1df1084214febcfeef89372292983cf1b0ba6358

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java   | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
4ac7c48e91f37471e83cc82d26b26e5b715e8e80

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java   | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
ae3eeb3e1c194c60fa62fbc7931566f3d8c87d68

 .../controller/ControllerChannelManager.scala      |  28 +++---
 .../scala/kafka/controller/KafkaController.scala   |  60 ++++++------
 .../kafka/controller/PartitionStateMachine.scala   |  84 ++++++++--------
 .../kafka/controller/ReplicaStateMachine.scala     |  45 ++++-----
 .../scala/kafka/controller/StateChangeLogger.scala |  50 ++++++++++
 .../coordinator/group/GroupMetadataManager.scala   |   2 +-
 .../main/scala/kafka/server/MetadataCache.scala    |  11 ++-
 .../main/scala/kafka/server/ReplicaManager.scala   | 106 ++++++++++-----------
 core/src/main/scala/kafka/utils/Logging.scala      |   4 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   5 +-
 10 files changed, 216 insertions(+), 179 deletions(-)
f2b74aa1c36bf2882006c14f7cbd56b493f39d26

 .../examples/pageview/PageViewTypedDemo.java       |   7 +-
 .../examples/pageview/PageViewUntypedDemo.java     |   9 +-
 .../org/apache/kafka/streams/StreamsBuilder.java   | 700 ++++-----------------
 .../java/org/apache/kafka/streams/Topology.java    |   2 +-
 .../kstream/internals/InternalStreamsBuilder.java  | 152 +++--
 .../streams/kstream/internals/KTableImpl.java      |   9 +-
 .../kstream/internals/MaterializedInternal.java    |   7 +-
 .../internals/InternalTopologyBuilder.java         |   3 +-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   3 +-
 .../streams/integration/EosIntegrationTest.java    |  12 +-
 .../integration/GlobalKTableIntegrationTest.java   |  13 +-
 .../streams/integration/JoinIntegrationTest.java   |   4 +-
 .../KStreamKTableJoinIntegrationTest.java          |   3 +-
 .../KTableKTableJoinIntegrationTest.java           |   6 +-
 .../integration/RestoreIntegrationTest.java        |   3 +-
 .../kstream/internals/GlobalKTableJoinsTest.java   |   5 +-
 .../internals/InternalStreamsBuilderTest.java      |  87 +--
 .../kstream/internals/KGroupedTableImplTest.java   |  25 +-
 .../streams/kstream/internals/KStreamImplTest.java |  11 +-
 .../internals/KStreamKStreamLeftJoinTest.java      |   2 +-
 .../kstream/internals/KStreamKTableJoinTest.java   |   7 +-
 .../internals/KStreamKTableLeftJoinTest.java       |   5 +-
 .../kstream/internals/KTableAggregateTest.java     |  22 +-
 .../kstream/internals/KTableFilterTest.java        |  28 +-
 .../kstream/internals/KTableForeachTest.java       |  12 +-
 .../streams/kstream/internals/KTableImplTest.java  |  29 +-
 .../kstream/internals/KTableKTableJoinTest.java    |  22 +-
 .../internals/KTableKTableLeftJoinTest.java        |  29 +-
 .../internals/KTableKTableOuterJoinTest.java       |  14 +-
 .../kstream/internals/KTableMapKeysTest.java       |   3 +-
 .../kstream/internals/KTableMapValuesTest.java     |  16 +-
 .../kstream/internals/KTableSourceTest.java        |  10 +-
 .../apache/kafka/streams/perf/SimpleBenchmark.java |  13 +-
 .../apache/kafka/streams/perf/YahooBenchmark.java  |   3 +-
 .../internals/StreamsMetadataStateTest.java        |   8 +-
 .../kafka/streams/tests/SmokeTestClient.java       |  13 +-
 36 files changed, 443 insertions(+), 854 deletions(-)
52d7b6763b7f8ec1973f1bc399d428542e6e962e

 core/src/test/scala/kafka/tools/ReplicaVerificationToolTest.scala | 1 +
 tests/kafkatest/services/replica_verification_tool.py             | 6 +++---
 2 files changed, 4 insertions(+), 3 deletions(-)
bd83ae6ba1f887ab112c4ccb2002633dfd387d69

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
b363901cbe9451bc5fc7ce55053aab1ffa9d7d49

 core/src/main/scala/kafka/tools/StreamsResetter.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
ed0e692147d81e396bf10f4d9425516d51bd52cc

 .../internals/RocksDBSegmentedBytesStore.java      |  1 +
 .../kafka/streams/state/internals/Segments.java    | 46 +++++++++++++++++-----
 .../internals/RocksDBSegmentedBytesStoreTest.java  | 39 +++++++++++++++++-
 .../streams/state/internals/SegmentsTest.java      | 29 ++++++++------
 4 files changed, 91 insertions(+), 24 deletions(-)
be6252d8ebdf9cf2d151028a7ba20eb1591b5961

 .../kafka/streams/processor/internals/StreamPartitionAssignor.java      | 2 +-
 .../java/org/apache/kafka/streams/processor/internals/StreamThread.java | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
d83252ebaeeca5bf19584908d95b424beb31b12e

 .../kafka/streams/kstream/KGroupedStream.java      | 210 ++++++++++++++++++++-
 .../internals/GroupedStreamAggregateBuilder.java   |  76 ++++++++
 .../kstream/internals/KGroupedStreamImpl.java      | 127 +++++++++----
 .../streams/kstream/internals/KStreamImpl.java     |  25 +--
 .../kstream/internals/MaterializedInternal.java    |  13 +-
 .../kstream/internals/WindowedKStreamImpl.java     |  57 ++----
 .../kstream/internals/KGroupedStreamImplTest.java  | 106 +++++++++++
 7 files changed, 515 insertions(+), 99 deletions(-)
346d0ca5382800f4bbc670b80660408705742392

 .../apache/kafka/jmh/cache/LRUCacheBenchmark.java  | 28 +++++++++++++++++-----
 1 file changed, 22 insertions(+), 6 deletions(-)
a3f068e22da6915cbc473be8da0cfbb229817436

 build.gradle                                       | 30 +++++-----------------
 .../apache/kafka/connect/runtime/WorkerTest.java   | 19 ++++++++------
 gradle/dependencies.gradle                         |  7 +++--
 3 files changed, 20 insertions(+), 36 deletions(-)
a339a387e0669226bc1537783b3d4c6ea5b9b4c0

 .../producer/internals/SenderMetricsRegistry.java  | 10 ++++++-
 .../apache/kafka/common/MetricNameTemplate.java    | 23 ++++++++++++++-
 .../clients/consumer/internals/FetcherTest.java    | 34 ++++++++++++++++++++++
 .../clients/producer/internals/SenderTest.java     | 30 +++++++++++++++++++
 .../test/java/org/apache/kafka/test/TestUtils.java | 12 +++++++-
 5 files changed, 106 insertions(+), 3 deletions(-)
f305dd68f6524abc25c4ed88983f0e78b4e6c243

 .../org/apache/kafka/streams/KafkaStreams.java     |  43 +++---
 .../streams/processor/internals/AbstractTask.java  |  31 +++--
 .../streams/processor/internals/AssignedTasks.java |  66 +++++-----
 .../processor/internals/GlobalStreamThread.java    |  37 +++---
 .../processor/internals/ProcessorStateManager.java |  46 +++----
 .../processor/internals/RecordCollectorImpl.java   |  29 +++--
 .../processor/internals/StandbyContextImpl.java    |   3 +-
 .../streams/processor/internals/StandbyTask.java   |  13 +-
 .../processor/internals/StoreChangelogReader.java  |  32 +++--
 .../internals/StreamPartitionAssignor.java         |  46 ++++---
 .../streams/processor/internals/StreamTask.java    |  51 ++++----
 .../streams/processor/internals/StreamThread.java  | 145 ++++++++++-----------
 .../streams/processor/internals/TaskManager.java   |  40 +++---
 .../kafka/streams/state/internals/ThreadCache.java |  15 +--
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   1 +
 ...KStreamSessionWindowAggregateProcessorTest.java |   3 +-
 .../internals/AbstractProcessorContextTest.java    |   3 +-
 .../processor/internals/AbstractTaskTest.java      |   3 +-
 .../processor/internals/AssignedTasksTest.java     |   3 +-
 .../processor/internals/ProcessorNodeTest.java     |   3 +-
 .../internals/ProcessorStateManagerTest.java       |  51 +++++---
 .../processor/internals/RecordCollectorTest.java   |  25 ++--
 .../processor/internals/RecordQueueTest.java       |   3 +-
 .../streams/processor/internals/SinkNodeTest.java  |   3 +-
 .../processor/internals/StandbyTaskTest.java       |   3 +-
 .../processor/internals/StateConsumerTest.java     |   6 +-
 .../internals/StoreChangelogReaderTest.java        |   6 +-
 .../processor/internals/StreamTaskTest.java        |  11 +-
 .../streams/state/KeyValueStoreTestDriver.java     |   5 +-
 .../state/internals/CachingKeyValueStoreTest.java  |   3 +-
 .../state/internals/CachingSessionStoreTest.java   |   3 +-
 .../state/internals/CachingWindowStoreTest.java    |   3 +-
 .../ChangeLoggingKeyValueBytesStoreTest.java       |   3 +-
 .../internals/ChangeLoggingKeyValueStoreTest.java  |   3 +-
 ...dSortedCacheKeyValueBytesStoreIteratorTest.java |   5 +-
 ...dSortedCacheWrappedWindowStoreIteratorTest.java |   3 +-
 .../state/internals/MeteredWindowStoreTest.java    |   3 +-
 .../RocksDBKeyValueStoreSupplierTest.java          |   3 +-
 .../internals/RocksDBSegmentedBytesStoreTest.java  |   3 +-
 .../internals/RocksDBSessionStoreSupplierTest.java |   3 +-
 .../state/internals/RocksDBSessionStoreTest.java   |   3 +-
 .../streams/state/internals/RocksDBStoreTest.java  |   5 +-
 .../internals/RocksDBWindowStoreSupplierTest.java  |   3 +-
 .../state/internals/RocksDBWindowStoreTest.java    |   5 +-
 .../state/internals/SegmentIteratorTest.java       |   3 +-
 .../streams/state/internals/SegmentsTest.java      |   3 +-
 .../state/internals/StoreChangeLoggerTest.java     |   3 +-
 .../StreamThreadStateStoreProviderTest.java        |   3 +-
 .../streams/state/internals/ThreadCacheTest.java   |  54 ++++----
 .../org/apache/kafka/test/KStreamTestDriver.java   |   8 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   6 +-
 51 files changed, 466 insertions(+), 391 deletions(-)
6055c749899a6d5ae618206548afd1f1e83eb65c

 .../test/java/org/apache/kafka/clients/admin/KafkaAdminClientTest.java  | 2 ++
 1 file changed, 2 insertions(+)
8fca432223da521b78e60e0cf8fa881ced19589c

 checkstyle/suppressions.xml                        |   8 +-
 .../org/apache/kafka/clients/NetworkClient.java    |   6 +-
 .../errors/AuthenticationFailedException.java      |  31 ++
 .../apache/kafka/common/network/Authenticator.java |   7 +
 .../apache/kafka/common/network/ChannelState.java  |  56 ++-
 .../apache/kafka/common/network/KafkaChannel.java  |  20 +-
 .../common/network/PlaintextChannelBuilder.java    |   7 +
 .../kafka/common/network/SaslChannelBuilder.java   |  26 +-
 .../kafka/common/network/SslChannelBuilder.java    |   7 +
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   3 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  10 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  22 +-
 .../kafka/common/requests/AbstractRequest.java     |   2 +
 .../kafka/common/requests/AbstractResponse.java    |   2 +
 .../common/requests/SaslAuthenticateRequest.java   | 102 ++++++
 .../common/requests/SaslAuthenticateResponse.java  |  88 +++++
 .../common/requests/SaslHandshakeRequest.java      |   9 +-
 .../authenticator/SaslClientAuthenticator.java     | 175 ++++++---
 .../authenticator/SaslServerAuthenticator.java     | 133 +++++--
 .../kafka/common/network/NetworkTestUtils.java     |  11 +-
 .../apache/kafka/common/network/NioEchoServer.java |   4 +-
 .../common/network/SslTransportLayerTest.java      |  22 +-
 .../apache/kafka/common/protocol/ApiKeysTest.java  |   8 +-
 .../kafka/common/protocol/ProtoUtilsTest.java      |   2 +-
 .../authenticator/SaslAuthenticatorTest.java       | 393 ++++++++++++++++++---
 .../security/authenticator/TestJaasConfig.java     |   5 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   8 +-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |   6 +-
 .../kafka/server/SaslApiVersionsRequestTest.scala  |   9 +-
 29 files changed, 1017 insertions(+), 165 deletions(-)
985cc534a4278b64fc37dc37913ab974266efe43

 .../streams/state/internals/CompositeReadOnlyWindowStore.java    | 2 +-
 .../state/internals/CompositeReadOnlyWindowStoreTest.java        | 9 ++++++---
 2 files changed, 7 insertions(+), 4 deletions(-)
f6f56a645bb1c5ec6810c024ba517e43bf77056c

 core/src/main/scala/kafka/cluster/Partition.scala  |   6 +-
 .../scala/kafka/common/TopicAndPartition.scala     |   2 +-
 .../controller/ControllerChannelManager.scala      |   6 +-
 .../scala/kafka/controller/KafkaController.scala   |  34 ++---
 .../kafka/controller/PartitionStateMachine.scala   |   7 +-
 .../kafka/controller/ReplicaStateMachine.scala     |  15 ++-
 .../scala/kafka/server/AbstractFetcherThread.scala |  30 ++---
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../main/scala/kafka/server/MetadataCache.scala    |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 149 +++++++++++----------
 .../kafka/tools/ReplicaVerificationToolTest.scala  |   2 +-
 11 files changed, 129 insertions(+), 128 deletions(-)
5d2422258cb975a137a42a4e08f03573c49a387e

 .../kafka/clients/producer/KafkaProducer.java      |  18 +-
 .../clients/producer/internals/ProducerBatch.java  |  36 +-
 .../producer/internals/RecordAccumulator.java      | 108 +++-
 .../kafka/clients/producer/internals/Sender.java   |  78 ++-
 .../producer/internals/TransactionManager.java     | 182 +++++-
 .../common/errors/DuplicateSequenceException.java  |  24 +
 .../errors/DuplicateSequenceNumberException.java   |  24 -
 .../org/apache/kafka/common/protocol/Errors.java   |   4 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  14 +
 .../java/org/apache/kafka/clients/MockClient.java  |  10 +
 .../clients/producer/internals/SenderTest.java     | 682 ++++++++++++++++++++-
 .../producer/internals/TransactionManagerTest.java |  88 ++-
 core/src/main/scala/kafka/log/Log.scala            |  19 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |   6 +-
 .../scala/kafka/log/ProducerStateManager.scala     | 197 +++---
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  12 +-
 .../integration/kafka/api/ProducerBounceTest.scala |   2 +-
 .../kafka/api/TransactionsBounceTest.scala         |  22 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |   3 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  97 ++-
 .../unit/kafka/log/ProducerStateManagerTest.scala  |  42 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   5 +-
 .../kafka/tools/TransactionalMessageCopier.java    |   6 +-
 23 files changed, 1384 insertions(+), 295 deletions(-)
8a5e86660593eab49c64fdfb5ef090634ae5ae06

 .../consumer/internals/AbstractCoordinator.java    | 23 +++---
 .../consumer/internals/ConsumerCoordinator.java    |  6 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 19 +++--
 .../consumer/internals/FetcherMetricsRegistry.java | 20 +++++
 .../clients/producer/internals/BufferPool.java     |  9 ++-
 .../producer/internals/RecordAccumulator.java      |  7 +-
 .../kafka/clients/producer/internals/Sender.java   | 44 ++++++-----
 .../producer/internals/SenderMetricsRegistry.java  | 16 ++++
 .../org/apache/kafka/common/metrics/Sensor.java    |  3 +-
 .../apache/kafka/common/metrics/stats/Meter.java   | 82 ++++++++++++++++++++
 .../org/apache/kafka/common/network/Selector.java  | 87 ++++++++++++++--------
 .../clients/producer/internals/BufferPoolTest.java |  6 +-
 .../apache/kafka/common/metrics/MetricsTest.java   | 20 +++--
 .../kafka/common/metrics/stats/MeterTest.java      | 73 ++++++++++++++++++
 .../main/scala/kafka/network/SocketServer.scala    |  5 +-
 .../kafka/api/PlaintextConsumerTest.scala          | 51 ++++++++++++-
 .../streams/processor/internals/StreamThread.java  | 26 +++++--
 .../processor/internals/StreamsMetricsImpl.java    | 13 +++-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  4 +-
 .../internals/StreamsMetricsImplTest.java          | 11 ++-
 20 files changed, 416 insertions(+), 109 deletions(-)
dfd625daa36de2e34e6c596967775394c55bc605

 .../java/org/apache/kafka/clients/ClientUtils.java |  2 --
 .../apache/kafka/clients/CommonClientConfigs.java  | 13 ++------
 .../kafka/common/network/ChannelBuilders.java      |  1 -
 .../kafka/common/protocol/SecurityProtocol.java    | 39 ++++------------------
 .../main/scala/kafka/consumer/BaseConsumer.scala   |  1 -
 .../TransactionMarkerChannelManager.scala          |  2 +-
 ...TransactionMarkerRequestCompletionHandler.scala |  2 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  1 -
 core/src/main/scala/kafka/server/KafkaConfig.scala |  6 ++--
 .../unit/kafka/network/SocketServerTest.scala      | 23 ++-----------
 10 files changed, 17 insertions(+), 73 deletions(-)
1c9581e2e9bb4a05dc2e25b4262272cfa1a4b470

 docs/streams/tutorial.html | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
b95a6bf61ae5c763ff054902a3c2d7cf205496e0

 .../quickstart/java/src/main/resources/archetype-resources/pom.xml    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
2656659e0d7c0e427768ce216df2698acc8c9b11

 .../kafka/clients/producer/KafkaProducer.java      |  6 +--
 .../kafka/clients/producer/internals/Sender.java   | 12 ++---
 .../producer/internals/TransactionManager.java     | 53 ++++++++++------------
 .../clients/producer/internals/SenderTest.java     | 24 +++++-----
 .../producer/internals/TransactionManagerTest.java |  3 +-
 5 files changed, 46 insertions(+), 52 deletions(-)
a0ad9f156a122e3e3a073cba0e2b0c39c93c7db5

 .../src/main/java/org/apache/kafka/clients/producer/KafkaProducer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3b5d88febb186c4b92cc514fa2338de7bc338f67

 checkstyle/import-control.xml                      |   5 +-
 .../apache/kafka/common/config/SaslConfigs.java    |  44 ++++--
 .../org/apache/kafka/common/config/SslConfigs.java |  42 +++--
 .../config/internals/BrokerSecurityConfigs.java    |  70 +++++++++
 .../apache/kafka/common/network/Authenticator.java |  19 +--
 .../kafka/common/network/ChannelBuilder.java       |   3 +-
 .../kafka/common/network/ChannelBuilders.java      |  48 ++++--
 .../kafka/common/network/DefaultAuthenticator.java |  63 --------
 .../apache/kafka/common/network/KafkaChannel.java  |  12 +-
 .../common/network/PlaintextChannelBuilder.java    |  64 +++++---
 .../kafka/common/network/SaslChannelBuilder.java   |  43 +++---
 .../kafka/common/network/SslChannelBuilder.java    |  81 +++++++---
 .../security/auth/AuthenticationContext.java       |  36 +++++
 .../security/auth/DefaultPrincipalBuilder.java     |   6 +-
 .../kafka/common/security/auth/KafkaPrincipal.java |  70 +++++----
 .../security/auth/KafkaPrincipalBuilder.java       |  36 +++++
 .../auth/PlaintextAuthenticationContext.java       |  40 +++++
 .../common/security/auth/PrincipalBuilder.java     |   5 +-
 .../security/auth/SaslAuthenticationContext.java   |  48 ++++++
 .../security/auth/SslAuthenticationContext.java    |  46 ++++++
 .../DefaultKafkaPrincipalBuilder.java              | 149 ++++++++++++++++++
 .../authenticator/SaslClientAuthenticator.java     |  33 ++--
 .../authenticator/SaslServerAuthenticator.java     |  67 +++++---
 .../authenticator/SaslServerCallbackHandler.java   |  21 +--
 .../kafka/common/security/ssl/SslFactory.java      |   3 +-
 .../apache/kafka/common/utils/SecurityUtils.java   |  37 +++++
 .../java/org/apache/kafka/common/utils/Utils.java  |   4 +-
 .../apache/kafka/common/network/CertStores.java    |   8 +-
 .../kafka/common/network/ChannelBuildersTest.java  | 107 +++++++++++++
 .../kafka/common/network/SslSelectorTest.java      |  37 +++--
 .../common/network/SslTransportLayerTest.java      |  62 ++++----
 .../kafka/common/security/TestSecurityConfig.java  |  16 +-
 .../auth/DefaultKafkaPrincipalBuilderTest.java     | 170 +++++++++++++++++++++
 .../common/security/auth/KafkaPrincipalTest.java   |   9 --
 .../authenticator/SaslAuthenticatorTest.java       |   9 +-
 .../authenticator/SaslServerAuthenticatorTest.java |  22 +--
 .../kafka/common/utils/SecurityUtilsTest.java      |  43 ++++++
 .../main/scala/kafka/network/SocketServer.scala    |   6 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  24 +--
 .../kafka/api/EndToEndAuthorizationTest.scala      |  18 +--
 .../kafka/api/IntegrationTestHarness.scala         |  14 +-
 .../api/PlaintextEndToEndAuthorizationTest.scala   |  71 +++++++++
 .../SaslPlainSslEndToEndAuthorizationTest.scala    |  29 +++-
 .../scala/integration/kafka/api/SaslSetup.scala    |   3 +-
 .../kafka/api/SslEndToEndAuthorizationTest.scala   |  35 ++++-
 .../kafka/integration/KafkaServerTestHarness.scala |   2 +-
 .../security/auth/SimpleAclAuthorizerTest.scala    |  20 +--
 .../scala/unit/kafka/server/RequestQuotaTest.scala |  11 +-
 .../scala/unit/kafka/utils/JaasTestUtils.scala     |   8 +-
 49 files changed, 1398 insertions(+), 421 deletions(-)
b0708c4acda6157460fdacc1da9e9079d1d9708a

 docs/streams/tutorial.html | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)
f7b1add686c27bcf26519c8a6963d9a773d7ffbe

 docs/streams/tutorial.html | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)
f47996ccbd9ad873230b509a1fef724989d2f1e8

 core/src/test/resources/log4j.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2098fef9175104917fdfc95b05cc9ccb285f2af3

 docs/streams/index.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
9d2437a464062025ea9288a307db3f0f4eaf1695

 docs/streams/index.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
ffd8f18a129fa826d62f527ea2c8eba2cfd644b2

 build.gradle                                       | 22 +++++++++++++++
 .../connect/file/FileStreamSinkConnectorTest.java  | 25 ++++++----------
 .../file/FileStreamSourceConnectorTest.java        | 19 +++++++------
 .../connect/file/FileStreamSourceTaskTest.java     | 16 +++++------
 .../runtime/distributed/DistributedHerderTest.java |  2 ++
 .../unit/kafka/producer/AsyncProducerTest.scala    | 33 +++++++++++-----------
 gradle/dependencies.gradle                         |  2 +-
 7 files changed, 69 insertions(+), 50 deletions(-)
c42bfc0d51e6691b4b5672ef7c8a1bedcd452d7f

 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
49b992dd8bad3d34bb6cdebda5eed9367b20e093

 release.py | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
90b4b07e6e3b44edfa41eebea83a674cb6f61922

 .../examples/temperature/TemperatureDemo.java      |  2 +-
 .../kstream/internals/WindowedDeserializer.java    | 40 ++++++++++++++++------
 .../streams/state/internals/WindowStoreUtils.java  |  2 +-
 .../internals/WindowedStreamPartitionerTest.java   | 24 ++++++++++---
 4 files changed, 51 insertions(+), 17 deletions(-)
9ed8bf273c6ee5569ed68b71782ec7ab947f9c93

 .../java/org/apache/kafka/common/network/Selector.java |  4 +++-
 .../apache/kafka/common/network/SslSelectorTest.java   | 18 +++++++-----------
 2 files changed, 10 insertions(+), 12 deletions(-)
8bd2a68b5020f0bf8f79cbe59676d649eebf170f

 .../kafka/streams/kstream/KGroupedTable.java       | 204 +++++++++++++++++++++
 .../apache/kafka/streams/kstream/Materialized.java |  12 +-
 .../kstream/internals/KGroupedTableImpl.java       | 134 +++++++++++---
 .../kafka/streams/kstream/MaterializedTest.java    |  54 ++++++
 .../kstream/internals/KGroupedTableImplTest.java   | 137 +++++++++++++-
 .../kstream/internals/KTableAggregateTest.java     |   1 +
 6 files changed, 509 insertions(+), 33 deletions(-)
08063f50a04fda3e40c6060a432a97f49bb68c8c

 .../org/apache/kafka/streams/kstream/KTable.java   | 290 +++++++++++++++++++--
 .../streams/kstream/internals/KTableImpl.java      |  88 ++++++-
 .../KTableKTableJoinIntegrationTest.java           |  33 ++-
 .../streams/kstream/internals/KTableImplTest.java  |  24 +-
 4 files changed, 400 insertions(+), 35 deletions(-)
c3c7674afb057e5b844145a55b67ea5717506301

 gradle.properties               | 2 +-
 streams/quickstart/java/pom.xml | 4 ++--
 streams/quickstart/pom.xml      | 4 ++--
 tests/kafkatest/__init__.py     | 2 +-
 4 files changed, 6 insertions(+), 6 deletions(-)
ba8483d27798b784f5bf1936dfbd5f3363ef1619

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
e1491d4a0463deaaa8de7e100dddc2edbc030abf

 .../internals/InternalTopologyBuilder.java         | 116 +++++++++++++--------
 1 file changed, 72 insertions(+), 44 deletions(-)
a67140317a644034e91ee596ab22bfb55adde1e0

 .../kafka/streams/InternalTopologyAccessor.java    | 32 ++++++++++++++++++++++
 .../kafka/test/ProcessorTopologyTestDriver.java    | 13 +++++++++
 2 files changed, 45 insertions(+)
439050816bef679efe403447a88cbaac69769567

 tests/kafkatest/services/kafka/kafka.py | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
1f5bc11cc0e94110e9cb673cacc63c02bb23c279

 .../main/java/org/apache/kafka/clients/NetworkClient.java   | 13 +++++++++++++
 1 file changed, 13 insertions(+)
d6fabb011af848ff96691b5deb97c88a84e1a683

 .../apache/kafka/streams/kstream/Serialized.java   | 12 +++-----
 .../streams/kstream/internals/KStreamImpl.java     | 10 ++++---
 .../streams/kstream/internals/KTableImpl.java      |  8 +++--
 .../kstream/internals/SerializedInternal.java      | 35 ++++++++++++++++++++++
 4 files changed, 51 insertions(+), 14 deletions(-)
9bb06c3eef3ebdff77e5e3b98c26b86c40efc56c

 .../org/apache/kafka/clients/NetworkClient.java    | 24 ++++++----
 .../kafka/clients/admin/KafkaAdminClient.java      | 19 +++++---
 .../kafka/clients/consumer/KafkaConsumer.java      |  5 +-
 .../kafka/clients/producer/KafkaProducer.java      |  5 +-
 .../org/apache/kafka/common/network/Selector.java  | 35 +++++++-------
 .../org/apache/kafka/common/utils/LogContext.java  |  4 ++
 .../apache/kafka/clients/NetworkClientTest.java    |  7 +--
 .../clients/consumer/internals/FetcherTest.java    |  2 +-
 .../clients/producer/internals/SenderTest.java     |  2 +-
 .../kafka/common/network/NetworkTestUtils.java     |  3 +-
 .../apache/kafka/common/network/NioEchoServer.java | 19 ++++----
 .../apache/kafka/common/network/SelectorTest.java  | 20 ++++----
 .../kafka/common/network/SslSelectorTest.java      |  7 +--
 .../common/network/SslTransportLayerTest.java      |  9 ++--
 .../runtime/distributed/WorkerGroupMember.java     |  5 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |  6 ++-
 .../controller/ControllerChannelManager.scala      | 11 +++--
 .../transaction/TransactionCoordinator.scala       | 18 +++++---
 .../TransactionMarkerChannelManager.scala          | 14 +++---
 .../main/scala/kafka/network/SocketServer.scala    | 14 ++++--
 core/src/main/scala/kafka/server/KafkaServer.scala | 17 ++++---
 .../kafka/server/ReplicaFetcherBlockingSend.scala  | 11 +++--
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 54 ++++++++++++----------
 .../transaction/TransactionCoordinatorTest.scala   |  5 +-
 .../unit/kafka/network/SocketServerTest.scala      | 11 +++--
 .../server/epoch/LeaderEpochIntegrationTest.scala  |  4 +-
 .../processor/internals/StreamsKafkaClient.java    | 15 ++++--
 27 files changed, 206 insertions(+), 140 deletions(-)
779714c08bc16fcdd6fe7c39e92a7f73ebebdb71

 .../org/apache/kafka/streams/kstream/Produced.java | 24 +++++--------
 .../streams/kstream/internals/KStreamImpl.java     | 12 +++++--
 .../kstream/internals/ProducedInternal.java        | 39 ++++++++++++++++++++++
 3 files changed, 57 insertions(+), 18 deletions(-)
c5464edbb7a6821e0a91a3712b1fe2fd92a22d68

 .../org/apache/kafka/streams/KafkaStreamsTest.java | 24 +++---
 .../apache/kafka/streams/StreamsConfigTest.java    | 36 ++++----
 .../streams/integration/EosIntegrationTest.java    |  4 +-
 .../streams/integration/FanoutIntegrationTest.java |  2 +-
 .../integration/GlobalKTableIntegrationTest.java   |  6 +-
 .../integration/InternalTopicIntegrationTest.java  |  4 +-
 .../streams/integration/JoinIntegrationTest.java   |  8 +-
 .../KStreamAggregationDedupIntegrationTest.java    |  4 +-
 .../KStreamAggregationIntegrationTest.java         |  4 +-
 .../KStreamKTableJoinIntegrationTest.java          |  2 +-
 .../integration/KStreamRepartitionJoinTest.java    | 24 +++---
 ...StreamsFineGrainedAutoResetIntegrationTest.java |  7 +-
 .../KTableKTableJoinIntegrationTest.java           | 43 +++++-----
 .../integration/QueryableStateIntegrationTest.java | 12 +--
 .../integration/RegexSourceIntegrationTest.java    |  7 +-
 .../streams/integration/ResetIntegrationTest.java  |  3 +-
 .../integration/utils/EmbeddedKafkaCluster.java    | 16 ++--
 .../kafka/streams/kstream/KStreamBuilderTest.java  | 32 ++++----
 .../kstream/internals/GlobalKTableJoinsTest.java   |  2 +-
 .../kstream/internals/KGroupedStreamImplTest.java  | 96 +++++++++++-----------
 .../kstream/internals/KGroupedTableImplTest.java   | 26 +++---
 .../streams/kstream/internals/KStreamImplTest.java | 58 ++++++-------
 .../kstream/internals/KStreamKStreamJoinTest.java  | 10 +--
 .../internals/KStreamKStreamLeftJoinTest.java      |  4 +-
 .../kstream/internals/KStreamKTableJoinTest.java   |  2 +-
 .../internals/KStreamKTableLeftJoinTest.java       |  2 +-
 ...KStreamSessionWindowAggregateProcessorTest.java | 18 ++--
 .../internals/KStreamWindowAggregateTest.java      |  6 +-
 .../internals/KTableKTableLeftJoinTest.java        |  8 +-
 .../internals/KTableKTableOuterJoinTest.java       |  6 +-
 .../kstream/internals/SessionKeySerdeTest.java     | 22 ++---
 .../apache/kafka/streams/perf/SimpleBenchmark.java | 36 ++++----
 .../apache/kafka/streams/perf/YahooBenchmark.java  |  6 +-
 .../streams/processor/TopologyBuilderTest.java     | 43 +++++-----
 .../internals/AbstractProcessorContextTest.java    | 22 ++---
 .../processor/internals/AbstractTaskTest.java      |  6 +-
 .../CopartitionedTopicsValidatorTest.java          | 10 +--
 .../internals/GlobalStateManagerImplTest.java      | 52 ++++++------
 .../processor/internals/GlobalStateTaskTest.java   | 15 ++--
 .../internals/GlobalStreamThreadTest.java          | 10 +--
 .../internals/InternalTopicConfigTest.java         | 20 ++---
 .../internals/InternalTopicManagerTest.java        | 10 +--
 .../internals/MinTimestampTrackerTest.java         | 14 ++--
 .../processor/internals/ProcessorNodeTest.java     |  4 +-
 .../internals/ProcessorStateManagerTest.java       | 20 ++---
 .../processor/internals/ProcessorTopologyTest.java | 10 +--
 .../processor/internals/RecordCollectorTest.java   | 10 +--
 .../processor/internals/RecordQueueTest.java       |  4 +-
 .../SourceNodeRecordDeserializerTest.java          |  6 +-
 .../processor/internals/StandbyTaskTest.java       | 16 ++--
 .../processor/internals/StateConsumerTest.java     | 21 ++---
 .../processor/internals/StateDirectoryTest.java    | 30 +++----
 .../processor/internals/StateRestorerTest.java     | 16 ++--
 .../internals/StoreChangelogReaderTest.java        | 24 +++---
 .../internals/StreamPartitionAssignorTest.java     |  8 +-
 .../processor/internals/StreamTaskTest.java        | 68 +++++++--------
 .../processor/internals/StreamThreadTest.java      | 12 +--
 .../internals/StreamsMetadataStateTest.java        | 40 ++++-----
 .../internals/StreamsMetricsImplTest.java          |  2 +-
 .../internals/assignment/AssignmentInfoTest.java   |  2 +-
 .../internals/assignment/ClientStateTest.java      | 34 ++++----
 .../assignment/StickyTaskAssignorTest.java         | 56 ++++++-------
 .../internals/assignment/SubscriptionInfoTest.java |  4 +-
 .../org/apache/kafka/streams/state/StoresTest.java | 10 +--
 .../state/internals/AbstractKeyValueStoreTest.java | 20 ++---
 .../state/internals/CachingKeyValueStoreTest.java  | 38 ++++-----
 .../state/internals/CachingSessionStoreTest.java   | 48 +++++------
 .../state/internals/CachingWindowStoreTest.java    | 44 +++++-----
 .../ChangeLoggingKeyValueBytesStoreTest.java       | 30 +++----
 .../internals/ChangeLoggingKeyValueStoreTest.java  | 38 ++++-----
 .../CompositeReadOnlyKeyValueStoreTest.java        | 32 ++++----
 .../CompositeReadOnlySessionStoreTest.java         | 10 +--
 .../CompositeReadOnlyWindowStoreTest.java          | 18 ++--
 .../DelegatingPeekingKeyValueIteratorTest.java     | 12 +--
 .../state/internals/FilteredCacheIteratorTest.java | 12 +--
 .../internals/GlobalStateStoreProviderTest.java    |  6 +-
 ...SortedCacheWrappedSessionStoreIteratorTest.java | 14 ++--
 ...dSortedCacheWrappedWindowStoreIteratorTest.java |  6 +-
 ...acheWrappedWindowStoreKeyValueIteratorTest.java | 14 ++--
 .../streams/state/internals/NamedCacheTest.java    | 36 ++++----
 .../internals/QueryableStoreProviderTest.java      | 14 ++--
 .../RocksDBKeyValueStoreSupplierTest.java          | 14 ++--
 .../state/internals/RocksDBKeyValueStoreTest.java  |  8 +-
 .../internals/RocksDBSegmentedBytesStoreTest.java  |  8 +-
 .../internals/RocksDBSessionStoreSupplierTest.java | 14 ++--
 .../state/internals/RocksDBSessionStoreTest.java   | 28 +++----
 .../streams/state/internals/RocksDBStoreTest.java  |  6 +-
 .../internals/RocksDBWindowStoreSupplierTest.java  | 14 ++--
 .../state/internals/RocksDBWindowStoreTest.java    | 18 ++--
 .../state/internals/SegmentIteratorTest.java       |  8 +-
 .../internals/SegmentedCacheFunctionTest.java      |  8 +-
 .../streams/state/internals/SegmentsTest.java      | 22 ++---
 .../internals/SerializedKeyValueIteratorTest.java  | 10 +--
 .../state/internals/SessionKeySchemaTest.java      | 14 ++--
 .../state/internals/StoreChangeLoggerTest.java     |  2 +-
 .../StreamThreadStateStoreProviderTest.java        | 14 ++--
 .../streams/state/internals/ThreadCacheTest.java   | 46 +++++------
 .../state/internals/WindowKeySchemaTest.java       | 14 ++--
 .../state/internals/WindowStoreUtilsTest.java      |  2 +-
 .../state/internals/WrappingStoreProviderTest.java |  6 +-
 .../streams/tests/BrokerCompatibilityTest.java     |  2 +-
 .../apache/kafka/streams/tests/EosTestDriver.java  |  2 +-
 .../kafka/streams/tests/SmokeTestDriver.java       |  4 +-
 .../apache/kafka/streams/tests/SmokeTestUtil.java  |  2 +-
 .../apache/kafka/streams/tests/StreamsEosTest.java |  2 +-
 .../kafka/streams/tests/StreamsSmokeTest.java      |  2 +-
 106 files changed, 900 insertions(+), 901 deletions(-)
3728f4cd9623ce028f1720b03e15d444856fd7fc

 .../src/test/java/org/apache/kafka/common/network/SelectorTest.java  | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
b53b7fc6e2bf5638ce5646c6899e5ce3153cbb8c

 .../main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java    | 4 ++++
 .../java/org/apache/kafka/clients/admin/KafkaAdminClientTest.java     | 2 ++
 .../java/org/apache/kafka/clients/admin/MockKafkaAdminClientEnv.java  | 2 +-
 3 files changed, 7 insertions(+), 1 deletion(-)
ae4100f82c13b3e6978c0a0f697312bd073e0eb3

 .../main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java    | 4 ++++
 .../java/org/apache/kafka/clients/admin/KafkaAdminClientTest.java     | 2 ++
 .../java/org/apache/kafka/clients/admin/MockKafkaAdminClientEnv.java  | 2 +-
 3 files changed, 7 insertions(+), 1 deletion(-)
689a84c7d6aec32956aabf2e8b3612e754ba2e88

 streams/src/main/java/org/apache/kafka/streams/Consumed.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9cec4109b236c1380f2b44caba2fbf2c8b96a828

 streams/src/main/java/org/apache/kafka/streams/kstream/Printed.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2db1e4423fb33405a319b253b040e57e069c1f7a

 docs/streams/developer-guide.html                  |  11 +-
 .../org/apache/kafka/streams/kstream/KTable.java   | 140 +++++++++++++++-
 .../apache/kafka/streams/kstream/Materialized.java | 184 +++++++++++++++++++++
 .../streams/kstream/internals/KTableImpl.java      |  60 +++++++
 .../internals/KeyValueStoreMaterializer.java       |  52 ++++++
 .../kstream/internals/MaterializedInternal.java    |  62 +++++++
 .../integration/QueryableStateIntegrationTest.java |  13 +-
 .../kstream/internals/KTableFilterTest.java        |  28 ++++
 .../streams/kstream/internals/KTableImplTest.java  |  22 +++
 .../kstream/internals/KTableMapValuesTest.java     |   9 +-
 .../internals/KeyValueStoreMaterializerTest.java   | 116 +++++++++++++
 11 files changed, 683 insertions(+), 14 deletions(-)
4a4b883d10644d54feefdf3154e46d2b43d4cea4

 tests/kafkatest/services/zookeeper.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
6e4045586212812165693840b68d7577a05b890a

 tests/kafkatest/services/zookeeper.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
5d73b37b14d03babffebd0bde6022d2cff175b8b

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6ebd9d35fc081bca3f1efeba8b70ec71cde85270

 .../org/apache/kafka/common/network/Selector.java  |  73 +--
 .../apache/kafka/common/network/SelectorTest.java  |  92 +++-
 .../kafka/common/network/SslSelectorTest.java      |   5 +
 .../main/scala/kafka/network/SocketServer.scala    | 208 +++++----
 .../unit/kafka/network/SocketServerTest.scala      | 516 ++++++++++++++++++++-
 5 files changed, 762 insertions(+), 132 deletions(-)
4769e3d92acdc6036f1f834c70004f0c867ae582

 docs/streams/developer-guide.html                  |  12 +-
 docs/streams/upgrade-guide.html                    |   6 +
 .../org/apache/kafka/streams/kstream/KStream.java  |  37 ++++++
 .../kafka/streams/kstream/PrintForeachAction.java  |  61 ----------
 .../org/apache/kafka/streams/kstream/Printed.java  | 126 +++++++++++++++++++++
 .../streams/kstream/internals/KStreamImpl.java     |  29 ++---
 .../streams/kstream/internals/KStreamPrint.java    |  43 +------
 .../streams/kstream/internals/KTableImpl.java      |   5 +-
 .../kstream/internals/PrintForeachAction.java      |  64 +++++++++++
 .../streams/kstream/internals/PrintedInternal.java |  36 ++++++
 .../apache/kafka/streams/kstream/PrintedTest.java  | 126 +++++++++++++++++++++
 .../streams/kstream/internals/KStreamImplTest.java |   7 +-
 .../kstream/internals/KStreamPrintTest.java        |  19 +---
 13 files changed, 426 insertions(+), 145 deletions(-)
5f0c060e0cc5d2fc483f83fbf556ad77b3ae0e96

 .../streams/processor/internals/AssignedTasks.java |   2 +-
 .../processor/internals/ChangelogReader.java       |  12 +-
 .../processor/internals/ProcessorStateManager.java |   1 -
 .../processor/internals/StoreChangelogReader.java  | 146 +++++++++++----------
 .../streams/processor/internals/StreamThread.java  |  18 +--
 .../processor/internals/AbstractTaskTest.java      |   3 +-
 .../processor/internals/AssignedTasksTest.java     |  15 ++-
 .../processor/internals/StandbyTaskTest.java       |   3 +-
 .../internals/StoreChangelogReaderTest.java        |  93 +++----------
 .../processor/internals/StreamTaskTest.java        |   3 +-
 .../processor/internals/StreamThreadTest.java      |  69 ++++------
 .../StreamThreadStateStoreProviderTest.java        |   2 +-
 .../org/apache/kafka/test/MockChangelogReader.java |   9 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   7 +-
 14 files changed, 142 insertions(+), 241 deletions(-)
e16b9143dfcecbd58e3bebecbdb7d8e933b88cc4

 docs/streams/developer-guide.html                  |  55 +++++---
 docs/streams/upgrade-guide.html                    |   6 +
 .../kafka/streams/kstream/KGroupedStream.java      |  14 ++
 .../kafka/streams/kstream/WindowedKStream.java     | 150 +++++++++++++++++++++
 .../kstream/internals/KGroupedStreamImpl.java      |  22 ++-
 .../kstream/internals/WindowedKStreamImpl.java     | 143 ++++++++++++++++++++
 .../KStreamAggregationIntegrationTest.java         |  55 ++++----
 .../kstream/internals/KGroupedStreamImplTest.java  |   1 +
 .../kstream/internals/WindowedKStreamImplTest.java | 144 ++++++++++++++++++++
 9 files changed, 544 insertions(+), 46 deletions(-)
beeed86600f3571635e83e6a3b6ee0c38679c7fe

 gradle/dependencies.gradle | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
ee4e4c8cb35d1403c521518d6c269bbc03700325

 .../apache/kafka/common/metrics/JmxReporter.java   |  16 +-
 .../kafka/common/metrics/KafkaMbeanTest.java       | 165 +++++++++++++++++++++
 2 files changed, 173 insertions(+), 8 deletions(-)
ef17d5b892fa34811c805cac366744040e6d6efb

 core/src/main/scala/kafka/server/KafkaConfig.scala          | 8 ++++++--
 core/src/test/scala/unit/kafka/server/KafkaConfigTest.scala | 8 ++++++++
 2 files changed, 14 insertions(+), 2 deletions(-)
6546f9af6da45044ce68e392d4bdeac4122d132e

 tests/README.md | 13 +++++++++++++
 1 file changed, 13 insertions(+)
b07435638d66f80c10c23c7e87bbe1d6844968a3

 .../kafka/clients/consumer/StickyAssignor.java     | 46 +++++++++++++---------
 1 file changed, 27 insertions(+), 19 deletions(-)
d0ee6ed36baf702fa24dac8ae31f45fc27324d89

 docs/streams/developer-guide.html                  |   7 +-
 .../examples/pageview/PageViewTypedDemo.java       |   3 +-
 .../examples/pageview/PageViewUntypedDemo.java     |   3 +-
 .../java/org/apache/kafka/streams/Consumed.java    | 158 ++++++++
 .../org/apache/kafka/streams/StreamsBuilder.java   | 431 +++++----------------
 .../org/apache/kafka/streams/kstream/KStream.java  |   8 +-
 .../kstream/internals/ConsumedInternal.java        |  56 +++
 .../kstream/internals/InternalStreamsBuilder.java  |  91 ++---
 .../streams/kstream/internals/KStreamImpl.java     |   7 +-
 .../streams/kstream/internals/KTableImpl.java      |   4 +-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   2 +-
 .../apache/kafka/streams/StreamsBuilderTest.java   |   9 +-
 .../integration/GlobalKTableIntegrationTest.java   |   3 +-
 .../KStreamAggregationDedupIntegrationTest.java    |   3 +-
 .../KStreamAggregationIntegrationTest.java         |  15 +-
 .../KStreamKTableJoinIntegrationTest.java          |   3 +-
 .../integration/KStreamRepartitionJoinTest.java    |   7 +-
 ...StreamsFineGrainedAutoResetIntegrationTest.java |  13 +-
 .../integration/QueryableStateIntegrationTest.java |   3 +-
 .../integration/RegexSourceIntegrationTest.java    |   2 +-
 .../kstream/internals/AbstractStreamTest.java      |   3 +-
 .../kstream/internals/GlobalKTableJoinsTest.java   |   3 +-
 .../internals/InternalStreamsBuilderTest.java      |  69 ++--
 .../kstream/internals/KGroupedStreamImplTest.java  |  10 +-
 .../kstream/internals/KStreamBranchTest.java       |   3 +-
 .../kstream/internals/KStreamFilterTest.java       |   5 +-
 .../kstream/internals/KStreamFlatMapTest.java      |   3 +-
 .../internals/KStreamFlatMapValuesTest.java        |   3 +-
 .../kstream/internals/KStreamForeachTest.java      |   3 +-
 .../streams/kstream/internals/KStreamImplTest.java |  25 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  |  24 +-
 .../internals/KStreamKStreamLeftJoinTest.java      |  10 +-
 .../kstream/internals/KStreamKTableJoinTest.java   |   3 +-
 .../internals/KStreamKTableLeftJoinTest.java       |   3 +-
 .../streams/kstream/internals/KStreamMapTest.java  |   3 +-
 .../kstream/internals/KStreamMapValuesTest.java    |   3 +-
 .../streams/kstream/internals/KStreamPeekTest.java |   5 +-
 .../kstream/internals/KStreamSelectKeyTest.java    |   3 +-
 .../kstream/internals/KStreamTransformTest.java    |   3 +-
 .../internals/KStreamTransformValuesTest.java      |   3 +-
 .../internals/KStreamWindowAggregateTest.java      |   7 +-
 .../apache/kafka/streams/perf/SimpleBenchmark.java |   7 +-
 .../apache/kafka/streams/perf/YahooBenchmark.java  |   6 +-
 .../processor/internals/StandbyTaskTest.java       |   3 +-
 .../processor/internals/StreamThreadTest.java      |  10 +-
 .../kafka/streams/tests/ShutdownDeadlockTest.java  |   3 +-
 .../kafka/streams/tests/SmokeTestClient.java       |   3 +-
 47 files changed, 553 insertions(+), 501 deletions(-)
27336192ff62d43d0beabc5dab2855b87befcc55

 .../common/ZkNodeChangeNotificationListener.scala  |  2 -
 .../main/scala/kafka/network/RequestChannel.scala  | 93 ++++++++++++----------
 .../main/scala/kafka/network/SocketServer.scala    | 17 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  9 ++-
 .../scala/kafka/server/KafkaRequestHandler.scala   |  4 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  2 +-
 .../kafka/api/EndToEndClusterIdTest.scala          |  2 +-
 .../integration/kafka/api/TransactionsTest.scala   |  2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  2 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |  4 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |  4 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  2 +-
 .../scala/unit/kafka/log/LogValidatorTest.scala    |  4 +-
 .../unit/kafka/network/SocketServerTest.scala      |  6 +-
 14 files changed, 83 insertions(+), 70 deletions(-)
07a428e0c8fea498f084f5918fa88d5334ae8028

 .../java/org/apache/kafka/common/security/ssl/SslFactory.java  |  4 +++-
 tests/kafkatest/services/security/security_config.py           | 10 +++++-----
 2 files changed, 8 insertions(+), 6 deletions(-)
a1ec6527db808679330a54e802c4ae1630e6b50d

 .../apache/kafka/streams/processor/internals/StreamThread.java    | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
674407908b898dd18b447447ad3346b5268b1dfc

 .../internals/InternalTopologyBuilder.java         | 112 ++++++++++++++++-----
 .../internals/InternalTopologyBuilderTest.java     |  46 +++++++++
 2 files changed, 132 insertions(+), 26 deletions(-)
3410f02fec6bc8633ebb58e3c1a8f9c2e49a1aa4

 core/src/main/scala/kafka/server/KafkaApis.scala   |  2 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      | 47 +++++++++++++++++++---
 2 files changed, 43 insertions(+), 6 deletions(-)
4065ffb3e1a82f71578811a0a329cdc90e5e1567

 tests/kafkatest/services/trogdor/__init__.py       |  14 ++
 tests/kafkatest/services/trogdor/fault_spec.py     |  45 ++++
 .../trogdor/network_partition_fault_spec.py        |  54 +++++
 .../kafkatest/services/trogdor/no_op_fault_spec.py |  41 ++++
 .../services/trogdor/templates/log4j.properties    |  23 ++
 tests/kafkatest/services/trogdor/trogdor.py        | 255 +++++++++++++++++++++
 tests/kafkatest/tests/tools/trogdor_test.py        |  97 ++++++++
 tests/kafkatest/utils/__init__.py                  |   2 +-
 tests/kafkatest/utils/util.py                      |   9 +
 .../java/org/apache/kafka/trogdor/agent/Agent.java |  50 +++-
 .../apache/kafka/trogdor/basic/BasicPlatform.java  |  13 +-
 .../kafka/trogdor/coordinator/Coordinator.java     |  32 ++-
 .../kafka/trogdor/coordinator/NodeManager.java     |   6 +
 .../apache/kafka/trogdor/fault/AbstractFault.java  | 106 +++++++++
 .../org/apache/kafka/trogdor/fault/DoneState.java  |  47 ++++
 .../java/org/apache/kafka/trogdor/fault/Fault.java |  28 ++-
 .../org/apache/kafka/trogdor/fault/FaultState.java |  36 ++-
 .../kafka/trogdor/fault/NetworkPartitionFault.java |  46 +---
 .../org/apache/kafka/trogdor/fault/NoOpFault.java  |  43 +---
 .../apache/kafka/trogdor/fault/PendingState.java   |  30 +++
 .../apache/kafka/trogdor/fault/RunningState.java   |  38 +++
 .../apache/kafka/trogdor/fault/SendingState.java   |  64 ++++++
 .../apache/kafka/trogdor/rest/FaultDataMap.java    |   2 +-
 .../org/apache/kafka/trogdor/agent/AgentTest.java  |  37 ++-
 .../kafka/trogdor/coordinator/CoordinatorTest.java |  18 +-
 25 files changed, 993 insertions(+), 143 deletions(-)
329d5fa64a2a3ac1d39ac37fdacbf6e43d500d11

 .../org/apache/kafka/streams/kstream/KTable.java   | 33 +++++++++++++++++++++-
 .../kafka/streams/kstream/KeyValueMapper.java      |  4 +--
 .../streams/kstream/internals/KTableImpl.java      | 22 ++++++++++-----
 .../kstream/internals/KTableAggregateTest.java     | 21 +++++++-------
 .../internals/KTableKTableLeftJoinTest.java        |  3 +-
 .../kafka/streams/tests/SmokeTestClient.java       |  3 +-
 6 files changed, 62 insertions(+), 24 deletions(-)
9cbb9f0939c88868bf33ae340c5fa756ee2965e8

 docs/streams/developer-guide.html                  |  56 ++--
 .../examples/wordcount/WordCountProcessorDemo.java |   6 +-
 .../java/org/apache/kafka/streams/Topology.java    |  24 +-
 .../streams/processor/StateStoreSupplier.java      |   2 +
 .../internals/InternalTopologyBuilder.java         | 295 ++++++++++++++++-----
 .../streams/state/KeyValueBytesStoreSupplier.java  |  26 ++
 .../streams/state/SessionBytesStoreSupplier.java   |  33 +++
 .../apache/kafka/streams/state/StoreBuilder.java   |  82 ++++++
 .../apache/kafka/streams/state/StoreSupplier.java  |  47 ++++
 .../org/apache/kafka/streams/state/Stores.java     | 148 +++++++++++
 .../streams/state/WindowBytesStoreSupplier.java    |  56 ++++
 .../state/internals/AbstractStoreBuilder.java      |  84 ++++++
 .../state/internals/KeyValueStoreBuilder.java      |  62 +++++
 .../internals/RocksDBKeyValueStoreSupplier.java    |  49 +---
 .../state/internals/RocksDBSessionStore.java       |   2 +-
 .../internals/RocksDBSessionStoreSupplier.java     |  51 ++--
 .../state/internals/RocksDBWindowStore.java        |   2 +-
 .../internals/RocksDBWindowStoreSupplier.java      |  62 ++---
 .../RocksDbKeyValueBytesStoreSupplier.java         |  48 ++++
 .../RocksDbSessionBytesStoreSupplier.java          |  59 +++++
 .../internals/RocksDbWindowBytesStoreSupplier.java |  90 +++++++
 .../state/internals/SessionStoreBuilder.java       |  63 +++++
 .../state/internals/WindowStoreBuilder.java        |  68 +++++
 .../org/apache/kafka/streams/TopologyTest.java     |  52 +++-
 .../internals/InternalTopologyBuilderTest.java     |   2 +-
 .../org/apache/kafka/streams/state/StoresTest.java |  62 +++++
 .../state/internals/KeyValueStoreBuilderTest.java  | 141 ++++++++++
 .../state/internals/SessionStoreBuilderTest.java   | 141 ++++++++++
 .../state/internals/WindowStoreBuilderTest.java    | 135 ++++++++++
 29 files changed, 1716 insertions(+), 232 deletions(-)
667cd60dc6ba68831423a256b6e455f7d955581c

 docs/streams/developer-guide.html                  |  18 ++-
 .../org/apache/kafka/streams/kstream/KStream.java  |  41 ++++++
 .../org/apache/kafka/streams/kstream/Produced.java | 163 +++++++++++++++++++++
 .../streams/kstream/internals/KStreamImpl.java     |  34 +++--
 .../streams/kstream/internals/KStreamImplTest.java |  47 ++++++
 5 files changed, 287 insertions(+), 16 deletions(-)
b041c8d87deab536b262e6260334b5bda1d896c8

 docs/streams/developer-guide.html | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
9b85cf9ed02d4b3b87ea39e0c2f8c35e1e813f2f

 docs/streams/developer-guide.html                                 | 2 +-
 docs/streams/upgrade-guide.html                                   | 4 ++--
 .../src/main/java/org/apache/kafka/streams/kstream/KStream.java   | 6 +++---
 .../java/org/apache/kafka/streams/processor/ProcessorContext.java | 4 ++--
 .../java/org/apache/kafka/streams/processor/PunctuationType.java  | 4 ++--
 .../org/apache/kafka/streams/processor/internals/StreamTask.java  | 4 ++--
 .../apache/kafka/streams/processor/internals/StreamTaskTest.java  | 8 ++++----
 7 files changed, 16 insertions(+), 16 deletions(-)
3f155eaa23c6081e4afa3b49f0f8a65a16b8e05c

 .../streams/processor/internals/StreamThread.java  | 21 +++--------
 .../org/apache/kafka/streams/state/Stores.java     |  4 +--
 .../processor/internals/StreamThreadTest.java      | 41 ++++++----------------
 3 files changed, 17 insertions(+), 49 deletions(-)
212bce6e3fed5069e530aa75c7a25443f28a2ffb

 docs/streams/upgrade-guide.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
23d01c805bef7504abfa83ecac7e384d121a583a

 .../org/apache/kafka/clients/consumer/Consumer.java   |  5 +++++
 .../apache/kafka/clients/consumer/KafkaConsumer.java  | 19 +++++++++++++++++++
 .../apache/kafka/clients/consumer/MockConsumer.java   |  5 +++++
 .../kafka/clients/consumer/KafkaConsumerTest.java     |  6 +++---
 core/src/main/scala/kafka/consumer/BaseConsumer.scala |  2 +-
 .../kafka/api/AuthorizerIntegrationTest.scala         | 14 +++++++-------
 6 files changed, 40 insertions(+), 11 deletions(-)
d93bd1aff96b418c22cdbf9af355c6185d1e9192

 .../kafka/connect/runtime/WorkerSourceTask.java    |  2 +-
 .../kafka/connect/storage/OffsetStorageWriter.java | 65 ++++++++++++----------
 2 files changed, 36 insertions(+), 31 deletions(-)
51025764601760684f3dbdc0171fd7aa2ebe70e7

 .../kafka/connect/runtime/WorkerSourceTask.java    |  2 +-
 .../kafka/connect/storage/OffsetStorageWriter.java | 65 ++++++++++++----------
 2 files changed, 36 insertions(+), 31 deletions(-)
45394d52c1ba566178c57897297a3ea31379f957

 .../apache/kafka/streams/kstream/JoinWindows.java  |   4 +-
 .../org/apache/kafka/streams/kstream/Joined.java   | 146 +++++++
 .../org/apache/kafka/streams/kstream/KStream.java  | 426 ++++++++++++++++++++-
 .../apache/kafka/streams/kstream/ValueJoiner.java  |  10 +-
 .../streams/kstream/internals/KStreamImpl.java     | 110 ++++--
 .../integration/KStreamRepartitionJoinTest.java    |  25 +-
 .../streams/kstream/internals/KStreamImplTest.java |  54 ++-
 .../kstream/internals/KStreamKStreamJoinTest.java  |  28 +-
 .../internals/KStreamKStreamLeftJoinTest.java      |  13 +-
 9 files changed, 732 insertions(+), 84 deletions(-)
b687c068008a81fad390c80da289249cc04b3efb

 docs/streams/developer-guide.html                  | 35 +++++----
 .../examples/pageview/PageViewTypedDemo.java       |  3 +-
 .../examples/pageview/PageViewUntypedDemo.java     |  3 +-
 .../org/apache/kafka/streams/kstream/KStream.java  | 59 ++++++++++++++-
 .../apache/kafka/streams/kstream/Serialized.java   | 88 ++++++++++++++++++++++
 .../streams/kstream/internals/KStreamImpl.java     | 38 +++++++---
 .../KStreamAggregationDedupIntegrationTest.java    |  6 +-
 .../KStreamAggregationIntegrationTest.java         |  7 +-
 .../KStreamKTableJoinIntegrationTest.java          |  3 +-
 .../kstream/internals/KGroupedStreamImplTest.java  |  3 +-
 .../internals/KStreamWindowAggregateTest.java      |  8 +-
 .../apache/kafka/streams/perf/YahooBenchmark.java  |  3 +-
 .../kafka/streams/tests/SmokeTestClient.java       |  3 +-
 13 files changed, 215 insertions(+), 44 deletions(-)
2fb5664bf4591f3e7bdc02894b9de392bf72913c

 build.gradle                                       |   9 +-
 checkstyle/suppressions.xml                        |   2 +
 .../kafka/clients/producer/KafkaProducer.java      |   5 +-
 .../producer/internals/ProducerMetrics.java        |  48 ++++++++
 .../kafka/clients/producer/internals/Sender.java   |  66 ++++++-----
 .../producer/internals/SenderMetricsRegistry.java  | 125 +++++++++++++++++++++
 .../clients/producer/internals/SenderTest.java     |  29 ++---
 .../producer/internals/TransactionManagerTest.java |   2 +-
 docs/ops.html                                      | 114 +------------------
 9 files changed, 240 insertions(+), 160 deletions(-)
cd59976eea54efe6367b4c55872ab206f504829a

 docs/streams/upgrade-guide.html | 40 +++++++++++++++++++++++++++++++++++++++-
 1 file changed, 39 insertions(+), 1 deletion(-)
5d69966195409d73e6e4d74e8a898fac754450cc

 .../main/scala/kafka/admin/ReassignPartitionsCommand.scala  |  4 ++--
 .../kafka/admin/ReassignPartitionsCommandArgsTest.scala     | 13 ++++++++++++-
 2 files changed, 14 insertions(+), 3 deletions(-)
81e789ae3dc6ea8369db181c5aef440491d74f19

 bin/windows/connect-distributed.bat              |  2 +-
 bin/windows/connect-standalone.bat               |  2 +-
 bin/windows/kafka-acls.bat                       |  2 +-
 bin/windows/kafka-configs.bat                    |  2 +-
 bin/windows/kafka-console-consumer.bat           |  2 +-
 bin/windows/kafka-console-producer.bat           |  2 +-
 bin/windows/kafka-consumer-groups.bat            |  2 +-
 bin/windows/kafka-consumer-offset-checker.bat    |  2 +-
 bin/windows/kafka-consumer-perf-test.bat         |  2 +-
 bin/windows/kafka-mirror-maker.bat               |  2 +-
 bin/windows/kafka-preferred-replica-election.bat |  2 +-
 bin/windows/kafka-producer-perf-test.bat         |  2 +-
 bin/windows/kafka-reassign-partitions.bat        |  2 +-
 bin/windows/kafka-replay-log-producer.bat        |  2 +-
 bin/windows/kafka-replica-verification.bat       |  2 +-
 bin/windows/kafka-run-class.bat                  | 65 ++++++++++++------------
 bin/windows/kafka-server-start.bat               |  2 +-
 bin/windows/kafka-simple-consumer-shell.bat      |  2 +-
 bin/windows/kafka-topics.bat                     |  2 +-
 bin/windows/zookeeper-server-start.bat           |  2 +-
 bin/windows/zookeeper-shell.bat                  |  2 +-
 21 files changed, 52 insertions(+), 53 deletions(-)
fc3eeb00473bd3a27517c8e047defbbe28905375

 .../org/apache/kafka/streams/processor/internals/StreamThreadTest.java   | 1 -
 1 file changed, 1 deletion(-)
426057094cc2211578b8546708c7a9b8818aeb05

 .../streams/processor/internals/AssignedTasks.java |  4 +--
 .../streams/processor/internals/StreamThread.java  | 42 ++++++++++------------
 .../processor/internals/StreamThreadTest.java      |  5 +--
 3 files changed, 21 insertions(+), 30 deletions(-)
752e5317410f05d08f69f302e4ee0cadae183b59

 .../kafka/clients/producer/MockProducer.java       |  2 --
 .../kafka/clients/producer/MockProducerTest.java   | 11 --------
 .../streams/processor/internals/AssignedTasks.java | 10 ++++----
 .../streams/processor/internals/StandbyTask.java   | 10 +++++---
 .../streams/processor/internals/StreamTask.java    | 19 ++++++++++----
 .../kafka/streams/processor/internals/Task.java    |  4 +--
 .../processor/internals/AbstractTaskTest.java      |  6 ++---
 .../processor/internals/AssignedTasksTest.java     | 12 ++++-----
 .../processor/internals/StandbyTaskTest.java       |  2 +-
 .../processor/internals/StreamTaskTest.java        | 29 +++++++++++++++-------
 .../kafka/test/ProcessorTopologyTestDriver.java    |  2 +-
 11 files changed, 58 insertions(+), 49 deletions(-)
facd2c5a8c7a4379755955ba3e318bfecde6af39

 .../org/apache/kafka/streams/KafkaStreams.java     |  21 +++
 .../kafka/streams/processor/TaskMetadata.java      |  74 ++++++++++
 .../kafka/streams/processor/ThreadMetadata.java    |  93 ++++++++++++
 .../streams/processor/internals/StreamThread.java  |  35 +++++
 .../processor/internals/StreamsMetadataState.java  |   2 +-
 .../streams/processor/internals/TaskManager.java   |   4 +
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  24 +++
 .../processor/internals/StreamThreadTest.java      | 163 ++++++++++++++++++++-
 8 files changed, 410 insertions(+), 6 deletions(-)
90b6d978e83fe9a3d9615fdcb7f1e5ac35512f7e

 streams/quickstart/pom.xml | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
d78eb03fad33b6060f246ae31c9276038e8555ec

 streams/quickstart/pom.xml | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
175cff05ae40eaa1934a196876a9bfdb4d382616

 docs/js/templateData.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
caddae19ea87fb2fa46884eddfa6eb742c770267

 docs/js/templateData.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
f7b9d523e34d9db1865dcd23236c06a71aa9b9a6

 release.py | 2 ++
 1 file changed, 2 insertions(+)
b1871e5adf3fef7256a75d09b812c6ba64791ff4

 release.py | 2 ++
 1 file changed, 2 insertions(+)
493c2aad595c70247d70572579853c90ee4ea5db

 docs/streams/developer-guide.html | 64 ++++++++++++++++++++++++++++++++++-----
 1 file changed, 57 insertions(+), 7 deletions(-)
7b6e5f96ce8e724fb513dfc7f2da2eaf7bb82328

 .../org/apache/kafka/streams/KafkaStreams.java     | 26 ++++++++++++++----
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 32 ++++++++++++----------
 2 files changed, 38 insertions(+), 20 deletions(-)
adefc8ea076354e07839f0319fee1fba52343b91

 bin/kafka-log-dirs.sh                              |  17 ++
 .../kafka/clients/admin/AbstractOptions.java       |  46 ++++
 .../apache/kafka/clients/admin/AdminClient.java    |  77 +++++-
 .../kafka/clients/admin/AdminClientConfig.java     |  10 +-
 .../kafka/clients/admin/AlterConfigsOptions.java   |  20 +-
 .../clients/admin/AlterReplicaDirOptions.java      |  29 +++
 .../kafka/clients/admin/AlterReplicaDirResult.java |  57 +++++
 .../kafka/clients/admin/CreateAclsOptions.java     |  20 +-
 .../kafka/clients/admin/CreateTopicsOptions.java   |  21 +-
 .../kafka/clients/admin/DeleteAclsOptions.java     |  20 +-
 .../kafka/clients/admin/DeleteTopicsOptions.java   |  20 +-
 .../kafka/clients/admin/DescribeAclsOptions.java   |  20 +-
 .../clients/admin/DescribeClusterOptions.java      |  20 +-
 .../clients/admin/DescribeConfigsOptions.java      |  19 +-
 .../clients/admin/DescribeLogDirsOptions.java      |  33 +++
 .../kafka/clients/admin/DescribeLogDirsResult.java |  70 ++++++
 .../admin/DescribeReplicaLogDirOptions.java        |  31 +++
 .../clients/admin/DescribeReplicaLogDirResult.java | 132 ++++++++++
 .../kafka/clients/admin/DescribeTopicsOptions.java |  20 +-
 .../kafka/clients/admin/KafkaAdminClient.java      | 195 ++++++++++++++-
 .../kafka/clients/admin/ListTopicsOptions.java     |  21 +-
 .../apache/kafka/common/TopicPartitionReplica.java |  91 +++++++
 .../kafka/common/errors/KafkaStorageException.java |   2 +-
 .../common/errors/LogDirNotFoundException.java     |  37 +++
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   4 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   8 +
 .../org/apache/kafka/common/protocol/Protocol.java |  56 ++++-
 .../kafka/common/requests/AbstractRequest.java     |   4 +
 .../kafka/common/requests/AbstractResponse.java    |   4 +
 .../common/requests/AlterReplicaDirRequest.java    | 148 +++++++++++
 .../common/requests/AlterReplicaDirResponse.java   | 114 +++++++++
 .../common/requests/DescribeLogDirsRequest.java    | 145 +++++++++++
 .../common/requests/DescribeLogDirsResponse.java   | 184 ++++++++++++++
 .../main/scala/kafka/admin/LogDirsCommand.scala    | 114 +++++++++
 .../kafka/admin/ReassignPartitionsCommand.scala    | 272 +++++++++++++++++----
 core/src/main/scala/kafka/log/LogManager.scala     |  35 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  34 ++-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  89 ++++++-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   8 +-
 .../kafka/api/AdminClientIntegrationTest.scala     |  81 +++++-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  22 +-
 .../other/kafka/ReplicationQuotasTestRig.scala     |   2 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  10 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |   2 +-
 .../admin/ReassignPartitionsClusterTest.scala      | 139 +++++++++--
 .../admin/ReassignPartitionsCommandTest.scala      |  20 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   2 +-
 .../kafka/server/AlterReplicaDirRequestTest.scala  |  83 +++++++
 .../scala/unit/kafka/server/BaseRequestTest.scala  |   4 +-
 .../kafka/server/DescribeLogDirsRequestTest.scala  |  64 +++++
 .../scala/unit/kafka/server/RequestQuotaTest.scala |   9 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  30 ++-
 53 files changed, 2399 insertions(+), 318 deletions(-)
99e08412c69787f955e1cd2ed7aa5b9d93624c93

 .../kafka/clients/admin/KafkaAdminClient.java      | 98 +++++++++++++---------
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 17 ++++
 2 files changed, 74 insertions(+), 41 deletions(-)
b2a328daf2a51520290fc4ec31ce5d92b2c0ef01

 .../kafka/clients/admin/KafkaAdminClient.java      | 98 +++++++++++++---------
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 17 ++++
 2 files changed, 74 insertions(+), 41 deletions(-)
14a7c297ab917efb28e579fa942d58cdcf4930c5

 .../java/org/apache/kafka/streams/KafkaStreams.java  | 20 +++++++++++++++++++-
 .../org/apache/kafka/streams/KafkaStreamsTest.java   | 19 ++++++++++++-------
 2 files changed, 31 insertions(+), 8 deletions(-)
bc999989bff39db2f5e7b07968988ed9ccba49b2

 core/src/main/scala/kafka/log/LogManager.scala        | 6 ++++--
 core/src/main/scala/kafka/server/KafkaServer.scala    | 6 +++---
 core/src/main/scala/kafka/server/ReplicaManager.scala | 1 +
 core/src/test/scala/unit/kafka/utils/TestUtils.scala  | 6 +++++-
 4 files changed, 13 insertions(+), 6 deletions(-)
51af6fb654c482fb6fdd85126991149238640fd7

 .../processor/internals/ProcessorTopologyTest.java | 46 ++++++++++++++++------
 .../kafka/test/ProcessorTopologyTestDriver.java    | 23 ++++++++++-
 2 files changed, 56 insertions(+), 13 deletions(-)
b4271b5cbc229143d485d9375b35cbb7a3a826c1

 tests/kafkatest/services/zookeeper.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5ec185e277051798f048657df944c643562e86e1

 tests/kafkatest/services/zookeeper.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
75070bdb5d70cc0b2f52faf4f769144f68f02ee2

 tests/kafkatest/services/zookeeper.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c9168e10f93d713ad78ed421f50e9819b3f046b5

 .../consumer/internals/AbstractCoordinator.java    |  2 +-
 .../org/apache/kafka/common/network/Selector.java  | 17 ++++++++++-
 .../apache/kafka/common/protocol/types/Struct.java |  2 +-
 .../authenticator/SaslClientAuthenticator.java     | 35 +++++++++++++++++-----
 .../authenticator/SaslClientCallbackHandler.java   |  2 +-
 .../authenticator/SaslServerAuthenticator.java     | 10 +++----
 .../kafka/clients/producer/ProducerRecordTest.java | 12 ++++----
 .../authenticator/SaslAuthenticatorTest.java       |  9 ++++--
 .../common/security/plain/PlainSaslServerTest.java | 16 ++++++----
 .../common/security/scram/ScramSaslServerTest.java |  2 +-
 10 files changed, 76 insertions(+), 31 deletions(-)
ded8741173854c98f3be0525403b6a17a55b6027

 .../org/apache/kafka/trogdor/coordinator/Coordinator.java     | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)
c3980a22bdbe9f7477b6b56c4194f5c46d0307f9

 clients/src/main/java/org/apache/kafka/clients/Metadata.java  |  1 +
 .../java/org/apache/kafka/clients/producer/KafkaProducer.java |  2 ++
 .../org/apache/kafka/clients/producer/KafkaProducerTest.java  | 11 +++++++++++
 3 files changed, 14 insertions(+)
0b4daa4bf48517b4b3e9cda11692e80ade620b04

 .../common/security/plain/PlainSaslServer.java     | 14 ++--
 .../common/security/scram/ScramSaslServer.java     | 18 ++++--
 .../common/security/plain/PlainSaslServerTest.java | 75 ++++++++++++++++++++++
 .../common/security/scram/ScramSaslServerTest.java | 74 +++++++++++++++++++++
 4 files changed, 172 insertions(+), 9 deletions(-)
9f3468645b968761ca9141d18337cb6adadbae97

 .../common/security/plain/PlainSaslServer.java     | 14 ++--
 .../common/security/scram/ScramSaslServer.java     | 18 ++++--
 .../common/security/plain/PlainSaslServerTest.java | 75 ++++++++++++++++++++++
 .../common/security/scram/ScramSaslServerTest.java | 74 +++++++++++++++++++++
 4 files changed, 172 insertions(+), 9 deletions(-)
47c2753496875db2849065ad91ee03c7c842c8e9

 .../common/security/plain/PlainSaslServer.java     | 14 ++--
 .../common/security/scram/ScramSaslServer.java     | 18 ++++--
 .../common/security/plain/PlainSaslServerTest.java | 75 ++++++++++++++++++++++
 .../common/security/scram/ScramSaslServerTest.java | 74 +++++++++++++++++++++
 4 files changed, 172 insertions(+), 9 deletions(-)
9ebc303bb85bf5aae2b732c60d3b3e0a6e07512d

 .../internals/AbstractProcessorContext.java        |   4 +-
 .../processor/internals/ProcessorNodeTest.java     |   6 +-
 .../streams/state/internals/RocksDBStoreTest.java  |  49 +------
 .../apache/kafka/test/MockProcessorContext.java    | 160 ++++++++-------------
 4 files changed, 66 insertions(+), 153 deletions(-)
9836adc732288924813927c4869ffb3908febba1

 clients/src/main/java/org/apache/kafka/clients/Metadata.java |  1 +
 .../org/apache/kafka/clients/producer/KafkaProducer.java     |  2 ++
 .../org/apache/kafka/clients/producer/KafkaProducerTest.java | 12 ++++++++++++
 3 files changed, 15 insertions(+)
ce04b14358054dd33134a596de97ef5594d187b7

 docs/streams/developer-guide.html | 10 +++++-----
 docs/streams/upgrade-guide.html   |  2 +-
 2 files changed, 6 insertions(+), 6 deletions(-)
f5310d645c4920d37925e82edb07f1e4a582b0b2

 docs/streams/core-concepts.html                    | 18 +++++------
 docs/streams/developer-guide.html                  | 37 +++++++++++-----------
 docs/streams/upgrade-guide.html                    | 19 ++++++++++-
 docs/upgrade.html                                  |  2 +-
 .../org/apache/kafka/streams/kstream/KStream.java  | 37 +++++++---------------
 5 files changed, 59 insertions(+), 54 deletions(-)
6682abe4ae68fdbf0eb362e45f43ea14e2aba847

 .../streams/processor/internals/AssignedTasks.java |   2 +-
 .../processor/internals/ChangelogReader.java       |  12 +-
 .../processor/internals/ProcessorStateManager.java |   1 -
 .../streams/processor/internals/StateRestorer.java |  10 +-
 .../processor/internals/StoreChangelogReader.java  | 154 +++++++++++----------
 .../streams/processor/internals/StreamThread.java  |   2 -
 .../processor/internals/AbstractTaskTest.java      |   3 +-
 .../processor/internals/StandbyTaskTest.java       |   3 +-
 .../internals/StoreChangelogReaderTest.java        |  99 +++----------
 .../processor/internals/StreamTaskTest.java        |   3 +-
 .../StreamThreadStateStoreProviderTest.java        |   3 +-
 .../org/apache/kafka/test/MockChangelogReader.java |   9 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   2 -
 13 files changed, 112 insertions(+), 191 deletions(-)
76c9a6dcbc1fa92d1a7c2e913ad42b5f1a72fe62

 .../internals/ChangeLoggingWindowBytesStore.java   |  20 +++-
 .../internals/RocksDBWindowStoreSupplier.java      |   2 +-
 .../ChangeLoggingWindowBytesStoreTest.java         | 132 +++++++++++++++++++++
 3 files changed, 147 insertions(+), 7 deletions(-)
10cb534c8b18997301553db6debfe91bf596500e

 .../kafka/clients/admin/KafkaAdminClient.java      | 112 ++++++++++-----------
 1 file changed, 55 insertions(+), 57 deletions(-)
bd54d2e3e09e7dc717828ed5690aa30f7c3611d8

 docs/images/streams-stateful_operations.png | Bin 0 -> 123213 bytes
 docs/streams/developer-guide.html           | 831 +++++++++++++++++++++++++++-
 2 files changed, 815 insertions(+), 16 deletions(-)
949577ca77d5c143774d4879b19505b4d6284de3

 tests/docker/Dockerfile                            |  2 +-
 tests/kafkatest/services/kafka/kafka.py            |  9 +++++---
 tests/kafkatest/services/kafka_log4j_appender.py   | 11 ++++++---
 tests/kafkatest/services/mirror_maker.py           | 19 +++++++--------
 tests/kafkatest/services/monitor/jmx.py            |  9 ++++++--
 .../services/performance/end_to_end_latency.py     | 11 ++++++---
 .../kafkatest/services/performance/performance.py  | 18 +++++++++++----
 .../services/replica_verification_tool.py          | 11 ++++++---
 tests/kafkatest/services/simple_consumer_shell.py  |  9 +++++---
 tests/kafkatest/services/zookeeper.py              | 27 ++++++++++++++--------
 tests/setup.py                                     |  2 +-
 11 files changed, 86 insertions(+), 42 deletions(-)
565455eae21d883e0a69f6a80e891a08aa2fb698

 tests/kafkatest/services/zookeeper.py | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)
0cffb62373fb785d6225f2b4c0a00ce4d67d9e37

 tests/kafkatest/services/zookeeper.py | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)
9ef2b3ce8e4553504e52385a6370bf641fc6ea1e

 .../kafka/streams/processor/ProcessorContext.java  |  5 ++
 .../internals/AbstractProcessorContext.java        |  6 +-
 .../streams/state/internals/RocksDBStore.java      |  8 +--
 .../internals/AbstractProcessorContextTest.java    | 28 +++++++-
 .../streams/state/internals/RocksDBStoreTest.java  | 78 +++++++++++++---------
 5 files changed, 84 insertions(+), 41 deletions(-)
1f659913a631d9e77e7cd9b9c9775e3249ef803a

 .../org/apache/kafka/streams/KafkaStreams.java     | 539 ++++++++++-----------
 .../processor/internals/GlobalStreamThread.java    | 121 +++--
 .../streams/processor/internals/StreamThread.java  | 254 +++++-----
 .../processor/internals/StreamsMetricsImpl.java    |   5 +-
 .../internals/StreamThreadStateStoreProvider.java  |   2 +-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  16 +-
 .../internals/GlobalStreamThreadTest.java          |  12 +-
 .../processor/internals/StateConsumerTest.java     |   4 +-
 .../processor/internals/StreamThreadTest.java      |  12 +-
 .../StreamThreadStateStoreProviderTest.java        |   2 +-
 10 files changed, 485 insertions(+), 482 deletions(-)
abc66c98ca4d64e88cd7862e799738c37da8820a

 .../streams/processor/internals/AssignedTasks.java | 12 ++++++
 .../processor/internals/StoreChangelogReader.java  | 48 +++++++++++++---------
 .../internals/StoreChangelogReaderTest.java        | 43 ++++++++++++++++++-
 3 files changed, 82 insertions(+), 21 deletions(-)
61548a6f02878ceb95d9dd019497c10c61a0ebce

 .../org/apache/kafka/clients/admin/KafkaAdminClient.java     |  8 +++++++-
 .../org/apache/kafka/clients/admin/KafkaAdminClientTest.java | 12 +++++++++++-
 .../integration/kafka/api/AdminClientIntegrationTest.scala   |  9 +++++----
 3 files changed, 23 insertions(+), 6 deletions(-)
7ae02a69c4965ccc6b9aeb72a0803d8ab1f62cc8

 .../org/apache/kafka/clients/admin/KafkaAdminClient.java     |  8 +++++++-
 .../org/apache/kafka/clients/admin/KafkaAdminClientTest.java | 12 +++++++++++-
 .../integration/kafka/api/AdminClientIntegrationTest.scala   |  9 +++++----
 3 files changed, 23 insertions(+), 6 deletions(-)
8d3aa6acadd057b866ffa39f04592ec8f92ad700

 core/src/main/scala/kafka/log/Log.scala | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)
5648dcc3e59f4518d7febb31e0d687b94f1baadf

 docs/streams/core-concepts.html   | 4 ++--
 docs/streams/developer-guide.html | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)
fc166ff43e352ecdc427f4c0a516ebde78d7fed9

 jmh-benchmarks/jmh.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b6adb2dc89ae0625aa5d7fa501c9585585d50107

 jmh-benchmarks/jmh.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b01fcc3b89ee27940ca20dea00226d09a0ca0b8e

 .../main/java/org/apache/kafka/clients/producer/KafkaProducer.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
551d57561d6cb9e53aa16e0616190d370d339355

 .../streams/processor/internals/AssignedTasks.java | 12 ++++
 .../processor/internals/StoreChangelogReader.java  | 74 ++++++++++++----------
 .../internals/StoreChangelogReaderTest.java        | 47 +++++++++++++-
 3 files changed, 98 insertions(+), 35 deletions(-)
c715f6a5ab94d187eb662efde594f0f14dcd9910

 .../streams/kstream/internals/SessionKeySerde.java |   2 +-
 .../state/internals/CachingSessionStore.java       |  59 +++---
 .../ChangeLoggingSegmentedBytesStore.java          |  80 -------
 .../internals/ChangeLoggingSessionBytesStore.java  |  92 ++++++++
 .../MergedSortedCacheSessionStoreIterator.java     |  30 ++-
 .../internals/MeteredSegmentedBytesStore.java      | 169 ---------------
 .../state/internals/MeteredSessionStore.java       | 169 +++++++++++++++
 .../internals/RocksDBSessionStoreSupplier.java     |  40 ++--
 .../state/internals/CachingSessionStoreTest.java   | 189 +++++++++--------
 .../state/internals/CachingWindowStoreTest.java    |  28 +--
 .../ChangeLoggingSegmentedBytesStoreTest.java      | 125 -----------
 .../ChangeLoggingSessionBytesStoreTest.java        | 177 ++++++++++++++++
 ...SortedCacheWrappedSessionStoreIteratorTest.java |  43 ++--
 .../internals/MeteredKeyValueBytesStoreTest.java   |   1 -
 .../internals/MeteredSegmentedBytesStoreTest.java  | 165 --------------
 .../state/internals/MeteredSessionStoreTest.java   | 236 +++++++++++++++++++++
 .../internals/RocksDBSessionStoreSupplierTest.java |  16 +-
 .../state/internals/RocksDBSessionStoreTest.java   |   4 +-
 .../org/apache/kafka/test/StreamsTestUtils.java    |  23 ++
 19 files changed, 883 insertions(+), 765 deletions(-)
0772fde562ed361beec6ad745895a0ee0cf229e8

 bin/trogdor.sh                                     |  50 +++
 build.gradle                                       |   7 +
 checkstyle/import-control.xml                      |  12 +
 checkstyle/suppressions.xml                        |  14 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  38 +++
 .../java/org/apache/kafka/trogdor/agent/Agent.java | 339 ++++++++++++++++++++
 .../apache/kafka/trogdor/agent/AgentClient.java    | 158 ++++++++++
 .../kafka/trogdor/agent/AgentRestResource.java     |  80 +++++
 .../org/apache/kafka/trogdor/basic/BasicNode.java  | 111 +++++++
 .../apache/kafka/trogdor/basic/BasicPlatform.java  |  95 ++++++
 .../apache/kafka/trogdor/basic/BasicTopology.java  |  58 ++++
 .../org/apache/kafka/trogdor/common/JsonUtil.java  |  52 ++++
 .../java/org/apache/kafka/trogdor/common/Node.java |  65 ++++
 .../org/apache/kafka/trogdor/common/Platform.java  |  80 +++++
 .../org/apache/kafka/trogdor/common/Topology.java  |  35 +++
 .../kafka/trogdor/coordinator/Coordinator.java     | 341 +++++++++++++++++++++
 .../trogdor/coordinator/CoordinatorClient.java     | 154 ++++++++++
 .../coordinator/CoordinatorRestResource.java       |  80 +++++
 .../kafka/trogdor/coordinator/NodeManager.java     | 262 ++++++++++++++++
 .../kafka/trogdor/fault/AbstractFaultSpec.java     |  53 ++++
 .../java/org/apache/kafka/trogdor/fault/Fault.java |  50 +++
 .../org/apache/kafka/trogdor/fault/FaultSet.java   | 146 +++++++++
 .../org/apache/kafka/trogdor/fault/FaultSpec.java  |  59 ++++
 .../org/apache/kafka/trogdor/fault/FaultState.java |  27 ++
 .../kafka/trogdor/fault/NetworkPartitionFault.java | 130 ++++++++
 .../trogdor/fault/NetworkPartitionFaultSpec.java   |  65 ++++
 .../org/apache/kafka/trogdor/fault/NoOpFault.java  |  92 ++++++
 .../apache/kafka/trogdor/fault/NoOpFaultSpec.java  |  50 +++
 .../kafka/trogdor/rest/AgentFaultsResponse.java    |  52 ++++
 .../kafka/trogdor/rest/AgentStatusResponse.java    |  59 ++++
 .../trogdor/rest/CoordinatorFaultsResponse.java    |  52 ++++
 .../trogdor/rest/CoordinatorStatusResponse.java    |  59 ++++
 .../trogdor/rest/CreateAgentFaultRequest.java      |  69 +++++
 .../rest/CreateCoordinatorFaultRequest.java        |  69 +++++
 .../java/org/apache/kafka/trogdor/rest/Empty.java  |  49 +++
 .../apache/kafka/trogdor/rest/ErrorResponse.java   |  68 ++++
 .../apache/kafka/trogdor/rest/FaultDataMap.java    |  98 ++++++
 .../apache/kafka/trogdor/rest/JsonRestServer.java  | 220 +++++++++++++
 .../kafka/trogdor/rest/RestExceptionMapper.java    |  71 +++++
 .../org/apache/kafka/trogdor/agent/AgentTest.java  | 167 ++++++++++
 .../kafka/trogdor/basic/BasicPlatformTest.java     |  68 ++++
 .../trogdor/common/CapturingCommandRunner.java     |  60 ++++
 .../kafka/trogdor/common/ExpectedFaults.java       | 193 ++++++++++++
 .../kafka/trogdor/common/MiniTrogdorCluster.java   | 238 ++++++++++++++
 .../kafka/trogdor/coordinator/CoordinatorTest.java | 212 +++++++++++++
 .../apache/kafka/trogdor/fault/FaultSetTest.java   | 126 ++++++++
 tools/src/test/resources/log4j.properties          |  22 ++
 47 files changed, 4648 insertions(+), 7 deletions(-)
607c3c21f652a8f911d1efb8374d2eec313a4e2d

 checkstyle/suppressions.xml                        |  2 +
 .../kafka/clients/producer/KafkaProducer.java      | 38 ++++++----
 .../producer/internals/RecordAccumulator.java      | 10 ++-
 .../kafka/clients/producer/internals/Sender.java   |  8 +-
 .../producer/internals/RecordAccumulatorTest.java  | 86 +++++++++++++---------
 .../clients/producer/internals/SenderTest.java     | 20 ++---
 .../producer/internals/TransactionManagerTest.java |  6 +-
 7 files changed, 103 insertions(+), 67 deletions(-)
c4d629a0b3cbd11c174cb8b09a50bc8de77825e9

 .../org/apache/kafka/clients/ClientRequest.java    |   2 +-
 .../org/apache/kafka/clients/NetworkClient.java    |  24 +--
 .../consumer/internals/ConsumerNetworkClient.java  |   4 +-
 .../kafka/clients/producer/internals/Sender.java   |   5 +-
 .../kafka/common/network/ChannelBuilders.java      |   2 +-
 .../kafka/common/network/SaslChannelBuilder.java   |  17 +-
 .../java/org/apache/kafka/common/network/Send.java |   4 +-
 .../kafka/common/requests/AbstractRequest.java     | 112 ++++------
 .../kafka/common/requests/AbstractResponse.java    |  19 +-
 .../kafka/common/requests/ApiVersionsRequest.java  |  27 ++-
 .../kafka/common/requests/ApiVersionsResponse.java |  12 +-
 .../kafka/common/requests/FetchResponse.java       |  21 +-
 .../kafka/common/requests/RequestContext.java      |  92 +++++++++
 .../kafka/common/requests/RequestHeader.java       |  48 +++--
 .../authenticator/SaslClientAuthenticator.java     |   8 +-
 .../authenticator/SaslServerAuthenticator.java     | 103 ++++-----
 .../common/network/SaslChannelBuilderTest.java     |   4 +-
 .../kafka/common/requests/RequestContextTest.java  |  75 +++++++
 .../kafka/common/requests/RequestHeaderTest.java   |   6 +-
 .../kafka/common/requests/RequestResponseTest.java |  12 +-
 .../authenticator/SaslAuthenticatorTest.java       |  14 +-
 .../authenticator/SaslServerAuthenticatorTest.java |   8 +-
 .../controller/ControllerChannelManager.scala      |   2 +-
 ...TransactionMarkerRequestCompletionHandler.scala |   4 +-
 .../main/scala/kafka/network/RequestChannel.scala  | 111 +++++-----
 .../main/scala/kafka/network/SocketServer.scala    |  24 ++-
 .../kafka/server/ClientRequestQuotaManager.scala   |  25 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 229 ++++++++++-----------
 .../scala/kafka/server/KafkaRequestHandler.scala   |  59 +++---
 core/src/main/scala/kafka/utils/Logging.scala      |   2 +
 .../test/scala/other/kafka/TestOffsetManager.scala |   3 +-
 .../unit/kafka/admin/AdminRackAwareTest.scala      |   5 +-
 .../kafka/admin/ResetConsumerGroupOffsetTest.scala |   9 +-
 .../TransactionMarkerChannelManagerTest.scala      |  11 +-
 ...sactionMarkerRequestCompletionHandlerTest.scala |  30 +--
 .../kafka/integration/KafkaServerTestHarness.scala |   2 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   3 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |   2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   1 -
 .../unit/kafka/log/ProducerStateManagerTest.scala  |   2 +-
 .../unit/kafka/network/SocketServerTest.scala      |  64 +++---
 .../scala/unit/kafka/server/BaseRequestTest.scala  |   2 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |   4 +-
 .../scala/unit/kafka/server/KafkaApisTest.scala    |  21 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   2 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |   4 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   2 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |   3 -
 .../unit/kafka/server/ReplicationQuotasTest.scala  |   2 +-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |   4 +-
 .../unit/kafka/utils/IteratorTemplateTest.scala    |   2 +-
 .../scala/unit/kafka/utils/timer/TimerTest.scala   |   3 +-
 52 files changed, 685 insertions(+), 571 deletions(-)
1425758915adbc858d5f5c5b3da9cabc10215aa6

 .../apache/kafka/streams/state/internals/Segments.java    |  4 +---
 .../kafka/streams/state/internals/SegmentsTest.java       | 15 +++++++++++++++
 2 files changed, 16 insertions(+), 3 deletions(-)
05e3850b2ea24f372ea1cc6ca7457e0ff99445f6

 .../apache/kafka/streams/state/internals/Segments.java    |  4 +---
 .../kafka/streams/state/internals/SegmentsTest.java       | 15 +++++++++++++++
 2 files changed, 16 insertions(+), 3 deletions(-)
a008238051b3dbb1a85c0c04b31bbbb486cd7fac

 docs/upgrade.html | 1 -
 1 file changed, 1 deletion(-)
14f6ecd9151fa985fad0a30347efab1397af2491

 tests/kafkatest/services/kafka/kafka.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e6164ec611ca48e71c549f88d8a92fef90bf5a71

 .../org/apache/kafka/common/network/Selector.java  |  2 +-
 .../main/scala/kafka/network/SocketServer.scala    |  4 ++
 .../unit/kafka/network/SocketServerTest.scala      | 44 +++++++++++++++-------
 3 files changed, 35 insertions(+), 15 deletions(-)
6e5f8850d50fcb1e113baee870671dbddb18ba85

 .../kafka/clients/producer/KafkaProducer.java      | 99 ++++++++++++++++------
 .../kafka/clients/producer/internals/Sender.java   |  5 +-
 .../producer/internals/TransactionManager.java     |  7 +-
 .../common/errors/OutOfOrderSequenceException.java |  8 ++
 .../common/errors/ProducerFencedException.java     |  6 ++
 .../UnsupportedForMessageFormatException.java      |  3 +-
 .../common/errors/UnsupportedVersionException.java | 12 +++
 .../java/org/apache/kafka/clients/MockClient.java  | 61 +++++++++----
 .../clients/producer/internals/SenderTest.java     | 72 +++++++++++++++-
 .../producer/internals/TransactionManagerTest.java | 77 +++++++++++++++++
 10 files changed, 299 insertions(+), 51 deletions(-)
71417552c7651a5b41e73460d0577615864aafe8

 .../kafka/clients/producer/KafkaProducer.java      | 99 ++++++++++++++++------
 .../kafka/clients/producer/internals/Sender.java   |  5 +-
 .../producer/internals/TransactionManager.java     |  7 +-
 .../common/errors/OutOfOrderSequenceException.java |  8 ++
 .../common/errors/ProducerFencedException.java     |  6 ++
 .../UnsupportedForMessageFormatException.java      |  3 +-
 .../common/errors/UnsupportedVersionException.java | 12 +++
 .../java/org/apache/kafka/clients/MockClient.java  | 61 +++++++++----
 .../clients/producer/internals/SenderTest.java     | 72 +++++++++++++++-
 .../producer/internals/TransactionManagerTest.java | 77 +++++++++++++++++
 10 files changed, 299 insertions(+), 51 deletions(-)
21fea170d8499a7153f2b821bcd32a55ad602645

 docs/streams/upgrade-guide.html | 22 +++++++++++++++++++---
 docs/upgrade.html               | 12 ++++++++++--
 2 files changed, 29 insertions(+), 5 deletions(-)
5e65c0da45f3a86a25087c4d2e2b501e81e0a285

 docs/streams/developer-guide.html | 504 ++++++++++++++++++++++++++++++++++----
 1 file changed, 454 insertions(+), 50 deletions(-)
b872abf69b1308da57ad7ad24e9cffe3e5421128

 .../kafka/clients/producer/MockProducer.java       |  2 --
 .../kafka/clients/producer/MockProducerTest.java   | 10 --------
 .../streams/processor/internals/AbstractTask.java  |  3 ++-
 .../streams/processor/internals/AssignedTasks.java |  6 ++---
 .../streams/processor/internals/StandbyTask.java   |  4 +++-
 .../streams/processor/internals/StreamTask.java    | 21 ++++++++++++-----
 .../streams/processor/internals/StreamThread.java  |  6 ++---
 .../processor/internals/AbstractTaskTest.java      |  2 +-
 .../processor/internals/AssignedTasksTest.java     | 15 ++++++------
 .../processor/internals/StreamTaskTest.java        | 27 +++++++++++++++-------
 .../processor/internals/StreamThreadTest.java      | 13 +++++++----
 .../kafka/test/ProcessorTopologyTestDriver.java    |  2 +-
 12 files changed, 63 insertions(+), 48 deletions(-)
d77c057dddbe5950566b741a4c5e62f308b80130

 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 13 ++-
 .../kafka/admin/ResetConsumerGroupOffsetTest.scala | 96 +++++++++-------------
 2 files changed, 47 insertions(+), 62 deletions(-)
5b99a288cd2d4461380b041067768ee6c1b2efc7

 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 13 ++-
 .../kafka/admin/ResetConsumerGroupOffsetTest.scala | 96 +++++++++-------------
 2 files changed, 47 insertions(+), 62 deletions(-)
99eebc840485d5b3352bc9e2f9230a33303cc080

 tests/kafkatest/benchmarks/streams/streams_simple_benchmark_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3b7e104559211d8104eb6d1493b6cdb5ec93de3a

 tests/kafkatest/services/zookeeper.py | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)
e47f2d3c468413e5671cf46b296aa50d7c8fa512

 .../org/apache/kafka/common/network/Selector.java  |  6 +-
 .../apache/kafka/common/network/SelectorTest.java  | 73 ++++++++++++++++++----
 2 files changed, 65 insertions(+), 14 deletions(-)
ea21752a79f3e843f0c2a74ea093a8793e42edb4

 .../org/apache/kafka/common/network/Selector.java  |  7 +-
 .../apache/kafka/common/network/SelectorTest.java  | 89 +++++++++++++++++-----
 2 files changed, 75 insertions(+), 21 deletions(-)
ff50cf9ea1df522d76bb42303d78578a2f0702ec

 .../kafka/connect/runtime/WorkerSinkTask.java      | 114 +++++---
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 300 ++++++++++++++++++++-
 2 files changed, 368 insertions(+), 46 deletions(-)
b78d7ba5d58fa77b831244444eef005a62883f9b

 .../org/apache/kafka/streams/KafkaStreams.java     |   2 +-
 .../streams/processor/internals/AbstractTask.java  |  46 +-
 .../streams/processor/internals/AssignedTasks.java | 440 +++++++++++++++++++
 .../processor/internals/ChangelogReader.java       |   9 +-
 .../processor/internals/PartitionGroup.java        |   1 -
 .../processor/internals/ProcessorStateManager.java |  59 ++-
 .../streams/processor/internals/StandbyTask.java   |  25 +-
 .../streams/processor/internals/StateRestorer.java |   1 +
 .../processor/internals/StoreChangelogReader.java  | 160 ++++---
 .../streams/processor/internals/StreamTask.java    |  34 +-
 .../streams/processor/internals/StreamThread.java  | 380 +++++------------
 .../kafka/streams/processor/internals/Task.java    |  14 +
 .../streams/processor/internals/TaskAction.java    |  22 +
 .../streams/processor/internals/TaskManager.java   | 445 ++++++--------------
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   2 +-
 .../streams/integration/ResetIntegrationTest.java  |   8 +-
 .../integration/RestoreIntegrationTest.java        | 191 +++++++++
 .../processor/internals/AbstractTaskTest.java      |  68 ++-
 .../processor/internals/AssignedTasksTest.java     | 412 ++++++++++++++++++
 .../internals/ProcessorStateManagerTest.java       |  31 --
 .../processor/internals/StandbyTaskTest.java       |   9 +-
 .../processor/internals/StreamTaskTest.java        |  17 +-
 .../processor/internals/StreamThreadTest.java      | 279 ++++--------
 .../processor/internals/TaskManagerTest.java       | 467 ++++++++++++++++-----
 .../StreamThreadStateStoreProviderTest.java        |   2 +
 .../org/apache/kafka/test/MockChangelogReader.java |   7 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   1 +
 27 files changed, 2043 insertions(+), 1089 deletions(-)
fa2751e4ad5e37f37db0e8e33418c332b170b743

 core/src/main/scala/kafka/log/LogManager.scala     | 16 ++++-----
 core/src/main/scala/kafka/log/LogSegment.scala     | 11 ++++++
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 39 +++++++++++++++++++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  4 +--
 4 files changed, 54 insertions(+), 16 deletions(-)
343a8ef99cbc23e27ada8eb5f8c1b752067a7e41

 .../org/apache/kafka/streams/KafkaStreams.java     | 79 ++++++++++++----------
 .../processor/internals/GlobalStreamThread.java    | 30 ++++----
 .../streams/processor/internals/StreamThread.java  | 49 +++++++-------
 3 files changed, 84 insertions(+), 74 deletions(-)
3615ef730caeab3f79874c8e2acb9f7e0e9cff82

 core/src/main/scala/kafka/log/LogManager.scala     | 15 ++++-----
 core/src/main/scala/kafka/log/LogSegment.scala     | 11 ++++++
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 39 +++++++++++++++++++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  4 +--
 4 files changed, 53 insertions(+), 16 deletions(-)
742a86839142c6e94ea5e51a63259844a4b08738

 .../org/apache/kafka/common/utils/AppInfoParser.java   | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
6cf92a253b7102c18547481387df4db17853267e

 .../org/apache/kafka/common/utils/AppInfoParser.java   | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
ecea150bdeb7cb98f1aa32eb2cf8ac4116e28f74

 docs/streams/developer-guide.html | 129 ++++++++++++++++++++++++++++++++++----
 1 file changed, 117 insertions(+), 12 deletions(-)
ee8e9349b22277ec69bf831dda66cfc6e767df14

 .../state/internals/CachingWindowStore.java        |  52 +++---
 .../internals/ChangeLoggingWindowBytesStore.java   |  82 +++++++++
 .../MergedSortedCacheWindowStoreIterator.java      |  18 +-
 ...rgedSortedCacheWindowStoreKeyValueIterator.java |  24 +--
 .../state/internals/MeteredWindowStore.java        | 134 +++++++++++++++
 .../internals/MeteredWindowStoreIterator.java      |  77 +++++++++
 .../internals/MeteredWindowedKeyValueIterator.java |  84 +++++++++
 .../internals/RocksDBWindowStoreSupplier.java      |  40 +++--
 .../state/internals/CachingWindowStoreTest.java    | 168 ++++++++++--------
 ...dSortedCacheWrappedWindowStoreIteratorTest.java |  10 +-
 ...acheWrappedWindowStoreKeyValueIteratorTest.java |  45 +++--
 .../state/internals/MeteredWindowStoreTest.java    | 189 +++++++++++++++++++++
 .../internals/RocksDBWindowStoreSupplierTest.java  |  16 +-
 .../state/internals/RocksDBWindowStoreTest.java    |   5 -
 14 files changed, 769 insertions(+), 175 deletions(-)
0b0819ba057bdb1e4d0d16745491aad523cab399

 .../apache/kafka/clients/CommonClientConfigs.java  |  4 ++--
 .../org/apache/kafka/streams/StreamsBuilder.java   | 24 +++++++++++-----------
 .../apache/kafka/streams/TopologyDescription.java  |  2 +-
 .../kafka/streams/kstream/ForeachAction.java       |  1 -
 4 files changed, 15 insertions(+), 16 deletions(-)
57dbe39ae1e8312c5e0e6603061d2816a8c05198

 tests/kafkatest/services/console_consumer.py            |  7 ++++---
 tests/kafkatest/services/kafka/config.py                |  2 +-
 tests/kafkatest/services/kafka/kafka.py                 | 17 +++++++++--------
 tests/kafkatest/services/monitor/jmx.py                 | 16 +++++++++-------
 .../services/performance/producer_performance.py        |  3 ++-
 tests/kafkatest/services/templates/zookeeper.properties |  2 +-
 tests/kafkatest/services/zookeeper.py                   | 17 ++++++++++-------
 7 files changed, 36 insertions(+), 28 deletions(-)
b4f3345b5188c134cdf09cb067053b44976b2b0f

 .../scala/kafka/log/ProducerStateManager.scala     | 61 ++++++++++++----------
 .../unit/kafka/log/ProducerStateManagerTest.scala  | 58 ++++++++++++++++++++
 2 files changed, 91 insertions(+), 28 deletions(-)
bf3bfd6749610eb49a4e47bdda2e667ca7458ff2

 .../scala/kafka/log/ProducerStateManager.scala     | 61 ++++++++++++----------
 .../unit/kafka/log/ProducerStateManagerTest.scala  | 58 ++++++++++++++++++++
 2 files changed, 91 insertions(+), 28 deletions(-)
8a5a84dc67e16f6ff77cc30454682b0ad6e5a878

 clients/src/test/java/org/apache/kafka/common/utils/ShellTest.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
fbd41d64d12f1775959a2804f1db9fbc8fef51fa

 tests/kafkatest/services/console_consumer.py       |  2 +-
 tests/kafkatest/services/kafka/kafka.py            | 44 ++++++++++++----------
 .../services/performance/consumer_performance.py   |  2 +-
 .../services/performance/end_to_end_latency.py     |  2 +-
 tests/kafkatest/services/security/kafka_acls.py    |  6 +--
 .../templates/mirror_maker_consumer.properties     |  2 +-
 tests/kafkatest/services/zookeeper.py              | 18 +++++++--
 tests/kafkatest/tests/client/quota_test.py         |  2 +-
 .../tests/core/security_rolling_upgrade_test.py    |  4 +-
 tests/kafkatest/tests/core/upgrade_test.py         | 16 ++------
 .../tests/core/zookeeper_security_upgrade_test.py  |  2 +-
 11 files changed, 54 insertions(+), 46 deletions(-)
26c65953ede2b449d7165f2d04453bc00dd29c20

 core/src/main/scala/kafka/log/LogConfig.scala | 4 ++++
 1 file changed, 4 insertions(+)
6896f1ddb7650f42630aef8c67c8b61866e9fc00

 .../kafka/clients/consumer/KafkaConsumer.java      |  81 +++--
 .../consumer/internals/AbstractCoordinator.java    |  84 +++--
 .../consumer/internals/ConsumerCoordinator.java    | 148 ++++----
 .../consumer/internals/ConsumerNetworkClient.java  |  35 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  10 +-
 .../org/apache/kafka/common/utils/LogContext.java  | 381 +++++++++++++++++++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  11 +-
 .../internals/AbstractCoordinatorTest.java         |   7 +-
 .../internals/ConsumerCoordinatorTest.java         |   4 +-
 .../internals/ConsumerNetworkClientTest.java       |  15 +-
 .../clients/consumer/internals/FetcherTest.java    |   8 +-
 .../runtime/distributed/WorkerCoordinator.java     |  12 +-
 .../runtime/distributed/WorkerGroupMember.java     |  24 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |   9 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |   3 +-
 15 files changed, 628 insertions(+), 204 deletions(-)
ed96523a2c763b48399a9720dcce0af44f5fc1a1

 build.gradle                                       |  38 ++-
 checkstyle/import-control.xml                      |   2 -
 .../security/plain/PlainSaslServerProvider.java    |   3 +-
 .../security/scram/ScramCredentialUtils.java       |  15 +-
 .../kafka/common/security/scram/ScramMessages.java |  19 +-
 .../security/scram/ScramSaslClientProvider.java    |   3 +-
 .../security/scram/ScramSaslServerProvider.java    |   3 +-
 .../java/org/apache/kafka/common/utils/Base64.java | 261 +++++++++++++++++++++
 .../java/org/apache/kafka/common/utils/Crc32C.java |   4 +-
 .../java/org/apache/kafka/common/utils/Java.java   |   3 +
 .../java/org/apache/kafka/common/utils/Utils.java  |  12 +-
 .../authenticator/TestDigestLoginModule.java       |   3 +-
 .../common/security/scram/ScramFormatterTest.java  |   9 +-
 .../common/security/scram/ScramMessagesTest.java   |  14 +-
 .../test/java/org/apache/kafka/test/TestUtils.java |   4 +-
 core/src/main/scala/kafka/Kafka.scala              |   3 +-
 .../src/main/scala/kafka/admin/ConfigCommand.scala |   3 +-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |   4 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |   3 +-
 .../scala/kafka/admin/ZkSecurityMigrator.scala     |   2 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |   2 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   2 +-
 .../scala/kafka/controller/KafkaController.scala   |   2 +-
 .../main/scala/kafka/javaapi/TopicMetadata.scala   |   1 -
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 core/src/main/scala/kafka/log/AbstractIndex.scala  |  12 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |   6 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |   5 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    |   4 +-
 core/src/main/scala/kafka/log/OffsetMap.scala      |   2 +-
 .../scala/kafka/log/ProducerStateManager.scala     |   4 +-
 core/src/main/scala/kafka/log/TimeIndex.scala      |   2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   2 +-
 core/src/main/scala/kafka/message/Message.scala    |   4 +-
 .../main/scala/kafka/producer/ProducerPool.scala   |   3 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |   2 +-
 .../main/scala/kafka/security/auth/Operation.scala |   2 -
 .../scala/kafka/security/auth/PermissionType.scala |   2 -
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |   1 -
 .../main/scala/kafka/server/ConfigHandler.scala    |   4 +-
 .../main/scala/kafka/server/DelayedOperation.scala |   2 +-
 .../scala/kafka/server/DelayedOperationKey.scala   |   1 -
 core/src/main/scala/kafka/server/KafkaConfig.scala |   5 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |   9 +-
 .../main/scala/kafka/tools/ConsoleProducer.scala   |   5 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   4 +-
 .../main/scala/kafka/tools/ExportZkOffsets.scala   |   2 +-
 .../main/scala/kafka/tools/GetOffsetShell.scala    |   4 +-
 .../main/scala/kafka/tools/ImportZkOffsets.scala   |   1 -
 core/src/main/scala/kafka/tools/JmxTool.scala      |  10 +-
 .../scala/kafka/tools/ProducerPerformance.scala    |   5 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   2 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  13 +-
 core/src/main/scala/kafka/utils/Implicits.scala    |  49 ++++
 .../main/scala/kafka/utils/ReplicationUtils.scala  |   1 -
 core/src/main/scala/kafka/utils/ToolsUtils.scala   |   9 +-
 .../kafka/api/AdminClientIntegrationTest.scala     |   8 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |   2 +-
 .../kafka/api/EndToEndClusterIdTest.scala          |   3 +-
 .../kafka/api/IntegrationTestHarness.scala         |   7 +-
 .../integration/kafka/api/ProducerBounceTest.scala |   3 +-
 .../kafka/api/SaslEndToEndAuthorizationTest.scala  |   3 +-
 .../api/SaslSslAdminClientIntegrationTest.scala    |   2 +-
 ...ListenersWithSameSecurityProtocolBaseTest.scala |   3 +-
 .../other/kafka/ReplicationQuotasTestRig.scala     |   3 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   4 +-
 .../scala/unit/kafka/admin/ConfigCommandTest.scala |   2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   3 +-
 .../TransactionMarkerChannelManagerTest.scala      |   6 +-
 .../log/AbstractLogCleanerIntegrationTest.scala    |   3 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   |   4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  29 +--
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |   8 +-
 73 files changed, 505 insertions(+), 182 deletions(-)
3e22c1c04a8751d8b6bd4cefa88f8f33ec2de8e0

 .../tests/streams/streams_broker_bounce_test.py    | 52 ++++++++++++++++++++--
 1 file changed, 48 insertions(+), 4 deletions(-)
75c78e9692a479e2c94dbd08e564f64faedd2071

 .../state/internals/CompositeKeyValueIterator.java | 74 ++++++++++++++++++++++
 .../internals/CompositeReadOnlyKeyValueStore.java  | 66 ++-----------------
 .../internals/CompositeReadOnlySessionStore.java   | 37 +++++------
 .../internals/CompositeReadOnlyWindowStore.java    | 53 ++++++----------
 .../state/internals/NextIteratorFunction.java      | 24 +++++++
 .../CompositeReadOnlySessionStoreTest.java         | 29 +++++++++
 .../CompositeReadOnlyWindowStoreTest.java          | 29 +++++++++
 .../state/internals/RocksDBSessionStoreTest.java   |  2 +-
 .../kafka/test/ReadOnlySessionStoreStub.java       |  4 +-
 9 files changed, 197 insertions(+), 121 deletions(-)
3457c4761ae09ef2befc141278fe489900cac470

 core/src/main/scala/kafka/cluster/Partition.scala | 14 ++++++--------
 1 file changed, 6 insertions(+), 8 deletions(-)
a4720b25a372790b26a0b00fa18eb78f830b1311

 .../org/apache/kafka/common/utils/ShellTest.java   | 28 ++++++++++++++++++++++
 1 file changed, 28 insertions(+)
520e651d532558b346d08388cb9aa0ac6e156ece

 tests/kafkatest/services/console_consumer.py       |  2 +-
 tests/kafkatest/services/kafka/kafka.py            | 48 ++++++++++++----------
 .../services/performance/consumer_performance.py   |  2 +-
 .../services/performance/end_to_end_latency.py     |  2 +-
 tests/kafkatest/services/security/kafka_acls.py    |  6 +--
 .../templates/mirror_maker_consumer.properties     |  2 +-
 tests/kafkatest/services/zookeeper.py              | 18 ++++++--
 tests/kafkatest/tests/client/quota_test.py         |  2 +-
 .../tests/core/security_rolling_upgrade_test.py    |  4 +-
 tests/kafkatest/tests/core/upgrade_test.py         | 16 ++------
 .../tests/core/zookeeper_security_upgrade_test.py  |  2 +-
 11 files changed, 56 insertions(+), 48 deletions(-)
334a30bcfffc3759aeded08f2089cea4ed6e9937

 .../java/org/apache/kafka/clients/KafkaClient.java |  2 +-
 .../org/apache/kafka/clients/NetworkClient.java    |  8 +++
 .../kafka/clients/consumer/KafkaConsumer.java      | 16 +++++
 .../consumer/internals/AbstractCoordinator.java    | 10 ++--
 .../consumer/internals/ConsumerCoordinator.java    |  5 ++
 .../consumer/internals/ConsumerNetworkClient.java  | 15 ++++-
 .../apache/kafka/clients/NetworkClientTest.java    | 14 +++--
 .../internals/ConsumerCoordinatorTest.java         | 68 ++++++++++++++++++++++
 .../internals/ConsumerNetworkClientTest.java       | 22 +++++++
 9 files changed, 147 insertions(+), 13 deletions(-)
efe4f6540a3c26371c88b3f956bbd4abfe9dc52e

 .../streams/state/internals/RocksDBStore.java      | 37 ++++++++++--
 .../kafka/streams/state/internals/Segment.java     |  2 -
 .../streams/state/internals/RocksDBStoreTest.java  | 66 +++++++++++++++++-----
 3 files changed, 83 insertions(+), 22 deletions(-)
517bcc49161b81521819c718616279a243814458

 .../org/apache/kafka/streams/KafkaStreams.java     | 356 +++++++++++++++------
 .../org/apache/kafka/streams/StreamsConfig.java    |   6 +-
 .../streams/kstream/internals/SessionKeySerde.java |   6 +-
 .../kafka/streams/processor/TopologyBuilder.java   |   2 +-
 .../processor/internals/GlobalStreamThread.java    | 131 +++++++-
 .../streams/processor/internals/StreamThread.java  | 153 +++++----
 .../internals/ThreadStateTransitionValidator.java  |  24 ++
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 173 +++++++++-
 .../KStreamAggregationDedupIntegrationTest.java    |  12 +-
 .../KStreamAggregationIntegrationTest.java         |  24 +-
 .../internals/GlobalStreamThreadTest.java          |  47 ++-
 .../processor/internals/StreamThreadTest.java      | 116 +++++--
 .../internals/StreamsMetadataStateTest.java        |   2 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   2 +-
 14 files changed, 818 insertions(+), 236 deletions(-)
bdeb98c866628a8a0787c3061b6473d9b6e5bbbe

 .../kafka/connect/runtime/WorkerSinkTask.java      | 19 +++---
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 68 +++++++++++++++++++++-
 2 files changed, 79 insertions(+), 8 deletions(-)
72eacbea5b831096a6cc9a4fa42401bc74a88a80

 .../kafka/connect/runtime/WorkerSinkTask.java      | 19 +++---
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 68 +++++++++++++++++++++-
 2 files changed, 79 insertions(+), 8 deletions(-)
eda1bf6c13c9966c3928b0df61f4786106395139

 .../src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
bf34a5b74035a90a7461ac8c8a209da450c0346b

 .../src/main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b268322ed789736dd1199849e3d3ff100ddc270e

 .../org/apache/kafka/streams/KafkaStreams.java     |   6 +-
 .../streams/processor/internals/AbstractTask.java  |  63 +-
 .../streams/processor/internals/AssignedTasks.java | 428 ++++++++++++
 .../processor/internals/ChangelogReader.java       |   6 +-
 .../processor/internals/ProcessorStateManager.java |  66 +-
 .../streams/processor/internals/StandbyTask.java   |  37 +-
 .../processor/internals/StoreChangelogReader.java  | 152 +++--
 .../streams/processor/internals/StreamTask.java    |  32 +-
 .../streams/processor/internals/StreamThread.java  | 724 ++++++---------------
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   2 +-
 .../streams/integration/ResetIntegrationTest.java  |   8 +-
 .../processor/internals/AbstractTaskTest.java      |  82 ++-
 .../processor/internals/AssignedTasksTest.java     | 426 ++++++++++++
 .../internals/ProcessorStateManagerTest.java       |  32 +-
 .../processor/internals/StandbyTaskTest.java       |   7 +-
 .../internals/StoreChangelogReaderTest.java        |  21 +
 .../processor/internals/StreamTaskTest.java        |  16 +-
 .../processor/internals/StreamThreadTest.java      | 414 ++++++------
 .../StreamThreadStateStoreProviderTest.java        |   2 +
 .../org/apache/kafka/test/MockChangelogReader.java |  10 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   1 +
 21 files changed, 1628 insertions(+), 907 deletions(-)
22c9a8cb48588462bac5735adf0cc3738419a164

 checkstyle/suppressions.xml                        |   4 +-
 .../kafka/connect/runtime/WorkerSinkTask.java      | 106 ++++++-----
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 200 ++++++++++++++++++++-
 3 files changed, 263 insertions(+), 47 deletions(-)
3b1cea60e909e579e54775fc479397ddbeba95eb

 checkstyle/suppressions.xml                        |   4 +-
 .../kafka/connect/runtime/WorkerSinkTask.java      | 102 +++++++----
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 200 ++++++++++++++++++++-
 3 files changed, 262 insertions(+), 44 deletions(-)
a1a1186064bc355b0f360bfb8679fae740b7d32f

 README.md                                          |  30 ++
 build.gradle                                       |   3 +-
 docs/documentation/streams/tutorial.html           |  19 +
 docs/js/templateData.js                            |   2 +-
 docs/streams/quickstart.html                       |  28 +-
 docs/streams/tutorial.html                         | 526 +++++++++++++++++++++
 docs/toc.html                                      |   9 +-
 .../kafka/streams/examples/pipe/PipeDemo.java      |   9 +-
 .../streams/examples/wordcount/WordCountDemo.java  |  18 +-
 .../examples/wordcount/WordCountProcessorDemo.java |  11 +-
 streams/quickstart/java/pom.xml                    |  36 ++
 .../META-INF/maven/archetype-metadata.xml          |  34 ++
 .../src/main/resources/archetype-resources/pom.xml | 136 ++++++
 .../src/main/java/LineSplit.java                   |  84 ++++
 .../archetype-resources/src/main/java/Pipe.java    |  65 +++
 .../src/main/java/WordCount.java                   |  95 ++++
 .../src/main/resources/log4j.properties            |  19 +
 .../resources/projects/basic/archetype.properties  |  18 +
 .../src/test/resources/projects/basic/goal.txt     |   1 +
 streams/quickstart/pom.xml                         | 101 ++++
 20 files changed, 1203 insertions(+), 41 deletions(-)
77b81c02b98b979ca6ecbfcfe4f620f4ab7ee240

 .../org/apache/kafka/streams/KafkaStreams.java     | 373 ++++++++++++++-------
 .../processor/internals/GlobalStreamThread.java    | 132 +++++++-
 .../streams/processor/internals/StreamThread.java  |  97 ++++--
 .../internals/ThreadStateTransitionValidator.java  |  24 ++
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 166 ++++++++-
 .../internals/GlobalStreamThreadTest.java          |  46 ++-
 .../processor/internals/StreamThreadTest.java      | 127 ++++---
 7 files changed, 744 insertions(+), 221 deletions(-)
869ef5579f00661a5d68e92f09e088e7ed884189

 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  43 +++++---
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 108 ++++++++++++++++++---
 2 files changed, 123 insertions(+), 28 deletions(-)
c0f7a7705851eec4a77d3e42cf6bf2546c07ffa8

 .../internals/StreamsKafkaClientTest.java          | 48 ++++++++++++++++++++++
 1 file changed, 48 insertions(+)
21ea4b1d2a1b99aa804bd4461015abaf31673923

 .../org/apache/kafka/common/network/Selector.java  |  15 ++-
 .../main/scala/kafka/network/SocketServer.scala    |  50 +++++---
 .../unit/kafka/network/SocketServerTest.scala      | 136 ++++++++++++++++++++-
 3 files changed, 181 insertions(+), 20 deletions(-)
fb47e213ead7c23abe57c258bdf249682d47f8ae

 .../kafka/common/network/SaslChannelBuilder.java   |   2 +-
 .../authenticator/SaslServerAuthenticator.java     |  22 ++--
 .../authenticator/SaslServerAuthenticatorTest.java | 119 +++++++++++++++++++++
 3 files changed, 132 insertions(+), 11 deletions(-)
8265a43897b3da88839df061ce22559820087ad9

 .../kafka/common/network/SaslChannelBuilder.java   |   2 +-
 .../authenticator/SaslServerAuthenticator.java     |  22 ++--
 .../authenticator/SaslServerAuthenticatorTest.java | 119 +++++++++++++++++++++
 3 files changed, 132 insertions(+), 11 deletions(-)
e19c37e5914b1fa64befdfdf24edbf2415f8cdb3

 .../streams/kstream/internals/TupleForwarder.java  |  21 +-
 .../state/internals/CachingKeyValueStore.java      |  59 ++--
 .../state/internals/InnerMeteredKeyValueStore.java | 323 +++++++++++++++++++++
 ...ergedSortedCacheKeyValueBytesStoreIterator.java |  59 ++++
 .../MergedSortedCacheKeyValueStoreIterator.java    |  65 -----
 .../state/internals/MeteredKeyValueBytesStore.java | 154 ++++++++++
 .../state/internals/MeteredKeyValueStore.java      | 216 +++-----------
 .../internals/RocksDBKeyValueStoreSupplier.java    |  35 +--
 .../streams/state/internals/WrappedStateStore.java |  15 +-
 .../state/internals/CachingKeyValueStoreTest.java  | 115 ++++----
 ...dSortedCacheKeyValueBytesStoreIteratorTest.java | 182 ++++++++++++
 ...MergedSortedCacheKeyValueStoreIteratorTest.java | 182 ------------
 .../internals/MeteredKeyValueBytesStoreTest.java   | 202 +++++++++++++
 .../RocksDBKeyValueStoreSupplierTest.java          |  10 +-
 14 files changed, 1094 insertions(+), 544 deletions(-)
f68d6720135c9e305c2e6116e1e1b3d45d6acc59

 .../main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java | 7 ++++++-
 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 4 ++--
 .../main/java/org/apache/kafka/clients/producer/KafkaProducer.java | 4 ++--
 3 files changed, 10 insertions(+), 5 deletions(-)
f4dc5ac15ca120d8240ac3b8ba28139ccb26cf91

 .../main/java/org/apache/kafka/clients/admin/KafkaAdminClient.java | 7 ++++++-
 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 4 ++--
 .../main/java/org/apache/kafka/clients/producer/KafkaProducer.java | 4 ++--
 3 files changed, 10 insertions(+), 5 deletions(-)
b6102cf4b2c3c56850593c5d88612cb9c4ac704f

 docs/streams/tutorial.html | 1 +
 docs/toc.html              | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)
d2774e302fa528b4fe7b7db39f69cf679753f348

 README.md                                          |  30 +
 build.gradle                                       |   3 +-
 docs/documentation/streams/tutorial.html           |  19 +
 docs/js/templateData.js                            |   6 +-
 docs/streams/quickstart.html                       |  28 +-
 docs/streams/tutorial.html                         | 630 +++++++++++++++++++++
 docs/toc.html                                      |  11 +-
 .../kafka/streams/examples/pipe/PipeDemo.java      |   9 +-
 .../examples/temperature/TemperatureDemo.java      |   5 +-
 .../streams/examples/wordcount/WordCountDemo.java  |  18 +-
 .../examples/wordcount/WordCountProcessorDemo.java |   9 +-
 streams/quickstart/java/pom.xml                    |  36 ++
 .../META-INF/maven/archetype-metadata.xml          |  34 ++
 .../src/main/resources/archetype-resources/pom.xml | 136 +++++
 .../src/main/java/LineSplit.java                   |  86 +++
 .../archetype-resources/src/main/java/Pipe.java    |  67 +++
 .../src/main/java/WordCount.java                   |  97 ++++
 .../src/main/resources/log4j.properties            |  19 +
 .../resources/projects/basic/archetype.properties  |  18 +
 .../src/test/resources/projects/basic/goal.txt     |   1 +
 streams/quickstart/pom.xml                         | 101 ++++
 21 files changed, 1317 insertions(+), 46 deletions(-)
2a4eeb1c6f32c84ea73058bc502b10c2232b011f

 build.gradle                                       |   1 +
 .../org/apache/kafka/streams/KafkaStreams.java     |  48 ++-
 .../processor/internals/StateDirectory.java        |  69 ++--
 .../streams/processor/internals/StreamThread.java  |  16 +-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  55 +++
 .../integration/RegexSourceIntegrationTest.java    |   3 +-
 .../processor/internals/StateDirectoryTest.java    |  57 +++
 .../internals/StreamPartitionAssignorTest.java     | 209 +++++++++--
 .../processor/internals/StreamThreadTest.java      | 392 +++++++++------------
 .../StreamThreadStateStoreProviderTest.java        |   3 +-
 10 files changed, 536 insertions(+), 317 deletions(-)
3e69ce80157eb6a5e6dd05e3be522b5208a41bc5

 .../org/apache/kafka/streams/KafkaStreams.java     |   51 +-
 .../streams/processor/internals/AbstractTask.java  |   16 +-
 .../processor/internals/ChangelogReader.java       |    5 +
 .../streams/processor/internals/StandbyTask.java   |   32 +-
 .../processor/internals/StoreChangelogReader.java  |    6 +
 .../internals/StreamPartitionAssignor.java         |   50 +-
 .../streams/processor/internals/StreamTask.java    |   20 +-
 .../streams/processor/internals/StreamThread.java  | 1038 +++++++----------
 .../processor/internals/StreamsMetadataState.java  |    2 +-
 .../kafka/streams/processor/internals/Task.java    |   67 ++
 .../streams/processor/internals/TaskManager.java   |  524 +++++++++
 .../processor/internals/ThreadDataProvider.java    |   36 +
 .../internals/ThreadMetadataProvider.java          |   36 +
 .../org/apache/kafka/streams/state/HostInfo.java   |    3 +-
 .../internals/StreamThreadStateStoreProvider.java  |    4 +-
 .../integration/RegexSourceIntegrationTest.java    |  280 ++---
 .../processor/internals/AbstractTaskTest.java      |   43 +
 .../processor/internals/StandbyTaskTest.java       |   46 +
 .../internals/StreamPartitionAssignorTest.java     |  397 ++-----
 .../processor/internals/StreamTaskTest.java        |   92 +-
 .../processor/internals/StreamThreadTest.java      | 1222 +++-----------------
 .../processor/internals/TaskManagerTest.java       |  240 ++++
 .../StreamThreadStateStoreProviderTest.java        |   51 +-
 .../org/apache/kafka/test/MockChangelogReader.java |    5 +
 24 files changed, 2038 insertions(+), 2228 deletions(-)
b2b529522d0683b4c3f97be8ac92597048f45037

 docs/streams/developer-guide.html | 234 ++++++++++++++++++++++++++++++++------
 1 file changed, 200 insertions(+), 34 deletions(-)
8ffb1a1fedad4350dd0f0ce0dd52107f962ce428

 .../streams/state/internals/RocksDBStore.java      |  8 +-
 .../streams/state/internals/RocksDBStoreTest.java  | 89 ++++++++++++++++++++++
 2 files changed, 95 insertions(+), 2 deletions(-)
017a21c6044189abe40b2b8b09ba51447646136e

 core/src/main/scala/kafka/api/FetchRequest.scala   | 19 +-----------------
 .../scala/kafka/api/GroupCoordinatorRequest.scala  | 10 +---------
 .../main/scala/kafka/api/OffsetCommitRequest.scala | 12 +----------
 .../main/scala/kafka/api/OffsetFetchRequest.scala  | 23 ++--------------------
 core/src/main/scala/kafka/api/OffsetRequest.scala  | 13 +-----------
 .../src/main/scala/kafka/api/ProducerRequest.scala | 17 +---------------
 .../scala/kafka/api/TopicMetadataRequest.scala     | 12 +----------
 docs/upgrade.html                                  |  5 +++++
 8 files changed, 13 insertions(+), 98 deletions(-)
58125ced768fea76d278f70828fa9a23cbefdd82

 .../main/java/org/apache/kafka/streams/state/internals/ThreadCache.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
75b0f30c448c12199263e3d82708c2cb6817d702

 bin/kafka-run-class.sh | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)
23df2199d78d799851a797f9c90c74e3bbc464f5

 core/src/main/scala/kafka/api/FetchResponse.scala            | 2 ++
 core/src/main/scala/kafka/api/GroupCoordinatorRequest.scala  | 2 ++
 core/src/main/scala/kafka/api/GroupCoordinatorResponse.scala | 2 ++
 core/src/main/scala/kafka/api/OffsetCommitRequest.scala      | 2 ++
 core/src/main/scala/kafka/api/OffsetCommitResponse.scala     | 2 ++
 core/src/main/scala/kafka/api/OffsetFetchRequest.scala       | 2 ++
 core/src/main/scala/kafka/api/OffsetFetchResponse.scala      | 2 ++
 core/src/main/scala/kafka/api/OffsetRequest.scala            | 2 ++
 core/src/main/scala/kafka/api/OffsetResponse.scala           | 2 ++
 core/src/main/scala/kafka/api/ProducerRequest.scala          | 2 ++
 core/src/main/scala/kafka/api/ProducerResponse.scala         | 2 ++
 core/src/main/scala/kafka/api/TopicMetadataRequest.scala     | 2 ++
 core/src/main/scala/kafka/api/TopicMetadataResponse.scala    | 2 ++
 13 files changed, 26 insertions(+)
d2a2b80cc615429a14ccdf21a1bd6c5fd0b31728

 bin/kafka-run-class.sh | 5 +++++
 1 file changed, 5 insertions(+)
69d3d4aad6ce0678f592140501485893b68b20b1

 bin/kafka-run-class.sh          | 2 +-
 bin/windows/kafka-run-class.bat | 2 +-
 docs/upgrade.html               | 2 ++
 3 files changed, 4 insertions(+), 2 deletions(-)
889da45dd00af266ddf2154a062903bd0d4cad17

 tests/README.md | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
1ad74f5b760d16f3990a5024e717f4826278675d

 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  32 +++++-
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 111 ++++++++++++++++++++-
 2 files changed, 140 insertions(+), 3 deletions(-)
a75027429bf4eff786a62b1223d42db26c42ba20

 .../state/internals/InMemoryKeyValueStore.java     |  4 ++--
 .../state/internals/InMemoryKeyValueStoreTest.java | 24 ++++++++++++++++++++++
 2 files changed, 26 insertions(+), 2 deletions(-)
c35c4798139bc30e3a380311e45a22ba56fcc918

 .../state/internals/InMemoryKeyValueStore.java     |  4 ++--
 .../state/internals/InMemoryKeyValueStoreTest.java | 24 ++++++++++++++++++++++
 2 files changed, 26 insertions(+), 2 deletions(-)
a593db6a2b6c3511215008b6d3dd6bd77f84e8c4

 .../connect/runtime/SourceTaskOffsetCommitter.java |  6 +--
 .../kafka/connect/runtime/WorkerConnector.java     | 19 ++++----
 .../kafka/connect/runtime/WorkerSinkTask.java      | 54 +++++++++++-----------
 .../kafka/connect/runtime/WorkerSourceTask.java    | 46 +++++++++---------
 .../apache/kafka/connect/runtime/WorkerTask.java   |  6 +--
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |  2 +
 6 files changed, 66 insertions(+), 67 deletions(-)
d05112125614ded3febe7fe7ffcdfefd0dd2eb6f

 docs/images/streams-cache-and-commit-interval.png | Bin 0 -> 38648 bytes
 docs/streams/developer-guide.html                 | 175 ++++++++++++++++++++++
 2 files changed, 175 insertions(+)
3bc5ee7dd119864e0bbfc6bc095b2e0bc57c32b6

 .../org/apache/kafka/connect/util/TopicAdmin.java  | 10 +++---
 .../apache/kafka/connect/util/TopicAdminTest.java  | 15 +++------
 .../tests/connect/connect_distributed_test.py      | 36 ++++++++++++++++++++--
 3 files changed, 44 insertions(+), 17 deletions(-)
1a653c813c842c0b67f26fb119d7727e272cf834

 .../org/apache/kafka/connect/util/TopicAdmin.java  | 10 +++---
 .../apache/kafka/connect/util/TopicAdminTest.java  | 15 +++------
 .../tests/connect/connect_distributed_test.py      | 36 ++++++++++++++++++++--
 3 files changed, 44 insertions(+), 17 deletions(-)
d0be27b4e075ec604ed4636c5e7799513a52ef74

 tests/kafkatest/services/kafka/kafka.py | 10 ++++++++++
 1 file changed, 10 insertions(+)
b8cf976865f3559b4e5c45eeb261444cd1d7383f

 tests/kafkatest/services/kafka/kafka.py | 10 ++++++++++
 1 file changed, 10 insertions(+)
fb8edbdc6314411e0ed006a76e9658460a99208a

 build.gradle                                       | 20 ++++++++--------
 .../scala/kafka/security/minikdc/MiniKdc.scala     | 13 ++++++----
 .../kafka/message/MessageCompressionTest.scala     |  5 ++--
 gradle/dependencies.gradle                         | 28 +++++++++++++---------
 4 files changed, 38 insertions(+), 28 deletions(-)
649276abb284c4f71504e9f028c5ab1450849fae

 .../main/scala/kafka/tools/ConsumerPerformance.scala    |  2 ++
 core/src/main/scala/kafka/tools/PerfConfig.scala        | 17 -----------------
 .../main/scala/kafka/tools/ProducerPerformance.scala    | 15 +++++++++++++++
 .../scala/kafka/tools/SimpleConsumerPerformance.scala   |  2 ++
 4 files changed, 19 insertions(+), 17 deletions(-)
98d4a483382dacad280e0cd25f10bccca51328a5

 .../main/scala/kafka/coordinator/group/GroupMetadata.scala   | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
0bf34e7157319bdd12ae907788bc40c70f9c7ad0

 checkstyle/suppressions.xml                        |  2 +-
 .../kafka/clients/admin/KafkaAdminClient.java      | 36 ++++++++++----
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 57 ++++++++++++++++++++++
 .../clients/admin/MockKafkaAdminClientEnv.java     | 18 +++++--
 4 files changed, 99 insertions(+), 14 deletions(-)
c9ffab16228ecd5d931b58d93dfa3f49287d2909

 checkstyle/suppressions.xml                        |  2 +-
 .../kafka/clients/admin/KafkaAdminClient.java      | 36 ++++++++++----
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 57 ++++++++++++++++++++++
 .../clients/admin/MockKafkaAdminClientEnv.java     | 18 +++++--
 4 files changed, 99 insertions(+), 14 deletions(-)
2b663790733527488d7f33ebc47f383ff18b5a83

 tests/kafkatest/services/monitor/jmx.py | 1 +
 1 file changed, 1 insertion(+)
57770dd235a82994f296971079a97281be0a130b

 .../streams/state/internals/RocksDBStore.java      | 52 ++++++++++------
 .../streams/state/internals/RocksDBStoreTest.java  | 70 ++++++----------------
 2 files changed, 52 insertions(+), 70 deletions(-)
1f0ad0121e03a2e4f6c0cf3551b14c75085bd34f

 .../processor/internals/ProcessorStateManager.java | 27 +++++++--
 .../internals/CompositeRestoreListenerTest.java    | 26 ++------
 .../internals/ProcessorStateManagerTest.java       | 69 +++++++++++++++++++++-
 .../test/MockBatchingStateRestoreListener.java     | 48 +++++++++++++++
 4 files changed, 139 insertions(+), 31 deletions(-)
f15cdc73ddd06e0bf0f319b0d8ad8f63e80cf28d

 .../org/apache/kafka/tools/VerifiableConsumer.java |   3 +
 .../org/apache/kafka/tools/VerifiableProducer.java | 370 +++++++++++++--------
 2 files changed, 241 insertions(+), 132 deletions(-)
2010aa067ffb3adba1afd392d7da10f67e231eb8

 docs/images/streams-cache-and-commit-interval.png | Bin 0 -> 38648 bytes
 docs/streams/developer-guide.html                 | 175 ++++++++++++++++++++++
 2 files changed, 175 insertions(+)
557001f9f91bdb7679e889e3e62eeb3bac7f94c7

 .../clients/producer/internals/ProducerBatch.java  |  2 +-
 .../kafka/clients/producer/internals/Sender.java   |  2 +-
 .../producer/internals/ProducerBatchTest.java      | 40 ++++++++++++++++++++++
 3 files changed, 42 insertions(+), 2 deletions(-)
1cd86284e808e2846e94b312bb55141f6d216d51

 .../clients/producer/internals/ProducerBatch.java  |  2 +-
 .../kafka/clients/producer/internals/Sender.java   |  2 +-
 .../producer/internals/ProducerBatchTest.java      | 40 ++++++++++++++++++++++
 3 files changed, 42 insertions(+), 2 deletions(-)
9b327fb79ed00a88037dd67206e9f6c091dc8022

 tests/docker/run_tests.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
991ef411de5a85ddaa95c57400cd752bf6ec85f2

 tests/docker/run_tests.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1d291a4219656cd9f597432ff9d7f8a42900abdb

 tests/docker/run_tests.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d637c134c8d8ce729cdff4e152a6eee3846bafcb

 tests/docker/ducker-ak | 85 ++++++++++++++++++++++++++++++++++++++------------
 1 file changed, 65 insertions(+), 20 deletions(-)
70796c3ca3306943e74d2ca260f3f28707481985

 .../org/apache/kafka/common/requests/ControlledShutdownRequest.java  | 4 +---
 .../java/org/apache/kafka/common/requests/RequestResponseTest.java   | 5 +++++
 2 files changed, 6 insertions(+), 3 deletions(-)
22611aca9b33cc3db9362add785e44c7a3698ba3

 .../kafka/connect/transforms/ExtractField.java     | 15 +++++++------
 .../connect/transforms/util/Requirements.java      | 14 ++++++++++++
 .../kafka/connect/transforms/ExtractFieldTest.java | 26 ++++++++++++++++++++++
 3 files changed, 48 insertions(+), 7 deletions(-)
b4f2e72892ab38f7bedd15f03fa0ea67269be3df

 docs/introduction.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
5704d8f05f0d271b62d0170ba5a8fbfceacb4304

 docs/introduction.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
c1690da071c00ef8d6cca7b3bed50a0e5e2c3332

 .../common/ZkNodeChangeNotificationListener.scala  |  6 ++--
 .../consumer/ZookeeperConsumerConnector.scala      |  8 ++---
 .../consumer/ZookeeperTopicEventWatcher.scala      | 14 ++++----
 .../scala/kafka/controller/KafkaController.scala   | 38 +++++++++++-----------
 .../main/scala/kafka/server/KafkaHealthcheck.scala |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 20 +++++++++++-
 7 files changed, 54 insertions(+), 36 deletions(-)
c06fa5adaaf7fe940c314a0be97e122e921de970

 .../kstream/internals/KStreamPrintTest.java        | 103 ++++++++++-----------
 1 file changed, 50 insertions(+), 53 deletions(-)
332a8129d3769163c622688bc7bf53a435f44b34

 core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala | 8 +++++++-
 core/src/main/scala/kafka/tools/ConsumerPerformance.scala  | 9 ++++++++-
 2 files changed, 15 insertions(+), 2 deletions(-)
5766f212db961470f30125a813c1edcc1fe75f6c

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)
dd712f14badb7f116eb63d3a59c2ea9c22d235eb

 .../common/ZkNodeChangeNotificationListener.scala  |  8 +++++---
 .../ZkNodeChangeNotificationListenerTest.scala     | 24 +++++++++++++++-------
 2 files changed, 22 insertions(+), 10 deletions(-)
62f03ba2cd27880562dbf85c5ef6699d25bc5b43

 .../common/ZkNodeChangeNotificationListener.scala  |  8 +++++---
 .../ZkNodeChangeNotificationListenerTest.scala     | 24 +++++++++++++++-------
 2 files changed, 22 insertions(+), 10 deletions(-)
e7f7d4093968d8de494e371a6d3c85e555332cbb

 .gitignore                                         |  4 +--
 .../scala/kafka/controller/KafkaController.scala   | 32 +++++++++++++++++++---
 .../scala/unit/kafka/metrics/MetricsTest.scala     | 11 ++++++++
 3 files changed, 41 insertions(+), 6 deletions(-)
5a516fb28e6a2af559fcbac5df12f048a5916fc6

 .../org/apache/kafka/common/protocol/Protocol.java | 46 +++++++----
 .../common/requests/ControlledShutdownRequest.java |  6 +-
 .../kafka/common/requests/FetchResponse.java       |  6 +-
 .../kafka/common/requests/RequestHeader.java       | 76 ++++++++++++------
 .../apache/kafka/clients/NodeApiVersionsTest.java  | 32 +++-----
 .../kafka/common/requests/RequestHeaderTest.java   | 76 ++++++++++++++++++
 .../kafka/common/requests/RequestResponseTest.java | 35 +--------
 .../test/java/org/apache/kafka/test/TestUtils.java |  8 ++
 .../kafka/api/ControlledShutdownRequest.scala      | 84 --------------------
 .../kafka/api/ControlledShutdownResponse.scala     | 72 -----------------
 .../scala/kafka/common/TopicAndPartition.scala     |  2 +
 .../main/scala/kafka/network/RequestChannel.scala  | 65 +++++-----------
 core/src/main/scala/kafka/server/KafkaApis.scala   | 74 +++++++-----------
 .../scala/kafka/server/KafkaRequestHandler.scala   |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 90 ++--------------------
 .../unit/kafka/network/SocketServerTest.scala      |  4 +-
 16 files changed, 247 insertions(+), 431 deletions(-)
0b6e38a2ced23f04908e9a65505f6e1b5020d6c9

 README.md    |  1 +
 build.gradle | 14 +++++++++-----
 2 files changed, 10 insertions(+), 5 deletions(-)
44d4b8ebc5fb555ecf92353a4ec99bb3a92c7320

 README.md    |  1 +
 build.gradle | 14 +++++++++-----
 2 files changed, 10 insertions(+), 5 deletions(-)
613971f8d401e42f985e0942927348dcee640b75

 README.md    |  1 +
 build.gradle | 14 +++++++++-----
 2 files changed, 10 insertions(+), 5 deletions(-)
13deb84dcf4b3e583997dbd05a0e25840f024375

 .../scala/kafka/network/ConnectionConfig.scala     | 27 -----------------
 core/src/main/scala/kafka/network/Handler.scala    | 35 ----------------------
 .../main/scala/kafka/network/RequestChannel.scala  | 31 ++++++++++++-------
 .../main/scala/kafka/network/SocketServer.scala    |  7 ++---
 .../unit/kafka/network/SocketServerTest.scala      |  2 +-
 .../scala/unit/kafka/server/KafkaApisTest.scala    |  3 +-
 6 files changed, 26 insertions(+), 79 deletions(-)
3eaa325692d3ecc411090560bc84c7229437ec1f

 docs/ops.html                                      | 321 ++++++++++++++++++---
 .../streams/processor/internals/ProcessorNode.java |  28 +-
 .../streams/processor/internals/StreamTask.java    |   3 +-
 .../processor/internals/StreamsMetricsImpl.java    |  60 ++--
 .../state/internals/CachingKeyValueStore.java      |   2 +-
 .../state/internals/MeteredKeyValueStore.java      |  32 +-
 .../internals/MeteredSegmentedBytesStore.java      |  23 +-
 .../kafka/streams/state/internals/NamedCache.java  |  41 ++-
 .../kafka/streams/state/internals/ThreadCache.java |  32 ++
 .../processor/internals/ProcessorNodeTest.java     |  45 ++-
 .../processor/internals/StreamTaskTest.java        |  29 +-
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |   3 +-
 ...dSortedCacheWrappedWindowStoreIteratorTest.java |   2 +-
 .../streams/state/internals/NamedCacheTest.java    |  32 +-
 .../streams/state/internals/ThreadCacheTest.java   | 103 +++----
 15 files changed, 550 insertions(+), 206 deletions(-)
6bee1e9e5799398550e1897bcef6c5067452500b

 docs/ops.html                                      | 321 ++++++++++++++++++---
 .../streams/processor/internals/ProcessorNode.java |  31 +-
 .../streams/processor/internals/StreamTask.java    |   3 +-
 .../processor/internals/StreamsMetricsImpl.java    |  60 ++--
 .../state/internals/CachingKeyValueStore.java      |   2 +-
 .../state/internals/MeteredKeyValueStore.java      |  32 +-
 .../internals/MeteredSegmentedBytesStore.java      |  23 +-
 .../kafka/streams/state/internals/NamedCache.java  |  41 ++-
 .../kafka/streams/state/internals/ThreadCache.java |  32 ++
 .../processor/internals/ProcessorNodeTest.java     |  45 ++-
 .../processor/internals/StreamTaskTest.java        |  29 +-
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |   3 +-
 ...dSortedCacheWrappedWindowStoreIteratorTest.java |   2 +-
 .../streams/state/internals/NamedCacheTest.java    |  32 +-
 .../streams/state/internals/ThreadCacheTest.java   | 103 +++----
 15 files changed, 552 insertions(+), 207 deletions(-)
fb21209b5ad30001eeace56b3c8ab060e0ceb021

 core/src/main/scala/kafka/log/Log.scala            |  12 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |   4 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |   3 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  43 +-
 .../scala/kafka/server/LogDirFailureChannel.scala  |  28 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../kafka/server/checkpoints/CheckpointFile.scala  |  10 +-
 .../integration/kafka/api/LogDirFailureTest.scala  |  34 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |   7 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  27 +-
 .../scala/unit/kafka/cluster/ReplicaTest.scala     |  11 +-
 .../log/AbstractLogCleanerIntegrationTest.scala    |   5 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   6 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |  11 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |   6 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 794 ++++++++-------------
 16 files changed, 441 insertions(+), 562 deletions(-)
125d69caee993710bc07523fdd3deb0e06b10636

 docs/streams/developer-guide.html                  | 36 ++++++++++-----
 .../org/apache/kafka/streams/StreamsBuilder.java   |  3 +-
 .../org/apache/kafka/streams/kstream/KStream.java  |  2 +-
 .../kafka/streams/kstream/KStreamBuilder.java      |  7 ++-
 .../streams/kstream/internals/KStreamImpl.java     | 22 +++++----
 .../streams/kstream/internals/KTableImpl.java      |  9 ++--
 .../internals/InternalTopologyBuilder.java         |  4 +-
 .../processor/internals/ProcessorContextImpl.java  |  7 ++-
 .../apache/kafka/streams/StreamsBuilderTest.java   | 13 ++++++
 ...StreamsFineGrainedAutoResetIntegrationTest.java | 10 +++-
 .../integration/RegexSourceIntegrationTest.java    | 10 ++--
 .../kstream/internals/GlobalKTableJoinsTest.java   |  4 +-
 .../internals/InternalStreamsBuilderTest.java      | 22 +++------
 .../kstream/internals/KStreamBranchTest.java       |  2 +-
 .../kstream/internals/KStreamFilterTest.java       |  2 +-
 .../kstream/internals/KStreamFlatMapTest.java      |  1 -
 .../kstream/internals/KStreamForeachTest.java      |  2 +-
 .../streams/kstream/internals/KStreamImplTest.java | 10 ++--
 .../kstream/internals/KStreamKStreamJoinTest.java  | 11 +++--
 .../internals/KStreamKStreamLeftJoinTest.java      |  5 +-
 .../kstream/internals/KStreamKTableJoinTest.java   |  5 +-
 .../internals/KStreamKTableLeftJoinTest.java       |  3 +-
 .../streams/kstream/internals/KStreamMapTest.java  |  2 +-
 .../kstream/internals/KStreamMapValuesTest.java    |  1 -
 .../streams/kstream/internals/KStreamPeekTest.java |  4 +-
 .../kstream/internals/KStreamSelectKeyTest.java    |  2 +-
 .../kstream/internals/KTableAggregateTest.java     | 23 +++++-----
 .../kstream/internals/KTableFilterTest.java        | 33 +++++++-------
 .../kstream/internals/KTableForeachTest.java       |  6 +--
 .../streams/kstream/internals/KTableImplTest.java  | 53 +++++++++++-----------
 .../kstream/internals/KTableKTableJoinTest.java    | 31 ++++---------
 .../internals/KTableKTableLeftJoinTest.java        |  3 +-
 .../internals/KTableKTableOuterJoinTest.java       |  3 +-
 .../kstream/internals/KTableMapKeysTest.java       |  8 +---
 .../kstream/internals/KTableMapValuesTest.java     | 11 ++---
 .../kstream/internals/KTableSourceTest.java        |  9 ++--
 .../processor/internals/StandbyTaskTest.java       | 10 ++--
 .../internals/StreamPartitionAssignorTest.java     |  6 +--
 .../processor/internals/StreamThreadTest.java      |  7 +--
 .../internals/StreamsMetadataStateTest.java        | 12 ++---
 .../org/apache/kafka/test/KStreamTestDriver.java   | 26 ++++-------
 .../org/apache/kafka/test/StreamsTestUtils.java    | 14 ------
 42 files changed, 216 insertions(+), 238 deletions(-)
630e9c5679efa0916a7bfca849dfc8850737681c

 .../processor/internals/RecordCollectorImpl.java   | 27 +++++++++++-----------
 1 file changed, 14 insertions(+), 13 deletions(-)
db306ec36297d042b58de6f825b0419d0ea912d8

 tests/kafkatest/utils/util.py | 36 +++++++++++++++++++++++++++++++-----
 1 file changed, 31 insertions(+), 5 deletions(-)
b7684b47b80a2a7d604632bb325fde49e570480f

 .../org/apache/kafka/streams/StreamsConfig.java    | 103 ++++++++++++++-------
 .../apache/kafka/streams/StreamsConfigTest.java    |  48 ++++++----
 2 files changed, 96 insertions(+), 55 deletions(-)
edcefccfd7bd83110746fa81669e0d69ece5bb4b

 .../apache/kafka/streams/StreamsBuilderTest.java   | 19 ++---
 .../kafka/streams/kstream/KStreamBuilderTest.java  | 20 ++----
 .../kstream/internals/AbstractStreamTest.java      | 15 ++--
 .../kstream/internals/GlobalKTableJoinsTest.java   | 15 ++--
 .../kstream/internals/KGroupedStreamImplTest.java  | 21 ++----
 .../kstream/internals/KGroupedTableImplTest.java   | 15 ++--
 .../kstream/internals/KStreamBranchTest.java       | 15 ++--
 .../kstream/internals/KStreamFilterTest.java       | 20 ++----
 .../kstream/internals/KStreamFlatMapTest.java      | 15 ++--
 .../internals/KStreamFlatMapValuesTest.java        | 15 ++--
 .../kstream/internals/KStreamForeachTest.java      | 16 ++---
 .../kstream/internals/KStreamKStreamJoinTest.java  | 23 +++---
 .../internals/KStreamKStreamLeftJoinTest.java      | 18 ++---
 .../kstream/internals/KStreamKTableJoinTest.java   | 16 ++---
 .../internals/KStreamKTableLeftJoinTest.java       | 15 ++--
 .../streams/kstream/internals/KStreamMapTest.java  | 16 ++---
 .../kstream/internals/KStreamMapValuesTest.java    | 16 ++---
 .../streams/kstream/internals/KStreamPeekTest.java | 15 ++--
 .../kstream/internals/KStreamPrintTest.java        | 18 ++---
 .../kstream/internals/KStreamSelectKeyTest.java    | 16 ++---
 .../kstream/internals/KStreamTransformTest.java    | 16 ++---
 .../internals/KStreamTransformValuesTest.java      | 16 ++---
 .../internals/KStreamWindowAggregateTest.java      | 21 ++----
 .../kstream/internals/KTableAggregateTest.java     | 26 +++----
 .../kstream/internals/KTableFilterTest.java        | 24 +++----
 .../kstream/internals/KTableForeachTest.java       | 16 ++---
 .../streams/kstream/internals/KTableImplTest.java  | 24 +++----
 .../kstream/internals/KTableKTableJoinTest.java    | 18 ++---
 .../internals/KTableKTableLeftJoinTest.java        | 22 ++----
 .../internals/KTableKTableOuterJoinTest.java       | 20 ++----
 .../kstream/internals/KTableMapKeysTest.java       | 18 ++---
 .../kstream/internals/KTableMapValuesTest.java     | 22 ++----
 .../kstream/internals/KTableSourceTest.java        | 22 ++----
 .../org/apache/kafka/test/KStreamTestDriver.java   | 82 ++++++++++++----------
 34 files changed, 225 insertions(+), 461 deletions(-)
452e2eedb84b77c6f16085cf5b59d9cadb609149

 .../streams/processor/internals/AbstractTask.java  | 15 ++---
 .../streams/processor/internals/StandbyTask.java   |  2 +-
 .../streams/processor/internals/StreamTask.java    | 39 ++++++-------
 .../streams/processor/internals/StreamThread.java  | 67 ++++++++++++----------
 .../processor/internals/AbstractTaskTest.java      |  3 -
 .../processor/internals/StreamThreadTest.java      | 56 +++++++++++++++++-
 6 files changed, 115 insertions(+), 67 deletions(-)
228a4fdb6dc15d1b8615615e00825e7ce53a41fa

 .../streams/processor/internals/AbstractTask.java  | 15 ++---
 .../streams/processor/internals/StandbyTask.java   |  2 +-
 .../streams/processor/internals/StreamTask.java    | 40 ++++++-----
 .../streams/processor/internals/StreamThread.java  | 77 +++++++++++-----------
 .../processor/internals/AbstractTaskTest.java      |  3 -
 .../processor/internals/StreamThreadTest.java      | 59 ++++++++++++++++-
 6 files changed, 120 insertions(+), 76 deletions(-)
94a6d6c02d478f5ccec1928163ff921688155a01

 .../examples/temperature/TemperatureDemo.java      | 144 +++++++++++++++++++++
 1 file changed, 144 insertions(+)
7e0ec9c766435bd10fcc24191b09765f94a248a3

 core/src/main/scala/kafka/network/RequestChannel.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4086db472d08f6dee4d30dda82ab9ff7b67d1a20

 core/src/main/scala/kafka/network/RequestChannel.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
86bfbd0ce6ae968d373af135754a68de4dc0c6af

 .../kafka/clients/consumer/internals/Fetcher.java  | 59 +++++++++++++---------
 .../clients/consumer/internals/FetcherTest.java    | 41 ++++++++++++---
 2 files changed, 67 insertions(+), 33 deletions(-)
cd4c6c0183edfbf8e7e8ce526d638e31fcd09186

 .../kafka/clients/consumer/internals/Fetcher.java  | 59 +++++++++++++---------
 .../clients/consumer/internals/FetcherTest.java    | 41 ++++++++++++---
 2 files changed, 67 insertions(+), 33 deletions(-)
da2205578be3228ce40eb5e59f6bbcb0c8da0aba

 docs/streams/developer-guide.html                  |   18 +-
 docs/streams/index.html                            |    6 +-
 .../examples/pageview/PageViewTypedDemo.java       |    8 +-
 .../examples/pageview/PageViewUntypedDemo.java     |    8 +-
 .../kafka/streams/examples/pipe/PipeDemo.java      |    6 +-
 .../streams/examples/wordcount/WordCountDemo.java  |    6 +-
 .../apache/kafka/streams/KafkaClientSupplier.java  |    2 +-
 .../org/apache/kafka/streams/KafkaStreams.java     |   24 +-
 .../org/apache/kafka/streams/StreamsBuilder.java   | 1211 ++++++++++++++++++++
 .../org/apache/kafka/streams/StreamsConfig.java    |    2 +-
 .../java/org/apache/kafka/streams/Topology.java    |    6 +
 .../apache/kafka/streams/kstream/GlobalKTable.java |    5 +-
 .../org/apache/kafka/streams/kstream/KStream.java  |   18 +-
 .../kafka/streams/kstream/KStreamBuilder.java      |  209 ++--
 .../org/apache/kafka/streams/kstream/KTable.java   |   54 +-
 .../streams/kstream/internals/AbstractStream.java  |   15 +-
 .../kstream/internals/InternalStreamsBuilder.java  |  203 ++++
 .../kstream/internals/KGroupedStreamImpl.java      |   30 +-
 .../kstream/internals/KGroupedTableImpl.java       |   25 +-
 .../streams/kstream/internals/KStreamImpl.java     |  461 ++++----
 .../kstream/internals/KStreamJoinWindow.java       |    6 +-
 .../streams/kstream/internals/KTableImpl.java      |  188 +--
 .../kafka/streams/processor/PartitionGrouper.java  |    2 +-
 .../kafka/streams/processor/TopologyBuilder.java   |   63 +-
 .../internals/StreamPartitionAssignor.java         |    7 +-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   57 +-
 .../apache/kafka/streams/StreamsBuilderTest.java   |  123 ++
 .../org/apache/kafka/streams/TopologyTest.java     |    1 +
 .../streams/integration/EosIntegrationTest.java    |   14 +-
 .../streams/integration/FanoutIntegrationTest.java |    6 +-
 .../integration/GlobalKTableIntegrationTest.java   |    8 +-
 .../integration/InternalTopicIntegrationTest.java  |   14 +-
 .../streams/integration/JoinIntegrationTest.java   |    8 +-
 .../KStreamAggregationDedupIntegrationTest.java    |   13 +-
 .../KStreamAggregationIntegrationTest.java         |    8 +-
 .../KStreamKTableJoinIntegrationTest.java          |    6 +-
 .../integration/KStreamRepartitionJoinTest.java    |    9 +-
 ...StreamsFineGrainedAutoResetIntegrationTest.java |   25 +-
 .../KTableKTableJoinIntegrationTest.java           |    6 +-
 .../integration/QueryableStateIntegrationTest.java |   32 +-
 .../integration/RegexSourceIntegrationTest.java    |   37 +-
 .../streams/integration/ResetIntegrationTest.java  |   15 +-
 .../kafka/streams/kstream/KStreamBuilderTest.java  |    9 +-
 .../kstream/internals/AbstractStreamTest.java      |   16 +-
 .../kstream/internals/GlobalKTableJoinsTest.java   |    4 +-
 .../internals/InternalStreamsBuilderTest.java      |  370 ++++++
 .../kstream/internals/KGroupedStreamImplTest.java  |   24 +-
 .../kstream/internals/KGroupedTableImplTest.java   |    4 +-
 .../kstream/internals/KStreamBranchTest.java       |    7 +-
 .../kstream/internals/KStreamFilterTest.java       |    8 +-
 .../kstream/internals/KStreamFlatMapTest.java      |   10 +-
 .../internals/KStreamFlatMapValuesTest.java        |    4 +-
 .../kstream/internals/KStreamForeachTest.java      |   13 +-
 .../streams/kstream/internals/KStreamImplTest.java |   29 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  |   22 +-
 .../internals/KStreamKStreamLeftJoinTest.java      |   10 +-
 .../kstream/internals/KStreamKTableJoinTest.java   |    6 +-
 .../internals/KStreamKTableLeftJoinTest.java       |    6 +-
 .../streams/kstream/internals/KStreamMapTest.java  |    6 +-
 .../kstream/internals/KStreamMapValuesTest.java    |    4 +-
 .../streams/kstream/internals/KStreamPeekTest.java |    7 +-
 .../kstream/internals/KStreamPrintTest.java        |   13 +-
 .../kstream/internals/KStreamSelectKeyTest.java    |    6 +-
 .../kstream/internals/KStreamTransformTest.java    |    6 +-
 .../internals/KStreamTransformValuesTest.java      |    4 +-
 .../internals/KStreamWindowAggregateTest.java      |    6 +-
 .../kstream/internals/KTableAggregateTest.java     |   21 +-
 .../kstream/internals/KTableFilterTest.java        |   46 +-
 .../kstream/internals/KTableForeachTest.java       |   18 +-
 .../streams/kstream/internals/KTableImplTest.java  |   50 +-
 .../kstream/internals/KTableKTableJoinTest.java    |   38 +-
 .../internals/KTableKTableLeftJoinTest.java        |   16 +-
 .../internals/KTableKTableOuterJoinTest.java       |   14 +-
 .../kstream/internals/KTableMapKeysTest.java       |    5 +-
 .../kstream/internals/KTableMapValuesTest.java     |   22 +-
 .../kstream/internals/KTableSourceTest.java        |   14 +-
 .../apache/kafka/streams/perf/SimpleBenchmark.java |   26 +-
 .../apache/kafka/streams/perf/YahooBenchmark.java  |   10 +-
 .../internals/GlobalStreamThreadTest.java          |    2 +-
 .../processor/internals/StandbyTaskTest.java       |   15 +-
 .../internals/StreamPartitionAssignorTest.java     |   28 +-
 .../processor/internals/StreamThreadTest.java      |  185 +--
 .../internals/StreamsMetadataStateTest.java        |   19 +-
 .../streams/tests/BrokerCompatibilityTest.java     |    6 +-
 .../apache/kafka/streams/tests/EosTestClient.java  |    6 +-
 .../kafka/streams/tests/ShutdownDeadlockTest.java  |    6 +-
 .../kafka/streams/tests/SmokeTestClient.java       |    6 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |   56 +
 .../kafka/test/ProcessorTopologyTestDriver.java    |    8 +-
 89 files changed, 3119 insertions(+), 1057 deletions(-)
1844bf2b2f4cdf5a8209d7ceccb6701fc7dcf768

 docs/streams/developer-guide.html                  |  63 +-
 .../examples/wordcount/WordCountProcessorDemo.java |   6 +-
 .../org/apache/kafka/streams/KafkaStreams.java     |  71 ++-
 .../java/org/apache/kafka/streams/Topology.java    | 640 ++++++++++++++++++++
 .../apache/kafka/streams/TopologyDescription.java  |   7 +-
 .../streams/errors/TopologyBuilderException.java   |   5 +-
 .../kafka/streams/errors/TopologyException.java    |  40 ++
 .../org/apache/kafka/streams/kstream/KStream.java  |   4 +-
 .../kstream/internals/KStreamTransform.java        |   1 +
 .../kstream/internals/KStreamTransformValues.java  |   2 +
 .../streams/kstream/internals/KTableImpl.java      |  10 +-
 .../kafka/streams/processor/AbstractProcessor.java |   1 +
 .../kafka/streams/processor/TopologyBuilder.java   | 221 ++++---
 .../internals/GlobalProcessorContextImpl.java      |   5 +-
 .../internals/InternalTopologyBuilder.java         | 242 +++++---
 .../processor/internals/ProcessorContextImpl.java  |   1 +
 .../internals/SourceNodeRecordDeserializer.java    |   1 +
 .../internals/StreamPartitionAssignor.java         |  15 +-
 .../org/apache/kafka/streams/TopologyTest.java     | 671 +++++++++++++++++++++
 ...StreamsFineGrainedAutoResetIntegrationTest.java |  19 +-
 .../streams/processor/TopologyBuilderTest.java     |   2 +-
 .../kafka/streams/processor/TopologyTest.java      | 408 -------------
 .../internals/InternalTopologyBuilderTest.java     | 140 ++---
 .../internals/StreamPartitionAssignorTest.java     |   7 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   2 +-
 25 files changed, 1865 insertions(+), 719 deletions(-)
37ada79570a80314b9f929e7c398c264e551f552

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
c50c941af1395d010160790f0127f06106cc69c8

 .../org/apache/kafka/streams/KafkaStreams.java     |  20 ++
 .../AbstractNotifyingBatchingRestoreCallback.java  |  83 ++++++++
 .../AbstractNotifyingRestoreCallback.java          |  72 +++++++
 .../processor/BatchingStateRestoreCallback.java    |  41 ++++
 .../streams/processor/StateRestoreListener.java    |  84 ++++++++
 .../internals/CompositeRestoreListener.java        | 109 ++++++++++
 .../internals/GlobalStateManagerImpl.java          |  12 +-
 .../processor/internals/ProcessorStateManager.java |   5 +-
 .../streams/processor/internals/StateRestorer.java |  38 +++-
 .../processor/internals/StoreChangelogReader.java  |  41 +++-
 .../streams/processor/internals/StreamThread.java  |  17 +-
 .../WrappedBatchingStateRestoreCallback.java       |  46 ++++
 .../streams/state/internals/RocksDBStore.java      |  56 ++++-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  14 ++
 .../processor/internals/AbstractTaskTest.java      |   3 +-
 .../internals/CompositeRestoreListenerTest.java    | 232 +++++++++++++++++++++
 .../processor/internals/StandbyTaskTest.java       |   4 +-
 .../processor/internals/StateRestorerTest.java     |  22 +-
 .../internals/StoreChangelogReaderTest.java        | 117 +++++++++--
 .../processor/internals/StreamTaskTest.java        |   5 +-
 .../processor/internals/StreamThreadTest.java      |   8 +-
 .../WrappedBatchingStateRestoreCallbackTest.java   |  51 +++++
 .../streams/state/internals/RocksDBStoreTest.java  |  82 +++++++-
 .../StreamThreadStateStoreProviderTest.java        |   3 +-
 .../apache/kafka/test/MockProcessorContext.java    |  38 +++-
 .../kafka/test/MockStateRestoreListener.java       |  90 ++++++++
 .../kafka/test/ProcessorTopologyTestDriver.java    |   5 +-
 27 files changed, 1233 insertions(+), 65 deletions(-)
4003c9384bcf452ba7eb4072b96ad731b13da035

 core/src/main/scala/kafka/cluster/Partition.scala     | 19 +++++++++++++++++++
 core/src/main/scala/kafka/server/ReplicaManager.scala |  9 +++++++++
 docs/ops.html                                         | 10 ++++++++++
 3 files changed, 38 insertions(+)
55c2b73650938d0ef86969e8ddbfb18a6c391cc9

 .../state/internals/MeteredKeyValueStore.java      | 174 ++++++++++++---------
 1 file changed, 99 insertions(+), 75 deletions(-)
4059fa5763252c6869b6b7c682d7b5f9d4dc3a87

 .../state/internals/MeteredKeyValueStore.java      | 174 ++++++++++++---------
 1 file changed, 99 insertions(+), 75 deletions(-)
c2b939c623ed2b532f129da2233ee8abe83cf94b

 core/src/main/scala/kafka/cluster/Partition.scala  |   4 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |  30 +++--
 core/src/main/scala/kafka/log/Log.scala            | 103 +++++++++------
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../scala/unit/kafka/cluster/ReplicaTest.scala     | 138 +++++++++++++++++++++
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   2 +
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   2 +
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  49 ++++++--
 .../server/HighwatermarkPersistenceTest.scala      |  21 ++--
 .../unit/kafka/server/ISRExpirationTest.scala      |   8 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   1 +
 .../kafka/server/ReplicaManagerQuotasTest.scala    |   4 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   4 +-
 ...chDrivenReplicationProtocolAcceptanceTest.scala |   6 +-
 .../server/epoch/OffsetsForLeaderEpochTest.scala   |   2 +-
 15 files changed, 297 insertions(+), 79 deletions(-)
6bd7302645a6167299de6de4e5a19749502db25c

 core/src/main/scala/kafka/cluster/Partition.scala  |   4 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |  30 +++--
 core/src/main/scala/kafka/log/Log.scala            | 107 ++++++++++------
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../scala/unit/kafka/cluster/ReplicaTest.scala     | 138 +++++++++++++++++++++
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   2 +
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   2 +
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  49 ++++++--
 .../server/HighwatermarkPersistenceTest.scala      |  21 ++--
 .../unit/kafka/server/ISRExpirationTest.scala      |   8 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   1 +
 .../kafka/server/ReplicaManagerQuotasTest.scala    |   4 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   4 +-
 ...chDrivenReplicationProtocolAcceptanceTest.scala |   6 +-
 .../server/epoch/OffsetsForLeaderEpochTest.scala   |   2 +-
 15 files changed, 299 insertions(+), 81 deletions(-)
9d6020ec5fac21f36e2caa58256ee2158658866e

 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
8b14e11743360a711b2bb670cf503acc0e604602

 build.gradle                                       |   2 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  26 +--
 .../scala/kafka/admin/DeleteRecordsCommand.scala   |  24 +--
 .../PreferredReplicaLeaderElectionCommand.scala    |  15 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |  29 +--
 .../src/main/scala/kafka/consumer/TopicCount.scala |   8 +-
 .../scala/kafka/controller/KafkaController.scala   |  44 ++---
 .../transaction/ProducerIdManager.scala            |   9 +-
 core/src/main/scala/kafka/security/auth/Acl.scala  |  21 +--
 .../scala/kafka/server/DynamicConfigManager.scala  |  86 ++++-----
 core/src/main/scala/kafka/utils/Json.scala         |  51 +++--
 core/src/main/scala/kafka/utils/LogDirUtils.scala  |  30 ++-
 .../main/scala/kafka/utils/ReplicationUtils.scala  |  15 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 124 +++++-------
 .../main/scala/kafka/utils/json/DecodeJson.scala   | 122 ++++++++++++
 .../main/scala/kafka/utils/json/JsonArray.scala    |  27 +++
 .../main/scala/kafka/utils/json/JsonObject.scala   |  42 +++++
 .../main/scala/kafka/utils/json/JsonValue.scala    | 118 ++++++++++++
 .../integration/kafka/api/LogDirFailureTest.scala  |   1 -
 .../unit/kafka/cluster/BrokerEndPointTest.scala    | 167 ++++++++++------
 .../transaction/ProducerIdManagerTest.scala        |  60 +++---
 .../src/test/scala/unit/kafka/utils/JsonTest.scala |  27 ++-
 .../unit/kafka/utils/json/JsonValueTest.scala      | 210 +++++++++++++++++++++
 gradle/dependencies.gradle                         |   2 -
 24 files changed, 879 insertions(+), 381 deletions(-)
25bcc217646ddd465a407c0d219111f97f910650

 .../consumer/ConsumerRebalanceListener.java        | 16 +++++++++++
 .../consumer/internals/AbstractCoordinator.java    | 13 +++++++--
 .../internals/AbstractCoordinatorTest.java         | 32 ++++++++++++++++++++++
 3 files changed, 58 insertions(+), 3 deletions(-)
3620035c45736b74e69921f7c50a1c3857aec334

 .../consumer/ConsumerRebalanceListener.java        | 16 +++++++++++
 .../consumer/internals/AbstractCoordinator.java    | 13 +++++++--
 .../internals/AbstractCoordinatorTest.java         | 32 ++++++++++++++++++++++
 3 files changed, 58 insertions(+), 3 deletions(-)
5effe72390e0a3b7f82debcaaf069a531caaa351

 core/src/main/scala/kafka/api/ApiVersion.scala     |  8 +++---
 .../controller/ControllerChannelManager.scala      |  4 +--
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 docs/upgrade.html                                  | 30 ++++++++--------------
 gradle.properties                                  |  2 +-
 kafka-merge-pr.py                                  |  2 +-
 tests/kafkatest/__init__.py                        |  4 +--
 7 files changed, 21 insertions(+), 31 deletions(-)
c1f583e671ace7f96f247ddba5aad94078f60d3b

 .../org/apache/kafka/streams/StreamsConfig.java    | 20 ++++----
 .../apache/kafka/streams/StreamsConfigTest.java    | 55 ++++++++++++++++++++++
 2 files changed, 63 insertions(+), 12 deletions(-)
f8498ec9e27ca0f08e3791d7a19ad8c6a97e210f

 .../org/apache/kafka/streams/StreamsConfig.java    | 20 ++++----
 .../apache/kafka/streams/StreamsConfigTest.java    | 55 ++++++++++++++++++++++
 2 files changed, 63 insertions(+), 12 deletions(-)
23c51495d915d60b1abee0eb107b9dbc84ed3490

 docs/connect.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
f4d1305bfef669446d4dbdeeed4d2c4d212c6e1d

 docs/connect.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
9f3f8b4de64501902a4843064b1cf1feb21c690a

 build.gradle                                       |   1 +
 .../org/apache/kafka/streams/KafkaStreams.java     |  45 ++-
 .../processor/internals/StateDirectory.java        |  66 ++--
 .../streams/processor/internals/StreamThread.java  |  16 +-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  53 ++++
 .../integration/RegexSourceIntegrationTest.java    |   3 +-
 .../processor/internals/StateDirectoryTest.java    |  57 ++++
 .../internals/StreamPartitionAssignorTest.java     |  53 ++--
 .../processor/internals/StreamThreadTest.java      | 331 +++++++--------------
 .../StreamThreadStateStoreProviderTest.java        |  20 +-
 10 files changed, 331 insertions(+), 314 deletions(-)
89faed8d30eb441fac7f1564edd40115006f5051

 .../org/apache/kafka/streams/KafkaStreams.java     | 26 ++++++++++++++++-----
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 27 ++++++++++++++++++++++
 2 files changed, 47 insertions(+), 6 deletions(-)
e5e88f636fa9857105324f62cc758b1fed3602bb

 .../scala/kafka/controller/ZookeeperClient.scala   | 286 ++++++++++++++++++
 .../kafka/controller/ZookeeperClientTest.scala     | 329 +++++++++++++++++++++
 2 files changed, 615 insertions(+)
47ee8e954df62b9a79099e944ec4be29afe046f6

 checkstyle/import-control.xml                      |   5 +
 .../common/memory/GarbageCollectedMemoryPool.java  | 168 +++++++++++++++++++++
 .../org/apache/kafka/common/memory/MemoryPool.java |  95 ++++++++++++
 .../kafka/common/memory/SimpleMemoryPool.java      | 137 +++++++++++++++++
 .../kafka/common/network/ChannelBuilder.java       |   7 +-
 .../apache/kafka/common/network/KafkaChannel.java  |  55 ++++++-
 .../kafka/common/network/NetworkReceive.java       |  50 +++++-
 .../common/network/PlaintextChannelBuilder.java    |   6 +-
 .../common/network/PlaintextTransportLayer.java    |   5 +
 .../org/apache/kafka/common/network/Receive.java   |  12 +-
 .../kafka/common/network/SaslChannelBuilder.java   |   6 +-
 .../org/apache/kafka/common/network/Selector.java  | 131 +++++++++++++---
 .../kafka/common/network/SslChannelBuilder.java    |   6 +-
 .../kafka/common/network/SslTransportLayer.java    |   5 +
 .../kafka/common/network/TransportLayer.java       |   6 +-
 .../apache/kafka/common/protocol/ProtoUtils.java   |  47 ++++++
 .../org/apache/kafka/common/protocol/Protocol.java |  47 ++++++
 .../kafka/common/protocol/SchemaVisitor.java       |  27 ++++
 .../common/protocol/SchemaVisitorAdapter.java      |  38 +++++
 .../apache/kafka/common/protocol/types/Field.java  |   5 +
 .../apache/kafka/common/protocol/types/Schema.java |   4 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  33 +++-
 .../memory/GarbageCollectedMemoryPoolTest.java     | 163 ++++++++++++++++++++
 .../apache/kafka/common/network/NioEchoServer.java |   5 +-
 .../kafka/common/network/PlaintextSender.java      |  44 ++++++
 .../apache/kafka/common/network/SelectorTest.java  |  92 ++++++++++-
 .../kafka/common/network/SslSelectorTest.java      |  95 +++++++++++-
 .../org/apache/kafka/common/network/SslSender.java |  83 ++++++++++
 .../common/network/SslTransportLayerTest.java      |   3 +-
 .../kafka/common/protocol/ProtoUtilsTest.java      |  35 +++++
 .../org/apache/kafka/common/utils/UtilsTest.java   |  12 ++
 .../main/scala/kafka/network/RequestChannel.scala  |  25 ++-
 .../main/scala/kafka/network/SocketServer.scala    |  33 +++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   7 +
 .../scala/kafka/server/KafkaRequestHandler.scala   |   7 +-
 .../unit/kafka/network/SocketServerTest.scala      |   5 +-
 .../scala/unit/kafka/server/KafkaApisTest.scala    |   3 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   1 +
 38 files changed, 1446 insertions(+), 62 deletions(-)
f15cdbc91b240e656d9a2aeb6877e94624b21f8d

 .../kafka/common/requests/BasePartitionState.java  | 40 ++++++++++++++++
 .../kafka/common/requests/LeaderAndIsrRequest.java | 41 ++++++++++++++---
 .../kafka/common/requests/PartitionState.java      | 53 ----------------------
 .../common/requests/UpdateMetadataRequest.java     | 40 ++++++----------
 .../kafka/common/requests/RequestResponseTest.java |  8 ++--
 core/src/main/scala/kafka/api/LeaderAndIsr.scala   | 27 -----------
 core/src/main/scala/kafka/cluster/Partition.scala  | 29 ++++++------
 .../controller/ControllerChannelManager.scala      | 49 ++++++++++----------
 .../scala/kafka/server/DelayedCreateTopics.scala   |  4 +-
 .../main/scala/kafka/server/MetadataCache.scala    | 34 +++++---------
 .../main/scala/kafka/server/ReplicaManager.scala   | 26 +++++------
 .../kafka/api/AuthorizerIntegrationTest.scala      |  3 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 14 +++---
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 .../unit/kafka/server/MetadataCacheTest.scala      |  6 +--
 .../unit/kafka/server/ReplicaManagerTest.scala     | 12 ++---
 .../scala/unit/kafka/server/RequestQuotaTest.scala |  2 +-
 .../server/epoch/LeaderEpochIntegrationTest.scala  |  4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 .../integration/utils/IntegrationTestUtils.java    |  8 ++--
 20 files changed, 187 insertions(+), 217 deletions(-)
acc020d833dc6f6a43466881f59347b1a0c94fec

 docs/js/templateData.js                            |   1 +
 docs/streams/quickstart.html                       | 192 +++++++++++++++------
 docs/toc.html                                      |   9 +
 .../kafka/streams/examples/pipe/PipeDemo.java      |  25 ++-
 .../streams/examples/wordcount/WordCountDemo.java  |  27 ++-
 .../examples/wordcount/WordCountProcessorDemo.java |  31 +++-
 6 files changed, 214 insertions(+), 71 deletions(-)
91c207c2c6b09d88cc3366d69a31d0bf0ab0bffb

 docs/js/templateData.js                            |   1 +
 docs/streams/quickstart.html                       | 192 +++++++++++++++------
 docs/toc.html                                      |   9 +
 .../kafka/streams/examples/pipe/PipeDemo.java      |  25 ++-
 .../streams/examples/wordcount/WordCountDemo.java  |  27 ++-
 .../examples/wordcount/WordCountProcessorDemo.java |  31 +++-
 6 files changed, 214 insertions(+), 71 deletions(-)
5d798511b12c5ef7555e4234fdd99a360176e435

 .../org/apache/kafka/streams/KafkaStreams.java     |    4 +-
 .../apache/kafka/streams/TopologyDescription.java  |  152 ++
 .../kafka/streams/processor/TopologyBuilder.java   | 1265 ++++-------------
 .../streams/processor/TopologyDescription.java     |  476 -------
 .../internals/InternalTopologyBuilder.java         | 1491 ++++++++++++++++++++
 .../internals/StreamPartitionAssignor.java         |    9 +-
 .../streams/processor/internals/StreamThread.java  |    7 +-
 .../processor/internals/StreamsMetadataState.java  |    5 +-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   31 +-
 .../integration/RegexSourceIntegrationTest.java    |   49 +-
 .../streams/processor/TopologyBuilderTest.java     |   10 +-
 .../kafka/streams/processor/TopologyTest.java      |   87 +-
 .../internals/InternalTopologyBuilderTest.java     |  709 ++++++++++
 .../processor/internals/ProcessorTopologyTest.java |   34 +-
 .../internals/StreamPartitionAssignorTest.java     |  289 +++-
 .../processor/internals/StreamThreadTest.java      |  151 +-
 .../internals/StreamsMetadataStateTest.java        |    8 +-
 .../StreamThreadStateStoreProviderTest.java        |    4 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |    7 +-
 19 files changed, 3016 insertions(+), 1772 deletions(-)
fc93fb4b6116e809f2b69ddb2f7e0f12548fef51

 .../kafka/clients/consumer/internals/Fetcher.java  |   5 +-
 .../org/apache/kafka/common/PartitionInfo.java     |  21 +-
 .../kafka/common/errors/KafkaStorageException.java |  50 +++
 .../org/apache/kafka/common/protocol/Errors.java   |  21 +-
 .../org/apache/kafka/common/protocol/Protocol.java | 138 +++++-
 .../apache/kafka/common/record/FileRecords.java    |   7 +
 .../kafka/common/requests/FetchResponse.java       |  11 +-
 .../kafka/common/requests/LeaderAndIsrRequest.java |  12 +-
 .../kafka/common/requests/MetadataRequest.java     |   1 +
 .../kafka/common/requests/MetadataResponse.java    |  57 ++-
 .../kafka/common/requests/PartitionState.java      |   8 +-
 .../kafka/common/requests/ProduceRequest.java      |   2 +
 .../kafka/common/requests/ProduceResponse.java     |   9 +-
 .../common/requests/UpdateMetadataRequest.java     |  58 ++-
 .../internals/AbstractCoordinatorTest.java         |   4 +-
 .../internals/ConsumerCoordinatorTest.java         |   4 +-
 .../clients/consumer/internals/FetcherTest.java    |   3 +-
 .../producer/internals/TransactionManagerTest.java |   2 +-
 .../org/apache/kafka/common/PartitionInfoTest.java |  15 +-
 .../apache/kafka/common/protocol/ErrorsTest.java   |   4 +-
 .../kafka/common/requests/RequestResponseTest.java |  21 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |   2 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   2 +-
 core/src/main/scala/kafka/api/ApiVersion.scala     |  12 +-
 core/src/main/scala/kafka/api/LeaderAndIsr.scala   |  15 +-
 core/src/main/scala/kafka/cluster/Partition.scala  | 119 +++--
 .../scala/kafka/common/KafkaStorageException.scala |   6 +-
 .../controller/ControllerChannelManager.scala      |  51 ++-
 .../scala/kafka/controller/ControllerState.scala   |  11 +-
 .../scala/kafka/controller/KafkaController.scala   | 169 +++++--
 .../kafka/controller/PartitionLeaderSelector.scala |  13 +-
 .../kafka/controller/PartitionStateMachine.scala   |   7 +-
 .../kafka/controller/ReplicaStateMachine.scala     |   5 +-
 .../kafka/controller/TopicDeletionManager.scala    |   2 +-
 .../coordinator/group/GroupMetadataManager.scala   |  10 +-
 .../transaction/TransactionCoordinator.scala       |   2 +-
 .../transaction/TransactionStateManager.scala      |   5 +-
 core/src/main/scala/kafka/log/AbstractIndex.scala  |   6 +
 core/src/main/scala/kafka/log/Log.scala            | 495 ++++++++++++---------
 core/src/main/scala/kafka/log/LogCleaner.scala     | 107 +++--
 .../main/scala/kafka/log/LogCleanerManager.scala   |  59 ++-
 core/src/main/scala/kafka/log/LogManager.scala     | 491 +++++++++++++-------
 core/src/main/scala/kafka/log/LogSegment.scala     |  47 +-
 .../scala/kafka/log/ProducerStateManager.scala     |  10 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  10 +-
 .../kafka/server/BrokerMetadataCheckpoint.scala    |   3 +-
 .../scala/kafka/server/DelayedDeleteRecords.scala  |  18 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |   6 +-
 .../main/scala/kafka/server/DelayedProduce.scala   |   5 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  70 ++-
 core/src/main/scala/kafka/server/KafkaServer.scala |  42 +-
 .../scala/kafka/server/LogDirFailureChannel.scala  |  55 +++
 .../main/scala/kafka/server/MetadataCache.scala    |  21 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  68 ++-
 .../main/scala/kafka/server/ReplicaManager.scala   | 296 +++++++++---
 .../kafka/server/checkpoints/CheckpointFile.scala  | 124 +++---
 .../checkpoints/LeaderEpochCheckpointFile.scala    |   5 +-
 .../server/checkpoints/OffsetCheckpointFile.scala  |   5 +-
 core/src/main/scala/kafka/utils/LogDirUtils.scala  |  66 +++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   7 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |   8 +-
 .../kafka/api/IntegrationTestHarness.scala         |   5 +-
 .../integration/kafka/api/LogDirFailureTest.scala  | 126 ++++++
 .../integration/kafka/api/TransactionsTest.scala   |   4 +-
 .../ReplicaFetcherThreadFatalErrorTest.scala       |   2 +-
 .../group/GroupMetadataManagerTest.scala           |  10 +-
 ...sactionMarkerRequestCompletionHandlerTest.scala |   2 +-
 .../transaction/TransactionStateManagerTest.scala  |   2 +-
 .../log/AbstractLogCleanerIntegrationTest.scala    |   3 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   2 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |   2 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |  10 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  22 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |   4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  12 +-
 .../server/HighwatermarkPersistenceTest.scala      |  26 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |  14 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   4 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   4 +-
 .../unit/kafka/server/MetadataCacheTest.scala      |  18 +-
 .../kafka/server/ReplicaFetcherThreadTest.scala    |   6 +-
 .../kafka/server/ReplicaManagerQuotasTest.scala    |   4 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  43 +-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |   7 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   5 +-
 .../checkpoints/OffsetCheckpointFileTest.scala     |  14 +-
 .../server/epoch/OffsetsForLeaderEpochTest.scala   |  26 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  20 +-
 docs/upgrade.html                                  |  57 ++-
 .../integration/utils/IntegrationTestUtils.java    |   8 +-
 .../internals/InternalTopicManagerTest.java        |   2 +-
 tests/kafkatest/services/kafka/config.py           |   2 +-
 tests/kafkatest/services/kafka/config_property.py  |   4 +
 tests/kafkatest/services/kafka/kafka.py            |  59 ++-
 tests/kafkatest/services/verifiable_producer.py    |   5 +-
 tests/kafkatest/tests/core/log_dir_failure_test.py | 177 ++++++++
 tests/kafkatest/tests/core/transactions_test.py    |   3 +-
 97 files changed, 2526 insertions(+), 1096 deletions(-)
2df4d493e4395783550e1a0947377c2eb4db5d66

 docs/upgrade.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
91b5fc737b308a4d17ca2a61dba3b039d19cdb17

 docs/upgrade.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
02c4fccf490cd265a8ca29a82bc4b9a12ac7dc66

 core/src/main/scala/kafka/log/LogCleanerManager.scala | 15 +++++++--------
 1 file changed, 7 insertions(+), 8 deletions(-)
7727d7a9a574ec4305bcf9f490b329f4ffcf4824

 core/src/main/scala/kafka/log/LogCleanerManager.scala | 15 +++++++--------
 1 file changed, 7 insertions(+), 8 deletions(-)
c71e7fa3a3916358f8307e8739e330814937372d

 core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
178f215ad6663bfb7d4917f12cb377c7d1779e25

 docs/images/icons/architecture--white.png  | Bin 0 -> 812 bytes
 docs/images/icons/architecture.png         | Bin 0 -> 818 bytes
 docs/images/icons/documentation--white.png | Bin 0 -> 1758 bytes
 docs/images/icons/documentation.png        | Bin 0 -> 1642 bytes
 docs/images/icons/tutorials--white.png     | Bin 0 -> 1047 bytes
 docs/images/icons/tutorials.png            | Bin 0 -> 985 bytes
 docs/images/streams-welcome.png            | Bin 0 -> 80530 bytes
 docs/streams/architecture.html             |   4 +-
 docs/streams/core-concepts.html            |  26 +++-
 docs/streams/developer-guide.html          |   8 +-
 docs/streams/index.html                    | 238 +++++++++++++++++++++++------
 docs/streams/quickstart.html               |   2 +-
 docs/streams/upgrade-guide.html            |   6 +-
 docs/toc.html                              |  16 +-
 14 files changed, 226 insertions(+), 74 deletions(-)
300f48018cf7835e3de6a998d4e50895a2714a4e

 docs/images/icons/architecture--white.png  | Bin 0 -> 812 bytes
 docs/images/icons/architecture.png         | Bin 0 -> 818 bytes
 docs/images/icons/documentation--white.png | Bin 0 -> 1758 bytes
 docs/images/icons/documentation.png        | Bin 0 -> 1642 bytes
 docs/images/icons/tutorials--white.png     | Bin 0 -> 1047 bytes
 docs/images/icons/tutorials.png            | Bin 0 -> 985 bytes
 docs/images/streams-welcome.png            | Bin 0 -> 80530 bytes
 docs/streams/architecture.html             |   4 +-
 docs/streams/core-concepts.html            |  26 +++-
 docs/streams/developer-guide.html          |   8 +-
 docs/streams/index.html                    | 238 +++++++++++++++++++++++------
 docs/streams/quickstart.html               |   2 +-
 docs/streams/upgrade-guide.html            |   6 +-
 docs/toc.html                              |  16 +-
 14 files changed, 226 insertions(+), 74 deletions(-)
6c6cf014f6eb9c90453e6ac1b01b8c1851d98f06

 .../org/apache/kafka/common/requests/ListOffsetResponse.java   | 10 ++++++++++
 1 file changed, 10 insertions(+)
1e98b2aa5027eb60ee1a1121111a7f8ec45b9c47

 .../connect/storage/FileOffsetBackingStore.java    |  4 +-
 .../kafka/connect/util/SafeObjectInputStream.java  | 71 ++++++++++++++++++++++
 2 files changed, 73 insertions(+), 2 deletions(-)
57218b2ad9f8f72c7fc9d7760118620ee53e8a60

 .../connect/storage/FileOffsetBackingStore.java    |  5 +-
 .../kafka/connect/util/SafeObjectInputStream.java  | 71 ++++++++++++++++++++++
 2 files changed, 73 insertions(+), 3 deletions(-)
24236d363af9404e75dadde2bc99db848843a518

 .../connect/storage/FileOffsetBackingStore.java    |  5 +-
 .../kafka/connect/util/SafeObjectInputStream.java  | 71 ++++++++++++++++++++++
 2 files changed, 73 insertions(+), 3 deletions(-)
acfb9dba90eabc8a941c717eff856d058117c217

 .../connect/storage/FileOffsetBackingStore.java    |  5 +-
 .../kafka/connect/util/SafeObjectInputStream.java  | 71 ++++++++++++++++++++++
 2 files changed, 73 insertions(+), 3 deletions(-)
5ef1c3553fdb9185db1404a151ca9a658e169790

 .../connect/storage/FileOffsetBackingStore.java    |  5 +-
 .../kafka/connect/util/SafeObjectInputStream.java  | 71 ++++++++++++++++++++++
 2 files changed, 73 insertions(+), 3 deletions(-)
da42977a004dc0c9d29c8c28f0f0cd2c06b889ef

 .../connect/storage/FileOffsetBackingStore.java    |  4 +-
 .../kafka/connect/util/SafeObjectInputStream.java  | 71 ++++++++++++++++++++++
 2 files changed, 73 insertions(+), 2 deletions(-)
c63919c27623c975728394f7a7c20690b3d67a69

 .../consumer/internals/AbstractCoordinator.java    |  5 +-
 .../internals/AbstractCoordinatorTest.java         | 67 ++++++++++++++++++----
 2 files changed, 61 insertions(+), 11 deletions(-)
4a7064d1ae323903a0d1353372aabadabebb1ed6

 .../consumer/internals/AbstractCoordinator.java    |  5 +-
 .../internals/AbstractCoordinatorTest.java         | 67 ++++++++++++++++++----
 2 files changed, 61 insertions(+), 11 deletions(-)
5819a364c10951334ffd3f0bf89dd2505b657571

 core/src/main/scala/kafka/tools/JmxTool.scala | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
08b775c322d359e20506069d54f5b92a5a37ce63

 core/src/main/scala/kafka/tools/JmxTool.scala | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
1110f66fa7278212160c6e8392b6e6ab09560452

 docs/streams/developer-guide.html                  |  39 +++++++
 .../org/apache/kafka/streams/KafkaStreams.java     |   2 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |  21 +++-
 .../internals/StreamPartitionAssignor.java         |   2 +-
 .../processor/internals/StreamsKafkaClient.java    |  86 ++++++++------
 .../internals/InternalTopicManagerTest.java        |   3 +-
 .../internals/StreamsKafkaClientTest.java          | 125 ++++++++++++++++++++-
 .../kafka/test/MockInternalTopicManager.java       |   2 +-
 8 files changed, 234 insertions(+), 46 deletions(-)
beb0ad9bbb36a642f5fe4a01d92949ba79299edf

 docs/quickstart.html | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)
ad6c53d89e5dac2e6d3fa9e3df9c597d0d52e485

 .../main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
67fbe049df11a0081f25b076b28ab3c39b6b6a82

 core/src/main/scala/kafka/log/LogCleaner.scala     |  3 +++
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 25 ++++++++++++++++++++++
 2 files changed, 28 insertions(+)
cd207dd3feb08052a82db90d2e5da956bad5ac33

 core/src/main/scala/kafka/log/LogCleaner.scala     |  3 +++
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 25 ++++++++++++++++++++++
 2 files changed, 28 insertions(+)
20adcbd8a48ce325e694fb0bce15fc00684116a3

 docs/security.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1d2d0bac9ea61de38b1afa6ab301a0a9a05f5758

 docs/security.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3b00f8b83f5d0ce0e2d3d7281164675872331225

 docs/connect.html | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
8a81566214a6028f58d35c04cde8ccc7edc71960

 docs/connect.html | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
97b24d820d8ea4cd9698affefcc65277bcf6c3ec

 tests/docker/Dockerfile                 | 7 ++++---
 tests/kafkatest/services/kafka/kafka.py | 1 +
 2 files changed, 5 insertions(+), 3 deletions(-)
b0ff6ea9aa1c2a9c2fc02b5fc5674efa74ef6ee4

 tests/docker/Dockerfile                 | 7 ++++---
 tests/kafkatest/services/kafka/kafka.py | 1 +
 2 files changed, 5 insertions(+), 3 deletions(-)
9ae09e80591f2deec3b89686dee5752a6be4adc7

 tests/docker/Dockerfile                 | 7 ++++---
 tests/kafkatest/services/kafka/kafka.py | 1 +
 2 files changed, 5 insertions(+), 3 deletions(-)
5bb53e034e4f8a06550dd06377fae7b3c2137ce2

 .../kafka/clients/consumer/internals/Fetcher.java  |  22 +-
 .../clients/consumer/internals/FetcherTest.java    | 590 +++++++++++----------
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |   2 +-
 .../kafka/api/LegacyAdminClientTest.scala          |   6 +
 docs/upgrade.html                                  |   2 +
 5 files changed, 327 insertions(+), 295 deletions(-)
930eefdab9a0fb7151f8382ca157a3ed9626fd4a

 core/src/main/scala/kafka/server/KafkaApis.scala   | 23 +++++----
 .../scala/unit/kafka/server/KafkaApisTest.scala    | 57 ++++++++++++++++++++++
 2 files changed, 71 insertions(+), 9 deletions(-)
cdff011fe02cb8e14cb5bf226e47b83cbbec8f3c

 core/src/main/scala/kafka/server/KafkaApis.scala   | 23 +++++----
 .../scala/unit/kafka/server/KafkaApisTest.scala    | 57 ++++++++++++++++++++++
 2 files changed, 71 insertions(+), 9 deletions(-)
32c086317edf7a8412cad174bfa14ebcfdeef275

 vagrant/vagrant-up.sh | 32 +++++++++++++++++---------------
 1 file changed, 17 insertions(+), 15 deletions(-)
bafdc980a091f9435df90240475b1245bc5d3d5d

 vagrant/vagrant-up.sh | 32 +++++++++++++++++---------------
 1 file changed, 17 insertions(+), 15 deletions(-)
c1e20261988b6a33fe919e3a3f6af3cbe8fb343f

 vagrant/vagrant-up.sh | 32 +++++++++++++++++---------------
 1 file changed, 17 insertions(+), 15 deletions(-)
8ebe41175eab62a734d8afa15db2de8e46cd316e

 vagrant/vagrant-up.sh | 32 +++++++++++++++++---------------
 1 file changed, 17 insertions(+), 15 deletions(-)
9b7a6ee2a9eabbeca2000c2d1831bc11fcc4a41f

 vagrant/vagrant-up.sh | 32 +++++++++++++++++---------------
 1 file changed, 17 insertions(+), 15 deletions(-)
b04bed022aec0f1f478a03383ab5184f048133b6

 checkstyle/suppressions.xml                        |   4 +-
 .../kafka/streams/processor/TopologyBuilder.java   | 144 ++++++-
 .../streams/processor/TopologyDescription.java     | 476 +++++++++++++++++++++
 .../kafka/streams/processor/TopologyTest.java      | 405 ++++++++++++++++++
 4 files changed, 1012 insertions(+), 17 deletions(-)
4b968afef2f41e128b7cccd42dbac21574007f66

 .../kafka/clients/consumer/internals/ConsumerCoordinator.java      | 2 +-
 .../kafka/clients/consumer/internals/ConsumerCoordinatorTest.java  | 7 +++++++
 2 files changed, 8 insertions(+), 1 deletion(-)
e0099e1f5852536918bfa27b4d1c33779e45ab6b

 .../kafka/clients/consumer/internals/ConsumerCoordinator.java      | 2 +-
 .../kafka/clients/consumer/internals/ConsumerCoordinatorTest.java  | 7 +++++++
 2 files changed, 8 insertions(+), 1 deletion(-)
fe4a469fce5a47b89083781ed8a03d0d71428aeb

 .../org/apache/kafka/streams/kstream/KStream.java  | 228 ++++++++++++++++++++-
 .../org/apache/kafka/streams/kstream/KTable.java   |  16 +-
 .../kafka/streams/kstream/PrintForeachAction.java  |  16 +-
 .../streams/kstream/internals/KStreamImpl.java     |  93 ++++++---
 .../streams/kstream/internals/KTableImpl.java      |  42 ++--
 .../kstream/internals/KStreamPrintTest.java        |  46 ++++-
 6 files changed, 374 insertions(+), 67 deletions(-)
84d2b6a01c0fd71ee18fdf2364d85473d78c2b2f

 .gitignore                                         |  1 +
 .../scala/kafka/server/ClientQuotaManager.scala    | 30 ++++++++++------------
 .../kafka/server/ReplicationQuotaManager.scala     | 13 +++++-----
 .../src/main/scala/kafka/server/SensorAccess.scala | 21 +++++++--------
 4 files changed, 29 insertions(+), 36 deletions(-)
272956f03a54ef4f476d6f6f49c0cf74e5daf7d0

 .../scala/kafka/common/ZkNodeChangeNotificationListener.scala    | 4 ++--
 .../main/scala/kafka/consumer/ZookeeperTopicEventWatcher.scala   | 2 +-
 .../unit/kafka/consumer/ZookeeperConsumerConnectorTest.scala     | 9 ++-------
 3 files changed, 5 insertions(+), 10 deletions(-)
2452201c57c42882cef56f6980bcd71a14ccf86b

 docs/ops.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0816e47bfe7e7999084a2448a39826166c8fff08

 docs/ops.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a6c108d3bcbe7e89cea501008f3f5ebf22b499e1

 .../main/java/org/apache/kafka/clients/admin/ConfigEntry.java | 11 +++++++++++
 1 file changed, 11 insertions(+)
1b8aed6dc52e5d2f7ba29e4589baf15d53ad2870

 .../main/java/org/apache/kafka/clients/admin/ConfigEntry.java | 11 +++++++++++
 1 file changed, 11 insertions(+)
43aa14f2dc47b36b86d644c08794118e82869c74

 config/server.properties | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
9b7af79a1441aef612e2e0eadbe057afcb5ce3c8

 tests/kafkatest/services/console_consumer.py | 37 +++++++++++++++-------------
 1 file changed, 20 insertions(+), 17 deletions(-)
021960be87c3b69bf867e153d58cc7d0e3e989b2

 tests/kafkatest/services/console_consumer.py | 40 +++++++++++++++-------------
 1 file changed, 21 insertions(+), 19 deletions(-)
acfcc1f9155a4a93a401827058c22704250c717d

 core/src/main/scala/kafka/tools/JmxTool.scala | 42 +++++++++++++++++++++------
 tests/kafkatest/services/console_consumer.py  | 40 +++++++++++++------------
 tests/kafkatest/services/monitor/jmx.py       | 11 +++++--
 3 files changed, 64 insertions(+), 29 deletions(-)
f50af9c31df6fc6febba51d39293051efc82cec9

 core/src/main/scala/kafka/tools/JmxTool.scala | 42 +++++++++++++++++++++------
 tests/kafkatest/services/console_consumer.py  | 40 +++++++++++++------------
 tests/kafkatest/services/monitor/jmx.py       | 11 +++++--
 3 files changed, 64 insertions(+), 29 deletions(-)
f87d58b796977fdaefb089d17cb30b2071cd4485

 .../kafka/clients/producer/KafkaProducer.java      |   3 +-
 .../producer/internals/TransactionManager.java     |   1 -
 .../requests/OffsetsForLeaderEpochRequest.java     |   4 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  17 +-
 .../kafka/clients/producer/KafkaProducerTest.java  |  33 ++--
 .../kafka/clients/producer/MockProducerTest.java   |  71 +++++++-
 .../clients/producer/internals/SenderTest.java     |   9 +-
 .../common/utils/ByteBufferOutputStreamTest.java   |  10 +-
 .../connect/file/FileStreamSourceTaskTest.java     |   1 +
 .../kafka/connect/runtime/isolation/Plugins.java   |   1 -
 .../connect/storage/FileOffsetBackingStore.java    |   4 +-
 .../runtime/WorkerSinkTaskThreadedTest.java        |   1 -
 .../storage/KafkaConfigBackingStoreTest.java       |  17 +-
 .../apache/kafka/connect/util/TopicAdminTest.java  |   1 -
 .../apache/kafka/connect/transforms/CastTest.java  | 144 +++++++---------
 .../kafka/connect/transforms/ExtractFieldTest.java |   9 +-
 .../kafka/connect/transforms/FlattenTest.java      |  54 +++---
 .../kafka/connect/transforms/HoistFieldTest.java   |   9 +-
 .../kafka/connect/transforms/InsertFieldTest.java  |  14 +-
 .../kafka/connect/transforms/RegexRouterTest.java  |   5 +-
 .../kafka/connect/transforms/ReplaceFieldTest.java |  11 +-
 .../connect/transforms/SetSchemaMetadataTest.java  |  11 +-
 .../connect/transforms/TimestampConverterTest.java | 128 ++++++--------
 .../connect/transforms/TimestampRouterTest.java    |   8 +-
 .../kafka/connect/transforms/ValueToKeyTest.java   |   9 +-
 .../org/apache/kafka/streams/kstream/KStream.java  |   1 -
 .../kafka/streams/kstream/KStreamBuilder.java      |   6 +-
 .../kstream/internals/KGroupedStreamImpl.java      |   7 -
 .../kstream/internals/KTableKTableJoin.java        |   1 -
 .../kstream/internals/KTableKTableLeftJoin.java    |   1 -
 .../kstream/internals/KTableKTableOuterJoin.java   |   1 -
 .../kstream/internals/KTableKTableRightJoin.java   |   1 -
 .../processor/internals/GlobalStateUpdateTask.java |   1 -
 .../streams/processor/internals/StreamThread.java  |   1 -
 .../internals/assignment/AssignmentInfo.java       |   4 +-
 .../apache/kafka/streams/state/StateSerdes.java    |   1 -
 .../state/internals/CachingKeyValueStore.java      |   1 -
 .../state/internals/CachingWindowStore.java        |   1 -
 .../ChangeLoggingSegmentedBytesStore.java          |   1 -
 .../streams/state/internals/RocksDBStore.java      |   1 -
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  10 +-
 ...KStreamSessionWindowAggregateProcessorTest.java |   2 -
 .../internals/WindowedStreamPartitionerTest.java   |   6 +
 .../streams/processor/TopologyBuilderTest.java     |  14 +-
 .../processor/internals/QuickUnionTest.java        |   1 -
 .../processor/internals/StandbyTaskTest.java       |   2 -
 .../internals/StreamPartitionAssignorTest.java     |   1 -
 .../processor/internals/StreamTaskTest.java        |   1 -
 .../streams/state/KeyValueStoreTestDriver.java     |   1 -
 .../ChangeLoggingSegmentedBytesStoreTest.java      |   3 -
 .../CompositeReadOnlyKeyValueStoreTest.java        |   4 -
 .../DelegatingPeekingKeyValueIteratorTest.java     |   5 +
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |   2 +
 ...dSortedCacheWrappedWindowStoreIteratorTest.java |   3 +
 .../internals/MeteredSegmentedBytesStoreTest.java  |   1 -
 .../RocksDBKeyValueStoreSupplierTest.java          |   2 -
 .../internals/RocksDBSessionStoreSupplierTest.java |   3 -
 .../internals/RocksDBWindowStoreSupplierTest.java  |   3 -
 .../state/internals/StoreChangeLoggerTest.java     |   2 -
 .../streams/tests/BrokerCompatibilityTest.java     |   1 +
 .../kafka/streams/tests/SmokeTestDriver.java       |   1 -
 .../kafka/tools/ClientCompatibilityTest.java       | 187 +++++++++++----------
 62 files changed, 419 insertions(+), 440 deletions(-)
63a06c853e51232fd30c80d7d0f6e1cc717ef679

 .../org/apache/kafka/common/config/TopicConfig.java    |  2 +-
 docs/configuration.html                                | 18 +++++++++---------
 docs/ops.html                                          |  4 ++--
 docs/toc.html                                          | 15 ++++++++-------
 4 files changed, 20 insertions(+), 19 deletions(-)
3bfc073f03e02bd34c813ee424864b5ace628aae

 .../org/apache/kafka/common/config/TopicConfig.java    |  2 +-
 docs/configuration.html                                | 18 +++++++++---------
 docs/ops.html                                          |  4 ++--
 docs/toc.html                                          | 15 ++++++++-------
 4 files changed, 20 insertions(+), 19 deletions(-)
fc0ea25025df8af5079e8142ba085939b3c9c073

 .../java/org/apache/kafka/common/errors/CorruptRecordException.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ea8845bbd6a8b0b3b930c637461c8da2fc84c342

 config/server.properties                           |  3 ---
 core/src/main/scala/kafka/server/KafkaConfig.scala |  2 +-
 docs/upgrade.html                                  | 11 +++++++++++
 3 files changed, 12 insertions(+), 4 deletions(-)
bbc390018571602fb4fb77609093d450ab95a4c0

 .../kafka/log4jappender/KafkaLog4jAppender.java    | 85 +++++++++++-----------
 .../log4jappender/MockKafkaLog4jAppender.java      |  5 +-
 2 files changed, 44 insertions(+), 46 deletions(-)
81ceed30dc6f7e8063a2368a830d0e366513000f

 clients/src/test/java/org/apache/kafka/common/network/SelectorTest.java | 1 -
 1 file changed, 1 deletion(-)
454f0f1ca1eccbeba6c459ce62c8e1caa4cf9a70

 clients/src/test/java/org/apache/kafka/common/network/SelectorTest.java | 1 -
 1 file changed, 1 deletion(-)
7f96aa36fbb1474e9bc5c8189640136cdc97df8f

 tests/kafkatest/services/console_consumer.py | 37 +++++++++++++---------------
 1 file changed, 17 insertions(+), 20 deletions(-)
40e36fccb6d6075e206347489391e46d505d6004

 tests/kafkatest/services/console_consumer.py | 40 +++++++++++++---------------
 1 file changed, 19 insertions(+), 21 deletions(-)
78d211404981a7e7847f6d3254957510f10f4b25

 tests/kafkatest/services/console_consumer.py | 40 +++++++++++++---------------
 1 file changed, 19 insertions(+), 21 deletions(-)
d663005fddcebafba439473299dc4c6ad74c966c

 tests/kafkatest/services/console_consumer.py | 40 +++++++++++++---------------
 1 file changed, 19 insertions(+), 21 deletions(-)
693318d2aeaa89f68acccbd5ac1618f85a08130a

 clients/out/test/resources/log4j.properties        |  21 ++++++++
 .../serializedData/offsetAndMetadataSerializedfile | Bin 0 -> 144 bytes
 .../serializedData/topicPartitionSerializedfile    | Bin 0 -> 125 bytes
 .../org/apache/kafka/common/network/Selector.java  |  18 ++++---
 .../apache/kafka/common/network/SelectorTest.java  |  54 +++++++++++++++++++++
 5 files changed, 86 insertions(+), 7 deletions(-)
28c83d9667676515607713d4ccfd3757a8afcba2

 clients/out/test/resources/log4j.properties        |  21 ++++++++
 .../serializedData/offsetAndMetadataSerializedfile | Bin 0 -> 144 bytes
 .../serializedData/topicPartitionSerializedfile    | Bin 0 -> 125 bytes
 .../org/apache/kafka/common/network/Selector.java  |  18 ++++---
 .../apache/kafka/common/network/SelectorTest.java  |  54 +++++++++++++++++++++
 5 files changed, 86 insertions(+), 7 deletions(-)
3a515505e07fb4ccc961afcf52b5bad5fbf57e0f

 .../coordinator/group/GroupMetadataManager.scala   | 86 +++++++++++-----------
 .../group/GroupMetadataManagerTest.scala           | 66 ++++++++++++++++-
 2 files changed, 105 insertions(+), 47 deletions(-)
e2fe19d22a42525001c5a66f21f02f49c051ecb5

 .../coordinator/group/GroupMetadataManager.scala   | 86 +++++++++++-----------
 .../group/GroupMetadataManagerTest.scala           | 66 ++++++++++++++++-
 2 files changed, 105 insertions(+), 47 deletions(-)
6d7a81b478e1f36d7632c84d34280c22a2f717b1

 .../src/main/java/org/apache/kafka/connect/data/SchemaBuilder.java   | 2 ++
 .../test/java/org/apache/kafka/connect/data/SchemaBuilderTest.java   | 5 +++++
 2 files changed, 7 insertions(+)
973f9d2b2a308f81ba33fb2e9613d1c729e2b023

 .../main/java/org/apache/kafka/common/network/KafkaChannel.java  | 2 +-
 core/src/main/scala/kafka/network/SocketServer.scala             | 9 +++++----
 2 files changed, 6 insertions(+), 5 deletions(-)
cf94b188f1678276a4a6df6b87d89f2d4d2e922c

 .../main/java/org/apache/kafka/common/network/KafkaChannel.java  | 2 +-
 core/src/main/scala/kafka/network/SocketServer.scala             | 9 +++++----
 2 files changed, 6 insertions(+), 5 deletions(-)
d0ce0a95de8c5451d73dcc87f3f9b6c03f5f85de

 .../scala/kafka/tools/ConsumerPerformance.scala    | 39 +++++++++++++-----
 .../unit/kafka/tools/ConsumerPerformanceTest.scala | 46 ++++++++++++++++++++++
 2 files changed, 76 insertions(+), 9 deletions(-)
335b9e48e09e2f0556f2a340870aa9a4a71f801b

 .../scala/kafka/coordinator/group/GroupCoordinator.scala     | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)
873eeae9f7ae661d27df5351c0001b785dc40956

 .../scala/kafka/coordinator/group/GroupCoordinator.scala     | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)
1685e7112c5d4dc723ffcfa219febaed045b6426

 build.gradle                                       | 22 ++++++++++++++++-
 .../kafka/admin/BrokerApiVersionsCommand.scala     |  3 +--
 .../scala/kafka/admin/DeleteRecordsCommand.scala   |  2 --
 core/src/main/scala/kafka/admin/TopicCommand.scala |  2 +-
 .../scala/kafka/admin/ZkSecurityMigrator.scala     |  2 --
 .../kafka/api/ControlledShutdownResponse.scala     |  2 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |  1 -
 .../scala/kafka/api/TopicMetadataRequest.scala     |  2 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |  2 --
 .../scala/kafka/common/TopicAndPartition.scala     |  1 -
 .../scala/kafka/consumer/ConsumerConnector.scala   |  2 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |  2 --
 .../scala/kafka/consumer/ConsumerIterator.scala    |  2 +-
 .../main/scala/kafka/consumer/KafkaStream.scala    |  2 +-
 .../scala/kafka/consumer/PartitionAssignor.scala   |  1 -
 .../controller/ControllerChannelManager.scala      | 20 ++--------------
 .../scala/kafka/controller/KafkaController.scala   |  2 +-
 ...TransactionMarkerRequestCompletionHandler.scala | 10 ++++----
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |  2 +-
 .../scala/kafka/javaapi/producer/Producer.scala    |  2 +-
 core/src/main/scala/kafka/log/AbstractIndex.scala  |  6 ++---
 .../main/scala/kafka/log/LogCleanerManager.scala   |  2 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    |  5 ++--
 core/src/main/scala/kafka/log/TimeIndex.scala      |  9 +++----
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |  4 ++--
 core/src/main/scala/kafka/producer/Producer.scala  |  2 +-
 .../scala/kafka/producer/async/EventHandler.scala  |  2 +-
 .../kafka/producer/async/ProducerSendThread.scala  |  2 +-
 core/src/main/scala/kafka/security/auth/Acl.scala  | 21 ++++++++--------
 .../scala/kafka/server/ClientQuotaManager.scala    |  2 +-
 .../main/scala/kafka/utils/IteratorTemplate.scala  |  4 ++--
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  4 ++--
 .../kafka/admin/BrokerApiVersionsCommandTest.scala |  2 +-
 .../kafka/api/AdminClientIntegrationTest.scala     |  2 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  2 +-
 .../kafka/api/EndToEndAuthorizationTest.scala      | 28 ++++++++++------------
 .../kafka/api/EndToEndClusterIdTest.scala          |  2 +-
 .../integration/kafka/api/ProducerBounceTest.scala |  2 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |  2 +-
 .../kafka/api/RackAwareAutoTopicCreationTest.scala |  2 +-
 .../kafka/api/SaslEndToEndAuthorizationTest.scala  |  2 +-
 .../kafka/api/TransactionsBounceTest.scala         | 13 +++++-----
 .../kafka/tools/MirrorMakerIntegrationTest.scala   |  4 ++--
 .../scala/unit/kafka/admin/AddPartitionsTest.scala | 12 +++++-----
 .../unit/kafka/admin/DeleteConsumerGroupTest.scala |  2 +-
 .../kafka/admin/DescribeConsumerGroupTest.scala    |  3 ++-
 .../unit/kafka/admin/ListConsumerGroupTest.scala   |  3 ++-
 .../admin/ReassignPartitionsClusterTest.scala      |  4 ++--
 .../admin/ReassignPartitionsCommandTest.scala      |  2 +-
 .../unit/kafka/cluster/BrokerEndPointTest.scala    |  2 +-
 .../ZkNodeChangeNotificationListenerTest.scala     |  4 ++--
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  4 ++--
 .../kafka/controller/ControllerFailoverTest.scala  |  2 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |  2 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  2 +-
 .../MetricsDuringTopicCreationDeletionTest.scala   |  2 +-
 .../unit/kafka/integration/MinIsrConfigTest.scala  |  2 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  2 +-
 .../unit/kafka/integration/TopicMetadataTest.scala | 22 ++++++++---------
 .../integration/UncleanLeaderElectionTest.scala    | 14 +++++------
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  3 ++-
 .../javaapi/message/BaseMessageSetTestCases.scala  |  2 +-
 .../test/scala/unit/kafka/log/TimeIndexTest.scala  |  2 +-
 .../unit/kafka/log/TransactionIndexTest.scala      |  4 ++--
 .../scala/unit/kafka/message/MessageTest.scala     |  2 +-
 .../scala/unit/kafka/metrics/MetricsTest.scala     |  2 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  2 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  2 +-
 .../kafka/security/auth/ZkAuthorizationTest.scala  |  2 +-
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |  6 ++---
 .../scala/unit/kafka/server/ApiVersionsTest.scala  |  2 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |  2 +-
 .../kafka/server/DynamicConfigChangeTest.scala     | 11 ++++-----
 .../unit/kafka/server/EdgeCaseRequestTest.scala    |  2 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  8 +++----
 .../unit/kafka/server/ServerStartupTest.scala      | 10 ++++----
 .../server/epoch/LeaderEpochIntegrationTest.scala  |  2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  8 +++----
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala | 16 ++++++-------
 83 files changed, 186 insertions(+), 202 deletions(-)
e391045473f258562d55bbc07faafe75ec7213ac

 .../consumer/ZookeeperConsumerConnector.scala      | 35 +++++--------
 .../scala/kafka/controller/KafkaController.scala   | 44 ++++++++--------
 .../kafka/controller/ReplicaStateMachine.scala     |  2 +-
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |  6 +--
 .../kafka/network/RequestOrResponseSend.scala      |  6 +--
 .../kafka/producer/async/DefaultEventHandler.scala |  5 +-
 core/src/main/scala/kafka/security/auth/Acl.scala  | 26 +++++-----
 core/src/main/scala/kafka/server/KafkaServer.scala | 58 +++++++++++-----------
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 47 ++++++------------
 .../scala/kafka/tools/StateChangeLogMerger.scala   | 18 +++----
 .../main/scala/kafka/utils/ReplicationUtils.scala  | 18 +++----
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 48 +++++++-----------
 .../integration/kafka/api/ConsumerBounceTest.scala | 10 ++--
 .../util/ReplicaFetcherMockBlockingSend.scala      |  5 +-
 14 files changed, 133 insertions(+), 195 deletions(-)
f0cd6af6d94ad61e8b3fc257b89d574db2029c86

 core/src/main/scala/kafka/log/Log.scala          | 11 ++++++++++-
 core/src/test/scala/unit/kafka/log/LogTest.scala | 13 +++++++++++++
 2 files changed, 23 insertions(+), 1 deletion(-)
2d2e9adb5d8d3805f082208ae9dd241f87566b27

 core/src/main/scala/kafka/log/Log.scala          | 11 ++++++++++-
 core/src/test/scala/unit/kafka/log/LogTest.scala | 13 +++++++++++++
 2 files changed, 23 insertions(+), 1 deletion(-)
0547a082545277dc119aa96dd8b8124949703be0

 .../connect/runtime/rest/resources/ConnectorPluginsResourceTest.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
ef275159432fd5fe88204783b621165ec39293d8

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
07bd394676de9fbeac11f88fe8fc8604689f47db

 .../java/org/apache/kafka/streams/integration/EosIntegrationTest.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8068a3560b1896f25bdc664acd50d9c4d84f7baa

 .../java/org/apache/kafka/streams/integration/EosIntegrationTest.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
44167399157b06d566401a3f6c17e9ca901a8c20

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9c6fc95f9161cc5c3347d36cb3d2616fd0255cad

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
dbf83c28e92e660c72268cf28bc8c24d67065e5a

 .../org/apache/kafka/streams/StreamsConfig.java    | 35 +++++++---------
 .../apache/kafka/streams/StreamsConfigTest.java    | 46 ++++++++++++++++++++++
 2 files changed, 61 insertions(+), 20 deletions(-)
2628695356de87aba7d046855fbe1f1963d3f911

 .../org/apache/kafka/streams/StreamsConfig.java    | 35 +++++++---------
 .../apache/kafka/streams/StreamsConfigTest.java    | 46 ++++++++++++++++++++++
 2 files changed, 61 insertions(+), 20 deletions(-)
990382b94cfeb7a73a93ccbfd92e80f0f62fc7b0

 .../integration/QueryableStateIntegrationTest.java | 36 +++++++++++++---------
 1 file changed, 22 insertions(+), 14 deletions(-)
a1f97c8dc4edd49c7a8a2ebb72734728029a85aa

 .../org/apache/kafka/streams/StreamsConfig.java    | 18 +++++
 .../errors/DeserializationExceptionHandler.java    | 60 +++++++++++++++++
 .../errors/LogAndContinueExceptionHandler.java     | 52 +++++++++++++++
 .../streams/errors/LogAndFailExceptionHandler.java | 52 +++++++++++++++
 .../processor/internals/GlobalStateUpdateTask.java | 45 ++++++-------
 .../processor/internals/GlobalStreamThread.java    |  3 +-
 .../streams/processor/internals/ProcessorNode.java |  3 +
 .../streams/processor/internals/RecordQueue.java   | 21 ++++--
 .../internals/SourceNodeRecordDeserializer.java    | 34 +++++++++-
 .../streams/processor/internals/StreamTask.java    | 21 +++---
 .../processor/internals/GlobalStateTaskTest.java   | 77 ++++++++++++++++++++--
 .../processor/internals/PartitionGroupTest.java    |  5 +-
 .../processor/internals/RecordQueueTest.java       | 60 +++++++++++++++--
 .../SourceNodeRecordDeserializerTest.java          |  6 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |  3 +-
 15 files changed, 403 insertions(+), 57 deletions(-)
6dc04fe8b2dcef0da860f49ca7baa0b36bdbb45a

 docs/streams/quickstart.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
6a5cd67b9bf38acd4fe437bc385747aaf7bd91e7

 docs/streams/quickstart.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
123ffb5e293e6440ba3019693ee8a20dc6d450c5

 docs/documentation/streams/quickstart.html |  19 +++
 docs/quickstart.html                       | 167 +------------------
 docs/streams/architecture.html             |   2 +-
 docs/streams/core-concepts.html            |   4 +-
 docs/streams/developer-guide.html          |   4 +-
 docs/streams/index.html                    |   5 +-
 docs/streams/quickstart.html               | 258 +++++++++++++++++++++++++++++
 docs/streams/upgrade-guide.html            |   4 +-
 8 files changed, 294 insertions(+), 169 deletions(-)
7bfe008ae1a2bb2fa98c3a765be5022e75cd151d

 docs/documentation/streams/quickstart.html |  19 +++
 docs/quickstart.html                       | 167 +------------------
 docs/streams/architecture.html             |   2 +-
 docs/streams/core-concepts.html            |   4 +-
 docs/streams/developer-guide.html          |   4 +-
 docs/streams/index.html                    |   5 +-
 docs/streams/quickstart.html               | 258 +++++++++++++++++++++++++++++
 docs/streams/upgrade-guide.html            |   4 +-
 8 files changed, 294 insertions(+), 169 deletions(-)
bb8eff1e70491c4ce2dad07249d769b467f4068e

 .../org/apache/kafka/streams/state/internals/ThreadCache.java  | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)
fab75162e53928d428d7280edf2eefa6e62e796a

 .../apache/kafka/streams/processor/internals/StreamsKafkaClient.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3d721433dedbf52fcec41a1b193105f6efd5e592

 .../apache/kafka/streams/processor/internals/StreamsKafkaClient.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
35f9fa804b0391492d7914f60e9b1ae94c223ad9

 .../apache/kafka/streams/processor/internals/StreamsKafkaClient.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a7a5d66bac9cb62130c7f3ca8a8480395c75a09a

 docs/streams/index.html | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
75f1b757e19d40738cbd5e6154ea9afccab7977a

 docs/streams/index.html | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
98a47acdd8af8a1c491e17ff18d0023ada1fad4e

 docs/api.html           | 8 ++++----
 docs/js/templateData.js | 5 +++--
 docs/quickstart.html    | 8 ++++----
 3 files changed, 11 insertions(+), 10 deletions(-)
c574c58a16147d2d4997145bc47b0ba558d68a36

 docs/api.html           | 8 ++++----
 docs/js/templateData.js | 5 +++--
 docs/quickstart.html    | 8 ++++----
 3 files changed, 11 insertions(+), 10 deletions(-)
c3f1aeeceb9153f673ce5e933682daeb644d4b43

 .../kafka/streams/integration/QueryableStateIntegrationTest.java   | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
071b8f975f3f4eeb5659ffe04dbffafa0c8ab263

 .../kafka/streams/integration/QueryableStateIntegrationTest.java   | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
4be8577746c8b8dba3955433f0d8d69ba43ed97e

 tests/kafkatest/tests/streams/streams_eos_test.py | 5 +++++
 1 file changed, 5 insertions(+)
6ea36bc6fbd7bf73dbbd0e097353f6caf89b9488

 tests/kafkatest/tests/streams/streams_eos_test.py | 5 +++++
 1 file changed, 5 insertions(+)
0046a881d389878bbb673c2591c06fd667923964

 .../processor/internals/StreamThreadTest.java      | 34 +++++++++++++++++-----
 1 file changed, 27 insertions(+), 7 deletions(-)
317de45d1aabc62d69ab891edeab3c519b483546

 docs/ops.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
6d203361a04380d8fb0f23c0bfcb37811eccb590

 docs/ops.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
9078554232f9de56849b5c35bf45b81a67a748c4

 .../org/apache/kafka/streams/KafkaStreams.java     | 332 +++++++++++++++------
 .../processor/internals/GlobalStreamThread.java    | 135 ++++++++-
 .../streams/processor/internals/StreamThread.java  | 120 +++++---
 .../internals/ThreadStateTransitionValidator.java  |  24 ++
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 149 ++++++++-
 .../internals/GlobalStreamThreadTest.java          |  48 ++-
 .../processor/internals/StreamThreadTest.java      | 247 +++++++++------
 streams/src/test/resources/log4j.properties        |   4 +-
 8 files changed, 808 insertions(+), 251 deletions(-)
5015c4cb07c19097ba13bc29210f9e16947ae7c3

 .../apache/kafka/streams/processor/internals/StreamsKafkaClient.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
784be9bd1ba279641f99411fab566ca936d3a5ed

 .../apache/kafka/streams/processor/internals/StreamsKafkaClient.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
f53f5eaa1bce0129bac7b8ffac3a8da11d2ee574

 .../apache/kafka/streams/processor/internals/StreamsKafkaClient.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
e68a94056fa7eb5b8d69815bcfa522247568d3e9

 .../internals/StreamPartitionAssignor.java         | 53 ++++++++++++----------
 1 file changed, 28 insertions(+), 25 deletions(-)
c50bee94a3155822cc9d448673965b9d9f9ace54

 .../streams/processor/internals/StreamThread.java  |  26 ++-
 .../processor/internals/StreamThreadTest.java      | 213 ++++++++++++++++++++-
 2 files changed, 231 insertions(+), 8 deletions(-)
70e949d522eba72b22c2619c4fde372d0f1a26b3

 .../streams/processor/internals/StreamThread.java  |  26 ++-
 .../processor/internals/StreamThreadTest.java      | 213 ++++++++++++++++++++-
 2 files changed, 231 insertions(+), 8 deletions(-)
97f5525cabbe29b17577e771e05d3daa5d6c53cd

 docs/images/streams-interactive-queries-01.png     | Bin 0 -> 80976 bytes
 docs/images/streams-interactive-queries-02.png     | Bin 0 -> 73218 bytes
 docs/images/streams-interactive-queries-03.png     | Bin 0 -> 79879 bytes
 docs/images/streams-interactive-queries-api-01.png | Bin 0 -> 84438 bytes
 docs/images/streams-interactive-queries-api-02.png | Bin 0 -> 100725 bytes
 docs/streams/developer-guide.html                  | 518 +++++++++++++++++++++
 docs/streams/index.html                            |   1 +
 7 files changed, 519 insertions(+)
ec2faa179663b1d440e5de243063947c70df3837

 docs/documentation/index.html                   |   18 +
 docs/documentation/streams.html                 |   19 -
 docs/documentation/streams/architecture.html    |   19 +
 docs/documentation/streams/core-concepts.html   |   19 +
 docs/documentation/streams/developer-guide.html |   19 +
 docs/documentation/streams/index.html           |   19 +
 docs/documentation/streams/upgrade-guide.html   |   19 +
 docs/streams.html                               | 1079 -----------------------
 docs/streams/architecture.html                  |  160 ++++
 docs/streams/core-concepts.html                 |  165 ++++
 docs/streams/developer-guide.html               |  606 +++++++++++++
 docs/streams/index.html                         |   94 ++
 docs/streams/upgrade-guide.html                 |  248 ++++++
 13 files changed, 1386 insertions(+), 1098 deletions(-)
3ab0456db839d8959b2846b9a7e4cc28b4c822c7

 .../main/scala/kafka/tools/StreamsResetter.java    | 41 ++++++++++------------
 1 file changed, 18 insertions(+), 23 deletions(-)
6cae5ec6687bdb0ba12c9f8a2c54008ce4d2334f

 docs/images/streams-interactive-queries-01.png     | Bin 0 -> 80976 bytes
 docs/images/streams-interactive-queries-02.png     | Bin 0 -> 73218 bytes
 docs/images/streams-interactive-queries-03.png     | Bin 0 -> 79879 bytes
 docs/images/streams-interactive-queries-api-01.png | Bin 0 -> 84438 bytes
 docs/images/streams-interactive-queries-api-02.png | Bin 0 -> 100725 bytes
 docs/streams/developer-guide.html                  | 518 +++++++++++++++++++++
 docs/streams/index.html                            |   1 +
 7 files changed, 519 insertions(+)
48c2160c75e24bae61133eb932a790fdf80e7ca9

 core/src/test/scala/integration/kafka/api/ConsumerBounceTest.scala | 3 +++
 1 file changed, 3 insertions(+)
ef5867dce3894aa57a8f815aa206693e2530b576

 .../kafka/streams/processor/internals/InternalTopicConfig.java | 10 ++++++++++
 .../streams/processor/internals/StreamPartitionAssignor.java   | 10 +++++++++-
 2 files changed, 19 insertions(+), 1 deletion(-)
afb91a02ae1ef8aab6a33335eec0a07490b36390

 .../scala/unit/kafka/integration/KafkaServerTestHarness.scala    | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)
cbafc08a5f25df58d33093b2e6015e8c49fefdea

 tests/kafkatest/tests/streams/streams_broker_compatibility_test.py | 4 +++-
 tests/kafkatest/tests/streams/streams_upgrade_test.py              | 5 ++++-
 2 files changed, 7 insertions(+), 2 deletions(-)
2c6e9a9653ffd19f4c9407cd74a89a8d7deb8b3f

 docs/documentation/index.html                   |   18 +
 docs/documentation/streams.html                 |   19 -
 docs/documentation/streams/architecture.html    |   19 +
 docs/documentation/streams/core-concepts.html   |   19 +
 docs/documentation/streams/developer-guide.html |   19 +
 docs/documentation/streams/index.html           |   19 +
 docs/documentation/streams/upgrade-guide.html   |   19 +
 docs/streams.html                               | 1078 -----------------------
 docs/streams/architecture.html                  |  160 ++++
 docs/streams/core-concepts.html                 |  165 ++++
 docs/streams/developer-guide.html               |  605 +++++++++++++
 docs/streams/index.html                         |   94 ++
 docs/streams/upgrade-guide.html                 |  248 ++++++
 13 files changed, 1385 insertions(+), 1097 deletions(-)
c9f777cc44269c2e9537eab2451481422e613383

 .../streams/kstream/internals/AbstractStream.java  |  8 ++
 .../kstream/internals/AbstractStreamTest.java      | 99 ++++++++++++++++++++++
 2 files changed, 107 insertions(+)
ab8e9d1755e9527ca76e994dd59a21cc94550312

 .../apache/kafka/connect/data/SchemaBuilder.java   | 10 +++++++
 .../kafka/connect/data/SchemaBuilderTest.java      | 32 ++++++++++++++++++++++
 2 files changed, 42 insertions(+)
793ccd85d9bd2b2769ec2db914628f6c8b3cda98

 core/src/main/scala/kafka/cluster/Replica.scala    |   2 +-
 core/src/main/scala/kafka/log/IndexEntry.scala     |   6 +
 core/src/main/scala/kafka/server/KafkaApis.scala   |  45 ++--
 .../kafka/api/PlaintextConsumerTest.scala          |  16 +-
 .../integration/kafka/api/TransactionsTest.scala   |  41 +++-
 .../scala/unit/kafka/server/KafkaApisTest.scala    | 234 ++++++++++++++++-----
 6 files changed, 249 insertions(+), 95 deletions(-)
9238aeaa2171f7860fd6ae7980608505a63c12ca

 core/src/main/scala/kafka/cluster/Replica.scala    |   2 +-
 core/src/main/scala/kafka/log/IndexEntry.scala     |   6 +
 core/src/main/scala/kafka/server/KafkaApis.scala   |  45 ++--
 .../kafka/api/PlaintextConsumerTest.scala          |  16 +-
 .../integration/kafka/api/TransactionsTest.scala   |  41 +++-
 .../scala/unit/kafka/server/KafkaApisTest.scala    | 235 ++++++++++++++++-----
 6 files changed, 250 insertions(+), 95 deletions(-)
9c2de4920e6035a8fb1d3dd5c6b5a8ccb31c7aa3

 core/src/main/scala/kafka/server/epoch/LeaderEpochFileCache.scala | 4 ++++
 1 file changed, 4 insertions(+)
49ed16daf43b5f28e51fed7cc124cd308de3deca

 tests/docker/Dockerfile                                     |  1 +
 .../tests/client/client_compatibility_features_test.py      |  7 ++++---
 .../client/client_compatibility_produce_consume_test.py     |  3 ++-
 .../tests/core/compatibility_test_new_broker_test.py        | 13 +++++++------
 tests/kafkatest/tests/core/upgrade_test.py                  |  4 +++-
 vagrant/base.sh                                             |  6 ++++--
 6 files changed, 21 insertions(+), 13 deletions(-)
342f34a1994caafa3cea94a2f85ffd219b8cebc5

 .../java/org/apache/kafka/clients/InFlightRequests.java | 17 ++++++-----------
 .../java/org/apache/kafka/clients/NetworkClient.java    |  2 +-
 2 files changed, 7 insertions(+), 12 deletions(-)
ae170a6a16bb2bdd9546f41929babaa8250429ca

 docs/implementation.html | 125 ++++++++++++++++++++++++++++++-----------------
 1 file changed, 79 insertions(+), 46 deletions(-)
6471822079e0bf378ff5bc83f4bd3b71ac0582cf

 docs/implementation.html | 125 ++++++++++++++++++++++++++++++-----------------
 1 file changed, 79 insertions(+), 46 deletions(-)
17bdd4831c0098ea2c50e9bad1bf8ba70352854c

 .../apache/kafka/streams/processor/internals/ProcessorStateManager.java | 2 --
 1 file changed, 2 deletions(-)
7429f49780a69d0c5eda8ef0c69a3209aecee11c

 .../kafka/streams/kstream/KGroupedStream.java      | 66 ++++++++++++++++++++--
 .../kafka/streams/kstream/KGroupedTable.java       | 14 +++--
 2 files changed, 68 insertions(+), 12 deletions(-)
d46513d2c8edf0568800ebc1198140b35a47dcda

 .../streams/processor/internals/StreamTask.java    |  68 +++---
 .../streams/processor/internals/StreamThread.java  |   2 +-
 .../processor/internals/StreamThreadTest.java      | 266 +++++++++++++++++----
 3 files changed, 254 insertions(+), 82 deletions(-)
0dfeb31a116d26023540f6c6074127f0aab00b6d

 .../streams/processor/internals/StreamTask.java    |  68 +++---
 .../streams/processor/internals/StreamThread.java  |   2 +-
 .../processor/internals/StreamThreadTest.java      | 266 +++++++++++++++++----
 3 files changed, 254 insertions(+), 82 deletions(-)
90a176afc9bbc02a63c0aa1ea44cf4aad4737c7b

 .../kafka/common/record/DefaultRecordBatch.java    | 80 +++++++++++++---------
 .../kafka/common/record/MemoryRecordsBuilder.java  | 12 ++--
 .../kafka/common/record/MutableRecordBatch.java    |  2 +-
 .../common/record/DefaultRecordBatchTest.java      |  2 +-
 .../scala/unit/kafka/log/LogValidatorTest.scala    |  2 +-
 5 files changed, 57 insertions(+), 41 deletions(-)
c4193cd1ad8eeed8383a1c2660383c455e848929

 .../kafka/common/record/DefaultRecordBatch.java    | 80 +++++++++++++---------
 .../kafka/common/record/MemoryRecordsBuilder.java  | 12 ++--
 .../kafka/common/record/MutableRecordBatch.java    |  2 +-
 .../common/record/DefaultRecordBatchTest.java      |  2 +-
 .../scala/unit/kafka/log/LogValidatorTest.scala    |  2 +-
 5 files changed, 57 insertions(+), 41 deletions(-)
87658b9b155354426011e35d4838c31b629e5318

 core/src/main/scala/kafka/cluster/Partition.scala | 1 +
 1 file changed, 1 insertion(+)
a16475eb333b0205b74b817237cba187862e61e7

 core/src/main/scala/kafka/cluster/Partition.scala | 1 +
 1 file changed, 1 insertion(+)
026350c4e44a09c5335d559319e85f3066c2cf59

 tests/cluster_file_generator.sh |  63 -----
 tests/docker/Dockerfile         |  31 ++-
 tests/docker/ducker-ak          | 511 ++++++++++++++++++++++++++++++++++++++++
 tests/docker/run_tests.sh       |  52 +---
 tests/docker/ssh-config         |  21 ++
 tests/setup.py                  |   1 +
 6 files changed, 566 insertions(+), 113 deletions(-)
1d27ca822dab3e97b9b295116cbbc90ca7ba92dc

 tests/cluster_file_generator.sh |  63 -----
 tests/docker/Dockerfile         |  32 ++-
 tests/docker/ducker-ak          | 511 ++++++++++++++++++++++++++++++++++++++++
 tests/docker/run_tests.sh       |  52 +---
 tests/docker/ssh-config         |  21 ++
 tests/setup.py                  |   1 +
 6 files changed, 566 insertions(+), 114 deletions(-)
5536b1237fe954ba712cd62013e7cd91b7caee51

 tests/cluster_file_generator.sh |  63 -----
 tests/docker/Dockerfile         |  32 ++-
 tests/docker/ducker-ak          | 511 ++++++++++++++++++++++++++++++++++++++++
 tests/docker/run_tests.sh       |  52 +---
 tests/docker/ssh-config         |  21 ++
 tests/setup.py                  |   1 +
 6 files changed, 566 insertions(+), 114 deletions(-)
ce1ca4ce14f306b279f48152b14244b47f55ac49

 core/src/main/scala/kafka/log/TransactionIndex.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
27fdd46dcd303566a35d4824c571cf988912575e

 core/src/main/scala/kafka/log/TransactionIndex.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
dc95456f1df1a6ba451944d515fcee81c29262f5

 .../scala/kafka/server/ClientQuotaManager.scala    | 26 +++++++++++---
 .../kafka/server/ClientRequestQuotaManager.scala   | 26 +++++++++++++-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 27 ++++-----------
 .../integration/kafka/api/BaseConsumerTest.scala   |  4 +++
 .../integration/kafka/api/BaseQuotaTest.scala      |  2 +-
 .../kafka/api/PlaintextConsumerTest.scala          | 36 +++++++++++++++++++
 .../unit/kafka/server/ClientQuotaManagerTest.scala | 40 +++++++++++-----------
 7 files changed, 114 insertions(+), 47 deletions(-)
8f7fd07169e5eb27449548fca9ba603d59cde75a

 .../java/org/apache/kafka/clients/consumer/ConsumerConfig.java    | 2 +-
 .../src/main/java/org/apache/kafka/common/config/ConfigDef.java   | 6 ++++++
 .../src/main/java/org/apache/kafka/common/config/TopicConfig.java | 2 +-
 core/src/main/scala/kafka/server/ConfigHandler.scala              | 8 ++++++--
 4 files changed, 14 insertions(+), 4 deletions(-)
a05a00e50364d33a0206e8dffe6bce6713c9467b

 .../java/org/apache/kafka/clients/consumer/ConsumerConfig.java    | 2 +-
 .../src/main/java/org/apache/kafka/common/config/ConfigDef.java   | 6 ++++++
 .../src/main/java/org/apache/kafka/common/config/TopicConfig.java | 2 +-
 core/src/main/scala/kafka/server/ConfigHandler.scala              | 8 ++++++--
 4 files changed, 14 insertions(+), 4 deletions(-)
41fff32a4ebb27847e35e0754119a1cf73c3b0ed

 .../kafka/common/record/DefaultRecordBatch.java    |   4 +-
 .../apache/kafka/common/record/MemoryRecords.java  |  87 +++++++-----
 .../kafka/common/utils/ByteBufferOutputStream.java |  21 ++-
 .../clients/consumer/internals/FetcherTest.java    |   7 +-
 .../common/record/DefaultRecordBatchTest.java      |   1 +
 .../kafka/common/record/MemoryRecordsTest.java     | 105 +++++++++++++-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  82 ++++++-----
 core/src/main/scala/kafka/log/LogValidator.scala   |   3 +
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 155 +++++++++++++++++++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  50 ++++++-
 .../scala/unit/kafka/log/LogValidatorTest.scala    |  40 +++++-
 11 files changed, 462 insertions(+), 93 deletions(-)
cb0325d484b957432048dd29419f0fa59c5f132d

 .../kafka/common/record/DefaultRecordBatch.java    |   4 +-
 .../apache/kafka/common/record/MemoryRecords.java  |  87 +++++++-----
 .../kafka/common/utils/ByteBufferOutputStream.java |  21 ++-
 .../clients/consumer/internals/FetcherTest.java    |   7 +-
 .../common/record/DefaultRecordBatchTest.java      |   1 +
 .../kafka/common/record/MemoryRecordsTest.java     | 105 +++++++++++++-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  82 ++++++-----
 core/src/main/scala/kafka/log/LogValidator.scala   |   3 +
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 155 +++++++++++++++++++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  50 ++++++-
 .../scala/unit/kafka/log/LogValidatorTest.scala    |  40 +++++-
 11 files changed, 462 insertions(+), 93 deletions(-)
f05c70b06972db92b9d8fe3247babf0882a35e8c

 core/src/test/scala/integration/kafka/api/TransactionsBounceTest.scala | 1 -
 1 file changed, 1 deletion(-)
efb060c57f05d1d586bb14c016b0187c60f8e994

 docs/streams.html                                  |  15 +-
 .../examples/wordcount/WordCountProcessorDemo.java |  36 ++--
 .../apache/kafka/streams/kstream/Transformer.java  |  13 +-
 .../kafka/streams/kstream/ValueTransformer.java    |  13 +-
 .../kstream/internals/KStreamTransformValues.java  |   8 +
 .../kafka/streams/processor/Cancellable.java       |  23 +++
 .../apache/kafka/streams/processor/Processor.java  |   8 +-
 .../kafka/streams/processor/ProcessorContext.java  |  28 ++-
 .../kafka/streams/processor/PunctuationType.java   |  34 ++++
 .../apache/kafka/streams/processor/Punctuator.java |  26 +++
 .../internals/GlobalProcessorContextImpl.java      |  29 +++-
 .../processor/internals/ProcessorContextImpl.java  |  16 +-
 .../streams/processor/internals/ProcessorNode.java |  18 +-
 .../internals/ProcessorNodePunctuator.java         |  26 +++
 .../processor/internals/PunctuationQueue.java      |  18 +-
 .../processor/internals/PunctuationSchedule.java   |  55 +++++-
 .../streams/processor/internals/Punctuator.java    |  23 ---
 .../processor/internals/StandbyContextImpl.java    |  12 ++
 .../streams/processor/internals/StreamTask.java    |  48 ++++--
 .../streams/processor/internals/StreamThread.java  |  38 +++-
 .../internals/AbstractProcessorContextTest.java    |   8 +
 .../processor/internals/PunctuationQueueTest.java  |  33 ++--
 .../processor/internals/StreamTaskTest.java        | 191 +++++++++++++++++----
 .../apache/kafka/test/MockProcessorContext.java    |   7 +
 .../org/apache/kafka/test/MockProcessorNode.java   |  12 +-
 .../apache/kafka/test/MockProcessorSupplier.java   |  50 ++++--
 .../apache/kafka/test/NoOpProcessorContext.java    |   8 +-
 27 files changed, 633 insertions(+), 163 deletions(-)
ec5b22c8b7e5cc6a272235c2c2c11d98c980536f

 checkstyle/suppressions.xml | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
a293e1dc0c0cdc6620abb3c8e099f29772e3d688

 checkstyle/suppressions.xml | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
1d28e25748024d78dcc1a35c825ce5eef0dfd30d

 core/src/main/scala/kafka/serializer/Encoder.scala | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
031da889bc811200da67568c5779760dcb006238

 .../kafka/clients/consumer/KafkaConsumer.java      | 104 ++++++++++++---------
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   1 +
 .../integration/kafka/api/ConsumerBounceTest.scala |   8 +-
 3 files changed, 68 insertions(+), 45 deletions(-)
dd006c82c2e6a55113cf419b9356ef968949648e

 .../kafka/clients/consumer/ConsumerConfig.java       | 11 ++++++-----
 .../kafka/clients/producer/ProducerConfig.java       |  7 ++++---
 .../org/apache/kafka/common/config/TopicConfig.java  |  9 ++++++---
 core/src/main/scala/kafka/server/KafkaConfig.scala   | 20 ++++++++++----------
 4 files changed, 26 insertions(+), 21 deletions(-)
f1cc8008e5e77d0587921d727daff1eafb80f74c

 .../kafka/clients/consumer/ConsumerConfig.java       | 11 ++++++-----
 .../kafka/clients/producer/ProducerConfig.java       |  7 ++++---
 .../org/apache/kafka/common/config/TopicConfig.java  |  9 ++++++---
 core/src/main/scala/kafka/server/KafkaConfig.scala   | 20 ++++++++++----------
 4 files changed, 26 insertions(+), 21 deletions(-)
3fcb7808cafffe5596b9c9c8f7c101f12ce2b5c5

 tests/kafkatest/services/monitor/jmx.py | 9 +++++++++
 1 file changed, 9 insertions(+)
55575877f05f852d931a879e72094b03e27c91bc

 tests/kafkatest/services/monitor/jmx.py           | 9 +++++++++
 tests/kafkatest/tests/produce_consume_validate.py | 6 ------
 2 files changed, 9 insertions(+), 6 deletions(-)
d292cad53ecd48fcebb36f7e31a1421a0faaffbe

 tests/kafkatest/services/monitor/jmx.py           | 9 +++++++++
 tests/kafkatest/tests/produce_consume_validate.py | 6 ------
 2 files changed, 9 insertions(+), 6 deletions(-)
e45c767d5344c4d0a42c444840ad81a82fcc9f7f

 tests/kafkatest/services/monitor/jmx.py           | 9 +++++++++
 tests/kafkatest/tests/produce_consume_validate.py | 6 ------
 2 files changed, 9 insertions(+), 6 deletions(-)
3f149ad46aa667263ed9601173638b2dc0c6ba30

 core/src/main/scala/kafka/log/LogCleaner.scala     | 28 ++++++++--
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 60 +++++++++++++++++++---
 2 files changed, 77 insertions(+), 11 deletions(-)
09accf27a46f9b25fd76dec6f2b165770d5aec0f

 .../org/apache/kafka/streams/StreamsConfig.java    |   2 +-
 .../internals/AbstractProcessorContext.java        |   8 +-
 .../apache/kafka/streams/tests/EosTestClient.java  |  43 ++-
 .../apache/kafka/streams/tests/EosTestDriver.java  | 375 +++++++++++++--------
 .../apache/kafka/streams/tests/SmokeTestUtil.java  |  63 ++--
 .../apache/kafka/streams/tests/StreamsEosTest.java |  13 +-
 tests/kafkatest/services/streams.py                |  10 +
 tests/kafkatest/tests/streams/streams_eos_test.py  |  94 ++++--
 8 files changed, 391 insertions(+), 217 deletions(-)
2265834803649d2f9fb090e86d11309f6e9789cb

 .../org/apache/kafka/streams/StreamsConfig.java    |   2 +-
 .../internals/AbstractProcessorContext.java        |   8 +-
 .../apache/kafka/streams/tests/EosTestClient.java  |  43 ++-
 .../apache/kafka/streams/tests/EosTestDriver.java  | 375 +++++++++++++--------
 .../apache/kafka/streams/tests/SmokeTestUtil.java  |  63 ++--
 .../apache/kafka/streams/tests/StreamsEosTest.java |  13 +-
 tests/kafkatest/services/streams.py                |  10 +
 tests/kafkatest/tests/streams/streams_eos_test.py  |  94 ++++--
 8 files changed, 391 insertions(+), 217 deletions(-)
2c217686fa68bc307bf96e90903eb6b03fd80588

 .../org/apache/kafka/clients/NetworkClient.java    | 44 +++++++++++-----------
 .../kafka/common/requests/OffsetFetchRequest.java  |  3 +-
 .../kafka/common/requests/RequestResponseTest.java | 10 +++++
 3 files changed, 35 insertions(+), 22 deletions(-)
a5c47db1382c14720106ae1da20d2b332f89c22c

 .../org/apache/kafka/clients/NetworkClient.java    | 44 +++++++++++-----------
 .../kafka/common/requests/OffsetFetchRequest.java  |  3 +-
 .../kafka/common/requests/RequestResponseTest.java | 10 +++++
 3 files changed, 35 insertions(+), 22 deletions(-)
ee5eac715d58e6b16a115692ede93ae481ae7785

 .../tests/streams/streams_upgrade_test.py          | 164 +++++++++++++++++++++
 vagrant/base.sh                                    |   5 +
 2 files changed, 169 insertions(+)
59b57212ad2ccee27b27a259976f2288e4227fdd

 .../streams/processor/internals/AbstractTask.java  | 12 ++-
 .../streams/processor/internals/ProcessorNode.java |  3 -
 .../processor/internals/ProcessorStateManager.java |  4 +-
 .../streams/processor/internals/StandbyTask.java   |  2 +-
 .../processor/internals/StateDirectory.java        |  6 +-
 .../processor/internals/StoreChangelogReader.java  |  8 +-
 .../internals/StreamPartitionAssignor.java         |  4 +-
 .../streams/processor/internals/StreamTask.java    | 24 +++---
 .../streams/processor/internals/StreamThread.java  | 87 +++++++++++-----------
 .../kafka/streams/state/internals/NamedCache.java  | 13 +---
 .../kafka/streams/state/internals/ThreadCache.java | 16 ++--
 11 files changed, 93 insertions(+), 86 deletions(-)
d5e463b9de1f92b0dcc8fea4cf74a0eaca835ef7

 .../streams/processor/internals/AbstractTask.java  | 12 ++-
 .../streams/processor/internals/ProcessorNode.java |  3 -
 .../processor/internals/ProcessorStateManager.java |  4 +-
 .../streams/processor/internals/StandbyTask.java   |  2 +-
 .../processor/internals/StateDirectory.java        |  6 +-
 .../processor/internals/StoreChangelogReader.java  |  8 +-
 .../internals/StreamPartitionAssignor.java         |  4 +-
 .../streams/processor/internals/StreamTask.java    | 24 +++---
 .../streams/processor/internals/StreamThread.java  | 87 +++++++++++-----------
 .../kafka/streams/state/internals/NamedCache.java  | 12 +--
 .../kafka/streams/state/internals/ThreadCache.java | 16 ++--
 11 files changed, 94 insertions(+), 84 deletions(-)
8abac1984e2fb709129105aa8142a6486e110502

 .../kafka/clients/admin/KafkaAdminClient.java      |  4 +-
 .../kafka/common/network/SaslChannelBuilder.java   | 12 +++-
 .../security/authenticator/LoginManager.java       | 16 ++++-
 .../common/network/SaslChannelBuilderTest.java     | 78 ++++++++++++++++++++++
 4 files changed, 104 insertions(+), 6 deletions(-)
d65844b52723c7a093d969c4b2822e3b36389b70

 .../kafka/clients/admin/KafkaAdminClient.java      |  4 +-
 .../kafka/common/network/SaslChannelBuilder.java   | 12 +++-
 .../security/authenticator/LoginManager.java       | 16 ++++-
 .../common/network/SaslChannelBuilderTest.java     | 78 ++++++++++++++++++++++
 4 files changed, 104 insertions(+), 6 deletions(-)
8af61a3a908ec2f3dd349cb4c28aef61e1e79b6a

 .../processor/internals/InternalTopicManager.java  | 14 ++++++------
 .../internals/InternalTopicManagerTest.java        | 25 ++++++++++++++++++++++
 2 files changed, 33 insertions(+), 6 deletions(-)
89e0ae7dc22e6eb5131f6a7e00cd6382f128603f

 .../processor/internals/InternalTopicManager.java  | 14 ++++++------
 .../internals/InternalTopicManagerTest.java        | 25 ++++++++++++++++++++++
 2 files changed, 33 insertions(+), 6 deletions(-)
b490368735b3bfe82acab3f2db4894a757abb966

 .../processor/internals/InternalTopicManager.java  | 14 ++++++------
 .../internals/InternalTopicManagerTest.java        | 25 ++++++++++++++++++++++
 2 files changed, 33 insertions(+), 6 deletions(-)
9ada0f81695d99587b18bffe939de651065076ab

 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java   | 4 ++--
 .../org/apache/kafka/streams/processor/internals/AbstractTask.java  | 2 +-
 .../kafka/streams/processor/internals/GlobalStateManagerImpl.java   | 6 +++---
 .../kafka/streams/processor/internals/InternalTopicManager.java     | 4 ++--
 .../org/apache/kafka/streams/processor/internals/StandbyTask.java   | 2 +-
 5 files changed, 9 insertions(+), 9 deletions(-)
701e318ee1046946ce6681a59223504d8c33d751

 .../streams/state/internals/RocksDBStore.java      |  7 +++
 .../streams/state/internals/RocksDBStoreTest.java  | 67 ++++++++++++++++++++++
 2 files changed, 74 insertions(+)
26eea1d71e57348284ea00182045c8d943336f4e

 .../CompositeReadOnlyKeyValueStoreTest.java        | 50 ++++++++++++++++++++++
 1 file changed, 50 insertions(+)
2420491f417012ba5215a9f72fa5e3a0c586c8e8

 .../org/apache/kafka/streams/state/Stores.java     |  5 +++-
 .../internals/RocksDBWindowStoreSupplier.java      |  5 +++-
 .../org/apache/kafka/streams/state/StoresTest.java | 15 +++++++++++
 .../internals/RocksDBWindowStoreSupplierTest.java  | 29 ++++++++++++++--------
 4 files changed, 41 insertions(+), 13 deletions(-)
ac539796478d6f39933d02f52e9c8972ac07466c

 tests/README.md         | 13 ++++++++++---
 vagrant/aws/aws-init.sh | 16 +++++++++++-----
 2 files changed, 21 insertions(+), 8 deletions(-)
b62cccd078210a5333a6dbc64881dd36f925e139

 tests/README.md                      |  7 +++++++
 vagrant/aws/aws-access-keys-commands | 11 ++++-------
 2 files changed, 11 insertions(+), 7 deletions(-)
f4ac58a062c49da06f0a3aea4b56f07b37d33aa8

 .../org/apache/kafka/streams/processor/internals/StreamThread.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
4baca9172dd662c2e45cd99c638a052eeca688c5

 .../org/apache/kafka/streams/processor/internals/StreamThread.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
c0033b0e0b9e56242752c82f15c6388d041914a1

 core/src/main/scala/kafka/controller/KafkaController.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
6d2fbfc911120c178d9ba2528179fb4d8475afc4

 core/src/main/scala/kafka/controller/KafkaController.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
faadddb524d0b9f1968d47d7700f98e879c40b6b

 .../org/apache/kafka/common/config/ConfigDef.java  |  7 ++-
 .../apache/kafka/common/config/ConfigDefTest.java  | 51 ++++++++++++++++++++++
 2 files changed, 56 insertions(+), 2 deletions(-)
cd11fd787438d26324d9644c248b812d25e26b34

 .../org/apache/kafka/common/config/ConfigDef.java  |  7 ++-
 .../apache/kafka/common/config/ConfigDefTest.java  | 51 ++++++++++++++++++++++
 2 files changed, 56 insertions(+), 2 deletions(-)
6eaffecfc96ba8d7af6b848d6e7b2b0c644867cb

 config/log4j.properties | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
5d9563d95fb09903d13b7135e1136081feb4fc4b

 config/log4j.properties | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
b082d5d60082441a19b7f451c71cf18d902e3fdd

 .../kafka/clients/consumer/internals/Fetcher.java  | 30 +++++++++----------
 .../kafka/common/record/DefaultRecordBatch.java    | 27 +++++++++++++++--
 .../clients/consumer/internals/FetcherTest.java    | 29 ++++++++++++++++++
 .../common/record/DefaultRecordBatchTest.java      | 35 ++++++++++++++++++++++
 4 files changed, 103 insertions(+), 18 deletions(-)
fc58ac594f0eb63e0928374f67eba25bfa18eaea

 .../kafka/clients/consumer/internals/Fetcher.java  | 30 +++++++++----------
 .../kafka/common/record/DefaultRecordBatch.java    | 27 +++++++++++++++--
 .../clients/consumer/internals/FetcherTest.java    | 29 ++++++++++++++++++
 .../common/record/DefaultRecordBatchTest.java      | 35 ++++++++++++++++++++++
 4 files changed, 103 insertions(+), 18 deletions(-)
1744a9b4c2a13545036f172064df01b34b0dded0

 .../state/internals/InMemoryKeyValueLoggedStoreTest.java | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
adfaa1161150635b9bb0e36a573382c5b68960e2

 .../kafka/streams/state/internals/CachingSessionStore.java |  4 ++++
 .../state/internals/CompositeReadOnlySessionStoreTest.java | 14 +++++++++++---
 2 files changed, 15 insertions(+), 3 deletions(-)
ec45d12353475266e2bd874f912269d9241d7f44

 docs/quickstart.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
785d8e20caf31d4165dbd9573828b74e5859b259

 docs/quickstart.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ff4bf50890d4337e2927d3de34a079373011e11b

 docs/implementation.html | 133 ++---------------------------------------------
 docs/toc.html            |  11 ++--
 2 files changed, 10 insertions(+), 134 deletions(-)
a6799f4e14ac68a5915bce50f37343bec45c988a

 docs/implementation.html | 133 ++---------------------------------------------
 docs/toc.html            |  11 ++--
 2 files changed, 10 insertions(+), 134 deletions(-)
cc8906698552c7d7b609052d7ef51a6a2c454b18

 config/log4j.properties | 31 ++++++++++++++++++-------------
 1 file changed, 18 insertions(+), 13 deletions(-)
a4794b11b201804c39ee9f9a2f32dbdd7c2c246b

 config/log4j.properties | 31 ++++++++++++++++++-------------
 1 file changed, 18 insertions(+), 13 deletions(-)
cb5e1f0a40e9a9779a5dcabf555a593363728b33

 .../kstream/internals/KGroupedTableImpl.java       |  5 +-
 .../streams/kstream/internals/KStreamImpl.java     |  5 +-
 .../streams/kstream/internals/KTableImpl.java      |  5 +-
 .../streams/kstream/internals/KStreamImplTest.java | 58 ++++++++++++++++++++++
 4 files changed, 67 insertions(+), 6 deletions(-)
3906575b3954e7c67c57665286d0183e56168d31

 .../org/apache/kafka/streams/examples/pageview/PageViewTypedDemo.java    | 1 +
 .../org/apache/kafka/streams/examples/pageview/PageViewUntypedDemo.java  | 1 +
 .../java/org/apache/kafka/streams/examples/wordcount/WordCountDemo.java  | 1 +
 .../apache/kafka/streams/examples/wordcount/WordCountProcessorDemo.java  | 1 +
 4 files changed, 4 insertions(+)
7f4feda959f5a0c438487844a0754cdf75f32a46

 .../org/apache/kafka/streams/examples/pageview/PageViewTypedDemo.java    | 1 +
 .../org/apache/kafka/streams/examples/pageview/PageViewUntypedDemo.java  | 1 +
 .../java/org/apache/kafka/streams/examples/wordcount/WordCountDemo.java  | 1 +
 .../apache/kafka/streams/examples/wordcount/WordCountProcessorDemo.java  | 1 +
 4 files changed, 4 insertions(+)
4e8797f54ef9d2d7f40e3100943ae8afd5496b16

 .../state/internals/CachingKeyValueStore.java      |  3 ++
 .../state/internals/CachingKeyValueStoreTest.java  | 46 ++++++++++++++++++++++
 2 files changed, 49 insertions(+)
ce2567fb8047255e9d9abe65bac9b26c6f967f7a

 docs/streams.html | 13 +++++++++++++
 1 file changed, 13 insertions(+)
8265d1a403abb9bffe6b8bd65a5e1322022b8f43

 core/src/main/scala/kafka/serializer/Decoder.scala | 18 +++---
 core/src/main/scala/kafka/serializer/Encoder.scala | 24 ++++++++
 .../streams/processor/internals/StandbyTask.java   |  7 ++-
 .../processor/internals/StreamTaskTest.java        | 66 ++++++++++++++++++++++
 .../apache/kafka/streams/tests/EosTestDriver.java  | 16 +++---
 5 files changed, 114 insertions(+), 17 deletions(-)
914e42a28254ef6a4818b3fcdc2197db6fbe8e0f

 core/src/main/scala/kafka/serializer/Decoder.scala | 18 +++---
 core/src/main/scala/kafka/serializer/Encoder.scala | 24 ++++++++
 .../streams/processor/internals/StandbyTask.java   |  7 ++-
 .../processor/internals/StreamTaskTest.java        | 66 ++++++++++++++++++++++
 .../apache/kafka/streams/tests/EosTestDriver.java  | 16 +++---
 5 files changed, 114 insertions(+), 17 deletions(-)
701297f1d6c93adcb7e88a62a2cb60506661320c

 .../apache/kafka/tools/ProducerPerformance.java    | 48 +++++++++++++++++++++-
 1 file changed, 47 insertions(+), 1 deletion(-)
bc47e9d6ca976ba3c15249500b2bb6f6355816bc

 .../apache/kafka/tools/ProducerPerformance.java    | 48 +++++++++++++++++++++-
 1 file changed, 47 insertions(+), 1 deletion(-)
1d65f15f2b656b7817eeaf6ee1d36eb3e2cf063f

 .../kafka/connect/runtime/AbstractHerder.java      |  42 ++----
 .../kafka/connect/runtime/ConnectorConfig.java     |   2 +-
 .../connect/runtime/SourceConnectorConfig.java     |   6 +-
 .../kafka/connect/runtime/AbstractHerderTest.java  | 158 ++++++++++++++++++++-
 .../kafka/connect/runtime/TestSinkConnector.java   |  61 ++++++++
 .../kafka/connect/runtime/TestSourceConnector.java |  61 ++++++++
 .../runtime/distributed/DistributedHerderTest.java |  13 +-
 .../resources/ConnectorPluginsResourceTest.java    |  72 +---------
 .../runtime/standalone/StandaloneHerderTest.java   |  13 +-
 9 files changed, 313 insertions(+), 115 deletions(-)
96587f4b1ffd372d3e4f9a1fba6fc1d2f84a191d

 .../kafka/connect/runtime/AbstractHerder.java      |  42 ++----
 .../kafka/connect/runtime/ConnectorConfig.java     |   2 +-
 .../connect/runtime/SourceConnectorConfig.java     |   6 +-
 .../kafka/connect/runtime/AbstractHerderTest.java  | 158 ++++++++++++++++++++-
 .../kafka/connect/runtime/TestSinkConnector.java   |  61 ++++++++
 .../kafka/connect/runtime/TestSourceConnector.java |  61 ++++++++
 .../runtime/distributed/DistributedHerderTest.java |  13 +-
 .../resources/ConnectorPluginsResourceTest.java    |  72 +---------
 .../runtime/standalone/StandaloneHerderTest.java   |  13 +-
 9 files changed, 313 insertions(+), 115 deletions(-)
9aef218f0df6be0401d613dbbfce4570e949a634

 docs/upgrade.html | 22 ++++++++++++++++++----
 1 file changed, 18 insertions(+), 4 deletions(-)
e6e263174300ffab05676790f2a6c963ba24e5c9

 docs/upgrade.html | 22 ++++++++++++++++++----
 1 file changed, 18 insertions(+), 4 deletions(-)
f848e2cd681ced74fefdd38a54a44e31e4d867fb

 .../apache/kafka/streams/state/internals/RocksDBStore.java    | 11 +++--------
 1 file changed, 3 insertions(+), 8 deletions(-)
f239f1f839f8bcbd80cce2a4a8643e15d340be8e

 .../kafka/clients/producer/KafkaProducer.java      |  3 +-
 .../kafka/clients/producer/internals/Sender.java   |  2 +-
 .../producer/internals/TransactionManager.java     | 46 ++++++++++++--
 .../clients/producer/internals/SenderTest.java     |  2 +-
 .../producer/internals/TransactionManagerTest.java | 71 +++++++++++++++++++++-
 .../transaction/TransactionCoordinator.scala       |  4 +-
 6 files changed, 118 insertions(+), 10 deletions(-)
254add953477df65fe36144dc0714e0c9815c767

 .../kafka/clients/producer/KafkaProducer.java      |  3 +-
 .../kafka/clients/producer/internals/Sender.java   |  2 +-
 .../producer/internals/TransactionManager.java     | 46 ++++++++++++--
 .../clients/producer/internals/SenderTest.java     |  2 +-
 .../producer/internals/TransactionManagerTest.java | 71 +++++++++++++++++++++-
 .../transaction/TransactionCoordinator.scala       |  4 +-
 6 files changed, 118 insertions(+), 10 deletions(-)
55a90938a12d8928289a30588bbad6c959c48674

 checkstyle/import-control.xml                      |   4 +
 .../apache/kafka/streams/perf/SimpleBenchmark.java |  92 ++++--
 .../apache/kafka/streams/perf/YahooBenchmark.java  | 361 +++++++++++++++++++++
 .../streams/streams_simple_benchmark_test.py       |  14 +-
 .../services/performance/streams_performance.py    |   5 +-
 tests/kafkatest/services/streams.py                |   7 +-
 6 files changed, 438 insertions(+), 45 deletions(-)
cae5977ed0d6b63f992973800273769c970b0a0a

 docs/streams.html | 13 +++++++++++++
 1 file changed, 13 insertions(+)
33727acf987bb4e4272140ccb6dace775138b9b0

 core/src/main/scala/kafka/log/LogCleaner.scala     | 29 ++---------
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 58 +++-------------------
 2 files changed, 11 insertions(+), 76 deletions(-)
7647b97f317ad8231a2b77c71ccf7e3ddb29a4cd

 core/src/main/scala/kafka/log/LogCleaner.scala     | 29 +++++++++--
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 58 +++++++++++++++++++---
 2 files changed, 76 insertions(+), 11 deletions(-)
186e3d5efc79ed803f0915d472ace77cbec88694

 core/src/main/scala/kafka/log/LogCleaner.scala     | 29 +++++++++--
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 58 +++++++++++++++++++---
 2 files changed, 76 insertions(+), 11 deletions(-)
76f6e14b07bd97d17f9275968a047d68b4658704

 core/src/main/scala/kafka/log/LogCleaner.scala     | 29 +++++++++--
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 58 +++++++++++++++++++---
 2 files changed, 76 insertions(+), 11 deletions(-)
c029960bf4ae2cd79b22886f4ee519c4af0bcc8b

 .../java/org/apache/kafka/common/config/ConfigDef.java    |  5 +++--
 .../org/apache/kafka/connect/runtime/AbstractHerder.java  | 15 +++++++++------
 2 files changed, 12 insertions(+), 8 deletions(-)
de982ba3fbf99664f0aaa5aa4b72af8fd1881232

 .../java/org/apache/kafka/common/config/ConfigDef.java    |  5 +++--
 .../org/apache/kafka/connect/runtime/AbstractHerder.java  | 15 +++++++++------
 2 files changed, 12 insertions(+), 8 deletions(-)
84de7f1756d34e6890c2608a699701d659fa191a

 .../java/org/apache/kafka/streams/state/internals/NamedCache.java    | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
83edf3f6f17314ca360342049669ac1b145f1835

 docs/design.html | 34 ++++++++++++++++++++++------------
 1 file changed, 22 insertions(+), 12 deletions(-)
cb3952a4fd14f72374165acdc3ed777347ffdaba

 docs/design.html | 34 ++++++++++++++++++++++------------
 1 file changed, 22 insertions(+), 12 deletions(-)
089cd5c847c332ab28be0b1f975dd74a78ea27e6

 docs/documentation.html |  6 +++---
 docs/js/templateData.js |  4 ++--
 docs/streams.html       | 41 ++++++++++++++++++++++++++++++++++++-----
 3 files changed, 41 insertions(+), 10 deletions(-)
f28fc1100b5f6e79baeb6b2f2363e86e5cd12306

 docs/documentation.html |  6 +++---
 docs/js/templateData.js |  4 ++--
 docs/streams.html       | 41 ++++++++++++++++++++++++++++++++++++-----
 3 files changed, 41 insertions(+), 10 deletions(-)
028b939daa30f57894a86480dbeaac066a2b1bc1

 docs/design.html | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)
491774bd52bfe34f32f935bc4fc5db22dc8ceba2

 docs/design.html | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)
54205697aea5bfeb4fbcd40fc849c0c975fd6070

 .../clients/producer/internals/ProducerBatch.java  |  4 ++--
 .../producer/internals/RecordAccumulator.java      |  4 ++--
 .../kafka/clients/producer/internals/Sender.java   |  4 ++--
 .../kafka/common/record/MemoryRecordsBuilder.java  | 25 +++++++++++++++-------
 .../producer/internals/RecordAccumulatorTest.java  |  2 +-
 .../common/record/MemoryRecordsBuilderTest.java    | 24 +++++++++++++++++++++
 6 files changed, 48 insertions(+), 15 deletions(-)
f7e5f70e4cb13201ec75704264b6e2cabcb24891

 vagrant/vagrant-up.sh | 19 ++++++++++++++++++-
 1 file changed, 18 insertions(+), 1 deletion(-)
9db8475f70004ee1fe7bb5dd12c5c8a9c5841000

 vagrant/vagrant-up.sh | 19 ++++++++++++++++++-
 1 file changed, 18 insertions(+), 1 deletion(-)
43fe077e9250f113a625c76546df2e9f3c2459db

 vagrant/vagrant-up.sh | 19 ++++++++++++++++++-
 1 file changed, 18 insertions(+), 1 deletion(-)
57181bb7786ef7c9ee735d02abcd3b0c6fe94c4c

 vagrant/base.sh       |  9 ---------
 vagrant/vagrant-up.sh | 19 ++++++++++++++++++-
 2 files changed, 18 insertions(+), 10 deletions(-)
ffa8100457bbde24eaba27a0fadb1bc5212bfc4e

 vagrant/base.sh       |  9 ---------
 vagrant/vagrant-up.sh | 19 ++++++++++++++++++-
 2 files changed, 18 insertions(+), 10 deletions(-)
6414b628af326e8275c0caf1e91225f01daae14f

 .../scala/kafka/coordinator/transaction/TransactionCoordinator.scala   | 3 +--
 .../transaction/TransactionMarkerRequestCompletionHandler.scala        | 2 +-
 .../scala/kafka/coordinator/transaction/TransactionStateManager.scala  | 1 -
 3 files changed, 2 insertions(+), 4 deletions(-)
cb2fdbd6c1621fd578c4c1422ead62faf7ae3f7f

 .../scala/kafka/coordinator/transaction/TransactionCoordinator.scala   | 3 +--
 .../transaction/TransactionMarkerRequestCompletionHandler.scala        | 2 +-
 .../scala/kafka/coordinator/transaction/TransactionStateManager.scala  | 1 -
 3 files changed, 2 insertions(+), 4 deletions(-)
1d24e10aeab616eede416201336e928b9a8efa98

 core/src/main/scala/kafka/admin/AdminUtils.scala   | 99 +---------------------
 .../scala/unit/kafka/producer/ProducerTest.scala   | 14 +--
 2 files changed, 4 insertions(+), 109 deletions(-)
a3633865aae0680fa02acdb490e6374337224708

 docs/implementation.html | 2 +-
 docs/uses.html           | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
9790d5aba05256a203ef3763f91972f9b2f94a56

 docs/implementation.html | 2 +-
 docs/uses.html           | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
e62d0df37299168ef1aa1965eb2e13dd515b7ff9

 .../java/org/apache/kafka/streams/processor/internals/StreamThread.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ea2a21dda4ee402cf06e127609456b11c5997d37

 .../java/org/apache/kafka/streams/processor/internals/StreamThread.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
198a43d84693153c0f0177b8314117525c05047b

 .../kafka/connect/file/FileStreamSinkConnector.java   |  2 +-
 .../kafka/connect/file/FileStreamSourceConnector.java |  2 +-
 .../connect/file/FileStreamSinkConnectorTest.java     | 14 ++++++++++++++
 .../kafka/connect/file/FileStreamSourceTaskTest.java  | 19 +++++++++++++++++++
 4 files changed, 35 insertions(+), 2 deletions(-)
b1ae12d6cb5e47e426410fb0fe525cdbd9f7c78d

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
5b351216621f52a471c21826d0dec3ce3187e697

 .../kafka/clients/consumer/KafkaConsumer.java      |  35 +++++++
 .../kafka/clients/producer/KafkaProducer.java      | 113 ++++++++++++++++++++-
 2 files changed, 143 insertions(+), 5 deletions(-)
b836bd18f99e32ee71e30693853518fdc2061218

 .../kafka/clients/consumer/KafkaConsumer.java      |  35 +++++++
 .../kafka/clients/producer/KafkaProducer.java      | 113 ++++++++++++++++++++-
 2 files changed, 143 insertions(+), 5 deletions(-)
d083a156e47253ecfc3b9ffaa97327b72ae0232a

 .../java/org/apache/kafka/common/utils/Utils.java  |  20 +-
 core/src/main/scala/kafka/log/Log.scala            | 140 +++--
 core/src/main/scala/kafka/log/LogCleaner.scala     |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |   4 +-
 .../scala/kafka/log/ProducerStateManager.scala     |  58 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |  14 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   2 +-
 .../log/AbstractLogCleanerIntegrationTest.scala    |   2 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   2 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |   4 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  16 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 602 ++++++++++++++++-----
 .../unit/kafka/log/ProducerStateManagerTest.scala  |  33 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   6 +-
 15 files changed, 663 insertions(+), 244 deletions(-)
bcaee7fe19b3f2e75f6de0dfc5487deebfef446e

 .../java/org/apache/kafka/common/utils/Utils.java  |  20 +-
 core/src/main/scala/kafka/log/Log.scala            | 140 +++--
 core/src/main/scala/kafka/log/LogCleaner.scala     |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |   4 +-
 .../scala/kafka/log/ProducerStateManager.scala     |  58 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |  14 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   2 +-
 .../log/AbstractLogCleanerIntegrationTest.scala    |   2 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   2 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |   4 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  16 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 602 ++++++++++++++++-----
 .../unit/kafka/log/ProducerStateManagerTest.scala  |  33 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   6 +-
 15 files changed, 663 insertions(+), 244 deletions(-)
bc6a3bc6f8c74df5437005f0c1da7822fa10ed2b

 .../kafka/clients/admin/KafkaAdminClient.java      |  18 ++--
 .../org/apache/kafka/common/acl/AclBinding.java    |   2 +-
 .../apache/kafka/common/acl/AclBindingFilter.java  |   4 +-
 .../org/apache/kafka/common/requests/ApiError.java |  10 +++
 .../kafka/common/requests/CreateAclsRequest.java   |   5 +-
 .../kafka/common/requests/CreateAclsResponse.java  |  33 ++-----
 .../kafka/common/requests/DeleteAclsRequest.java   |   2 +-
 .../kafka/common/requests/DeleteAclsResponse.java  |  95 +++++++-------------
 .../kafka/common/requests/DescribeAclsRequest.java |   3 +-
 .../common/requests/DescribeAclsResponse.java      |  50 ++++-------
 .../kafka/common/resource/ResourceFilter.java      |   2 +-
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 100 ++++++---------------
 .../apache/kafka/common/acl/AclBindingTest.java    |  14 +--
 .../kafka/common/requests/RequestResponseTest.java |  31 +++----
 .../main/scala/kafka/security/SecurityUtils.scala  |  17 ++--
 .../src/main/scala/kafka/server/AdminManager.scala |   8 +-
 .../scala/kafka/server/DelayedCreateTopics.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  36 ++++----
 .../kafka/api/AuthorizerIntegrationTest.scala      |  96 ++++++++++++--------
 .../api/SaslSslAdminClientIntegrationTest.scala    |  32 ++++---
 .../server/AbstractCreateTopicsRequestTest.scala   |   4 +-
 .../processor/internals/StreamsKafkaClient.java    |   2 +-
 22 files changed, 251 insertions(+), 317 deletions(-)
63605779ef67fb39487cf0487c8ac4caa8d39cbc

 .../kafka/common/requests/DeleteAclsResponse.java  |   8 +
 .../scala/kafka/common/InterBrokerSendThread.scala |  29 ++--
 .../TransactionMarkerChannelManager.scala          |  22 +--
 .../main/scala/kafka/security/SecurityUtils.scala  |  48 ++++++
 .../scala/kafka/security/auth/PermissionType.scala |   5 -
 core/src/main/scala/kafka/server/KafkaApis.scala   | 187 ++++++---------------
 .../kafka/common/InterBrokerSendThreadTest.scala   |  16 +-
 .../TransactionMarkerChannelManagerTest.scala      |  20 +--
 8 files changed, 151 insertions(+), 184 deletions(-)
d68f9e2fe6cf2f76a81105ace5061eb7abb85995

 .../kafka/clients/admin/KafkaAdminClient.java      |  18 ++--
 .../org/apache/kafka/common/acl/AclBinding.java    |   2 +-
 .../apache/kafka/common/acl/AclBindingFilter.java  |   4 +-
 .../org/apache/kafka/common/requests/ApiError.java |  10 +++
 .../kafka/common/requests/CreateAclsRequest.java   |   5 +-
 .../kafka/common/requests/CreateAclsResponse.java  |  33 ++-----
 .../kafka/common/requests/DeleteAclsRequest.java   |   2 +-
 .../kafka/common/requests/DeleteAclsResponse.java  |  95 +++++++-------------
 .../kafka/common/requests/DescribeAclsRequest.java |   3 +-
 .../common/requests/DescribeAclsResponse.java      |  50 ++++-------
 .../kafka/common/resource/ResourceFilter.java      |   2 +-
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 100 ++++++---------------
 .../apache/kafka/common/acl/AclBindingTest.java    |  14 +--
 .../kafka/common/requests/RequestResponseTest.java |  31 +++----
 .../main/scala/kafka/security/SecurityUtils.scala  |  17 ++--
 .../src/main/scala/kafka/server/AdminManager.scala |   8 +-
 .../scala/kafka/server/DelayedCreateTopics.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  36 ++++----
 .../kafka/api/AuthorizerIntegrationTest.scala      |  96 ++++++++++++--------
 .../api/SaslSslAdminClientIntegrationTest.scala    |  32 ++++---
 .../server/AbstractCreateTopicsRequestTest.scala   |   4 +-
 .../processor/internals/StreamsKafkaClient.java    |   2 +-
 22 files changed, 251 insertions(+), 317 deletions(-)
b1313935f26e1bb233caf5eab70a73798e4c5c2e

 .../apache/kafka/common/record/DefaultRecord.java  | 25 ++++---
 .../kafka/common/record/DefaultRecordBatch.java    |  2 +-
 .../common/record/InvalidRecordException.java      |  4 ++
 .../kafka/common/record/DefaultRecordTest.java     | 84 ++++++++++++++++++++++
 4 files changed, 104 insertions(+), 11 deletions(-)
51fc50ed0ba7aa4d0e618f9103a1531680489139

 .../apache/kafka/common/record/DefaultRecord.java  | 25 ++++---
 .../kafka/common/record/DefaultRecordBatch.java    |  2 +-
 .../common/record/InvalidRecordException.java      |  4 ++
 .../kafka/common/record/DefaultRecordTest.java     | 84 ++++++++++++++++++++++
 4 files changed, 104 insertions(+), 11 deletions(-)
7184343edfbe7844d284b8b38d814182104430c6

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
3fdbba1c7218f77fc4b7b4b2d7d2a8b4b24ef1f0

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
b6c2bbc4dd044ca2aef09d5d7e2be6cb9e8fdd48

 .../main/java/org/apache/kafka/common/internals/FatalExitError.java   | 4 ----
 1 file changed, 4 deletions(-)
2d9dedca15ef13b059912e5767bd1d7b3c7cc0b2

 .../apache/kafka/common/record/DefaultRecord.java  | 80 +++++++++++++---------
 .../kafka/common/record/DefaultRecordBatch.java    | 39 +++++++++--
 .../common/record/DefaultRecordBatchTest.java      | 59 ++++++++++++++++
 .../kafka/common/record/DefaultRecordTest.java     | 58 ++++++++++++++++
 core/src/main/scala/kafka/log/LogValidator.scala   |  1 +
 5 files changed, 201 insertions(+), 36 deletions(-)
48de613a90fe91ca56628803fe9f02fdfd99813a

 .../apache/kafka/common/record/DefaultRecord.java  | 80 +++++++++++++---------
 .../kafka/common/record/DefaultRecordBatch.java    | 39 +++++++++--
 .../common/record/DefaultRecordBatchTest.java      | 59 ++++++++++++++++
 .../kafka/common/record/DefaultRecordTest.java     | 58 ++++++++++++++++
 core/src/main/scala/kafka/log/LogValidator.scala   |  1 +
 5 files changed, 201 insertions(+), 36 deletions(-)
fdd12698b8c8f9d4b70d775e5844b76912977843

 .../kafka/common/requests/DeleteAclsResponse.java  |   8 +
 .../scala/kafka/common/InterBrokerSendThread.scala |  29 ++--
 .../TransactionMarkerChannelManager.scala          |  22 +--
 .../main/scala/kafka/security/SecurityUtils.scala  |  48 ++++++
 .../scala/kafka/security/auth/PermissionType.scala |   5 -
 core/src/main/scala/kafka/server/KafkaApis.scala   | 187 ++++++---------------
 .../kafka/common/InterBrokerSendThreadTest.scala   |  16 +-
 .../TransactionMarkerChannelManagerTest.scala      |  20 +--
 8 files changed, 151 insertions(+), 184 deletions(-)
e07ef8ef501fdcc9d44fdd954371b141056a9b23

 .../processor/internals/ProcessorStateManager.java |  6 ++---
 .../streams/processor/internals/StreamTask.java    |  6 ++---
 .../streams/processor/internals/StreamThread.java  | 28 +++++++++++-----------
 3 files changed, 20 insertions(+), 20 deletions(-)
11aa110126d641cb8f078162fd87bf519ef29766

 .../processor/internals/ProcessorStateManager.java |  6 ++---
 .../streams/processor/internals/StreamTask.java    |  6 ++---
 .../streams/processor/internals/StreamThread.java  | 28 +++++++++++-----------
 3 files changed, 20 insertions(+), 20 deletions(-)
b1b01734351de5b6021bea269bb9aec5c606a257

 docs/streams.html | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
5b063252e293b7cbb0ccb21eb0e813db689a535f

 docs/streams.html | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
6f19604ed504d567418895aac2ab4ed0f4e5404c

 docs/streams.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
518f141ed0c6ca8a91da36a427650fc329a943fd

 docs/streams.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2cfa15009216a02cf1301e02b6e0202073a693b9

 .../kafka/clients/producer/KafkaProducer.java      |  4 +-
 .../clients/producer/internals/ProducerBatch.java  | 11 ++---
 .../producer/internals/RecordAccumulator.java      |  2 +-
 .../kafka/common/record/AbstractRecords.java       | 18 ++++++--
 .../kafka/common/record/DefaultRecordBatch.java    |  6 ++-
 .../kafka/common/record/MemoryRecordsBuilder.java  | 21 +++++----
 .../producer/internals/RecordAccumulatorTest.java  | 52 +++++++++++++++++++++-
 .../jmh/record/RecordBatchIterationBenchmark.java  |  8 ++--
 8 files changed, 91 insertions(+), 31 deletions(-)
f49697a2796540452a21d4a29ab879ba04214046

 .../kafka/clients/producer/KafkaProducer.java      |  4 +-
 .../clients/producer/internals/ProducerBatch.java  | 11 ++---
 .../producer/internals/RecordAccumulator.java      |  2 +-
 .../kafka/common/record/AbstractRecords.java       | 18 ++++++--
 .../kafka/common/record/DefaultRecordBatch.java    |  6 ++-
 .../kafka/common/record/MemoryRecordsBuilder.java  | 21 +++++----
 .../producer/internals/RecordAccumulatorTest.java  | 52 +++++++++++++++++++++-
 .../jmh/record/RecordBatchIterationBenchmark.java  |  8 ++--
 8 files changed, 91 insertions(+), 31 deletions(-)
145df86ff792aae579cf2e698b8f491481831ed9

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
354cbebdc1f26f745aaf614486449fbe240a88e0

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
67e944438248b01d66fe165e1fe8e0c88f2961a6

 .../clients/producer/internals/ProducerBatch.java  |  4 ++--
 .../apache/kafka/common/record/DefaultRecord.java  |  8 --------
 .../kafka/common/record/MemoryRecordsBuilder.java  |  8 ++++----
 .../producer/internals/ProducerBatchTest.java      |  4 ++--
 .../producer/internals/RecordAccumulatorTest.java  |  6 ++++--
 .../common/record/MemoryRecordsBuilderTest.java    |  6 +++---
 .../kafka/common/record/MemoryRecordsTest.java     | 24 ++++++++++++++++++++--
 7 files changed, 37 insertions(+), 23 deletions(-)
c83719f3d8799ec35cf9af95fd93c97b910df570

 .../clients/producer/internals/ProducerBatch.java  |  4 ++--
 .../apache/kafka/common/record/DefaultRecord.java  |  8 --------
 .../kafka/common/record/MemoryRecordsBuilder.java  |  8 ++++----
 .../producer/internals/ProducerBatchTest.java      |  4 ++--
 .../producer/internals/RecordAccumulatorTest.java  |  6 ++++--
 .../common/record/MemoryRecordsBuilderTest.java    |  6 +++---
 .../kafka/common/record/MemoryRecordsTest.java     | 24 ++++++++++++++++++++--
 7 files changed, 37 insertions(+), 23 deletions(-)
6cd7f448aa6cc9f8bde27ab46ab1db1048194066

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
6f1d4c693307d1c5d1a178d56e403bb7084d537f

 .../org/apache/kafka/common/metrics/Metrics.java   |  3 ++-
 .../common/security/kerberos/KerberosLogin.java    |  6 ++---
 .../org/apache/kafka/common/utils/KafkaThread.java | 12 ++++++++--
 .../java/org/apache/kafka/common/utils/Shell.java  |  4 ++--
 .../java/org/apache/kafka/common/utils/Utils.java  | 28 ----------------------
 .../main/scala/kafka/network/SocketServer.scala    |  8 +++----
 .../scala/kafka/server/KafkaRequestHandler.scala   |  4 ++--
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  6 ++---
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  4 ++--
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  4 ++--
 core/src/main/scala/kafka/utils/timer/Timer.scala  |  4 ++--
 11 files changed, 32 insertions(+), 51 deletions(-)
9fe07b9652e7c32020a193948ae17d904e29cc29

 .../kafka/clients/producer/KafkaProducer.java      |   4 +-
 .../producer/internals/IncompleteBatches.java      |  59 ++++++
 .../clients/producer/internals/ProducerBatch.java  |   2 +-
 .../producer/internals/RecordAccumulator.java      |  64 ++-----
 .../kafka/clients/producer/internals/Sender.java   |  22 +--
 .../producer/internals/TransactionManager.java     |  26 ++-
 .../producer/internals/RecordAccumulatorTest.java  |  80 ++++++++-
 .../producer/internals/TransactionManagerTest.java | 199 +++++++++++++++++----
 8 files changed, 341 insertions(+), 115 deletions(-)
54a3718a900a5286baf2193713ea8d58ca2c08f6

 .../kafka/clients/producer/KafkaProducer.java      |   4 +-
 .../producer/internals/IncompleteBatches.java      |  59 ++++++
 .../clients/producer/internals/ProducerBatch.java  |   2 +-
 .../producer/internals/RecordAccumulator.java      |  64 ++-----
 .../kafka/clients/producer/internals/Sender.java   |  22 +--
 .../producer/internals/TransactionManager.java     |  26 ++-
 .../producer/internals/RecordAccumulatorTest.java  |  80 ++++++++-
 .../producer/internals/TransactionManagerTest.java | 199 +++++++++++++++++----
 8 files changed, 341 insertions(+), 115 deletions(-)
2c890a78142f5804e33eb0fb5d8ff5858de2ab22

 .../java/org/apache/kafka/clients/producer/internals/Sender.java  | 5 ++++-
 .../kafka/clients/producer/internals/TransactionManager.java      | 8 +++++---
 2 files changed, 9 insertions(+), 4 deletions(-)
6cc29e32169e069a75304803feac67591a57b6a5

 .../java/org/apache/kafka/clients/producer/internals/Sender.java  | 5 ++++-
 .../kafka/clients/producer/internals/TransactionManager.java      | 8 +++++---
 2 files changed, 9 insertions(+), 4 deletions(-)
90b2a2bf664e4e40d4cd1b46c72732c5edb97cf9

 .../apache/kafka/streams/state/internals/RocksDBStore.java    | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)
46e9869afe1cfbf1b2509b1676dcae6ce59ea55d

 .../org/apache/kafka/streams/processor/internals/StreamThread.java     | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
1d556e471411b3ffa5bf65afd08d1a78ee40e710

 .../org/apache/kafka/streams/processor/internals/StreamThread.java     | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
3e99db84540c1ac6cb7a5eafc66ac7d6653dadae

 .../kafka/clients/admin/AdminClientConfig.java     |  9 ++++
 .../kafka/clients/admin/AlterConfigsOptions.java   |  2 +-
 .../kafka/clients/admin/AlterConfigsResult.java    |  2 +-
 .../kafka/clients/admin/CreateAclsResult.java      |  2 +-
 .../kafka/clients/admin/CreateTopicsOptions.java   |  2 +-
 .../kafka/clients/admin/CreateTopicsResult.java    |  2 +-
 .../kafka/clients/admin/DeleteAclsResult.java      | 32 ++++++------
 .../kafka/clients/admin/DeleteTopicsResult.java    |  2 +-
 .../kafka/clients/admin/DescribeAclsResult.java    |  2 +-
 .../kafka/clients/admin/DescribeConfigsResult.java |  2 +-
 .../kafka/clients/admin/DescribeTopicsResult.java  |  2 +-
 .../kafka/clients/admin/KafkaAdminClient.java      | 60 +++++++++++-----------
 .../kafka/clients/admin/ListTopicsOptions.java     |  2 +-
 .../kafka/clients/admin/ListTopicsResult.java      | 13 ++---
 .../org/apache/kafka/clients/admin/NewTopic.java   |  2 +-
 .../kafka/clients/admin/TopicDescription.java      | 19 +++----
 .../apache/kafka/clients/admin/TopicListing.java   |  2 +-
 .../apache/kafka/common/TopicPartitionInfo.java    |  7 +--
 .../kafka/common/acl/AccessControlEntry.java       | 10 ++--
 .../kafka/common/acl/AccessControlEntryData.java   |  4 +-
 .../kafka/common/acl/AccessControlEntryFilter.java |  4 +-
 .../org/apache/kafka/common/acl/AclBinding.java    |  2 +-
 .../apache/kafka/common/acl/AclBindingFilter.java  |  2 +-
 .../org/apache/kafka/common/acl/AclOperation.java  |  2 +-
 .../apache/kafka/common/acl/AclPermissionType.java |  2 +-
 .../org/apache/kafka/common/resource/Resource.java |  4 +-
 .../kafka/common/resource/ResourceFilter.java      |  2 +-
 .../apache/kafka/common/resource/ResourceType.java |  2 +-
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 28 +++++-----
 .../apache/kafka/common/acl/AclOperationTest.java  |  2 +-
 .../kafka/common/acl/AclPermissionTypeTest.java    |  2 +-
 .../kafka/common/resource/ResourceTypeTest.java    |  2 +-
 .../org/apache/kafka/connect/util/TopicAdmin.java  |  2 +-
 .../storage/KafkaConfigBackingStoreTest.java       |  2 +-
 .../storage/KafkaOffsetBackingStoreTest.java       |  2 +-
 .../kafka/api/AdminClientIntegrationTest.scala     | 30 +++++------
 .../AdminClientWithPoliciesIntegrationTest.scala   | 20 ++++----
 .../api/SaslSslAdminClientIntegrationTest.scala    | 38 +++++++-------
 .../kafka/tools/ClientCompatibilityTest.java       |  6 +--
 39 files changed, 173 insertions(+), 159 deletions(-)
0f60617fab5fc6805f522d0b9a213a7f600fab12

 .../kafka/clients/admin/AdminClientConfig.java     |  9 ++++
 .../kafka/clients/admin/AlterConfigsOptions.java   |  2 +-
 .../kafka/clients/admin/AlterConfigsResult.java    |  2 +-
 .../kafka/clients/admin/CreateAclsResult.java      |  2 +-
 .../kafka/clients/admin/CreateTopicsOptions.java   |  2 +-
 .../kafka/clients/admin/CreateTopicsResult.java    |  2 +-
 .../kafka/clients/admin/DeleteAclsResult.java      | 32 ++++++------
 .../kafka/clients/admin/DeleteTopicsResult.java    |  2 +-
 .../kafka/clients/admin/DescribeAclsResult.java    |  2 +-
 .../kafka/clients/admin/DescribeConfigsResult.java |  2 +-
 .../kafka/clients/admin/DescribeTopicsResult.java  |  2 +-
 .../kafka/clients/admin/KafkaAdminClient.java      | 60 +++++++++++-----------
 .../kafka/clients/admin/ListTopicsOptions.java     |  2 +-
 .../kafka/clients/admin/ListTopicsResult.java      | 13 ++---
 .../org/apache/kafka/clients/admin/NewTopic.java   |  2 +-
 .../kafka/clients/admin/TopicDescription.java      | 19 +++----
 .../apache/kafka/clients/admin/TopicListing.java   |  2 +-
 .../apache/kafka/common/TopicPartitionInfo.java    |  7 +--
 .../kafka/common/acl/AccessControlEntry.java       | 10 ++--
 .../kafka/common/acl/AccessControlEntryData.java   |  4 +-
 .../kafka/common/acl/AccessControlEntryFilter.java |  4 +-
 .../org/apache/kafka/common/acl/AclBinding.java    |  2 +-
 .../apache/kafka/common/acl/AclBindingFilter.java  |  2 +-
 .../org/apache/kafka/common/acl/AclOperation.java  |  2 +-
 .../apache/kafka/common/acl/AclPermissionType.java |  2 +-
 .../org/apache/kafka/common/resource/Resource.java |  4 +-
 .../kafka/common/resource/ResourceFilter.java      |  2 +-
 .../apache/kafka/common/resource/ResourceType.java |  2 +-
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 28 +++++-----
 .../apache/kafka/common/acl/AclOperationTest.java  |  2 +-
 .../kafka/common/acl/AclPermissionTypeTest.java    |  2 +-
 .../kafka/common/resource/ResourceTypeTest.java    |  2 +-
 .../org/apache/kafka/connect/util/TopicAdmin.java  |  2 +-
 .../storage/KafkaConfigBackingStoreTest.java       |  2 +-
 .../storage/KafkaOffsetBackingStoreTest.java       |  2 +-
 .../kafka/api/AdminClientIntegrationTest.scala     | 30 +++++------
 .../AdminClientWithPoliciesIntegrationTest.scala   | 20 ++++----
 .../api/SaslSslAdminClientIntegrationTest.scala    | 38 +++++++-------
 .../kafka/tools/ClientCompatibilityTest.java       |  6 +--
 39 files changed, 173 insertions(+), 159 deletions(-)
d199f2de71698dff457053a5efec408a2950647e

 tests/kafkatest/services/connect.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
bcf5da0baccc6bf9baa2a45047845dc6842cd200

 tests/kafkatest/services/connect.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
ad0acb6c74bbacd2feb57e8ded9f05ba68a7dfb7

 .../services/transactional_message_copier.py       |  7 ++-
 tests/kafkatest/tests/core/transactions_test.py    |  4 +-
 .../kafka/tools/TransactionalMessageCopier.java    | 52 +++++++++++++++-------
 3 files changed, 43 insertions(+), 20 deletions(-)
005b86ecf3bd881cb2005c177c2555eeb2a049d9

 .../services/transactional_message_copier.py       |  7 ++-
 tests/kafkatest/tests/core/transactions_test.py    |  4 +-
 .../kafka/tools/TransactionalMessageCopier.java    | 52 +++++++++++++++-------
 3 files changed, 43 insertions(+), 20 deletions(-)
71a3e00cc7d91b3d404f99a2d235d69133c5703c

 .../connect/runtime/TransformationConfigTest.java  | 211 +++++++++++++++++++++
 .../connect/transforms/TimestampConverter.java     |   6 +-
 .../connect/transforms/TimestampConverterTest.java |  48 ++---
 3 files changed, 238 insertions(+), 27 deletions(-)
b760615f3d58ed1fd4e17bb3ec647b26135cf458

 .../connect/runtime/TransformationConfigTest.java  | 211 +++++++++++++++++++++
 .../connect/transforms/TimestampConverter.java     |   6 +-
 .../connect/transforms/TimestampConverterTest.java |  48 ++---
 3 files changed, 238 insertions(+), 27 deletions(-)
de7c9742e9708a75166e7c3426d5b325e108d78f

 .../TransactionMarkerChannelManager.scala          | 48 +++++++++-------------
 .../TransactionMarkerChannelManagerTest.scala      |  4 +-
 2 files changed, 21 insertions(+), 31 deletions(-)
3c2329ad0b56fe39d9cbc8301c5902689e54fb3a

 .../TransactionMarkerChannelManager.scala          | 48 +++++++++-------------
 .../TransactionMarkerChannelManagerTest.scala      |  4 +-
 2 files changed, 21 insertions(+), 31 deletions(-)
8a40e8c85935cef7c43e033b54c0fb7f8e7edded

 .../kafka/clients/consumer/internals/Fetcher.java  |  7 ++++
 .../clients/consumer/internals/FetcherTest.java    | 39 ++++++++++++++++++++++
 2 files changed, 46 insertions(+)
2572637121527f8c37bc95212e7eaf8190eb436b

 .../kafka/clients/consumer/internals/Fetcher.java  |  7 ++++
 .../clients/consumer/internals/FetcherTest.java    | 39 ++++++++++++++++++++++
 2 files changed, 46 insertions(+)
227ab597d8da2f0a5bb75b3d9763fbd3049835ad

 .../org/apache/kafka/streams/processor/internals/StreamThread.java  | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
e60d547eff4e918b50998a42123ab3a942ba76e9

 .../java/org/apache/kafka/streams/processor/internals/StreamThread.java | 2 ++
 1 file changed, 2 insertions(+)
65e36895f5cf91afcf785857ebff4c0fce8d1d9c

 .../java/org/apache/kafka/streams/processor/internals/StreamThread.java | 2 ++
 1 file changed, 2 insertions(+)
18c6ca92e8acba91eb61d8f2378f740a0c4f855f

 .../processor/internals/RecordCollectorImpl.java   |  10 +-
 .../streams/processor/internals/StreamThread.java  |   7 +-
 .../streams/integration/EosIntegrationTest.java    | 484 +++++++++++----------
 3 files changed, 270 insertions(+), 231 deletions(-)
160933bc092b4392cac1dd9497010320c6ae4d10

 .../processor/internals/RecordCollectorImpl.java   |  10 +-
 .../streams/processor/internals/StreamThread.java  |   7 +-
 .../streams/integration/EosIntegrationTest.java    | 484 +++++++++++----------
 3 files changed, 270 insertions(+), 231 deletions(-)
fe8e968c6af3893c5bb909f54c50d9dc6614f41b

 build.gradle                                       |  1 +
 checkstyle/import-control.xml                      |  3 ++
 .../apache/kafka/clients/admin/AdminClient.java    | 41 ++++++++++++++++++---
 .../kafka/clients/admin/AdminClientConfig.java     |  2 +-
 .../kafka/clients/admin/AlterConfigsOptions.java   | 33 +++++++++++++----
 .../kafka/clients/admin/AlterConfigsResult.java    | 13 ++++++-
 .../org/apache/kafka/clients/admin/Config.java     | 21 +++++++++--
 .../apache/kafka/clients/admin/ConfigEntry.java    | 42 ++++++++++++++++++++++
 .../kafka/clients/admin/CreateAclsOptions.java     | 18 +++++++++-
 .../kafka/clients/admin/CreateAclsResult.java      | 13 ++++---
 .../kafka/clients/admin/CreateTopicsOptions.java   | 23 ++++++++++--
 .../kafka/clients/admin/CreateTopicsResult.java    |  7 ++--
 .../kafka/clients/admin/DeleteAclsOptions.java     | 18 +++++++++-
 .../kafka/clients/admin/DeleteAclsResult.java      | 26 ++++++++++++--
 .../kafka/clients/admin/DeleteTopicsOptions.java   | 17 +++++++--
 .../kafka/clients/admin/DeleteTopicsResult.java    |  7 ++--
 .../kafka/clients/admin/DescribeAclsOptions.java   | 17 ++++++++-
 .../kafka/clients/admin/DescribeAclsResult.java    | 10 +++++-
 .../clients/admin/DescribeClusterOptions.java      | 15 ++++++--
 .../kafka/clients/admin/DescribeClusterResult.java | 14 ++++----
 .../clients/admin/DescribeConfigsOptions.java      | 16 +++++++--
 .../kafka/clients/admin/DescribeConfigsResult.java | 15 +++++++-
 .../kafka/clients/admin/DescribeTopicsOptions.java | 17 +++++++--
 .../kafka/clients/admin/DescribeTopicsResult.java  |  7 ++--
 .../kafka/clients/admin/KafkaAdminClient.java      |  8 +++--
 .../kafka/clients/admin/ListTopicsOptions.java     | 17 +++++++--
 .../kafka/clients/admin/ListTopicsResult.java      |  6 ++--
 .../org/apache/kafka/clients/admin/NewTopic.java   | 31 +++++++++++++---
 .../kafka/clients/admin/TopicDescription.java      | 17 +++++++++
 .../apache/kafka/clients/admin/TopicListing.java   | 13 +++++++
 .../java/org/apache/kafka/common/KafkaFuture.java  |  9 +++--
 .../apache/kafka/common/TopicPartitionInfo.java    | 27 ++++++++++++++
 .../kafka/common/acl/AccessControlEntry.java       | 28 +++++++++++++--
 .../kafka/common/acl/AccessControlEntryFilter.java | 30 +++++++++++++++-
 .../org/apache/kafka/common/acl/AclBinding.java    | 16 +++++++++
 .../apache/kafka/common/acl/AclBindingFilter.java  | 26 ++++++++++++++
 .../org/apache/kafka/common/acl/AclOperation.java  | 14 ++++++++
 .../apache/kafka/common/acl/AclPermissionType.java | 14 ++++++++
 .../common/annotation/InterfaceStability.java      | 20 ++++++-----
 .../apache/kafka/common/config/ConfigResource.java | 22 ++++++++++++
 .../org/apache/kafka/common/resource/Resource.java | 17 +++++++++
 .../kafka/common/resource/ResourceFilter.java      | 29 +++++++++++++++
 .../apache/kafka/common/resource/ResourceType.java | 14 ++++++++
 43 files changed, 681 insertions(+), 73 deletions(-)
b20d9333be05b18dd776d3c8a92d76bde8d36794

 build.gradle                                       |  1 +
 checkstyle/import-control.xml                      |  3 ++
 .../apache/kafka/clients/admin/AdminClient.java    | 41 ++++++++++++++++++---
 .../kafka/clients/admin/AdminClientConfig.java     |  2 +-
 .../kafka/clients/admin/AlterConfigsOptions.java   | 33 +++++++++++++----
 .../kafka/clients/admin/AlterConfigsResult.java    | 13 ++++++-
 .../org/apache/kafka/clients/admin/Config.java     | 21 +++++++++--
 .../apache/kafka/clients/admin/ConfigEntry.java    | 42 ++++++++++++++++++++++
 .../kafka/clients/admin/CreateAclsOptions.java     | 18 +++++++++-
 .../kafka/clients/admin/CreateAclsResult.java      | 13 ++++---
 .../kafka/clients/admin/CreateTopicsOptions.java   | 23 ++++++++++--
 .../kafka/clients/admin/CreateTopicsResult.java    |  7 ++--
 .../kafka/clients/admin/DeleteAclsOptions.java     | 18 +++++++++-
 .../kafka/clients/admin/DeleteAclsResult.java      | 26 ++++++++++++--
 .../kafka/clients/admin/DeleteTopicsOptions.java   | 17 +++++++--
 .../kafka/clients/admin/DeleteTopicsResult.java    |  7 ++--
 .../kafka/clients/admin/DescribeAclsOptions.java   | 17 ++++++++-
 .../kafka/clients/admin/DescribeAclsResult.java    | 10 +++++-
 .../clients/admin/DescribeClusterOptions.java      | 15 ++++++--
 .../kafka/clients/admin/DescribeClusterResult.java | 14 ++++----
 .../clients/admin/DescribeConfigsOptions.java      | 16 +++++++--
 .../kafka/clients/admin/DescribeConfigsResult.java | 15 +++++++-
 .../kafka/clients/admin/DescribeTopicsOptions.java | 17 +++++++--
 .../kafka/clients/admin/DescribeTopicsResult.java  |  7 ++--
 .../kafka/clients/admin/KafkaAdminClient.java      |  8 +++--
 .../kafka/clients/admin/ListTopicsOptions.java     | 17 +++++++--
 .../kafka/clients/admin/ListTopicsResult.java      |  6 ++--
 .../org/apache/kafka/clients/admin/NewTopic.java   | 31 +++++++++++++---
 .../kafka/clients/admin/TopicDescription.java      | 17 +++++++++
 .../apache/kafka/clients/admin/TopicListing.java   | 13 +++++++
 .../java/org/apache/kafka/common/KafkaFuture.java  |  9 +++--
 .../apache/kafka/common/TopicPartitionInfo.java    | 27 ++++++++++++++
 .../kafka/common/acl/AccessControlEntry.java       | 28 +++++++++++++--
 .../kafka/common/acl/AccessControlEntryFilter.java | 30 +++++++++++++++-
 .../org/apache/kafka/common/acl/AclBinding.java    | 16 +++++++++
 .../apache/kafka/common/acl/AclBindingFilter.java  | 26 ++++++++++++++
 .../org/apache/kafka/common/acl/AclOperation.java  | 14 ++++++++
 .../apache/kafka/common/acl/AclPermissionType.java | 14 ++++++++
 .../common/annotation/InterfaceStability.java      | 20 ++++++-----
 .../apache/kafka/common/config/ConfigResource.java | 22 ++++++++++++
 .../org/apache/kafka/common/resource/Resource.java | 17 +++++++++
 .../kafka/common/resource/ResourceFilter.java      | 29 +++++++++++++++
 .../apache/kafka/common/resource/ResourceType.java | 14 ++++++++
 43 files changed, 681 insertions(+), 73 deletions(-)
2bf58987fbf4dbf6746d0ab24c1d2ef902a66b8e

 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  5 +++--
 .../scala/unit/kafka/tools/MirrorMakerTest.scala   | 22 +++++++++++++++++++++-
 2 files changed, 24 insertions(+), 3 deletions(-)
09b354a84606fe1862edecc9378908abb4048121

 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  5 +++--
 .../scala/unit/kafka/tools/MirrorMakerTest.scala   | 22 +++++++++++++++++++++-
 2 files changed, 24 insertions(+), 3 deletions(-)
1625d5d9df71b55312def277e8311654c449a5b9

 .../kafka/common/serialization/Deserializer.java      | 15 ++++++++-------
 .../common/serialization/ExtendedDeserializer.java    | 19 ++++++++++++++++++-
 .../common/serialization/ExtendedSerializer.java      | 18 ++++++++++++++++++
 .../apache/kafka/common/serialization/Serializer.java | 17 ++++++++++-------
 4 files changed, 54 insertions(+), 15 deletions(-)
0082066c56676cbc6721d7ea1d0b6b3c011d7083

 .../kafka/common/serialization/Deserializer.java      | 15 ++++++++-------
 .../common/serialization/ExtendedDeserializer.java    | 19 ++++++++++++++++++-
 .../common/serialization/ExtendedSerializer.java      | 18 ++++++++++++++++++
 .../apache/kafka/common/serialization/Serializer.java | 17 ++++++++++-------
 4 files changed, 54 insertions(+), 15 deletions(-)
bd58d6ef36e266d7a4b7b5f293f09f160f76c547

 .../apache/kafka/connect/runtime/WorkerTest.java   | 76 ++++++++++++++++++----
 1 file changed, 63 insertions(+), 13 deletions(-)
179d574a39fe6ab13501de23c0689356da3e19aa

 .../apache/kafka/connect/runtime/WorkerTest.java   | 76 ++++++++++++++++++----
 1 file changed, 63 insertions(+), 13 deletions(-)
27b8f63ad4fb830558737f17c40ae2bcec0a26f2

 .../apache/kafka/clients/admin/AdminClient.java    | 21 --------
 .../kafka/clients/admin/ApiVersionsOptions.java    | 37 -------------
 .../kafka/clients/admin/ApiVersionsResult.java     | 63 ----------------------
 .../kafka/clients/admin/KafkaAdminClient.java      | 35 ------------
 .../kafka/api/AdminClientIntegrationTest.scala     | 10 ++--
 5 files changed, 4 insertions(+), 162 deletions(-)
32f0f1f50aa618e8a3c52eb37006f4945fa6865a

 .../apache/kafka/clients/admin/AdminClient.java    | 21 --------
 .../kafka/clients/admin/ApiVersionsOptions.java    | 37 -------------
 .../kafka/clients/admin/ApiVersionsResult.java     | 63 ----------------------
 .../kafka/clients/admin/KafkaAdminClient.java      | 35 ------------
 .../kafka/api/AdminClientIntegrationTest.scala     | 10 ++--
 5 files changed, 4 insertions(+), 162 deletions(-)
ee08f6608388bd77283c36b87dfe12eb2b655613

 .../java/org/apache/kafka/clients/NetworkClient.java    |  2 +-
 .../org/apache/kafka/clients/NetworkClientTest.java     | 17 ++++++++++++++++-
 2 files changed, 17 insertions(+), 2 deletions(-)
d099c749591ac0e819017a9d3ae48144ddbbff0d

 .../java/org/apache/kafka/clients/NetworkClient.java    |  2 +-
 .../org/apache/kafka/clients/NetworkClientTest.java     | 17 ++++++++++++++++-
 2 files changed, 17 insertions(+), 2 deletions(-)
b45440fe86ab1a5036b13a9e2337989f279463b5

 .../connect/runtime/isolation/PluginDescTest.java  | 241 +++++++++++++++++++++
 1 file changed, 241 insertions(+)
6771285aeab5a5bf76de317ef9483cc57acb7b05

 .../java/org/apache/kafka/connect/runtime/isolation/PluginDesc.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
004dde9e7abb9ebf18a7bfdf8b6f0e997ea9badb

 .../connect/runtime/isolation/PluginDescTest.java  | 241 +++++++++++++++++++++
 1 file changed, 241 insertions(+)
b5307120cf6371aa234fff1ee32e009d48c01739

 core/src/main/scala/kafka/server/KafkaApis.scala   | 36 ++++++++++------
 .../integration/kafka/api/TransactionsTest.scala   | 49 +++++++++++++++++++++-
 2 files changed, 71 insertions(+), 14 deletions(-)
c2daf4c623e5919872012aff57ffa25af46a97f8

 core/src/main/scala/kafka/server/KafkaApis.scala   | 36 ++++++++++------
 .../integration/kafka/api/TransactionsTest.scala   | 49 +++++++++++++++++++++-
 2 files changed, 71 insertions(+), 14 deletions(-)
4b4102884c8d317fe362523a9f5af20a27a4ee52

 .../java/org/apache/kafka/connect/runtime/isolation/PluginDesc.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
24676a17b0a940ad81951de194bd55a7eeaf1f49

 .../unit/kafka/admin/DeleteConsumerGroupTest.scala     | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)
5c9557857602a4c5a57afd06d98447d02cc325c8

 .../unit/kafka/admin/DeleteConsumerGroupTest.scala     | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)
687a61bac158136dc4afab4a293e46ee387c7ae5

 core/src/main/scala/kafka/network/RequestChannel.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
85b7c855bdf88994712d6b6683c9ab69bfa437a9

 core/src/main/scala/kafka/network/RequestChannel.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
4664632417d56f9b08454a2fda25e140dc2a1326

 core/src/main/scala/kafka/server/QuotaFactory.scala | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)
136b03868a3156b1566f109eb47b3832b02c14f7

 core/src/main/scala/kafka/server/QuotaFactory.scala | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)
aaca1b478fcce99860e2eb89aa468ff863458572

 .../consumer/internals/AbstractCoordinator.java    |  3 +-
 .../kafka/clients/producer/KafkaProducer.java      |  3 +-
 .../kafka/controller/ControllerEventManager.scala  |  5 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  4 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala | 54 +++++++++++++++++++++-
 5 files changed, 63 insertions(+), 6 deletions(-)
2b34e587e6b771ba730cb9f428987098c69bddd4

 core/src/main/scala/kafka/utils/ZkUtils.scala          |  5 +++--
 core/src/test/scala/unit/kafka/utils/ZkUtilsTest.scala | 11 +++++++++++
 2 files changed, 14 insertions(+), 2 deletions(-)
435e5e196b64625f017ef2c8c7ab49ce7fc271b8

 core/src/main/scala/kafka/utils/ZkUtils.scala          |  5 +++--
 core/src/test/scala/unit/kafka/utils/ZkUtilsTest.scala | 11 +++++++++++
 2 files changed, 14 insertions(+), 2 deletions(-)
d98993bc1583f37492d1d7fda094f792c4d8c2c2

 .../kafka/clients/producer/KafkaProducer.java      |  2 +-
 .../kafka/clients/producer/KafkaProducerTest.java  | 38 ++++++++++++++++++++++
 2 files changed, 39 insertions(+), 1 deletion(-)
4660bac4eb45a65767d05b03d275e3bf08a85c2a

 .../kafka/clients/producer/KafkaProducer.java      |  2 +-
 .../kafka/clients/producer/KafkaProducerTest.java  | 38 ++++++++++++++++++++++
 2 files changed, 39 insertions(+), 1 deletion(-)
ad74035d5870e203433d40c31ec1c9b3ae2710df

 .../kafka/clients/producer/KafkaProducer.java      |   3 -
 .../clients/producer/internals/ProducerBatch.java  |  12 +-
 .../producer/internals/ProducerIdAndEpoch.java     |   2 +-
 .../producer/internals/RecordAccumulator.java      |   2 +-
 .../kafka/clients/producer/internals/Sender.java   |   9 +-
 .../producer/internals/TransactionManager.java     |  22 +-
 .../producer/internals/TransactionManagerTest.java | 240 ++++++++++++++++++++-
 core/src/main/scala/kafka/cluster/Partition.scala  |  24 +--
 ...TransactionMarkerRequestCompletionHandler.scala |   3 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   3 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  10 +-
 11 files changed, 288 insertions(+), 42 deletions(-)
aea53108a7d9573b8976da83235639a981c09af3

 .../kafka/clients/producer/KafkaProducer.java      |   3 -
 .../clients/producer/internals/ProducerBatch.java  |  12 +-
 .../producer/internals/ProducerIdAndEpoch.java     |   2 +-
 .../producer/internals/RecordAccumulator.java      |   2 +-
 .../kafka/clients/producer/internals/Sender.java   |   9 +-
 .../producer/internals/TransactionManager.java     |  22 +-
 .../producer/internals/TransactionManagerTest.java | 240 ++++++++++++++++++++-
 core/src/main/scala/kafka/cluster/Partition.scala  |  24 +--
 ...TransactionMarkerRequestCompletionHandler.scala |   3 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   3 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  10 +-
 11 files changed, 288 insertions(+), 42 deletions(-)
886a41d62453d1cd00b0b1eb575817f7a52fc371

 .../clients/producer/internals/ProducerBatch.java  | 53 ++++++++++++-----
 .../producer/internals/RecordAccumulator.java      |  8 +--
 .../producer/internals/ProducerBatchTest.java      | 67 ++++++++++++++++++++++
 3 files changed, 111 insertions(+), 17 deletions(-)
6c92fc557682e853a0a3ed5684c13174fff45acf

 .../clients/producer/internals/ProducerBatch.java  | 53 ++++++++++++-----
 .../producer/internals/RecordAccumulator.java      |  8 +--
 .../producer/internals/ProducerBatchTest.java      | 67 ++++++++++++++++++++++
 3 files changed, 111 insertions(+), 17 deletions(-)
076eefcc639404354434a6fceb097072fafd9200

 tests/kafkatest/services/transactional_message_copier.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
0f3f2f56a2d013e6ff723155607b2f71b20db620

 tests/kafkatest/services/transactional_message_copier.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
0827d2129d54d27c42d2314a82f076c6ec30d2df

 .../producer/internals/TransactionManager.java     |  32 +++---
 .../producer/internals/TransactionManagerTest.java | 124 ++++++++++++++++++++-
 2 files changed, 133 insertions(+), 23 deletions(-)
43e935a630eb0a7fa64c5a1a38bfee17f9b724dc

 .../producer/internals/TransactionManager.java     |  32 +++---
 .../producer/internals/TransactionManagerTest.java | 124 ++++++++++++++++++++-
 2 files changed, 133 insertions(+), 23 deletions(-)
ad75a2fa1442629d47da2b1c50bedc1396ea0ec0

 .../transaction/TransactionCoordinator.scala       | 64 ++++++++--------------
 .../TransactionMarkerChannelManager.scala          |  7 ++-
 ...TransactionMarkerRequestCompletionHandler.scala |  6 ++
 .../transaction/TransactionStateManager.scala      | 52 +++++++-----------
 .../transaction/TransactionCoordinatorTest.scala   | 14 ++---
 .../transaction/TransactionStateManagerTest.scala  |  4 +-
 6 files changed, 63 insertions(+), 84 deletions(-)
2724053adf3466d01a70ad9020b3d639150050d6

 .../transaction/TransactionCoordinator.scala       | 64 ++++++++--------------
 .../TransactionMarkerChannelManager.scala          |  7 ++-
 ...TransactionMarkerRequestCompletionHandler.scala |  6 ++
 .../transaction/TransactionStateManager.scala      | 52 +++++++-----------
 .../transaction/TransactionCoordinatorTest.scala   | 14 ++---
 .../transaction/TransactionStateManagerTest.scala  |  4 +-
 6 files changed, 63 insertions(+), 84 deletions(-)
e5109d2d8f9e486dfa88f353eb31c786ab48e847

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d06a0db8b8fcd8ddbdf277885204a062a642dd67

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
b9d70b9e7f9edc09bc186d6338676aec75fd75ad

 core/src/main/scala/kafka/log/LogManager.scala | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)
2d154420c54f725988a7ca696febe341f625049a

 core/src/main/scala/kafka/log/LogManager.scala | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)
eef121f2fd5d688427a789e73a39eb00a6f6a01f

 .../client/client_compatibility_features_test.py   |  16 +--
 .../kafka/tools/ClientCompatibilityTest.java       | 121 +++++++++++++++++++--
 2 files changed, 119 insertions(+), 18 deletions(-)
7d1ef63bec459bcf05b46c1542488283db02a6e2

 .../client/client_compatibility_features_test.py   |  16 +--
 .../kafka/tools/ClientCompatibilityTest.java       | 121 +++++++++++++++++++--
 2 files changed, 119 insertions(+), 18 deletions(-)
f6bcb84727ea8710392ce3d0960a6b511dc3d907

 .../transaction/TransactionCoordinator.scala       |  43 +++--
 .../TransactionMarkerChannelManager.scala          |  59 +++++--
 ...TransactionMarkerRequestCompletionHandler.scala |   3 +
 .../transaction/TransactionMetadata.scala          |  26 +--
 .../transaction/TransactionStateManager.scala      | 112 +++++++------
 .../main/scala/kafka/utils/ReplicationUtils.scala  |  14 +-
 .../transaction/TransactionCoordinatorTest.scala   |  24 ++-
 .../TransactionMarkerChannelManagerTest.scala      | 177 ++++++++++++++++++++-
 .../transaction/TransactionStateManagerTest.scala  |  76 ++++++++-
 9 files changed, 419 insertions(+), 115 deletions(-)
9d6f0f40ceb4859d54454e03f6abfe8b67963e83

 .../transaction/TransactionCoordinator.scala       |  43 +++--
 .../TransactionMarkerChannelManager.scala          |  59 +++++--
 ...TransactionMarkerRequestCompletionHandler.scala |   3 +
 .../transaction/TransactionMetadata.scala          |  26 +--
 .../transaction/TransactionStateManager.scala      | 112 +++++++------
 .../main/scala/kafka/utils/ReplicationUtils.scala  |  14 +-
 .../transaction/TransactionCoordinatorTest.scala   |  24 ++-
 .../TransactionMarkerChannelManagerTest.scala      | 177 ++++++++++++++++++++-
 .../transaction/TransactionStateManagerTest.scala  |  76 ++++++++-
 9 files changed, 419 insertions(+), 115 deletions(-)
26c6a07152a243481c64598913449fa78709519a

 .../api/SaslSslAdminClientIntegrationTest.scala    | 22 +++++++++++++---------
 1 file changed, 13 insertions(+), 9 deletions(-)
46db2c5b99de05591274241c70378d845ee4c847

 .../api/SaslSslAdminClientIntegrationTest.scala    | 22 +++++++++++++---------
 1 file changed, 13 insertions(+), 9 deletions(-)
4508fb2e488cb44647cb8da03b17e2e8e9a07e62

 core/src/main/scala/kafka/network/RequestChannel.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
a623d8fe391f4c4439707b4522c66a3764f620d8

 core/src/main/scala/kafka/network/RequestChannel.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
40509fd7b60018f06bcb4c55deabc2503415fcb2

 .../processor/UsePreviousTimeOnInvalidTimestampTest.java      | 11 +++++++++++
 1 file changed, 11 insertions(+)
50b20d2d32a32736f6e5a8177b717d258449e76f

 .../main/scala/kafka/coordinator/transaction/TransactionMetadata.scala  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1e03b711875d45081c6f839962f9a019d3f64d8c

 .../main/scala/kafka/coordinator/transaction/TransactionMetadata.scala  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2af69cc6e522dea8d9e879b30a7ba68505e0510c

 .../producer/internals/TransactionManager.java     |  3 +-
 .../producer/internals/TransactionManagerTest.java | 65 ++++++++++++++++++++++
 2 files changed, 67 insertions(+), 1 deletion(-)
8e7839f610a9278f800ba2f7378fb10abded8f28

 .../producer/internals/TransactionManager.java     |  3 +-
 .../producer/internals/TransactionManagerTest.java | 65 ++++++++++++++++++++++
 2 files changed, 67 insertions(+), 1 deletion(-)
b8b493091d08352658a24b4ad1211bc4e489e235

 .../streams/integration/EosIntegrationTest.java    | 38 ++++++----------------
 1 file changed, 10 insertions(+), 28 deletions(-)
2af4dd8653dd6717cca1630a57b2835a2698a1bc

 .../streams/integration/EosIntegrationTest.java    | 38 ++++++----------------
 1 file changed, 10 insertions(+), 28 deletions(-)
8482e1c73aedf966464a2149ee6ced1bc9cd63ea

 .../main/scala/kafka/consumer/BaseConsumer.scala   | 46 ++++++----------------
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  3 --
 2 files changed, 13 insertions(+), 36 deletions(-)
5d7c8cc81af6cd2f209f8e5f3df784b9272830b9

 .../main/scala/kafka/consumer/BaseConsumer.scala   | 46 ++++++----------------
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  3 --
 2 files changed, 13 insertions(+), 36 deletions(-)
bf4886611036a3b4839134acb02bf08358a8ef52

 .../java/org/apache/kafka/streams/integration/EosIntegrationTest.java  | 3 +++
 1 file changed, 3 insertions(+)
88aec3eb6d6f8d328e322493ebf4c3011b7335ea

 .../java/org/apache/kafka/streams/integration/EosIntegrationTest.java  | 3 +++
 1 file changed, 3 insertions(+)
9fa80af433ff343c5cfb958317994b87b950b86d

 build.gradle            | 16 ++++++++++++++--
 docs/api.html           |  2 +-
 docs/configuration.html |  4 ++++
 docs/documentation.html |  4 ++--
 docs/toc.html           |  4 +++-
 5 files changed, 24 insertions(+), 6 deletions(-)
c57cfdf4fa56667cb2a5e4ffdb0bcd0b7ff1e134

 build.gradle            | 16 ++++++++++++++--
 docs/api.html           |  2 +-
 docs/configuration.html |  4 ++++
 docs/documentation.html |  4 ++--
 docs/toc.html           |  4 +++-
 5 files changed, 24 insertions(+), 6 deletions(-)
c2890ff006b9c1314112cb4042c5f08703e6bb4c

 checkstyle/import-control.xml                      |   4 +
 .../streams/processor/internals/StreamThread.java  |   4 +-
 .../apache/kafka/streams/tests/EosTestClient.java  | 150 +++++++
 .../apache/kafka/streams/tests/EosTestDriver.java  | 470 +++++++++++++++++++++
 .../apache/kafka/streams/tests/StreamsEosTest.java |  57 +++
 tests/kafkatest/services/streams.py                |  25 ++
 tests/kafkatest/tests/streams/streams_eos_test.py  | 105 +++++
 7 files changed, 813 insertions(+), 2 deletions(-)
ba07d828c545d542cc11db60249e660d88a20fbb

 checkstyle/import-control.xml                      |   4 +
 .../streams/processor/internals/StreamThread.java  |   4 +-
 .../apache/kafka/streams/tests/EosTestClient.java  | 150 +++++++
 .../apache/kafka/streams/tests/EosTestDriver.java  | 470 +++++++++++++++++++++
 .../apache/kafka/streams/tests/StreamsEosTest.java |  57 +++
 tests/kafkatest/services/streams.py                |  25 ++
 tests/kafkatest/tests/streams/streams_eos_test.py  | 105 +++++
 7 files changed, 813 insertions(+), 2 deletions(-)
c6a6ddfa92a02a53c6ec5f6a81bbaef20d614e23

 .../java/org/apache/kafka/streams/integration/EosIntegrationTest.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
21194a63edb460105acd8763e03d07ebbff1df68

 .../java/org/apache/kafka/streams/integration/EosIntegrationTest.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
313560eaa96634519a05b75161df82bce6a4073f

 .../TransactionMarkerChannelManager.scala          | 66 +++++++++++-----------
 .../TransactionMarkerChannelManagerTest.scala      | 45 ++++++++-------
 2 files changed, 58 insertions(+), 53 deletions(-)
b4b65e9eafc45cadca093b023361bd15e77ccb21

 .../TransactionMarkerChannelManager.scala          | 66 +++++++++++-----------
 .../TransactionMarkerChannelManagerTest.scala      | 45 ++++++++-------
 2 files changed, 58 insertions(+), 53 deletions(-)
451963debb255ecdeb2617c20d2b676a11a695e6

 tests/kafkatest/services/templates/tools_log4j.properties | 6 ++++++
 tests/kafkatest/services/transactional_message_copier.py  | 6 ++++--
 2 files changed, 10 insertions(+), 2 deletions(-)
eff79849a0cf8150bd0e4b7e18f77ecbf1f89a36

 tests/kafkatest/services/templates/tools_log4j.properties | 6 ++++++
 tests/kafkatest/services/transactional_message_copier.py  | 6 ++++--
 2 files changed, 10 insertions(+), 2 deletions(-)
1e87b09ec7018a396e9c31bde443b231ccfea73e

 .../main/scala/kafka/controller/KafkaController.scala   |  2 +-
 .../scala/kafka/controller/TopicDeletionManager.scala   |  8 ++++----
 core/src/main/scala/kafka/utils/ZkUtils.scala           | 17 ++---------------
 3 files changed, 7 insertions(+), 20 deletions(-)
be70225bd247f3f297e019511ae4992e90bd086d

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
f4e0deca43595f30b9c6f1a1666192416ecc8a9c

 .../apache/kafka/streams/state/KeyValueStore.java  | 10 ++--
 .../kafka/streams/state/ReadOnlySessionStore.java  |  3 ++
 .../kafka/streams/state/ReadOnlyWindowStore.java   |  2 +
 .../apache/kafka/streams/state/SessionStore.java   |  4 ++
 .../apache/kafka/streams/state/WindowStore.java    |  6 +++
 .../state/internals/CachingKeyValueStore.java      |  7 +--
 .../internals/CompositeReadOnlyKeyValueStore.java  |  5 ++
 .../streams/state/internals/MemoryLRUCache.java    |  5 ++
 .../streams/state/internals/RocksDBStore.java      |  8 ++--
 .../state/internals/AbstractKeyValueStoreTest.java | 53 ++++++++++++++++++++++
 .../state/internals/CachingKeyValueStoreTest.java  | 49 ++++++++++++++++----
 .../state/internals/CachingSessionStoreTest.java   | 40 ++++++++++++++++
 .../state/internals/CachingWindowStoreTest.java    | 27 ++++++++++-
 .../CompositeReadOnlyKeyValueStoreTest.java        | 15 ++++++
 .../internals/InMemoryKeyValueLoggedStoreTest.java | 49 ++++++++++++++++++++
 .../state/internals/RocksDBSessionStoreTest.java   | 40 ++++++++++++++++
 .../streams/state/internals/RocksDBStoreTest.java  | 48 +++++++++++++++++---
 .../state/internals/RocksDBWindowStoreTest.java    | 30 ++++++++++++
 18 files changed, 372 insertions(+), 29 deletions(-)
4f6895e80e1983aa9ea2d33436247ddcd1a89139

 .../org/apache/kafka/streams/processor/TimestampExtractor.java | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)
3de2d296e9fec89631b6521ed488263dca5808a9

 .../org/apache/kafka/streams/processor/TimestampExtractor.java | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)
e692a845582810650ff957ef2c56522a78774aaf

 docs/ops.html | 19 ++++++++++++++++++-
 1 file changed, 18 insertions(+), 1 deletion(-)
d1a279dcc7aba6ad965fbdd854f1daf0ec184f46

 docs/ops.html | 19 ++++++++++++++++++-
 1 file changed, 18 insertions(+), 1 deletion(-)
eb2aa184a07abeec97fcda96d86d44c47ab35557

 .../kafka/common/requests/LeaderAndIsrRequest.java |  2 +-
 .../kafka/common/requests/MetadataResponse.java    | 10 +++
 .../kafka/common/requests/PartitionState.java      | 12 ++--
 .../common/requests/UpdateMetadataRequest.java     |  2 +-
 .../kafka/common/requests/RequestResponseTest.java | 12 ++--
 core/src/main/scala/kafka/api/LeaderAndIsr.scala   |  2 +-
 .../controller/ControllerChannelManager.scala      |  4 +-
 .../kafka/api/AdminClientIntegrationTest.scala     | 44 ++++++++++++-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  4 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 .../unit/kafka/server/MetadataCacheTest.scala      | 72 ++++++++++++----------
 .../unit/kafka/server/MetadataRequestTest.scala    | 32 +++++++++-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 15 ++---
 .../scala/unit/kafka/server/RequestQuotaTest.scala |  4 +-
 14 files changed, 148 insertions(+), 69 deletions(-)
12612e82971b8dc85941c771b7fe87ff95a07ab5

 .../kafka/common/requests/LeaderAndIsrRequest.java |  2 +-
 .../kafka/common/requests/MetadataResponse.java    | 10 +++
 .../kafka/common/requests/PartitionState.java      | 12 ++--
 .../common/requests/UpdateMetadataRequest.java     |  2 +-
 .../kafka/common/requests/RequestResponseTest.java | 12 ++--
 core/src/main/scala/kafka/api/LeaderAndIsr.scala   |  2 +-
 .../controller/ControllerChannelManager.scala      |  4 +-
 .../kafka/api/AdminClientIntegrationTest.scala     | 44 ++++++++++++-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  4 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 .../unit/kafka/server/MetadataCacheTest.scala      | 72 ++++++++++++----------
 .../unit/kafka/server/MetadataRequestTest.scala    | 32 +++++++++-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 15 ++---
 .../scala/unit/kafka/server/RequestQuotaTest.scala |  4 +-
 14 files changed, 148 insertions(+), 69 deletions(-)
469778a5ad6b276d17242b38ff198eeddafcc945

 .../org/apache/kafka/clients/NetworkClient.java    |  23 ++-
 .../org/apache/kafka/common/acl/AclOperation.java  |  13 ++
 .../kafka/common/requests/AbstractResponse.java    |   3 +
 .../org/apache/kafka/common/resource/Resource.java |  10 +
 .../apache/kafka/common/resource/ResourceType.java |   4 +-
 .../apache/kafka/common/acl/AclOperationTest.java  |   1 +
 .../kafka/common/acl/AclPermissionTypeTest.java    |   1 +
 .../kafka/common/resource/ResourceTypeTest.java    |   3 +-
 core/src/main/scala/kafka/admin/AclCommand.scala   |   2 +-
 .../controller/ControllerChannelManager.scala      |   5 +-
 .../main/scala/kafka/security/auth/Operation.scala |   8 +-
 .../scala/kafka/security/auth/PermissionType.scala |   8 +-
 .../scala/kafka/security/auth/ResourceType.scala   |  22 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  19 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  54 +++--
 .../api/SaslSslAdminClientIntegrationTest.scala    | 225 +++++++++++++++++----
 .../unit/kafka/security/auth/OperationTest.scala   |  28 +--
 .../kafka/security/auth/PermissionTypeTest.scala   |  20 +-
 .../kafka/security/auth/ResourceTypeTest.scala     |  20 +-
 .../security/auth/SimpleAclAuthorizerTest.scala    |  52 ++++-
 20 files changed, 397 insertions(+), 124 deletions(-)
4d6dcd7bdbb030324d89b785f26844132370cc3c

 core/src/main/scala/kafka/security/auth/SimpleAclAuthorizer.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
2fc91afbad2229ef2f8ef6fbeebc257ab7019746

 .../org/apache/kafka/clients/NetworkClient.java    |  23 ++-
 .../org/apache/kafka/common/acl/AclOperation.java  |  13 ++
 .../kafka/common/requests/AbstractResponse.java    |   3 +
 .../org/apache/kafka/common/resource/Resource.java |  10 +
 .../apache/kafka/common/resource/ResourceType.java |   4 +-
 .../apache/kafka/common/acl/AclOperationTest.java  |   1 +
 .../kafka/common/acl/AclPermissionTypeTest.java    |   1 +
 .../kafka/common/resource/ResourceTypeTest.java    |   3 +-
 core/src/main/scala/kafka/admin/AclCommand.scala   |   2 +-
 .../controller/ControllerChannelManager.scala      |   5 +-
 .../main/scala/kafka/security/auth/Operation.scala |   8 +-
 .../scala/kafka/security/auth/PermissionType.scala |   8 +-
 .../scala/kafka/security/auth/ResourceType.scala   |  22 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  19 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  54 +++--
 .../api/SaslSslAdminClientIntegrationTest.scala    | 225 +++++++++++++++++----
 .../unit/kafka/security/auth/OperationTest.scala   |  28 +--
 .../kafka/security/auth/PermissionTypeTest.scala   |  20 +-
 .../kafka/security/auth/ResourceTypeTest.scala     |  20 +-
 .../security/auth/SimpleAclAuthorizerTest.scala    |  52 ++++-
 20 files changed, 397 insertions(+), 124 deletions(-)
d1acbe9f80e43a89629a7c309685be6bd45291f8

 .../clients/producer/internals/ProducerBatch.java  |  14 +--
 .../producer/internals/RecordAccumulator.java      |  15 +--
 .../kafka/clients/producer/internals/Sender.java   |  16 ++-
 .../producer/internals/TransactionManager.java     |   1 -
 .../producer/internals/RecordAccumulatorTest.java  |  59 ++-------
 .../clients/producer/internals/SenderTest.java     |  50 ++++++++
 .../producer/internals/TransactionManagerTest.java | 138 +++++++++++++++++++++
 .../kafka/tools/TransactionalMessageCopier.java    |  40 ++++--
 8 files changed, 242 insertions(+), 91 deletions(-)
79db393ffaca25fdaac0fef69d6fb082f1628649

 .../clients/producer/internals/ProducerBatch.java  |  14 +--
 .../producer/internals/RecordAccumulator.java      |  15 +--
 .../kafka/clients/producer/internals/Sender.java   |  16 ++-
 .../producer/internals/TransactionManager.java     |   1 -
 .../producer/internals/RecordAccumulatorTest.java  |  59 ++-------
 .../clients/producer/internals/SenderTest.java     |  50 ++++++++
 .../producer/internals/TransactionManagerTest.java | 138 +++++++++++++++++++++
 .../kafka/tools/TransactionalMessageCopier.java    |  40 ++++--
 8 files changed, 242 insertions(+), 91 deletions(-)
1266d4f9ec84f12a46b961892229eb9e66fc5447

 .../kafka/coordinator/group/GroupCoordinator.scala | 15 +++++++-----
 .../coordinator/group/GroupMetadataManager.scala   | 27 ++++++++--------------
 .../transaction/TransactionMetadata.scala          |  1 -
 3 files changed, 19 insertions(+), 24 deletions(-)
effda15f1fbe643cde1f610b9d54715c9e2078cf

 .../kafka/coordinator/group/GroupCoordinator.scala | 15 +++++++-----
 .../coordinator/group/GroupMetadataManager.scala   | 27 ++++++++--------------
 .../transaction/TransactionMetadata.scala          |  1 -
 3 files changed, 19 insertions(+), 24 deletions(-)
6aeca1012356a90d75d58c9294891619e4a7ab81

 core/src/test/scala/unit/kafka/admin/TopicCommandTest.scala | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)
d9c022beb61fc1f202e92b03625f0204905e8b54

 .../java/org/apache/kafka/clients/KafkaClient.java |  10 ++
 .../org/apache/kafka/clients/NetworkClient.java    |  50 +++++-
 .../apache/kafka/clients/admin/AdminClient.java    |  13 +-
 .../kafka/clients/admin/AdminClientConfig.java     |   2 +-
 .../kafka/clients/admin/KafkaAdminClient.java      | 167 +++++++++++----------
 .../java/org/apache/kafka/clients/MockClient.java  |   1 +
 .../kafka/clients/admin/KafkaAdminClientTest.java  |  42 ++++++
 .../kafka/api/AdminClientIntegrationTest.scala     |  19 +++
 8 files changed, 216 insertions(+), 88 deletions(-)
38ae746448f799c3ff8be113f608aaa870e00c87

 .../java/org/apache/kafka/clients/KafkaClient.java |  10 ++
 .../org/apache/kafka/clients/NetworkClient.java    |  50 +++++-
 .../apache/kafka/clients/admin/AdminClient.java    |  13 +-
 .../kafka/clients/admin/AdminClientConfig.java     |   2 +-
 .../kafka/clients/admin/KafkaAdminClient.java      | 167 +++++++++++----------
 .../java/org/apache/kafka/clients/MockClient.java  |   1 +
 .../kafka/clients/admin/KafkaAdminClientTest.java  |  42 ++++++
 .../kafka/api/AdminClientIntegrationTest.scala     |  19 +++
 8 files changed, 216 insertions(+), 88 deletions(-)
71474a6f81d9bc81c0431090c433500f7b490582

 .../streams/streams_simple_benchmark_test.py       |  1 +
 .../services/kafka/templates/log4j.properties      | 28 +++++++++++-----------
 2 files changed, 15 insertions(+), 14 deletions(-)
5c3d7ca7113dd380d7465d5f914adfb4c7394eaa

 .../streams/streams_simple_benchmark_test.py       |  1 +
 .../services/kafka/templates/log4j.properties      | 28 +++++++++++-----------
 2 files changed, 15 insertions(+), 14 deletions(-)
172041d572a53ae7984216837bf956f7f9cfd0fa

 .../kafka/clients/consumer/internals/Fetcher.java  |   7 +-
 .../consumer/internals/SubscriptionState.java      |  14 +-
 .../kafka/clients/producer/KafkaProducer.java      |   2 +-
 .../producer/internals/RecordAccumulator.java      |   2 +-
 .../producer/internals/TransactionManager.java     |   4 +-
 .../clients/consumer/internals/FetcherTest.java    | 118 +++++++---
 .../producer/internals/TransactionManagerTest.java |  86 +++----
 core/src/main/scala/kafka/cluster/Partition.scala  |  11 +
 core/src/main/scala/kafka/log/Log.scala            |  11 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  42 ++--
 .../unit/kafka/server/ISRExpirationTest.scala      |  25 ++-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 249 +++++++++++----------
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   5 +-
 15 files changed, 332 insertions(+), 251 deletions(-)
dcbdce31ba525771016be5be4abc4a2067e0890b

 .../kafka/clients/consumer/internals/Fetcher.java  |   7 +-
 .../consumer/internals/SubscriptionState.java      |  14 +-
 .../kafka/clients/producer/KafkaProducer.java      |   2 +-
 .../producer/internals/RecordAccumulator.java      |   2 +-
 .../producer/internals/TransactionManager.java     |   4 +-
 .../clients/consumer/internals/FetcherTest.java    | 118 +++++++---
 .../producer/internals/TransactionManagerTest.java |  86 +++----
 core/src/main/scala/kafka/cluster/Partition.scala  |  11 +
 core/src/main/scala/kafka/log/Log.scala            |  11 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  42 ++--
 .../unit/kafka/server/ISRExpirationTest.scala      |  25 ++-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 249 +++++++++++----------
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   5 +-
 15 files changed, 332 insertions(+), 251 deletions(-)
60d2f12949ddb7b52ac1e6ffcbd9e0158a824bcc

 docs/api.html            |   8 +--
 docs/configuration.html  |  19 ++---
 docs/connect.html        |  36 +++++-----
 docs/design.html         |   6 +-
 docs/implementation.html |  34 ++++-----
 docs/ops.html            | 107 ++++++++++++++--------------
 docs/quickstart.html     | 176 +++++++++++++++++++++++------------------------
 docs/security.html       | 110 +++++++++++++++--------------
 docs/streams.html        |  32 ++++-----
 9 files changed, 268 insertions(+), 260 deletions(-)
57b0d0fe572399048e523d54beafa3520a708cf5

 docs/api.html            |   8 +--
 docs/configuration.html  |  19 ++---
 docs/connect.html        |  36 +++++-----
 docs/design.html         |   6 +-
 docs/implementation.html |  34 ++++-----
 docs/ops.html            | 107 ++++++++++++++--------------
 docs/quickstart.html     | 176 +++++++++++++++++++++++------------------------
 docs/security.html       | 110 +++++++++++++++--------------
 docs/streams.html        |  32 ++++-----
 9 files changed, 268 insertions(+), 260 deletions(-)
5363cd4c6242673c5079520f3ed4abfec68f83ed

 config/server.properties | 8 ++++++++
 1 file changed, 8 insertions(+)
f8d6dba345de432006a0644434823d70c0a907fc

 config/server.properties | 8 ++++++++
 1 file changed, 8 insertions(+)
b18ca2543762f7a3c93794307a272e86adb65fe4

 .../apache/kafka/clients/consumer/internals/AbstractCoordinator.java | 2 +-
 .../apache/kafka/connect/runtime/distributed/WorkerCoordinator.java  | 5 -----
 2 files changed, 1 insertion(+), 6 deletions(-)
2f5b652a3531b2f5c4e570d25359269a750c90b7

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java  |  2 +-
 .../test/java/org/apache/kafka/clients/MockClient.java    |  7 +++++++
 .../apache/kafka/clients/consumer/KafkaConsumerTest.java  | 15 +++++++++++----
 3 files changed, 19 insertions(+), 5 deletions(-)
bb914a0445549b41fb0b667ea2f5f15a90060133

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java  |  2 +-
 .../test/java/org/apache/kafka/clients/MockClient.java    |  7 +++++++
 .../apache/kafka/clients/consumer/KafkaConsumerTest.java  | 15 +++++++++++----
 3 files changed, 19 insertions(+), 5 deletions(-)
3d0f0caf76691febbcd104f14b5347e1ef19fc7e

 .../java/org/apache/kafka/streams/integration/EosIntegrationTest.java  | 3 ---
 1 file changed, 3 deletions(-)
b01c83ea916f9dd2a2db664d6e458b255d0242a6

 .../java/org/apache/kafka/streams/integration/EosIntegrationTest.java  | 3 ---
 1 file changed, 3 deletions(-)
0c9e4af11d7b949a79c41280f1c99a860fee45cc

 .../kafka/clients/producer/internals/Sender.java   |  5 ++
 .../producer/internals/TransactionManager.java     |  5 +-
 .../producer/internals/TransactionManagerTest.java | 71 ++++++++++++++++-
 tests/kafkatest/tests/core/transactions_test.py    | 92 +++++++++++++++-------
 .../kafka/tools/TransactionalMessageCopier.java    |  5 +-
 5 files changed, 143 insertions(+), 35 deletions(-)
202cb8ea892f443e95c7a08fce5828131809a678

 .../kafka/clients/producer/internals/Sender.java   |  5 ++
 .../producer/internals/TransactionManager.java     |  5 +-
 .../producer/internals/TransactionManagerTest.java | 71 ++++++++++++++++-
 tests/kafkatest/tests/core/transactions_test.py    | 92 +++++++++++++++-------
 .../kafka/tools/TransactionalMessageCopier.java    |  5 +-
 5 files changed, 143 insertions(+), 35 deletions(-)
547ddcb1b8dad8f4efb03e1194f5860965efea9c

 .../kafka/connect/runtime/WorkerSinkTask.java      |   8 +-
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 100 +++++++++++++++++++++
 2 files changed, 107 insertions(+), 1 deletion(-)
d655d806ee4fe345ea25f8ff4a5f168c1a5f609b

 .../kafka/connect/runtime/WorkerSinkTask.java      |   8 +-
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 100 +++++++++++++++++++++
 2 files changed, 107 insertions(+), 1 deletion(-)
2244c68ebc4b016e1a037026f625a2ecceb852a3

 .../src/test/java/org/apache/kafka/streams/perf/SimpleBenchmark.java    | 2 ++
 1 file changed, 2 insertions(+)
503f927210a91ffd6fa90703099276083876f02d

 docs/streams.html | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)
ad8e7cf5e82386f8596025b06fab6b1cbd0b9109

 docs/streams.html | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)
c39fea37e4b4c6e1488629d4bcb16efb5db4dc01

 .../test/scala/unit/kafka/admin/DescribeConsumerGroupTest.scala    | 7 +++++++
 1 file changed, 7 insertions(+)
3de683993dcc1f363cc2e1b177181036b96c2cee

 .../test/scala/unit/kafka/admin/DescribeConsumerGroupTest.scala    | 7 +++++++
 1 file changed, 7 insertions(+)
9419204c2b4e63e9b1a47335f16191dc6e23543f

 .../kafka/clients/producer/KafkaProducer.java      |  16 +-
 .../producer/internals/RecordAccumulator.java      |   4 +-
 .../producer/internals/TransactionManager.java     |  78 +++--
 .../producer/internals/RecordAccumulatorTest.java  |   1 -
 .../clients/producer/internals/SenderTest.java     |   4 +-
 .../producer/internals/TransactionManagerTest.java | 342 ++++++++++++++++++++-
 6 files changed, 381 insertions(+), 64 deletions(-)
cb78ba1294d1a27b2c4d842a125486ffec593d98

 .../kafka/clients/producer/KafkaProducer.java      |  16 +-
 .../producer/internals/RecordAccumulator.java      |   4 +-
 .../producer/internals/TransactionManager.java     |  78 +++--
 .../producer/internals/RecordAccumulatorTest.java  |   1 -
 .../clients/producer/internals/SenderTest.java     |   4 +-
 .../producer/internals/TransactionManagerTest.java | 342 ++++++++++++++++++++-
 6 files changed, 381 insertions(+), 64 deletions(-)
b9c876ee0ee4446e527f88c60427ebf273a664e9

 core/src/main/scala/kafka/admin/AdminClient.scala  |  36 ++-
 .../other/kafka/ReplicationQuotasTestRig.scala     |   5 -
 .../kafka/admin/DescribeConsumerGroupTest.scala    | 284 +++++++++------------
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   |   4 +-
 .../unit/kafka/server/ReplicationQuotasTest.scala  |   4 +-
 ...chDrivenReplicationProtocolAcceptanceTest.scala |   2 +-
 .../server/epoch/LeaderEpochIntegrationTest.scala  |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  28 +-
 8 files changed, 174 insertions(+), 191 deletions(-)
313f8d7ddc48943d9f2290a27751d7a0fa1d3a82

 core/src/main/scala/kafka/admin/AdminClient.scala  |  36 ++-
 .../other/kafka/ReplicationQuotasTestRig.scala     |   5 -
 .../kafka/admin/DescribeConsumerGroupTest.scala    | 284 +++++++++------------
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   |   4 +-
 .../unit/kafka/server/ReplicationQuotasTest.scala  |   4 +-
 ...chDrivenReplicationProtocolAcceptanceTest.scala |   2 +-
 .../server/epoch/LeaderEpochIntegrationTest.scala  |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  28 +-
 8 files changed, 174 insertions(+), 191 deletions(-)
1d943a765e6036033b67ff3d65ef7e6ffc6e731a

 .../kafka/common/network/SslChannelBuilder.java    |  46 +++++++-
 .../kafka/common/security/ssl/SslFactory.java      |   2 +
 .../apache/kafka/common/network/CertStores.java    |  17 ++-
 .../kafka/common/network/NetworkTestUtils.java     |   2 +-
 .../apache/kafka/common/network/NioEchoServer.java |   6 +-
 .../kafka/common/network/SslSelectorTest.java      |   4 +-
 .../common/network/SslTransportLayerTest.java      | 130 +++++++++++++++++++--
 .../java/org/apache/kafka/test/TestSslUtils.java   |  92 ++++++++++-----
 8 files changed, 252 insertions(+), 47 deletions(-)
17b2bde4be6296dfd47defce85443cbf6e23835b

 .../kafka/common/network/SslChannelBuilder.java    |  46 +++++++-
 .../kafka/common/security/ssl/SslFactory.java      |   2 +
 .../apache/kafka/common/network/CertStores.java    |  17 ++-
 .../kafka/common/network/NetworkTestUtils.java     |   2 +-
 .../apache/kafka/common/network/NioEchoServer.java |   6 +-
 .../kafka/common/network/SslSelectorTest.java      |   4 +-
 .../common/network/SslTransportLayerTest.java      | 130 +++++++++++++++++++--
 .../java/org/apache/kafka/test/TestSslUtils.java   |  92 ++++++++++-----
 8 files changed, 252 insertions(+), 47 deletions(-)
4b37918ef47f5d8c4874644f576d8e1a72e16212

 .../clients/producer/internals/BufferPool.java     | 73 ++++++++++++++--------
 .../clients/producer/internals/BufferPoolTest.java | 25 +++++++-
 2 files changed, 69 insertions(+), 29 deletions(-)
8f9ee0ee4d744424f2e66b754fbdf61e3b1799d4

 .../org/apache/kafka/common/network/Selector.java  | 17 ++++++++++-
 .../authenticator/SaslClientAuthenticator.java     | 35 +++++++++++++++++-----
 .../authenticator/SaslServerAuthenticator.java     | 10 +++----
 .../authenticator/SaslAuthenticatorTest.java       | 10 +++++--
 4 files changed, 56 insertions(+), 16 deletions(-)
9934d28a34351a63738f8e9bac6b53fd699a4905

 .../org/apache/kafka/common/network/Selector.java  | 17 ++++++++++-
 .../authenticator/SaslClientAuthenticator.java     | 35 +++++++++++++++++-----
 .../authenticator/SaslServerAuthenticator.java     | 10 +++----
 .../authenticator/SaslAuthenticatorTest.java       | 10 +++++--
 4 files changed, 56 insertions(+), 16 deletions(-)
b9b4af1d465ca03925f31e6f1c8bff84e61c17ce

 .../clients/consumer/internals/FetcherTest.java    |  10 +-
 core/src/main/scala/kafka/log/Log.scala            |  11 +-
 .../scala/kafka/log/ProducerStateManager.scala     |  29 +++++
 .../src/main/scala/kafka/server/DelayedFetch.scala |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../integration/kafka/api/TransactionsTest.scala   |  48 ++++++-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 142 ++++++++++++++++-----
 7 files changed, 200 insertions(+), 45 deletions(-)
2bb48a4fa45422d0773f2f4ea5b38328d3c173ac

 .../clients/consumer/internals/FetcherTest.java    |  10 +-
 core/src/main/scala/kafka/log/Log.scala            |  11 +-
 .../scala/kafka/log/ProducerStateManager.scala     |  29 +++++
 .../src/main/scala/kafka/server/DelayedFetch.scala |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../integration/kafka/api/TransactionsTest.scala   |  48 ++++++-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 142 ++++++++++++++++-----
 7 files changed, 200 insertions(+), 45 deletions(-)
d21429df02773b19ee44063a1f83894989662347

 tests/docker/Dockerfile                            |  1 +
 tests/docker/run_tests.sh                          |  2 +-
 .../services/kafka/templates/kafka.properties      |  4 ++-
 .../client/client_compatibility_features_test.py   |  3 +-
 .../client_compatibility_produce_consume_test.py   |  3 +-
 .../tests/client/message_format_change_test.py     | 32 +++++++++++++++-------
 .../core/compatibility_test_new_broker_test.py     |  5 ++--
 tests/kafkatest/tests/core/upgrade_test.py         | 16 +++++++----
 8 files changed, 43 insertions(+), 23 deletions(-)
b119d04093c2eb771fc3d9bc2d5c1390fc3dd184

 tests/docker/Dockerfile                            |  1 +
 tests/docker/run_tests.sh                          |  2 +-
 .../services/kafka/templates/kafka.properties      |  4 ++-
 .../client/client_compatibility_features_test.py   |  3 +-
 .../client_compatibility_produce_consume_test.py   |  3 +-
 .../tests/client/message_format_change_test.py     | 32 +++++++++++++++-------
 .../core/compatibility_test_new_broker_test.py     |  5 ++--
 tests/kafkatest/tests/core/upgrade_test.py         | 16 +++++++----
 8 files changed, 43 insertions(+), 23 deletions(-)
39eb31feaeebfb184d98cc5d94da9148c2319d81

 checkstyle/suppressions.xml                        |  2 +-
 .../org/apache/kafka/common/internals/Topic.java   | 13 ++++--
 gradle/findbugs-exclude.xml                        |  1 +
 .../apache/kafka/jmh/common/TopicBenchmark.java    | 53 ++++++++++++++++++++++
 4 files changed, 65 insertions(+), 4 deletions(-)
d51b54918ef69ecf418b3a373f098589a270aa6f

 .../scala/kafka/common/InterBrokerSendThread.scala | 53 +++++++------
 .../TransactionMarkerChannelManager.scala          | 86 ++++++++++++++++------
 .../TransactionMarkerChannelManagerTest.scala      | 12 ++-
 3 files changed, 105 insertions(+), 46 deletions(-)
8e3ed7028e235b014cd14aedde6808b4ae411232

 .../scala/kafka/common/InterBrokerSendThread.scala | 53 +++++++------
 .../TransactionMarkerChannelManager.scala          | 86 ++++++++++++++++------
 .../TransactionMarkerChannelManagerTest.scala      | 12 ++-
 3 files changed, 105 insertions(+), 46 deletions(-)
bf2966a73aa7e40d7724a28c8cf8f30765cf8bcc

 docs/streams.html | 41 +++++++++++++++++++++++++++++++++--------
 1 file changed, 33 insertions(+), 8 deletions(-)
1c70e7ac12966bb13fecd633b5ba8223178733a4

 docs/streams.html | 41 +++++++++++++++++++++++++++++++++--------
 1 file changed, 33 insertions(+), 8 deletions(-)
bcbd5e665b6966f3376f1763ca31a7173c7db289

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 4 ++++
 1 file changed, 4 insertions(+)
b62f156eb480498eba338b1746a995ed0d8ce871

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 4 ++++
 1 file changed, 4 insertions(+)
6baf0c92d2146844f99d341f9324625ebe1c3ad2

 docs/streams.html | 30 ++++++++++++++++++++++--------
 1 file changed, 22 insertions(+), 8 deletions(-)
d4a070fcfae97a5ec0681f7055385c6459727956

 docs/streams.html | 30 ++++++++++++++++++++++--------
 1 file changed, 22 insertions(+), 8 deletions(-)
f2c3cfe6a501426b67e1203ad243523121945ac3

 .../kafka/clients/consumer/internals/Fetcher.java  |  19 +-
 .../producer/internals/TransactionManager.java     |   8 +
 .../common/requests/TxnOffsetCommitRequest.java    |   4 +
 .../coordinator/group/GroupMetadataManager.scala   |   5 +-
 core/src/main/scala/kafka/log/Log.scala            |   9 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  40 ++++-
 .../integration/kafka/api/TransactionsTest.scala   | 108 ++++++++---
 .../ReplicaFetcherThreadFatalErrorTest.scala       |   4 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |   3 +-
 .../group/GroupMetadataManagerTest.scala           |   3 +-
 .../transaction/TransactionStateManagerTest.scala  |   4 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  11 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  56 +++---
 .../kafka/server/ReplicaManagerQuotasTest.scala    |  20 ++-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 197 +++++++++++----------
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  26 ++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 19 files changed, 323 insertions(+), 202 deletions(-)
3557f097b81edd6518100d79b442223fadf9f81f

 .../kafka/clients/consumer/internals/Fetcher.java  |  19 +-
 .../producer/internals/TransactionManager.java     |   8 +
 .../common/requests/TxnOffsetCommitRequest.java    |   4 +
 .../coordinator/group/GroupMetadataManager.scala   |   5 +-
 core/src/main/scala/kafka/log/Log.scala            |   9 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  40 ++++-
 .../integration/kafka/api/TransactionsTest.scala   | 108 ++++++++---
 .../ReplicaFetcherThreadFatalErrorTest.scala       |   4 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |   3 +-
 .../group/GroupMetadataManagerTest.scala           |   3 +-
 .../transaction/TransactionStateManagerTest.scala  |   4 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  11 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  56 +++---
 .../kafka/server/ReplicaManagerQuotasTest.scala    |  20 ++-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 197 +++++++++++----------
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  26 ++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 19 files changed, 323 insertions(+), 202 deletions(-)
296dfb5bf48863c77d49fbece3a87b163c86ce4f

 checkstyle/import-control.xml                      |  1 +
 .../common/header/internals/RecordHeaders.java     |  2 +-
 gradle/findbugs-exclude.xml                        |  1 +
 .../jmh/producer/ProducerRecordBenchmark.java      | 47 ++++++++++++++++++++++
 4 files changed, 50 insertions(+), 1 deletion(-)
c7bc8f7d8c0101103853b5f6778edb04d1f41b76

 checkstyle/import-control.xml                      |  1 +
 .../common/header/internals/RecordHeaders.java     |  2 +-
 gradle/findbugs-exclude.xml                        |  1 +
 .../jmh/producer/ProducerRecordBenchmark.java      | 47 ++++++++++++++++++++++
 4 files changed, 50 insertions(+), 1 deletion(-)
358ccf0932c6fb65f5b42dfec31adc1561d7e4f5

 .../java/org/apache/kafka/clients/producer/ProducerRecord.java   | 9 ---------
 1 file changed, 9 deletions(-)
d7ec9feaf1c2d2fc79218a798394f4665e4d72d0

 .../java/org/apache/kafka/clients/producer/ProducerRecord.java   | 9 ---------
 1 file changed, 9 deletions(-)
384293911ec561c4e96ba74ffedd2a79c75045bf

 .../unit/kafka/producer/SyncProducerTest.scala     | 41 ++++++++--------------
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  3 +-
 2 files changed, 16 insertions(+), 28 deletions(-)
9b58372dcce5dc96826d4786123513a4d8c7b39f

 .../unit/kafka/producer/SyncProducerTest.scala     | 41 ++++++++--------------
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  3 +-
 2 files changed, 16 insertions(+), 28 deletions(-)
c4b6df975d2738a42184f246df06581c4be1d540

 .../java/org/apache/kafka/clients/producer/ProducerRecord.java   | 9 +++++++++
 1 file changed, 9 insertions(+)
941e2177c0cf57eff818192258300d256971a11e

 .../java/org/apache/kafka/clients/producer/ProducerRecord.java   | 9 +++++++++
 1 file changed, 9 insertions(+)
45b326d9365c767378018357ca5993edceffdace

 core/src/main/scala/kafka/admin/TopicCommand.scala | 18 ++++++++---
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  4 +++
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  6 ++--
 .../scala/unit/kafka/admin/TopicCommandTest.scala  | 37 ++++++++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 12 ++++++-
 5 files changed, 68 insertions(+), 9 deletions(-)
a598c4d26fb06acb455e14e84468306dfa6e1c8b

 core/src/main/scala/kafka/admin/TopicCommand.scala | 18 ++++++++---
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  4 +++
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  6 ++--
 .../scala/unit/kafka/admin/TopicCommandTest.scala  | 37 ++++++++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 12 ++++++-
 5 files changed, 68 insertions(+), 9 deletions(-)
b9f7aa52dce7bab5aa66a1d72356103067ea4e22

 docs/upgrade.html | 82 +++++++++++++++++++++++++++++++++++++++++++++++--------
 1 file changed, 71 insertions(+), 11 deletions(-)
8711e5937fe33b87123843f9ce9825c60b784ef9

 docs/upgrade.html | 82 +++++++++++++++++++++++++++++++++++++++++++++++--------
 1 file changed, 71 insertions(+), 11 deletions(-)
a30513a53961cb494ec919b2c7cf6c7ad8927eee

 checkstyle/import-control.xml                      |  1 +
 .../kafka/clients/admin/KafkaAdminClient.java      |  8 +++--
 .../client/client_compatibility_features_test.py   |  2 ++
 .../kafka/tools/ClientCompatibilityTest.java       | 35 ++++++++++++++++++++++
 4 files changed, 44 insertions(+), 2 deletions(-)
f389b715707e4e53eaf6ce476a218a4a06c427ee

 checkstyle/import-control.xml                      |  1 +
 .../kafka/clients/admin/KafkaAdminClient.java      |  8 +++--
 .../client/client_compatibility_features_test.py   |  2 ++
 .../kafka/tools/ClientCompatibilityTest.java       | 35 ++++++++++++++++++++++
 4 files changed, 44 insertions(+), 2 deletions(-)
054e9740f1bde193680bebb4329acabd509f0060

 core/src/main/scala/kafka/server/DelayedFetch.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
6a5a908b1cf972451ec8d5c66cf9fb4507a1355f

 core/src/main/scala/kafka/server/DelayedFetch.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
8ebe4838a94d25938ed86c79d555f54e4752e64b

 .../kafka/server/policy/AlterConfigPolicy.java     |  85 ++++
 .../kafka/clients/admin/KafkaAdminClientTest.java  |   2 +-
 .../src/main/scala/kafka/server/AdminManager.scala |  34 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   5 +
 .../kafka/api/AdminClientIntegrationTest.scala     | 491 +++++++++++++++++++++
 .../AdminClientWithPoliciesIntegrationTest.scala   | 209 +++++++++
 .../api/KafkaAdminClientIntegrationTest.scala      | 475 --------------------
 .../api/SaslSslAdminClientIntegrationTest.scala    |   2 +-
 8 files changed, 818 insertions(+), 485 deletions(-)
eb5586102e5bb4b66f2cacafbe45f9a7bad8eb10

 .../kafka/server/policy/AlterConfigPolicy.java     |  85 ++++
 .../kafka/clients/admin/KafkaAdminClientTest.java  |   2 +-
 .../src/main/scala/kafka/server/AdminManager.scala |  34 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   5 +
 .../kafka/api/AdminClientIntegrationTest.scala     | 491 +++++++++++++++++++++
 .../AdminClientWithPoliciesIntegrationTest.scala   | 209 +++++++++
 .../api/KafkaAdminClientIntegrationTest.scala      | 475 --------------------
 .../api/SaslSslAdminClientIntegrationTest.scala    |   2 +-
 8 files changed, 818 insertions(+), 485 deletions(-)
2223d13893bc6ef6405ec4f1bb31e04a14033fff

 .../apache/kafka/common/record/MemoryRecords.java  | 53 +++++++++++++---------
 .../kafka/common/record/MemoryRecordsTest.java     | 16 ++++---
 core/src/main/scala/kafka/log/LogCleaner.scala     |  4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  4 +-
 4 files changed, 46 insertions(+), 31 deletions(-)
1c786c589ab6737e1660981e739582935f9e0f0d

 .../apache/kafka/common/record/MemoryRecords.java  | 53 +++++++++++++---------
 .../kafka/common/record/MemoryRecordsTest.java     | 16 ++++---
 core/src/main/scala/kafka/log/LogCleaner.scala     |  4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  4 +-
 4 files changed, 46 insertions(+), 31 deletions(-)
27578d0096663993612849121fdc5dfb509a117f

 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 34 ++++------------------
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 32 --------------------
 2 files changed, 6 insertions(+), 60 deletions(-)
8104c0de273fb7627c4172f18a609472186860fd

 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 34 ++++------------------
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 32 --------------------
 2 files changed, 6 insertions(+), 60 deletions(-)
f2673eb37818f5e74fdbec90b5277822ce247bd3

 .../org/apache/kafka/clients/producer/internals/TransactionManager.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0b107e5f752f4f7d1d6dc97891cb9569c3db5b3d

 .../org/apache/kafka/clients/producer/internals/TransactionManager.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
27a8b4fe540ac755986f8ea5fff9f496b5e6254e

 .../producer/internals/TransactionManager.java     |  3 +
 .../errors/OperationNotAttemptedException.java     | 27 ++++++++
 .../org/apache/kafka/common/protocol/Errors.java   | 13 +++-
 .../producer/internals/TransactionManagerTest.java | 26 +++++---
 core/src/main/scala/kafka/server/KafkaApis.scala   | 11 ++--
 .../server/AddPartitionsToTxnRequestTest.scala     | 76 ++++++++++++++++++++++
 6 files changed, 141 insertions(+), 15 deletions(-)
a318b1512900d29dc9ff0082f52f467999ba69b8

 .../producer/internals/TransactionManager.java     |  3 +
 .../errors/OperationNotAttemptedException.java     | 27 ++++++++
 .../org/apache/kafka/common/protocol/Errors.java   | 13 +++-
 .../producer/internals/TransactionManagerTest.java | 26 +++++---
 core/src/main/scala/kafka/server/KafkaApis.scala   | 11 ++--
 .../server/AddPartitionsToTxnRequestTest.scala     | 76 ++++++++++++++++++++++
 6 files changed, 141 insertions(+), 15 deletions(-)
bf8378a84fbe874b1091555e58e0a13ad874cda5

 .../org/apache/kafka/common/record/CompressionType.java | 17 +++++++++--------
 .../kafka/common/record/MemoryRecordsBuilder.java       |  4 +---
 .../apache/kafka/common/record/CompressionTypeTest.java |  4 ++--
 .../kafka/common/record/SimpleLegacyRecordTest.java     |  2 +-
 .../unit/kafka/message/MessageCompressionTest.scala     | 12 ++++++------
 docs/upgrade.html                                       |  6 ++++++
 6 files changed, 25 insertions(+), 20 deletions(-)
4959444afc927026f48f5c7d9babed7b9f1bea50

 .../org/apache/kafka/common/record/CompressionType.java | 17 +++++++++--------
 .../kafka/common/record/MemoryRecordsBuilder.java       |  4 +---
 .../apache/kafka/common/record/CompressionTypeTest.java |  4 ++--
 .../kafka/common/record/SimpleLegacyRecordTest.java     |  2 +-
 .../unit/kafka/message/MessageCompressionTest.scala     | 12 ++++++------
 docs/upgrade.html                                       |  6 ++++++
 6 files changed, 25 insertions(+), 20 deletions(-)
f9de919c1644e1686d8217048f87fd508a9c21f8

 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 34 ++++++++++++++++++----
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 32 ++++++++++++++++++++
 2 files changed, 60 insertions(+), 6 deletions(-)
b63e41ea78a58bdea78be33f90bfcb61ce5988d3

 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 34 ++++++++++++++++++----
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 32 ++++++++++++++++++++
 2 files changed, 60 insertions(+), 6 deletions(-)
84709861055f677123c88b19a5f1bd44576e2a3f

 .../org/apache/kafka/common/metrics/stats/Sum.java | 45 ++++++++++++++++++++++
 .../streams/processor/internals/StreamThread.java  |  3 +-
 2 files changed, 47 insertions(+), 1 deletion(-)
0a8b10e27f573612e1d5d6787b2096d3a8528b94

 .../org/apache/kafka/common/metrics/stats/Sum.java | 45 ++++++++++++++++++++++
 .../streams/processor/internals/StreamThread.java  |  3 +-
 2 files changed, 47 insertions(+), 1 deletion(-)
4671a486cfe2757cd04011f4f969a44e7d37b54a

 .../main/scala/kafka/consumer/BaseConsumer.scala   | 46 ++++++++++++++++------
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  3 ++
 2 files changed, 36 insertions(+), 13 deletions(-)
d7d1196a0b542adb46d22eeb5b6d12af950b64c9

 .../main/scala/kafka/consumer/BaseConsumer.scala   | 46 ++++++++++++++++------
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  3 ++
 2 files changed, 36 insertions(+), 13 deletions(-)
f5aee9bd5f1229ace6101b28f37dd145d0c3e150

 .../connect/transforms/SetSchemaMetadata.java      | 33 ++++++++-
 .../connect/transforms/SetSchemaMetadataTest.java  | 80 ++++++++++++++++++++++
 2 files changed, 111 insertions(+), 2 deletions(-)
af85e05b98a41cd5f8ac45a853b2ddd28463c084

 .../connect/transforms/SetSchemaMetadata.java      | 33 ++++++++-
 .../connect/transforms/SetSchemaMetadataTest.java  | 80 ++++++++++++++++++++++
 2 files changed, 111 insertions(+), 2 deletions(-)
bac27673fb47810bbae871c7f5973c7c0eadf516

 .../kafka/streams/processor/internals/StreamsKafkaClient.java     | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
0d71cf108e11c49b3399065071a6a43b3e20cd21

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  4 +++
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |  1 +
 core/src/main/scala/kafka/api/FetchRequest.scala   |  3 ++
 core/src/main/scala/kafka/client/ClientUtils.scala |  3 +-
 .../main/scala/kafka/consumer/BaseConsumer.scala   |  8 +++++
 .../main/scala/kafka/consumer/ConsumerConfig.scala | 22 +++++++------
 .../scala/kafka/consumer/ConsumerConnector.scala   | 14 ++++++---
 .../kafka/consumer/ConsumerFetcherManager.scala    |  1 +
 .../kafka/consumer/ConsumerFetcherThread.scala     |  4 +++
 .../scala/kafka/consumer/ConsumerIterator.scala    |  3 ++
 .../scala/kafka/consumer/ConsumerTopicStats.scala  |  3 ++
 .../consumer/FetchRequestAndResponseStats.scala    |  3 ++
 .../scala/kafka/consumer/FetchedDataChunk.scala    |  3 +-
 .../main/scala/kafka/consumer/KafkaStream.scala    |  2 ++
 .../scala/kafka/consumer/PartitionAssignor.scala   |  9 ++++++
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  6 ++--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  2 ++
 .../src/main/scala/kafka/consumer/TopicCount.scala |  7 ++++-
 .../scala/kafka/consumer/TopicEventHandler.scala   |  1 +
 .../main/scala/kafka/consumer/TopicFilter.scala    |  5 +--
 .../consumer/ZookeeperConsumerConnector.scala      |  2 ++
 .../consumer/ZookeeperTopicEventWatcher.scala      |  1 +
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  4 +++
 .../consumer/ConsumerRebalanceListener.java        |  4 +++
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |  6 ++--
 .../consumer/ZookeeperConsumerConnector.scala      |  1 +
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |  1 +
 .../main/scala/kafka/network/BlockingChannel.scala |  2 ++
 .../scala/kafka/server/AbstractFetcherThread.scala |  2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |  1 +
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 36 ++++++++++++----------
 .../kafka/tools/SimpleConsumerPerformance.scala    |  3 ++
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  6 ++--
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala | 10 +++---
 .../kafka/tools/VerifyConsumerRebalance.scala      |  2 ++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  9 ++++++
 .../test/scala/kafka/tools/TestLogCleaning.scala   | 35 +++++++++++----------
 .../unit/kafka/admin/DeleteConsumerGroupTest.scala |  1 +
 .../kafka/admin/DescribeConsumerGroupTest.scala    |  4 +++
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  5 +--
 .../kafka/consumer/PartitionAssignorTest.scala     |  3 +-
 .../unit/kafka/consumer/TopicFilterTest.scala      |  5 +--
 .../scala/unit/kafka/integration/FetcherTest.scala |  1 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  5 ++-
 .../java/kafka/examples/SimpleConsumerDemo.java    |  4 +++
 45 files changed, 187 insertions(+), 70 deletions(-)
f85c18032be5d583c2ca8f9fa1eb1b5ec55e59fa

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  4 +++
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |  1 +
 core/src/main/scala/kafka/api/FetchRequest.scala   |  3 ++
 core/src/main/scala/kafka/client/ClientUtils.scala |  3 +-
 .../main/scala/kafka/consumer/BaseConsumer.scala   |  8 +++++
 .../main/scala/kafka/consumer/ConsumerConfig.scala | 22 +++++++------
 .../scala/kafka/consumer/ConsumerConnector.scala   | 14 ++++++---
 .../kafka/consumer/ConsumerFetcherManager.scala    |  1 +
 .../kafka/consumer/ConsumerFetcherThread.scala     |  4 +++
 .../scala/kafka/consumer/ConsumerIterator.scala    |  3 ++
 .../scala/kafka/consumer/ConsumerTopicStats.scala  |  3 ++
 .../consumer/FetchRequestAndResponseStats.scala    |  3 ++
 .../scala/kafka/consumer/FetchedDataChunk.scala    |  3 +-
 .../main/scala/kafka/consumer/KafkaStream.scala    |  2 ++
 .../scala/kafka/consumer/PartitionAssignor.scala   |  9 ++++++
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  6 ++--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  2 ++
 .../src/main/scala/kafka/consumer/TopicCount.scala |  7 ++++-
 .../scala/kafka/consumer/TopicEventHandler.scala   |  1 +
 .../main/scala/kafka/consumer/TopicFilter.scala    |  5 +--
 .../consumer/ZookeeperConsumerConnector.scala      |  2 ++
 .../consumer/ZookeeperTopicEventWatcher.scala      |  1 +
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  4 +++
 .../consumer/ConsumerRebalanceListener.java        |  4 +++
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |  6 ++--
 .../consumer/ZookeeperConsumerConnector.scala      |  1 +
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |  1 +
 .../main/scala/kafka/network/BlockingChannel.scala |  2 ++
 .../scala/kafka/server/AbstractFetcherThread.scala |  2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |  1 +
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 36 ++++++++++++----------
 .../kafka/tools/SimpleConsumerPerformance.scala    |  3 ++
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  6 ++--
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala | 10 +++---
 .../kafka/tools/VerifyConsumerRebalance.scala      |  2 ++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  9 ++++++
 .../test/scala/kafka/tools/TestLogCleaning.scala   | 35 +++++++++++----------
 .../unit/kafka/admin/DeleteConsumerGroupTest.scala |  1 +
 .../kafka/admin/DescribeConsumerGroupTest.scala    |  4 +++
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  5 +--
 .../kafka/consumer/PartitionAssignorTest.scala     |  3 +-
 .../unit/kafka/consumer/TopicFilterTest.scala      |  5 +--
 .../scala/unit/kafka/integration/FetcherTest.scala |  1 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  5 ++-
 .../java/kafka/examples/SimpleConsumerDemo.java    |  4 +++
 45 files changed, 187 insertions(+), 70 deletions(-)
99a3f816579a5c8d92d8624ccbbdbdb63f519c7b

 .../integration/kafka/api/TransactionsTest.scala   | 374 ++++++++++-----------
 1 file changed, 180 insertions(+), 194 deletions(-)
5d46348619b1ca8610af305bf5e90c560b050258

 .../integration/kafka/api/TransactionsTest.scala   | 374 ++++++++++-----------
 1 file changed, 180 insertions(+), 194 deletions(-)
ca54eaef4cd1cb584d92f03d49f3e0cb637bfe86

 .../common/record/AbstractLegacyRecordBatch.java   | 63 +++++++++++++---------
 .../kafka/common/record/DefaultRecordBatch.java    |  1 -
 .../record/AbstractLegacyRecordBatchTest.java      | 46 +++++++++++++++-
 3 files changed, 83 insertions(+), 27 deletions(-)
47a3066ccb216bfb65dda2746ca1b7775d8cba05

 .../common/record/AbstractLegacyRecordBatch.java   | 63 +++++++++++++---------
 .../kafka/common/record/DefaultRecordBatch.java    |  1 -
 .../record/AbstractLegacyRecordBatchTest.java      | 46 +++++++++++++++-
 3 files changed, 83 insertions(+), 27 deletions(-)
963c423c1923add6c7e71c3bf8a34df6d12c385a

 .../kafka/clients/consumer/internals/Fetcher.java  |  5 +-
 .../kafka/clients/producer/KafkaProducer.java      |  6 +-
 .../kafka/clients/producer/MockProducer.java       |  6 +-
 .../common/serialization/ExtendedDeserializer.java |  4 ++
 .../common/serialization/ExtendedSerializer.java   |  4 ++
 .../kstream/internals/ChangedDeserializer.java     | 24 +++++---
 .../kstream/internals/ChangedSerializer.java       | 22 +++++---
 .../streams/processor/internals/SourceNode.java    | 24 ++++----
 .../internals/SourceNodeRecordDeserializer.java    |  4 +-
 .../SourceNodeRecordDeserializerTest.java          |  5 +-
 .../processor/internals/SourceNodeTest.java        | 65 ++++++++++++++++++++++
 11 files changed, 128 insertions(+), 41 deletions(-)
1188db5657e1db6944b59b1c91a75e47856f4e5c

 .../kafka/clients/consumer/internals/Fetcher.java  |  5 +-
 .../kafka/clients/producer/KafkaProducer.java      |  6 +-
 .../kafka/clients/producer/MockProducer.java       |  6 +-
 .../common/serialization/ExtendedDeserializer.java |  4 ++
 .../common/serialization/ExtendedSerializer.java   |  4 ++
 .../kstream/internals/ChangedDeserializer.java     | 24 +++++---
 .../kstream/internals/ChangedSerializer.java       | 22 +++++---
 .../streams/processor/internals/SourceNode.java    | 24 ++++----
 .../internals/SourceNodeRecordDeserializer.java    |  4 +-
 .../SourceNodeRecordDeserializerTest.java          |  5 +-
 .../processor/internals/SourceNodeTest.java        | 65 ++++++++++++++++++++++
 11 files changed, 128 insertions(+), 41 deletions(-)
da6da53563066519c587c751c1b16b65760fe096

 .../producer/internals/TransactionManager.java     |  34 ++++++-
 .../producer/internals/TransactionManagerTest.java | 111 ++++++++++++++++++++-
 2 files changed, 139 insertions(+), 6 deletions(-)
673ab671e6d72f48fcc98de0b73564983c34e752

 .../producer/internals/TransactionManager.java     |  34 ++++++-
 .../producer/internals/TransactionManagerTest.java | 111 ++++++++++++++++++++-
 2 files changed, 139 insertions(+), 6 deletions(-)
07cfcc53bcb16a015903e9045e3c04c908e86e52

 .../apache/kafka/common/record/DefaultRecord.java  |   4 +-
 .../kafka/common/record/DefaultRecordBatch.java    |  10 +-
 .../common/record/DefaultRecordBatchTest.java      |  36 ++++
 .../transaction/TransactionCoordinator.scala       |  70 ++++----
 .../TransactionMarkerChannelManager.scala          |   4 +-
 ...TransactionMarkerRequestCompletionHandler.scala |   4 +-
 .../transaction/TransactionMetadata.scala          | 131 +++++++++-----
 .../transaction/TransactionStateManager.scala      |  78 +++++----
 .../scala/kafka/log/ProducerStateManager.scala     |  18 +-
 .../integration/kafka/api/TransactionsTest.scala   |  10 +-
 .../transaction/TransactionCoordinatorTest.scala   | 146 ++++++++++++----
 .../TransactionMarkerChannelManagerTest.scala      |   4 +-
 ...sactionMarkerRequestCompletionHandlerTest.scala |   8 +-
 .../transaction/TransactionMetadataTest.scala      | 188 +++++++++++++++++++++
 .../transaction/TransactionStateManagerTest.scala  |  66 ++++----
 .../unit/kafka/log/ProducerStateManagerTest.scala  |  27 +++
 16 files changed, 605 insertions(+), 199 deletions(-)
1c882ee5fb4ef2d256c914bd69239d58d9706108

 .../apache/kafka/common/record/DefaultRecord.java  |   4 +-
 .../kafka/common/record/DefaultRecordBatch.java    |  10 +-
 .../common/record/DefaultRecordBatchTest.java      |  36 ++++
 .../transaction/TransactionCoordinator.scala       |  70 ++++----
 .../TransactionMarkerChannelManager.scala          |   4 +-
 ...TransactionMarkerRequestCompletionHandler.scala |   4 +-
 .../transaction/TransactionMetadata.scala          | 131 +++++++++-----
 .../transaction/TransactionStateManager.scala      |  78 +++++----
 .../scala/kafka/log/ProducerStateManager.scala     |  18 +-
 .../integration/kafka/api/TransactionsTest.scala   |  10 +-
 .../transaction/TransactionCoordinatorTest.scala   | 146 ++++++++++++----
 .../TransactionMarkerChannelManagerTest.scala      |   4 +-
 ...sactionMarkerRequestCompletionHandlerTest.scala |   8 +-
 .../transaction/TransactionMetadataTest.scala      | 188 +++++++++++++++++++++
 .../transaction/TransactionStateManagerTest.scala  |  66 ++++----
 .../unit/kafka/log/ProducerStateManagerTest.scala  |  27 +++
 16 files changed, 605 insertions(+), 199 deletions(-)
4424534e99a92f54a873771dc3f05f23f3487669

 .../kafka/clients/consumer/internals/Fetcher.java  | 11 +++-
 .../producer/internals/ProducerIdAndEpoch.java     |  5 ++
 .../producer/internals/RecordAccumulator.java      |  6 +-
 .../kafka/clients/producer/internals/Sender.java   | 35 ++++------
 .../producer/internals/TransactionManager.java     | 74 ++++++++++------------
 .../common/requests/AddOffsetsToTxnResponse.java   |  9 +++
 .../requests/AddPartitionsToTxnResponse.java       |  9 +++
 .../kafka/common/requests/EndTxnResponse.java      |  8 +++
 .../kafka/common/requests/FetchResponse.java       |  7 +-
 .../common/requests/FindCoordinatorResponse.java   |  4 +-
 .../common/requests/InitProducerIdResponse.java    |  9 +++
 .../common/requests/TxnOffsetCommitResponse.java   |  8 +++
 .../transaction/TransactionCoordinator.scala       | 13 ++--
 core/src/main/scala/kafka/log/Log.scala            |  7 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 36 +++++++++--
 15 files changed, 157 insertions(+), 84 deletions(-)
0c3e466eb035859659ce41404f3b71b577467dca

 .../kafka/clients/consumer/internals/Fetcher.java  | 11 +++-
 .../producer/internals/ProducerIdAndEpoch.java     |  5 ++
 .../producer/internals/RecordAccumulator.java      |  6 +-
 .../kafka/clients/producer/internals/Sender.java   | 35 ++++------
 .../producer/internals/TransactionManager.java     | 74 ++++++++++------------
 .../common/requests/AddOffsetsToTxnResponse.java   |  9 +++
 .../requests/AddPartitionsToTxnResponse.java       |  9 +++
 .../kafka/common/requests/EndTxnResponse.java      |  8 +++
 .../kafka/common/requests/FetchResponse.java       |  7 +-
 .../common/requests/FindCoordinatorResponse.java   |  4 +-
 .../common/requests/InitProducerIdResponse.java    |  9 +++
 .../common/requests/TxnOffsetCommitResponse.java   |  8 +++
 .../transaction/TransactionCoordinator.scala       | 13 ++--
 core/src/main/scala/kafka/log/Log.scala            |  7 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 36 +++++++++--
 15 files changed, 157 insertions(+), 84 deletions(-)
0be4d1af0a94194e91541178854cbf7c1b6dd6cc

 docs/upgrade.html | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
4c8ec795a0c7091b70bc90add329076c5525dcbc

 docs/upgrade.html | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
c2c1a6aa367a37677fedb517437fa1422217abfc

 docs/streams.html | 31 +++++++++++++++++++++++++------
 docs/upgrade.html |  2 ++
 2 files changed, 27 insertions(+), 6 deletions(-)
1e350b860acd8e3fcc6ee296e9babbdfe4bcd365

 docs/streams.html | 31 +++++++++++++++++++++++++------
 docs/upgrade.html |  2 ++
 2 files changed, 27 insertions(+), 6 deletions(-)
1db85b1a2e4b218cd41c2398d0357f2b204ad1ae

 .../kafka/streams/processor/internals/StreamsKafkaClient.java     | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
6b9bc3fd26d0e565c1fe86ce46859f9c1a024987

 .../kafka/streams/processor/internals/StreamsKafkaClient.java     | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
e370714d9df0311bd931452c0bd384238d955cf3

 config/connect-log4j.properties | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
be392f95dee921377b903cff18f70c1e7845a879

 config/connect-log4j.properties | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
13a44fb1b39633d7575f8e685879e945ddbacdd4

 docs/upgrade.html | 6 ++++++
 1 file changed, 6 insertions(+)
adb4ea74ab55860e5a775151f317e923acac2ad4

 docs/upgrade.html | 6 ++++++
 1 file changed, 6 insertions(+)
a4a3e1e5d6bb75ad0abc555ba207ce48307edfa8

 .../apache/kafka/clients/consumer/internals/AbstractCoordinator.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0e36cf763b9796279c43f897756b8cebb9dabb61

 .../consumer/internals/AbstractCoordinator.java    |  5 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 74 +++++++++++++++++++++-
 2 files changed, 76 insertions(+), 3 deletions(-)
e4d829c47b9e143aa914cc492500d568d44836ef

 .../apache/kafka/clients/consumer/internals/AbstractCoordinator.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1b16acaaa181ceb214d84e70b8ddc146af9c0c5c

 .../consumer/internals/AbstractCoordinator.java    |  5 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 74 +++++++++++++++++++++-
 2 files changed, 76 insertions(+), 3 deletions(-)
97e7433f877ee455faf38ae59fb76dfc7e92786a

 .../apache/kafka/clients/CommonClientConfigs.java  | 27 +++++++
 .../kafka/clients/admin/AdminClientConfig.java     |  5 ++
 .../kafka/clients/consumer/ConsumerConfig.java     |  5 ++
 .../kafka/clients/producer/ProducerConfig.java     |  5 ++
 .../kafka/clients/CommonClientConfigsTest.java     | 85 ++++++++++++++++++++++
 .../apache/kafka/connect/runtime/WorkerConfig.java |  6 ++
 .../runtime/distributed/DistributedConfig.java     |  2 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |  5 +-
 8 files changed, 137 insertions(+), 3 deletions(-)
b3036c5861df2c5fc8a06ca5b817d43147f5ba92

 .../apache/kafka/clients/CommonClientConfigs.java  | 27 +++++++
 .../kafka/clients/admin/AdminClientConfig.java     |  5 ++
 .../kafka/clients/consumer/ConsumerConfig.java     |  5 ++
 .../kafka/clients/producer/ProducerConfig.java     |  5 ++
 .../kafka/clients/CommonClientConfigsTest.java     | 85 ++++++++++++++++++++++
 .../apache/kafka/connect/runtime/WorkerConfig.java |  6 ++
 .../runtime/distributed/DistributedConfig.java     |  2 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |  5 +-
 8 files changed, 137 insertions(+), 3 deletions(-)
d5c49d0e09db160e5603fe578ae2280236c8aeb1

 core/src/main/scala/kafka/serializer/Decoder.scala |  18 +
 .../streams/processor/internals/StreamTask.java    |  13 +-
 .../streams/processor/internals/StreamThread.java  |   2 +-
 .../streams/integration/EosIntegrationTest.java    | 782 +++++++++++++++++++++
 .../processor/internals/StreamTaskTest.java        |  11 +
 5 files changed, 823 insertions(+), 3 deletions(-)
39c1e6259c8ff547c3f7c5165b43c88f9f3ea158

 core/src/main/scala/kafka/serializer/Decoder.scala |  18 +
 .../streams/processor/internals/StreamTask.java    |  13 +-
 .../streams/processor/internals/StreamThread.java  |   2 +-
 .../streams/integration/EosIntegrationTest.java    | 782 +++++++++++++++++++++
 .../processor/internals/StreamTaskTest.java        |  11 +
 5 files changed, 823 insertions(+), 3 deletions(-)
e944956a35d30ba4e393be887f873f12106efe75

 .../kafka/clients/consumer/internals/Fetcher.java  |   4 +-
 .../kafka/common/record/AbstractRecords.java       |   4 +-
 .../apache/kafka/common/record/BufferSupplier.java |  95 +++++++
 .../apache/kafka/common/record/FileRecords.java    |  23 +-
 .../common/record/KafkaLZ4BlockInputStream.java    | 205 ++++++++-------
 .../org/apache/kafka/common/record/LogEntry.java   |   2 +-
 .../apache/kafka/common/record/MemoryRecords.java  |  19 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  22 +-
 .../org/apache/kafka/common/record/Records.java    |  18 +-
 .../kafka/common/record/RecordsIterator.java       |  51 ++--
 .../java/org/apache/kafka/common/utils/Utils.java  |  24 ++
 .../producer/internals/RecordAccumulatorTest.java  |   7 +-
 .../kafka/common/record/FileRecordsTest.java       |   2 +-
 .../apache/kafka/common/record/KafkaLZ4Test.java   | 286 ++++++++++++++++++---
 .../kafka/common/record/MemoryRecordsTest.java     |   6 +-
 core/src/main/scala/kafka/log/LogValidator.scala   |   2 +-
 .../scala/kafka/message/CompressionFactory.scala   |  19 +-
 .../kafka/message/MessageCompressionTest.scala     |   7 +-
 .../unit/kafka/message/MessageWriterTest.scala     |   2 +-
 19 files changed, 593 insertions(+), 205 deletions(-)
dc15062ea9c8f9db864e6114819966daa40f6a45

 .../producer/internals/TransactionManager.java     |   4 +-
 .../common/requests/OffsetCommitResponse.java      |   1 +
 .../common/requests/TxnOffsetCommitResponse.java   |   1 +
 ...TransactionMarkerRequestCompletionHandler.scala |   3 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  12 +-
 tests/kafkatest/services/console_consumer.py       |   9 +-
 .../services/transactional_message_copier.py       | 183 +++++++++++++
 tests/kafkatest/tests/core/transactions_test.py    | 207 +++++++++++++++
 tests/kafkatest/version.py                         |   5 +
 .../kafka/tools/TransactionalMessageCopier.java    | 287 +++++++++++++++++++++
 10 files changed, 706 insertions(+), 6 deletions(-)
1959835d9e148f0eb6407b36ff96b334d5e785cb

 .../producer/internals/TransactionManager.java     |   4 +-
 .../common/requests/OffsetCommitResponse.java      |   1 +
 .../common/requests/TxnOffsetCommitResponse.java   |   1 +
 ...TransactionMarkerRequestCompletionHandler.scala |   3 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  12 +-
 tests/kafkatest/services/console_consumer.py       |   9 +-
 .../services/transactional_message_copier.py       | 183 +++++++++++++
 tests/kafkatest/tests/core/transactions_test.py    | 207 +++++++++++++++
 tests/kafkatest/version.py                         |   5 +
 .../kafka/tools/TransactionalMessageCopier.java    | 287 +++++++++++++++++++++
 10 files changed, 706 insertions(+), 6 deletions(-)
b42cefe2f977ced5cd3c600a97f9672be5862373

 .../kafka/clients/producer/internals/Sender.java   |  2 +-
 .../kafka/common/record/AbstractRecords.java       | 22 +++++-
 .../apache/kafka/common/record/FileRecords.java    |  4 +-
 .../apache/kafka/common/record/MemoryRecords.java  |  4 +-
 .../org/apache/kafka/common/record/Records.java    |  4 +-
 .../kafka/common/record/FileRecordsTest.java       | 54 +++++++++----
 .../common/record/MemoryRecordsBuilderTest.java    | 43 +++++++++--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 29 ++++---
 .../scala/unit/kafka/server/FetchRequestTest.scala | 89 +++++++++++++++++++---
 9 files changed, 201 insertions(+), 50 deletions(-)
8e8b3c56572a825d3c1beb6ad77ce88571354f51

 .../kafka/clients/producer/internals/Sender.java   |  2 +-
 .../kafka/common/record/AbstractRecords.java       | 22 +++++-
 .../apache/kafka/common/record/FileRecords.java    |  4 +-
 .../apache/kafka/common/record/MemoryRecords.java  |  4 +-
 .../org/apache/kafka/common/record/Records.java    |  4 +-
 .../kafka/common/record/FileRecordsTest.java       | 54 +++++++++----
 .../common/record/MemoryRecordsBuilderTest.java    | 43 +++++++++--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 29 ++++---
 .../scala/unit/kafka/server/FetchRequestTest.scala | 89 +++++++++++++++++++---
 9 files changed, 201 insertions(+), 50 deletions(-)
64855109dcac76e923bca6e2c91af8e7e6df4fbf

 jenkins.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a0863464279d3175f7c97ea5b247fe0826b1579e

 jenkins.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
44e036702e5ffa346fcb493f601f07083aef7913

 .../integration/kafka/api/BaseQuotaTest.scala      | 38 ++++++++++++++++++----
 1 file changed, 31 insertions(+), 7 deletions(-)
640082776b429067613922c576a57ec716b1dbe9

 .../integration/kafka/api/BaseQuotaTest.scala      | 38 ++++++++++++++++++----
 1 file changed, 31 insertions(+), 7 deletions(-)
386a8d041c474b8ba66f3abd815338347f944b79

 .../common/record/ByteBufferOutputStream.java      | 125 +++++++++++++++------
 .../apache/kafka/common/record/MemoryRecords.java  |  58 ++++++++--
 .../kafka/common/record/MemoryRecordsBuilder.java  |  50 +++++----
 .../org/apache/kafka/common/record/Record.java     |   2 +-
 .../clients/consumer/internals/FetcherTest.java    |   3 +-
 .../common/record/ByteBufferOutputStreamTest.java  | 101 +++++++++++++++++
 .../kafka/common/record/MemoryRecordsTest.java     |  58 +++++++++-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  11 +-
 8 files changed, 334 insertions(+), 74 deletions(-)
13d189df6bd44b9ebaed87635db761b73d82869b

 .../kafka/connect/runtime/ConnectorFactory.java    |  99 -----------
 .../runtime/isolation/DelegatingClassLoader.java   |  76 +++++----
 .../runtime/isolation/PluginClassLoader.java       |  17 +-
 .../connect/runtime/isolation/PluginUtils.java     | 188 ++++++++++++++++++---
 .../connect/runtime/isolation/PluginUtilsTest.java |  10 +-
 5 files changed, 219 insertions(+), 171 deletions(-)
e0150a25e8127c282f54a0395eb2b1c80ebda94a

 .../kafka/connect/runtime/ConnectorFactory.java    |  99 -----------
 .../runtime/isolation/DelegatingClassLoader.java   |  76 +++++----
 .../runtime/isolation/PluginClassLoader.java       |  17 +-
 .../connect/runtime/isolation/PluginUtils.java     | 188 ++++++++++++++++++---
 .../connect/runtime/isolation/PluginUtilsTest.java |  10 +-
 5 files changed, 219 insertions(+), 171 deletions(-)
53589a6092daeddb2f7de0a6038ce633ecd0233b

 .../transaction/TransactionCoordinator.scala       | 11 ++++++++++
 .../transaction/TransactionMetadata.scala          |  7 ++++++
 .../transaction/TransactionStateManager.scala      | 25 +++++++++++++++++++---
 .../transaction/TransactionStateManagerTest.scala  | 10 ++++++++-
 4 files changed, 49 insertions(+), 4 deletions(-)
049abe7efa17c9660fce7b57b4c235e24c72315c

 .../transaction/TransactionCoordinator.scala       | 11 ++++++++++
 .../transaction/TransactionMetadata.scala          |  7 ++++++
 .../transaction/TransactionStateManager.scala      | 25 +++++++++++++++++++---
 .../transaction/TransactionStateManagerTest.scala  | 10 ++++++++-
 4 files changed, 49 insertions(+), 4 deletions(-)
3c3edc9dbaa5d22e0d5c466eb6015d7dea1e0c01

 .../clients/producer/internals/ProducerBatch.java  | 30 ++++++--
 .../producer/internals/RecordAccumulator.java      | 13 ++--
 .../kafka/clients/producer/internals/Sender.java   |  4 +-
 .../producer/internals/TransactionManager.java     |  9 +++
 .../apache/kafka/common/record/MemoryRecords.java  | 13 +---
 .../kafka/common/record/MemoryRecordsBuilder.java  |  7 +-
 .../producer/internals/ProducerBatchTest.java      | 43 ++++++++++-
 .../producer/internals/RecordAccumulatorTest.java  |  2 +-
 .../clients/producer/internals/SenderTest.java     | 85 +++++++++++++++++-----
 .../common/record/MemoryRecordsBuilderTest.java    |  9 +--
 10 files changed, 162 insertions(+), 53 deletions(-)
e4a6b50deca8fabc9880c6764334bfaa830a6d5e

 .../clients/producer/internals/ProducerBatch.java  | 30 ++++++--
 .../producer/internals/RecordAccumulator.java      | 13 ++--
 .../kafka/clients/producer/internals/Sender.java   |  4 +-
 .../producer/internals/TransactionManager.java     |  9 +++
 .../apache/kafka/common/record/MemoryRecords.java  | 13 +---
 .../kafka/common/record/MemoryRecordsBuilder.java  |  7 +-
 .../producer/internals/ProducerBatchTest.java      | 43 ++++++++++-
 .../producer/internals/RecordAccumulatorTest.java  |  2 +-
 .../clients/producer/internals/SenderTest.java     | 85 +++++++++++++++++-----
 .../common/record/MemoryRecordsBuilderTest.java    |  9 +--
 10 files changed, 162 insertions(+), 53 deletions(-)
458a9a4c5cff752b8abd453e36f6251a719d0910

 .../kafka/streams/processor/TopologyBuilder.java   |  4 +
 .../internals/StreamPartitionAssignor.java         | 33 ++++++--
 .../streams/processor/internals/StreamThread.java  |  1 -
 .../streams/processor/TopologyBuilderTest.java     |  6 +-
 .../internals/StreamPartitionAssignorTest.java     | 15 ++++
 .../processor/internals/StreamThreadTest.java      | 91 ++++++++++++++++++++++
 6 files changed, 140 insertions(+), 10 deletions(-)
6360e04e70b8f5ce562c2f24f85208aaae788363

 .../kafka/streams/processor/TopologyBuilder.java   |  4 +
 .../internals/StreamPartitionAssignor.java         | 33 ++++++--
 .../streams/processor/internals/StreamThread.java  |  1 -
 .../streams/processor/TopologyBuilderTest.java     |  6 +-
 .../internals/StreamPartitionAssignorTest.java     | 15 ++++
 .../processor/internals/StreamThreadTest.java      | 91 ++++++++++++++++++++++
 6 files changed, 140 insertions(+), 10 deletions(-)
5ae0adb2e6842d4ed9ad21e09438fcbf49ddaa93

 streams/src/main/java/org/apache/kafka/streams/KafkaStreams.java       | 2 +-
 streams/src/main/java/org/apache/kafka/streams/StreamsMetrics.java     | 2 +-
 .../java/org/apache/kafka/streams/errors/BrokerNotFoundException.java  | 2 --
 .../org/apache/kafka/streams/errors/InvalidStateStoreException.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/errors/LockException.java   | 2 --
 .../java/org/apache/kafka/streams/errors/ProcessorStateException.java  | 2 --
 .../main/java/org/apache/kafka/streams/errors/StreamsException.java    | 2 --
 .../java/org/apache/kafka/streams/errors/TaskIdFormatException.java    | 2 --
 .../java/org/apache/kafka/streams/errors/TopologyBuilderException.java | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Aggregator.java | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/ForeachAction.java  | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/GlobalKTable.java   | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/Initializer.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/JoinWindows.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/KGroupedStream.java | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/KGroupedTable.java  | 2 +-
 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java    | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/KStreamBuilder.java | 2 ++
 streams/src/main/java/org/apache/kafka/streams/kstream/KTable.java     | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/KeyValueMapper.java | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Merger.java     | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Predicate.java  | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Reducer.java    | 3 +--
 .../src/main/java/org/apache/kafka/streams/kstream/SessionWindows.java | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/TimeWindows.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/Transformer.java    | 2 --
 .../java/org/apache/kafka/streams/kstream/TransformerSupplier.java     | 2 --
 .../main/java/org/apache/kafka/streams/kstream/UnlimitedWindows.java   | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/ValueJoiner.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/ValueMapper.java    | 2 --
 .../main/java/org/apache/kafka/streams/kstream/ValueTransformer.java   | 2 --
 .../org/apache/kafka/streams/kstream/ValueTransformerSupplier.java     | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Window.java     | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Windowed.java   | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Windows.java    | 2 --
 .../apache/kafka/streams/processor/ExtractRecordMetadataTimestamp.java | 2 ++
 .../org/apache/kafka/streams/processor/FailOnInvalidTimestamp.java     | 2 ++
 .../apache/kafka/streams/processor/LogAndSkipOnInvalidTimestamp.java   | 2 ++
 .../src/main/java/org/apache/kafka/streams/processor/Processor.java    | 3 +++
 .../main/java/org/apache/kafka/streams/processor/ProcessorContext.java | 2 +-
 .../java/org/apache/kafka/streams/processor/StateRestoreCallback.java  | 3 +++
 .../java/org/apache/kafka/streams/processor/TimestampExtractor.java    | 2 ++
 .../main/java/org/apache/kafka/streams/processor/TopologyBuilder.java  | 2 ++
 .../kafka/streams/processor/UsePreviousTimeOnInvalidTimestamp.java     | 2 ++
 .../apache/kafka/streams/processor/WallclockTimestampExtractor.java    | 2 ++
 .../src/main/java/org/apache/kafka/streams/state/KeyValueStore.java    | 2 --
 .../main/java/org/apache/kafka/streams/state/QueryableStoreType.java   | 2 --
 .../java/org/apache/kafka/streams/state/ReadOnlyKeyValueStore.java     | 2 --
 .../main/java/org/apache/kafka/streams/state/ReadOnlySessionStore.java | 2 --
 .../main/java/org/apache/kafka/streams/state/ReadOnlyWindowStore.java  | 2 --
 streams/src/main/java/org/apache/kafka/streams/state/Stores.java       | 2 ++
 .../src/main/java/org/apache/kafka/streams/state/StreamsMetadata.java  | 2 ++
 streams/src/main/java/org/apache/kafka/streams/state/WindowStore.java  | 2 --
 53 files changed, 35 insertions(+), 74 deletions(-)
681c6fc1fb37c9cfec00df09fdfe5bf1b11f3b4b

 streams/src/main/java/org/apache/kafka/streams/KafkaStreams.java       | 2 +-
 streams/src/main/java/org/apache/kafka/streams/StreamsMetrics.java     | 2 +-
 .../java/org/apache/kafka/streams/errors/BrokerNotFoundException.java  | 2 --
 .../org/apache/kafka/streams/errors/InvalidStateStoreException.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/errors/LockException.java   | 2 --
 .../java/org/apache/kafka/streams/errors/ProcessorStateException.java  | 2 --
 .../main/java/org/apache/kafka/streams/errors/StreamsException.java    | 2 --
 .../java/org/apache/kafka/streams/errors/TaskIdFormatException.java    | 2 --
 .../java/org/apache/kafka/streams/errors/TopologyBuilderException.java | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Aggregator.java | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/ForeachAction.java  | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/GlobalKTable.java   | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/Initializer.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/JoinWindows.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/KGroupedStream.java | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/KGroupedTable.java  | 2 +-
 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java    | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/KStreamBuilder.java | 2 ++
 streams/src/main/java/org/apache/kafka/streams/kstream/KTable.java     | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/KeyValueMapper.java | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Merger.java     | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Predicate.java  | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Reducer.java    | 3 +--
 .../src/main/java/org/apache/kafka/streams/kstream/SessionWindows.java | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/TimeWindows.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/Transformer.java    | 2 --
 .../java/org/apache/kafka/streams/kstream/TransformerSupplier.java     | 2 --
 .../main/java/org/apache/kafka/streams/kstream/UnlimitedWindows.java   | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/ValueJoiner.java    | 2 --
 .../src/main/java/org/apache/kafka/streams/kstream/ValueMapper.java    | 2 --
 .../main/java/org/apache/kafka/streams/kstream/ValueTransformer.java   | 2 --
 .../org/apache/kafka/streams/kstream/ValueTransformerSupplier.java     | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Window.java     | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Windowed.java   | 2 --
 streams/src/main/java/org/apache/kafka/streams/kstream/Windows.java    | 2 --
 .../apache/kafka/streams/processor/ExtractRecordMetadataTimestamp.java | 2 ++
 .../org/apache/kafka/streams/processor/FailOnInvalidTimestamp.java     | 2 ++
 .../apache/kafka/streams/processor/LogAndSkipOnInvalidTimestamp.java   | 2 ++
 .../src/main/java/org/apache/kafka/streams/processor/Processor.java    | 3 +++
 .../main/java/org/apache/kafka/streams/processor/ProcessorContext.java | 2 +-
 .../java/org/apache/kafka/streams/processor/StateRestoreCallback.java  | 3 +++
 .../java/org/apache/kafka/streams/processor/TimestampExtractor.java    | 2 ++
 .../main/java/org/apache/kafka/streams/processor/TopologyBuilder.java  | 2 ++
 .../kafka/streams/processor/UsePreviousTimeOnInvalidTimestamp.java     | 2 ++
 .../apache/kafka/streams/processor/WallclockTimestampExtractor.java    | 2 ++
 .../src/main/java/org/apache/kafka/streams/state/KeyValueStore.java    | 2 --
 .../main/java/org/apache/kafka/streams/state/QueryableStoreType.java   | 2 --
 .../java/org/apache/kafka/streams/state/ReadOnlyKeyValueStore.java     | 2 --
 .../main/java/org/apache/kafka/streams/state/ReadOnlySessionStore.java | 2 --
 .../main/java/org/apache/kafka/streams/state/ReadOnlyWindowStore.java  | 2 --
 streams/src/main/java/org/apache/kafka/streams/state/Stores.java       | 2 ++
 .../src/main/java/org/apache/kafka/streams/state/StreamsMetadata.java  | 2 ++
 streams/src/main/java/org/apache/kafka/streams/state/WindowStore.java  | 2 --
 53 files changed, 35 insertions(+), 74 deletions(-)
016e3b1a50100445ec49055234abd0c56d39f9e8

 .../java/org/apache/kafka/clients/Metadata.java    | 22 ++++++------
 .../org/apache/kafka/clients/NetworkClient.java    |  3 +-
 .../apache/kafka/clients/admin/AdminClient.java    |  6 ----
 .../kafka/clients/admin/KafkaAdminClient.java      | 22 +++++++++---
 .../kafka/clients/consumer/KafkaConsumer.java      |  5 +--
 .../kafka/clients/producer/KafkaProducer.java      |  3 +-
 .../org/apache/kafka/common/protocol/Protocol.java | 32 +++++++++++------
 .../kafka/common/requests/MetadataRequest.java     | 39 ++++++++++++++------
 .../org/apache/kafka/clients/MetadataTest.java     | 12 +++----
 .../apache/kafka/clients/NetworkClientTest.java    |  8 ++---
 .../clients/admin/MockKafkaAdminClientEnv.java     |  2 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 36 ++++++++++---------
 .../internals/AbstractCoordinatorTest.java         |  2 +-
 .../internals/ConsumerCoordinatorTest.java         |  2 +-
 .../internals/ConsumerNetworkClientTest.java       |  2 +-
 .../clients/consumer/internals/FetcherTest.java    | 14 ++++----
 .../kafka/clients/producer/KafkaProducerTest.java  |  3 +-
 .../clients/producer/internals/SenderTest.java     |  2 +-
 .../producer/internals/TransactionManagerTest.java |  2 +-
 .../kafka/common/requests/RequestResponseTest.java |  6 +++-
 .../authenticator/SaslAuthenticatorTest.java       | 11 +++---
 .../runtime/distributed/WorkerGroupMember.java     |  2 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |  2 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |  4 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 10 +++---
 .../kafka/api/AuthorizerIntegrationTest.scala      | 10 +++---
 .../api/KafkaAdminClientIntegrationTest.scala      | 31 ++++++++++++----
 .../server/AbstractCreateTopicsRequestTest.scala   |  4 +--
 .../kafka/server/DeleteTopicsRequestTest.scala     |  2 +-
 .../unit/kafka/server/MetadataRequestTest.scala    | 42 ++++++++++++++++++----
 .../scala/unit/kafka/server/RequestQuotaTest.scala |  2 +-
 .../processor/internals/StreamsKafkaClient.java    |  8 +++--
 32 files changed, 226 insertions(+), 125 deletions(-)
7311dcbc5363d59dd0a0de86518dd12a7b259ca4

 .../java/org/apache/kafka/clients/Metadata.java    | 22 ++++++------
 .../org/apache/kafka/clients/NetworkClient.java    |  3 +-
 .../apache/kafka/clients/admin/AdminClient.java    |  6 ----
 .../kafka/clients/admin/KafkaAdminClient.java      | 22 +++++++++---
 .../kafka/clients/consumer/KafkaConsumer.java      |  5 +--
 .../kafka/clients/producer/KafkaProducer.java      |  3 +-
 .../org/apache/kafka/common/protocol/Protocol.java | 32 +++++++++++------
 .../kafka/common/requests/MetadataRequest.java     | 39 ++++++++++++++------
 .../org/apache/kafka/clients/MetadataTest.java     | 12 +++----
 .../apache/kafka/clients/NetworkClientTest.java    |  8 ++---
 .../clients/admin/MockKafkaAdminClientEnv.java     |  2 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 36 ++++++++++---------
 .../internals/AbstractCoordinatorTest.java         |  2 +-
 .../internals/ConsumerCoordinatorTest.java         |  2 +-
 .../internals/ConsumerNetworkClientTest.java       |  2 +-
 .../clients/consumer/internals/FetcherTest.java    | 14 ++++----
 .../kafka/clients/producer/KafkaProducerTest.java  |  3 +-
 .../clients/producer/internals/SenderTest.java     |  2 +-
 .../producer/internals/TransactionManagerTest.java |  2 +-
 .../kafka/common/requests/RequestResponseTest.java |  6 +++-
 .../authenticator/SaslAuthenticatorTest.java       | 11 +++---
 .../runtime/distributed/WorkerGroupMember.java     |  2 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |  2 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |  4 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 10 +++---
 .../kafka/api/AuthorizerIntegrationTest.scala      | 10 +++---
 .../api/KafkaAdminClientIntegrationTest.scala      | 31 ++++++++++++----
 .../server/AbstractCreateTopicsRequestTest.scala   |  4 +--
 .../kafka/server/DeleteTopicsRequestTest.scala     |  2 +-
 .../unit/kafka/server/MetadataRequestTest.scala    | 42 ++++++++++++++++++----
 .../scala/unit/kafka/server/RequestQuotaTest.scala |  2 +-
 .../processor/internals/StreamsKafkaClient.java    |  8 +++--
 32 files changed, 226 insertions(+), 125 deletions(-)
cad725a2f68dce0fbbfa6063cc9d2cd63bf49c7c

 .../kafka/common/record/DefaultRecordBatch.java    |  8 ++++-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  8 ++---
 .../kafka/common/record/MutableRecordBatch.java    |  8 +++--
 .../apache/kafka/common/record/RecordBatch.java    |  6 ++--
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 35 ++++++++++++++++------
 5 files changed, 45 insertions(+), 20 deletions(-)
647afeff6a2e3fd78328f6989e8d9f96bcde5121

 .../kafka/common/record/DefaultRecordBatch.java    |  8 ++++-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  8 ++---
 .../kafka/common/record/MutableRecordBatch.java    |  8 +++--
 .../apache/kafka/common/record/RecordBatch.java    |  6 ++--
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 35 ++++++++++++++++------
 5 files changed, 45 insertions(+), 20 deletions(-)
93308d101c5ae80ffcdaf04767beb4b2451db789

 core/src/test/scala/unit/kafka/controller/ControllerFailoverTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
eeb8f67810e2b02ee73eeb3a784e365b7b780f47

 core/src/test/scala/unit/kafka/controller/ControllerFailoverTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3bc1734362c6e28a3f35fbe04df087e0eb3f39ed

 checkstyle/suppressions.xml                        |   2 +-
 .../common/serialization/IntegerDeserializer.java  |   3 +-
 .../common/serialization/LongDeserializer.java     |   3 +-
 .../apache/kafka/common/serialization/Serdes.java  |  17 ++
 .../common/serialization/ShortDeserializer.java    |  47 ++++
 .../common/serialization/ShortSerializer.java      |  40 ++++
 .../common/serialization/SerializationTest.java    | 249 ++++++---------------
 7 files changed, 176 insertions(+), 185 deletions(-)
dc5bf4bd453495af050ea7c0ec7a66b8d2b2e8d4

 checkstyle/suppressions.xml                        |   2 +-
 .../common/serialization/IntegerDeserializer.java  |   3 +-
 .../common/serialization/LongDeserializer.java     |   3 +-
 .../apache/kafka/common/serialization/Serdes.java  |  17 ++
 .../common/serialization/ShortDeserializer.java    |  47 ++++
 .../common/serialization/ShortSerializer.java      |  40 ++++
 .../common/serialization/SerializationTest.java    | 249 ++++++---------------
 7 files changed, 176 insertions(+), 185 deletions(-)
f4c29613f7947df0a6545d1fc07d5fa0f4a966be

 docs/streams.html                                  |   6 +
 .../org/apache/kafka/streams/StreamsConfig.java    | 314 +++++++++++----------
 2 files changed, 167 insertions(+), 153 deletions(-)
d9479275fdacd172a2b545007b55e787c53fe54e

 docs/streams.html                                  |   6 +
 .../org/apache/kafka/streams/StreamsConfig.java    | 314 +++++++++++----------
 2 files changed, 167 insertions(+), 153 deletions(-)
1aad6b468dec2b51849e7906d793970595f7a997

 .../common/record/AbstractLegacyRecordBatch.java   |  73 +++++++
 .../kafka/common/record/DefaultRecordBatch.java    |  77 +++++++
 .../kafka/common/record/FileLogInputStream.java    | 216 +++++++-------------
 .../apache/kafka/common/record/FileRecords.java    |   4 +-
 .../apache/kafka/common/record/LegacyRecord.java   |  43 ++--
 .../apache/kafka/common/record/MemoryRecords.java  |  11 +-
 .../org/apache/kafka/common/record/Records.java    |   2 +
 .../clients/consumer/internals/FetcherTest.java    |   2 +-
 .../common/record/FileLogInputStreamTest.java      | 223 ++++++++++++++++++++-
 .../kafka/common/record/FileRecordsTest.java       |   6 +-
 .../common/record/MemoryRecordsBuilderTest.java    |   2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   4 +-
 .../scala/kafka/message/MessageAndOffset.scala     |  24 ++-
 13 files changed, 504 insertions(+), 183 deletions(-)
81f0c1e8f2ba2d86f061361b5ee33bb8e6f640c5

 .../common/record/AbstractLegacyRecordBatch.java   |  73 +++++++
 .../kafka/common/record/DefaultRecordBatch.java    |  77 +++++++
 .../kafka/common/record/FileLogInputStream.java    | 216 +++++++-------------
 .../apache/kafka/common/record/FileRecords.java    |   4 +-
 .../apache/kafka/common/record/LegacyRecord.java   |  43 ++--
 .../apache/kafka/common/record/MemoryRecords.java  |  11 +-
 .../org/apache/kafka/common/record/Records.java    |   2 +
 .../clients/consumer/internals/FetcherTest.java    |   2 +-
 .../common/record/FileLogInputStreamTest.java      | 223 ++++++++++++++++++++-
 .../kafka/common/record/FileRecordsTest.java       |   6 +-
 .../common/record/MemoryRecordsBuilderTest.java    |   2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   4 +-
 .../scala/kafka/message/MessageAndOffset.scala     |  24 ++-
 13 files changed, 504 insertions(+), 183 deletions(-)
1b64a4e634405b4c0e702edc45f184b846976429

 checkstyle/import-control.xml                      |  11 ++
 .../kafka/clients/admin/AccessControlEntry.java    |  86 -----------
 .../clients/admin/AccessControlEntryData.java      | 105 -------------
 .../clients/admin/AccessControlEntryFilter.java    | 117 ---------------
 .../org/apache/kafka/clients/admin/AclBinding.java |  74 ----------
 .../kafka/clients/admin/AclBindingFilter.java      |  89 -----------
 .../apache/kafka/clients/admin/AclOperation.java   | 137 -----------------
 .../kafka/clients/admin/AclPermissionType.java     |  92 ------------
 .../apache/kafka/clients/admin/AdminClient.java    |  80 +++++-----
 .../kafka/clients/admin/AlterConfigsResult.java    |  43 ++++++
 .../kafka/clients/admin/AlterConfigsResults.java   |  42 ------
 .../kafka/clients/admin/ApiVersionsResult.java     |  63 ++++++++
 .../kafka/clients/admin/ApiVersionsResults.java    |  63 --------
 .../apache/kafka/clients/admin/ConfigResource.java |  65 --------
 .../kafka/clients/admin/CreateAclsResult.java      |  49 +++++++
 .../kafka/clients/admin/CreateAclsResults.java     |  48 ------
 .../kafka/clients/admin/CreateTopicResults.java    |  49 -------
 .../kafka/clients/admin/CreateTopicsResult.java    |  49 +++++++
 .../kafka/clients/admin/DeleteAclsResult.java      | 109 ++++++++++++++
 .../kafka/clients/admin/DeleteAclsResults.java     | 107 --------------
 .../kafka/clients/admin/DeleteTopicResults.java    |  50 -------
 .../kafka/clients/admin/DeleteTopicsResult.java    |  50 +++++++
 .../kafka/clients/admin/DescribeAclsResult.java    |  38 +++++
 .../kafka/clients/admin/DescribeAclsResults.java   |  37 -----
 .../kafka/clients/admin/DescribeClusterResult.java |  65 ++++++++
 .../clients/admin/DescribeClusterResults.java      |  65 --------
 .../kafka/clients/admin/DescribeConfigsResult.java |  60 ++++++++
 .../clients/admin/DescribeConfigsResults.java      |  59 --------
 .../kafka/clients/admin/DescribeTopicsResult.java  |  68 +++++++++
 .../kafka/clients/admin/DescribeTopicsResults.java |  68 ---------
 .../kafka/clients/admin/KafkaAdminClient.java      |  52 ++++---
 .../kafka/clients/admin/ListTopicsResult.java      |  67 +++++++++
 .../kafka/clients/admin/ListTopicsResults.java     |  67 ---------
 .../org/apache/kafka/clients/admin/Resource.java   |  74 ----------
 .../apache/kafka/clients/admin/ResourceFilter.java |  90 ------------
 .../apache/kafka/clients/admin/ResourceType.java   | 102 -------------
 .../kafka/clients/admin/TopicDescription.java      |   1 +
 .../kafka/clients/admin/TopicPartitionInfo.java    |  58 --------
 .../apache/kafka/common/TopicPartitionInfo.java    |  57 +++++++
 .../kafka/common/acl/AccessControlEntry.java       |  86 +++++++++++
 .../kafka/common/acl/AccessControlEntryData.java   | 105 +++++++++++++
 .../kafka/common/acl/AccessControlEntryFilter.java | 117 +++++++++++++++
 .../org/apache/kafka/common/acl/AclBinding.java    |  77 ++++++++++
 .../apache/kafka/common/acl/AclBindingFilter.java  |  93 ++++++++++++
 .../org/apache/kafka/common/acl/AclOperation.java  | 137 +++++++++++++++++
 .../apache/kafka/common/acl/AclPermissionType.java |  92 ++++++++++++
 .../apache/kafka/common/config/ConfigResource.java |  65 ++++++++
 .../apache/kafka/common/config/TopicConfig.java    | 163 +++++++++++++++++++++
 .../kafka/common/requests/CreateAclsRequest.java   |   6 +-
 .../kafka/common/requests/DeleteAclsRequest.java   |   6 +-
 .../kafka/common/requests/DeleteAclsResponse.java  |   6 +-
 .../kafka/common/requests/DescribeAclsRequest.java |   8 +-
 .../common/requests/DescribeAclsResponse.java      |   6 +-
 .../apache/kafka/common/requests/RequestUtils.java |  14 +-
 .../org/apache/kafka/common/resource/Resource.java |  75 ++++++++++
 .../kafka/common/resource/ResourceFilter.java      |  91 ++++++++++++
 .../apache/kafka/common/resource/ResourceType.java | 102 +++++++++++++
 .../apache/kafka/clients/admin/AclBindingTest.java | 110 --------------
 .../kafka/clients/admin/AclOperationTest.java      |  89 -----------
 .../kafka/clients/admin/AclPermissionTypeTest.java |  80 ----------
 .../kafka/clients/admin/KafkaAdminClientTest.java  |  15 +-
 .../kafka/clients/admin/ResourceTypeTest.java      |  82 -----------
 .../apache/kafka/common/acl/AclBindingTest.java    | 113 ++++++++++++++
 .../apache/kafka/common/acl/AclOperationTest.java  |  89 +++++++++++
 .../kafka/common/acl/AclPermissionTypeTest.java    |  81 ++++++++++
 .../kafka/common/requests/RequestResponseTest.java |  18 +--
 .../kafka/common/resource/ResourceTypeTest.java    |  82 +++++++++++
 core/src/main/scala/kafka/log/LogConfig.scala      | 155 +++++++-------------
 .../main/scala/kafka/security/auth/Operation.scala |   2 +-
 .../scala/kafka/security/auth/PermissionType.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   3 +-
 .../api/KafkaAdminClientIntegrationTest.scala      |   4 +
 .../api/SaslSslAdminClientIntegrationTest.scala    |   4 +-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |   3 +-
 74 files changed, 2481 insertions(+), 2306 deletions(-)
da9a171c99eb456378bdda95a563d09dfd9af4d8

 checkstyle/import-control.xml                      |  11 ++
 .../kafka/clients/admin/AccessControlEntry.java    |  86 -----------
 .../clients/admin/AccessControlEntryData.java      | 105 -------------
 .../clients/admin/AccessControlEntryFilter.java    | 117 ---------------
 .../org/apache/kafka/clients/admin/AclBinding.java |  74 ----------
 .../kafka/clients/admin/AclBindingFilter.java      |  89 -----------
 .../apache/kafka/clients/admin/AclOperation.java   | 137 -----------------
 .../kafka/clients/admin/AclPermissionType.java     |  92 ------------
 .../apache/kafka/clients/admin/AdminClient.java    |  80 +++++-----
 .../kafka/clients/admin/AlterConfigsResult.java    |  43 ++++++
 .../kafka/clients/admin/AlterConfigsResults.java   |  42 ------
 .../kafka/clients/admin/ApiVersionsResult.java     |  63 ++++++++
 .../kafka/clients/admin/ApiVersionsResults.java    |  63 --------
 .../apache/kafka/clients/admin/ConfigResource.java |  65 --------
 .../kafka/clients/admin/CreateAclsResult.java      |  49 +++++++
 .../kafka/clients/admin/CreateAclsResults.java     |  48 ------
 .../kafka/clients/admin/CreateTopicResults.java    |  49 -------
 .../kafka/clients/admin/CreateTopicsResult.java    |  49 +++++++
 .../kafka/clients/admin/DeleteAclsResult.java      | 109 ++++++++++++++
 .../kafka/clients/admin/DeleteAclsResults.java     | 107 --------------
 .../kafka/clients/admin/DeleteTopicResults.java    |  50 -------
 .../kafka/clients/admin/DeleteTopicsResult.java    |  50 +++++++
 .../kafka/clients/admin/DescribeAclsResult.java    |  38 +++++
 .../kafka/clients/admin/DescribeAclsResults.java   |  37 -----
 .../kafka/clients/admin/DescribeClusterResult.java |  65 ++++++++
 .../clients/admin/DescribeClusterResults.java      |  65 --------
 .../kafka/clients/admin/DescribeConfigsResult.java |  60 ++++++++
 .../clients/admin/DescribeConfigsResults.java      |  59 --------
 .../kafka/clients/admin/DescribeTopicsResult.java  |  68 +++++++++
 .../kafka/clients/admin/DescribeTopicsResults.java |  68 ---------
 .../kafka/clients/admin/KafkaAdminClient.java      |  52 ++++---
 .../kafka/clients/admin/ListTopicsResult.java      |  67 +++++++++
 .../kafka/clients/admin/ListTopicsResults.java     |  67 ---------
 .../org/apache/kafka/clients/admin/Resource.java   |  74 ----------
 .../apache/kafka/clients/admin/ResourceFilter.java |  90 ------------
 .../apache/kafka/clients/admin/ResourceType.java   | 102 -------------
 .../kafka/clients/admin/TopicDescription.java      |   1 +
 .../kafka/clients/admin/TopicPartitionInfo.java    |  58 --------
 .../apache/kafka/common/TopicPartitionInfo.java    |  57 +++++++
 .../kafka/common/acl/AccessControlEntry.java       |  86 +++++++++++
 .../kafka/common/acl/AccessControlEntryData.java   | 105 +++++++++++++
 .../kafka/common/acl/AccessControlEntryFilter.java | 117 +++++++++++++++
 .../org/apache/kafka/common/acl/AclBinding.java    |  77 ++++++++++
 .../apache/kafka/common/acl/AclBindingFilter.java  |  93 ++++++++++++
 .../org/apache/kafka/common/acl/AclOperation.java  | 137 +++++++++++++++++
 .../apache/kafka/common/acl/AclPermissionType.java |  92 ++++++++++++
 .../apache/kafka/common/config/ConfigResource.java |  65 ++++++++
 .../apache/kafka/common/config/TopicConfig.java    | 163 +++++++++++++++++++++
 .../kafka/common/requests/CreateAclsRequest.java   |   6 +-
 .../kafka/common/requests/DeleteAclsRequest.java   |   6 +-
 .../kafka/common/requests/DeleteAclsResponse.java  |   6 +-
 .../kafka/common/requests/DescribeAclsRequest.java |   8 +-
 .../common/requests/DescribeAclsResponse.java      |   6 +-
 .../apache/kafka/common/requests/RequestUtils.java |  14 +-
 .../org/apache/kafka/common/resource/Resource.java |  75 ++++++++++
 .../kafka/common/resource/ResourceFilter.java      |  91 ++++++++++++
 .../apache/kafka/common/resource/ResourceType.java | 102 +++++++++++++
 .../apache/kafka/clients/admin/AclBindingTest.java | 110 --------------
 .../kafka/clients/admin/AclOperationTest.java      |  89 -----------
 .../kafka/clients/admin/AclPermissionTypeTest.java |  80 ----------
 .../kafka/clients/admin/KafkaAdminClientTest.java  |  15 +-
 .../kafka/clients/admin/ResourceTypeTest.java      |  82 -----------
 .../apache/kafka/common/acl/AclBindingTest.java    | 113 ++++++++++++++
 .../apache/kafka/common/acl/AclOperationTest.java  |  89 +++++++++++
 .../kafka/common/acl/AclPermissionTypeTest.java    |  81 ++++++++++
 .../kafka/common/requests/RequestResponseTest.java |  18 +--
 .../kafka/common/resource/ResourceTypeTest.java    |  82 +++++++++++
 core/src/main/scala/kafka/log/LogConfig.scala      | 155 +++++++-------------
 .../main/scala/kafka/security/auth/Operation.scala |   2 +-
 .../scala/kafka/security/auth/PermissionType.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   3 +-
 .../api/KafkaAdminClientIntegrationTest.scala      |   4 +
 .../api/SaslSslAdminClientIntegrationTest.scala    |   4 +-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |   3 +-
 74 files changed, 2481 insertions(+), 2306 deletions(-)
f925627e2798bfdd584d85a0f5d718c2306d90a8

 .../kafka/api/BaseProducerSendTest.scala           |  6 +-
 .../integration/kafka/api/ProducerBounceTest.scala |  2 +-
 .../kafka/api/ProducerCompressionTest.scala        | 88 ++++++++++------------
 .../scala/unit/kafka/producer/ProducerTest.scala   |  2 +-
 4 files changed, 44 insertions(+), 54 deletions(-)
9323a753355abcb62fe8121303e5e65dbfe018ea

 .../kafka/api/BaseProducerSendTest.scala           |  6 +-
 .../integration/kafka/api/ProducerBounceTest.scala |  2 +-
 .../kafka/api/ProducerCompressionTest.scala        | 88 ++++++++++------------
 .../scala/unit/kafka/producer/ProducerTest.scala   |  2 +-
 4 files changed, 44 insertions(+), 54 deletions(-)
ce6e638bd9d3fd0d3df18d4439a7dae7ec492c44

 .../kafka/clients/consumer/internals/Fetcher.java      | 10 ++++++++--
 .../kafka/clients/consumer/internals/FetcherTest.java  | 18 +++++++++++++++++-
 2 files changed, 25 insertions(+), 3 deletions(-)
aebba89a2b9b5ea6a7cab2599555232ef3fe21ad

 .../kafka/clients/consumer/internals/Fetcher.java      | 10 ++++++++--
 .../kafka/clients/consumer/internals/FetcherTest.java  | 18 +++++++++++++++++-
 2 files changed, 25 insertions(+), 3 deletions(-)
c63e9baeb99b7faeb8147e0c359106f507da2cde

 .../unit/kafka/controller/ControllerFailoverTest.scala      | 13 ++++++-------
 1 file changed, 6 insertions(+), 7 deletions(-)
31cc8885e4cfc35d97291b5d9eece6f3793f2538

 .../unit/kafka/controller/ControllerFailoverTest.scala      | 13 ++++++-------
 1 file changed, 6 insertions(+), 7 deletions(-)
08c80c6d4859a25be3c72f1dbefb4bf2734fcd17

 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 88 +++++++++++++---------
 .../kafka/admin/ResetConsumerGroupOffsetTest.scala | 33 ++++++--
 2 files changed, 80 insertions(+), 41 deletions(-)
ef9551297c815a0ac3065a65a0831863090714f0

 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 88 +++++++++++++---------
 .../kafka/admin/ResetConsumerGroupOffsetTest.scala | 33 ++++++--
 2 files changed, 80 insertions(+), 41 deletions(-)
85d2ce23c24619173cb5f2010e099ae3032ab865

 .../kafka/common/requests/ByteBufferChannel.java   |  71 +++++++++++
 .../kafka/common/requests/RequestResponseTest.java |  52 +-------
 ...TransactionMarkerRequestCompletionHandler.scala |   9 ++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  59 ++++++---
 ...sactionMarkerRequestCompletionHandlerTest.scala |   6 +
 .../scala/unit/kafka/server/KafkaApisTest.scala    | 142 ++++++++++++++++++++-
 6 files changed, 266 insertions(+), 73 deletions(-)
2cc8f48ae5358087381fa5f79233789499d6b939

 .../kafka/common/requests/ByteBufferChannel.java   |  71 +++++++++++
 .../kafka/common/requests/RequestResponseTest.java |  52 +-------
 ...TransactionMarkerRequestCompletionHandler.scala |   9 ++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  59 ++++++---
 ...sactionMarkerRequestCompletionHandlerTest.scala |   6 +
 .../scala/unit/kafka/server/KafkaApisTest.scala    | 142 ++++++++++++++++++++-
 6 files changed, 266 insertions(+), 73 deletions(-)
044158a5c9c7aa37f114e7b8ed5bb1a8bf71ddc8

 .../org/apache/kafka/streams/StreamsConfig.java    |   2 +-
 .../streams/state/internals/RocksDBStore.java      |   8 +-
 .../streams/state/internals/RocksDBStoreTest.java  | 103 +++++++++++++++++++++
 3 files changed, 111 insertions(+), 2 deletions(-)
dd8cdb79d356b3049c21bf00613b8144dff0882c

 .../org/apache/kafka/streams/StreamsConfig.java    |   2 +-
 .../streams/state/internals/RocksDBStore.java      |   8 +-
 .../streams/state/internals/RocksDBStoreTest.java  | 103 +++++++++++++++++++++
 3 files changed, 111 insertions(+), 2 deletions(-)
a1a48794548c546f45d55162f55928420fec0c8f

 .../kafka/clients/consumer/internals/Fetcher.java  |  84 ++++++--------
 .../clients/consumer/internals/FetcherTest.java    | 127 +++++++++++++++------
 2 files changed, 123 insertions(+), 88 deletions(-)
d082563907103ea79eed681305df7093053f52ec

 .../kafka/clients/consumer/internals/Fetcher.java  |  84 ++++++--------
 .../clients/consumer/internals/FetcherTest.java    | 127 +++++++++++++++------
 2 files changed, 123 insertions(+), 88 deletions(-)
651d9a5385c103aafd9f5d44ae016af7879f694f

 .../kafka/clients/producer/KafkaProducer.java      |   2 +-
 .../producer/internals/RecordAccumulator.java      |  19 +-
 .../kafka/clients/producer/internals/Sender.java   |  66 ++++---
 .../producer/internals/TransactionManager.java     |  62 +++---
 .../common/requests/AddOffsetsToTxnRequest.java    |   3 +-
 .../common/requests/AddPartitionsToTxnRequest.java |   7 +-
 .../kafka/common/requests/EndTxnRequest.java       |   3 +-
 .../apache/kafka/common/requests/FetchRequest.java |   7 +-
 .../common/requests/TxnOffsetCommitRequest.java    |   3 +-
 .../clients/producer/internals/SenderTest.java     |   2 +-
 .../producer/internals/TransactionManagerTest.java | 209 ++++++++++++++-------
 .../integration/kafka/api/TransactionsTest.scala   |   1 +
 12 files changed, 259 insertions(+), 125 deletions(-)
d41cf1b77819ede5716b31683d0137eb60cb7bfb

 .../kafka/clients/producer/KafkaProducer.java      |   2 +-
 .../producer/internals/RecordAccumulator.java      |  19 +-
 .../kafka/clients/producer/internals/Sender.java   |  66 ++++---
 .../producer/internals/TransactionManager.java     |  62 +++---
 .../common/requests/AddOffsetsToTxnRequest.java    |   3 +-
 .../common/requests/AddPartitionsToTxnRequest.java |   7 +-
 .../kafka/common/requests/EndTxnRequest.java       |   3 +-
 .../apache/kafka/common/requests/FetchRequest.java |   7 +-
 .../common/requests/TxnOffsetCommitRequest.java    |   3 +-
 .../clients/producer/internals/SenderTest.java     |   2 +-
 .../producer/internals/TransactionManagerTest.java | 209 ++++++++++++++-------
 .../integration/kafka/api/TransactionsTest.scala   |   1 +
 12 files changed, 259 insertions(+), 125 deletions(-)
d00e1bdebab6a7e999f0de9c53286a8a6d521a0d

 .../apache/kafka/clients/admin/AdminClient.java    |  29 ++-
 .../kafka/clients/admin/KafkaAdminClient.java      | 240 ++++++++++++++++-----
 .../clients/admin/MockKafkaAdminClientEnv.java     |   2 +-
 .../api/KafkaAdminClientIntegrationTest.scala      |  59 ++++-
 4 files changed, 273 insertions(+), 57 deletions(-)
3250cc767e8ef79d0160312a8b605535d3002851

 .../apache/kafka/clients/admin/AdminClient.java    |  29 ++-
 .../kafka/clients/admin/KafkaAdminClient.java      | 240 ++++++++++++++++-----
 .../clients/admin/MockKafkaAdminClientEnv.java     |   2 +-
 .../api/KafkaAdminClientIntegrationTest.scala      |  59 ++++-
 4 files changed, 273 insertions(+), 57 deletions(-)
931b7bef480925b24adcdd98f838efebeb816537

 checkstyle/import-control.xml                      |   1 +
 .../kafka/clients/consumer/internals/Fetcher.java  |   5 +-
 .../common/record/AbstractLegacyRecordBatch.java   |  58 +++--
 .../apache/kafka/common/record/BufferSupplier.java |  96 +++++++
 .../kafka/common/record/CompressionType.java       |  68 ++---
 .../apache/kafka/common/record/DefaultRecord.java  |   6 +-
 .../kafka/common/record/DefaultRecordBatch.java    |  17 +-
 .../kafka/common/record/FileLogInputStream.java    |   4 +-
 .../common/record/KafkaLZ4BlockInputStream.java    | 204 ++++++++-------
 .../common/record/KafkaLZ4BlockOutputStream.java   |   4 +-
 .../apache/kafka/common/record/RecordBatch.java    |   7 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  25 ++
 .../kafka/common/record/CompressionTypeTest.java   |   5 +-
 .../common/record/DefaultRecordBatchTest.java      |   2 +-
 .../apache/kafka/common/record/KafkaLZ4Test.java   | 279 ++++++++++++++++++---
 .../kafka/common/record/MemoryRecordsTest.java     |   2 +-
 gradle/findbugs-exclude.xml                        |   7 +-
 .../jmh/record/RecordBatchIterationBenchmark.java  | 145 +++++++++++
 18 files changed, 731 insertions(+), 204 deletions(-)
c060c482855bb9f51e19dde51911645413d85260

 checkstyle/import-control.xml                      |   1 +
 .../kafka/clients/consumer/internals/Fetcher.java  |   5 +-
 .../common/record/AbstractLegacyRecordBatch.java   |  58 +++--
 .../apache/kafka/common/record/BufferSupplier.java |  96 +++++++
 .../kafka/common/record/CompressionType.java       |  68 ++---
 .../apache/kafka/common/record/DefaultRecord.java  |   6 +-
 .../kafka/common/record/DefaultRecordBatch.java    |  17 +-
 .../kafka/common/record/FileLogInputStream.java    |   4 +-
 .../common/record/KafkaLZ4BlockInputStream.java    | 204 ++++++++-------
 .../common/record/KafkaLZ4BlockOutputStream.java   |   4 +-
 .../apache/kafka/common/record/RecordBatch.java    |   7 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  25 ++
 .../kafka/common/record/CompressionTypeTest.java   |   5 +-
 .../common/record/DefaultRecordBatchTest.java      |   2 +-
 .../apache/kafka/common/record/KafkaLZ4Test.java   | 279 ++++++++++++++++++---
 .../kafka/common/record/MemoryRecordsTest.java     |   2 +-
 gradle/findbugs-exclude.xml                        |   7 +-
 .../jmh/record/RecordBatchIterationBenchmark.java  | 145 +++++++++++
 18 files changed, 731 insertions(+), 204 deletions(-)
8acd77f15265214cb359586b94c8f1b3990e2c30

 .../controller/ControllerChannelManager.scala      |   4 +-
 .../scala/kafka/controller/KafkaController.scala   | 113 +++++++---------
 .../kafka/controller/PartitionStateMachine.scala   |   6 +-
 .../kafka/controller/ReplicaStateMachine.scala     |   4 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   3 +-
 .../controller/ControllerEventManagerTest.scala    |  15 +--
 .../kafka/controller/ControllerFailoverTest.scala  | 148 +++++----------------
 .../controller/ControllerIntegrationTest.scala     |   6 +-
 .../kafka/controller/ControllerTestUtils.scala     |  35 +++++
 10 files changed, 137 insertions(+), 199 deletions(-)
6021618f9dafa3478104575d307e7bcd2cb4cca9

 .../controller/ControllerChannelManager.scala      |   4 +-
 .../scala/kafka/controller/KafkaController.scala   | 113 +++++++---------
 .../kafka/controller/PartitionStateMachine.scala   |   6 +-
 .../kafka/controller/ReplicaStateMachine.scala     |   4 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   3 +-
 .../controller/ControllerEventManagerTest.scala    |  15 +--
 .../kafka/controller/ControllerFailoverTest.scala  | 148 +++++----------------
 .../controller/ControllerIntegrationTest.scala     |   6 +-
 .../kafka/controller/ControllerTestUtils.scala     |  35 +++++
 10 files changed, 137 insertions(+), 199 deletions(-)
81a657ec4f945151787bb2192780b932ef1f600c

 docs/ops.html | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)
b38b74bb77e6d12e4ea74b51216bdc15e47dbbce

 docs/ops.html | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)
d834e2aa9712461bf6a3c304ec2dee62217e3d19

 .../TransactionMarkerChannelManager.scala          |  90 ++++++++++---
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 .../main/scala/kafka/server/MetadataCache.scala    |  26 ++--
 .../main/scala/kafka/server/ReplicaManager.scala   |   1 -
 .../TransactionMarkerChannelManagerTest.scala      | 146 +++++++++++++--------
 5 files changed, 178 insertions(+), 87 deletions(-)
80223b14ee092e95d05b40b12631df2d6db7ef53

 .../TransactionMarkerChannelManager.scala          |  90 ++++++++++---
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 .../main/scala/kafka/server/MetadataCache.scala    |  26 ++--
 .../main/scala/kafka/server/ReplicaManager.scala   |   1 -
 .../TransactionMarkerChannelManagerTest.scala      | 146 +++++++++++++--------
 5 files changed, 178 insertions(+), 87 deletions(-)
1e963d04d91d4f9e1944b0669e350ceab9b340c3

 core/src/main/scala/kafka/Kafka.scala                                 | 2 +-
 core/src/main/scala/kafka/admin/AclCommand.scala                      | 2 +-
 core/src/main/scala/kafka/admin/BrokerApiVersionsCommand.scala        | 2 +-
 core/src/main/scala/kafka/admin/ConfigCommand.scala                   | 2 +-
 core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala            | 2 +-
 core/src/main/scala/kafka/admin/DeleteRecordsCommand.scala            | 2 +-
 .../scala/kafka/admin/PreferredReplicaLeaderElectionCommand.scala     | 2 +-
 core/src/main/scala/kafka/admin/ReassignPartitionsCommand.scala       | 2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala                    | 2 +-
 core/src/main/scala/kafka/admin/ZkSecurityMigrator.scala              | 2 +-
 core/src/main/scala/kafka/tools/ConsoleConsumer.scala                 | 2 +-
 core/src/main/scala/kafka/tools/ConsoleProducer.scala                 | 2 +-
 core/src/main/scala/kafka/tools/ConsumerOffsetChecker.scala           | 2 +-
 core/src/main/scala/kafka/tools/DumpLogSegments.scala                 | 2 +-
 core/src/main/scala/kafka/tools/ExportZkOffsets.scala                 | 2 +-
 core/src/main/scala/kafka/tools/GetOffsetShell.scala                  | 2 +-
 core/src/main/scala/kafka/tools/ImportZkOffsets.scala                 | 2 +-
 core/src/main/scala/kafka/tools/JmxTool.scala                         | 2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala                     | 2 +-
 core/src/main/scala/kafka/tools/PerfConfig.scala                      | 2 +-
 core/src/main/scala/kafka/tools/ReplayLogProducer.scala               | 2 +-
 core/src/main/scala/kafka/tools/ReplicaVerificationTool.scala         | 2 +-
 core/src/main/scala/kafka/tools/SimpleConsumerShell.scala             | 2 +-
 core/src/main/scala/kafka/tools/StateChangeLogMerger.scala            | 2 +-
 core/src/main/scala/kafka/tools/StreamsResetter.java                  | 3 ++-
 core/src/main/scala/kafka/tools/VerifyConsumerRebalance.scala         | 2 +-
 core/src/test/scala/kafka/tools/TestLogCleaning.scala                 | 2 +-
 core/src/test/scala/other/kafka/TestLinearWriteSpeed.scala            | 2 +-
 core/src/test/scala/other/kafka/TestOffsetManager.scala               | 2 +-
 core/src/test/scala/other/kafka/TestPurgatoryPerformance.scala        | 2 +-
 docs/security.html                                                    | 4 ++--
 .../org/apache/kafka/streams/integration/ResetIntegrationTest.java    | 4 ++--
 32 files changed, 35 insertions(+), 34 deletions(-)
f0745cd514a8af6ea22e1fddfef66f0e69ae8b1c

 core/src/main/scala/kafka/Kafka.scala                                 | 2 +-
 core/src/main/scala/kafka/admin/AclCommand.scala                      | 2 +-
 core/src/main/scala/kafka/admin/BrokerApiVersionsCommand.scala        | 2 +-
 core/src/main/scala/kafka/admin/ConfigCommand.scala                   | 2 +-
 core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala            | 2 +-
 core/src/main/scala/kafka/admin/DeleteRecordsCommand.scala            | 2 +-
 .../scala/kafka/admin/PreferredReplicaLeaderElectionCommand.scala     | 2 +-
 core/src/main/scala/kafka/admin/ReassignPartitionsCommand.scala       | 2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala                    | 2 +-
 core/src/main/scala/kafka/admin/ZkSecurityMigrator.scala              | 2 +-
 core/src/main/scala/kafka/tools/ConsoleConsumer.scala                 | 2 +-
 core/src/main/scala/kafka/tools/ConsoleProducer.scala                 | 2 +-
 core/src/main/scala/kafka/tools/ConsumerOffsetChecker.scala           | 2 +-
 core/src/main/scala/kafka/tools/DumpLogSegments.scala                 | 2 +-
 core/src/main/scala/kafka/tools/ExportZkOffsets.scala                 | 2 +-
 core/src/main/scala/kafka/tools/GetOffsetShell.scala                  | 2 +-
 core/src/main/scala/kafka/tools/ImportZkOffsets.scala                 | 2 +-
 core/src/main/scala/kafka/tools/JmxTool.scala                         | 2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala                     | 2 +-
 core/src/main/scala/kafka/tools/PerfConfig.scala                      | 2 +-
 core/src/main/scala/kafka/tools/ReplayLogProducer.scala               | 2 +-
 core/src/main/scala/kafka/tools/ReplicaVerificationTool.scala         | 2 +-
 core/src/main/scala/kafka/tools/SimpleConsumerShell.scala             | 2 +-
 core/src/main/scala/kafka/tools/StateChangeLogMerger.scala            | 2 +-
 core/src/main/scala/kafka/tools/StreamsResetter.java                  | 3 ++-
 core/src/main/scala/kafka/tools/VerifyConsumerRebalance.scala         | 2 +-
 core/src/test/scala/kafka/tools/TestLogCleaning.scala                 | 2 +-
 core/src/test/scala/other/kafka/TestLinearWriteSpeed.scala            | 2 +-
 core/src/test/scala/other/kafka/TestOffsetManager.scala               | 2 +-
 core/src/test/scala/other/kafka/TestPurgatoryPerformance.scala        | 2 +-
 docs/security.html                                                    | 4 ++--
 .../org/apache/kafka/streams/integration/ResetIntegrationTest.java    | 4 ++--
 32 files changed, 35 insertions(+), 34 deletions(-)
8b63fc81ddc193d90f6a0e0694f2735f7466969c

 .../producer/internals/RecordAccumulator.java      |  2 +-
 .../apache/kafka/common/record/DefaultRecord.java  | 19 -----
 .../apache/kafka/common/record/MemoryRecords.java  |  8 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  7 +-
 .../kafka/common/utils/ByteBufferOutputStream.java | 85 +++++++++++++++-------
 .../kafka/common/record/DefaultRecordTest.java     | 18 +++--
 .../common/utils/ByteBufferOutputStreamTest.java   |  1 +
 7 files changed, 77 insertions(+), 63 deletions(-)
b3788d8dcbeee7a20f562e878c187a75bac11ff0

 .../producer/internals/RecordAccumulator.java      |  2 +-
 .../apache/kafka/common/record/DefaultRecord.java  | 19 -----
 .../apache/kafka/common/record/MemoryRecords.java  |  8 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  7 +-
 .../kafka/common/utils/ByteBufferOutputStream.java | 85 +++++++++++++++-------
 .../kafka/common/record/DefaultRecordTest.java     | 18 +++--
 .../common/utils/ByteBufferOutputStreamTest.java   |  1 +
 7 files changed, 77 insertions(+), 63 deletions(-)
396f17a94a21f15d138354a1f5f1404b993f285c

 core/src/main/scala/kafka/server/KafkaConfig.scala       | 16 ++++------------
 .../test/scala/unit/kafka/server/KafkaConfigTest.scala   |  1 -
 docs/upgrade.html                                        |  2 --
 3 files changed, 4 insertions(+), 15 deletions(-)
6b03497915665bb4823073a5a34b03be709eb287

 core/src/main/scala/kafka/server/KafkaConfig.scala       | 16 ++++------------
 .../test/scala/unit/kafka/server/KafkaConfigTest.scala   |  1 -
 docs/upgrade.html                                        |  2 --
 3 files changed, 4 insertions(+), 15 deletions(-)
0521c65bcf89684df82873d219436226adda3e07

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)
6f5930d631a7d3fc090cb81e5eb9cd69580f142b

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)
9dd7db2f5fb4b6c14ce72d2e87eea917016bf02b

 .../producer/internals/TransactionManager.java     | 13 +++++
 .../producer/internals/TransactionManagerTest.java | 64 ++++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  1 -
 .../kafka/api/AuthorizerIntegrationTest.scala      | 25 ++++++++-
 4 files changed, 99 insertions(+), 4 deletions(-)
a8794d8a5d18bb4eaafceac1ef675243af945862

 .../producer/internals/TransactionManager.java     | 13 +++++
 .../producer/internals/TransactionManagerTest.java | 64 ++++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  1 -
 .../kafka/api/AuthorizerIntegrationTest.scala      | 25 ++++++++-
 4 files changed, 99 insertions(+), 4 deletions(-)
a1da4c5345ce0815104028699b751b90d0bbd104

 .../java/org/apache/kafka/streams/integration/ResetIntegrationTest.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
dc520d275adc715d56231fad771c66104e77ff3f

 .../java/org/apache/kafka/streams/integration/ResetIntegrationTest.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
569248f6fb7515609a2bace98d5dc35721f060f8

 checkstyle/checkstyle.xml                          |   2 +-
 .../clients/producer/internals/ProducerBatch.java  |  57 +++-------
 .../common/record/AbstractLegacyRecordBatch.java   |   6 +
 .../kafka/common/record/DefaultRecordBatch.java    |  14 +--
 .../kafka/common/record/FileLogInputStream.java    |   7 --
 .../apache/kafka/common/record/FileRecords.java    |  21 +---
 .../apache/kafka/common/record/MemoryRecords.java  | 110 ++++++++++++------
 .../kafka/common/record/MemoryRecordsBuilder.java  | 124 +++++++++++++--------
 .../kafka/common/record/MutableRecordBatch.java    |   9 ++
 .../kafka/common/utils/ByteBufferOutputStream.java |  45 +++++++-
 .../java/org/apache/kafka/clients/MockClient.java  |  15 ++-
 .../producer/internals/RecordAccumulatorTest.java  |   8 +-
 .../clients/producer/internals/SenderTest.java     |  61 ++++++----
 .../common/record/FileLogInputStreamTest.java      |   2 +-
 .../kafka/common/record/MemoryRecordsTest.java     |  70 ++++++++++--
 .../common/utils/ByteBufferOutputStreamTest.java   | 101 +++++++++++++++++
 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  11 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  14 +--
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   4 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  10 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   9 +-
 22 files changed, 490 insertions(+), 212 deletions(-)
dfa3c8a92dddd58cab95e12c72669f250bb99683

 checkstyle/checkstyle.xml                          |   2 +-
 .../clients/producer/internals/ProducerBatch.java  |  57 +++-------
 .../common/record/AbstractLegacyRecordBatch.java   |   6 +
 .../kafka/common/record/DefaultRecordBatch.java    |  14 +--
 .../kafka/common/record/FileLogInputStream.java    |   7 --
 .../apache/kafka/common/record/FileRecords.java    |  21 +---
 .../apache/kafka/common/record/MemoryRecords.java  | 110 ++++++++++++------
 .../kafka/common/record/MemoryRecordsBuilder.java  | 124 +++++++++++++--------
 .../kafka/common/record/MutableRecordBatch.java    |   9 ++
 .../kafka/common/utils/ByteBufferOutputStream.java |  45 +++++++-
 .../java/org/apache/kafka/clients/MockClient.java  |  15 ++-
 .../producer/internals/RecordAccumulatorTest.java  |   8 +-
 .../clients/producer/internals/SenderTest.java     |  61 ++++++----
 .../common/record/FileLogInputStreamTest.java      |   2 +-
 .../kafka/common/record/MemoryRecordsTest.java     |  70 ++++++++++--
 .../common/utils/ByteBufferOutputStreamTest.java   | 101 +++++++++++++++++
 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  11 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  14 +--
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   4 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  10 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   9 +-
 22 files changed, 490 insertions(+), 212 deletions(-)
b50387eb7c7be978081ecce7724f3058e679e4b8

 core/src/main/scala/kafka/security/auth/SimpleAclAuthorizer.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
d90899bb924ac27231c8b0fcc50467d100f02a71

 .../kafka/admin/ResetConsumerGroupOffsetTest.scala | 95 ++++++++++++----------
 .../controller/ControllerEventManagerTest.scala    |  3 +-
 2 files changed, 52 insertions(+), 46 deletions(-)
eb3aae7a058845852024fb0a551e1d2917ac121c

 .../kafka/admin/ResetConsumerGroupOffsetTest.scala | 95 ++++++++++++----------
 .../controller/ControllerEventManagerTest.scala    |  3 +-
 2 files changed, 52 insertions(+), 46 deletions(-)
8175890e68be43c1547ffdbde8305c982d522e29

 build.gradle                                       |   9 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   6 +-
 .../consumer/internals/ConsumerMetrics.java        |  51 ++++++++
 .../kafka/clients/consumer/internals/Fetcher.java  |  95 +++++---------
 .../consumer/internals/FetcherMetricsRegistry.java | 140 +++++++++++++++++++++
 .../apache/kafka/common/MetricNameTemplate.java    |  72 +++++++++++
 .../apache/kafka/common/metrics/JmxReporter.java   |   6 +-
 .../org/apache/kafka/common/metrics/Metrics.java   |  83 ++++++++++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   5 +-
 .../clients/consumer/internals/FetcherTest.java    |  28 +++--
 .../apache/kafka/common/metrics/MetricsTest.java   |  54 ++++++++
 .../apache/kafka/common/metrics/SampleMetrics.java |  31 +++++
 docs/ops.html                                      | 105 +---------------
 13 files changed, 498 insertions(+), 187 deletions(-)
0bc4f75eedf14af6d0b2e3e9be62a460b1049d0b

 build.gradle                                       |   9 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   6 +-
 .../consumer/internals/ConsumerMetrics.java        |  51 ++++++++
 .../kafka/clients/consumer/internals/Fetcher.java  |  95 +++++---------
 .../consumer/internals/FetcherMetricsRegistry.java | 140 +++++++++++++++++++++
 .../apache/kafka/common/MetricNameTemplate.java    |  72 +++++++++++
 .../apache/kafka/common/metrics/JmxReporter.java   |   6 +-
 .../org/apache/kafka/common/metrics/Metrics.java   |  83 ++++++++++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   5 +-
 .../clients/consumer/internals/FetcherTest.java    |  28 +++--
 .../apache/kafka/common/metrics/MetricsTest.java   |  54 ++++++++
 .../apache/kafka/common/metrics/SampleMetrics.java |  31 +++++
 docs/ops.html                                      | 105 +---------------
 13 files changed, 498 insertions(+), 187 deletions(-)
eb49a5288ab5943c1ce02da22ef34529b4e9d88b

 .../test/java/org/apache/kafka/streams/KafkaStreamsTest.java | 12 ++++++++++++
 1 file changed, 12 insertions(+)
ca8915d2efc225dbc0a4c138a2a34cf34d07e347

 .../test/java/org/apache/kafka/streams/KafkaStreamsTest.java | 12 ++++++++++++
 1 file changed, 12 insertions(+)
3066b2d8864e9aa88bca1633b49289664a31fc80

 .../errors/BrokerAuthorizationException.java       | 23 ----------------------
 .../org/apache/kafka/common/protocol/Errors.java   |  7 -------
 core/src/main/scala/kafka/admin/AclCommand.scala   | 10 ----------
 .../scala/kafka/security/auth/ResourceType.scala   |  7 +------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  9 +++------
 .../scala/unit/kafka/admin/AclCommandTest.scala    |  3 ---
 6 files changed, 4 insertions(+), 55 deletions(-)
68eed84f24a4771ccd805d8f39340eb7599df2ed

 .../errors/BrokerAuthorizationException.java       | 23 ----------------------
 .../org/apache/kafka/common/protocol/Errors.java   |  7 -------
 core/src/main/scala/kafka/admin/AclCommand.scala   | 10 ----------
 .../scala/kafka/security/auth/ResourceType.scala   |  7 +------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  9 +++------
 .../scala/unit/kafka/admin/AclCommandTest.scala    |  3 ---
 6 files changed, 4 insertions(+), 55 deletions(-)
0123320426341fe50d4124f0ef398d7f5aaee909

 .../org/apache/kafka/common/protocol/ApiKeys.java  |  71 +++++++------
 .../kafka/common/requests/ApiVersionsResponse.java |  18 ++--
 .../clients/consumer/internals/FetcherTest.java    |   2 +-
 .../clients/producer/internals/SenderTest.java     |   2 +-
 .../common/requests/ApiVersionsResponseTest.java   |  68 +++++++++++++
 .../transaction/TransactionStateManager.scala      |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |  14 ++-
 .../scala/unit/kafka/server/KafkaApisTest.scala    | 111 +++++++++++++++++++++
 8 files changed, 246 insertions(+), 41 deletions(-)
7892b4e6c7c32be09d78a8bbbeeaa823d3197aaa

 .../org/apache/kafka/common/protocol/ApiKeys.java  |  71 +++++++------
 .../kafka/common/requests/ApiVersionsResponse.java |  18 ++--
 .../clients/consumer/internals/FetcherTest.java    |   2 +-
 .../clients/producer/internals/SenderTest.java     |   2 +-
 .../common/requests/ApiVersionsResponseTest.java   |  68 +++++++++++++
 .../transaction/TransactionStateManager.scala      |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |  14 ++-
 .../scala/unit/kafka/server/KafkaApisTest.scala    | 111 +++++++++++++++++++++
 8 files changed, 246 insertions(+), 41 deletions(-)
1b15adde1d393e5d2bbfe75db46880ce9efcd1b2

 .../org/apache/kafka/streams/KafkaStreams.java     |   6 +-
 .../streams/processor/internals/StreamThread.java  |  59 ++++----
 .../internals/StreamThreadStateStoreProvider.java  |   4 +
 .../integration/QueryableStateIntegrationTest.java | 164 ++++++++++++++++-----
 .../processor/internals/StreamThreadTest.java      |   2 +-
 5 files changed, 166 insertions(+), 69 deletions(-)
faa1803aa35871e5e040a22b7fcec61a2be16e24

 .../org/apache/kafka/streams/KafkaStreams.java     |   6 +-
 .../streams/processor/internals/StreamThread.java  |  59 ++++----
 .../internals/StreamThreadStateStoreProvider.java  |   4 +
 .../integration/QueryableStateIntegrationTest.java | 164 ++++++++++++++++-----
 .../processor/internals/StreamThreadTest.java      |   2 +-
 5 files changed, 166 insertions(+), 69 deletions(-)
5dd2a49e63685069bab5fd21a6cc426553a5a1de

 .../kafka/clients/consumer/internals/Fetcher.java  |  4 +-
 .../common/record/AbstractLegacyRecordBatch.java   |  2 +-
 .../apache/kafka/common/record/DefaultRecord.java  |  4 +-
 .../kafka/common/record/DefaultRecordBatch.java    |  9 ++-
 .../apache/kafka/common/record/MemoryRecords.java  |  9 +--
 .../kafka/common/record/MemoryRecordsBuilder.java  |  4 +-
 .../org/apache/kafka/common/record/Record.java     |  2 +-
 .../apache/kafka/common/record/RecordBatch.java    | 24 +++---
 .../kafka/common/record/MemoryRecordsTest.java     | 64 ++++++++++++++-
 core/src/main/scala/kafka/log/Log.scala            |  5 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 92 ++++++++++++++++++----
 11 files changed, 178 insertions(+), 41 deletions(-)
37433638271718344498d695d5da08db12c24eed

 .../kafka/clients/consumer/internals/Fetcher.java  |  4 +-
 .../common/record/AbstractLegacyRecordBatch.java   |  2 +-
 .../apache/kafka/common/record/DefaultRecord.java  |  4 +-
 .../kafka/common/record/DefaultRecordBatch.java    |  9 ++-
 .../apache/kafka/common/record/MemoryRecords.java  |  9 +--
 .../kafka/common/record/MemoryRecordsBuilder.java  |  4 +-
 .../org/apache/kafka/common/record/Record.java     |  2 +-
 .../apache/kafka/common/record/RecordBatch.java    | 24 +++---
 .../kafka/common/record/MemoryRecordsTest.java     | 64 ++++++++++++++-
 core/src/main/scala/kafka/log/Log.scala            |  5 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 92 ++++++++++++++++++----
 11 files changed, 178 insertions(+), 41 deletions(-)
c62793eab35d166c33c018d931fa4a40024a2524

 .../producer/internals/TransactionManager.java     | 34 ++++++++++++----------
 .../internals/TransactionalRequestResult.java      |  2 +-
 2 files changed, 20 insertions(+), 16 deletions(-)
02c0c3b01730bdbff8a09d355c1b017715c7ce10

 .../producer/internals/TransactionManager.java     | 34 ++++++++++++----------
 .../internals/TransactionalRequestResult.java      |  2 +-
 2 files changed, 20 insertions(+), 16 deletions(-)
7dde914aa3ee3b78982187d5479bfc8b4e952667

 checkstyle/suppressions.xml                        |  2 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 40 +++++++++++++--
 .../kafka/clients/consumer/KafkaConsumer.java      |  4 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 26 +++++-----
 .../kafka/clients/producer/KafkaProducer.java      |  4 +-
 .../kafka/clients/producer/internals/Sender.java   | 25 +++++----
 .../kafka/common/requests/AbstractResponse.java    |  1 +
 .../common/requests/AddOffsetsToTxnResponse.java   |  1 -
 .../requests/AddPartitionsToTxnResponse.java       |  1 -
 .../common/requests/AlterConfigsResponse.java      |  2 -
 .../kafka/common/requests/ApiVersionsResponse.java |  1 -
 .../kafka/common/requests/CreateAclsResponse.java  |  5 +-
 .../common/requests/CreateTopicsResponse.java      |  1 -
 .../kafka/common/requests/DeleteAclsResponse.java  |  5 +-
 .../common/requests/DeleteRecordsResponse.java     |  1 -
 .../common/requests/DeleteTopicsResponse.java      |  1 -
 .../common/requests/DescribeAclsResponse.java      |  5 +-
 .../common/requests/DescribeConfigsResponse.java   |  2 -
 .../common/requests/DescribeGroupsResponse.java    |  1 -
 .../kafka/common/requests/EndTxnResponse.java      |  1 -
 .../kafka/common/requests/FetchResponse.java       |  1 -
 .../common/requests/FindCoordinatorResponse.java   |  1 -
 .../kafka/common/requests/HeartbeatResponse.java   |  1 -
 .../common/requests/InitProducerIdResponse.java    |  1 -
 .../kafka/common/requests/JoinGroupResponse.java   |  1 -
 .../kafka/common/requests/LeaveGroupResponse.java  |  1 -
 .../kafka/common/requests/ListGroupsResponse.java  |  1 -
 .../kafka/common/requests/ListOffsetResponse.java  |  1 -
 .../kafka/common/requests/MetadataResponse.java    |  1 -
 .../common/requests/OffsetCommitResponse.java      |  1 -
 .../kafka/common/requests/OffsetFetchResponse.java |  1 -
 .../kafka/common/requests/ProduceResponse.java     |  1 -
 .../kafka/common/requests/SyncGroupResponse.java   |  1 -
 .../common/requests/TxnOffsetCommitResponse.java   |  1 -
 .../clients/consumer/internals/FetcherTest.java    | 60 +++++++++++++++-------
 .../clients/producer/internals/SenderTest.java     | 45 +++++++++++++---
 36 files changed, 156 insertions(+), 92 deletions(-)
73ca0d215ead9574487744eb89f7ae677a9e13ea

 checkstyle/suppressions.xml                        |  2 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 40 +++++++++++++--
 .../kafka/clients/consumer/KafkaConsumer.java      |  4 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 26 +++++-----
 .../kafka/clients/producer/KafkaProducer.java      |  4 +-
 .../kafka/clients/producer/internals/Sender.java   | 25 +++++----
 .../kafka/common/requests/AbstractResponse.java    |  1 +
 .../common/requests/AddOffsetsToTxnResponse.java   |  1 -
 .../requests/AddPartitionsToTxnResponse.java       |  1 -
 .../common/requests/AlterConfigsResponse.java      |  2 -
 .../kafka/common/requests/ApiVersionsResponse.java |  1 -
 .../kafka/common/requests/CreateAclsResponse.java  |  5 +-
 .../common/requests/CreateTopicsResponse.java      |  1 -
 .../kafka/common/requests/DeleteAclsResponse.java  |  5 +-
 .../common/requests/DeleteRecordsResponse.java     |  1 -
 .../common/requests/DeleteTopicsResponse.java      |  1 -
 .../common/requests/DescribeAclsResponse.java      |  5 +-
 .../common/requests/DescribeConfigsResponse.java   |  2 -
 .../common/requests/DescribeGroupsResponse.java    |  1 -
 .../kafka/common/requests/EndTxnResponse.java      |  1 -
 .../kafka/common/requests/FetchResponse.java       |  1 -
 .../common/requests/FindCoordinatorResponse.java   |  1 -
 .../kafka/common/requests/HeartbeatResponse.java   |  1 -
 .../common/requests/InitProducerIdResponse.java    |  1 -
 .../kafka/common/requests/JoinGroupResponse.java   |  1 -
 .../kafka/common/requests/LeaveGroupResponse.java  |  1 -
 .../kafka/common/requests/ListGroupsResponse.java  |  1 -
 .../kafka/common/requests/ListOffsetResponse.java  |  1 -
 .../kafka/common/requests/MetadataResponse.java    |  1 -
 .../common/requests/OffsetCommitResponse.java      |  1 -
 .../kafka/common/requests/OffsetFetchResponse.java |  1 -
 .../kafka/common/requests/ProduceResponse.java     |  1 -
 .../kafka/common/requests/SyncGroupResponse.java   |  1 -
 .../common/requests/TxnOffsetCommitResponse.java   |  1 -
 .../clients/consumer/internals/FetcherTest.java    | 60 +++++++++++++++-------
 .../clients/producer/internals/SenderTest.java     | 45 +++++++++++++---
 36 files changed, 156 insertions(+), 92 deletions(-)
a7bd4b3aa0d7b01e9fcc5486fb8a90730ec68502

 .../transaction/TransactionCoordinator.scala       |  22 ++--
 .../transaction/TransactionMetadata.scala          |  16 ++-
 .../transaction/TransactionStateManager.scala      |  98 +++++++++++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  16 ++-
 .../transaction/TransactionCoordinatorTest.scala   |  11 +-
 .../transaction/TransactionStateManagerTest.scala  | 119 ++++++++++++++++++++-
 6 files changed, 252 insertions(+), 30 deletions(-)
20e2008785d46aa0500b02d8737380c50d66da3b

 .../transaction/TransactionCoordinator.scala       |  22 ++--
 .../transaction/TransactionMetadata.scala          |  16 ++-
 .../transaction/TransactionStateManager.scala      |  98 +++++++++++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  16 ++-
 .../transaction/TransactionCoordinatorTest.scala   |  11 +-
 .../transaction/TransactionStateManagerTest.scala  | 119 ++++++++++++++++++++-
 6 files changed, 252 insertions(+), 30 deletions(-)
c3f806d020e8b362ba1ae9e25eeb5ae155df0777

 .../kafka/clients/ClusterConnectionStates.java     | 12 +++++++
 .../java/org/apache/kafka/clients/KafkaClient.java |  5 +++
 .../org/apache/kafka/clients/NetworkClient.java    |  5 +++
 .../kafka/clients/consumer/KafkaConsumer.java      |  2 +-
 .../consumer/internals/ConsumerCoordinator.java    | 42 +++++++++++++++-------
 .../consumer/internals/ConsumerNetworkClient.java  | 10 +++---
 .../java/org/apache/kafka/clients/MockClient.java  |  5 +++
 .../internals/ConsumerCoordinatorTest.java         | 32 ++++++++---------
 8 files changed, 79 insertions(+), 34 deletions(-)
64fc1a7cae348fad10e84c5ebc457c2a391573ee

 .../kafka/clients/ClusterConnectionStates.java     | 12 +++++++
 .../java/org/apache/kafka/clients/KafkaClient.java |  5 +++
 .../org/apache/kafka/clients/NetworkClient.java    |  5 +++
 .../kafka/clients/consumer/KafkaConsumer.java      |  2 +-
 .../consumer/internals/ConsumerCoordinator.java    | 42 +++++++++++++++-------
 .../consumer/internals/ConsumerNetworkClient.java  | 10 +++---
 .../java/org/apache/kafka/clients/MockClient.java  |  5 +++
 .../internals/ConsumerCoordinatorTest.java         | 32 ++++++++---------
 8 files changed, 79 insertions(+), 34 deletions(-)
22288e8053e16d31be6e0e4449daa09cbe5102c1

 .../test/java/org/apache/kafka/clients/admin/KafkaAdminClientTest.java   | 1 -
 1 file changed, 1 deletion(-)
a10990f44b1a4f8345eae7ebfc9c571bfd0447c3

 .../test/java/org/apache/kafka/clients/admin/KafkaAdminClientTest.java   | 1 -
 1 file changed, 1 deletion(-)
6ed7288fdbdab2766eddf06229db7809f726e260

 .../kafka/clients/consumer/ConsumerRecord.java     | 23 +++++--
 .../kafka/clients/consumer/internals/Fetcher.java  |  2 +-
 .../kafka/clients/producer/KafkaProducer.java      |  4 +-
 .../kafka/clients/producer/MockProducer.java       |  7 +-
 .../kafka/clients/producer/RecordMetadata.java     | 43 +++++++-----
 .../producer/internals/FutureRecordMetadata.java   | 10 +--
 .../clients/producer/internals/ProducerBatch.java  |  4 +-
 .../producer/internals/ProducerInterceptors.java   |  6 +-
 .../common/header/internals/RecordHeaders.java     |  6 +-
 .../common/record/AbstractLegacyRecordBatch.java   |  5 ++
 .../apache/kafka/common/record/DefaultRecord.java  | 67 +++++++-----------
 .../kafka/common/record/DefaultRecordBatch.java    |  3 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  | 71 ++++++++++---------
 .../org/apache/kafka/common/record/Record.java     |  5 +-
 .../kafka/clients/consumer/ConsumerRecordTest.java | 12 ++++
 .../kafka/clients/producer/RecordMetadataTest.java | 79 ++++++++++++++++++++++
 .../kafka/clients/producer/RecordSendTest.java     |  6 +-
 .../producer/internals/ProducerBatchTest.java      | 29 ++++++++
 .../internals/ProducerInterceptorsTest.java        |  2 +-
 .../producer/internals/RecordAccumulatorTest.java  |  8 +--
 .../common/record/MemoryRecordsBuilderTest.java    | 16 +++++
 .../apache/kafka/test/MockConsumerInterceptor.java |  3 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  6 +-
 docs/upgrade.html                                  |  2 +-
 24 files changed, 285 insertions(+), 134 deletions(-)
a89200a585593cebb4a3a1af0c2af9892babcd5b

 docs/upgrade.html | 5 +++++
 1 file changed, 5 insertions(+)
cea319a4ad9c55d3d3263cf7a4224c25772d0e11

 .../kafka/clients/consumer/ConsumerRecord.java     | 23 +++++--
 .../kafka/clients/consumer/internals/Fetcher.java  |  2 +-
 .../kafka/clients/producer/KafkaProducer.java      |  4 +-
 .../kafka/clients/producer/MockProducer.java       |  7 +-
 .../kafka/clients/producer/RecordMetadata.java     | 43 +++++++-----
 .../producer/internals/FutureRecordMetadata.java   | 10 +--
 .../clients/producer/internals/ProducerBatch.java  |  4 +-
 .../producer/internals/ProducerInterceptors.java   |  6 +-
 .../common/header/internals/RecordHeaders.java     |  6 +-
 .../common/record/AbstractLegacyRecordBatch.java   |  5 ++
 .../apache/kafka/common/record/DefaultRecord.java  | 67 +++++++-----------
 .../kafka/common/record/DefaultRecordBatch.java    |  3 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  | 71 ++++++++++---------
 .../org/apache/kafka/common/record/Record.java     |  5 +-
 .../kafka/clients/consumer/ConsumerRecordTest.java | 12 ++++
 .../kafka/clients/producer/RecordMetadataTest.java | 79 ++++++++++++++++++++++
 .../kafka/clients/producer/RecordSendTest.java     |  6 +-
 .../producer/internals/ProducerBatchTest.java      | 29 ++++++++
 .../internals/ProducerInterceptorsTest.java        |  2 +-
 .../producer/internals/RecordAccumulatorTest.java  |  8 +--
 .../common/record/MemoryRecordsBuilderTest.java    | 16 +++++
 .../apache/kafka/test/MockConsumerInterceptor.java |  3 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  6 +-
 docs/upgrade.html                                  |  2 +-
 24 files changed, 285 insertions(+), 134 deletions(-)
8dfc098ee5c5024a580dab50281e19fec2dd6cbf

 .../kafka/coordinator/group/GroupCoordinator.scala |  25 +--
 .../kafka/coordinator/group/GroupMetadata.scala    |   2 +-
 .../coordinator/group/GroupMetadataManager.scala   |  39 ++--
 .../transaction/TransactionStateManager.scala      |   2 +-
 .../main/scala/kafka/server/DelayedProduce.scala   |  28 +--
 .../main/scala/kafka/server/ReplicaManager.scala   |  10 +-
 .../coordinator/group/GroupCoordinatorTest.scala   |   7 +-
 .../group/GroupMetadataManagerTest.scala           | 222 ++++++++++++++++-----
 8 files changed, 218 insertions(+), 117 deletions(-)
fdcee8b8b3c027cdc1b13031fa19fcfc7de5609f

 .../kafka/coordinator/group/GroupCoordinator.scala |  25 +--
 .../kafka/coordinator/group/GroupMetadata.scala    |   2 +-
 .../coordinator/group/GroupMetadataManager.scala   |  39 ++--
 .../transaction/TransactionStateManager.scala      |   2 +-
 .../main/scala/kafka/server/DelayedProduce.scala   |  28 +--
 .../main/scala/kafka/server/ReplicaManager.scala   |  10 +-
 .../coordinator/group/GroupCoordinatorTest.scala   |   7 +-
 .../group/GroupMetadataManagerTest.scala           | 222 ++++++++++++++++-----
 8 files changed, 218 insertions(+), 117 deletions(-)
a8dbce47f5a39ebc0fb21b7e0ef43f837b252313

 .../kafka/streams/kstream/KStreamBuilder.java      | 39 +++++++++++++++++++++-
 1 file changed, 38 insertions(+), 1 deletion(-)
c5d44af77473abb36cb9bf7ca3dead36490b8320

 .../kafka/streams/kstream/KStreamBuilder.java      | 39 +++++++++++++++++++++-
 1 file changed, 38 insertions(+), 1 deletion(-)
9a21bf20b623b790c9910813e373d2d61fe84c2c

 .../org/apache/kafka/clients/ClientResponse.java   |    7 +-
 .../apache/kafka/clients/admin/AclOperation.java   |    7 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |    2 +-
 .../kafka/clients/producer/KafkaProducer.java      |   35 +-
 .../kafka/clients/producer/internals/Sender.java   |  169 +--
 .../producer/internals/TransactionManager.java     |  268 ++--
 .../errors/ProducerIdAuthorizationException.java   |   23 -
 .../TransactionalIdAuthorizationException.java     |    2 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   13 +-
 .../org/apache/kafka/common/protocol/Protocol.java |    3 +
 .../common/requests/AddOffsetsToTxnRequest.java    |   11 +
 .../common/requests/AddOffsetsToTxnResponse.java   |    5 +-
 .../common/requests/AddPartitionsToTxnRequest.java |   11 +
 .../requests/AddPartitionsToTxnResponse.java       |    3 +-
 .../kafka/common/requests/EndTxnRequest.java       |   11 +
 .../kafka/common/requests/EndTxnResponse.java      |    3 +-
 .../common/requests/InitProducerIdResponse.java    |   12 +-
 .../kafka/common/requests/ProduceRequest.java      |    5 +-
 .../kafka/common/requests/ProduceResponse.java     |    3 +
 .../common/requests/TxnOffsetCommitRequest.java    |   31 +-
 .../common/requests/TxnOffsetCommitResponse.java   |    1 +
 .../common/requests/WriteTxnMarkersResponse.java   |    1 +
 .../kafka/clients/admin/AclOperationTest.java      |    3 +-
 .../clients/producer/internals/SenderTest.java     |  183 +--
 .../producer/internals/TransactionManagerTest.java |  445 ++++--
 .../kafka/common/requests/RequestResponseTest.java |   10 +-
 core/src/main/scala/kafka/admin/AclCommand.scala   |   54 +-
 .../kafka/coordinator/group/GroupMetadata.scala    |   43 +-
 .../coordinator/group/GroupMetadataManager.scala   |    5 +-
 .../kafka/coordinator/group/MemberMetadata.scala   |   14 +-
 .../main/scala/kafka/security/auth/Operation.scala |    6 +-
 .../main/scala/kafka/security/auth/Resource.scala  |    3 +-
 .../scala/kafka/security/auth/ResourceType.scala   |   16 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  316 +++--
 .../kafka/api/AuthorizerIntegrationTest.scala      |  292 +++-
 .../kafka/api/TransactionsBounceTest.scala         |   31 +-
 .../integration/kafka/api/TransactionsTest.scala   |    7 +-
 .../scala/unit/kafka/admin/AclCommandTest.scala    |   36 +-
 .../group/GroupCoordinatorResponseTest.scala       | 1492 --------------------
 .../coordinator/group/GroupCoordinatorTest.scala   | 1492 ++++++++++++++++++++
 .../coordinator/group/GroupMetadataTest.scala      |    2 +-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |    9 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   10 +-
 43 files changed, 2771 insertions(+), 2324 deletions(-)
38f6cae9e879baa35c5dbc5829bf09ecd59930c2

 .../org/apache/kafka/clients/ClientResponse.java   |    7 +-
 .../apache/kafka/clients/admin/AclOperation.java   |    7 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |    2 +-
 .../kafka/clients/producer/KafkaProducer.java      |   35 +-
 .../kafka/clients/producer/internals/Sender.java   |  169 +--
 .../producer/internals/TransactionManager.java     |  268 ++--
 .../errors/ProducerIdAuthorizationException.java   |   23 -
 .../TransactionalIdAuthorizationException.java     |    2 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   13 +-
 .../org/apache/kafka/common/protocol/Protocol.java |    3 +
 .../common/requests/AddOffsetsToTxnRequest.java    |   11 +
 .../common/requests/AddOffsetsToTxnResponse.java   |    5 +-
 .../common/requests/AddPartitionsToTxnRequest.java |   11 +
 .../requests/AddPartitionsToTxnResponse.java       |    3 +-
 .../kafka/common/requests/EndTxnRequest.java       |   11 +
 .../kafka/common/requests/EndTxnResponse.java      |    3 +-
 .../common/requests/InitProducerIdResponse.java    |   12 +-
 .../kafka/common/requests/ProduceRequest.java      |    5 +-
 .../kafka/common/requests/ProduceResponse.java     |    3 +
 .../common/requests/TxnOffsetCommitRequest.java    |   31 +-
 .../common/requests/TxnOffsetCommitResponse.java   |    1 +
 .../common/requests/WriteTxnMarkersResponse.java   |    1 +
 .../kafka/clients/admin/AclOperationTest.java      |    3 +-
 .../clients/producer/internals/SenderTest.java     |  183 +--
 .../producer/internals/TransactionManagerTest.java |  445 ++++--
 .../kafka/common/requests/RequestResponseTest.java |   10 +-
 core/src/main/scala/kafka/admin/AclCommand.scala   |   54 +-
 .../kafka/coordinator/group/GroupMetadata.scala    |   43 +-
 .../coordinator/group/GroupMetadataManager.scala   |    5 +-
 .../kafka/coordinator/group/MemberMetadata.scala   |   14 +-
 .../main/scala/kafka/security/auth/Operation.scala |    6 +-
 .../main/scala/kafka/security/auth/Resource.scala  |    3 +-
 .../scala/kafka/security/auth/ResourceType.scala   |   16 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  316 +++--
 .../kafka/api/AuthorizerIntegrationTest.scala      |  292 +++-
 .../kafka/api/TransactionsBounceTest.scala         |   31 +-
 .../integration/kafka/api/TransactionsTest.scala   |    7 +-
 .../scala/unit/kafka/admin/AclCommandTest.scala    |   36 +-
 .../group/GroupCoordinatorResponseTest.scala       | 1492 --------------------
 .../coordinator/group/GroupCoordinatorTest.scala   | 1492 ++++++++++++++++++++
 .../coordinator/group/GroupMetadataTest.scala      |    2 +-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |    9 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   10 +-
 43 files changed, 2771 insertions(+), 2324 deletions(-)
7cb57dc99bc775b8a195b5ba507cb2a31a00f553

 checkstyle/checkstyle.xml                          |   2 +-
 .../producer/internals/FutureRecordMetadata.java   |  34 +++-
 .../clients/producer/internals/ProducerBatch.java  | 142 +++++++++++++-
 .../producer/internals/RecordAccumulator.java      |  37 +++-
 .../kafka/clients/producer/internals/Sender.java   |  29 ++-
 .../kafka/common/record/AbstractRecords.java       |   4 +
 .../common/record/CompressionRatioEstimator.java   | 111 +++++++++++
 .../kafka/common/record/CompressionType.java       |   6 +-
 .../apache/kafka/common/record/DefaultRecord.java  |   8 +-
 .../kafka/common/record/DefaultRecordBatch.java    |   8 +
 .../kafka/common/record/MemoryRecordsBuilder.java  |  78 +++++---
 .../producer/internals/RecordAccumulatorTest.java  | 203 ++++++++++++++++++++-
 .../clients/producer/internals/SenderTest.java     |  90 +++++++++
 .../common/record/MemoryRecordsBuilderTest.java    |   9 +-
 14 files changed, 701 insertions(+), 60 deletions(-)
308c7e47c3b8c4fa2835534b9d28dd9c2e2dc1a3

 core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
88200938f0c3ace5ec0bdb65a315ebd9b6adb4d0

 core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
23de4f4cdda23181fe0b925dd9feb2444dc06e3a

 .../apache/kafka/clients/consumer/KafkaConsumer.java   | 18 +++---------------
 .../kafka/clients/consumer/OffsetAndMetadata.java      | 14 ++++++++++----
 .../kafka/clients/consumer/KafkaConsumerTest.java      | 10 ++++++++--
 .../integration/kafka/api/TransactionsBounceTest.scala |  5 ++---
 .../scala/integration/kafka/api/TransactionsTest.scala |  8 +++-----
 core/src/test/scala/unit/kafka/utils/TestUtils.scala   | 10 ++++++++++
 6 files changed, 36 insertions(+), 29 deletions(-)
4d89db968257c0c3273ece7e5546cb95ddcbeb46

 .../apache/kafka/clients/consumer/KafkaConsumer.java   | 18 +++---------------
 .../kafka/clients/consumer/OffsetAndMetadata.java      | 14 ++++++++++----
 .../kafka/clients/consumer/KafkaConsumerTest.java      | 10 ++++++++--
 .../integration/kafka/api/TransactionsBounceTest.scala |  5 ++---
 .../scala/integration/kafka/api/TransactionsTest.scala |  8 +++-----
 core/src/test/scala/unit/kafka/utils/TestUtils.scala   | 10 ++++++++++
 6 files changed, 36 insertions(+), 29 deletions(-)
44294a8941145fec2d973fd448ccbf97c86f0dd4

 build.gradle | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
90dc2d16fbed59fc65e6e190380c8b9c43b6d95a

 build.gradle | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
999c247e076cbf7e84141533c5a9042a844d57ae

 core/src/main/scala/kafka/cluster/Partition.scala  |   3 +-
 .../controller/ControllerChannelManager.scala      |  37 +-
 .../kafka/controller/ControllerEventManager.scala  |  65 +++
 .../scala/kafka/controller/ControllerState.scala   |  83 ++++
 .../scala/kafka/controller/KafkaController.scala   | 456 +++++++++++----------
 .../kafka/controller/PartitionLeaderSelector.scala |   2 +-
 .../kafka/controller/TopicDeletionManager.scala    |   7 +-
 core/src/main/scala/kafka/metrics/KafkaTimer.scala |   8 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   5 +-
 .../controller/ControllerEventManagerTest.scala    |  94 +++++
 .../controller/ControllerIntegrationTest.scala     |  20 +-
 .../MetricsDuringTopicCreationDeletionTest.scala   |  10 +-
 12 files changed, 549 insertions(+), 241 deletions(-)
516d8457d8142111a91af94cab918c84990685da

 core/src/main/scala/kafka/cluster/Partition.scala  |   3 +-
 .../controller/ControllerChannelManager.scala      |  37 +-
 .../kafka/controller/ControllerEventManager.scala  |  65 +++
 .../scala/kafka/controller/ControllerState.scala   |  83 ++++
 .../scala/kafka/controller/KafkaController.scala   | 456 +++++++++++----------
 .../kafka/controller/PartitionLeaderSelector.scala |   2 +-
 .../kafka/controller/TopicDeletionManager.scala    |   7 +-
 core/src/main/scala/kafka/metrics/KafkaTimer.scala |   8 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   5 +-
 .../controller/ControllerEventManagerTest.scala    |  94 +++++
 .../controller/ControllerIntegrationTest.scala     |  20 +-
 .../MetricsDuringTopicCreationDeletionTest.scala   |  10 +-
 12 files changed, 549 insertions(+), 241 deletions(-)
69970630ba91de4a48b83a9101c487cd4eff3b46

 .../scala/kafka/controller/KafkaController.scala   | 23 +++++++++++++++-------
 1 file changed, 16 insertions(+), 7 deletions(-)
beeddc25d6b443ed344658a2562a162fb03048ef

 .../scala/kafka/controller/KafkaController.scala   | 23 +++++++++++++++-------
 1 file changed, 16 insertions(+), 7 deletions(-)
e6600a36816718c90f896ab89bda6650de60ad78

 .../coordinator/group/GroupMetadataManager.scala   |   8 +-
 .../transaction/TransactionCoordinator.scala       | 133 +++++-----
 .../TransactionMarkerChannelManager.scala          |  38 ++-
 ...TransactionMarkerRequestCompletionHandler.scala |  41 ++-
 .../transaction/TransactionMetadata.scala          |   2 +-
 .../transaction/TransactionStateManager.scala      | 187 +++++++------
 .../main/scala/kafka/server/DelayedOperation.scala |  14 +-
 .../main/scala/kafka/server/DelayedProduce.scala   |  16 ++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  12 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  14 +-
 .../group/GroupCoordinatorResponseTest.scala       |  14 +-
 .../group/GroupMetadataManagerTest.scala           |   4 +-
 .../transaction/TransactionCoordinatorTest.scala   | 292 +++++++--------------
 .../TransactionMarkerChannelManagerTest.scala      |   9 +-
 ...sactionMarkerRequestCompletionHandlerTest.scala |  24 +-
 .../transaction/TransactionStateManagerTest.scala  | 105 +++++---
 16 files changed, 455 insertions(+), 458 deletions(-)
1bf64833168e81015e1f30a30c64eb6849c15422

 .../coordinator/group/GroupMetadataManager.scala   |   8 +-
 .../transaction/TransactionCoordinator.scala       | 133 +++++-----
 .../TransactionMarkerChannelManager.scala          |  38 ++-
 ...TransactionMarkerRequestCompletionHandler.scala |  41 ++-
 .../transaction/TransactionMetadata.scala          |   2 +-
 .../transaction/TransactionStateManager.scala      | 187 +++++++------
 .../main/scala/kafka/server/DelayedOperation.scala |  14 +-
 .../main/scala/kafka/server/DelayedProduce.scala   |  16 ++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  12 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  14 +-
 .../group/GroupCoordinatorResponseTest.scala       |  14 +-
 .../group/GroupMetadataManagerTest.scala           |   4 +-
 .../transaction/TransactionCoordinatorTest.scala   | 292 +++++++--------------
 .../TransactionMarkerChannelManagerTest.scala      |   9 +-
 ...sactionMarkerRequestCompletionHandlerTest.scala |  24 +-
 .../transaction/TransactionStateManagerTest.scala  | 105 +++++---
 16 files changed, 455 insertions(+), 458 deletions(-)
49a2482c22ca75516038ce961b5d053e9d2def56

 .../streams/integration/FanoutIntegrationTest.java |   4 +-
 .../integration/GlobalKTableIntegrationTest.java   |   3 +-
 .../integration/InternalTopicIntegrationTest.java  |   3 +-
 .../streams/integration/JoinIntegrationTest.java   |  41 +------
 .../KStreamAggregationIntegrationTest.java         |   3 +-
 .../KStreamKTableJoinIntegrationTest.java          |   4 +-
 ...StreamsFineGrainedAutoResetIntegrationTest.java |  47 ++++----
 .../KTableKTableJoinIntegrationTest.java           |   5 +-
 .../integration/QueryableStateIntegrationTest.java |   7 +-
 .../integration/RegexSourceIntegrationTest.java    |  23 ++--
 .../streams/integration/ResetIntegrationTest.java  |  77 +-------------
 .../integration/utils/EmbeddedKafkaCluster.java    | 118 ++++++++++++++++++++-
 12 files changed, 163 insertions(+), 172 deletions(-)
49587750570a2aaf332eb73f5aad373196f984ce

 .../streams/integration/FanoutIntegrationTest.java |   4 +-
 .../integration/GlobalKTableIntegrationTest.java   |   3 +-
 .../integration/InternalTopicIntegrationTest.java  |   3 +-
 .../streams/integration/JoinIntegrationTest.java   |  41 +------
 .../KStreamAggregationIntegrationTest.java         |   3 +-
 .../KStreamKTableJoinIntegrationTest.java          |   4 +-
 ...StreamsFineGrainedAutoResetIntegrationTest.java |  47 ++++----
 .../KTableKTableJoinIntegrationTest.java           |   5 +-
 .../integration/QueryableStateIntegrationTest.java |   7 +-
 .../integration/RegexSourceIntegrationTest.java    |  23 ++--
 .../streams/integration/ResetIntegrationTest.java  |  77 +-------------
 .../integration/utils/EmbeddedKafkaCluster.java    | 118 ++++++++++++++++++++-
 12 files changed, 163 insertions(+), 172 deletions(-)
fdbf2e5f7ad99b25feff2122cbcf4c51697250e3

 .../producer/internals/TransactionManager.java     |   4 +-
 .../transaction/TransactionCoordinator.scala       |  22 +--
 .../coordinator/transaction/TransactionLog.scala   |  41 +++---
 .../TransactionMarkerChannelManager.scala          |   5 +-
 .../transaction/TransactionMetadata.scala          | 160 ++++++++++++---------
 .../transaction/TransactionStateManager.scala      |  41 +++---
 .../transaction/TransactionCoordinatorTest.scala   | 119 +++++++++------
 .../transaction/TransactionLogTest.scala           |  42 +++---
 .../TransactionMarkerChannelManagerTest.scala      |  15 +-
 ...sactionMarkerRequestCompletionHandlerTest.scala |   3 +-
 .../transaction/TransactionStateManagerTest.scala  | 133 ++++++++---------
 11 files changed, 306 insertions(+), 279 deletions(-)
70ec4b1d927cad7373eda2c54ef44bfc4275832f

 .../producer/internals/TransactionManager.java     |   4 +-
 .../transaction/TransactionCoordinator.scala       |  22 +--
 .../coordinator/transaction/TransactionLog.scala   |  41 +++---
 .../TransactionMarkerChannelManager.scala          |   5 +-
 .../transaction/TransactionMetadata.scala          | 160 ++++++++++++---------
 .../transaction/TransactionStateManager.scala      |  41 +++---
 .../transaction/TransactionCoordinatorTest.scala   | 119 +++++++++------
 .../transaction/TransactionLogTest.scala           |  42 +++---
 .../TransactionMarkerChannelManagerTest.scala      |  15 +-
 ...sactionMarkerRequestCompletionHandlerTest.scala |   3 +-
 .../transaction/TransactionStateManagerTest.scala  | 133 ++++++++---------
 11 files changed, 306 insertions(+), 279 deletions(-)
9e0581df513f2953bb7a899f784410bc99407465

 .../TransactionCoordinatorIntegrationTest.scala    | 102 ---------------------
 1 file changed, 102 deletions(-)
5a6676bfca9f56c467ff46aefffc6f344ff4bf65

 .../TransactionCoordinatorIntegrationTest.scala    | 102 ---------------------
 1 file changed, 102 deletions(-)
2b326faf5f5a2bc632b842c26d2f48a07fa8a15e

 .../kafka/coordinator/group/GroupMetadata.scala    |  96 ++++++++++++++----
 .../coordinator/group/GroupMetadataManager.scala   |  50 +++++-----
 .../group/GroupMetadataManagerTest.scala           | 102 ++++++++++++++++++-
 .../coordinator/group/GroupMetadataTest.scala      | 109 ++++++++++++++++++++-
 4 files changed, 310 insertions(+), 47 deletions(-)
d1853f791147d66303c2700a8e58af762518188c

 .../kafka/coordinator/group/GroupMetadata.scala    |  96 ++++++++++++++----
 .../coordinator/group/GroupMetadataManager.scala   |  50 +++++-----
 .../group/GroupMetadataManagerTest.scala           | 102 ++++++++++++++++++-
 .../coordinator/group/GroupMetadataTest.scala      | 109 ++++++++++++++++++++-
 4 files changed, 310 insertions(+), 47 deletions(-)
33216846fe070dfb5dd09eab9f53490bae92c357

 .../apache/kafka/common/record/MemoryRecords.java  |  6 +++
 .../kafka/common/requests/ProduceResponse.java     |  1 +
 core/src/main/scala/kafka/log/LogValidator.scala   | 40 +++++++++++---------
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 44 +++++++++++++++++++++-
 4 files changed, 72 insertions(+), 19 deletions(-)
e3e2f1d22d17a20ccccf67218c600e7e1647e1ca

 .../apache/kafka/common/record/MemoryRecords.java  |  6 +++
 .../kafka/common/requests/ProduceResponse.java     |  1 +
 core/src/main/scala/kafka/log/LogValidator.scala   | 40 +++++++++++---------
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 44 +++++++++++++++++++++-
 4 files changed, 72 insertions(+), 19 deletions(-)
931b592ee81370a30d951f3f4d0e1873033f8850

 vagrant/base.sh | 4 ++++
 1 file changed, 4 insertions(+)
fa538c7418c7a06a1598fc784cd14b2562ce93d2

 vagrant/base.sh | 4 ++++
 1 file changed, 4 insertions(+)
8b306ca2ae234b7c9391672b755ba6b58dab84a0

 vagrant/base.sh | 4 ++++
 1 file changed, 4 insertions(+)
9ae4deaa5724220569b0af312500130079b7fdb0

 vagrant/base.sh | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
cca9ad42434265e388ec0100e0080250120e2cf9

 vagrant/base.sh | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
a9c9dbf58f0e9ccf873e100b62f0f811ad5e4659

 core/src/main/scala/kafka/log/Log.scala          | 50 ++++++++++++++++--------
 core/src/test/scala/unit/kafka/log/LogTest.scala | 27 +++++++++++++
 2 files changed, 60 insertions(+), 17 deletions(-)
fcdbb71953fc4c92559a9c7adb4cb8ad4a74acd6

 core/src/main/scala/kafka/log/Log.scala          | 50 ++++++++++++++++--------
 core/src/test/scala/unit/kafka/log/LogTest.scala | 27 +++++++++++++
 2 files changed, 60 insertions(+), 17 deletions(-)
67f691bbd93b06efe58f2ba28f1b85efedf99651

 .../kafka/clients/consumer/RangeAssignor.java      |   8 +-
 .../kafka/clients/consumer/RoundRobinAssignor.java |  10 +-
 .../kafka/clients/consumer/StickyAssignor.java     | 153 ++++++++-------
 .../internals/AbstractPartitionAssignor.java       |  18 +-
 .../kafka/clients/consumer/RangeAssignorTest.java  |  90 ++++-----
 .../clients/consumer/RoundRobinAssignorTest.java   |  88 ++++-----
 .../kafka/clients/consumer/StickyAssignorTest.java | 216 +++++++++++++--------
 .../consumer/internals/MockPartitionAssignor.java  |   2 +-
 8 files changed, 307 insertions(+), 278 deletions(-)
65861a712ddf67eb071a00218730926fdeef7084

 .../kafka/clients/consumer/RangeAssignor.java      |   8 +-
 .../kafka/clients/consumer/RoundRobinAssignor.java |  10 +-
 .../kafka/clients/consumer/StickyAssignor.java     | 153 ++++++++-------
 .../internals/AbstractPartitionAssignor.java       |  18 +-
 .../kafka/clients/consumer/RangeAssignorTest.java  |  90 ++++-----
 .../clients/consumer/RoundRobinAssignorTest.java   |  88 ++++-----
 .../kafka/clients/consumer/StickyAssignorTest.java | 216 +++++++++++++--------
 .../consumer/internals/MockPartitionAssignor.java  |   2 +-
 8 files changed, 307 insertions(+), 278 deletions(-)
4c29b1544bb058a004c57c3e559c7458810df2b4

 core/src/main/scala/kafka/consumer/ConsumerFetcherThread.scala | 3 ++-
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala   | 4 ++--
 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala    | 3 +++
 3 files changed, 7 insertions(+), 3 deletions(-)
c2ced5fb51f2a4ec94d158e18836afb7284d26ce

 core/src/main/scala/kafka/consumer/ConsumerFetcherThread.scala | 3 ++-
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala   | 4 ++--
 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala    | 3 +++
 3 files changed, 7 insertions(+), 3 deletions(-)
e08e76b7166f5690cafdc8d5e52cd81746408a37

 core/src/main/scala/kafka/server/KafkaApis.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
ceb10c53302bd4824737e03ab86ca19e2aa64c7a

 core/src/main/scala/kafka/server/KafkaApis.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
ef88ee5045ea791d3208c3dcbc8723c4b2092262

 .../java/org/apache/kafka/common/security/plain/PlainSaslServer.java     | 1 +
 1 file changed, 1 insertion(+)
d3f1407f7bc95b823516e5a1bdaa23c717b6354e

 .../java/org/apache/kafka/common/security/plain/PlainSaslServer.java     | 1 +
 1 file changed, 1 insertion(+)
6d04e412cffabb1976aa935b4fb4767fd255836e

 checkstyle/checkstyle.xml                          |  2 +-
 .../org/apache/kafka/streams/KafkaStreams.java     |  4 +-
 .../processor/internals/StreamsKafkaClient.java    | 19 ++++++-
 .../streams/tests/BrokerCompatibilityTest.java     | 21 +++++---
 tests/kafkatest/services/streams.py                |  4 +-
 .../streams/streams_broker_compatibility_test.py   | 59 ++++++++++++++--------
 tests/kafkatest/version.py                         |  7 ++-
 vagrant/base.sh                                    |  2 +
 8 files changed, 86 insertions(+), 32 deletions(-)
495836a4a27c2219f72a5f3776ba8e5216493b41

 checkstyle/checkstyle.xml                          |  2 +-
 .../org/apache/kafka/streams/KafkaStreams.java     |  4 +-
 .../processor/internals/StreamsKafkaClient.java    | 19 ++++++-
 .../streams/tests/BrokerCompatibilityTest.java     | 21 +++++---
 tests/kafkatest/services/streams.py                |  4 +-
 .../streams/streams_broker_compatibility_test.py   | 59 ++++++++++++++--------
 tests/kafkatest/version.py                         |  7 ++-
 vagrant/base.sh                                    |  2 +
 8 files changed, 86 insertions(+), 32 deletions(-)
c0e789bdcc039a177f99bfecf36191f5be566d63

 tests/kafkatest/sanity_checks/test_kafka_version.py       |  6 +++---
 tests/kafkatest/sanity_checks/test_verifiable_producer.py | 12 +++++++++---
 tests/kafkatest/utils/util.py                             |  8 ++++++--
 3 files changed, 18 insertions(+), 8 deletions(-)
dc10b0ea014974b450f2abcd4a58e09d5b988e9e

 tests/kafkatest/sanity_checks/test_kafka_version.py       |  6 +++---
 tests/kafkatest/sanity_checks/test_verifiable_producer.py | 12 +++++++++---
 tests/kafkatest/utils/util.py                             |  8 ++++++--
 3 files changed, 18 insertions(+), 8 deletions(-)
a144c5277dd95d8862ea6d9a497e5a087aa491fe

 .../kafkatest/tests/connect/connect_distributed_test.py  | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)
d190d89dbc3df90e00f5e3c55507f67c5818504e

 .../kafkatest/tests/connect/connect_distributed_test.py  | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)
7fad45557e4cb7b345f34cec32f910b437c59bc2

 checkstyle/checkstyle.xml                          |   2 +-
 .../producer/internals/FutureRecordMetadata.java   |  34 +++-
 .../clients/producer/internals/ProducerBatch.java  | 142 +++++++++++++-
 .../producer/internals/RecordAccumulator.java      |  37 +++-
 .../kafka/clients/producer/internals/Sender.java   |  29 ++-
 .../kafka/common/record/AbstractRecords.java       |   4 +
 .../common/record/CompressionRatioEstimator.java   | 111 +++++++++++
 .../kafka/common/record/CompressionType.java       |   6 +-
 .../apache/kafka/common/record/DefaultRecord.java  |   8 +-
 .../kafka/common/record/DefaultRecordBatch.java    |   8 +
 .../kafka/common/record/MemoryRecordsBuilder.java  |  78 +++++---
 .../producer/internals/RecordAccumulatorTest.java  | 203 ++++++++++++++++++++-
 .../clients/producer/internals/SenderTest.java     |  90 +++++++++
 .../common/record/MemoryRecordsBuilderTest.java    |   9 +-
 14 files changed, 701 insertions(+), 60 deletions(-)
1c7fdd2843482beab4039fbb487a8d7d53800292

 docs/upgrade.html | 5 +++++
 1 file changed, 5 insertions(+)
55330cc2931cc05cb1172cc207ada60154a6250a

 .../kafka/clients/producer/KafkaProducer.java      |   3 +-
 .../producer/internals/TransactionManager.java     |  10 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   3 +-
 .../producer/internals/TransactionManagerTest.java | 154 +++++++++++++++++----
 .../kafka/api/TransactionsBounceTest.scala         |   4 +-
 5 files changed, 140 insertions(+), 34 deletions(-)
8b04d8ba071fbcafc72a17d4cbfe6f00613e59b3

 .../kafka/clients/producer/KafkaProducer.java      |   3 +-
 .../producer/internals/TransactionManager.java     |  10 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   3 +-
 .../producer/internals/TransactionManagerTest.java | 154 +++++++++++++++++----
 .../kafka/api/TransactionsBounceTest.scala         |   4 +-
 5 files changed, 140 insertions(+), 34 deletions(-)
037f63882df854c923bb9de11856318b951ecb32

 core/src/main/scala/kafka/tools/StreamsResetter.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
338857e1c2c2bb0c6011fcab477818102b95cb56

 core/src/main/scala/kafka/tools/StreamsResetter.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
64e12d3c641baeb6a4a624b971ba33721d656054

 .../kafka/connect/tools/TransformationDoc.java     |   4 +-
 .../connect/transforms/TimestampConverter.java     | 452 +++++++++++++++++++++
 .../connect/transforms/util/Requirements.java      |   2 +-
 .../connect/transforms/TimestampConverterTest.java | 370 +++++++++++++++++
 4 files changed, 826 insertions(+), 2 deletions(-)
61bab2d875ab5e03d0df4f62217346549a4c64c3

 .../kafka/connect/tools/TransformationDoc.java     |   4 +-
 .../connect/transforms/TimestampConverter.java     | 452 +++++++++++++++++++++
 .../connect/transforms/util/Requirements.java      |   2 +-
 .../connect/transforms/TimestampConverterTest.java | 370 +++++++++++++++++
 4 files changed, 826 insertions(+), 2 deletions(-)
b31df613f2664a8dc699b421b392f0aca9d5f83f

 .../kafka/clients/ClusterConnectionStates.java     | 60 ++++++++++++++++++----
 .../apache/kafka/clients/CommonClientConfigs.java  |  5 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 17 ++++--
 .../kafka/clients/admin/AdminClientConfig.java     | 12 +++++
 .../kafka/clients/admin/KafkaAdminClient.java      |  1 +
 .../kafka/clients/consumer/ConsumerConfig.java     | 11 ++++
 .../kafka/clients/consumer/KafkaConsumer.java      |  1 +
 .../kafka/clients/producer/KafkaProducer.java      |  1 +
 .../kafka/clients/producer/ProducerConfig.java     |  4 ++
 .../apache/kafka/clients/NetworkClientTest.java    |  9 ++--
 .../runtime/distributed/DistributedConfig.java     |  6 +++
 .../runtime/distributed/WorkerGroupMember.java     |  1 +
 core/src/main/scala/kafka/admin/AdminClient.scala  |  2 +
 .../controller/ControllerChannelManager.scala      |  1 +
 .../TransactionMarkerChannelManager.scala          |  1 +
 core/src/main/scala/kafka/server/KafkaServer.scala |  1 +
 .../kafka/server/ReplicaFetcherBlockingSend.scala  |  3 +-
 .../org/apache/kafka/streams/StreamsConfig.java    | 10 ++++
 .../processor/internals/StreamsKafkaClient.java    |  1 +
 19 files changed, 128 insertions(+), 19 deletions(-)
abe699176babe4f065b67b2b72d20daa0a2e46a1

 .../kafka/clients/ClusterConnectionStates.java     | 60 ++++++++++++++++++----
 .../apache/kafka/clients/CommonClientConfigs.java  |  5 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 17 ++++--
 .../kafka/clients/admin/AdminClientConfig.java     | 12 +++++
 .../kafka/clients/admin/KafkaAdminClient.java      |  1 +
 .../kafka/clients/consumer/ConsumerConfig.java     | 11 ++++
 .../kafka/clients/consumer/KafkaConsumer.java      |  1 +
 .../kafka/clients/producer/KafkaProducer.java      |  1 +
 .../kafka/clients/producer/ProducerConfig.java     |  4 ++
 .../apache/kafka/clients/NetworkClientTest.java    |  9 ++--
 .../runtime/distributed/DistributedConfig.java     |  6 +++
 .../runtime/distributed/WorkerGroupMember.java     |  1 +
 core/src/main/scala/kafka/admin/AdminClient.scala  |  2 +
 .../controller/ControllerChannelManager.scala      |  1 +
 .../TransactionMarkerChannelManager.scala          |  1 +
 core/src/main/scala/kafka/server/KafkaServer.scala |  1 +
 .../kafka/server/ReplicaFetcherBlockingSend.scala  |  3 +-
 .../org/apache/kafka/streams/StreamsConfig.java    | 10 ++++
 .../processor/internals/StreamsKafkaClient.java    |  1 +
 19 files changed, 128 insertions(+), 19 deletions(-)
8b2995c31a44a03883b0ad85523bdf67f694ad36

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
9170e87b2a154e7478af0ede43cc56b01f75bedd

 checkstyle/checkstyle.xml                          |   7 +-
 .../java/org/apache/kafka/common/utils/Bytes.java  |   6 +-
 .../org/apache/kafka/streams/kstream/Windowed.java |   2 +-
 .../kafka/streams/state/ReadOnlySessionStore.java  |  12 +
 .../kafka/streams/state/ReadOnlyWindowStore.java   |  14 +
 .../apache/kafka/streams/state/SessionStore.java   |  15 +
 .../AbstractMergedSortedCacheStoreIterator.java    |  18 +-
 .../streams/state/internals/CacheFunction.java     |  25 ++
 .../state/internals/CachingSessionStore.java       |  56 +++-
 .../state/internals/CachingWindowStore.java        |  64 +++-
 .../ChangeLoggingSegmentedBytesStore.java          |   6 +-
 .../internals/CompositeReadOnlySessionStore.java   |  46 ++-
 .../internals/CompositeReadOnlyWindowStore.java    |  49 +--
 .../state/internals/FilteredCacheIterator.java     |  41 ++-
 .../streams/state/internals/KeyValueIterators.java |  71 +++++
 .../MergedSortedCacheKeyValueStoreIterator.java    |  12 +-
 .../MergedSortedCacheSessionStoreIterator.java     |  39 +--
 .../MergedSortedCacheWindowStoreIterator.java      |  22 +-
 ...rgedSortedCacheWindowStoreKeyValueIterator.java |  75 +++++
 .../internals/MeteredSegmentedBytesStore.java      |   7 +-
 .../streams/state/internals/OrderedBytes.java      |  68 +++++
 .../internals/RocksDBSegmentedBytesStore.java      |  18 +-
 .../state/internals/RocksDBSessionStore.java       |  15 +-
 .../internals/RocksDBSessionStoreSupplier.java     |   5 +-
 .../state/internals/RocksDBWindowStore.java        |  48 ++-
 .../internals/RocksDBWindowStoreSupplier.java      |   8 +-
 .../state/internals/SegmentedBytesStore.java       |  46 ++-
 .../state/internals/SegmentedCacheFunction.java    |  76 +++++
 .../kafka/streams/state/internals/Segments.java    |   7 +-
 .../streams/state/internals/SessionKeySchema.java  |  33 +-
 .../streams/state/internals/WindowKeySchema.java   |  31 +-
 .../internals/WindowStoreIteratorWrapper.java      | 195 ++++++++++++
 .../streams/state/internals/WindowStoreUtils.java  |  14 +-
 .../internals/WrappedWindowStoreIterator.java      |  91 ------
 .../internals/KStreamWindowAggregateTest.java      |  94 +++---
 .../kafka/streams/state/NoOpWindowStore.java       |   6 +
 .../state/internals/CachingSessionStoreTest.java   |  61 +++-
 .../state/internals/CachingWindowStoreTest.java    |  72 ++++-
 .../CompositeReadOnlyWindowStoreTest.java          |   9 +-
 .../state/internals/FilteredCacheIteratorTest.java |  20 +-
 ...SortedCacheWrappedSessionStoreIteratorTest.java |  25 +-
 ...dSortedCacheWrappedWindowStoreIteratorTest.java |  32 +-
 ...acheWrappedWindowStoreKeyValueIteratorTest.java | 132 ++++++++
 .../state/internals/ReadOnlyWindowStoreStub.java   |  62 +++-
 .../state/internals/RocksDBSessionStoreTest.java   |  21 +-
 .../state/internals/RocksDBWindowStoreTest.java    | 331 +++++++++++++--------
 .../internals/SegmentedCacheFunctionTest.java      | 124 ++++++++
 .../state/internals/SessionKeySchemaTest.java      |  92 +++++-
 .../state/internals/WindowKeySchemaTest.java       | 131 ++++++++
 .../kafka/test/ReadOnlySessionStoreStub.java       |  45 ++-
 .../apache/kafka/test/SegmentedBytesStoreStub.java |   5 +
 51 files changed, 2044 insertions(+), 460 deletions(-)
e28752357705568219315375c666f8e500db9c12

 checkstyle/checkstyle.xml                          |   7 +-
 .../java/org/apache/kafka/common/utils/Bytes.java  |   6 +-
 .../org/apache/kafka/streams/kstream/Windowed.java |   2 +-
 .../kafka/streams/state/ReadOnlySessionStore.java  |  12 +
 .../kafka/streams/state/ReadOnlyWindowStore.java   |  14 +
 .../apache/kafka/streams/state/SessionStore.java   |  15 +
 .../AbstractMergedSortedCacheStoreIterator.java    |  18 +-
 .../streams/state/internals/CacheFunction.java     |  25 ++
 .../state/internals/CachingSessionStore.java       |  56 +++-
 .../state/internals/CachingWindowStore.java        |  64 +++-
 .../ChangeLoggingSegmentedBytesStore.java          |   6 +-
 .../internals/CompositeReadOnlySessionStore.java   |  46 ++-
 .../internals/CompositeReadOnlyWindowStore.java    |  49 +--
 .../state/internals/FilteredCacheIterator.java     |  41 ++-
 .../streams/state/internals/KeyValueIterators.java |  71 +++++
 .../MergedSortedCacheKeyValueStoreIterator.java    |  12 +-
 .../MergedSortedCacheSessionStoreIterator.java     |  39 +--
 .../MergedSortedCacheWindowStoreIterator.java      |  22 +-
 ...rgedSortedCacheWindowStoreKeyValueIterator.java |  75 +++++
 .../internals/MeteredSegmentedBytesStore.java      |   7 +-
 .../streams/state/internals/OrderedBytes.java      |  68 +++++
 .../internals/RocksDBSegmentedBytesStore.java      |  18 +-
 .../state/internals/RocksDBSessionStore.java       |  15 +-
 .../internals/RocksDBSessionStoreSupplier.java     |   5 +-
 .../state/internals/RocksDBWindowStore.java        |  48 ++-
 .../internals/RocksDBWindowStoreSupplier.java      |   8 +-
 .../state/internals/SegmentedBytesStore.java       |  46 ++-
 .../state/internals/SegmentedCacheFunction.java    |  76 +++++
 .../kafka/streams/state/internals/Segments.java    |   7 +-
 .../streams/state/internals/SessionKeySchema.java  |  33 +-
 .../streams/state/internals/WindowKeySchema.java   |  31 +-
 .../internals/WindowStoreIteratorWrapper.java      | 195 ++++++++++++
 .../streams/state/internals/WindowStoreUtils.java  |  14 +-
 .../internals/WrappedWindowStoreIterator.java      |  91 ------
 .../internals/KStreamWindowAggregateTest.java      |  94 +++---
 .../kafka/streams/state/NoOpWindowStore.java       |   6 +
 .../state/internals/CachingSessionStoreTest.java   |  61 +++-
 .../state/internals/CachingWindowStoreTest.java    |  72 ++++-
 .../CompositeReadOnlyWindowStoreTest.java          |   9 +-
 .../state/internals/FilteredCacheIteratorTest.java |  20 +-
 ...SortedCacheWrappedSessionStoreIteratorTest.java |  25 +-
 ...dSortedCacheWrappedWindowStoreIteratorTest.java |  32 +-
 ...acheWrappedWindowStoreKeyValueIteratorTest.java | 132 ++++++++
 .../state/internals/ReadOnlyWindowStoreStub.java   |  62 +++-
 .../state/internals/RocksDBSessionStoreTest.java   |  21 +-
 .../state/internals/RocksDBWindowStoreTest.java    | 331 +++++++++++++--------
 .../internals/SegmentedCacheFunctionTest.java      | 124 ++++++++
 .../state/internals/SessionKeySchemaTest.java      |  92 +++++-
 .../state/internals/WindowKeySchemaTest.java       | 131 ++++++++
 .../kafka/test/ReadOnlySessionStoreStub.java       |  45 ++-
 .../apache/kafka/test/SegmentedBytesStoreStub.java |   5 +
 51 files changed, 2044 insertions(+), 460 deletions(-)
b661d3b8ab37fc63b44145ba29d129b07c1582b9

 .../kafka/api/ControlledShutdownRequest.scala      |   2 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   2 +-
 .../scala/kafka/api/GroupCoordinatorRequest.scala  |   4 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |   2 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |   2 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   2 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   4 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   2 +-
 .../main/scala/kafka/network/RequestChannel.scala  |  40 +--
 .../main/scala/kafka/network/SocketServer.scala    |  12 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 390 ++++++++++-----------
 .../unit/kafka/network/SocketServerTest.scala      |  16 +-
 12 files changed, 231 insertions(+), 247 deletions(-)
56623efd73ec77e68cf35021d18d630b27062e82

 .../org/apache/kafka/clients/admin/NewTopic.java   |  20 ++
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 151 +++++-------
 .../clients/admin/MockKafkaAdminClientEnv.java     |  87 +++++++
 .../test/java/org/apache/kafka/test/TestUtils.java |   9 +
 config/connect-distributed.properties              |  37 ++-
 .../runtime/distributed/DistributedConfig.java     |  68 +++++-
 .../connect/storage/KafkaConfigBackingStore.java   |  27 ++-
 .../connect/storage/KafkaOffsetBackingStore.java   |  33 ++-
 .../connect/storage/KafkaStatusBackingStore.java   |  28 ++-
 .../apache/kafka/connect/util/KafkaBasedLog.java   |  16 +-
 .../org/apache/kafka/connect/util/TopicAdmin.java  | 263 +++++++++++++++++++++
 .../storage/KafkaConfigBackingStoreTest.java       |  11 +-
 .../storage/KafkaOffsetBackingStoreTest.java       |  16 +-
 .../kafka/connect/util/KafkaBasedLogTest.java      |   9 +-
 .../apache/kafka/connect/util/TopicAdminTest.java  | 158 +++++++++++++
 .../tests/connect/connect_distributed_test.py      |   8 +-
 tests/kafkatest/tests/connect/connect_rest_test.py |   5 +
 .../templates/connect-distributed.properties       |   5 +
 18 files changed, 828 insertions(+), 123 deletions(-)
30736da65d6e47eb68ab7563357a063caf753964

 .../scala/integration/kafka/api/AuthorizerIntegrationTest.scala   | 1 +
 core/src/test/scala/integration/kafka/api/TransactionsTest.scala  | 8 ++++----
 2 files changed, 5 insertions(+), 4 deletions(-)
96959bc5620b6dc5900173a15cccfe83d20be944

 core/src/main/scala/kafka/server/KafkaApis.scala | 87 ++++++++++++++----------
 1 file changed, 51 insertions(+), 36 deletions(-)
65edd64ca4902c9b2bc48e952056235f016031e1

 .../kafka/common/network/SaslChannelBuilder.java   |  3 +-
 .../java/org/apache/kafka/common/utils/Java.java   |  4 ++
 .../org/apache/kafka/common/utils/JavaTest.java    | 56 ++++++++++++++++++++++
 .../scala/kafka/security/minikdc/MiniKdc.scala     |  4 +-
 .../scala/unit/kafka/utils/JaasTestUtils.scala     | 49 ++++++++++++++-----
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 12 ++---
 6 files changed, 105 insertions(+), 23 deletions(-)
c1fdf575deed0398e1692be16cacf24308afd5d5

 .../org/apache/kafka/clients/producer/KafkaProducer.java    | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)
34e379f10779bfb17fb399fde0357d17dc34ab62

 .../kafka/coordinator/transaction/TransactionCoordinator.scala   | 9 +++++++--
 .../coordinator/transaction/TransactionCoordinatorTest.scala     | 6 +++---
 2 files changed, 10 insertions(+), 5 deletions(-)
d662b09c9f32d7d4dcfc18522a4d2789b43d319c

 .../kafka/coordinator/transaction/TransactionCoordinator.scala    | 2 +-
 .../scala/kafka/coordinator/transaction/TransactionMetadata.scala | 2 +-
 .../coordinator/transaction/TransactionCoordinatorTest.scala      | 8 +++++++-
 3 files changed, 9 insertions(+), 3 deletions(-)
45f2261763eac5caaebf860daab32ef5337c9293

 build.gradle                                       |   1 +
 checkstyle/import-control.xml                      |   5 +
 checkstyle/suppressions.xml                        |   2 +-
 config/connect-distributed.properties              |  10 +
 config/connect-standalone.properties               |  11 +
 .../kafka/connect/cli/ConnectDistributed.java      |   7 +-
 .../kafka/connect/cli/ConnectStandalone.java       |   7 +-
 .../kafka/connect/runtime/AbstractHerder.java      |  91 ++++---
 .../kafka/connect/runtime/ConnectorConfig.java     |  67 +++--
 .../org/apache/kafka/connect/runtime/Herder.java   |   9 +-
 .../kafka/connect/runtime/PluginDiscovery.java     | 126 ---------
 .../kafka/connect/runtime/SinkConnectorConfig.java |  10 +-
 .../connect/runtime/SourceConnectorConfig.java     |   5 +-
 .../org/apache/kafka/connect/runtime/Worker.java   | 173 +++++++++---
 .../apache/kafka/connect/runtime/WorkerConfig.java |  31 ++-
 .../kafka/connect/runtime/WorkerSinkTask.java      |   3 +-
 .../kafka/connect/runtime/WorkerSourceTask.java    |   3 +-
 .../apache/kafka/connect/runtime/WorkerTask.java   |  12 +-
 .../runtime/distributed/DistributedHerder.java     |   4 +-
 .../runtime/isolation/DelegatingClassLoader.java   | 299 +++++++++++++++++++++
 .../runtime/isolation/PluginClassLoader.java       |  68 +++++
 .../connect/runtime/isolation/PluginDesc.java      | 110 ++++++++
 .../runtime/isolation/PluginScanResult.java        |  55 ++++
 .../connect/runtime/isolation/PluginType.java      |  58 ++++
 .../connect/runtime/isolation/PluginUtils.java     | 147 ++++++++++
 .../kafka/connect/runtime/isolation/Plugins.java   | 217 +++++++++++++++
 .../runtime/rest/entities/ConnectorPluginInfo.java |  37 +--
 .../rest/resources/ConnectorPluginsResource.java   |  40 ++-
 .../runtime/standalone/StandaloneHerder.java       |   4 +-
 .../kafka/connect/runtime/ConnectorConfigTest.java |  27 +-
 .../kafka/connect/runtime/WorkerConnectorTest.java |  30 ++-
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |   8 +-
 .../runtime/WorkerSinkTaskThreadedTest.java        |   7 +-
 .../connect/runtime/WorkerSourceTaskTest.java      |   5 +-
 .../kafka/connect/runtime/WorkerTaskTest.java      |  30 ++-
 .../apache/kafka/connect/runtime/WorkerTest.java   | 224 +++++++++++++--
 .../runtime/distributed/DistributedHerderTest.java |  67 +++--
 .../connect/runtime/isolation/PluginUtilsTest.java | 127 +++++++++
 .../resources/ConnectorPluginsResourceTest.java    | 128 +++++++--
 .../runtime/standalone/StandaloneHerderTest.java   |  72 +++--
 gradle/dependencies.gradle                         |   4 +-
 41 files changed, 1937 insertions(+), 404 deletions(-)
5aaaba7ffe51a3216262811f24e6ccf10488b5e1

 .../kafka/controller/PartitionStateMachine.scala   | 44 +++++++++------
 .../kafka/controller/ReplicaStateMachine.scala     | 65 +++++++++++++++-------
 2 files changed, 72 insertions(+), 37 deletions(-)
816578b5c13d36d73af02d1c11787f789a69be3f

 .../integration/QueryableStateIntegrationTest.java | 27 +++++++++-------------
 1 file changed, 11 insertions(+), 16 deletions(-)
14a3d69d9463b2aa26776329610f8fc5eddd0202

 .../clients/consumer/internals/ConsumerProtocol.java | 20 +++-----------------
 1 file changed, 3 insertions(+), 17 deletions(-)
9fa0d52cac24c69dbc907208ccb3e603cab3503b

 .../main/scala/kafka/tools/StreamsResetter.java    | 32 +++++++---------------
 1 file changed, 10 insertions(+), 22 deletions(-)
972b7545363ae85a55f94cf7ea83614be8840b75

 checkstyle/suppressions.xml                        |   4 +-
 .../apache/kafka/clients/admin/AclOperation.java   |  12 +-
 .../apache/kafka/clients/admin/AdminClient.java    |  60 ++++++
 .../kafka/clients/admin/AlterConfigsOptions.java   |  45 +++++
 .../kafka/clients/admin/AlterConfigsResults.java   |  42 ++++
 .../org/apache/kafka/clients/admin/Config.java     |  63 ++++++
 .../apache/kafka/clients/admin/ConfigEntry.java    |  59 ++++++
 .../apache/kafka/clients/admin/ConfigResource.java |  65 ++++++
 .../clients/admin/DescribeConfigsOptions.java      |  37 ++++
 .../clients/admin/DescribeConfigsResults.java      |  59 ++++++
 .../kafka/clients/admin/KafkaAdminClient.java      | 184 ++++++++++++++++-
 .../apache/kafka/clients/admin/ResourceType.java   |   7 +-
 .../apache/kafka/common/config/AbstractConfig.java |   7 +
 .../errors/BrokerAuthorizationException.java       |  23 +++
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   4 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  20 +-
 .../org/apache/kafka/common/protocol/Protocol.java | 182 +++++++++++------
 .../apache/kafka/common/protocol/types/Schema.java |  16 +-
 .../kafka/common/requests/AbstractRequest.java     |   6 +
 .../kafka/common/requests/AbstractResponse.java    |   4 +
 .../kafka/common/requests/AlterConfigsRequest.java | 179 ++++++++++++++++
 .../common/requests/AlterConfigsResponse.java      |  88 ++++++++
 .../org/apache/kafka/common/requests/ApiError.java |  99 +++++++++
 .../kafka/common/requests/CreateTopicsRequest.java |  12 +-
 .../common/requests/CreateTopicsResponse.java      |  68 +------
 .../common/requests/DescribeConfigsRequest.java    | 142 +++++++++++++
 .../common/requests/DescribeConfigsResponse.java   | 186 +++++++++++++++++
 .../org/apache/kafka/common/requests/Resource.java |  60 ++++++
 .../apache/kafka/common/requests/ResourceType.java |  42 ++++
 .../kafka/server/policy/CreateTopicPolicy.java     |   6 +-
 .../kafka/clients/admin/AclOperationTest.java      |   4 +-
 .../kafka/clients/admin/KafkaAdminClientTest.java  |  20 +-
 .../kafka/clients/admin/ResourceTypeTest.java      |   3 +-
 .../kafka/common/requests/RequestResponseTest.java |  60 +++++-
 core/src/main/scala/kafka/admin/AclCommand.scala   |  14 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  33 ++-
 .../src/main/scala/kafka/admin/ConfigCommand.scala |  17 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |   2 +-
 .../main/scala/kafka/security/auth/Operation.scala |  20 +-
 .../scala/kafka/security/auth/ResourceType.scala   |   7 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |   2 +-
 .../src/main/scala/kafka/server/AdminManager.scala | 109 +++++++++-
 .../scala/kafka/server/DelayedCreateTopics.scala   |   8 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  82 +++++++-
 core/src/main/scala/kafka/server/KafkaServer.scala |   6 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      | 132 +++++++-----
 .../api/KafkaAdminClientIntegrationTest.scala      | 224 ++++++++++++++++++++-
 .../scala/unit/kafka/admin/AclCommandTest.scala    |  11 +-
 .../server/AbstractCreateTopicsRequestTest.scala   |   8 +-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |  18 +-
 .../processor/internals/StreamsKafkaClient.java    |   3 +-
 52 files changed, 2271 insertions(+), 295 deletions(-)
e1abf17708918b82d3974ea028a4d74e3892fa0f

 .../kafka/clients/consumer/StickyAssignor.java     | 933 +++++++++++++++++++++
 .../internals/AbstractPartitionAssignor.java       |   8 +-
 .../consumer/internals/ConsumerProtocol.java       |   1 -
 .../consumer/internals/PartitionAssignor.java      |   2 +-
 .../org/apache/kafka/common/TopicPartition.java    |   1 -
 .../kafka/clients/consumer/StickyAssignorTest.java | 689 +++++++++++++++
 .../kafka/api/PlaintextConsumerTest.scala          |  58 +-
 7 files changed, 1685 insertions(+), 7 deletions(-)
9815e18fefa27d8d901356ec1d994a41b4db4622

 checkstyle/import-control.xml                      |   2 +
 checkstyle/suppressions.xml                        |   9 +-
 .../kafka/clients/admin/AccessControlEntry.java    |  86 ++++++++
 .../clients/admin/AccessControlEntryData.java      | 105 ++++++++++
 .../clients/admin/AccessControlEntryFilter.java    | 117 +++++++++++
 .../org/apache/kafka/clients/admin/AclBinding.java |  74 +++++++
 .../kafka/clients/admin/AclBindingFilter.java      |  89 +++++++++
 .../apache/kafka/clients/admin/AclOperation.java   | 122 ++++++++++++
 .../kafka/clients/admin/AclPermissionType.java     |  92 +++++++++
 .../apache/kafka/clients/admin/AdminClient.java    |  66 ++++++
 .../kafka/clients/admin/CreateAclsOptions.java     |  34 ++++
 .../kafka/clients/admin/CreateAclsResults.java     |  48 +++++
 .../kafka/clients/admin/DeleteAclsOptions.java     |  34 ++++
 .../kafka/clients/admin/DeleteAclsResults.java     | 107 ++++++++++
 .../kafka/clients/admin/DescribeAclsOptions.java   |  34 ++++
 .../kafka/clients/admin/DescribeAclsResults.java   |  37 ++++
 .../kafka/clients/admin/KafkaAdminClient.java      | 173 +++++++++++++++-
 .../org/apache/kafka/clients/admin/Resource.java   |  74 +++++++
 .../apache/kafka/clients/admin/ResourceFilter.java |  90 +++++++++
 .../apache/kafka/clients/admin/ResourceType.java   |  97 +++++++++
 .../common/errors/SecurityDisabledException.java   |  32 +++
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   5 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  12 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  90 +++++++++
 .../kafka/common/requests/AbstractRequest.java     |   9 +
 .../kafka/common/requests/AbstractResponse.java    |   6 +
 .../kafka/common/requests/CreateAclsRequest.java   | 133 +++++++++++++
 .../kafka/common/requests/CreateAclsResponse.java  | 106 ++++++++++
 .../kafka/common/requests/DeleteAclsRequest.java   | 111 +++++++++++
 .../kafka/common/requests/DeleteAclsResponse.java  | 182 +++++++++++++++++
 .../kafka/common/requests/DescribeAclsRequest.java |  90 +++++++++
 .../common/requests/DescribeAclsResponse.java      | 128 ++++++++++++
 .../apache/kafka/common/requests/RequestUtils.java |  82 ++++++++
 .../apache/kafka/clients/admin/AclBindingTest.java | 110 ++++++++++
 .../kafka/clients/admin/AclOperationTest.java      |  86 ++++++++
 .../kafka/clients/admin/AclPermissionTypeTest.java |  80 ++++++++
 .../kafka/clients/admin/KafkaAdminClientTest.java  | 163 +++++++++++++++
 .../kafka/clients/admin/ResourceTypeTest.java      |  81 ++++++++
 .../kafka/common/requests/RequestResponseTest.java |  80 ++++++++
 .../main/scala/kafka/security/auth/Operation.scala |  56 +++++-
 .../scala/kafka/security/auth/PermissionType.scala |  17 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 221 ++++++++++++++++++++-
 .../api/KafkaAdminClientIntegrationTest.scala      |  23 ++-
 .../api/SaslSslAdminClientIntegrationTest.scala    |  87 +++++++-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |  24 ++-
 45 files changed, 3472 insertions(+), 32 deletions(-)
24915206260c33cd7118db5359f3927d3be1ff60

 core/src/main/scala/kafka/cluster/Partition.scala  | 45 ++++++++----
 core/src/main/scala/kafka/log/Log.scala            |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  6 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 48 +++++--------
 .../kafka/server/epoch/LeaderEpochFileCache.scala  |  2 +-
 .../server/epoch/OffsetsForLeaderEpochTest.scala   | 83 ++++++++++++----------
 6 files changed, 100 insertions(+), 86 deletions(-)
c64cfd2e2bffd0a8fcfa515d3bbbe76416a89ee7

 checkstyle/checkstyle.xml                          |   2 +-
 .../kafka/clients/producer/internals/Sender.java   |   8 +-
 .../coordinator/transaction/DelayedTxnMarker.scala |   1 +
 .../transaction/TransactionCoordinator.scala       |  10 +-
 .../TransactionMarkerChannelManager.scala          |   6 +-
 ...TransactionMarkerRequestCompletionHandler.scala |  59 ++++++++---
 .../transaction/TransactionMetadata.scala          |  18 +++-
 .../transaction/TransactionStateManager.scala      | 113 ++++++++++++++-------
 .../main/scala/kafka/server/DelayedOperation.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 .../integration/kafka/api/TransactionsTest.scala   |   2 +-
 .../transaction/TransactionCoordinatorTest.scala   |   6 +-
 .../transaction/TransactionStateManagerTest.scala  |   2 +-
 13 files changed, 157 insertions(+), 74 deletions(-)
b3a33ce4b81a20ae5635cf28490fd2e1f9d86141

 .../kafka/clients/producer/internals/Sender.java   |  59 +--
 .../producer/internals/TransactionManager.java     |  25 +-
 .../kafka/common/requests/EndTxnRequest.java       |   4 +
 .../producer/internals/TransactionManagerTest.java |  47 ++-
 .../transaction/TransactionCoordinator.scala       |  24 +-
 .../transaction/TransactionMetadata.scala          |   2 +-
 .../transaction/TransactionStateManager.scala      |   1 -
 .../kafka/api/TransactionsBounceTest.scala         | 185 ++++++++++
 .../integration/kafka/api/TransactionsTest.scala   | 400 +++++++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  95 ++++-
 10 files changed, 806 insertions(+), 36 deletions(-)
2181ae768719a9ae3a929ba875faa89c67edf643

 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 302 ++++++++++-
 .../kafka/admin/ResetConsumerGroupOffsetTest.scala | 601 +++++++++++++++++++++
 2 files changed, 874 insertions(+), 29 deletions(-)
6910baf548ebad4c1530432e51be40793b4a4f10

 .../kafka/streams/kstream/PrintForeachAction.java  |  59 ++++++
 .../streams/kstream/internals/KStreamForeach.java  |  43 -----
 .../streams/kstream/internals/KStreamImpl.java     |   9 +-
 .../streams/kstream/internals/KStreamPeek.java     |   9 +-
 .../streams/kstream/internals/KStreamPrint.java    |  89 +++++++++
 .../streams/kstream/internals/KTableImpl.java      |   9 +-
 .../streams/kstream/internals/KeyValuePrinter.java | 120 ------------
 .../streams/kstream/internals/KStreamPeekTest.java |   9 +-
 .../kstream/internals/KStreamPrintTest.java        |  91 +++++++++
 .../internals/KeyValuePrinterProcessorTest.java    | 207 ---------------------
 10 files changed, 262 insertions(+), 383 deletions(-)
8c7e6631308ae986bd60df0b0761f68c777fadff

 .../scala/unit/kafka/server/RequestQuotaTest.scala | 78 +++++++++-------------
 1 file changed, 33 insertions(+), 45 deletions(-)
c36b5b7f6ef5767c9455cca093ce05bf2a54d5db

 .../java/org/apache/kafka/clients/admin/AdminClient.java    | 13 ++++++++++++-
 .../org/apache/kafka/clients/admin/KafkaAdminClient.java    |  2 +-
 .../org/apache/kafka/clients/admin/TopicDescription.java    |  2 +-
 .../java/org/apache/kafka/clients/admin/TopicListing.java   |  2 +-
 .../org/apache/kafka/clients/admin/TopicPartitionInfo.java  |  2 +-
 5 files changed, 16 insertions(+), 5 deletions(-)
62d5aac5dda5ad7108aeb41ac3006221e2dab74b

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1cea4d8f5a51cc5795ddd3af2ea015b9e14d937d

 .../apache/kafka/connect/data/SchemaBuilder.java   |   2 +-
 .../kafka/connect/tools/TransformationDoc.java     |   6 +-
 .../org/apache/kafka/connect/transforms/Cast.java  | 417 +++++++++++++++++++++
 .../apache/kafka/connect/transforms/Flatten.java   | 281 ++++++++++++++
 .../connect/transforms/util/Requirements.java      |   1 +
 .../kafka/connect/transforms/util/SchemaUtil.java  |   4 +
 .../apache/kafka/connect/transforms/CastTest.java  | 384 +++++++++++++++++++
 .../kafka/connect/transforms/FlattenTest.java      | 257 +++++++++++++
 8 files changed, 1350 insertions(+), 2 deletions(-)
ebc7f7caaeb47c9588d79a2f3ed496daa0bd39e5

 .../kafka/clients/consumer/MockConsumer.java       |  78 +--
 .../kafka/clients/producer/MockProducer.java       |  23 +
 .../apache/kafka/common/config/AbstractConfig.java |  16 +
 .../kafka/clients/producer/MockProducerTest.java   | 122 ++++
 .../org/apache/kafka/streams/StreamsConfig.java    |  74 ++-
 .../streams/processor/internals/AbstractTask.java  |  34 +-
 .../processor/internals/PartitionGroup.java        |  65 ++-
 .../processor/internals/ProcessorStateManager.java |  17 +-
 .../processor/internals/RecordCollector.java       |  12 +
 .../processor/internals/RecordCollectorImpl.java   |   9 +-
 .../processor/internals/StandbyContextImpl.java    |  22 +-
 .../streams/processor/internals/StandbyTask.java   |  15 +-
 .../streams/processor/internals/StreamTask.java    | 158 +++--
 .../streams/processor/internals/StreamThread.java  | 180 ++++--
 .../streams/state/internals/OffsetCheckpoint.java  |  75 +--
 .../apache/kafka/streams/StreamsConfigTest.java    | 171 +++++-
 .../processor/internals/AbstractTaskTest.java      |  13 +-
 .../processor/internals/PartitionGroupTest.java    |  12 +-
 .../internals/ProcessorStateManagerTest.java       | 272 ++++++---
 .../processor/internals/StreamTaskTest.java        | 289 ++++++---
 .../processor/internals/StreamThreadTest.java      | 645 +++++++++++++++------
 .../StreamThreadStateStoreProviderTest.java        |  69 ++-
 .../org/apache/kafka/test/MockClientSupplier.java  |  23 +-
 .../org/apache/kafka/test/NoOpRecordCollector.java |   9 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    | 155 ++---
 25 files changed, 1812 insertions(+), 746 deletions(-)
670193f22d9e05a130024c1bcc7408ac2f736fba

 docs/design.html | 35 +++++++++++++++++++++++++++++------
 docs/ops.html    | 41 +++++++++++++++++++++++++++--------------
 2 files changed, 56 insertions(+), 20 deletions(-)
d1d71aa29afd4aa959864225d2fec50c71513481

 .../main/scala/kafka/tools/StreamsResetter.java    | 151 ++++++++++++++++-----
 1 file changed, 120 insertions(+), 31 deletions(-)
e06cd3e55f25a0bb414e0770493906ea8019420a

 .../processor/internals/GlobalStateManagerImpl.java       |  4 ++--
 .../processor/internals/GlobalStateManagerImplTest.java   | 15 ++++++++++++++-
 2 files changed, 16 insertions(+), 3 deletions(-)
73703a15c5006ddca166a458dcde72e17c91de4a

 .../processor/internals/GlobalStateManagerImpl.java        |  4 ++--
 .../processor/internals/GlobalStateManagerImplTest.java    | 14 +++++++++++++-
 2 files changed, 15 insertions(+), 3 deletions(-)
4e3092d27648b9db18a496d16cd44f600429dcfc

 .../kafka/coordinator/group/GroupCoordinator.scala |  84 +++--
 core/src/main/scala/kafka/log/Log.scala            |  14 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   3 +-
 .../scala/kafka/log/ProducerStateManager.scala     |  40 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  74 ++--
 .../group/GroupCoordinatorResponseTest.scala       |  14 +-
 .../coordinator/group/GroupCoordinatorTest.scala   |  36 --
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   7 +-
 .../unit/kafka/log/ProducerStateManagerTest.scala  | 409 +++++++++++----------
 9 files changed, 350 insertions(+), 331 deletions(-)
d66e7af6526f208900a5d6cb588cf47058800804

 .../kafka/clients/producer/KafkaProducer.java      |  25 +-
 .../clients/producer/internals/ProducerBatch.java  |   4 +
 .../producer/internals/RecordAccumulator.java      |   8 +-
 .../kafka/clients/producer/internals/Sender.java   |  16 +-
 .../producer/internals/TransactionManager.java     |  72 +++--
 .../errors/ProducerIdAuthorizationException.java   |  23 ++
 .../TransactionalIdAuthorizationException.java     |  23 ++
 .../org/apache/kafka/common/protocol/Errors.java   |  21 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  10 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  17 +-
 .../common/requests/AddPartitionsToTxnRequest.java |   7 +-
 .../requests/AddPartitionsToTxnResponse.java       |  56 +++-
 .../common/requests/FindCoordinatorResponse.java   |  10 +
 .../kafka/common/requests/ProduceRequest.java      |  12 +
 .../producer/internals/TransactionManagerTest.java |  51 +++-
 .../common/record/MemoryRecordsBuilderTest.java    |  66 +++++
 .../kafka/common/requests/ProduceRequestTest.java  |  95 +++++++
 .../kafka/common/requests/RequestResponseTest.java |   2 +-
 .../main/scala/kafka/security/auth/Resource.scala  |   2 +
 .../scala/kafka/security/auth/ResourceType.scala   |  11 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 290 ++++++++++++---------
 .../kafka/api/AuthorizerIntegrationTest.scala      | 113 +++++++-
 22 files changed, 752 insertions(+), 182 deletions(-)
a281fe17fe1dda9a41890648299b74fa2449552a

 .../src/main/java/org/apache/kafka/clients/admin/AdminClient.java   | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
0a1689a749392d8de9dfbdc200ad9edce75024a1

 .../test/scala/unit/kafka/controller/ControllerIntegrationTest.scala    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0e2c90bad934b276610fdcf027252553208099ac

 .../main/java/org/apache/kafka/clients/consumer/internals/Fetcher.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
cacbba6519a150ed25780889e8fa9b03c27832ee

 core/src/test/scala/unit/kafka/log/LogCleanerTest.scala | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
dd9f43140d4a898576d86f6d5b7be1a021de1040

 .../integration/kafka/api/BaseQuotaTest.scala      |  5 +-
 .../integration/kafka/api/ProducerBounceTest.scala |  4 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala | 16 ++---
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  4 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  6 +-
 .../integration/UncleanLeaderElectionTest.scala    | 12 ++--
 .../scala/unit/kafka/server/FetchRequestTest.scala |  2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     | 26 ++++----
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 14 ++---
 .../unit/kafka/server/ProduceRequestTest.scala     |  2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 69 ++++++++++++----------
 11 files changed, 80 insertions(+), 80 deletions(-)
7bb551b4a1737f1819e11e08248b1f2277a0680e

 core/src/main/scala/kafka/log/Log.scala            |   1 +
 core/src/main/scala/kafka/log/LogSegment.scala     |   1 +
 .../scala/kafka/log/ProducerStateManager.scala     |  10 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |   8 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 108 ++++++++++++++++++++-
 .../unit/kafka/log/ProducerStateManagerTest.scala  |  21 ++++
 6 files changed, 141 insertions(+), 8 deletions(-)
4c75f31a5f80e6a717d040b0534c79f5ed8d9346

 checkstyle/suppressions.xml                        |  2 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 27 +++++++++--
 .../apache/kafka/common/network/ChannelState.java  | 56 ++++++++++++++++++++++
 .../apache/kafka/common/network/KafkaChannel.java  | 16 ++++++-
 .../apache/kafka/common/network/Selectable.java    |  7 +--
 .../org/apache/kafka/common/network/Selector.java  | 22 ++++++---
 .../apache/kafka/clients/NetworkClientTest.java    |  4 +-
 .../kafka/common/network/NetworkTestUtils.java     |  3 +-
 .../apache/kafka/common/network/SelectorTest.java  |  9 ++--
 .../kafka/common/network/SslSelectorTest.java      |  2 +-
 .../common/network/SslTransportLayerTest.java      | 14 +++---
 .../authenticator/SaslAuthenticatorTest.java       | 40 +++++++---------
 .../java/org/apache/kafka/test/MockSelector.java   |  9 ++--
 .../main/scala/kafka/network/SocketServer.scala    |  2 +-
 14 files changed, 156 insertions(+), 57 deletions(-)
46aa88b9cf82971a0890f4f83efa9639f84c677b

 .../scala/kafka/controller/KafkaController.scala   |  24 ++--
 .../kafka/controller/PartitionLeaderSelector.scala |   2 +-
 core/src/main/scala/kafka/log/Log.scala            |  10 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  13 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   3 +-
 .../scala/kafka/server/KafkaRequestHandler.scala   |  32 ++++--
 core/src/main/scala/kafka/server/KafkaServer.scala |  28 +++--
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  31 ++---
 .../ReplicaFetcherThreadFatalErrorTest.scala       |   2 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |   4 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   3 +-
 .../log/AbstractLogCleanerIntegrationTest.scala    |   4 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   7 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |   7 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |   4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 128 +++++++++++++++------
 .../scala/unit/kafka/metrics/MetricsTest.scala     |   2 +-
 .../server/HighwatermarkPersistenceTest.scala      |   4 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   3 +-
 .../kafka/server/ReplicaManagerQuotasTest.scala    |   3 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  18 ++-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  12 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 24 files changed, 221 insertions(+), 130 deletions(-)
0186794104b7106fe426024d65730fec79ad999a

 .../clients/producer/internals/TransactionManager.java  |  3 +--
 .../java/org/apache/kafka/common/protocol/Protocol.java |  3 ---
 .../kafka/common/requests/TxnOffsetCommitRequest.java   | 17 +++--------------
 .../kafka/common/requests/RequestResponseTest.java      |  2 +-
 .../test/scala/unit/kafka/server/RequestQuotaTest.scala |  2 +-
 5 files changed, 6 insertions(+), 21 deletions(-)
c26545ea5701e02fc2667c81c719630ba14f500b

 .../apache/kafka/streams/state/internals/CachingSessionStore.java   | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
5719e8c9c07d7580a8806fddbb7135bd56be9e0c

 .../apache/kafka/streams/state/internals/CachingSessionStore.java   | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
3e6669000f082808999a7216b00c4b0f5a94e1da

 .../producer/internals/RecordAccumulator.java      |  10 +-
 .../kafka/clients/producer/internals/Sender.java   |  27 +--
 .../producer/internals/TransactionManager.java     |  10 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   4 +-
 .../kafka/common/record/DefaultRecordBatch.java    |   4 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  10 +-
 .../apache/kafka/common/record/RecordBatch.java    |   4 +-
 .../common/requests/AddOffsetsToTxnRequest.java    |   6 +-
 .../common/requests/AddPartitionsToTxnRequest.java |  12 +-
 .../kafka/common/requests/EndTxnRequest.java       |  12 +-
 .../kafka/common/requests/FetchResponse.java       |   6 +-
 .../common/requests/TxnOffsetCommitRequest.java    |  12 +-
 .../common/requests/WriteTxnMarkersRequest.java    |  12 +-
 .../common/requests/WriteTxnMarkersResponse.java   |   6 +-
 .../clients/producer/internals/SenderTest.java     |   4 +-
 .../producer/internals/TransactionManagerTest.java |   4 +-
 .../kafka/coordinator/group/GroupMetadata.scala    |   2 +-
 .../coordinator/transaction/TransactionLog.scala   | 193 +++++++++++----------
 ...TransactionMarkerRequestCompletionHandler.scala |   2 +-
 .../transaction/TransactionMetadata.scala          |   6 +-
 .../transaction/TransactionStateManager.scala      |   2 +-
 core/src/main/scala/kafka/log/Log.scala            |  22 +--
 core/src/main/scala/kafka/log/LogManager.scala     |   4 +-
 .../scala/kafka/log/ProducerStateManager.scala     |  22 +--
 core/src/main/scala/kafka/server/KafkaConfig.scala |   8 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |  20 +--
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   6 +-
 29 files changed, 221 insertions(+), 213 deletions(-)
c15b93fbee7883852c0d9633f2279c29772ba2ba

 .../org/apache/kafka/streams/state/internals/RocksDBSessionStore.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e40e27b4eb99e8931488e86289453c5f14d5e886

 .../org/apache/kafka/streams/state/internals/RocksDBSessionStore.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
82e84fabf87fa5b5e6b4b9fd464edafaa9c5a744

 .../java/org/apache/kafka/common/requests/AddOffsetsToTxnResponse.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a511a47020a1a3f58c7778b5d5aba08d2b4876d6

 .../java/org/apache/kafka/common/metrics/stats/Percentiles.java   | 6 ++++++
 .../test/java/org/apache/kafka/common/metrics/MetricsTest.java    | 8 ++++++++
 2 files changed, 14 insertions(+)
50eacb7b45143dbc26a341620290991428194e4d

 .../scala/kafka/server/KafkaRequestHandler.scala   |  6 ++--
 .../scala/unit/kafka/metrics/MetricsTest.scala     | 35 ++++++++++++++--------
 2 files changed, 27 insertions(+), 14 deletions(-)
1ca2b1aacc2994e441c1a949310129d3e78532b5

 core/src/main/scala/kafka/log/Log.scala          | 40 ++++++++----
 core/src/main/scala/kafka/log/LogManager.scala   | 11 +---
 core/src/main/scala/kafka/log/LogSegment.scala   |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala | 81 +++++++++++++++++++++---
 4 files changed, 103 insertions(+), 31 deletions(-)
e2d4198c4ca980c5a5743af043ed2abd08792f30

 core/src/main/scala/kafka/log/Log.scala          |  5 ++++-
 core/src/test/scala/unit/kafka/log/LogTest.scala | 19 +++++++++++++++++++
 2 files changed, 23 insertions(+), 1 deletion(-)
f56bbb6510df8c12db3ad075e2f6c78dd0092d60

 core/src/main/scala/kafka/log/Log.scala          | 42 ++++++++----
 core/src/main/scala/kafka/log/LogManager.scala   | 11 +---
 core/src/main/scala/kafka/log/LogSegment.scala   |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala | 82 ++++++++++++++++++++----
 4 files changed, 104 insertions(+), 33 deletions(-)
bc55f85237cb46e73c6774298cf308060a4a739c

 .../org/apache/kafka/common/internals/Topic.java   |  66 ++++++++-----
 .../apache/kafka/common/internals/TopicTest.java   |  89 +++++++++++-------
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   3 +-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |   9 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |   6 +-
 core/src/main/scala/kafka/common/Topic.scala       |  74 ---------------
 .../main/scala/kafka/consumer/TopicFilter.scala    |   5 +-
 .../kafka/coordinator/group/GroupCoordinator.scala |   5 +-
 .../coordinator/group/GroupMetadataManager.scala   |  16 ++--
 .../transaction/TransactionStateManager.scala      |  11 ++-
 core/src/main/scala/kafka/log/Log.scala            |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  22 ++---
 .../main/scala/kafka/server/MetadataCache.scala    |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   3 +-
 .../scala/kafka/tools/StateChangeLogMerger.scala   |   5 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  18 ++--
 .../integration/kafka/api/BaseConsumerTest.scala   |   4 +-
 .../api/GroupCoordinatorIntegrationTest.scala      |   6 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |   4 +-
 ...ListenersWithSameSecurityProtocolBaseTest.scala |   4 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |  12 +--
 .../test/scala/unit/kafka/common/TopicTest.scala   | 102 ---------------------
 .../unit/kafka/consumer/TopicFilterTest.scala      |  10 +-
 .../group/GroupCoordinatorResponseTest.scala       |  31 ++++---
 .../group/GroupMetadataManagerTest.scala           |  42 ++++-----
 .../TransactionCoordinatorIntegrationTest.scala    |   4 +-
 .../transaction/TransactionStateManagerTest.scala  |   9 +-
 .../unit/kafka/server/MetadataRequestTest.scala    |   7 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   5 +-
 29 files changed, 230 insertions(+), 349 deletions(-)
758e3aa7eb9fc7e7d60def9d055875a60161d2ba

 .../org/apache/kafka/common/config/ConfigDef.java  |  2 +-
 .../apache/kafka/common/config/ConfigDefTest.java  | 67 ++++++++++++++++++++++
 2 files changed, 68 insertions(+), 1 deletion(-)
885643ce100b3b74a2b6859bf0b85103d8c05ef8

 .../org/apache/kafka/common/config/ConfigDef.java  |  2 +-
 .../apache/kafka/common/config/ConfigDefTest.java  | 67 ++++++++++++++++++++++
 2 files changed, 68 insertions(+), 1 deletion(-)
e3892c29c342629be789437c2c52b4e367af52ef

 .../transforms/util/NonEmptyListValidator.java     |  2 +-
 .../transforms/util/NonEmptyListValidatorTest.java | 40 ++++++++++++++++++++++
 2 files changed, 41 insertions(+), 1 deletion(-)
1af096039d7a2d8fd865b0eaee28c70f10e07008

 .../scala/unit/kafka/metrics/MetricsTest.scala     | 27 +++++++++++-----------
 1 file changed, 14 insertions(+), 13 deletions(-)
c5aeaa7d898ce4b21e3204cd805d0b2c508e24eb

 core/src/main/scala/kafka/server/KafkaServer.scala | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)
6a5026b23bec5207105d498f784872a3d2dd1e72

 .../unit/kafka/admin/ListConsumerGroupTest.scala    |  6 +++++-
 .../security/auth/SimpleAclAuthorizerTest.scala     | 21 +++++++++++++++------
 2 files changed, 20 insertions(+), 7 deletions(-)
6ca71c064940605873e93ebf82ca8c404c8b43e2

 .../streams/processor/internals/StreamThread.java  |   8 +-
 .../processor/internals/StreamThreadTest.java      | 166 +++++++++++++++++++--
 2 files changed, 155 insertions(+), 19 deletions(-)
9198467eb293435385edcef9028a59fa41a3828a

 .../examples/pageview/PageViewTypedDemo.java       |   2 +-
 .../examples/pageview/PageViewUntypedDemo.java     |   2 +-
 .../kafka/streams/examples/pipe/PipeDemo.java      |   4 +-
 .../streams/examples/wordcount/WordCountDemo.java  |   4 +-
 .../examples/wordcount/WordCountProcessorDemo.java |   4 +-
 .../org/apache/kafka/streams/KafkaStreams.java     |   4 +-
 .../org/apache/kafka/streams/StreamsConfig.java    | 117 +++++-
 .../kafka/streams/kstream/KGroupedTable.java       |   2 +-
 .../kafka/streams/kstream/KStreamBuilder.java      | 434 ++++++++++++++++++---
 .../streams/processor/TimestampExtractor.java      |   1 +
 .../kafka/streams/processor/TopologyBuilder.java   | 317 +++++++++++----
 .../processor/internals/PartitionGroup.java        |   9 +-
 .../streams/processor/internals/SourceNode.java    |  14 +-
 .../streams/processor/internals/StreamTask.java    |   8 +-
 .../apache/kafka/streams/StreamsConfigTest.java    |  16 +-
 .../streams/integration/FanoutIntegrationTest.java |   2 +-
 .../integration/GlobalKTableIntegrationTest.java   |   2 +-
 .../integration/InternalTopicIntegrationTest.java  |   8 +-
 .../streams/integration/JoinIntegrationTest.java   |   4 +-
 .../KStreamKTableJoinIntegrationTest.java          |   4 +-
 .../KTableKTableJoinIntegrationTest.java           |   4 +-
 .../integration/QueryableStateIntegrationTest.java |   4 +-
 .../streams/integration/ResetIntegrationTest.java  |   4 +-
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  54 +++
 .../kstream/internals/GlobalKTableJoinsTest.java   |   2 +-
 .../streams/kstream/internals/KStreamImplTest.java |   8 +-
 .../apache/kafka/streams/perf/SimpleBenchmark.java |   4 +-
 .../streams/processor/TopologyBuilderTest.java     |  64 ++-
 .../internals/InternalTopicManagerTest.java        |   2 +-
 .../processor/internals/PartitionGroupTest.java    |   2 +-
 .../processor/internals/ProcessorTopologyTest.java |   6 +-
 .../processor/internals/StandbyTaskTest.java       |   2 +-
 .../internals/StreamPartitionAssignorTest.java     |   2 +-
 .../processor/internals/StreamTaskTest.java        |  17 +-
 .../processor/internals/StreamThreadTest.java      |  21 +-
 .../streams/state/KeyValueStoreTestDriver.java     |   6 +-
 .../StreamThreadStateStoreProviderTest.java        |   5 +-
 .../streams/tests/BrokerCompatibilityTest.java     |   4 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   2 +-
 .../org/apache/kafka/test/StreamsTestUtils.java    |   4 +-
 40 files changed, 947 insertions(+), 228 deletions(-)
8bf70610ba818f2d8e38fd285e553994d4e0d4b2

 .../state/internals/MergedSortedCacheWindowStoreIteratorTest.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
a1c8e7d941ad9c765dac232435a297f905eeeed5

 .../kafka/clients/producer/KafkaProducer.java      |   2 +-
 .../clients/producer/internals/PidAndEpoch.java    |  36 -------
 .../clients/producer/internals/ProducerBatch.java  |   4 +-
 .../producer/internals/ProducerIdAndEpoch.java     |  36 +++++++
 .../producer/internals/RecordAccumulator.java      |  12 +--
 .../kafka/clients/producer/internals/Sender.java   |  24 ++---
 .../producer/internals/TransactionManager.java     |  64 +++++------
 .../common/errors/InvalidTxnTimeoutException.java  |   2 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   3 +-
 .../kafka/common/requests/AbstractRequest.java     |   2 +-
 .../kafka/common/requests/AbstractResponse.java    |   2 +-
 .../kafka/common/requests/InitPidRequest.java      | 104 ------------------
 .../kafka/common/requests/InitPidResponse.java     |  89 ---------------
 .../common/requests/InitProducerIdRequest.java     | 104 ++++++++++++++++++
 .../common/requests/InitProducerIdResponse.java    |  89 +++++++++++++++
 .../clients/producer/internals/SenderTest.java     |  20 ++--
 .../producer/internals/TransactionManagerTest.java |  26 ++---
 .../kafka/common/requests/RequestResponseTest.java |   8 +-
 .../transaction/ProducerIdManager.scala            | 119 +++++++++++----------
 .../transaction/TransactionCoordinator.scala       |  90 ++++++++--------
 .../TransactionMarkerChannelManager.scala          |   7 +-
 .../scala/kafka/log/ProducerStateManager.scala     |  84 +++++++--------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  29 +++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   6 +-
 .../transaction/ProducerIdManagerTest.scala        |  14 +--
 .../TransactionCoordinatorIntegrationTest.scala    |  16 +--
 .../transaction/TransactionCoordinatorTest.scala   |  50 ++++-----
 .../scala/unit/kafka/server/RequestQuotaTest.scala |   4 +-
 29 files changed, 525 insertions(+), 523 deletions(-)
1cb39f7570b8dad3e8b5c7643fb1cbbcf382bb31

 .../kafka/controller/ControllerIntegrationTest.scala  | 19 +++++++++----------
 1 file changed, 9 insertions(+), 10 deletions(-)
f21f8f2d44f97eba4ce155ac9fcc8432f00cad24

 .../main/scala/kafka/network/SocketServer.scala    | 24 ++++++++++++----------
 .../unit/kafka/network/SocketServerTest.scala      | 21 +++++++++++++++++++
 2 files changed, 34 insertions(+), 11 deletions(-)
238e739782222b17f33a3ac5a0374d8dac3be28f

 .../kafka/common/security/JaasContextTest.java      |  2 +-
 .../scala/integration/kafka/api/SaslSetup.scala     |  4 ++--
 .../kafka/security/auth/ZkAuthorizationTest.scala   |  2 +-
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala  |  2 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala  | 21 ---------------------
 5 files changed, 5 insertions(+), 26 deletions(-)
b9fc41f04b0dc964896f95e41fcf882d734e0326

 .../org/apache/kafka/streams/state/internals/RocksDBStore.java | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
b1cd3afc13070c4c50ba963520e7266f97ac52b4

 .../org/apache/kafka/streams/state/internals/RocksDBStore.java | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
767cc31a8929efbcc827a3724700090330f948e6

 .../src/main/java/org/apache/kafka/streams/StreamsConfig.java |  2 +-
 .../test/java/org/apache/kafka/streams/StreamsConfigTest.java |  9 +++++++++
 .../streams/integration/GlobalKTableIntegrationTest.java      |  1 +
 .../streams/integration/InternalTopicIntegrationTest.java     |  1 +
 .../apache/kafka/streams/integration/JoinIntegrationTest.java |  1 +
 .../integration/KStreamAggregationDedupIntegrationTest.java   |  1 +
 .../integration/KStreamAggregationIntegrationTest.java        |  1 +
 .../streams/integration/KStreamKTableJoinIntegrationTest.java |  1 +
 .../kafka/streams/integration/KStreamRepartitionJoinTest.java |  1 +
 .../KStreamsFineGrainedAutoResetIntegrationTest.java          |  1 +
 .../streams/integration/KTableKTableJoinIntegrationTest.java  |  1 +
 .../streams/integration/QueryableStateIntegrationTest.java    |  2 +-
 .../kafka/streams/integration/RegexSourceIntegrationTest.java | 11 +++++++----
 .../kafka/streams/integration/ResetIntegrationTest.java       |  1 +
 .../kafka/streams/integration/utils/IntegrationTestUtils.java |  1 +
 15 files changed, 29 insertions(+), 6 deletions(-)
05c13552f910b20aa45e221f92614cffe76c08fc

 .../AbstractMergedSortedCacheStoreIterator.java        |  2 +-
 .../MergedSortedCacheWindowStoreIteratorTest.java      | 18 ++++++++++++++++--
 2 files changed, 17 insertions(+), 3 deletions(-)
7258a5fddf3fb77480cd414819cdbfbd96b709e5

 .../apache/kafka/common/record/MemoryRecords.java  |  18 +-
 .../kafka/coordinator/group/GroupCoordinator.scala |  28 ++-
 .../kafka/coordinator/group/GroupMetadata.scala    |  63 ++++-
 .../coordinator/group/GroupMetadataManager.scala   | 209 ++++++++++++----
 core/src/main/scala/kafka/log/Log.scala            |   3 +-
 .../scala/kafka/log/ProducerStateManager.scala     |  43 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  94 ++++++-
 .../group/GroupCoordinatorResponseTest.scala       | 249 ++++++++++++++++++-
 .../group/GroupMetadataManagerTest.scala           | 276 +++++++++++++++++++++
 .../unit/kafka/log/ProducerStateManagerTest.scala  |  14 +-
 10 files changed, 906 insertions(+), 91 deletions(-)
da0b5b8596fa20836b8c80c473b3f37af96c9b96

 .../AbstractMergedSortedCacheStoreIterator.java        |  2 +-
 ...ergedSortedCacheWrappedWindowStoreIteratorTest.java | 18 ++++++++++++++++--
 2 files changed, 17 insertions(+), 3 deletions(-)
794e6dbd14f040d21d3402c5eda22cfa8f5c4b3d

 .../common/requests/WriteTxnMarkersResponse.java   |   2 +
 .../scala/kafka/common/InterBrokerSendThread.scala |   3 +
 .../transaction/TransactionCoordinator.scala       | 525 +++++++++++----------
 .../coordinator/transaction/TransactionLog.scala   |  14 +-
 .../transaction/TransactionMarkerChannel.scala     | 186 --------
 .../TransactionMarkerChannelManager.scala          | 243 ++++++++--
 ...TransactionMarkerRequestCompletionHandler.scala | 130 +++--
 .../transaction/TransactionMetadata.scala          | 200 ++++++--
 .../transaction/TransactionStateManager.scala      | 385 +++++++--------
 .../main/scala/kafka/server/DelayedOperation.scala |   3 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   8 +-
 .../main/scala/kafka/server/MetadataCache.scala    |  18 +
 .../main/scala/kafka/server/ReplicaManager.scala   |   6 +-
 .../TransactionCoordinatorIntegrationTest.scala    |   6 +
 .../transaction/TransactionCoordinatorTest.scala   | 380 ++++++---------
 .../transaction/TransactionLogTest.scala           |   8 +-
 .../TransactionMarkerChannelManagerTest.scala      | 304 +++++-------
 .../transaction/TransactionMarkerChannelTest.scala | 179 -------
 ...sactionMarkerRequestCompletionHandlerTest.scala | 195 ++++++--
 .../transaction/TransactionStateManagerTest.scala  | 139 +++---
 20 files changed, 1430 insertions(+), 1504 deletions(-)
7baa58d797126b6fb2b1de30e72428895d2bcb40

 .../kafka/clients/consumer/internals/Fetcher.java  |  38 ++-
 .../apache/kafka/common/record/MemoryRecords.java  |  51 +++-
 .../clients/consumer/internals/FetcherTest.java    | 189 +++++++++++---
 .../common/record/MemoryRecordsBuilderTest.java    |   4 +-
 .../kafka/common/record/MemoryRecordsTest.java     |  57 ++++-
 core/src/main/scala/kafka/log/Log.scala            |  30 ++-
 core/src/main/scala/kafka/log/LogCleaner.scala     | 257 ++++++++++++++-----
 .../main/scala/kafka/log/LogCleanerManager.scala   |  29 ++-
 core/src/main/scala/kafka/log/OffsetMap.scala      |   5 +
 .../scala/kafka/log/ProducerStateManager.scala     |   2 +-
 .../main/scala/kafka/log/TransactionIndex.scala    |  13 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |  48 ++++
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 280 ++++++++++++++++++---
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  26 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  21 +-
 .../unit/kafka/log/TransactionIndexTest.scala      |  11 +-
 16 files changed, 840 insertions(+), 221 deletions(-)
1c2bbaa501c2d0fd4db9c2dacacc3ff7f5236d3d

 .../kafka/clients/consumer/KafkaConsumer.java      | 10 +++--
 .../kafka/clients/producer/KafkaProducer.java      |  8 ++--
 .../kafka/clients/producer/ProducerConfig.java     | 18 ++++++++-
 .../org/apache/kafka/common/network/Selector.java  | 20 +++++-----
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 15 +++++++
 .../kafka/clients/producer/KafkaProducerTest.java  | 46 +++++++++++++++-------
 6 files changed, 84 insertions(+), 33 deletions(-)
4951849163b1defea91129472b5354531407deb9

 .../transaction/TransactionCoordinator.scala       | 43 +++++++++++++-
 .../transaction/TransactionMarkerChannel.scala     |  3 +-
 .../TransactionMarkerChannelManager.scala          |  2 +-
 .../transaction/TransactionMetadata.scala          |  4 +-
 .../transaction/TransactionStateManager.scala      | 25 ++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  6 ++
 .../transaction/TransactionCoordinatorTest.scala   | 66 ++++++++++++++++++++++
 .../transaction/TransactionStateManagerTest.scala  | 32 +++++++++++
 8 files changed, 170 insertions(+), 11 deletions(-)
766dea94e477a2f84afc57c4d3091ec1688c35c5

 core/src/test/scala/unit/kafka/metrics/MetricsTest.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
e2fafddbbf335a96e828b00c6ace0a0921803ad3

 config/server.properties                           | 4 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)
d96866243990a4d739ec8fc239f0c2758bba66e8

 core/src/main/scala/kafka/server/KafkaApis.scala   |  3 +-
 .../scala/kafka/server/KafkaRequestHandler.scala   | 31 ++++++++++++
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  1 +
 .../scala/unit/kafka/metrics/MetricsTest.scala     | 56 ++++++++++++++++++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 25 +++++++++-
 5 files changed, 102 insertions(+), 14 deletions(-)
29214d33634ef613618ef7ad32ad08eae9f83a40

 .../kafka/clients/consumer/ConsumerConfig.java     | 18 +++++-
 .../kafka/clients/consumer/KafkaConsumer.java      | 31 +++++-----
 .../consumer/internals/AbstractCoordinator.java    |  9 ++-
 .../consumer/internals/ConsumerCoordinator.java    | 20 ++++---
 .../org/apache/kafka/common/config/ConfigDef.java  | 35 +++++++++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  3 +-
 .../internals/AbstractCoordinatorTest.java         |  2 +-
 .../internals/ConsumerCoordinatorTest.java         | 69 ++++++++++++----------
 .../apache/kafka/common/config/ConfigDefTest.java  | 22 +++++++
 .../runtime/distributed/WorkerCoordinator.java     | 17 +++---
 10 files changed, 153 insertions(+), 73 deletions(-)
9eb0cdb546a6ec7792cce12a0ceb6cd30afc88ad

 .../streams/processor/internals/AbstractTask.java  |  19 +-
 .../processor/internals/Checkpointable.java        |  27 +++
 .../internals/GlobalStateManagerImpl.java          |  16 +-
 .../processor/internals/GlobalStateUpdateTask.java |   3 +-
 .../processor/internals/ProcessorStateManager.java |  58 +++---
 .../streams/processor/internals/StandbyTask.java   |  23 +--
 .../streams/processor/internals/StateManager.java  |   4 +-
 .../streams/processor/internals/StreamTask.java    |   5 +-
 .../state/internals/InMemoryKeyValueStore.java     | 187 +++++++++++++++++++
 .../processor/internals/AbstractTaskTest.java      |   1 +
 .../internals/GlobalStateManagerImplTest.java      |  49 ++++-
 .../processor/internals/GlobalStateTaskTest.java   |  16 +-
 .../internals/ProcessorStateManagerTest.java       | 198 ++++++++++++++-------
 .../processor/internals/StandbyTaskTest.java       |  49 ++++-
 .../processor/internals/StreamTaskTest.java        |  63 +++++++
 .../apache/kafka/test/GlobalStateManagerStub.java  |   7 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   3 +-
 17 files changed, 588 insertions(+), 140 deletions(-)
911c768bcc3ba950d63536ce4e6ba2542542d573

 .../kafka/clients/consumer/internals/Fetcher.java  | 35 +++++++++++++++-------
 .../clients/consumer/internals/FetcherTest.java    | 22 +++++++++++---
 2 files changed, 43 insertions(+), 14 deletions(-)
12aa70d55bc422226255ab18e69e4bc6f24be2d9

 .../kafka/api/ProducerCompressionTest.scala        |   5 +-
 ...ListenersWithSameSecurityProtocolBaseTest.scala |   7 +-
 .../ReplicaFetcherThreadFatalErrorTest.scala       |   2 +-
 .../other/kafka/ReplicationQuotasTestRig.scala     |   5 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |   5 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 209 ++++++++++-----------
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  43 ++---
 .../admin/ReassignPartitionsClusterTest.scala      |   5 +-
 .../controller/ControllerIntegrationTest.scala     |   5 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   3 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |  20 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |   5 +-
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |   7 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   5 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   3 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |   6 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   3 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |   2 +-
 .../unit/kafka/server/ReplicationQuotasTest.scala  |   9 +-
 .../kafka/server/ServerGenerateBrokerIdTest.scala  |  78 ++++----
 .../kafka/server/ServerGenerateClusterIdTest.scala |  44 ++---
 .../unit/kafka/server/ServerStartupTest.scala      |  39 ++--
 ...chDrivenReplicationProtocolAcceptanceTest.scala |   2 +-
 .../server/epoch/LeaderEpochIntegrationTest.scala  |  15 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  17 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  20 ++
 26 files changed, 265 insertions(+), 299 deletions(-)
b6effcbba50eaa3abf91e24f0ae83abb53881add

 .../kafka/connect/runtime/PluginDiscovery.java     |   4 +-
 .../runtime/rest/entities/ConnectorPluginInfo.java |  77 +++++++++++--
 .../runtime/rest/entities/ConnectorType.java       |  52 +++++++++
 .../runtime/rest/entities/ConnectorTypeTest.java   |  44 +++++++
 .../resources/ConnectorPluginsResourceTest.java    | 126 +++++++++++++++++++--
 5 files changed, 283 insertions(+), 20 deletions(-)
27107ee34d1df89035eb9b9b4e11036fca6cf723

 .../org/apache/kafka/common/requests/JoinGroupRequest.java    |  3 ++-
 .../org/apache/kafka/common/requests/RequestResponseTest.java | 11 +++++++++--
 2 files changed, 11 insertions(+), 3 deletions(-)
24a4e6146a83c3ce188f6ee2f56d763a58b88b8b

 .../scala/kafka/coordinator/transaction/TransactionStateManager.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
3085d4f435bba74fc9aa077e23a4da3475b4d2ec

 .../scala/kafka/common/InterBrokerSendThread.scala     |  5 +++--
 .../transaction/TransactionCoordinator.scala           |  1 +
 .../src/main/scala/kafka/server/DelayedOperation.scala |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala     | 18 ++++++++++--------
 core/src/main/scala/kafka/server/ReplicaManager.scala  |  1 +
 5 files changed, 16 insertions(+), 11 deletions(-)
bcf447e93ec15c70156d5a17bd1c7c28b7188e43

 README.md                       |  8 +++---
 bin/kafka-run-class.sh          |  2 +-
 bin/windows/kafka-run-class.bat |  2 +-
 build.gradle                    | 56 +++++++++++++++++++++--------------------
 docs/quickstart.html            |  2 +-
 gradle.properties               |  2 +-
 gradle/dependencies.gradle      | 45 +++++++++++++++++----------------
 tests/docker/Dockerfile         |  7 +++---
 vagrant/base.sh                 | 14 ++++++-----
 9 files changed, 74 insertions(+), 64 deletions(-)
970c00eab80d82b97456e276ee0f5615cb1ccfa1

 .../apache/kafka/common/record/MemoryRecordsBuilder.java  |  2 +-
 .../clients/producer/internals/ProducerBatchTest.java     | 15 +++++++++++++++
 2 files changed, 16 insertions(+), 1 deletion(-)
0bede30ada6d5719950ad35a69c586f0ba9c4f7e

 core/src/main/scala/kafka/cluster/Broker.scala     |   4 +-
 .../integration/kafka/api/BaseQuotaTest.scala      |   8 +-
 .../kafka/api/IntegrationTestHarness.scala         |   1 -
 .../api/KafkaAdminClientIntegrationTest.scala      |   3 +-
 .../kafka/api/SaslEndToEndAuthorizationTest.scala  |  15 +-
 .../kafka/api/SaslMultiMechanismConsumerTest.scala |  26 +-
 .../kafka/api/SaslPlainPlaintextConsumerTest.scala |  24 +-
 .../kafka/api/SaslPlaintextConsumerTest.scala      |  18 +-
 .../scala/integration/kafka/api/SaslSetup.scala    |  70 ++---
 .../api/SaslSslAdminClientIntegrationTest.scala    |  17 +-
 .../kafka/api/SaslSslConsumerTest.scala            |  17 +-
 .../integration/kafka/api/SaslTestHarness.scala    |  39 ---
 .../kafka/api/SslEndToEndAuthorizationTest.scala   |   2 +-
 .../integration/kafka/api/UserQuotaTest.scala      |  18 +-
 ...pleListenersWithAdditionalJaasContextTest.scala |  28 +-
 ...ltipleListenersWithDefaultJaasContextTest.scala |  14 +-
 ...ListenersWithSameSecurityProtocolBaseTest.scala |  40 +--
 .../scala/kafka/security/minikdc/MiniKdc.scala     |  20 +-
 .../TransactionCoordinatorIntegrationTest.scala    |   4 +-
 .../kafka/integration/BaseTopicMetadataTest.scala  | 304 ---------------------
 .../integration/PlaintextTopicMetadataTest.scala   |  26 --
 .../SaslPlaintextTopicMetadataTest.scala           |  27 --
 .../integration/SaslSslTopicMetadataTest.scala     |  29 --
 .../kafka/integration/SslTopicMetadataTest.scala   |  27 --
 .../unit/kafka/integration/TopicMetadataTest.scala | 298 ++++++++++++++++++++
 .../kafka/security/auth/ZkAuthorizationTest.scala  |   2 +-
 .../unit/kafka/server/BaseReplicaFetchTest.scala   |  88 ------
 .../kafka/server/PlaintextReplicaFetchTest.scala   |  25 --
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  83 ++++++
 .../kafka/server/SaslApiVersionsRequestTest.scala  |  28 +-
 .../server/SaslPlaintextReplicaFetchTest.scala     |  27 --
 .../kafka/server/SaslSslReplicaFetchTest.scala     |  29 --
 .../unit/kafka/server/SslReplicaFetchTest.scala    |  27 --
 .../scala/unit/kafka/utils/JaasTestUtils.scala     | 114 ++++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   8 +-
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |   7 +-
 36 files changed, 670 insertions(+), 847 deletions(-)
a420d20c0e3da2c9637820f7d1a344706fd835fa

 core/src/main/scala/kafka/log/Log.scala            | 10 ++++----
 .../kafka/server/epoch/LeaderEpochFileCache.scala  | 17 ++++++++----
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  1 -
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  2 +-
 .../server/epoch/LeaderEpochFileCacheTest.scala    | 30 +++++++++++-----------
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 19 ++++++++++++++
 6 files changed, 52 insertions(+), 27 deletions(-)
0eedd6d806ffc2f8e1e2a704d831bc5ac865ce3e

 .gitignore |   2 +
 release.py | 473 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 475 insertions(+)
7371bf7f65d1245b084f17e534b5728d5929e207

 .../streams/integration/ResetIntegrationTest.java  | 21 ++++++++--------
 .../integration/utils/EmbeddedKafkaCluster.java    | 28 ++++++++++++++++++----
 2 files changed, 33 insertions(+), 16 deletions(-)
b982eefd37595b30600b7a979915db5da22271fe

 .../kafka/streams/kstream/KStreamBuilderTest.java  | 53 +++++++++++++++++++---
 .../org/apache/kafka/test/KStreamTestDriver.java   | 45 ++++++++++--------
 2 files changed, 72 insertions(+), 26 deletions(-)
bce189fa451141df9f5b1c86a307a321caeaf807

 tests/kafkatest/services/connect.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8ace736f7121161518953b4ce2a03f36a8306e18

 tests/kafkatest/services/connect.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c69842336d87cc321a58171c517c46cdddfe1a64

 .../kafka/clients/producer/MockProducer.java       | 164 +++++++-
 .../kafka/clients/producer/MockProducerTest.java   | 468 ++++++++++++++++++++-
 2 files changed, 592 insertions(+), 40 deletions(-)
5b36adde4f158d9d3b47bb98123a0bcca8028288

 .../kafka/streams/integration/QueryableStateIntegrationTest.java  | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
78ace3725151dc056e83a8ec389141fc8809d4c0

 .../clients/admin/DescribeClusterResults.java      | 30 +++++++++++++++++++---
 .../kafka/clients/admin/KafkaAdminClient.java      |  9 ++++++-
 .../api/KafkaAdminClientIntegrationTest.scala      |  8 +++++-
 3 files changed, 41 insertions(+), 6 deletions(-)
59b918ec2be5ec69fd5b62613e7665510f5217c0

 .../apache/kafka/clients/CommonClientConfigs.java  |  5 --
 .../main/java/org/apache/kafka/common/Cluster.java | 14 -----
 .../java/org/apache/kafka/common/MetricName.java   | 64 ----------------------
 docs/upgrade.html                                  |  1 +
 4 files changed, 1 insertion(+), 83 deletions(-)
3bcadbfb474f6caccc939fb3775a6f969d136af7

 .../kafka/clients/producer/KafkaProducer.java      | 45 +---------------------
 .../kafka/clients/producer/ProducerConfig.java     | 43 ---------------------
 docs/upgrade.html                                  |  2 +
 3 files changed, 4 insertions(+), 86 deletions(-)
0e8b0847749d78815c1ec3a066a82a1f5e2e4165

 .../org/apache/kafka/streams/state/internals/RocksDBStore.java | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
2554a8dd4dd07b0ac844839b51533bd1e67eed85

 .../consumer/NoOffsetForPartitionException.java    | 25 ++++++++++++++++++----
 .../kafka/clients/consumer/internals/Fetcher.java  | 22 ++++++++++++-------
 .../clients/consumer/internals/FetcherTest.java    | 15 +++++++++++++
 3 files changed, 50 insertions(+), 12 deletions(-)
257ad524d305bd052feb8bf81d6736f74a19983f

 .../org/apache/kafka/streams/state/internals/RocksDBStore.java | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
e472ee7b613dbcab2ba1f5b6b384fa713f3906d0

 .../state/internals/CachingSessionStore.java       | 12 ++++++-----
 .../state/internals/CachingSessionStoreTest.java   | 25 ++++++++++++++++++++++
 2 files changed, 32 insertions(+), 5 deletions(-)
e71dce89c0da50f3eccc47d0fc050c92d5a99b88

 .../kafka/clients/consumer/internals/Fetcher.java  |  79 +--
 .../TransactionCoordinatorFencedException.java     |  30 +
 .../org/apache/kafka/common/protocol/Errors.java   |  17 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  17 +-
 .../common/record/AbstractLegacyRecordBatch.java   |   2 +-
 .../kafka/common/record/AbstractRecords.java       |   9 +-
 .../kafka/common/record/ControlRecordType.java     |  24 +-
 .../apache/kafka/common/record/DefaultRecord.java  |  50 +-
 .../kafka/common/record/DefaultRecordBatch.java    |  22 +-
 .../kafka/common/record/EndTransactionMarker.java  | 124 +++++
 .../kafka/common/record/FileLogInputStream.java    |   6 +
 .../apache/kafka/common/record/FileRecords.java    |  13 +-
 .../apache/kafka/common/record/MemoryRecords.java  | 109 +++-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  66 ++-
 .../org/apache/kafka/common/record/Record.java     |   9 -
 .../apache/kafka/common/record/RecordBatch.java    |   8 +
 .../kafka/common/requests/ListOffsetRequest.java   |  34 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |   5 +
 .../clients/consumer/internals/FetcherTest.java    |  97 ++--
 .../common/record/DefaultRecordBatchTest.java      |  31 +-
 .../kafka/common/record/DefaultRecordTest.java     |  45 +-
 .../common/record/EndTransactionMarkerTest.java    |  70 +++
 .../kafka/common/record/FileRecordsTest.java       |  11 +-
 .../common/record/MemoryRecordsBuilderTest.java    |  93 +++-
 .../kafka/common/record/MemoryRecordsTest.java     |  80 ++-
 .../kafka/common/requests/RequestResponseTest.java |  22 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |   4 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |  23 +-
 .../coordinator/group/GroupMetadataManager.scala   |  27 +-
 .../transaction/TransactionStateManager.scala      |  19 +-
 core/src/main/scala/kafka/log/AbstractIndex.scala  |  23 +-
 core/src/main/scala/kafka/log/Log.scala            | 611 ++++++++++++++-------
 core/src/main/scala/kafka/log/LogCleaner.scala     |  34 +-
 core/src/main/scala/kafka/log/LogManager.scala     |   6 +-
 core/src/main/scala/kafka/log/LogSegment.scala     | 132 +++--
 core/src/main/scala/kafka/log/LogValidator.scala   |  83 +--
 core/src/main/scala/kafka/log/OffsetIndex.scala    |  20 +-
 .../main/scala/kafka/log/ProducerIdMapping.scala   | 384 -------------
 .../scala/kafka/log/ProducerStateManager.scala     | 590 ++++++++++++++++++++
 core/src/main/scala/kafka/log/TimeIndex.scala      |   7 +-
 .../main/scala/kafka/log/TransactionIndex.scala    | 243 ++++++++
 .../src/main/scala/kafka/server/DelayedFetch.scala |  14 +-
 .../main/scala/kafka/server/FetchDataInfo.scala    |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  67 ++-
 .../scala/kafka/server/LogOffsetMetadata.scala     |   8 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  31 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  29 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |   2 +-
 .../group/GroupCoordinatorResponseTest.scala       |   6 +-
 .../group/GroupMetadataManagerTest.scala           |  22 +-
 .../transaction/TransactionStateManagerTest.scala  |   7 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   2 +-
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |   3 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   5 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 104 +++-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 555 ++++++++++++++++---
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 209 +++++--
 .../scala/unit/kafka/log/OffsetIndexTest.scala     |  24 +-
 .../unit/kafka/log/ProducerIdMappingTest.scala     | 291 ----------
 .../unit/kafka/log/ProducerStateManagerTest.scala  | 562 +++++++++++++++++++
 .../unit/kafka/log/TransactionIndexTest.scala      | 173 ++++++
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  12 +-
 .../kafka/server/ReplicaManagerQuotasTest.scala    |   7 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 151 ++++-
 .../scala/unit/kafka/server/RequestQuotaTest.scala |   7 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   7 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   2 +-
 69 files changed, 4099 insertions(+), 1488 deletions(-)
29994dd10de5c58166e7aa248beab78cab3c9b86

 bin/windows/kafka-broker-api-versions.bat | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
715eae6da92d5d1db7ac65e3c8ff753e15b5c0ca

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java   |  2 ++
 .../apache/kafka/clients/consumer/KafkaConsumerTest.java   | 14 ++++++++++----
 .../apache/kafka/clients/producer/KafkaProducerTest.java   |  9 +++++++++
 3 files changed, 21 insertions(+), 4 deletions(-)
05ea454dfb1c68e9026b74fe443279e3a4bc5182

 .../kafka/api/KafkaAdminClientIntegrationTest.scala       |  8 +++++++-
 core/src/test/scala/unit/kafka/utils/TestUtils.scala      | 15 ++++++++++++++-
 2 files changed, 21 insertions(+), 2 deletions(-)
95b48b157aca44beec4335e62a59f37097fe7499

 .../main/scala/kafka/admin/ReassignPartitionsCommand.scala    |  8 +++++++-
 .../unit/kafka/admin/ReassignPartitionsClusterTest.scala      | 11 +++++++++++
 2 files changed, 18 insertions(+), 1 deletion(-)
2448343edd0ea2e1f1a4cdc325d361913e48ff14

 core/src/main/scala/kafka/server/KafkaServer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
124ddf5779b845cb220f622d3b4233e586db4888

 docs/api.html | 35 +++++++++++++++++++++++++----------
 1 file changed, 25 insertions(+), 10 deletions(-)
8c872762f7ef47a4a2d2c7d49993cedacd50d8b4

 gradle/findbugs-exclude.xml                                       | 7 -------
 .../java/org/apache/kafka/streams/state/internals/Segments.java   | 8 ++++----
 2 files changed, 4 insertions(+), 11 deletions(-)
1816e29981b0e9df67d416c8cfccc4f2ee1241fa

 .../scala/integration/kafka/api/ConsumerBounceTest.scala  |  3 ++-
 .../scala/integration/kafka/api/ProducerBounceTest.scala  | 15 +++------------
 .../unit/kafka/controller/ControllerFailoverTest.scala    |  9 ++-------
 3 files changed, 7 insertions(+), 20 deletions(-)
41fead3acf6b70f829eb61688d31b0914adedadc

 core/src/main/scala/kafka/log/AbstractIndex.scala     | 12 ++++++++----
 core/src/main/scala/kafka/log/OffsetIndex.scala       |  4 ++--
 core/src/main/scala/kafka/log/TimeIndex.scala         |  5 +++--
 core/src/main/scala/kafka/tools/DumpLogSegments.scala |  6 +++---
 4 files changed, 16 insertions(+), 11 deletions(-)
a6728f6ee7a87da2859baca95b50e00dd6368431

 core/src/main/scala/kafka/log/Log.scala          |  5 ++++-
 core/src/test/scala/unit/kafka/log/LogTest.scala | 19 +++++++++++++++++++
 2 files changed, 23 insertions(+), 1 deletion(-)
ed59f742b0b2c7920444d56c44d0bc79dbc8a2ad

 .../org/apache/kafka/common/protocol/Protocol.java |   2 +-
 .../kafka/coordinator/group/DelayedJoin.scala      |  41 +++++++-
 .../kafka/coordinator/group/GroupCoordinator.scala |  31 ++++--
 .../kafka/coordinator/group/GroupMetadata.scala    |   1 +
 core/src/main/scala/kafka/server/KafkaConfig.scala |   5 +
 .../integration/kafka/api/BaseConsumerTest.scala   |   1 +
 .../integration/kafka/api/BaseQuotaTest.scala      |   1 +
 .../integration/kafka/api/ConsumerBounceTest.scala |   1 +
 .../kafka/api/LegacyAdminClientTest.scala          |   1 +
 .../group/GroupCoordinatorResponseTest.scala       | 104 ++++++++++++++++++---
 .../coordinator/group/GroupMetadataTest.scala      |  15 ++-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   1 +
 .../integration/utils/EmbeddedKafkaCluster.java    |   1 +
 13 files changed, 183 insertions(+), 22 deletions(-)
24e6423424bf0e41dc05c4a67226e92011e34968

 .../integration/RegexSourceIntegrationTest.java    | 29 ++++++++++++++--------
 1 file changed, 18 insertions(+), 11 deletions(-)
ec9e4eafa406fec897713310bafdedf6bbb3c0c5

 .../kafka/streams/kstream/KGroupedStream.java      |  552 ++++++++--
 .../kafka/streams/kstream/KGroupedTable.java       |  323 +++++-
 .../kafka/streams/kstream/KStreamBuilder.java      |  479 +++++++--
 .../org/apache/kafka/streams/kstream/KTable.java   | 1094 ++++++++++++++++++--
 .../streams/kstream/internals/AbstractStream.java  |    7 +
 .../kstream/internals/KGroupedStreamImpl.java      |  128 ++-
 .../kstream/internals/KGroupedTableImpl.java       |  113 +-
 .../streams/kstream/internals/KStreamImpl.java     |    2 +-
 .../streams/kstream/internals/KTableFilter.java    |   26 +-
 .../streams/kstream/internals/KTableImpl.java      |  326 +++++-
 .../kstream/internals/KTableKTableJoinMerger.java  |   35 +-
 .../streams/kstream/internals/KTableMapValues.java |   27 +-
 .../kafka/streams/processor/TopologyBuilder.java   |   20 +-
 .../KStreamAggregationIntegrationTest.java         |   28 +-
 .../KTableKTableJoinIntegrationTest.java           |  155 ++-
 .../integration/QueryableStateIntegrationTest.java |  178 ++++
 .../kafka/streams/kstream/KStreamBuilderTest.java  |   55 +-
 .../kstream/internals/KGroupedStreamImplTest.java  |  279 +++--
 .../kstream/internals/KGroupedTableImplTest.java   |   72 +-
 .../kstream/internals/KTableAggregateTest.java     |   55 +-
 .../kstream/internals/KTableFilterTest.java        |  245 ++++-
 .../streams/kstream/internals/KTableImplTest.java  |   32 +-
 .../kstream/internals/KTableKTableJoinTest.java    |  162 +--
 .../kstream/internals/KTableMapValuesTest.java     |  128 ++-
 .../streams/processor/TopologyBuilderTest.java     |    2 +-
 .../processor/internals/ProcessorTopologyTest.java |    4 +-
 26 files changed, 3793 insertions(+), 734 deletions(-)
a3952aee49c5eb11cd38c1bc2fb95e9a285ff158

 .../java/org/apache/kafka/streams/processor/internals/StreamTask.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
bc65c62e661c2829a30ad6b08fc9fa34303ad386

 .../processor/internals/MinTimestampTracker.java   | 28 ++++++++++++----------
 1 file changed, 16 insertions(+), 12 deletions(-)
cfb2386743cc1981d7eb5c042ae8cbad70f99370

 core/src/main/scala/kafka/server/KafkaApis.scala | 46 ++++++++++++++----------
 1 file changed, 27 insertions(+), 19 deletions(-)
a7671c7f3723113e716b99471e7be3499fde1b15

 .../kafka/api/SaslEndToEndAuthorizationTest.scala  |   2 +-
 .../scala/integration/kafka/api/SaslSetup.scala    |  47 ++++--
 ...pleListenersWithAdditionalJaasContextTest.scala |  47 ++++++
 ...ltipleListenersWithDefaultJaasContextTest.scala |  37 +++++
 ...ListenersWithSameSecurityProtocolBaseTest.scala | 158 +++++++++++++++++++++
 ...ipleListenersWithSameSecurityProtocolTest.scala | 132 -----------------
 .../kafka/security/auth/ZkAuthorizationTest.scala  |   2 +-
 .../scala/unit/kafka/utils/JaasTestUtils.scala     |  32 +----
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |   2 +-
 9 files changed, 283 insertions(+), 176 deletions(-)
8d749201632618e66fbc7077d730e5fac5e157a5

 bin/kafka-run-class.sh | 2 +-
 docs/upgrade.html      | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)
4a6bbd5f1386562262193b5054b44894a196997b

 .../consumer/ZookeeperConsumerConnector.scala      |  2 +-
 .../kafka/coordinator/group/DelayedHeartbeat.scala |  2 +-
 .../kafka/coordinator/group/DelayedJoin.scala      |  2 +-
 .../coordinator/group/GroupMetadataManager.scala   |  6 ++--
 .../TransactionMarkerChannelManager.scala          |  5 +---
 .../transaction/TransactionStateManager.scala      |  4 +--
 core/src/main/scala/kafka/log/Log.scala            |  2 +-
 core/src/main/scala/kafka/log/LogManager.scala     | 16 +++++-----
 .../main/scala/kafka/server/ReplicaManager.scala   |  8 ++---
 .../unit/kafka/server/BaseReplicaFetchTest.scala   |  2 +-
 .../scala/unit/kafka/utils/SchedulerTest.scala     | 34 +++++++++++-----------
 11 files changed, 40 insertions(+), 43 deletions(-)
f60009b14dae33168009290e549e4e9544595685

 .../src/main/java/org/apache/kafka/common/KafkaFuture.java   |  9 +++++++--
 .../test/java/org/apache/kafka/common/KafkaFutureTest.java   | 12 ++++++++++++
 2 files changed, 19 insertions(+), 2 deletions(-)
0e7cc4aa384372d1e08d7bd444b5e23510f447d9

 .../apache/kafka/common/requests/FetchRequest.java   |  4 ++--
 .../clients/consumer/internals/FetcherTest.java      |  9 ++++++++-
 .../kafka/common/requests/RequestResponseTest.java   | 20 ++++++++++++++++++++
 3 files changed, 30 insertions(+), 3 deletions(-)
619fd7aeb62b2c1a68938a341ff81f728fc60090

 .../transaction/TransactionCoordinator.scala       | 112 +++++++++++----------
 .../transaction/TransactionStateManager.scala      |  24 +++--
 .../TransactionMarkerChannelManagerTest.scala      |   2 +-
 .../transaction/TransactionStateManagerTest.scala  |  33 +++++-
 4 files changed, 110 insertions(+), 61 deletions(-)
b2fcf73b68d7ad3b0b4fb90371298e7163c630c6

 .../scala/kafka/controller/KafkaController.scala   | 60 ++++++++--------------
 .../kafka/controller/TopicDeletionManager.scala    | 39 +++++++-------
 2 files changed, 42 insertions(+), 57 deletions(-)
46da01a4a7d12243a7f8b1d5a51f7815a9162320

 core/src/main/scala/kafka/server/KafkaConfig.scala |  2 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  1 +
 .../integration/UncleanLeaderElectionTest.scala    | 27 +++++++++++-----------
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     | 11 +++++----
 docs/upgrade.html                                  |  2 ++
 6 files changed, 25 insertions(+), 20 deletions(-)
64ea193ceee931ee42c3fce27341980ee7c50d15

 .../kafka/clients/admin/DescribeTopicsResults.java  |  4 ++--
 .../kafka/clients/admin/KafkaAdminClient.java       |  3 ++-
 .../kafka/api/KafkaAdminClientIntegrationTest.scala | 21 +++++++++------------
 3 files changed, 13 insertions(+), 15 deletions(-)
94a35fd93684ea5713777c6b4e1631642de5f377

 core/src/test/scala/unit/kafka/server/RequestQuotaTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
324b475eca48502fb16c8efd0de99756f68437bf

 .../org/apache/kafka/common/protocol/Protocol.java |  8 +-
 .../common/requests/WriteTxnMarkersRequest.java    | 46 +++++-----
 .../kafka/common/requests/RequestResponseTest.java |  6 +-
 .../transaction/TransactionMarkerChannel.scala     | 97 +++++++++++++---------
 .../TransactionMarkerChannelManager.scala          | 19 ++---
 ...TransactionMarkerRequestCompletionHandler.scala | 19 +++--
 .../TransactionMarkerChannelManagerTest.scala      | 45 +++++-----
 .../transaction/TransactionMarkerChannelTest.scala | 38 ++++-----
 ...sactionMarkerRequestCompletionHandlerTest.scala | 19 ++---
 9 files changed, 149 insertions(+), 148 deletions(-)
67f1f4d270c279480cea5e6120ca157637910cba

 .../kafka/clients/producer/KafkaProducer.java      |  18 +-
 .../internals/FutureTransactionalResult.java       |  64 --
 .../clients/producer/internals/PidAndEpoch.java    |  36 ++
 .../clients/producer/internals/ProducerBatch.java  |   2 +-
 .../producer/internals/RecordAccumulator.java      |   2 +-
 .../kafka/clients/producer/internals/Sender.java   |  48 +-
 .../producer/internals/TransactionManager.java     | 651 ++++++++++-----------
 .../internals/TransactionalRequestResult.java      |  15 +-
 .../common/requests/AddOffsetsToTxnRequest.java    |   4 +
 .../common/requests/FindCoordinatorRequest.java    |   8 +
 .../common/requests/TxnOffsetCommitRequest.java    |   4 +
 .../clients/producer/internals/SenderTest.java     |   8 +-
 .../producer/internals/TransactionManagerTest.java |  45 +-
 13 files changed, 443 insertions(+), 462 deletions(-)
1f2451d4e7e3766540d3650d177e304fcddf49b8

 .../coordinator/transaction/DelayedTxnMarker.scala |  4 +-
 .../transaction/TransactionCoordinator.scala       | 79 +++++++------------
 .../transaction/TransactionMetadata.scala          |  3 +-
 .../transaction/TransactionCoordinatorTest.scala   | 91 ++++++++--------------
 4 files changed, 64 insertions(+), 113 deletions(-)
4aed28d1897c6c5293f372cb4fc44ab363dfc365

 checkstyle/import-control.xml                      |    5 +
 checkstyle/suppressions.xml                        |    4 +-
 .../java/org/apache/kafka/clients/Metadata.java    |    4 +-
 .../apache/kafka/clients/admin/AdminClient.java    |  186 ++++
 .../kafka/clients/admin/AdminClientConfig.java     |  163 +++
 .../kafka/clients/admin/ApiVersionsOptions.java    |   37 +
 .../kafka/clients/admin/ApiVersionsResults.java    |   63 ++
 .../kafka/clients/admin/CreateTopicResults.java    |   49 +
 .../kafka/clients/admin/CreateTopicsOptions.java   |   47 +
 .../kafka/clients/admin/DeleteTopicResults.java    |   50 +
 .../kafka/clients/admin/DeleteTopicsOptions.java   |   37 +
 .../clients/admin/DescribeClusterOptions.java      |   37 +
 .../clients/admin/DescribeClusterResults.java      |   43 +
 .../kafka/clients/admin/DescribeTopicsOptions.java |   37 +
 .../kafka/clients/admin/DescribeTopicsResults.java |   68 ++
 .../kafka/clients/admin/KafkaAdminClient.java      | 1065 ++++++++++++++++++++
 .../kafka/clients/admin/ListTopicsOptions.java     |   54 +
 .../kafka/clients/admin/ListTopicsResults.java     |   67 ++
 .../org/apache/kafka/clients/admin/NewTopic.java   |   85 ++
 .../kafka/clients/admin/TopicDescription.java      |   56 +
 .../apache/kafka/clients/admin/TopicListing.java   |   44 +
 .../kafka/clients/admin/TopicPartitionInfo.java    |   58 ++
 .../main/java/org/apache/kafka/common/Cluster.java |   33 +-
 .../java/org/apache/kafka/common/KafkaFuture.java  |  155 +++
 .../kafka/common/internals/KafkaFutureImpl.java    |  264 +++++
 .../kafka/common/network/ChannelBuilder.java       |    2 +-
 .../org/apache/kafka/common/network/Selector.java  |    2 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  507 ++++++++--
 .../common/requests/CreateTopicsResponse.java      |    5 +
 .../kafka/common/requests/MetadataResponse.java    |    3 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |    2 +-
 .../kafka/clients/admin/KafkaAdminClientTest.java  |  206 ++++
 .../org/apache/kafka/common/KafkaFutureTest.java   |  164 +++
 core/src/main/scala/kafka/admin/AdminClient.scala  |    5 +
 .../integration/kafka/api/AdminClientTest.scala    |  263 -----
 .../api/KafkaAdminClientIntegrationTest.scala      |  162 +++
 .../kafka/api/LegacyAdminClientTest.scala          |  266 +++++
 .../api/SaslSslAdminClientIntegrationTest.scala    |   26 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |    3 +
 39 files changed, 3943 insertions(+), 384 deletions(-)
c96656efb3718f8b2badc30e56c7f179c0658de8

 .../main/scala/kafka/admin/ReassignPartitionsCommand.scala    |  3 +++
 .../unit/kafka/admin/ReassignPartitionsClusterTest.scala      | 11 +++++++++++
 2 files changed, 14 insertions(+)
0104b657a154fb15e716d872a0e6084f9da650bf

 .../org/apache/kafka/clients/NetworkClient.java    |  30 +-
 .../org/apache/kafka/common/metrics/Sensor.java    |   9 +-
 .../apache/kafka/common/network/KafkaChannel.java  |  22 +-
 .../org/apache/kafka/common/network/Selector.java  |  23 +
 .../org/apache/kafka/common/protocol/ApiKeys.java  |  86 ++--
 .../org/apache/kafka/common/protocol/Protocol.java | 212 ++++++--
 .../kafka/common/requests/AbstractRequest.java     |   9 +-
 .../kafka/common/requests/AbstractResponse.java    |   1 +
 .../common/requests/AddOffsetsToTxnRequest.java    |   4 +-
 .../common/requests/AddOffsetsToTxnResponse.java   |  11 +-
 .../common/requests/AddPartitionsToTxnRequest.java |   4 +-
 .../requests/AddPartitionsToTxnResponse.java       |  11 +-
 .../kafka/common/requests/ApiVersionsRequest.java  |   8 +-
 .../kafka/common/requests/ApiVersionsResponse.java |  31 +-
 .../common/requests/ControlledShutdownRequest.java |   2 +-
 .../kafka/common/requests/CreateTopicsRequest.java |   4 +-
 .../common/requests/CreateTopicsResponse.java      |  14 +
 .../common/requests/DeleteRecordsRequest.java      |   4 +-
 .../common/requests/DeleteRecordsResponse.java     |  12 +-
 .../kafka/common/requests/DeleteTopicsRequest.java |   4 +-
 .../common/requests/DeleteTopicsResponse.java      |  14 +
 .../common/requests/DescribeGroupsRequest.java     |   4 +-
 .../common/requests/DescribeGroupsResponse.java    |  20 +-
 .../kafka/common/requests/EndTxnRequest.java       |   4 +-
 .../kafka/common/requests/EndTxnResponse.java      |  11 +-
 .../apache/kafka/common/requests/FetchRequest.java |   4 +-
 .../common/requests/FindCoordinatorRequest.java    |   5 +-
 .../common/requests/FindCoordinatorResponse.java   |  14 +
 .../kafka/common/requests/HeartbeatRequest.java    |   4 +-
 .../kafka/common/requests/HeartbeatResponse.java   |  14 +
 .../kafka/common/requests/InitPidRequest.java      |   4 +-
 .../kafka/common/requests/InitPidResponse.java     |  15 +-
 .../kafka/common/requests/JoinGroupRequest.java    |  11 +-
 .../kafka/common/requests/JoinGroupResponse.java   |  20 +
 .../kafka/common/requests/LeaderAndIsrRequest.java |   2 +-
 .../kafka/common/requests/LeaveGroupRequest.java   |   4 +-
 .../kafka/common/requests/LeaveGroupResponse.java  |  14 +
 .../kafka/common/requests/ListGroupsRequest.java   |   4 +-
 .../kafka/common/requests/ListGroupsResponse.java  |  20 +-
 .../kafka/common/requests/ListOffsetRequest.java   |   6 +-
 .../kafka/common/requests/ListOffsetResponse.java  |  16 +-
 .../kafka/common/requests/MetadataRequest.java     |   4 +-
 .../kafka/common/requests/MetadataResponse.java    |  14 +
 .../kafka/common/requests/OffsetCommitRequest.java |   5 +-
 .../common/requests/OffsetCommitResponse.java      |  14 +
 .../kafka/common/requests/OffsetFetchRequest.java  |  10 +-
 .../kafka/common/requests/OffsetFetchResponse.java |  22 +-
 .../requests/OffsetsForLeaderEpochRequest.java     |   2 +-
 .../kafka/common/requests/ProduceRequest.java      |   4 +-
 .../kafka/common/requests/ProduceResponse.java     |   1 -
 .../common/requests/SaslHandshakeRequest.java      |  25 +-
 .../kafka/common/requests/StopReplicaRequest.java  |   2 +-
 .../kafka/common/requests/SyncGroupRequest.java    |   7 +-
 .../kafka/common/requests/SyncGroupResponse.java   |  14 +
 .../common/requests/TxnOffsetCommitRequest.java    |   4 +-
 .../common/requests/TxnOffsetCommitResponse.java   |  11 +-
 .../common/requests/UpdateMetadataRequest.java     |   2 +-
 .../common/requests/WriteTxnMarkersRequest.java    |   2 +-
 .../apache/kafka/clients/NetworkClientTest.java    |   3 +-
 .../clients/producer/internals/SenderTest.java     |   2 +-
 .../producer/internals/TransactionManagerTest.java |  10 +-
 .../common/network/SslTransportLayerTest.java      |  39 ++
 .../apache/kafka/common/protocol/ApiKeysTest.java  |  31 ++
 .../kafka/common/requests/RequestResponseTest.java |  10 +-
 .../main/scala/kafka/network/RequestChannel.scala  |  82 ++--
 .../main/scala/kafka/network/SocketServer.scala    |  31 +-
 .../scala/kafka/server/ClientQuotaManager.scala    | 101 ++--
 .../kafka/server/ClientRequestQuotaManager.scala   |  54 +++
 .../main/scala/kafka/server/ConfigHandler.scala    |   6 +
 .../main/scala/kafka/server/DynamicConfig.scala    |   5 +
 core/src/main/scala/kafka/server/KafkaApis.scala   | 539 +++++++++++++--------
 .../scala/kafka/server/KafkaRequestHandler.scala   |   6 +-
 .../src/main/scala/kafka/server/QuotaFactory.scala |  12 +-
 .../integration/kafka/api/AdminClientTest.scala    |   2 +-
 .../integration/kafka/api/BaseQuotaTest.scala      |  65 ++-
 .../integration/kafka/api/ClientIdQuotaTest.scala  |   5 +-
 .../kafka/api/UserClientIdQuotaTest.scala          |   8 +-
 .../integration/kafka/api/UserQuotaTest.scala      |   8 +-
 .../unit/kafka/server/ApiVersionsRequestTest.scala |   6 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |   2 +-
 .../unit/kafka/server/ClientQuotaManagerTest.scala |  62 +++
 .../scala/unit/kafka/server/RequestQuotaTest.scala | 420 ++++++++++++++++
 82 files changed, 1879 insertions(+), 484 deletions(-)
6185bc0276c03075022c30d3c36f7f5c09ef19c6

 build.gradle                                       |   1 +
 checkstyle/import-control.xml                      |   7 +
 .../kafka/clients/consumer/ConsumerRecord.java     |  44 +++-
 .../kafka/clients/consumer/internals/Fetcher.java  |  24 ++-
 .../kafka/clients/producer/KafkaProducer.java      |  47 +++--
 .../kafka/clients/producer/MockProducer.java       |  19 +-
 .../kafka/clients/producer/ProducerRecord.java     |  58 +++++-
 .../clients/producer/internals/ProducerBatch.java  |   7 +-
 .../producer/internals/RecordAccumulator.java      |  19 +-
 .../org/apache/kafka/common/header/Header.java     |  25 +++
 .../org/apache/kafka/common/header/Headers.java    |  72 +++++++
 .../common/header/internals/RecordHeader.java      |  79 ++++++++
 .../common/header/internals/RecordHeaders.java     | 207 +++++++++++++++++++
 .../common/record/AbstractLegacyRecordBatch.java   |   1 +
 .../kafka/common/record/AbstractRecords.java       |   5 +-
 .../apache/kafka/common/record/DefaultRecord.java  |  16 +-
 .../kafka/common/record/DefaultRecordBatch.java    |   1 +
 .../org/apache/kafka/common/record/Header.java     |  64 ------
 .../kafka/common/record/MemoryRecordsBuilder.java  |  30 ++-
 .../org/apache/kafka/common/record/Record.java     |   2 +
 .../apache/kafka/common/record/SimpleRecord.java   |   1 +
 .../kafka/common/serialization/Deserializer.java   |   2 +-
 .../common/serialization/ExtendedDeserializer.java |  56 ++++++
 .../common/serialization/ExtendedSerializer.java   |  55 +++++
 .../kafka/common/serialization/Serializer.java     |   1 -
 .../java/org/apache/kafka/common/utils/Utils.java  |   9 +
 .../kafka/clients/consumer/ConsumerRecordTest.java |   2 +
 .../clients/consumer/internals/FetcherTest.java    |  47 +++++
 .../kafka/clients/producer/KafkaProducerTest.java  |  61 ++++++
 .../kafka/clients/producer/ProducerRecordTest.java |   2 +-
 .../producer/internals/RecordAccumulatorTest.java  |  42 ++--
 .../clients/producer/internals/SenderTest.java     |  28 +--
 .../producer/internals/TransactionManagerTest.java |  13 +-
 .../common/header/internals/RecordHeadersTest.java | 224 +++++++++++++++++++++
 .../common/record/DefaultRecordBatchTest.java      |   6 +-
 .../kafka/common/record/DefaultRecordTest.java     |   9 +-
 .../main/scala/kafka/consumer/BaseConsumer.scala   |  11 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |   2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |   4 +-
 .../kafka/api/PlaintextConsumerTest.scala          |  92 ++++++++-
 40 files changed, 1216 insertions(+), 179 deletions(-)
ca6ae811662fd291421c5e064dda067517fc624e

 .../test/scala/integration/kafka/api/ConsumerBounceTest.scala | 11 +++++------
 1 file changed, 5 insertions(+), 6 deletions(-)
f0152a7fdac2ae4dcac65d5ed24fa201f3d30120

 .../java/org/apache/kafka/clients/MockClient.java  |  3 +-
 .../clients/consumer/internals/FetcherTest.java    | 45 +++++++++++++++++++++-
 2 files changed, 46 insertions(+), 2 deletions(-)
a931e9954d27f4c9f12fd89afd6f0fe523cf35e8

 .../kafka/clients/producer/MockProducer.java       | 38 ++++++++++--
 .../org/apache/kafka/streams/StreamsConfig.java    | 16 ++++-
 .../streams/processor/internals/StreamTask.java    |  9 ++-
 .../streams/processor/internals/StreamThread.java  |  2 +-
 .../processor/internals/StreamTaskTest.java        |  4 +-
 .../processor/internals/StreamThreadTest.java      | 69 +++++++---------------
 .../org/apache/kafka/test/MockClientSupplier.java  | 17 +++---
 7 files changed, 83 insertions(+), 72 deletions(-)
bc10f5f173383ae4593d4742a16060faa88d7fb6

 core/src/main/scala/kafka/admin/AdminUtils.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
4b9de871df1b2574a7e5d1159b45ae9e4ba31955

 .../org/apache/kafka/streams/processor/TopologyBuilder.java  |  3 +++
 .../apache/kafka/streams/processor/TopologyBuilderTest.java  | 12 ++++++++++++
 2 files changed, 15 insertions(+)
ee8c5e2dc391222b618b8a48dde9e407031ea85b

 .../internals/InMemoryKeyValueLoggedStore.java     |   1 -
 .../internals/InMemoryLRUCacheStoreSupplier.java   |   2 +-
 .../streams/state/internals/MemoryLRUCache.java    |  33 +++---
 .../streams/state/KeyValueStoreTestDriver.java     | 116 ++++++---------------
 .../state/internals/AbstractKeyValueStoreTest.java |   7 +-
 .../state/internals/InMemoryKeyValueStoreTest.java |   3 +-
 .../state/internals/InMemoryLRUCacheStoreTest.java |  30 +++++-
 .../state/internals/RocksDBKeyValueStoreTest.java  |  18 ----
 .../apache/kafka/test/MockProcessorContext.java    |   3 +-
 9 files changed, 84 insertions(+), 129 deletions(-)
6753af270c8a966411f5574afa57f6e5ffe43dbe

 .../streams/processor/internals/AbstractTask.java  |  103 +-
 .../processor/internals/ProcessorStateManager.java |    1 +
 .../streams/processor/internals/StandbyTask.java   |   63 +-
 .../streams/processor/internals/StreamTask.java    |  276 +++--
 .../streams/processor/internals/StreamThread.java  | 1101 ++++++++++----------
 .../processor/internals/AbstractTaskTest.java      |    6 +-
 .../processor/internals/StreamTaskTest.java        |    2 +-
 .../processor/internals/StreamThreadTest.java      |   10 +-
 .../StreamThreadStateStoreProviderTest.java        |    2 +-
 9 files changed, 788 insertions(+), 776 deletions(-)
36aef1c2682169571b410a4986680361db5eec01

 .../streams/processor/internals/StreamThread.java  |   2 -
 .../KTableKTableJoinIntegrationTest.java           |   2 -
 .../integration/utils/IntegrationTestUtils.java    | 231 +++++++++++++--------
 3 files changed, 143 insertions(+), 92 deletions(-)
efa479736c041f7c311fbb26664d91a739ac4040

 core/src/main/scala/kafka/controller/KafkaController.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
909cf9bb9778e3ba240fbcd4073a1642b79a6c23

 .../scala/unit/kafka/network/SocketServerTest.scala     | 17 +++++++++++------
 1 file changed, 11 insertions(+), 6 deletions(-)
5b5efd4b5cb092813d878b080e0657f40fc1f72c

 .../kafka/clients/producer/KafkaProducer.java      |  1 +
 .../kafka/clients/producer/KafkaProducerTest.java  | 40 ++++++++++++++++++++++
 2 files changed, 41 insertions(+)
a82f194b21a6af2f52e36e55e2c6adcdba942c08

 checkstyle/import-control.xml                      |   1 +
 checkstyle/suppressions.xml                        |  44 +-
 .../kafka/clients/consumer/ConsumerConfig.java     |  20 +
 .../kafka/clients/consumer/KafkaConsumer.java      |   8 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  94 ++-
 .../kafka/clients/producer/KafkaProducer.java      | 169 +++-
 .../kafka/clients/producer/MockProducer.java       |  23 +
 .../apache/kafka/clients/producer/Producer.java    |  30 +-
 .../kafka/clients/producer/ProducerConfig.java     |  25 +-
 .../kafka/clients/producer/TransactionState.java   | 135 ----
 .../internals/FutureTransactionalResult.java       |  64 ++
 .../clients/producer/internals/ProducerBatch.java  |   7 +-
 .../producer/internals/RecordAccumulator.java      |  32 +-
 .../kafka/clients/producer/internals/Sender.java   | 134 +++-
 .../producer/internals/TransactionManager.java     | 866 +++++++++++++++++++++
 .../internals/TransactionalRequestResult.java      |  64 ++
 .../org/apache/kafka/common/config/ConfigDef.java  |  10 +
 .../apache/kafka/common/record/MemoryRecords.java  |  32 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  31 +-
 .../common/requests/AddOffsetsToTxnResponse.java   |   1 +
 .../requests/AddPartitionsToTxnResponse.java       |   1 +
 .../kafka/common/requests/EndTxnResponse.java      |   1 +
 .../apache/kafka/common/requests/FetchRequest.java |  21 +-
 .../kafka/common/requests/ProduceRequest.java      |  22 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   7 +-
 .../clients/consumer/internals/FetcherTest.java    | 313 +++++++-
 .../producer/internals/RecordAccumulatorTest.java  |   3 +-
 .../clients/producer/internals/SenderTest.java     |  49 +-
 .../producer/internals/TransactionManagerTest.java | 588 ++++++++++++++
 .../producer/internals/TransactionStateTest.java   |  61 --
 .../common/record/MemoryRecordsBuilderTest.java    |   9 +-
 core/src/main/scala/kafka/log/LogValidator.scala   |   4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   8 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |   6 +-
 gradle/findbugs-exclude.xml                        |   9 +
 35 files changed, 2515 insertions(+), 377 deletions(-)
bb663d04febcadd4f120e0ff5c5919ca8bf7e971

 .../controller/ControllerChannelManager.scala      |   80 +-
 .../kafka/controller/ControllerZkListener.scala    |   62 --
 .../scala/kafka/controller/KafkaController.scala   | 1093 ++++++++++++--------
 .../kafka/controller/PartitionLeaderSelector.scala |    4 +-
 .../kafka/controller/PartitionStateMachine.scala   |  193 +---
 .../kafka/controller/ReplicaStateMachine.scala     |   87 +-
 .../kafka/controller/TopicDeletionManager.scala    |  220 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |   21 +-
 .../main/scala/kafka/server/LeaderElector.scala    |   33 -
 .../kafka/server/ZookeeperLeaderElector.scala      |  158 ---
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   15 +-
 11 files changed, 831 insertions(+), 1135 deletions(-)
f69d94158ce72f4ef2df5b98f2395c2b2e61251e

 checkstyle/import-control-core.xml                 |    4 +
 .../kafka/clients/consumer/internals/Fetcher.java  |    8 +-
 .../errors/ConcurrentTransactionsException.java    |   25 +
 .../common/errors/InvalidTxnTimeoutException.java  |    1 +
 .../org/apache/kafka/common/protocol/Errors.java   |   10 +-
 .../kafka/common/requests/InitPidRequest.java      |    2 -
 .../common/requests/WriteTxnMarkersRequest.java    |   41 +
 .../kafka/common/requests/RequestResponseTest.java |    3 +-
 config/server.properties                           |    6 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |    2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |    4 +-
 .../scala/kafka/common/InterBrokerSendThread.scala |   69 ++
 core/src/main/scala/kafka/common/Topic.scala       |    3 +-
 .../scala/kafka/coordinator/DelayedHeartbeat.scala |   40 -
 .../main/scala/kafka/coordinator/DelayedJoin.scala |   44 -
 .../scala/kafka/coordinator/GroupCoordinator.scala |  817 --------------
 .../scala/kafka/coordinator/GroupMetadata.scala    |  327 ------
 .../kafka/coordinator/GroupMetadataManager.scala   | 1122 -------------------
 .../scala/kafka/coordinator/MemberMetadata.scala   |  123 ---
 .../scala/kafka/coordinator/OffsetConfig.scala     |   61 --
 .../kafka/coordinator/ProducerIdManager.scala      |  153 ---
 .../kafka/coordinator/TransactionCoordinator.scala |   92 --
 .../kafka/coordinator/group/DelayedHeartbeat.scala |   40 +
 .../kafka/coordinator/group/DelayedJoin.scala      |   43 +
 .../kafka/coordinator/group/GroupCoordinator.scala |  817 ++++++++++++++
 .../kafka/coordinator/group/GroupMetadata.scala    |  326 ++++++
 .../coordinator/group/GroupMetadataManager.scala   | 1123 +++++++++++++++++++
 .../kafka/coordinator/group/MemberMetadata.scala   |  120 ++
 .../kafka/coordinator/group/OffsetConfig.scala     |   61 ++
 .../coordinator/transaction/DelayedTxnMarker.scala |   48 +
 .../transaction/ProducerIdManager.scala            |  153 +++
 .../transaction/TransactionCoordinator.scala       |  434 ++++++++
 .../coordinator/transaction/TransactionLog.scala   |  275 +++++
 .../transaction/TransactionMarkerChannel.scala     |  168 +++
 .../TransactionMarkerChannelManager.scala          |  159 +++
 ...TransactionMarkerRequestCompletionHandler.scala |   95 ++
 .../transaction/TransactionMetadata.scala          |  175 +++
 .../transaction/TransactionStateManager.scala      |  429 ++++++++
 .../src/main/scala/kafka/server/AdminManager.scala |    2 +-
 .../main/scala/kafka/server/DelayedOperation.scala |   32 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  194 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |   54 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |    7 +-
 .../main/scala/kafka/server/MetadataCache.scala    |   14 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |    6 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |    2 +-
 .../main/scala/kafka/utils/KafkaScheduler.scala    |    2 +-
 .../scala/kafka/utils/ShutdownableThread.scala     |    4 +-
 ...ipleListenersWithSameSecurityProtocolTest.scala |    2 +-
 .../kafka/common/InterBrokerSendThreadTest.scala   |  131 +++
 .../coordinator/GroupCoordinatorResponseTest.scala | 1154 --------------------
 .../kafka/coordinator/GroupCoordinatorTest.scala   |   36 -
 .../coordinator/GroupMetadataManagerTest.scala     |  814 --------------
 .../unit/kafka/coordinator/GroupMetadataTest.scala |  360 ------
 .../kafka/coordinator/MemberMetadataTest.scala     |   88 --
 .../kafka/coordinator/ProducerIdManagerTest.scala  |  105 --
 .../coordinator/TransactionCoordinatorTest.scala   |   93 --
 .../group/GroupCoordinatorResponseTest.scala       | 1154 ++++++++++++++++++++
 .../coordinator/group/GroupCoordinatorTest.scala   |   36 +
 .../group/GroupMetadataManagerTest.scala           |  815 ++++++++++++++
 .../coordinator/group/GroupMetadataTest.scala      |  362 ++++++
 .../coordinator/group/MemberMetadataTest.scala     |   88 ++
 .../transaction/ProducerIdManagerTest.scala        |  104 ++
 .../TransactionCoordinatorIntegrationTest.scala    |   98 ++
 .../transaction/TransactionCoordinatorTest.scala   |  787 +++++++++++++
 .../transaction/TransactionLogTest.scala           |  109 ++
 .../TransactionMarkerChannelManagerTest.scala      |  283 +++++
 .../transaction/TransactionMarkerChannelTest.scala |  179 +++
 ...sactionMarkerRequestCompletionHandlerTest.scala |  164 +++
 .../transaction/TransactionStateManagerTest.scala  |  354 ++++++
 .../unit/kafka/server/DelayedOperationTest.scala   |   34 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |    8 +-
 72 files changed, 9554 insertions(+), 5544 deletions(-)
8d8ab2ebcd498982a9dd6be873f4d7cc032c65d8

 .../main/scala/kafka/log/ProducerIdMapping.scala   |  6 ++--
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 38 ++++++++++++++++------
 2 files changed, 31 insertions(+), 13 deletions(-)
d06f2cc7ac8d214edbefa57addc82312fbae884f

 .../kafka/streams/integration/KTableKTableJoinIntegrationTest.java      | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d7850a400ed3d6efd3aae20515560971693f39b5

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
760cffd5672206ba7f344450f18eb420809e49c3
f7b7b4745541a576eb0219468263487b07bac959

 .../streams/processor/internals/AbstractTask.java  |  62 ++--
 .../processor/internals/ProcessorStateManager.java | 127 ++++---
 .../streams/processor/internals/StandbyTask.java   | 101 +++---
 .../internals/StreamPartitionAssignor.java         |   2 +-
 .../streams/processor/internals/StreamTask.java    | 200 ++++++-----
 .../streams/processor/internals/StreamThread.java  | 381 ++++++++-------------
 .../processor/internals/AbstractTaskTest.java      |  21 +-
 .../processor/internals/StandbyTaskTest.java       |  10 +-
 .../processor/internals/StreamTaskTest.java        |  53 ++-
 .../processor/internals/StreamThreadTest.java      | 206 ++++++-----
 10 files changed, 547 insertions(+), 616 deletions(-)
c43eb856d16e648c2a6ab1f87b58f59035fce065

 .../clients/producer/internals/BufferPool.java     | 125 +++++++++++----------
 .../clients/producer/internals/BufferPoolTest.java |  47 ++++++++
 2 files changed, 110 insertions(+), 62 deletions(-)
7ba26ef14eab295a0216d076741a1f3893ddfbf0

 .../apache/kafka/streams/perf/SimpleBenchmark.java | 515 +++++++++++++--------
 .../streams/streams_simple_benchmark_test.py       |  89 +++-
 .../services/performance/streams_performance.py    |  10 +-
 tests/kafkatest/services/streams.py                |  10 +-
 4 files changed, 407 insertions(+), 217 deletions(-)
4815323be73e4e207fcf7079714bd1fd82fd8f6b

 tests/kafkatest/tests/core/replication_test.py | 14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)
b15422177460a8f928a2ba93c429de426ae68076

 .../org/apache/kafka/tools/ProducerPerformance.java | 21 ++++++++++++++-------
 1 file changed, 14 insertions(+), 7 deletions(-)
1fbb8cfafa64307f94de09e4a14217a69f01cea0

 tests/kafkatest/tests/streams/streams_broker_compatibility_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
19f266d4075a8c56d56f6b8c7e95773378b95211

 .../src/main/java/org/apache/kafka/common/Os.java  | 30 -------------------
 .../apache/kafka/common/utils/OperatingSystem.java | 34 ++++++++++++++++++++++
 .../org/apache/kafka/common/utils/ShellTest.java   |  5 ++--
 core/src/main/scala/kafka/log/AbstractIndex.scala  | 14 ++++-----
 4 files changed, 42 insertions(+), 41 deletions(-)
d7b5eadb92e514857754f8599f3d902093651f25

 .../src/main/java/org/apache/kafka/streams/kstream/Transformer.java    | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
3d8506a3ac5e4176ea1f2f0be97bef2712f46464

 .../src/main/java/org/apache/kafka/streams/state/SessionStore.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
cba0094f5a9833194bf2a13965eda678bd4a05ea

 .../streams/processor/internals/AbstractTask.java  |  2 +-
 .../internals/GlobalStateManagerImpl.java          |  3 +-
 .../processor/internals/GlobalStateUpdateTask.java |  2 +-
 .../processor/internals/ProcessorStateManager.java |  4 +-
 .../streams/processor/internals/StandbyTask.java   |  2 +-
 .../streams/processor/internals/StateManager.java  |  2 +-
 .../streams/processor/internals/StreamTask.java    |  2 +-
 ...KStreamSessionWindowAggregateProcessorTest.java |  1 +
 .../internals/GlobalStateManagerImplTest.java      |  4 +-
 .../processor/internals/ProcessorNodeTest.java     |  2 +
 .../internals/ProcessorStateManagerTest.java       |  6 +-
 .../streams/processor/internals/SinkNodeTest.java  | 52 +++++-------
 .../processor/internals/StateManagerStub.java      | 16 ++--
 .../state/internals/AbstractKeyValueStoreTest.java | 12 +--
 .../state/internals/CachingKeyValueStoreTest.java  | 11 ++-
 .../state/internals/CachingSessionStoreTest.java   |  4 +-
 .../state/internals/CachingWindowStoreTest.java    |  4 +-
 .../ChangeLoggingKeyValueBytesStoreTest.java       | 19 +++--
 .../internals/ChangeLoggingKeyValueStoreTest.java  | 19 +++--
 .../ChangeLoggingSegmentedBytesStoreTest.java      | 43 ++++++----
 .../internals/MeteredSegmentedBytesStoreTest.java  | 20 +++--
 .../RocksDBKeyValueStoreSupplierTest.java          |  1 +
 .../state/internals/RocksDBKeyValueStoreTest.java  | 58 ++++++-------
 .../internals/RocksDBSegmentedBytesStoreTest.java  | 13 +--
 .../internals/RocksDBSessionStoreSupplierTest.java | 57 ++++---------
 .../state/internals/RocksDBSessionStoreTest.java   |  1 +
 .../internals/RocksDBWindowStoreSupplierTest.java  |  1 +
 .../state/internals/RocksDBWindowStoreTest.java    |  1 +
 .../state/internals/SegmentIteratorTest.java       |  4 +-
 .../streams/state/internals/SegmentsTest.java      |  1 +
 .../state/internals/StoreChangeLoggerTest.java     |  5 ++
 .../apache/kafka/test/GlobalStateManagerStub.java  |  4 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  1 +
 .../apache/kafka/test/MockProcessorContext.java    | 94 +++++++++++-----------
 34 files changed, 243 insertions(+), 228 deletions(-)
80e0548e2b1620c25f4fddc69550d00dd460961c

 tools/src/main/java/org/apache/kafka/tools/ProducerPerformance.java | 4 ++++
 1 file changed, 4 insertions(+)
72be1df5984a8d2df7b4d2ea8f386c69fe31f4d2

 .../streams/errors/BrokerNotFoundException.java    | 44 ++++++++++++++++++++++
 .../processor/internals/StreamsKafkaClient.java    |  6 ++-
 .../streams/tests/BrokerCompatibilityTest.java     |  4 ++
 .../streams/streams_broker_compatibility_test.py   | 21 ++++++++++-
 4 files changed, 72 insertions(+), 3 deletions(-)
3bedcce01b9d3e8ba0516fa33eb59d57817ce27e

 .../processor/internals/RecordCollector.java       |  26 +++---
 .../processor/internals/RecordCollectorImpl.java   |  72 ++++++++-------
 .../streams/processor/internals/SinkNode.java      |  34 ++++---
 .../processor/internals/StandbyContextImpl.java    |  74 ++++++++-------
 .../processor/internals/RecordCollectorTest.java   |  68 ++++++++------
 .../streams/state/KeyValueStoreTestDriver.java     | 101 ++++++++++-----------
 .../state/internals/StoreChangeLoggerTest.java     |  29 +++---
 .../org/apache/kafka/test/KStreamTestDriver.java   |  94 +++++++++----------
 .../org/apache/kafka/test/NoOpRecordCollector.java |  29 +++---
 9 files changed, 277 insertions(+), 250 deletions(-)
93fbda4c577870c96c3ab86c29b60c04dc9183b9

 core/src/main/scala/kafka/log/LogValidator.scala | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)
e89bffd6b2eff799713f560074c657f3f522cd85

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
c82118b196687cf5f523dfd733bfe575a127c315

 .../main/java/org/apache/kafka/common/record/ControlRecordType.java   | 4 ++--
 .../org/apache/kafka/common/record/KafkaLZ4BlockOutputStream.java     | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)
d53e99736550b37edc89d1a220cab43604fa3f03

 README.md    | 15 ++++++++-------
 build.gradle |  4 ++--
 jenkins.sh   |  2 +-
 3 files changed, 11 insertions(+), 10 deletions(-)
d18de0e9547728e4fa0df985c1778aab5ffec751

 .../scala/kafka/server/DynamicConfigManager.scala  |  8 +++++++-
 .../SaslScramSslEndToEndAuthorizationTest.scala    | 24 ++++++++++++++--------
 2 files changed, 23 insertions(+), 9 deletions(-)
fc5ad22e33cb9f757f645cec9d4afe9e65292712

 core/src/main/scala/kafka/tools/ReplicaVerificationTool.scala           | 2 +-
 core/src/main/scala/kafka/tools/SimpleConsumerShell.scala               | 2 +-
 .../apache/kafka/streams/integration/utils/IntegrationTestUtils.java    | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
495cdbde9e164513c8f982df80c0f29a871b62f2

 .../streams/integration/ResetIntegrationTest.java  | 38 ++++++++++++++++++++--
 1 file changed, 36 insertions(+), 2 deletions(-)
0731d35e58b2d70e91c06edcd17c5e447b2a1f75

 .../org/apache/kafka/streams/state/internals/ThreadCacheTest.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
f18a14af361f24851664b428b46d5789f51a80ea

 .../org/apache/kafka/streams/state/internals/ThreadCacheTest.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
49230625736d30cb4d0467ac0a103b23de5c266b

 .../org/apache/kafka/streams/processor/internals/StreamThread.java    | 4 ++++
 1 file changed, 4 insertions(+)
3c471d25b97b9a867ec6a2a1ed9467b8e4ba6b66

 .../apache/kafka/streams/kstream/GlobalKTable.java |  2 +
 .../org/apache/kafka/streams/kstream/KTable.java   |  2 +
 .../internals/GlobalStateManagerImpl.java          |  4 +-
 .../processor/internals/StoreChangelogReader.java  |  4 +-
 .../internals/GlobalStateManagerImplTest.java      | 23 +++++++++++
 .../processor/internals/StateRestorerTest.java     |  2 +-
 .../internals/StoreChangelogReaderTest.java        | 47 ++++++++++++++++------
 .../org/apache/kafka/test/MockRestoreCallback.java |  9 ++++-
 8 files changed, 75 insertions(+), 18 deletions(-)
b9dadae97c29341d5c008d429bb53b3fcc1b6713

 .../integration/GlobalKTableIntegrationTest.java      |  1 +
 .../integration/InternalTopicIntegrationTest.java     |  4 +++-
 .../streams/integration/JoinIntegrationTest.java      |  1 +
 .../KStreamAggregationIntegrationTest.java            |  2 +-
 .../integration/KTableKTableJoinIntegrationTest.java  |  1 +
 .../integration/QueryableStateIntegrationTest.java    | 19 +++++++++----------
 .../streams/integration/ResetIntegrationTest.java     |  1 +
 .../java/org/apache/kafka/test/StreamsTestUtils.java  |  2 ++
 8 files changed, 19 insertions(+), 12 deletions(-)
14ab3dcc6c70d5bd4b21d99e0b97332ea332ac07

 .../kafka/streams/integration/GlobalKTableIntegrationTest.java |  1 +
 .../streams/integration/InternalTopicIntegrationTest.java      |  4 +++-
 .../apache/kafka/streams/integration/JoinIntegrationTest.java  |  1 +
 .../streams/integration/KStreamAggregationIntegrationTest.java |  2 +-
 .../streams/integration/KTableKTableJoinIntegrationTest.java   |  1 +
 .../streams/integration/QueryableStateIntegrationTest.java     | 10 +++++-----
 .../apache/kafka/streams/integration/ResetIntegrationTest.java |  1 +
 .../src/test/java/org/apache/kafka/test/StreamsTestUtils.java  |  2 ++
 8 files changed, 15 insertions(+), 7 deletions(-)
2aa339de1135e110bba9c345e809bebf27ce3178

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
779874fb14f5a2f60016546059576e8ae936b14c

 tests/kafkatest/tests/streams/streams_broker_compatibility_test.py | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)
98d62a880d91ac1b552ac3a049c5d202c2d63520

 .../kafka/clients/consumer/KafkaConsumer.java      |  3 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 61 ++++++++++++++--------
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  6 ++-
 .../processor/internals/StoreChangelogReader.java  | 25 +++++----
 4 files changed, 59 insertions(+), 36 deletions(-)
2aa615545514cd9d2be0c998e685fad10927d208

 .../kafka/clients/consumer/internals/Fetcher.java  | 61 ++++++++++------------
 1 file changed, 27 insertions(+), 34 deletions(-)
588ed4644fe8842e4217c8e2add39f6e08e07db9

 .../kafka/common/record/DefaultRecordBatch.java    |   3 +
 .../apache/kafka/common/record/MemoryRecords.java  |   9 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |   6 +
 .../common/record/DefaultRecordBatchTest.java      |  39 +++-
 .../kafka/common/record/MemoryRecordsTest.java     |  81 +++++++-
 core/src/main/scala/kafka/log/Log.scala            |  96 +++++----
 .../main/scala/kafka/log/ProducerIdMapping.scala   | 227 ++++++++++-----------
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   6 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 221 +++++++++++++++++++-
 .../unit/kafka/log/ProducerIdMappingTest.scala     | 112 ++++++++--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   5 +-
 11 files changed, 609 insertions(+), 196 deletions(-)
6af876b94dc588c8d6098a7fef7a18c46625d1d5

 .../log/AbstractLogCleanerIntegrationTest.scala    | 113 +++++++++++++++++++++
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  81 +++------------
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |  65 ++----------
 .../unit/kafka/log/ProducerIdMappingTest.scala     |   5 +-
 .../scala/unit/kafka/utils/MockScheduler.scala     |   2 +-
 5 files changed, 137 insertions(+), 129 deletions(-)
63f01a8af897ee9510ab0364f2d026e4bf5472ef

 core/src/main/scala/kafka/admin/AclCommand.scala   |  7 ++-
 .../scala/kafka/controller/KafkaController.scala   |  2 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  2 +-
 .../kafka/server/ZookeeperLeaderElector.scala      |  2 +-
 .../kafka/api/SaslPlainPlaintextConsumerTest.scala | 15 ++++-
 .../SaslPlainSslEndToEndAuthorizationTest.scala    | 12 +++-
 .../kafka/security/auth/ZkAuthorizationTest.scala  | 35 ++---------
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 68 ++++++++++++++++++++++
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  3 +-
 9 files changed, 107 insertions(+), 39 deletions(-)
c2d17c830ca309a4e3989981a47790209955273c

 build.gradle               | 17 +++++++----------
 gradle/dependencies.gradle | 14 +++++++-------
 2 files changed, 14 insertions(+), 17 deletions(-)
609e9b0b2f46ce72ed91965f7e43c512b26a609b

 .../scala/kafka/tools/ConsumerPerformance.scala    | 18 ++++++-
 core/src/main/scala/kafka/utils/ToolsUtils.scala   | 32 +++++++++++++
 .../apache/kafka/tools/ProducerPerformance.java    | 20 ++++++--
 .../java/org/apache/kafka/tools/ToolsUtils.java    | 55 ++++++++++++++++++++++
 4 files changed, 119 insertions(+), 6 deletions(-)
7c436d38890083cd833091971e40f0c977993570

 tests/kafkatest/tests/client/client_compatibility_features_test.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
41c0f8addeef44be23524bade61bcb2ab6077706

 core/src/main/scala/kafka/utils/ZkUtils.scala      | 46 +++++++++++-----------
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala | 18 ++++-----
 2 files changed, 33 insertions(+), 31 deletions(-)
c4e59a338a045fc9d9b726ad68641e93582a8642

 .../PreferredReplicaLeaderElectionCommand.scala    |   3 +-
 .../kafka/server/ZookeeperLeaderElector.scala      |   8 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   9 +-
 .../controller/ControllerIntegrationTest.scala     | 317 +++++++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  10 +
 5 files changed, 340 insertions(+), 7 deletions(-)
6526177f22e2d5c95d13a3d4d105e2e525cc818b

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
a26731674815a57368ad4500a77e84a218a40e63

 .../kafka/clients/consumer/internals/Fetcher.java  | 78 ++++++++++++-----
 .../clients/consumer/internals/FetcherTest.java    | 99 +++++++++++++++++++---
 .../kafka/api/AuthorizerIntegrationTest.scala      |  1 +
 3 files changed, 143 insertions(+), 35 deletions(-)
020ca7903669306862950260b8d63177402322c3

 .../apache/kafka/common/record/MemoryRecords.java  |  10 +
 core/src/main/scala/kafka/cluster/Partition.scala  |   8 +-
 core/src/main/scala/kafka/log/Log.scala            |  60 ++++--
 core/src/main/scala/kafka/log/LogSegment.scala     |   2 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 .../kafka/server/epoch/LeaderEpochFileCache.scala  |  55 ++----
 .../src/test/scala/other/kafka/StressTestLog.scala |   2 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   2 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |   2 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   4 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  10 +-
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |   2 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |   8 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 104 +++++-----
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  16 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 219 ++++++++++-----------
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   8 +-
 .../kafka/server/ReplicaFetcherThreadTest.scala    |  12 +-
 .../server/epoch/LeaderEpochFileCacheTest.scala    | 102 +++-------
 19 files changed, 278 insertions(+), 352 deletions(-)
17ce2a7307222d7476eb60318fab2e672eebe559

 .../kafka/clients/consumer/internals/Fetcher.java  | 81 +++++++++++++++-------
 .../clients/consumer/internals/FetcherTest.java    | 77 ++++++++++++++++++++
 .../kafka/api/AuthorizerIntegrationTest.scala      |  2 +
 3 files changed, 135 insertions(+), 25 deletions(-)
148f8c25453e453f56ef429f8ef607de808de679

 checkstyle/suppressions.xml                        |  10 +-
 .../org/apache/kafka/streams/StreamsConfig.java    | 172 +++++++------
 .../processor/internals/RecordCollectorImpl.java   |   6 +
 .../streams/processor/internals/StreamTask.java    |  69 +++--
 .../streams/processor/internals/StreamThread.java  | 156 ++++++++----
 .../processor/internals/StreamTaskTest.java        |  45 +++-
 .../processor/internals/StreamThreadTest.java      | 282 ++++++++++++++++-----
 .../org/apache/kafka/test/MockClientSupplier.java  |   8 +-
 8 files changed, 515 insertions(+), 233 deletions(-)
45f517dc205d3e3f8eff1f12d951a1c2f0ed850b

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
1e93c3b9a3b8cbf069c57b46737fc02c818cb286

 .../processor/internals/ProcessorStateManager.java      | 17 +++++++++++++----
 .../streams/processor/internals/StateDirectory.java     |  9 ++++++++-
 .../streams/processor/internals/StateDirectoryTest.java | 16 ++++++++++++++++
 3 files changed, 37 insertions(+), 5 deletions(-)
8638675828b63c4bae6fb85de56543d7b3088546

 .../processor/internals/ProcessorStateManager.java     | 16 ++++++++++++----
 .../streams/processor/internals/StateDirectory.java    |  9 ++++++++-
 .../processor/internals/StateDirectoryTest.java        | 18 ++++++++++++++++++
 3 files changed, 38 insertions(+), 5 deletions(-)
0be835dde50611277504a4ddd93cc62f39e6defe

 .../src/main/java/org/apache/kafka/streams/StreamsConfig.java |  2 +-
 .../test/java/org/apache/kafka/streams/StreamsConfigTest.java |  9 +++++++++
 .../streams/integration/GlobalKTableIntegrationTest.java      |  1 +
 .../streams/integration/InternalTopicIntegrationTest.java     |  1 +
 .../apache/kafka/streams/integration/JoinIntegrationTest.java |  1 +
 .../integration/KStreamAggregationDedupIntegrationTest.java   |  1 +
 .../integration/KStreamAggregationIntegrationTest.java        |  1 +
 .../streams/integration/KStreamKTableJoinIntegrationTest.java |  1 +
 .../kafka/streams/integration/KStreamRepartitionJoinTest.java |  1 +
 .../KStreamsFineGrainedAutoResetIntegrationTest.java          |  1 +
 .../streams/integration/KTableKTableJoinIntegrationTest.java  |  1 +
 .../streams/integration/QueryableStateIntegrationTest.java    |  2 ++
 .../kafka/streams/integration/RegexSourceIntegrationTest.java | 11 +++++++----
 .../kafka/streams/integration/ResetIntegrationTest.java       |  1 +
 .../kafka/streams/integration/utils/IntegrationTestUtils.java |  1 +
 15 files changed, 30 insertions(+), 5 deletions(-)
3c93fa321ba7c0027169685beade2082c041a60e

 docs/upgrade.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5f728532aceb0132e3a312e2b427bc29f6c85f64

 docs/upgrade.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a74f0358444160516990a8d6585fb95734381301

 docs/streams.html |  7 +++++++
 docs/upgrade.html | 10 +++++++++-
 2 files changed, 16 insertions(+), 1 deletion(-)
5a68fa7e4e1315801c3128f95deedc0b2221ffaa

 docs/streams.html |  7 +++++++
 docs/upgrade.html | 10 +++++++++-
 2 files changed, 16 insertions(+), 1 deletion(-)
1d25369d22f47567a7117dede14b62b8586f394a

 core/src/main/scala/kafka/api/LeaderAndIsr.scala   |  25 +++--
 .../controller/ControllerChannelManager.scala      |  18 ++--
 .../scala/kafka/controller/KafkaController.scala   |  32 +++---
 .../kafka/controller/PartitionLeaderSelector.scala | 117 ++++++++++-----------
 .../kafka/controller/PartitionStateMachine.scala   |  61 ++++++-----
 .../ControlledShutdownLeaderSelectorTest.scala     |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  36 +++----
 7 files changed, 152 insertions(+), 139 deletions(-)
256f8d5662bcaf0804a4b328de1466d2b57d039e

 build.gradle                                       |  9 ++-
 .../main/scala/kafka/coordinator/PidMetadata.scala | 31 ----------
 .../main/scala/kafka/log/ProducerIdMapping.scala   | 13 ++--
 .../main/scala/kafka/server/DelayedOperation.scala | 10 +--
 .../kafka/server/epoch/LeaderEpochFileCache.scala  |  2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |  3 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  8 +--
 gradle/findbugs-exclude.xml                        | 71 ++++++++++++++++++++--
 jenkins.sh                                         |  2 +-
 9 files changed, 93 insertions(+), 56 deletions(-)
8e7516ea2e6b99a6e9a3fb5a958e62b1fb186cf9

 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 26 +++++++++++++++++-----
 .../unit/kafka/tools/ConsoleConsumerTest.scala     |  7 +++---
 2 files changed, 25 insertions(+), 8 deletions(-)
d2f5589afc4505c2e2c11e125ad1be69eb9fe645

 docs/security.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2adaa50f552b38eac36ead8bd559a7581e7ff81f

 .../java/org/apache/kafka/streams/state/ReadOnlySessionStore.java    | 4 ++++
 .../java/org/apache/kafka/streams/state/ReadOnlyWindowStore.java     | 5 ++++-
 2 files changed, 8 insertions(+), 1 deletion(-)
7c58351e9e7d109a54dfa319437ca5f891164e5b

 .../java/org/apache/kafka/streams/state/ReadOnlySessionStore.java    | 4 ++++
 .../java/org/apache/kafka/streams/state/ReadOnlyWindowStore.java     | 5 ++++-
 2 files changed, 8 insertions(+), 1 deletion(-)
d0e7c6b9304b23ced046934c799df0cba39c28e5

 .../consumer/RetriableCommitFailedException.java   |   7 +-
 .../consumer/internals/AbstractCoordinator.java    |  36 ++---
 .../consumer/internals/ConsumerCoordinator.java    |  15 ++-
 .../clients/consumer/internals/RequestFuture.java  |   2 +-
 .../errors/CoordinatorLoadInProgressException.java |  39 ++++++
 .../errors/CoordinatorNotAvailableException.java   |  43 ++++++
 .../GroupCoordinatorNotAvailableException.java     |   5 +-
 .../errors/GroupLoadInProgressException.java       |   5 +-
 .../common/errors/InvalidTxnTimeoutException.java  |  33 +++++
 .../common/errors/NotCoordinatorException.java     |  38 ++++++
 .../errors/NotCoordinatorForGroupException.java    |   5 +-
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   2 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  24 ++--
 .../org/apache/kafka/common/protocol/Protocol.java |  57 +++++---
 .../kafka/common/requests/AbstractRequest.java     |   4 +-
 .../kafka/common/requests/AbstractResponse.java    |   4 +-
 .../common/requests/DescribeGroupsResponse.java    |   6 +-
 .../common/requests/FindCoordinatorRequest.java    | 145 +++++++++++++++++++++
 .../common/requests/FindCoordinatorResponse.java   |  95 ++++++++++++++
 .../common/requests/GroupCoordinatorRequest.java   |  89 -------------
 .../common/requests/GroupCoordinatorResponse.java  |  85 ------------
 .../kafka/common/requests/HeartbeatResponse.java   |   2 +-
 .../kafka/common/requests/InitPidRequest.java      |  31 ++++-
 .../kafka/common/requests/JoinGroupResponse.java   |   4 +-
 .../kafka/common/requests/ListGroupsResponse.java  |   2 +-
 .../common/requests/OffsetCommitResponse.java      |   4 +-
 .../kafka/common/requests/OffsetFetchResponse.java |   6 +-
 .../kafka/common/requests/SyncGroupResponse.java   |   2 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  14 +-
 .../internals/AbstractCoordinatorTest.java         |   6 +-
 .../internals/ConsumerCoordinatorTest.java         |  42 +++---
 .../kafka/common/requests/RequestResponseTest.java |  30 +++--
 .../runtime/distributed/WorkerCoordinatorTest.java |   6 +-
 .../kafka/connect/util/KafkaBasedLogTest.java      |   2 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |  10 +-
 .../scala/kafka/api/GroupCoordinatorRequest.scala  |   4 +-
 .../kafka/common/OffsetMetadataAndError.scala      |   6 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   8 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |  62 ++++-----
 .../kafka/coordinator/GroupMetadataManager.scala   |  12 +-
 .../kafka/coordinator/TransactionCoordinator.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  42 +++---
 .../kafka/api/AuthorizerIntegrationTest.scala      |  12 +-
 .../kafka/admin/DescribeConsumerGroupTest.scala    |  43 +++---
 .../api/RequestResponseSerializationTest.scala     |   2 +-
 .../coordinator/GroupCoordinatorResponseTest.scala |  12 +-
 .../coordinator/GroupMetadataManagerTest.scala     |  20 +--
 47 files changed, 717 insertions(+), 408 deletions(-)
749e9e14c7a1b8a97f79a2d852d8c8647b55b38e

 .../apache/kafka/clients/consumer/RetriableCommitFailedException.java | 2 +-
 .../apache/kafka/clients/consumer/internals/ConsumerCoordinator.java  | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)
629ee94d27d776c829d4dbb60672d947addd6a26

 core/src/main/scala/kafka/utils/ZkUtils.scala | 43 ++++++++++++++-------------
 1 file changed, 22 insertions(+), 21 deletions(-)
c31958eb0d547b10a388fc63fcc3cbe00dec27f2

 core/src/main/scala/kafka/utils/ZkUtils.scala | 43 ++++++++++++++-------------
 1 file changed, 22 insertions(+), 21 deletions(-)
82a8e83de622f777a81e9ea0c01d6832f44e7956

 .../kafka/server/checkpoints/CheckpointFile.scala  | 13 +++---
 .../checkpoints/LeaderEpochCheckpointFile.scala    | 49 +++++++++++-----------
 .../server/checkpoints/OffsetCheckpointFile.scala  | 48 +++++++++++----------
 .../checkpoints/OffsetCheckpointFileTest.scala     | 15 ++++++-
 4 files changed, 68 insertions(+), 57 deletions(-)
bf01467b6e866ec0e5bdab9bf6387689951e63f8

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
08a5b6421c69dec46487ff0136020dd0030fe34a

 .../scala/kafka/admin/ZkSecurityMigrator.scala     |  4 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 93 +++++++++++++++-------
 .../kafka/security/auth/ZkAuthorizationTest.scala  | 28 ++++---
 3 files changed, 80 insertions(+), 45 deletions(-)
67fc2a91a6e80bfda30537c7c95cd9ce396d4e7d

 .../scala/kafka/admin/ZkSecurityMigrator.scala     |  4 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 93 +++++++++++++++-------
 .../kafka/security/auth/ZkAuthorizationTest.scala  | 28 ++++---
 3 files changed, 80 insertions(+), 45 deletions(-)
5cf64f06a877a181d12a2ae2390516ba1a572135

 .../common/record/AbstractLegacyRecordBatch.java   |   2 +-
 .../apache/kafka/common/record/MemoryRecords.java  |  31 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  33 +-
 .../apache/kafka/common/record/RecordBatch.java    |   2 +-
 .../kafka/common/requests/EpochEndOffset.java      |   4 +-
 .../common/record/MemoryRecordsBuilderTest.java    |  33 +-
 .../kafka/common/record/MemoryRecordsTest.java     |   6 +-
 core/src/main/scala/kafka/log/Log.scala            |  11 +-
 core/src/main/scala/kafka/log/LogValidator.scala   | 153 +++++----
 .../main/scala/kafka/log/ProducerIdMapping.scala   |   2 +-
 .../kafka/server/epoch/LeaderEpochFileCache.scala  |   5 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |  21 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 214 ++++++------
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 368 ++++++++++++++-------
 ...chDrivenReplicationProtocolAcceptanceTest.scala |   3 +-
 15 files changed, 529 insertions(+), 359 deletions(-)
a4c50687f6a5a5a7ea9e523df7c55355441c7ffa

 clients/src/main/java/org/apache/kafka/clients/InFlightRequests.java  | 2 +-
 clients/src/test/java/org/apache/kafka/clients/NetworkClientTest.java | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)
47f9e8fe2cf7911e24d87ee6527362b2cc9ec306

 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java | 1 +
 1 file changed, 1 insertion(+)
e19bf3f24466cd8dcd6c11f2d7cbc5796600fb88

 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java | 1 +
 1 file changed, 1 insertion(+)
ab148f39ae64ecbaa84f49c38b3cab8a0a0fd846

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  4 +-
 .../kafka/consumer/ConsumerFetcherThread.scala     |  1 -
 .../src/main/scala/kafka/consumer/TopicCount.scala |  9 --
 .../main/scala/kafka/javaapi/FetchRequest.scala    | 12 +--
 .../main/scala/kafka/javaapi/FetchResponse.scala   | 11 +--
 .../kafka/javaapi/GroupCoordinatorResponse.scala   | 11 +--
 .../scala/kafka/javaapi/OffsetCommitRequest.scala  | 16 ++--
 .../scala/kafka/javaapi/OffsetFetchRequest.scala   | 16 ++--
 .../main/scala/kafka/javaapi/OffsetRequest.scala   | 17 ++--
 .../main/scala/kafka/javaapi/OffsetResponse.scala  | 16 ++--
 .../kafka/javaapi/TopicMetadataResponse.scala      | 11 +--
 core/src/main/scala/kafka/log/Log.scala            | 19 ++---
 core/src/main/scala/kafka/log/LogManager.scala     |  5 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  9 +-
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |  3 +-
 .../kafka/server/BrokerMetadataCheckpoint.scala    | 14 ++--
 .../scala/kafka/server/ClientQuotaManager.scala    |  2 +-
 .../kafka/server/checkpoints/CheckpointFile.scala  |  8 +-
 .../main/scala/kafka/tools/ImportZkOffsets.scala   | 31 +++----
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 17 ++--
 core/src/main/scala/kafka/utils/FileLock.scala     |  6 +-
 gradle/findbugs-exclude.xml                        | 98 ++++++++++++++++++++--
 22 files changed, 204 insertions(+), 132 deletions(-)
359a68510801a22630a7af275c9935fb2d4c8dbf

 .../requests/OffsetsForLeaderEpochRequest.java     | 77 +++++-------------
 .../requests/OffsetsForLeaderEpochResponse.java    | 90 +++++++---------------
 2 files changed, 46 insertions(+), 121 deletions(-)
865d82af2cc050d10544d70b95468da90c1d800b

 checkstyle/suppressions.xml                        |   4 +
 .../apache/kafka/clients/producer/Producer.java    |  12 +-
 .../common/errors/InvalidPidMappingException.java  |  23 +++
 .../common/errors/InvalidTxnStateException.java    |  23 +++
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   7 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  36 ++--
 .../org/apache/kafka/common/protocol/Protocol.java | 185 ++++++++++++++++++-
 .../kafka/common/record/ControlRecordType.java     |   8 +-
 .../kafka/common/requests/AbstractRequest.java     |  15 ++
 .../kafka/common/requests/AbstractResponse.java    |  10 ++
 .../common/requests/AddOffsetsToTxnRequest.java    | 107 +++++++++++
 .../common/requests/AddOffsetsToTxnResponse.java   |  60 +++++++
 .../common/requests/AddPartitionsToTxnRequest.java | 136 ++++++++++++++
 .../requests/AddPartitionsToTxnResponse.java       |  60 +++++++
 .../kafka/common/requests/EndTxnRequest.java       | 107 +++++++++++
 .../kafka/common/requests/EndTxnResponse.java      |  59 +++++++
 .../kafka/common/requests/FetchResponse.java       |  20 +--
 .../kafka/common/requests/InitPidResponse.java     |   4 +-
 .../kafka/common/requests/TransactionResult.java   |  34 ++++
 .../common/requests/TxnOffsetCommitRequest.java    | 195 +++++++++++++++++++++
 .../common/requests/TxnOffsetCommitResponse.java   | 102 +++++++++++
 .../common/requests/WriteTxnMarkersRequest.java    | 186 ++++++++++++++++++++
 .../common/requests/WriteTxnMarkersResponse.java   | 130 ++++++++++++++
 .../kafka/common/requests/RequestResponseTest.java |  89 +++++++++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  32 +++-
 25 files changed, 1597 insertions(+), 47 deletions(-)
2f4f3b957d753debd8d10c98a2c867211064503e

 gradle/findbugs-exclude.xml                        | 24 +++++++++++++++++++
 .../kstream/internals/KStreamWindowReduce.java     |  6 ++---
 .../kafka/streams/processor/TopologyBuilder.java   | 28 ++++++++++------------
 .../processor/internals/ProcessorStateManager.java |  5 ++--
 .../internals/StreamPartitionAssignor.java         | 15 ++++++++++++
 .../streams/processor/internals/StreamThread.java  | 13 +++++-----
 .../streams/state/internals/MemoryLRUCache.java    |  2 +-
 7 files changed, 65 insertions(+), 28 deletions(-)
76a10e23f0a3d89e4a0a88854d0ec3926e7f6827

 .../kafka/common/requests/OffsetsForLeaderEpochRequest.java       | 8 ++++----
 core/src/main/scala/kafka/api/ApiVersion.scala                    | 5 ++---
 2 files changed, 6 insertions(+), 7 deletions(-)
0baea2ac13532981f3fea11e5dfc6da5aafaeaa8

 checkstyle/suppressions.xml                        |   2 +
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   3 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  52 ++
 .../apache/kafka/common/record/MemoryRecords.java  |  29 +-
 .../kafka/common/requests/AbstractRequest.java     |   3 +
 .../kafka/common/requests/AbstractResponse.java    |   2 +
 .../kafka/common/requests/EpochEndOffset.java      |  81 +++
 .../requests/OffsetsForLeaderEpochRequest.java     | 175 +++++
 .../requests/OffsetsForLeaderEpochResponse.java    | 132 ++++
 .../kafka/common/requests/RequestResponseTest.java |  23 +
 .../org/apache/kafka/test/MockDeserializer.java    |  25 +-
 config/log4j.properties                            |   2 +-
 core/src/main/scala/kafka/api/ApiVersion.scala     |  15 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  11 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |   6 +-
 .../kafka/consumer/ConsumerFetcherThread.scala     |  12 +-
 core/src/main/scala/kafka/log/Log.scala            |  62 +-
 .../main/scala/kafka/log/LogCleanerManager.scala   |   4 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  21 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  11 +-
 core/src/main/scala/kafka/log/LogValidator.scala   |  32 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  95 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  12 +
 .../main/scala/kafka/server/OffsetCheckpoint.scala | 124 ----
 .../kafka/server/ReplicaFetcherBlockingSend.scala  | 105 +++
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 198 +++---
 .../main/scala/kafka/server/ReplicaManager.scala   |  41 +-
 .../kafka/server/checkpoints/CheckpointFile.scala  | 114 ++++
 .../checkpoints/LeaderEpochCheckpointFile.scala    |  67 ++
 .../server/checkpoints/OffsetCheckpointFile.scala  |  60 ++
 .../kafka/server/epoch/LeaderEpochFileCache.scala  | 224 +++++++
 .../kafka/api/AuthorizerIntegrationTest.scala      |  16 +-
 .../kafka/api/EndToEndClusterIdTest.scala          |  11 +-
 .../kafka/api/ProducerCompressionTest.scala        |   5 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   7 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  12 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  25 +
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 225 ++++++-
 .../kafka/server/AbstractFetcherThreadTest.scala   |  15 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   5 +
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |   5 +-
 .../kafka/server/ReplicaFetcherThreadTest.scala    | 402 ++++++++++++
 .../kafka/server/ReplicaManagerQuotasTest.scala    |   2 +-
 .../unit/kafka/server/ReplicationQuotasTest.scala  |   2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   3 +-
 .../LeaderEpochCheckpointFileTest.scala            |  72 ++
 .../checkpoints/OffsetCheckpointFileTest.scala     |  89 +++
 ...chDrivenReplicationProtocolAcceptanceTest.scala | 410 ++++++++++++
 .../server/epoch/LeaderEpochFileCacheTest.scala    | 721 +++++++++++++++++++++
 .../server/epoch/LeaderEpochIntegrationTest.scala  | 283 ++++++++
 .../server/epoch/OffsetsForLeaderEpochTest.scala   |  98 +++
 .../util/ReplicaFetcherMockBlockingSend.scala      |  80 +++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 .../tests/core/zookeeper_security_upgrade_test.py  |   1 -
 54 files changed, 3908 insertions(+), 327 deletions(-)
51ae9c2491e90da88391467b8e25f6e98fd660dc

 .../processor/internals/InternalTopicManager.java  |  32 +++-
 .../internals/StreamPartitionAssignor.java         |  12 +-
 .../streams/processor/internals/StreamThread.java  |  65 ++++---
 .../processor/internals/StreamsKafkaClient.java    |  19 +-
 .../internals/InternalTopicManagerTest.java        |  19 +-
 .../kafka/streams/tests/SmokeTestClient.java       |  41 +++-
 .../kafka/streams/tests/SmokeTestDriver.java       |  20 +-
 .../kafka/test/MockInternalTopicManager.java       |   3 +-
 tests/kafkatest/services/streams.py                |   3 +-
 .../kafkatest/tests/streams/streams_bounce_test.py |   4 +-
 .../tests/streams/streams_broker_bounce_test.py    | 213 +++++++++++++++++++++
 .../kafkatest/tests/streams/streams_smoke_test.py  |   4 +-
 12 files changed, 372 insertions(+), 63 deletions(-)
09509949536bc309ba9ab95c7c2fba2111bac056

 .../streams/processor/internals/StreamThread.java  |  74 +++++----
 ...StreamsFineGrainedAutoResetIntegrationTest.java | 172 +++++++++++++++------
 2 files changed, 173 insertions(+), 73 deletions(-)
4def30c6720b45f6a766a1fc394a75230b66ef26

 .../kafka/common/requests/ProduceRequest.java      | 52 +++++++++++++++++++---
 .../kafka/common/requests/RequestResponseTest.java | 43 ++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   | 14 +++---
 3 files changed, 97 insertions(+), 12 deletions(-)
5edb09fcb86e2b06b1da233d94cc3631dc8eca03

 .../main/java/org/apache/kafka/connect/runtime/PluginDiscovery.java   | 2 +-
 .../main/java/org/apache/kafka/connect/transforms/ExtractField.java   | 4 ++--
 .../src/main/java/org/apache/kafka/connect/transforms/HoistField.java | 4 ++--
 .../main/java/org/apache/kafka/connect/transforms/InsertField.java    | 4 ++--
 .../src/main/java/org/apache/kafka/connect/transforms/MaskField.java  | 4 ++--
 .../main/java/org/apache/kafka/connect/transforms/ReplaceField.java   | 4 +++-
 .../java/org/apache/kafka/connect/transforms/SetSchemaMetadata.java   | 4 ++--
 7 files changed, 14 insertions(+), 12 deletions(-)
7028384bfb4c8d761c15bc11e2156278249e721a

 .../kafka/streams/state/ReadOnlyWindowStore.java    | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)
b611cfa5c0f4941a491781424afd9b699bdb894e

 .../kafka/streams/state/ReadOnlyWindowStore.java    | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)
8e35721ce811cb0807b45d3a18c55329f2f79c4c

 .../apache/kafka/streams/examples/pageview/PageViewTypedDemo.java  | 7 ++++---
 .../kafka/streams/examples/pageview/PageViewUntypedDemo.java       | 5 +++--
 .../main/java/org/apache/kafka/streams/examples/pipe/PipeDemo.java | 5 +++--
 .../org/apache/kafka/streams/examples/wordcount/WordCountDemo.java | 5 +++--
 .../kafka/streams/examples/wordcount/WordCountProcessorDemo.java   | 5 +++--
 5 files changed, 16 insertions(+), 11 deletions(-)
6ba98f6e5ad8776b7268441b5392330496565814

 .../apache/kafka/streams/examples/pageview/PageViewTypedDemo.java  | 7 ++++---
 .../kafka/streams/examples/pageview/PageViewUntypedDemo.java       | 5 +++--
 .../main/java/org/apache/kafka/streams/examples/pipe/PipeDemo.java | 5 +++--
 .../org/apache/kafka/streams/examples/wordcount/WordCountDemo.java | 5 +++--
 .../kafka/streams/examples/wordcount/WordCountProcessorDemo.java   | 5 +++--
 5 files changed, 16 insertions(+), 11 deletions(-)
2dfeff064a5f0a5adfb5adb29015e0fdcc85c45a

 .../org/apache/kafka/streams/KafkaStreams.java     | 24 ++++++++-----
 .../streams/processor/internals/StreamThread.java  | 40 +++++++++-------------
 2 files changed, 32 insertions(+), 32 deletions(-)
afeadbef50ee8cb5c23de26c1b2a5ad2c7ad941e

 .../streams/processor/internals/StreamThread.java  |  51 ++++--
 ...StreamsFineGrainedAutoResetIntegrationTest.java | 172 +++++++++++++++------
 2 files changed, 160 insertions(+), 63 deletions(-)
d5fb7364aebf293c621b804a4585eb9ef1001864

 .../consumer/internals/AbstractCoordinator.java    | 20 ++++---
 .../clients/producer/internals/ProducerBatch.java  |  7 ++-
 .../apache/kafka/common/config/AbstractConfig.java |  6 +-
 .../kafka/common/metrics/stats/Histogram.java      |  3 +-
 .../common/security/kerberos/KerberosLogin.java    |  2 +-
 .../java/org/apache/kafka/common/utils/Bytes.java  |  2 +
 gradle/findbugs-exclude.xml                        | 66 +++++++++++++++++++---
 7 files changed, 82 insertions(+), 24 deletions(-)
97e61d4ae2feaf0551e75fa8cdd041f49f42a9a5

 .../main/java/org/apache/kafka/streams/KafkaStreams.java    | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)
d4c4bcf017a1b770dca71868b97d37ec7327ea00

 .../main/java/org/apache/kafka/common/config/ConfigDef.java | 13 ++++++-------
 .../java/org/apache/kafka/common/config/ConfigDefTest.java  |  6 ++++++
 .../org/apache/kafka/connect/runtime/AbstractHerder.java    |  4 ++--
 .../rest/resources/ConnectorPluginsResourceTest.java        |  6 +++---
 4 files changed, 17 insertions(+), 12 deletions(-)
65c8f680ee4bf0efad82843736b1c63bc89c7d61

 .../streams/kstream/internals/KStreamImpl.java     | 12 ++---
 .../streams/kstream/internals/SessionKeySerde.java | 17 +++---
 .../internals/WindowedStreamPartitioner.java       |  8 +--
 .../apache/kafka/streams/state/StateSerdes.java    | 61 ++++++++++++----------
 .../state/internals/CachingKeyValueStore.java      |  3 +-
 .../state/internals/CachingSessionStore.java       | 14 +++--
 .../state/internals/CachingWindowStore.java        |  7 +--
 .../internals/ChangeLoggingKeyValueBytesStore.java |  9 +++-
 .../internals/ChangeLoggingKeyValueStore.java      |  3 +-
 .../ChangeLoggingSegmentedBytesStore.java          |  9 +++-
 .../internals/InMemoryKeyValueLoggedStore.java     | 10 ++--
 .../internals/InMemoryKeyValueStoreSupplier.java   |  8 +--
 .../streams/state/internals/MemoryLRUCache.java    |  8 +--
 .../MergedSortedCacheSessionStoreIterator.java     |  4 +-
 .../internals/RocksDBSegmentedBytesStore.java      |  3 ++
 .../state/internals/RocksDBSessionStore.java       | 14 +++--
 .../streams/state/internals/RocksDBStore.java      |  8 +--
 .../state/internals/RocksDBWindowStore.java        |  3 +-
 .../state/internals/SegmentedBytesStore.java       |  8 +++
 .../streams/state/internals/SessionKeySchema.java  | 10 +++-
 .../state/internals/WindowStoreKeySchema.java      |  7 ++-
 .../streams/state/internals/WindowStoreUtils.java  |  5 +-
 .../kstream/internals/SessionKeySerdeTest.java     | 10 ++--
 .../internals/WindowedStreamPartitionerTest.java   |  2 +-
 .../streams/state/KeyValueStoreTestDriver.java     |  8 +--
 .../state/internals/CachingSessionStoreTest.java   |  2 +-
 .../state/internals/CachingWindowStoreTest.java    |  2 +-
 .../CompositeReadOnlyKeyValueStoreTest.java        |  2 +-
 .../MergedSortedCacheSessionStoreIteratorTest.java |  2 +-
 .../internals/RocksDBSegmentedBytesStoreTest.java  |  4 +-
 .../state/internals/StateStoreTestUtils.java       | 13 +++--
 .../state/internals/WrappingStoreProviderTest.java |  4 +-
 32 files changed, 176 insertions(+), 104 deletions(-)
d640259110be5113aca65129bb10de90d2a09527

 .../connect/runtime/rest/resources/ConnectorPluginsResource.java    | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)
0df910c0345ce7a667aa3276a9fea15851df50f1

 .../processor/internals/StateDirectoryTest.java    | 106 ++++++++++++++-------
 1 file changed, 73 insertions(+), 33 deletions(-)
aea14651184476940c69238535de5143e61f4c31

 .../streams/kstream/internals/KStreamImpl.java     | 12 ++---
 .../streams/kstream/internals/SessionKeySerde.java | 17 +++----
 .../internals/WindowedStreamPartitioner.java       |  8 +--
 .../apache/kafka/streams/state/StateSerdes.java    | 57 ++++++++++++----------
 .../state/internals/CachingKeyValueStore.java      |  8 +--
 .../state/internals/CachingSessionStore.java       | 23 +++++----
 .../state/internals/CachingWindowStore.java        | 14 +++---
 .../internals/ChangeLoggingKeyValueBytesStore.java |  9 +++-
 .../internals/ChangeLoggingKeyValueStore.java      |  7 +--
 .../ChangeLoggingSegmentedBytesStore.java          |  9 +++-
 .../internals/InMemoryKeyValueLoggedStore.java     | 10 ++--
 .../state/internals/InMemoryKeyValueStore.java     |  8 +--
 .../streams/state/internals/MemoryLRUCache.java    |  8 +--
 .../MergedSortedCacheSessionStoreIterator.java     |  4 +-
 .../internals/RocksDBSegmentedBytesStore.java      |  3 ++
 .../state/internals/RocksDBSessionStore.java       | 16 ++++--
 .../internals/RocksDBSessionStoreSupplier.java     |  6 +--
 .../streams/state/internals/RocksDBStore.java      |  8 +--
 .../state/internals/RocksDBWindowStore.java        |  7 +--
 .../state/internals/SegmentedBytesStore.java       |  8 +++
 .../streams/state/internals/SessionKeySchema.java  | 10 +++-
 .../streams/state/internals/WindowKeySchema.java   |  7 ++-
 .../streams/state/internals/WindowStoreUtils.java  |  5 +-
 .../internals/WrappedSessionStoreIterator.java     |  4 +-
 .../kstream/internals/SessionKeySerdeTest.java     | 16 +++---
 .../internals/WindowedStreamPartitionerTest.java   |  2 +-
 .../streams/state/KeyValueStoreTestDriver.java     | 34 +++++++------
 .../state/internals/CachingSessionStoreTest.java   |  6 ++-
 .../state/internals/CachingWindowStoreTest.java    |  2 +-
 .../CompositeReadOnlyKeyValueStoreTest.java        |  2 +-
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |  2 +-
 ...SortedCacheWrappedSessionStoreIteratorTest.java |  2 +-
 .../internals/RocksDBSegmentedBytesStoreTest.java  |  9 ++--
 .../state/internals/RocksDBSessionStoreTest.java   |  5 +-
 .../state/internals/SessionKeySchemaTest.java      |  1 +
 .../state/internals/StateStoreTestUtils.java       | 16 ++++--
 .../state/internals/StoreChangeLoggerTest.java     |  6 +--
 .../state/internals/WrappingStoreProviderTest.java |  4 +-
 38 files changed, 229 insertions(+), 146 deletions(-)
49f80b2360ab55274ad28405352596f9d560ec1c

 .../org/apache/kafka/streams/StreamsConfig.java    |   2 +-
 .../processor/internals/InternalTopicManager.java  |  32 +++-
 .../internals/StreamPartitionAssignor.java         |  13 +-
 .../streams/processor/internals/StreamThread.java  |  53 +++--
 .../processor/internals/StreamsKafkaClient.java    |  20 +-
 .../internals/InternalTopicManagerTest.java        |  15 +-
 .../kafka/streams/tests/SmokeTestClient.java       |  29 ++-
 .../kafka/streams/tests/SmokeTestDriver.java       |  20 +-
 .../kafka/test/MockInternalTopicManager.java       |   5 +-
 .../kafkatest/tests/streams/streams_bounce_test.py |   4 +-
 .../tests/streams/streams_broker_bounce_test.py    | 213 +++++++++++++++++++++
 11 files changed, 354 insertions(+), 52 deletions(-)
5a57913d57d8b9dc061688f787a5bef9be626361

 .../processor/internals/MinTimestampTracker.java   |  20 ++--
 .../internals/MinTimestampTrackerTest.java         | 107 +++++++++------------
 2 files changed, 59 insertions(+), 68 deletions(-)
444110eacb88a5f6cffbdb3a773f5d50eca2aea8

 .../org/apache/kafka/streams/processor/internals/StreamThread.java    | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
8c0005740ab8936382559149332af9cb02391f00

 .../rest/resources/ConnectorPluginsResource.java   |  23 ++-
 .../resources/ConnectorPluginsResourceTest.java    | 215 ++++++++++++++++++++-
 2 files changed, 224 insertions(+), 14 deletions(-)
9160810072e540a3a037481505aaaa23e3b50546

 .../rest/resources/ConnectorPluginsResource.java   |  23 ++-
 .../resources/ConnectorPluginsResourceTest.java    | 215 ++++++++++++++++++++-
 2 files changed, 224 insertions(+), 14 deletions(-)
54bf2fb5ff8f1841aea2df2e6fa76f8a05fddfba

 .../org/apache/kafka/connect/data/SchemaBuilder.java  | 19 +++++++++----------
 .../apache/kafka/connect/data/SchemaBuilderTest.java  | 18 ++++++++++++++++++
 2 files changed, 27 insertions(+), 10 deletions(-)
75e213e55036850abef77e4641af9b9071465f80

 .../org/apache/kafka/connect/data/SchemaBuilder.java    | 17 ++++++++---------
 .../apache/kafka/connect/data/SchemaBuilderTest.java    | 12 ++++++++++++
 2 files changed, 20 insertions(+), 9 deletions(-)
f812a8fd93c37cb27db07505dd5f8f29463906a1

 .../org/apache/kafka/connect/runtime/Worker.java   |  6 ++--
 .../runtime/distributed/DistributedHerder.java     | 15 ++++++++++
 .../runtime/rest/entities/ConnectorStateInfo.java  | 16 ++++++++++
 .../kafka/connect/tools/SchemaSourceTask.java      |  6 ++--
 .../apache/kafka/connect/util/ConnectorTaskId.java |  2 +-
 gradle/findbugs-exclude.xml                        | 34 ++++++++++++++++++++++
 6 files changed, 71 insertions(+), 8 deletions(-)
ca2979f847ead39b4480f31085c5cf26bb102080

 core/src/main/scala/kafka/tools/MirrorMaker.scala                 | 8 ++++----
 .../integration/kafka/tools/MirrorMakerIntegrationTest.scala      | 3 +--
 2 files changed, 5 insertions(+), 6 deletions(-)
b9b2cfc28c055745f606ba1a20c5e8e428acefcf

 .../clients/producer/internals/ProducerBatch.java  |  8 ++++
 .../producer/internals/RecordAccumulator.java      | 14 +++++--
 .../kafka/common/record/MemoryRecordsBuilder.java  | 47 +++++++++++++++++++---
 core/src/main/scala/kafka/log/Log.scala            |  2 -
 core/src/main/scala/kafka/log/LogCleaner.scala     |  2 +-
 5 files changed, 61 insertions(+), 12 deletions(-)
d9db9ee0722369b69c7117f5ceb7a0b5ad404118

 .../kafka/connect/runtime/AbstractHerder.java      | 36 +++++++++++++++++++
 .../runtime/distributed/DistributedHerder.java     |  7 +---
 .../runtime/standalone/StandaloneHerder.java       |  8 ++---
 .../runtime/standalone/StandaloneHerderTest.java   | 41 ++++++++++++++++++++++
 4 files changed, 80 insertions(+), 12 deletions(-)
040fde8ec1f94856799c6bb47fa23a73c20bda66

 .../kafka/connect/runtime/AbstractHerder.java      | 36 +++++++++++++++++++
 .../runtime/distributed/DistributedHerder.java     |  7 +---
 .../runtime/standalone/StandaloneHerder.java       |  8 ++---
 .../runtime/standalone/StandaloneHerderTest.java   | 41 ++++++++++++++++++++++
 4 files changed, 80 insertions(+), 12 deletions(-)
800d29648bc370643d6dd1ead861792d7585c843

 .../internals/KStreamWindowAggregateTest.java      | 498 ++++++++++-----------
 1 file changed, 243 insertions(+), 255 deletions(-)
f54b61909d525547d65123c02bbd36d92ccee5da

 .../producer/internals/RecordAccumulator.java       |  2 +-
 .../apache/kafka/common/record/MemoryRecords.java   | 21 +++++++++------------
 .../producer/internals/RecordAccumulatorTest.java   | 20 +++++++++++++++++++-
 3 files changed, 29 insertions(+), 14 deletions(-)
1ba8b40b3421ad0d23787ba9a1a4b635d8f11d91

 .../kafka/clients/consumer/internals/ConsumerCoordinatorTest.java    | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
3364f12bc240e3fefa6a467519ef608fa768917c

 .../kafka/clients/producer/KafkaProducer.java      |  2 +-
 .../org/apache/kafka/streams/KafkaStreams.java     | 36 ++++++++++++----------
 .../streams/processor/internals/StreamThread.java  |  8 ++---
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  2 +-
 4 files changed, 26 insertions(+), 22 deletions(-)
bdf4cba047334943aa8357585c4fb379b27e9ffd

 checkstyle/checkstyle.xml                          |   4 +-
 checkstyle/suppressions.xml                        |   3 +
 .../apache/kafka/clients/NetworkClientUtils.java   | 103 ++++++
 .../kafka/clients/producer/KafkaProducer.java      | 184 +++++++---
 .../kafka/clients/producer/MockProducer.java       |   1 -
 .../kafka/clients/producer/ProducerConfig.java     |  20 +-
 .../kafka/clients/producer/TransactionState.java   | 135 +++++++
 .../clients/producer/internals/ProducerBatch.java  |  19 +-
 .../producer/internals/RecordAccumulator.java      |  53 ++-
 .../kafka/clients/producer/internals/Sender.java   | 180 ++++++++--
 .../errors/DuplicateSequenceNumberException.java   |  24 ++
 .../common/errors/OutOfOrderSequenceException.java |  24 ++
 .../common/errors/ProducerFencedException.java     |  24 ++
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   3 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  12 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  25 ++
 .../apache/kafka/common/protocol/types/Struct.java |   4 +
 .../apache/kafka/common/protocol/types/Type.java   |  30 ++
 .../common/record/AbstractLegacyRecordBatch.java   |   5 +
 .../kafka/common/record/AbstractRecordBatch.java   |   5 +
 .../apache/kafka/common/record/MemoryRecords.java  |  20 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  26 +-
 .../apache/kafka/common/record/RecordBatch.java    |   5 +
 .../kafka/common/requests/AbstractRequest.java     |   3 +
 .../kafka/common/requests/AbstractResponse.java    |   2 +
 .../kafka/common/requests/InitPidRequest.java      |  81 +++++
 .../kafka/common/requests/InitPidResponse.java     |  80 +++++
 .../org/apache/kafka/common/utils/ByteUtils.java   |  10 +
 .../producer/internals/RecordAccumulatorTest.java  |  44 ++-
 .../clients/producer/internals/SenderTest.java     | 250 +++++++++++--
 .../producer/internals/TransactionStateTest.java   |  61 ++++
 .../kafka/common/record/MemoryRecordsTest.java     |   2 +-
 .../kafka/common/requests/RequestResponseTest.java |  11 +
 .../apache/kafka/common/utils/ByteUtilsTest.java   |  10 +
 .../controller/ControllerChannelManager.scala      |  12 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |  13 +-
 .../main/scala/kafka/coordinator/PidMetadata.scala |  31 ++
 .../kafka/coordinator/ProducerIdManager.scala      | 153 ++++++++
 .../kafka/coordinator/TransactionCoordinator.scala |  92 +++++
 core/src/main/scala/kafka/log/Log.scala            | 157 ++++++--
 core/src/main/scala/kafka/log/LogCleaner.scala     |  19 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |   1 +
 core/src/main/scala/kafka/log/LogManager.scala     |  64 +++-
 core/src/main/scala/kafka/log/LogValidator.scala   |  16 +-
 .../main/scala/kafka/log/ProducerIdMapping.scala   | 394 +++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  52 ++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  21 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  54 +--
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   7 +-
 .../kafka/utils/NetworkClientBlockingOps.scala     | 145 --------
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  36 +-
 .../integration/kafka/api/ProducerBounceTest.scala |  85 +++--
 .../coordinator/GroupCoordinatorResponseTest.scala |   7 +-
 .../coordinator/GroupMetadataManagerTest.scala     |   5 +-
 .../kafka/coordinator/ProducerIdManagerTest.scala  | 105 ++++++
 .../coordinator/TransactionCoordinatorTest.scala   |  93 +++++
 .../unit/kafka/log/BrokerCompressionTest.scala     |   2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   2 +-
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |   2 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |   4 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |  29 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 323 ++++++++++++++---
 .../unit/kafka/log/ProducerIdMappingTest.scala     | 224 ++++++++++++
 .../unit/kafka/server/ReplicationQuotasTest.scala  |   1 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 .../test/scala/unit/kafka/utils/ZkUtilsTest.scala  |  15 +
 tests/kafkatest/services/verifiable_producer.py    |  16 +-
 tests/kafkatest/tests/core/replication_test.py     |  24 +-
 tests/kafkatest/tests/produce_consume_validate.py  |  13 +-
 70 files changed, 3124 insertions(+), 563 deletions(-)
5b8541e5e3b61d483f03993a38942df2831d6f08

 jenkins.sh | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)
1ce6aa550324f74c41fc404ce9f4a9e51f7c862e

 docs/security.html | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
76f8028d9d6473e6ec084e4258bf0e2d84f8a428

 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java | 7 +++++++
 1 file changed, 7 insertions(+)
5f88cf79fb51996e77614aafdfbb15e4989e159b

 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)
e3c5f41229f1cd07bd5645e596348ebb14c02370

 tests/kafkatest/tests/client/consumer_test.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
93d451ceeb00a150bbbdae3f0601620b902b7c87

 tests/kafkatest/tests/client/consumer_test.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
4b8c73615e778c244af8394dfbd5befac005c419

 .../kafka/streams/processor/TopologyBuilder.java   | 185 +++++++++++++--------
 .../integration/RegexSourceIntegrationTest.java    |  30 ++++
 .../streams/processor/TopologyBuilderTest.java     |  34 ++++
 3 files changed, 178 insertions(+), 71 deletions(-)
15e0234a5f4976facd4cfe61b91cfcdec6f6083c

 .../kafka/streams/processor/TopologyBuilder.java   | 185 +++++++++++++--------
 .../integration/RegexSourceIntegrationTest.java    |  30 ++++
 .../streams/processor/TopologyBuilderTest.java     |  34 ++++
 3 files changed, 178 insertions(+), 71 deletions(-)
4e92fd5f7411da155aeec166901f5f6f89ca7ba2

 vagrant/base.sh | 22 +++++++++++++++++++++-
 1 file changed, 21 insertions(+), 1 deletion(-)
dd71e4a8d830c9de40b5ec3f987f60a1d2f26b39

 .../kafka/clients/consumer/KafkaConsumer.java      |   1 +
 .../kafka/clients/consumer/internals/Fetcher.java  |  40 +-
 .../common/record/AbstractLegacyRecordBatch.java   |  46 ++-
 .../apache/kafka/common/record/DefaultRecord.java  |  41 ++
 .../kafka/common/record/DefaultRecordBatch.java    |  45 ++-
 .../kafka/common/record/FileLogInputStream.java    |   7 +
 .../apache/kafka/common/record/LegacyRecord.java   |   4 +-
 .../apache/kafka/common/record/RecordBatch.java    |  11 +
 .../apache/kafka/common/record/SimpleRecord.java   |   8 +
 .../kafka/common/utils/CloseableIterator.java      |  30 ++
 .../clients/consumer/internals/FetcherTest.java    | 446 +++++++++++++--------
 .../common/record/DefaultRecordBatchTest.java      |  14 +
 .../test/java/org/apache/kafka/test/TestUtils.java |   5 +
 13 files changed, 516 insertions(+), 182 deletions(-)
f9772d5fb26b0a375729a88db5e7ee199f85c8b3

 .../kafka/streams/processor/internals/StreamThread.java      | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
92b7d7570027cdc4e069862472ce6ec6b3dad04a

 .../streams/integration/ResetIntegrationTest.java  | 33 +++++++++++++++++++++-
 1 file changed, 32 insertions(+), 1 deletion(-)
2e075fe6a47221b24abc49c25a4a69a447362eeb

 .../java/org/apache/kafka/common/requests/OffsetFetchResponse.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
4b3ea062be515bc173f6c788c4c1e14f77935aef

 core/src/test/scala/integration/kafka/api/AdminClientTest.scala | 2 --
 1 file changed, 2 deletions(-)
a3e13776e6c0889131ddfdaa8b10cd2ef2498603

 .../main/java/org/apache/kafka/common/requests/MetadataRequest.java   | 2 +-
 .../src/main/java/org/apache/kafka/common/security/JaasConfig.java    | 2 +-
 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala   | 4 ++--
 core/src/main/scala/kafka/log/Log.scala                               | 2 +-
 core/src/main/scala/kafka/log/TimeIndex.scala                         | 4 ++--
 core/src/main/scala/kafka/utils/Annotations.scala                     | 2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala                         | 2 +-
 core/src/test/scala/integration/kafka/api/BaseConsumerTest.scala      | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/TimeWindows.java   | 4 ++--
 .../apache/kafka/streams/state/internals/CachingKeyValueStore.java    | 2 +-
 .../kafka/streams/processor/internals/ProcessorStateManagerTest.java  | 4 ++--
 .../streams/processor/internals/StreamPartitionAssignorTest.java      | 2 +-
 12 files changed, 16 insertions(+), 16 deletions(-)
81721f8c535d9b32c518bb8f74611ead50826d4c

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d345d53e4e5e4f74707e2521aa635b93ba3f1e7b

 checkstyle/suppressions.xml                        |  2 +-
 .../java/org/apache/kafka/common/utils/Utils.java  | 37 +++++++++++++++-------
 .../org/apache/kafka/common/utils/UtilsTest.java   | 24 ++++++++++++++
 .../test/java/org/apache/kafka/test/TestUtils.java |  9 +++++-
 .../examples/pageview/JsonPOJOSerializer.java      |  3 +-
 .../kafka/streams/state/internals/Segment.java     |  9 +++++-
 .../kafka/streams/state/internals/Segments.java    | 11 ++++++-
 .../internals/ProcessorStateManagerTest.java       |  2 +-
 .../processor/internals/StandbyTaskTest.java       |  3 +-
 .../processor/internals/StateDirectoryTest.java    |  7 ++--
 .../processor/internals/StreamTaskTest.java        |  3 +-
 .../StreamThreadStateStoreProviderTest.java        |  2 +-
 12 files changed, 87 insertions(+), 25 deletions(-)
43fb2df7a4b2bc7637dcba9436a5435cdcb4fb27

 .../apache/kafka/clients/CommonClientConfigs.java  |  2 +-
 .../kafka/common/requests/CreateTopicsRequest.java |  7 ++--
 .../common/requests/DeleteRecordsRequest.java      |  3 +-
 .../apache/kafka/common/requests/FetchRequest.java |  3 +-
 .../kafka/common/requests/LeaderAndIsrRequest.java |  2 +-
 .../kafka/common/requests/ListOffsetRequest.java   |  5 +--
 .../kafka/common/requests/OffsetCommitRequest.java |  3 +-
 .../kafka/common/requests/ProduceRequest.java      |  2 +-
 .../common/requests/UpdateMetadataRequest.java     |  4 +-
 .../java/org/apache/kafka/common/utils/Utils.java  | 47 ++++++----------------
 .../org/apache/kafka/common/utils/UtilsTest.java   |  2 +-
 .../internals/StreamPartitionAssignor.java         |  2 +-
 .../apache/kafka/streams/StreamsConfigTest.java    |  4 +-
 .../kafka/tools/ClientCompatibilityTest.java       |  3 +-
 14 files changed, 30 insertions(+), 59 deletions(-)
c808e8955f23c551c86ec0f51683c88486ad394e

 .../main/java/org/apache/kafka/common/requests/FetchRequest.java  | 2 +-
 .../org/apache/kafka/common/requests/RequestResponseTest.java     | 8 ++++++++
 2 files changed, 9 insertions(+), 1 deletion(-)
84a14fec299749a208251bce1a0eb9c1a8241d08

 .../streams/processor/internals/StreamTask.java    |  17 +-
 .../streams/processor/internals/StreamThread.java  | 225 +++++++++++++--------
 .../processor/internals/StreamTaskTest.java        |  45 +++--
 .../streams/streams_simple_benchmark_test.py       |   4 +-
 tests/kafkatest/services/streams.py                |   2 +-
 5 files changed, 188 insertions(+), 105 deletions(-)
6feaa8a581daaa76ff7c85e4a0b9c9aa4284fe99

 .../apache/kafka/common/record/DefaultRecord.java  |  12 +-
 .../kafka/common/record/DefaultRecordBatch.java    |  16 +-
 .../apache/kafka/common/record/LegacyRecord.java   |  15 +-
 .../org/apache/kafka/common/utils/Checksums.java   |  67 +++
 .../java/org/apache/kafka/common/utils/Crc32.java  |  37 +-
 .../java/org/apache/kafka/common/utils/Crc32C.java | 112 ++++
 .../java/org/apache/kafka/common/utils/Java.java   |  44 ++
 .../apache/kafka/common/utils/PureJavaCrc32C.java  | 644 +++++++++++++++++++++
 .../kafka/common/record/FileRecordsTest.java       |  19 +-
 .../kafka/common/record/MemoryRecordsTest.java     |  52 +-
 .../common/record/SimpleLegacyRecordTest.java      |   4 +-
 .../apache/kafka/common/utils/ChecksumsTest.java   |  93 +++
 .../org/apache/kafka/common/utils/Crc32CTest.java  |  52 ++
 .../org/apache/kafka/common/utils/Crc32Test.java   |  51 +-
 .../org/apache/kafka/common/utils/CrcTest.java     |  59 --
 15 files changed, 1127 insertions(+), 150 deletions(-)
aea5989d988cd1b46c95409989a7c12c7cf52b5f

 .../apache/kafka/streams/examples/pageview/JsonPOJOSerializer.java    | 4 ----
 1 file changed, 4 deletions(-)
7adf1e4148a1b709f9bc754b08129c390e725cdf

 gradle/findbugs-exclude.xml | 6 ++++++
 1 file changed, 6 insertions(+)
42284960dab4724445a4a3a7831b3b48f0ddcb48

 .../src/main/java/org/apache/kafka/common/Os.java  | 30 +++++++++++++++
 .../java/org/apache/kafka/common/utils/Shell.java  |  5 ---
 .../org/apache/kafka/common/utils/ShellTest.java   | 45 ++++++++++++++++++++++
 core/src/main/scala/kafka/log/AbstractIndex.scala  | 11 +++---
 core/src/main/scala/kafka/utils/Os.scala           | 25 ------------
 5 files changed, 81 insertions(+), 35 deletions(-)
4ce65d65dff3e185bdfd387b6fd4b730e69adec4

 tests/kafkatest/tests/core/zookeeper_security_upgrade_test.py | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
a0b8e435c9419a9402d08408260bea0c1d95cff0

 .../kafka/clients/consumer/internals/Fetcher.java  | 222 ++++++++++++---------
 .../kafka/common/record/DefaultRecordBatch.java    | 100 +++++-----
 .../clients/consumer/internals/FetcherTest.java    |   6 +-
 3 files changed, 175 insertions(+), 153 deletions(-)
2397269c442ba9292b47843c4d275b4415d6f845

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
edb372dcaf34312b5c1c91c4df5e5ff87586e73b

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
23a0f0986319cc0061a0ea149f23f5b5d696d1c1

 .../main/java/org/apache/kafka/common/network/DualSocketChannel.java  | 4 ----
 1 file changed, 4 deletions(-)
8b05ad406d4cba6a75d1683b6d8699c3ab28f9d6

 bin/kafka-delete-records.sh                        |  17 ++
 .../kafka/clients/consumer/internals/Fetcher.java  |   4 +-
 .../clients/consumer/internals/RequestFuture.java  |  36 ++--
 .../kafka/common/network/DualSocketChannel.java    |   4 +
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   3 +-
 .../org/apache/kafka/common/protocol/Protocol.java | 112 ++++++++++++-
 .../apache/kafka/common/record/FileRecords.java    |  15 +-
 .../kafka/common/requests/AbstractRequest.java     |   3 +
 .../kafka/common/requests/AbstractResponse.java    |   2 +
 .../common/requests/DeleteRecordsRequest.java      | 151 +++++++++++++++++
 .../common/requests/DeleteRecordsResponse.java     | 135 +++++++++++++++
 .../apache/kafka/common/requests/FetchRequest.java |  30 ++--
 .../kafka/common/requests/FetchResponse.java       |  35 ++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   2 +-
 .../clients/consumer/internals/FetcherTest.java    |   4 +-
 .../kafka/common/requests/RequestResponseTest.java |  16 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  | 183 +++++++++++++++++++--
 .../kafka/admin/BrokerApiVersionsCommand.scala     |   1 +
 .../scala/kafka/admin/DeleteRecordsCommand.scala   | 117 +++++++++++++
 core/src/main/scala/kafka/api/ApiVersion.scala     |  10 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  58 +++++--
 core/src/main/scala/kafka/cluster/Replica.scala    |  34 +++-
 .../kafka/consumer/ConsumerFetcherThread.scala     |   3 +-
 core/src/main/scala/kafka/log/Log.scala            |  98 ++++++++---
 core/src/main/scala/kafka/log/LogManager.scala     |  56 ++++++-
 core/src/main/scala/kafka/log/LogSegment.scala     |  33 ++--
 .../scala/kafka/server/AbstractFetcherThread.scala |  26 +--
 .../scala/kafka/server/DelayedDeleteRecords.scala  | 129 +++++++++++++++
 .../src/main/scala/kafka/server/DelayedFetch.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  67 +++++++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  10 ++
 core/src/main/scala/kafka/server/KafkaServer.scala |   5 +-
 .../main/scala/kafka/server/MetadataCache.scala    |   6 +
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  15 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 155 +++++++++++++++--
 .../integration/kafka/api/AdminClientTest.scala    | 179 +++++++++++++++++---
 .../kafka/api/AuthorizerIntegrationTest.scala      |   2 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |   1 +
 .../ReplicaFetcherThreadFatalErrorTest.scala       |   4 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |   1 +
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   2 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   1 +
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |   1 +
 .../unit/kafka/log/LogCleanerManagerTest.scala     |   3 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |   2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  97 +++++++----
 .../kafka/server/AbstractFetcherThreadTest.scala   |   4 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |   2 +-
 .../server/HighwatermarkPersistenceTest.scala      |   6 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |  12 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   2 +
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  40 ++++-
 .../kafka/server/ReplicaManagerQuotasTest.scala    |   5 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  42 ++---
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   7 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 docs/upgrade.html                                  |   6 +
 59 files changed, 1732 insertions(+), 271 deletions(-)
f3f9a9eafb9aee9d87dd188521a4fd72466abfeb

 .../kafka/clients/consumer/KafkaConsumer.java      |  1 +
 .../consumer/internals/ConsumerNetworkClient.java  | 78 +++++++++-------------
 .../java/org/apache/kafka/clients/MockClient.java  |  4 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 18 ++++-
 4 files changed, 51 insertions(+), 50 deletions(-)
1abed91bd2915226cf6320395e1a5877ea0705d7

 .../kafka/clients/consumer/ConsumerConfig.java     | 18 +++++-
 .../kafka/clients/consumer/KafkaConsumer.java      | 31 +++++-----
 .../consumer/internals/AbstractCoordinator.java    |  9 ++-
 .../consumer/internals/ConsumerCoordinator.java    | 20 ++++---
 .../org/apache/kafka/common/config/ConfigDef.java  | 33 +++++++++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  3 +-
 .../internals/AbstractCoordinatorTest.java         |  2 +-
 .../internals/ConsumerCoordinatorTest.java         | 69 ++++++++++++----------
 .../apache/kafka/common/config/ConfigDefTest.java  | 22 +++++++
 .../runtime/distributed/WorkerCoordinator.java     | 17 +++---
 10 files changed, 152 insertions(+), 72 deletions(-)
abc47844be489c0a4583f3c381451204dc4ada2b

 .../kafka/connect/tools/VerifiableSourceTask.java     | 19 +++++++++++++++++++
 tests/kafkatest/services/connect.py                   |  6 ++++++
 .../tests/connect/connect_distributed_test.py         | 17 ++++++++++-------
 3 files changed, 35 insertions(+), 7 deletions(-)
aa60a92c062b07fd619142f91d10e23c7c4ede6c

 .../kafka/connect/tools/VerifiableSourceTask.java     | 19 +++++++++++++++++++
 tests/kafkatest/services/connect.py                   |  6 ++++++
 .../tests/connect/connect_distributed_test.py         | 17 ++++++++++-------
 3 files changed, 35 insertions(+), 7 deletions(-)
d27e09e60c53520bd24872f8b7dbfee87b523d04

 .../kafka/common/network/ByteBufferReceive.java    | 57 -------------
 .../kafka/common/record/CompressionType.java       | 94 ++++++++--------------
 2 files changed, 33 insertions(+), 118 deletions(-)
d348ac92c80b6426864e3ed68b89bad341b3bda5

 .../kafka/common/requests/FetchResponse.java       | 56 ++++++++++++++--
 .../kafka/common/requests/RequestResponseTest.java | 78 ++++++++++++++--------
 2 files changed, 100 insertions(+), 34 deletions(-)
462767660baf49fb63550e60cd9a418705831715

 tests/kafkatest/services/verifiable_client.py   |  2 +-
 tests/kafkatest/services/verifiable_consumer.py | 12 +++++++++++-
 tests/kafkatest/services/verifiable_producer.py | 11 ++++++++++-
 3 files changed, 22 insertions(+), 3 deletions(-)
5bd06f1d542e6b588a1d402d059bc24690017d32

 checkstyle/checkstyle.xml                          |   2 +-
 checkstyle/import-control.xml                      |   2 +
 checkstyle/suppressions.xml                        |   6 +-
 .../java/org/apache/kafka/clients/ApiVersions.java |  66 +++
 .../java/org/apache/kafka/clients/KafkaClient.java |   6 +-
 .../org/apache/kafka/clients/NetworkClient.java    |  27 +-
 .../org/apache/kafka/clients/NodeApiVersions.java  | 126 +++--
 .../kafka/clients/consumer/ConsumerRecord.java     |   4 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   6 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  50 +-
 .../kafka/clients/producer/KafkaProducer.java      |  27 +-
 .../kafka/clients/producer/MockProducer.java       |  28 +-
 .../kafka/clients/producer/RecordMetadata.java     |   4 +-
 .../producer/internals/ProduceRequestResult.java   |  12 +-
 .../clients/producer/internals/ProducerBatch.java  |  12 +-
 .../producer/internals/ProducerInterceptors.java   |   4 +-
 .../producer/internals/RecordAccumulator.java      |  19 +-
 .../kafka/clients/producer/internals/Sender.java   |  39 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  94 ++-
 .../apache/kafka/common/protocol/types/Type.java   |  24 +-
 .../common/record/AbstractLegacyRecordBatch.java   | 456 +++++++++++++++
 .../kafka/common/record/AbstractRecordBatch.java   |  31 +
 .../kafka/common/record/AbstractRecords.java       | 185 ++++--
 .../common/record/ByteBufferLogInputStream.java    |  85 +--
 .../kafka/common/record/CompressionType.java       |   4 +-
 .../kafka/common/record/ControlRecordType.java     |  87 +++
 .../apache/kafka/common/record/DefaultRecord.java  | 457 +++++++++++++++
 .../kafka/common/record/DefaultRecordBatch.java    | 435 ++++++++++++++
 .../kafka/common/record/FileLogInputStream.java    | 250 ++++++--
 .../apache/kafka/common/record/FileRecords.java    | 129 +++--
 .../org/apache/kafka/common/record/Header.java     |  64 +++
 .../apache/kafka/common/record/LegacyRecord.java   | 570 +++++++++++++++++++
 .../org/apache/kafka/common/record/LogEntry.java   | 171 ------
 .../apache/kafka/common/record/LogInputStream.java |  24 +-
 .../apache/kafka/common/record/MemoryRecords.java  | 277 ++++-----
 .../kafka/common/record/MemoryRecordsBuilder.java  | 348 +++++++++---
 .../kafka/common/record/MutableRecordBatch.java    |  45 ++
 .../org/apache/kafka/common/record/Record.java     | 630 +++------------------
 .../apache/kafka/common/record/RecordBatch.java    | 203 +++++++
 .../kafka/common/record/RecordBatchIterator.java   |  43 ++
 .../org/apache/kafka/common/record/Records.java    |  72 ++-
 .../kafka/common/record/RecordsIterator.java       | 222 --------
 .../apache/kafka/common/record/SimpleRecord.java   | 109 ++++
 .../apache/kafka/common/record/TimestampType.java  |  13 -
 .../kafka/common/requests/AbstractRequest.java     |   4 +
 .../apache/kafka/common/requests/FetchRequest.java |  31 +-
 .../kafka/common/requests/FetchResponse.java       |  87 ++-
 .../kafka/common/requests/IsolationLevel.java      |  42 ++
 .../kafka/common/requests/ProduceRequest.java      |  86 ++-
 .../kafka/common/requests/ProduceResponse.java     |   5 +-
 .../java/org/apache/kafka/common/utils/Crc32.java  |  29 +
 .../java/org/apache/kafka/common/utils/Utils.java  |  89 ++-
 .../org/apache/kafka/clients/ApiVersionsTest.java  |  46 ++
 .../java/org/apache/kafka/clients/MockClient.java  |   9 +-
 .../apache/kafka/clients/NetworkClientTest.java    |  21 +-
 .../apache/kafka/clients/NodeApiVersionsTest.java  |  30 +
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  16 +-
 .../internals/ConsumerCoordinatorTest.java         |   2 +-
 .../clients/consumer/internals/FetcherTest.java    | 107 +++-
 .../kafka/clients/producer/RecordSendTest.java     |  12 +-
 .../producer/internals/ProducerBatchTest.java      |   6 +-
 .../producer/internals/RecordAccumulatorTest.java  | 112 ++--
 .../clients/producer/internals/SenderTest.java     | 153 ++++-
 .../record/AbstractLegacyRecordBatchTest.java      | 167 ++++++
 .../record/ByteBufferLogInputStreamTest.java       | 116 ++--
 .../kafka/common/record/CompressionTypeTest.java   |   8 +-
 .../kafka/common/record/ControlRecordTypeTest.java |  48 ++
 .../common/record/DefaultRecordBatchTest.java      | 210 +++++++
 .../kafka/common/record/DefaultRecordTest.java     |  93 +++
 .../common/record/FileLogInputStreamTest.java      |  62 ++
 .../kafka/common/record/FileRecordsTest.java       | 229 ++++----
 .../kafka/common/record/LegacyRecordTest.java      | 129 +++++
 .../common/record/MemoryRecordsBuilderTest.java    | 297 +++++++---
 .../kafka/common/record/MemoryRecordsTest.java     | 222 +++++---
 .../org/apache/kafka/common/record/RecordTest.java | 129 -----
 .../common/record/SimpleLegacyRecordTest.java      |  87 +++
 .../kafka/common/record/SimpleRecordTest.java      | 144 -----
 .../kafka/common/record/TimestampTypeTest.java     |  42 --
 .../kafka/common/requests/RequestResponseTest.java | 108 +++-
 .../org/apache/kafka/common/utils/Crc32Test.java   |  61 ++
 .../org/apache/kafka/common/utils/UtilsTest.java   |  92 +++
 .../runtime/distributed/WorkerGroupMember.java     |   4 +-
 .../apache/kafka/connect/util/ConnectUtils.java    |   4 +-
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |   6 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |   3 +-
 core/src/main/scala/kafka/api/ApiVersion.scala     |  33 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   3 +-
 .../kafka/consumer/ConsumerFetcherThread.scala     |   2 +-
 .../controller/ControllerChannelManager.scala      |   5 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |   8 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 264 +++++----
 core/src/main/scala/kafka/log/Log.scala            |  63 ++-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  34 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  35 +-
 core/src/main/scala/kafka/log/LogValidator.scala   | 259 +++++----
 core/src/main/scala/kafka/log/TimeIndex.scala      |   6 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |  32 +-
 core/src/main/scala/kafka/message/Message.scala    |  35 +-
 .../scala/kafka/message/MessageAndOffset.scala     |  14 +-
 core/src/main/scala/kafka/message/MessageSet.scala |   2 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   5 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  47 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  10 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   5 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  10 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   3 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 120 ++--
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |   4 +-
 .../kafka/tools/ReplicaVerificationTool.scala      |  27 +-
 .../kafka/admin/BrokerApiVersionsCommandTest.scala |   4 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |   6 +-
 .../api/GroupCoordinatorIntegrationTest.scala      |   4 +-
 .../kafka/api/PlaintextConsumerTest.scala          |   6 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |   4 +-
 .../ReplicaFetcherThreadFatalErrorTest.scala       |   3 +-
 .../kafka/tools/ReplicaVerificationToolTest.scala  |   6 +-
 .../test/scala/kafka/tools/TestLogCleaning.scala   |  10 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |   4 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  10 +-
 .../coordinator/GroupCoordinatorResponseTest.scala |  23 +-
 .../coordinator/GroupMetadataManagerTest.scala     |  65 ++-
 .../unit/kafka/log/BrokerCompressionTest.scala     |  10 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  48 +-
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |   6 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |  14 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |  61 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  66 ++-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 166 +++---
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 510 +++++++++++++----
 .../kafka/message/BaseMessageSetTestCases.scala    |   3 +-
 .../unit/kafka/network/SocketServerTest.scala      |   8 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |   4 +-
 .../kafka/server/AbstractFetcherThreadTest.scala   |  30 +-
 .../unit/kafka/server/EdgeCaseRequestTest.scala    |  11 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |  45 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  13 +-
 .../unit/kafka/server/ProduceRequestTest.scala     |  21 +-
 .../kafka/server/ReplicaManagerQuotasTest.scala    |  24 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  12 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  53 +-
 .../scala/unit/kafka/tools/MirrorMakerTest.scala   |   4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  28 +-
 docs/upgrade.html                                  |  30 +-
 .../processor/internals/StreamsKafkaClient.java    |   4 +-
 145 files changed, 7555 insertions(+), 3405 deletions(-)
1e4cab7616c534a0c059126eb01131351fd0078d

 .../kafka/streams/processor/internals/RecordCollectorImpl.java      | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
f615c9e9d2c59542665edd95cd7152f17e61f026

 .../kafka/streams/processor/internals/RecordCollectorImpl.java      | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
c96635291e963e4651e2ff5dac1b8449c16d32ba

 docs/streams.html                                                    | 5 +++--
 .../kafka/streams/examples/wordcount/WordCountProcessorDemo.java     | 4 +---
 .../src/main/java/org/apache/kafka/streams/processor/Processor.java  | 2 ++
 .../src/main/java/org/apache/kafka/streams/processor/StateStore.java | 3 +++
 4 files changed, 9 insertions(+), 5 deletions(-)
2269eed242d9ccd4cc3e9ae3211d01f166f6e234

 docs/streams.html                                                    | 5 +++--
 .../kafka/streams/examples/wordcount/WordCountProcessorDemo.java     | 4 +---
 .../src/main/java/org/apache/kafka/streams/processor/Processor.java  | 2 ++
 .../src/main/java/org/apache/kafka/streams/processor/StateStore.java | 3 +++
 4 files changed, 9 insertions(+), 5 deletions(-)
eb0dbe850b7d56dfc851ec5fa3c45510fd7b37c0

 docs/connect.html | 68 ++++++++++++++++++++++++++++++++++++++++++++++++++++++-
 docs/toc.html     |  6 +++++
 2 files changed, 73 insertions(+), 1 deletion(-)
95ef40dd31b6b0ee403413184ef974c6c051ddeb

 docs/connect.html | 68 ++++++++++++++++++++++++++++++++++++++++++++++++++++++-
 docs/toc.html     |  6 +++++
 2 files changed, 73 insertions(+), 1 deletion(-)
57278aa82da5dc9d040eb3dcf4a182e0731a621b

 .../org/apache/kafka/streams/KafkaStreams.java     |   7 +-
 .../processor/internals/GlobalStreamThread.java    |  11 +--
 .../processor/internals/ProcessorStateManager.java |   2 +
 .../processor/internals/StateDirectory.java        |  53 +++++++----
 .../streams/processor/internals/StateRestorer.java |  25 ++++-
 .../processor/internals/StoreChangelogReader.java  |  39 ++++++--
 .../streams/processor/internals/StreamTask.java    |   4 +-
 .../streams/processor/internals/StreamThread.java  | 101 ++++++++++++++-------
 .../kafka/streams/state/internals/ThreadCache.java |   2 +-
 .../internals/GlobalStreamThreadTest.java          |   4 +-
 .../processor/internals/StateRestorerTest.java     |  15 +++
 11 files changed, 179 insertions(+), 84 deletions(-)
763ea5aad191b09ed3deefaa12ce7b9925ebe7dc

 .../main/java/org/apache/kafka/connect/runtime/PluginDiscovery.java   | 2 +-
 .../main/java/org/apache/kafka/connect/transforms/ExtractField.java   | 4 ++--
 .../src/main/java/org/apache/kafka/connect/transforms/HoistField.java | 4 ++--
 .../main/java/org/apache/kafka/connect/transforms/InsertField.java    | 4 ++--
 .../src/main/java/org/apache/kafka/connect/transforms/MaskField.java  | 4 ++--
 .../main/java/org/apache/kafka/connect/transforms/ReplaceField.java   | 4 +++-
 .../java/org/apache/kafka/connect/transforms/SetSchemaMetadata.java   | 4 ++--
 7 files changed, 14 insertions(+), 12 deletions(-)
75df53f4b3923fee79a7457f1e32abca7e5e98ee

 .../kafka/streams/processor/internals/ProcessorStateManager.java      | 4 ++++
 .../org/apache/kafka/streams/integration/ResetIntegrationTest.java    | 1 -
 2 files changed, 4 insertions(+), 1 deletion(-)
cf310ec48ff08f52f27b894dcf473048bb738db6

 docs/streams.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
666beecec83db755335eac9cef2433d0b4870a05

 docs/streams.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d5cec01f2aeb37823d1a158683da0809a0c54818

 tests/kafkatest/services/verifiable_client.py      | 330 +++++++++++++++++++++
 tests/kafkatest/services/verifiable_consumer.py    |  65 ++--
 tests/kafkatest/services/verifiable_producer.py    | 119 +++-----
 .../tests/client/consumer_rolling_upgrade_test.py  |   6 +-
 tests/kafkatest/tests/client/consumer_test.py      |   9 +-
 tests/kafkatest/tests/client/pluggable_test.py     |  51 ++++
 .../org/apache/kafka/tools/VerifiableConsumer.java |   9 +
 .../org/apache/kafka/tools/VerifiableProducer.java |   7 +
 8 files changed, 487 insertions(+), 109 deletions(-)
b3f5f95203960ca338024cf0fc8ba437c55b9214

 .../streams/integration/ResetIntegrationTest.java  | 40 +++++++++++++++-------
 1 file changed, 28 insertions(+), 12 deletions(-)
83824089f2371d6375c2713d494f276aec27c1a1

 .../streams/integration/ResetIntegrationTest.java  | 39 +++++++++++++++-------
 1 file changed, 27 insertions(+), 12 deletions(-)
b3beaebd4481dc94a36949dbb87e02c28272adb0

 .../streams/processor/internals/StoreChangelogReader.java   | 13 +++++++++++++
 1 file changed, 13 insertions(+)
51ffddcbc8846be57936166d2d43eed75336e0fa

 .../org/apache/kafka/streams/kstream/KStream.java  | 76 +++++++++++++++++-----
 .../org/apache/kafka/streams/kstream/KTable.java   | 45 ++-----------
 2 files changed, 64 insertions(+), 57 deletions(-)
a7e3679d22504b0808e970ac9c481a3ee62f9243

 .../org/apache/kafka/connect/data/Decimal.java     |  2 +-
 .../apache/kafka/connect/json/JsonConverter.java   |  3 ++-
 gradle/findbugs-exclude.xml                        | 30 ++++++++++++++++++++++
 3 files changed, 33 insertions(+), 2 deletions(-)
6f7780cf127c8f4bb0edabaa5cb228fc566681f2

 .../org/apache/kafka/streams/kstream/KStream.java  | 76 +++++++++++++++++-----
 .../org/apache/kafka/streams/kstream/KTable.java   | 45 ++-----------
 2 files changed, 64 insertions(+), 57 deletions(-)
6e2698b25587b71dcec6d42d82516fc986a3ebd4

 .../apache/kafka/streams/kstream/internals/KStreamTransformValues.java | 3 ---
 1 file changed, 3 deletions(-)
c2653754d9dbc232ae5f2052993611b26ed62693

 .../apache/kafka/streams/kstream/internals/KStreamTransformValues.java | 3 ---
 1 file changed, 3 deletions(-)
3d294533c8613d2cf57ead76dfd75ca472659132

 .../streams/kstream/internals/SessionKeySerde.java |   9 ++
 .../state/internals/CachingSessionStore.java       |  52 ---------
 .../state/internals/CachingWindowStore.java        |  12 ++-
 .../state/internals/FilteredCacheIterator.java     |  73 +++++++++++++
 .../streams/state/internals/SessionKeySchema.java  |  14 +--
 .../state/internals/WindowStoreKeySchema.java      |  25 +++--
 .../kstream/internals/SessionKeySerdeTest.java     |   8 ++
 .../state/internals/CachingWindowStoreTest.java    |  22 ++++
 .../state/internals/RocksDBSessionStoreTest.java   |  39 ++++++-
 .../state/internals/RocksDBWindowStoreTest.java    | 116 +++++++++++++++++++++
 10 files changed, 298 insertions(+), 72 deletions(-)
c74eec96c5e8828a88df67f6eb21d2369b340a22

 .../streams/kstream/internals/SessionKeySerde.java |  2 +-
 .../streams/state/internals/SessionKeySchema.java  | 14 ++--
 .../streams/state/internals/WindowKeySchema.java   | 12 ++--
 .../state/internals/RocksDBSessionStoreTest.java   | 39 ++++++++++--
 .../state/internals/RocksDBWindowStoreTest.java    | 47 +++++++++++++-
 .../state/internals/SessionKeySchemaTest.java      | 74 ++++++++++++++++++++++
 6 files changed, 167 insertions(+), 21 deletions(-)
fef7fca2af7fd00bc6b0889062da3f8b56b2224e

 README.md                                          |  32 ++--
 build.gradle                                       |  49 +++++-
 .../org/apache/kafka/test/IntegrationTest.java     |  20 +++
 .../kafka/api/IntegrationTestHarness.scala         |   2 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   2 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |   8 +-
 jenkins.sh                                         |  20 +++
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   3 +
 .../streams/integration/FanoutIntegrationTest.java |  18 +-
 .../integration/GlobalKTableIntegrationTest.java   |   3 +
 .../integration/InternalTopicIntegrationTest.java  |   3 +
 .../streams/integration/JoinIntegrationTest.java   |   3 +
 .../KStreamAggregationDedupIntegrationTest.java    |   3 +
 .../KStreamAggregationIntegrationTest.java         |   3 +
 .../KStreamKTableJoinIntegrationTest.java          |  33 ++--
 .../integration/KStreamRepartitionJoinTest.java    |  29 ++--
 ...StreamsFineGrainedAutoResetIntegrationTest.java |   3 +
 .../KTableKTableJoinIntegrationTest.java           | 184 +++++++++++----------
 .../integration/QueryableStateIntegrationTest.java |  43 +++--
 .../integration/RegexSourceIntegrationTest.java    |   3 +
 .../streams/integration/ResetIntegrationTest.java  |   3 +
 21 files changed, 289 insertions(+), 178 deletions(-)
77bfe78ba4d446a92eb03910de094d472f6a2836

 docs/security.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
05690f0c851007fb60ebd96c43c1141bddd510c1

 docs/security.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
197a5d5a6d160e9f3f1642caf85bad968a35f109

 clients/.gitignore                                 |  1 +
 connect/api/.gitignore                             |  1 +
 connect/json/.gitignore                            |  1 +
 core/.gitignore                                    |  3 +++
 streams/.gitignore                                 |  1 +
 .../org/apache/kafka/streams/StreamsConfig.java    |  1 +
 .../streams/processor/internals/StreamThread.java  | 22 ++++++++++++++--------
 7 files changed, 22 insertions(+), 8 deletions(-)
5a2fcdd6d480e9f003cc49a59d5952ba4c515a71

 .../producer/internals/ErrorLoggingCallback.java   |  6 ++-
 .../java/org/apache/kafka/common/utils/Shell.java  |  7 +++-
 .../kafka/connect/file/FileStreamSinkTask.java     |  7 +++-
 .../kafka/connect/file/FileStreamSourceTask.java   |  5 ++-
 .../kafka/connect/runtime/AbstractHerder.java      |  3 +-
 .../kafka/connect/runtime/rest/RestServer.java     |  3 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 17 ++++----
 .../main/scala/kafka/server/OffsetCheckpoint.scala |  5 ++-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 24 ++++++-----
 .../main/scala/kafka/tools/ConsoleProducer.scala   | 11 ++---
 .../main/scala/kafka/tools/EndToEndLatency.scala   |  5 ++-
 .../main/scala/kafka/tools/ExportZkOffsets.scala   |  6 ++-
 .../main/scala/kafka/tools/ImportZkOffsets.scala   |  6 +--
 .../scala/kafka/tools/ProducerPerformance.scala    |  5 ++-
 .../scala/kafka/tools/StateChangeLogMerger.scala   |  3 +-
 .../kafka/admin/BrokerApiVersionsCommandTest.scala |  2 +-
 .../kafka/api/BaseProducerSendTest.scala           | 48 +++++++++++++---------
 .../unit/kafka/admin/DeleteConsumerGroupTest.scala |  6 ++-
 .../kafka/log4jappender/KafkaLog4jAppender.java    |  4 +-
 .../streams/kstream/internals/KStreamImpl.java     | 14 +++----
 .../streams/kstream/internals/KTableImpl.java      | 11 ++---
 .../streams/kstream/internals/KeyValuePrinter.java | 43 ++++++++++---------
 .../streams/state/internals/OffsetCheckpoint.java  | 12 +++---
 .../internals/KeyValuePrinterProcessorTest.java    | 36 ++++++++++------
 24 files changed, 168 insertions(+), 121 deletions(-)
783900c259511f86f5af03cbd96f2e74833447b9

 .../streams/processor/internals/SinkNode.java      |  6 +-
 .../streams/processor/internals/SinkNodeTest.java  | 94 +++++++++++++++++-----
 2 files changed, 78 insertions(+), 22 deletions(-)
9e787716b013595851b4a6c1ddf8b8af1ec0f42e

 .../org/apache/kafka/common/internals/Topic.java   | 60 ++++++++++++++++
 .../apache/kafka/common/internals/TopicTest.java   | 84 ++++++++++++++++++++++
 .../kafka/streams/kstream/KGroupedStream.java      | 43 ++++++++---
 .../kafka/streams/kstream/KGroupedTable.java       | 15 +++-
 .../org/apache/kafka/streams/kstream/KTable.java   |  4 +-
 .../streams/kstream/internals/AbstractStream.java  |  3 +
 .../kstream/internals/KGroupedStreamImpl.java      |  4 ++
 .../kstream/internals/KGroupedTableImpl.java       |  7 ++
 .../streams/processor/StateStoreSupplier.java      |  1 +
 .../processor/internals/InternalTopicConfig.java   |  4 ++
 .../kstream/internals/KGroupedStreamImplTest.java  | 46 +++++++++++-
 .../kstream/internals/KGroupedTableImplTest.java   | 12 ++++
 .../internals/InternalTopicConfigTest.java         |  6 ++
 13 files changed, 274 insertions(+), 15 deletions(-)
ec8feb766f0fc560200a326941632033600c141e

 .../src/main/java/org/apache/kafka/tools/ClientCompatibilityTest.java | 2 +-
 tools/src/main/java/org/apache/kafka/tools/ProducerPerformance.java   | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)
01768e3321cfce19bf558ad0fe7bf6ca84ada8f6

 clients/src/main/java/org/apache/kafka/common/network/ListenerName.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4a019bdfaf2ab7110660b313df5bb05ab195e614

 tests/kafkatest/tests/core/throttling_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6b11fb7af81390789ba449c0cd5daa81c8ee9cb5

 tests/kafkatest/tests/core/throttling_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c5adf17aeae763d9e8a4e802d988a464fef5d5e8

 core/src/main/scala/kafka/server/KafkaApis.scala | 4 ++++
 1 file changed, 4 insertions(+)
cfda0368dbb7ddd014780e1ed1dedcae2778f403

 .../apache/kafka/streams/integration/FanoutIntegrationTest.java    | 4 +++-
 .../integration/KStreamAggregationDedupIntegrationTest.java        | 7 +++++--
 .../streams/integration/KStreamKTableJoinIntegrationTest.java      | 2 ++
 .../kafka/streams/integration/KStreamRepartitionJoinTest.java      | 2 ++
 .../kafka/streams/integration/QueryableStateIntegrationTest.java   | 6 ++++--
 5 files changed, 16 insertions(+), 5 deletions(-)
b8fe2bb56c25715de1602c1f00ab720af085f2e5

 .../apache/kafka/streams/perf/SimpleBenchmark.java | 27 +++++++++++++++++-----
 .../streams/tests/BrokerCompatibilityTest.java     |  9 ++++++++
 .../kafka/streams/tests/SmokeTestClient.java       | 12 +++++++++-
 .../kafka/streams/tests/StreamsSmokeTest.java      |  7 ------
 4 files changed, 41 insertions(+), 14 deletions(-)
94938f3734c71c69fe14612052ca16ecc0205d4d

 .../java/org/apache/kafka/clients/Metadata.java    | 18 ++++-
 .../org/apache/kafka/clients/NetworkClient.java    |  2 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |  2 +-
 .../consumer/internals/ConsumerCoordinator.java    |  6 +-
 .../kafka/clients/producer/KafkaProducer.java      |  2 +-
 .../kafka/common/requests/MetadataResponse.java    | 24 ++++++
 .../org/apache/kafka/clients/MetadataTest.java     | 66 +++++++--------
 .../java/org/apache/kafka/clients/MockClient.java  | 33 +++++---
 .../apache/kafka/clients/NetworkClientTest.java    |  2 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 38 ++++-----
 .../internals/AbstractCoordinatorTest.java         |  2 +-
 .../internals/ConsumerCoordinatorTest.java         | 94 ++++++++++++++++++----
 .../clients/consumer/internals/FetcherTest.java    |  4 +-
 .../clients/producer/internals/SenderTest.java     | 14 ++--
 .../runtime/distributed/WorkerGroupMember.java     |  3 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |  2 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |  2 +-
 .../integration/kafka/api/ConsumerBounceTest.scala | 59 ++++++++++++--
 .../processor/internals/StreamsKafkaClient.java    |  4 +-
 19 files changed, 270 insertions(+), 107 deletions(-)
1659ca1773596b5889fe8b2f163196f7b32ea70a

 .../kafka/common/requests/AbstractRequest.java     |  8 +++-
 .../kafka/common/requests/ProduceRequest.java      | 56 ++++++++++++++++++++--
 .../kafka/common/requests/RequestResponseTest.java | 50 +++++++++++++++++++
 .../main/scala/kafka/network/RequestChannel.scala  |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 14 +++---
 5 files changed, 115 insertions(+), 15 deletions(-)
be11272818a06eea157ab7f6eee8905855f1cede

 docs/ops.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b9f812491f5eb06ffe5b68f5e53df4302d2f68a8

 .../org/apache/kafka/streams/KafkaStreams.java     | 24 ++++++++-----
 .../streams/processor/internals/StreamThread.java  | 39 +++++++++-------------
 2 files changed, 32 insertions(+), 31 deletions(-)
962c378cc6cdb178541155af419c24e463516a5d

 .../apache/kafka/connect/converters/ByteArrayConverter.java  | 12 ++++++------
 .../kafka/connect/converters/ByteArrayConverterTest.java     | 10 +++++-----
 2 files changed, 11 insertions(+), 11 deletions(-)
52a15d7c0b88da11409954321463b8b57b133a23

 checkstyle/import-control.xml                      |  4 +
 .../connect/converters/ByteArrayConverter.java     | 52 +++++++++++++
 .../connect/converters/ByteArrayConverterTest.java | 90 ++++++++++++++++++++++
 3 files changed, 146 insertions(+)
9e4548df30d50a56ae99cb3383f1a3f97bbe77bb

 .../state/internals/CachingSessionStore.java       |  52 --
 .../state/internals/CachingWindowStore.java        |  12 +-
 .../state/internals/FilteredCacheIterator.java     |  73 ++
 .../streams/state/internals/WindowKeySchema.java   |  22 +-
 .../state/internals/CachingWindowStoreTest.java    |  25 +-
 .../state/internals/FilteredCacheIteratorTest.java | 118 +++
 .../state/internals/RocksDBWindowStoreTest.java    | 843 +++++++++++----------
 7 files changed, 663 insertions(+), 482 deletions(-)
d3b8ff02437e735801e36cc4970b794344400058

 .../common/serialization/FloatDeserializer.java    | 22 +++++++++++++---------
 .../common/serialization/FloatSerializer.java      | 22 +++++++++++++---------
 2 files changed, 26 insertions(+), 18 deletions(-)
2a9c18a87d4374d03f8a07b37a4e66d74325f1c2

 .../main/java/org/apache/kafka/common/requests/AbstractRequest.java  | 5 +++++
 .../main/java/org/apache/kafka/common/requests/RequestHeader.java    | 5 +++++
 2 files changed, 10 insertions(+)
85e7a0a2b0d56891c13c15fc88a3011877f9c9e9

 .../CompositeReadOnlyWindowStoreTest.java          | 49 ++++++++++++++++++++--
 1 file changed, 46 insertions(+), 3 deletions(-)
cd69daa4150631e9cea4e299c5ea08e12359118d

 .../common/serialization/FloatDeserializer.java    | 47 +++++++++++
 .../common/serialization/FloatSerializer.java      | 42 ++++++++++
 .../apache/kafka/common/serialization/Serdes.java  | 17 ++++
 .../common/serialization/SerializationTest.java    | 93 ++++++++++++++++++++++
 4 files changed, 199 insertions(+)
928789bf743bb96e232fb0a2ed789cc05d2787ca

 streams/src/main/java/org/apache/kafka/streams/KafkaStreams.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
046519d0714591785cd984ab2d57e193b54a2f19

 streams/src/main/java/org/apache/kafka/streams/KafkaStreams.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
f9660e16dafb9e1109704bdecb978b7046f0cc6b

 .../java/org/apache/kafka/streams/state/internals/RocksDBStore.java | 6 ++++++
 1 file changed, 6 insertions(+)
0011a3dc337a41ceb21b1567db7bdc3219a07552

 .../java/org/apache/kafka/streams/state/internals/RocksDBStore.java   | 4 ++++
 1 file changed, 4 insertions(+)
dfa2ef4837259cd127b013e63ce26acdec8b94c5

 .../internals/StreamPartitionAssignor.java         | 10 +--
 .../internals/assignment/ClientState.java          | 60 +++++++-------
 .../internals/assignment/StickyTaskAssignor.java   | 50 ++++++------
 .../internals/assignment/ClientStateTest.java      | 92 +++++++++++++---------
 .../assignment/StickyTaskAssignorTest.java         | 56 ++++++-------
 5 files changed, 143 insertions(+), 125 deletions(-)
c063561ce815ec066851e480b7f70a84d6ccd371

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
beb0d570091cf368fe7397c73c97a2f1e1d5c2c2

 .../kafka/coordinator/GroupMetadataManager.scala   | 33 ++++----
 core/src/main/scala/kafka/server/KafkaApis.scala   |  2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  6 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  2 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  3 +-
 .../integration/kafka/api/FixedPortTestUtils.scala |  9 +--
 .../kafka/api/IntegrationTestHarness.scala         |  2 +-
 .../integration/kafka/api/LogAppendTimeTest.scala  | 87 ++++++++++++++++++++++
 .../coordinator/GroupCoordinatorResponseTest.scala | 12 +--
 .../coordinator/GroupMetadataManagerTest.scala     | 16 ++--
 .../kafka/integration/KafkaServerTestHarness.scala |  4 +-
 11 files changed, 129 insertions(+), 47 deletions(-)
7565dcd8b0547f91a5d9d19771d9cd6693079d01

 .../kafka/coordinator/GroupMetadataManager.scala   | 33 +++++----
 core/src/main/scala/kafka/server/KafkaApis.scala   |  2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  6 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  2 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  3 +-
 .../integration/kafka/api/FixedPortTestUtils.scala |  9 +--
 .../kafka/api/IntegrationTestHarness.scala         |  2 +-
 .../integration/kafka/api/LogAppendTimeTest.scala  | 86 ++++++++++++++++++++++
 .../coordinator/GroupCoordinatorResponseTest.scala | 12 +--
 .../coordinator/GroupMetadataManagerTest.scala     | 16 ++--
 .../kafka/integration/KafkaServerTestHarness.scala |  4 +-
 11 files changed, 128 insertions(+), 47 deletions(-)
dbcbd7920f7056c80d55453ad543ea9ba87da9be

 .travis.yml             |  54 +++++++++
 tests/README.md         | 303 ++++++++++++++++++++++++++++++++++++++++++++++++
 tests/docker/Dockerfile |   2 +-
 3 files changed, 358 insertions(+), 1 deletion(-)
65650ba4dcba8a9729cb9cb6477a62a7b7c3714e

 .../org/apache/kafka/clients/InFlightRequests.java | 27 ++++++++++++++++++----
 .../java/org/apache/kafka/clients/KafkaClient.java | 16 ++++++++++---
 .../org/apache/kafka/clients/NetworkClient.java    | 16 ++++++++++---
 .../consumer/internals/ConsumerNetworkClient.java  |  4 ++--
 .../java/org/apache/kafka/clients/MockClient.java  | 17 +++++++++++++-
 .../apache/kafka/clients/NetworkClientTest.java    |  3 +++
 .../clients/producer/internals/SenderTest.java     | 11 ++++++++-
 7 files changed, 80 insertions(+), 14 deletions(-)
3445ed0bab6a035c3bacf1fd5f2439e44fb3ca52

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  2 +-
 .../scala/kafka/admin/ZkSecurityMigrator.scala     |  4 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  4 +-
 .../scala/kafka/server/DynamicConfigManager.scala  |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 56 +++++++++++++---------
 .../SaslScramSslEndToEndAuthorizationTest.scala    |  2 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |  2 +-
 .../kafka/security/auth/ZkAuthorizationTest.scala  |  6 +--
 .../kafka/server/DynamicConfigChangeTest.scala     |  2 +-
 9 files changed, 46 insertions(+), 34 deletions(-)
294018a578cbbc187ac123a6b99990468186e349

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  2 +-
 .../scala/kafka/admin/ZkSecurityMigrator.scala     |  4 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  4 +-
 .../scala/kafka/server/DynamicConfigManager.scala  |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 56 +++++++++++++---------
 .../SaslScramSslEndToEndAuthorizationTest.scala    |  2 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |  2 +-
 .../kafka/security/auth/ZkAuthorizationTest.scala  |  6 +--
 .../kafka/server/DynamicConfigChangeTest.scala     |  2 +-
 9 files changed, 46 insertions(+), 34 deletions(-)
537f98a5d64b86022ac2125c75d079c26e4b9830

 .../org/apache/kafka/common/record/KafkaLZ4BlockOutputStream.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
022bf129518e33e165f9ceefc4ab9e622952d3bd

 .../kafka/clients/consumer/KafkaConsumer.java      |  2 +-
 .../consumer/internals/ConsumerNetworkClient.java  | 95 +++++++++++++---------
 .../kafka/clients/consumer/internals/Fetcher.java  |  2 +-
 3 files changed, 58 insertions(+), 41 deletions(-)
f7354e779cb058985dd385b2b1209db71eb7a5e8

 .../apache/kafka/common/protocol/types/Type.java   |  57 ++++
 .../kafka/common/record/ByteBufferInputStream.java |  48 ---
 .../common/record/ByteBufferLogInputStream.java    |   4 +-
 .../common/record/ByteBufferOutputStream.java      |  58 ----
 .../kafka/common/record/CompressionType.java       |   2 +
 .../common/record/KafkaLZ4BlockInputStream.java    |  10 +-
 .../common/record/KafkaLZ4BlockOutputStream.java   |  10 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |   1 +
 .../org/apache/kafka/common/record/Record.java     |   6 +-
 .../kafka/common/record/RecordsIterator.java       |   1 +
 .../kafka/common/utils/ByteBufferInputStream.java  |  48 +++
 .../kafka/common/utils/ByteBufferOutputStream.java |  58 ++++
 .../org/apache/kafka/common/utils/ByteUtils.java   | 324 +++++++++++++++++++++
 .../java/org/apache/kafka/common/utils/Utils.java  | 105 +------
 .../clients/consumer/internals/FetcherTest.java    |   2 +-
 .../protocol/types/ProtocolSerializationTest.java  |   8 +
 .../kafka/common/record/CompressionTypeTest.java   |   2 +
 .../kafka/common/record/SimpleRecordTest.java      |   1 +
 .../apache/kafka/common/utils/ByteUtilsTest.java   | 222 ++++++++++++++
 .../org/apache/kafka/common/utils/UtilsTest.java   |  80 +----
 core/src/main/scala/kafka/message/Message.scala    |   7 +-
 .../scala/unit/kafka/message/MessageTest.scala     |   5 +-
 .../kafka/server/AbstractFetcherThreadTest.scala   |   4 +-
 .../internals/assignment/AssignmentInfo.java       |   2 +-
 24 files changed, 772 insertions(+), 293 deletions(-)
29084a9b27b959532813141591ce03be2921e860

 .../apache/kafka/streams/processor/internals/StreamThread.java   | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)
c6bccddb94affe8f85110004341f75bd66b839eb

 .../kafka/clients/ClusterConnectionStates.java     | 13 ++-
 .../org/apache/kafka/clients/NetworkClient.java    |  2 +-
 .../consumer/internals/ConsumerNetworkClient.java  | 95 +++++++++-------------
 3 files changed, 52 insertions(+), 58 deletions(-)
a05c5415460abc9c93ebd6f859b58689b0a3d56f

 .../kafka/streams/state/internals/Segments.java     | 21 ++++++++++++++-------
 1 file changed, 14 insertions(+), 7 deletions(-)
146edd530a6dfa534fd8cb924fd2336e27872c2a

 .../kafka/streams/state/internals/Segments.java    | 22 ++++++++++++++--------
 1 file changed, 14 insertions(+), 8 deletions(-)
81f9e1376cefed57022de62cd3abf5641c46e4aa

 .../clients/producer/internals/ProducerBatch.java  | 246 +++++++++++++++++++++
 .../producer/internals/RecordAccumulator.java      | 100 ++++-----
 .../clients/producer/internals/RecordBatch.java    | 246 ---------------------
 .../kafka/clients/producer/internals/Sender.java   |  40 ++--
 .../producer/internals/ProducerBatchTest.java      |  73 ++++++
 .../producer/internals/RecordAccumulatorTest.java  |  36 +--
 .../producer/internals/RecordBatchTest.java        |  72 ------
 7 files changed, 407 insertions(+), 406 deletions(-)
06a00933a2544fcdc985309c6a26c76643b2461c

 Vagrantfile | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
8814c2118304ec914d9c4547c5af7115f2f813eb

 Vagrantfile | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
5cf491c2765b4912ff5f7f69f0b992a67005b983

 .../producer/internals/RecordAccumulator.java      | 33 +++++-----
 .../clients/producer/internals/RecordBatch.java    | 57 +++++++++++------
 .../kafka/clients/producer/internals/Sender.java   |  6 +-
 .../producer/internals/RecordBatchTest.java        | 72 ++++++++++++++++++++++
 4 files changed, 128 insertions(+), 40 deletions(-)
46e6601b2583a8e2b862fb41cbc6d95419228446

 docs/quickstart.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
2064a2a55dde9ae4e263eb7c78da3b4ac2896201

 docs/quickstart.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
63010cbfe5d07df5db060888afd348fab5cbe62c

 .../kafka/admin/ReassignPartitionsCommand.scala    | 37 +++++++++------
 .../other/kafka/ReplicationQuotasTestRig.scala     |  3 +-
 .../admin/ReassignPartitionsClusterTest.scala      | 55 ++++++++++++----------
 .../admin/ReassignPartitionsCommandTest.scala      |  7 +--
 .../unit/kafka/server/ReplicationQuotasTest.scala  |  1 -
 5 files changed, 60 insertions(+), 43 deletions(-)
79f85039d7be1b4266f06715a487f3635558ded6

 build.gradle                                       | 43 ++++++++++++++
 checkstyle/import-control.xml                      |  9 +++
 jmh-benchmarks/README.md                           | 61 +++++++++++++++++++
 jmh-benchmarks/jmh.sh                              | 42 +++++++++++++
 .../apache/kafka/jmh/cache/LRUCacheBenchmark.java  | 68 ++++++++++++++++++++++
 settings.gradle                                    |  2 +-
 6 files changed, 224 insertions(+), 1 deletion(-)
f111f2a7167f3abcb0b0e53ac22f9f7bb367766e

 .../kafka/common/OffsetMetadataAndError.scala      |  2 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |  4 +--
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  2 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      | 30 +++++++++++-----------
 4 files changed, 19 insertions(+), 19 deletions(-)
5b013d9cd28d86b50109e8e08f813c3b5af0054b

 .../streams/processor/TopologyBuilderTest.java     |  2 +-
 .../processor/internals/ProcessorTopologyTest.java | 22 ++++++++++-
 .../kafka/test/ProcessorTopologyTestDriver.java    | 46 +++++++++++-----------
 3 files changed, 43 insertions(+), 27 deletions(-)
b1272500bd7a80931d9571b426afb6a2de7ddeca

 docs/connect.html | 2 ++
 1 file changed, 2 insertions(+)
3e69ef6e3c41a83bdec1e2a37073a6af2f44e2a2

 config/connect-distributed.properties | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)
580bebe09798b8f0062a2a1566a1d5836ecad4bb

 .../main/java/org/apache/kafka/streams/kstream/Window.java  |  4 +++-
 .../streams/kstream/internals/KStreamWindowAggregate.java   |  6 +++---
 .../streams/processor/internals/InternalTopicManager.java   | 10 ++++++----
 .../streams/processor/internals/StoreChangelogReader.java   |  6 ++++--
 .../streams/processor/internals/StreamsKafkaClient.java     |  6 ++++--
 .../streams/processor/internals/assignment/ClientState.java |  9 +++++----
 .../kafka/streams/state/internals/OffsetCheckpoint.java     |  3 ++-
 .../apache/kafka/streams/state/internals/RocksDBStore.java  | 13 ++++++++++---
 .../java/org/apache/kafka/streams/kstream/WindowTest.java   |  5 +++++
 9 files changed, 42 insertions(+), 20 deletions(-)
b7378d567fffd06395f5babc36cebd64bdf539d1

 .../org/apache/kafka/streams/perf/SimpleBenchmark.java  | 17 ++++++++++++++++-
 .../benchmarks/streams/streams_simple_benchmark_test.py |  2 +-
 tests/kafkatest/services/streams.py                     |  2 +-
 3 files changed, 18 insertions(+), 3 deletions(-)
adb70da13e18eb652e734887b430ac0ecbc5f9e6

 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +-
 .../consumer/internals/ConsumerNetworkClient.java  | 210 +++++++++++++++------
 .../kafka/clients/consumer/internals/Fetcher.java  |   2 +-
 3 files changed, 153 insertions(+), 61 deletions(-)
5781feb527766fbb3620cb601ed453dd8086e0c2

 core/src/test/scala/unit/kafka/network/SocketServerTest.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
d9b784e1470714c8b04e7c3d74f626a96ca1591e

 checkstyle/suppressions.xml                        |  2 +-
 .../producer/internals/DefaultPartitioner.java     |  4 +-
 .../org/apache/kafka/common/config/ConfigDef.java  |  7 ++-
 .../org/apache/kafka/common/protocol/Protocol.java |  5 --
 .../apache/kafka/common/protocol/types/Struct.java |  2 +-
 .../java/org/apache/kafka/common/utils/Bytes.java  |  3 +-
 .../java/org/apache/kafka/common/utils/Utils.java  | 67 ++++++----------------
 .../java/org/apache/kafka/clients/MockClient.java  |  2 +-
 .../internals/AbstractCoordinatorTest.java         |  2 +-
 .../producer/internals/RecordAccumulatorTest.java  |  2 +-
 .../clients/producer/internals/SenderTest.java     |  4 +-
 .../protocol/types/ProtocolSerializationTest.java  | 12 ++++
 .../kafka/common/security/JaasContextTest.java     |  4 +-
 .../common/security/scram/ScramMessagesTest.java   |  2 +-
 .../kafka/common/utils/AbstractIteratorTest.java   |  2 +-
 .../org/apache/kafka/common/utils/UtilsTest.java   | 64 +++++++++++++++++++++
 .../java/org/apache/kafka/test/TestSslUtils.java   |  4 +-
 17 files changed, 113 insertions(+), 75 deletions(-)
d2792e356ff9d3ed8b0484bf62ac98e85fdc26fa

 .../org/apache/kafka/streams/integration/ResetIntegrationTest.java  | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)
0b04d4e240c56f70f2a334cdb0d4b7a83d228278

 tests/docker/Dockerfile   | 8 ++++----
 tests/docker/run_tests.sh | 8 +++++++-
 2 files changed, 11 insertions(+), 5 deletions(-)
4b1415c109fa75a01a11460aa80f0404baecac51

 tests/docker/Dockerfile   | 8 ++++----
 tests/docker/run_tests.sh | 8 +++++++-
 2 files changed, 11 insertions(+), 5 deletions(-)
2e92f9b2e4ab367f89a055a32a64915a38274065

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
573a6f39863061a6f38a0aca35f11470c3e8538e

 core/src/main/scala/kafka/admin/AdminClient.scala  |  48 ++++++--
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |  17 ++-
 .../main/scala/kafka/tools/StreamsResetter.java    |   2 +-
 .../kafka/admin/DescribeConsumerGroupTest.scala    | 133 ++++++++-------------
 .../streams/integration/ResetIntegrationTest.java  |   2 +-
 5 files changed, 110 insertions(+), 92 deletions(-)
a3c45b0c9263ca4481b1af7af3f7d8ae8cb5d5cd

 .../java/org/apache/kafka/clients/Metadata.java    | 18 ++++-
 .../org/apache/kafka/clients/NetworkClient.java    |  2 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |  2 +-
 .../consumer/internals/ConsumerCoordinator.java    |  6 +-
 .../kafka/clients/producer/KafkaProducer.java      |  2 +-
 .../kafka/common/requests/MetadataResponse.java    | 24 ++++++
 .../org/apache/kafka/clients/MetadataTest.java     | 66 +++++++--------
 .../java/org/apache/kafka/clients/MockClient.java  | 33 +++++---
 .../apache/kafka/clients/NetworkClientTest.java    |  2 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 38 ++++-----
 .../internals/AbstractCoordinatorTest.java         |  2 +-
 .../internals/ConsumerCoordinatorTest.java         | 94 ++++++++++++++++++----
 .../clients/consumer/internals/FetcherTest.java    |  4 +-
 .../clients/producer/internals/SenderTest.java     | 14 ++--
 .../runtime/distributed/WorkerGroupMember.java     |  3 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |  2 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |  2 +-
 .../integration/kafka/api/ConsumerBounceTest.scala | 59 ++++++++++++--
 .../processor/internals/StreamsKafkaClient.java    |  4 +-
 19 files changed, 270 insertions(+), 107 deletions(-)
46e6081eb705cbaad0643cdc59d8cc1ffa14bc4e

 .../org/apache/kafka/streams/KafkaStreams.java     | 42 +++++++++--------
 .../streams/processor/internals/StreamThread.java  | 55 +++++++++++-----------
 2 files changed, 50 insertions(+), 47 deletions(-)
670980ef29fb70838dcd462d11789c2519981164

 .../org/apache/kafka/streams/KafkaStreams.java     | 42 +++++++++--------
 .../streams/processor/internals/StreamThread.java  | 55 +++++++++++-----------
 2 files changed, 50 insertions(+), 47 deletions(-)
59779aa1546c6039ea145c6e21706cbf68cad4a2

 .../src/main/java/org/apache/kafka/streams/kstream/GlobalKTable.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
9e65b25e9fca6c26cef3498ff747879d4f527700

 .../kafka/streams/kstream/KStreamBuilderTest.java  | 92 ++++++++++++++++++++++
 1 file changed, 92 insertions(+)
ca06862a7005ca476f900bd9c2373021422d695b

 clients/src/main/java/org/apache/kafka/clients/Metadata.java     | 2 +-
 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 2 +-
 .../java/org/apache/kafka/clients/producer/MockProducer.java     | 2 +-
 clients/src/main/java/org/apache/kafka/common/Cluster.java       | 9 ++++++---
 clients/src/test/java/org/apache/kafka/clients/MetadataTest.java | 2 +-
 .../apache/kafka/streams/processor/DefaultPartitionGrouper.java  | 4 ++--
 .../streams/processor/internals/StreamPartitionAssignor.java     | 2 +-
 .../kafka/streams/processor/internals/StreamsMetadataState.java  | 2 +-
 8 files changed, 14 insertions(+), 11 deletions(-)
1b902b4ed39e78066fab163d1b6d54dd435b1d7b

 .../kafka/server/AbstractFetcherManager.scala      | 29 +++++++++++++++-------
 .../scala/kafka/server/AbstractFetcherThread.scala |  2 +-
 2 files changed, 21 insertions(+), 10 deletions(-)
ef92bb4e00da10728cf74c2d81f8f2bbec4c9c02

 .../streams/processor/internals/StreamThread.java  | 10 ++++----
 .../apache/kafka/streams/perf/SimpleBenchmark.java | 26 ++++++++------------
 .../processor/internals/StreamThreadTest.java      | 28 +++++++++++-----------
 3 files changed, 28 insertions(+), 36 deletions(-)
b380a82d5be7c68141590467911ecb61db45ed1e

 .../processor/internals/MinTimestampTracker.java   |  15 ++-
 .../internals/MinTimestampTrackerTest.java         | 102 +++++++++------------
 2 files changed, 55 insertions(+), 62 deletions(-)
0fba529608a5eb829feb66a499c89ead40b79694

 .../internals/assignment/ClientState.java          |   4 +
 .../internals/assignment/StickyTaskAssignor.java   |  71 ++++++++----
 .../internals/assignment/ClientStateTest.java      |  13 +++
 .../assignment/StickyTaskAssignorTest.java         | 121 ++++++++++++++++++++-
 4 files changed, 182 insertions(+), 27 deletions(-)
c9872cb2142bbee12e4657af9a84627a1684fddd

 README.md                   | 21 ++++++++++++++++++---
 build.gradle                | 14 ++++++++++++++
 gradle/findbugs-exclude.xml | 28 ++++++++++++++++++++++++++++
 3 files changed, 60 insertions(+), 3 deletions(-)
de05c9d3a0d79a555088afe9344b52e002d287f2

 build.gradle                                       |   5 +-
 checkstyle/checkstyle.xml                          |  36 ++++
 checkstyle/suppressions.xml                        | 229 +++++++++++++++++++++
 .../apache/kafka/common/protocol/types/Struct.java |   2 +-
 .../authenticator/SaslClientCallbackHandler.java   |   2 +-
 .../kafka/clients/producer/ProducerRecordTest.java |  12 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |   6 +-
 .../streams/kstream/internals/SessionKeySerde.java |   6 +-
 .../kafka/streams/processor/TopologyBuilder.java   |   4 +-
 .../KStreamAggregationDedupIntegrationTest.java    |  12 +-
 .../KStreamAggregationIntegrationTest.java         |  24 +--
 .../internals/StreamsMetadataStateTest.java        |   7 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   2 +-
 13 files changed, 307 insertions(+), 40 deletions(-)
a10d7b1b765a2ac4af3e219b7c344f67a93de487

 .../processor/internals/ProcessorTopologyTest.java | 46 ++++++++++++++++++++++
 .../kafka/test/ProcessorTopologyTestDriver.java    | 29 ++++++++++----
 2 files changed, 67 insertions(+), 8 deletions(-)
e31c0c9bdbad432bc21b583bd3c084f05323f642

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d0e436c471ba4122ddcc0f7a1624546f97c4a517

 checkstyle/checkstyle.xml                          |  4 +--
 checkstyle/java.header                             | 16 +++++++++++
 .../org/apache/kafka/clients/ClientRequest.java    | 26 +++++++++--------
 .../org/apache/kafka/clients/ClientResponse.java   | 26 +++++++++--------
 .../java/org/apache/kafka/clients/ClientUtils.java | 22 +++++++++------
 .../kafka/clients/ClusterConnectionStates.java     | 26 +++++++++--------
 .../apache/kafka/clients/CommonClientConfigs.java  | 23 ++++++++-------
 .../org/apache/kafka/clients/ConnectionState.java  | 26 +++++++++--------
 .../org/apache/kafka/clients/InFlightRequests.java | 26 +++++++++--------
 .../java/org/apache/kafka/clients/KafkaClient.java | 26 +++++++++--------
 .../kafka/clients/ManualMetadataUpdater.java       | 23 ++++++++-------
 .../java/org/apache/kafka/clients/Metadata.java    | 22 +++++++++------
 .../org/apache/kafka/clients/MetadataUpdater.java  | 23 ++++++++-------
 .../org/apache/kafka/clients/NetworkClient.java    | 22 +++++++++------
 .../org/apache/kafka/clients/NodeApiVersions.java  | 22 +++++++++------
 .../kafka/clients/RequestCompletionHandler.java    | 26 +++++++++--------
 .../clients/consumer/CommitFailedException.java    |  6 ++--
 .../apache/kafka/clients/consumer/Consumer.java    | 22 +++++++++------
 .../kafka/clients/consumer/ConsumerConfig.java     | 22 +++++++++------
 .../clients/consumer/ConsumerInterceptor.java      | 22 +++++++++------
 .../consumer/ConsumerRebalanceListener.java        | 22 +++++++++------
 .../kafka/clients/consumer/ConsumerRecord.java     | 26 +++++++++--------
 .../kafka/clients/consumer/ConsumerRecords.java    | 26 +++++++++--------
 .../clients/consumer/InvalidOffsetException.java   | 22 +++++++++------
 .../kafka/clients/consumer/KafkaConsumer.java      | 22 +++++++++------
 .../kafka/clients/consumer/MockConsumer.java       | 22 +++++++++------
 .../consumer/NoOffsetForPartitionException.java    | 27 ++++++++++--------
 .../kafka/clients/consumer/OffsetAndMetadata.java  | 22 +++++++++------
 .../kafka/clients/consumer/OffsetAndTimestamp.java |  6 ++--
 .../clients/consumer/OffsetCommitCallback.java     | 22 +++++++++------
 .../consumer/OffsetOutOfRangeException.java        | 26 +++++++++--------
 .../clients/consumer/OffsetResetStrategy.java      | 22 +++++++++------
 .../kafka/clients/consumer/RangeAssignor.java      | 12 ++++----
 .../consumer/RetriableCommitFailedException.java   |  6 ++--
 .../kafka/clients/consumer/RoundRobinAssignor.java | 26 +++++++++--------
 .../consumer/internals/AbstractCoordinator.java    | 26 +++++++++--------
 .../internals/AbstractPartitionAssignor.java       | 26 +++++++++--------
 .../consumer/internals/ConsumerCoordinator.java    | 22 +++++++++------
 .../consumer/internals/ConsumerInterceptors.java   | 22 +++++++++------
 .../consumer/internals/ConsumerNetworkClient.java  | 22 +++++++++------
 .../consumer/internals/ConsumerProtocol.java       |  6 ++--
 .../kafka/clients/consumer/internals/Fetcher.java  | 23 ++++++++-------
 .../clients/consumer/internals/Heartbeat.java      | 26 +++++++++--------
 .../internals/NoAvailableBrokersException.java     | 22 +++++++++------
 .../internals/NoOpConsumerRebalanceListener.java   | 27 ++++++++++--------
 .../consumer/internals/PartitionAssignor.java      | 22 +++++++++------
 .../clients/consumer/internals/RequestFuture.java  | 22 +++++++++------
 .../consumer/internals/RequestFutureAdapter.java   | 22 +++++++++------
 .../consumer/internals/RequestFutureListener.java  | 22 +++++++++------
 .../consumer/internals/StaleMetadataException.java | 22 +++++++++------
 .../consumer/internals/SubscriptionState.java      | 22 +++++++++------
 .../clients/producer/BufferExhaustedException.java |  6 ++--
 .../apache/kafka/clients/producer/Callback.java    |  6 ++--
 .../kafka/clients/producer/KafkaProducer.java      | 22 +++++++++------
 .../kafka/clients/producer/MockProducer.java       |  6 ++--
 .../apache/kafka/clients/producer/Partitioner.java |  7 ++---
 .../apache/kafka/clients/producer/Producer.java    |  6 ++--
 .../kafka/clients/producer/ProducerConfig.java     | 22 +++++++++------
 .../clients/producer/ProducerInterceptor.java      |  6 ++--
 .../kafka/clients/producer/ProducerRecord.java     | 26 +++++++++--------
 .../kafka/clients/producer/RecordMetadata.java     |  6 ++--
 .../clients/producer/internals/BufferPool.java     |  6 ++--
 .../producer/internals/DefaultPartitioner.java     |  6 ++--
 .../producer/internals/ErrorLoggingCallback.java   | 23 ++++++++-------
 .../producer/internals/FutureRecordMetadata.java   | 26 +++++++++--------
 .../producer/internals/ProduceRequestResult.java   |  6 ++--
 .../producer/internals/ProducerInterceptors.java   |  6 ++--
 .../producer/internals/RecordAccumulator.java      | 26 +++++++++--------
 .../clients/producer/internals/RecordBatch.java    | 26 +++++++++--------
 .../kafka/clients/producer/internals/Sender.java   | 26 +++++++++--------
 .../main/java/org/apache/kafka/common/Cluster.java | 26 +++++++++--------
 .../org/apache/kafka/common/ClusterResource.java   |  7 ++---
 .../kafka/common/ClusterResourceListener.java      | 23 ++++++++-------
 .../java/org/apache/kafka/common/Configurable.java |  6 ++--
 .../org/apache/kafka/common/KafkaException.java    |  6 ++--
 .../main/java/org/apache/kafka/common/Metric.java  |  6 ++--
 .../java/org/apache/kafka/common/MetricName.java   | 24 +++++++++-------
 .../main/java/org/apache/kafka/common/Node.java    | 22 +++++++++------
 .../org/apache/kafka/common/PartitionInfo.java     | 26 +++++++++--------
 .../org/apache/kafka/common/TopicPartition.java    |  6 ++--
 .../common/annotation/InterfaceStability.java      | 22 +++++++++------
 .../java/org/apache/kafka/common/cache/Cache.java  |  9 +++---
 .../org/apache/kafka/common/cache/LRUCache.java    |  9 +++---
 .../kafka/common/cache/SynchronizedCache.java      |  9 +++---
 .../apache/kafka/common/config/AbstractConfig.java | 22 +++++++++------
 .../org/apache/kafka/common/config/Config.java     | 22 +++++++++------
 .../org/apache/kafka/common/config/ConfigDef.java  | 22 +++++++++------
 .../kafka/common/config/ConfigException.java       |  6 ++--
 .../apache/kafka/common/config/ConfigValue.java    | 15 +++++-----
 .../apache/kafka/common/config/SaslConfigs.java    | 23 ++++++++-------
 .../org/apache/kafka/common/config/SslConfigs.java | 23 ++++++++-------
 .../apache/kafka/common/config/types/Password.java |  9 +++---
 .../apache/kafka/common/errors/ApiException.java   |  6 ++--
 .../common/errors/AuthenticationException.java     | 22 +++++++++------
 .../common/errors/AuthorizationException.java      | 22 +++++++++------
 .../common/errors/BrokerNotAvailableException.java |  7 ++---
 .../errors/ClusterAuthorizationException.java      | 22 +++++++++------
 .../common/errors/ControllerMovedException.java    |  7 ++---
 .../common/errors/CorruptRecordException.java      | 22 +++++++++------
 .../kafka/common/errors/DisconnectException.java   | 22 +++++++++------
 .../common/errors/GroupAuthorizationException.java | 22 +++++++++------
 .../GroupCoordinatorNotAvailableException.java     | 23 ++++++++-------
 .../errors/GroupLoadInProgressException.java       | 23 ++++++++-------
 .../common/errors/IllegalGenerationException.java  | 22 +++++++++------
 .../common/errors/IllegalSaslStateException.java   | 22 +++++++++------
 .../errors/InconsistentGroupProtocolException.java | 22 +++++++++------
 .../kafka/common/errors/InterruptException.java    | 26 +++++++++--------
 .../errors/InvalidCommitOffsetSizeException.java   | 22 +++++++++------
 .../errors/InvalidConfigurationException.java      |  8 +++---
 .../common/errors/InvalidFetchSizeException.java   | 22 +++++++++------
 .../common/errors/InvalidGroupIdException.java     | 22 +++++++++------
 .../common/errors/InvalidMetadataException.java    | 27 ++++++++++--------
 .../common/errors/InvalidOffsetException.java      |  7 ++---
 .../common/errors/InvalidPartitionsException.java  |  8 +++---
 .../errors/InvalidReplicaAssignmentException.java  |  8 +++---
 .../errors/InvalidReplicationFactorException.java  |  8 +++---
 .../common/errors/InvalidRequestException.java     |  8 +++---
 .../errors/InvalidRequiredAcksException.java       |  8 +++---
 .../errors/InvalidSessionTimeoutException.java     | 22 +++++++++------
 .../common/errors/InvalidTimestampException.java   |  7 ++---
 .../kafka/common/errors/InvalidTopicException.java | 26 +++++++++--------
 .../common/errors/LeaderNotAvailableException.java | 22 +++++++++------
 .../kafka/common/errors/NetworkException.java      | 26 +++++++++--------
 .../common/errors/NotControllerException.java      | 23 ++++++++-------
 .../errors/NotCoordinatorForGroupException.java    | 23 ++++++++-------
 .../NotEnoughReplicasAfterAppendException.java     |  8 +++---
 .../common/errors/NotEnoughReplicasException.java  |  8 +++---
 .../errors/NotLeaderForPartitionException.java     | 26 +++++++++--------
 .../common/errors/OffsetMetadataTooLarge.java      | 22 +++++++++------
 .../common/errors/OffsetOutOfRangeException.java   |  7 ++---
 .../common/errors/PolicyViolationException.java    |  7 ++---
 .../errors/RebalanceInProgressException.java       |  6 ++--
 .../errors/RecordBatchTooLargeException.java       | 22 +++++++++------
 .../common/errors/RecordTooLargeException.java     | 26 +++++++++--------
 .../errors/ReplicaNotAvailableException.java       |  7 ++---
 .../kafka/common/errors/RetriableException.java    | 26 +++++++++--------
 .../common/errors/SerializationException.java      | 22 +++++++++------
 .../kafka/common/errors/TimeoutException.java      | 26 +++++++++--------
 .../common/errors/TopicAuthorizationException.java | 22 +++++++++------
 .../kafka/common/errors/TopicExistsException.java  |  8 +++---
 .../common/errors/UnknownMemberIdException.java    | 22 +++++++++------
 .../common/errors/UnknownServerException.java      | 26 +++++++++--------
 .../errors/UnknownTopicOrPartitionException.java   | 26 +++++++++--------
 .../UnsupportedForMessageFormatException.java      | 22 +++++++++------
 .../errors/UnsupportedSaslMechanismException.java  | 22 +++++++++------
 .../common/errors/UnsupportedVersionException.java | 22 +++++++++------
 .../kafka/common/errors/WakeupException.java       | 22 +++++++++------
 .../common/internals/ClusterResourceListeners.java |  7 ++---
 .../kafka/common/internals/FatalExitError.java     | 22 +++++++++------
 .../kafka/common/internals/PartitionStates.java    |  7 ++---
 .../apache/kafka/common/metrics/CompoundStat.java  |  6 ++--
 .../apache/kafka/common/metrics/JmxReporter.java   | 26 +++++++++--------
 .../apache/kafka/common/metrics/KafkaMetric.java   |  6 ++--
 .../apache/kafka/common/metrics/Measurable.java    | 26 +++++++++--------
 .../kafka/common/metrics/MeasurableStat.java       |  6 ++--
 .../apache/kafka/common/metrics/MetricConfig.java  |  6 ++--
 .../org/apache/kafka/common/metrics/Metrics.java   | 26 +++++++++--------
 .../kafka/common/metrics/MetricsReporter.java      | 26 +++++++++--------
 .../org/apache/kafka/common/metrics/Quota.java     |  6 ++--
 .../common/metrics/QuotaViolationException.java    |  6 ++--
 .../org/apache/kafka/common/metrics/Sensor.java    | 26 +++++++++--------
 .../java/org/apache/kafka/common/metrics/Stat.java |  6 ++--
 .../org/apache/kafka/common/metrics/stats/Avg.java | 26 +++++++++--------
 .../apache/kafka/common/metrics/stats/Count.java   | 26 +++++++++--------
 .../kafka/common/metrics/stats/Histogram.java      |  6 ++--
 .../org/apache/kafka/common/metrics/stats/Max.java | 26 +++++++++--------
 .../org/apache/kafka/common/metrics/stats/Min.java | 26 +++++++++--------
 .../kafka/common/metrics/stats/Percentile.java     |  6 ++--
 .../kafka/common/metrics/stats/Percentiles.java    | 26 +++++++++--------
 .../apache/kafka/common/metrics/stats/Rate.java    | 26 +++++++++--------
 .../kafka/common/metrics/stats/SampledStat.java    | 26 +++++++++--------
 .../kafka/common/metrics/stats/SimpleRate.java     | 12 ++++----
 .../apache/kafka/common/metrics/stats/Total.java   | 26 +++++++++--------
 .../apache/kafka/common/metrics/stats/Value.java   | 22 +++++++++------
 .../apache/kafka/common/network/Authenticator.java |  7 ++---
 .../kafka/common/network/ByteBufferReceive.java    |  6 ++--
 .../kafka/common/network/ByteBufferSend.java       | 22 +++++++++------
 .../kafka/common/network/ChannelBuilder.java       | 22 +++++++++------
 .../kafka/common/network/ChannelBuilders.java      | 23 ++++++++-------
 .../kafka/common/network/DefaultAuthenticator.java |  7 ++---
 .../common/network/InvalidReceiveException.java    |  8 +++---
 .../apache/kafka/common/network/KafkaChannel.java  |  7 ++---
 .../apache/kafka/common/network/ListenerName.java  |  8 +++---
 .../java/org/apache/kafka/common/network/Mode.java |  6 ++--
 .../org/apache/kafka/common/network/MultiSend.java |  8 +++---
 .../kafka/common/network/NetworkReceive.java       | 22 +++++++++------
 .../apache/kafka/common/network/NetworkSend.java   |  6 ++--
 .../common/network/PlaintextChannelBuilder.java    | 22 +++++++++------
 .../common/network/PlaintextTransportLayer.java    |  7 ++---
 .../org/apache/kafka/common/network/Receive.java   |  6 ++--
 .../kafka/common/network/SaslChannelBuilder.java   | 22 +++++++++------
 .../apache/kafka/common/network/Selectable.java    | 22 +++++++++------
 .../org/apache/kafka/common/network/Selector.java  | 22 +++++++++------
 .../java/org/apache/kafka/common/network/Send.java | 22 +++++++++------
 .../kafka/common/network/SslChannelBuilder.java    | 22 +++++++++------
 .../kafka/common/network/SslTransportLayer.java    |  7 ++---
 .../kafka/common/network/TransportLayer.java       |  7 ++---
 .../kafka/common/network/TransportLayers.java      |  7 ++---
 .../org/apache/kafka/common/protocol/ApiKeys.java  |  6 ++--
 .../org/apache/kafka/common/protocol/Errors.java   |  6 ++--
 .../org/apache/kafka/common/protocol/Protocol.java |  6 ++--
 .../kafka/common/protocol/SecurityProtocol.java    |  8 +++---
 .../kafka/common/protocol/types/ArrayOf.java       |  6 ++--
 .../apache/kafka/common/protocol/types/Field.java  |  6 ++--
 .../apache/kafka/common/protocol/types/Schema.java | 26 +++++++++--------
 .../common/protocol/types/SchemaException.java     |  6 ++--
 .../apache/kafka/common/protocol/types/Struct.java | 22 +++++++++------
 .../apache/kafka/common/protocol/types/Type.java   |  6 ++--
 .../kafka/common/record/AbstractRecords.java       | 14 ++++-----
 .../kafka/common/record/ByteBufferInputStream.java |  6 ++--
 .../common/record/ByteBufferLogInputStream.java    | 14 ++++-----
 .../common/record/ByteBufferOutputStream.java      |  6 ++--
 .../kafka/common/record/CompressionType.java       |  6 ++--
 .../kafka/common/record/FileLogInputStream.java    | 14 ++++-----
 .../apache/kafka/common/record/FileRecords.java    | 14 ++++-----
 .../common/record/InvalidRecordException.java      |  6 ++--
 .../common/record/KafkaLZ4BlockInputStream.java    |  7 ++---
 .../common/record/KafkaLZ4BlockOutputStream.java   |  7 ++---
 .../org/apache/kafka/common/record/LogEntry.java   |  6 ++--
 .../apache/kafka/common/record/LogInputStream.java | 14 ++++-----
 .../apache/kafka/common/record/MemoryRecords.java  | 26 +++++++++--------
 .../kafka/common/record/MemoryRecordsBuilder.java  |  6 ++--
 .../org/apache/kafka/common/record/Record.java     |  6 ++--
 .../org/apache/kafka/common/record/Records.java    |  6 ++--
 .../kafka/common/record/RecordsIterator.java       | 14 ++++-----
 .../apache/kafka/common/record/TimestampType.java  |  7 ++---
 .../kafka/common/requests/AbstractRequest.java     |  8 +++---
 .../common/requests/AbstractRequestResponse.java   | 22 +++++++++------
 .../kafka/common/requests/AbstractResponse.java    | 14 ++++-----
 .../kafka/common/requests/ApiVersionsRequest.java  | 22 +++++++++------
 .../kafka/common/requests/ApiVersionsResponse.java | 22 +++++++++------
 .../common/requests/ControlledShutdownRequest.java | 22 +++++++++------
 .../requests/ControlledShutdownResponse.java       | 22 +++++++++------
 .../kafka/common/requests/CreateTopicsRequest.java |  8 +++---
 .../common/requests/CreateTopicsResponse.java      |  8 +++---
 .../kafka/common/requests/DeleteTopicsRequest.java |  8 +++---
 .../common/requests/DeleteTopicsResponse.java      |  8 +++---
 .../common/requests/DescribeGroupsRequest.java     | 22 +++++++++------
 .../common/requests/DescribeGroupsResponse.java    | 22 +++++++++------
 .../apache/kafka/common/requests/FetchRequest.java | 22 +++++++++------
 .../kafka/common/requests/FetchResponse.java       |  6 ++--
 .../common/requests/GroupCoordinatorRequest.java   | 22 +++++++++------
 .../common/requests/GroupCoordinatorResponse.java  | 22 +++++++++------
 .../kafka/common/requests/HeartbeatRequest.java    | 22 +++++++++------
 .../kafka/common/requests/HeartbeatResponse.java   | 22 +++++++++------
 .../kafka/common/requests/JoinGroupRequest.java    | 22 +++++++++------
 .../kafka/common/requests/JoinGroupResponse.java   | 22 +++++++++------
 .../kafka/common/requests/LeaderAndIsrRequest.java |  7 ++---
 .../common/requests/LeaderAndIsrResponse.java      | 23 ++++++++-------
 .../kafka/common/requests/LeaveGroupRequest.java   | 22 +++++++++------
 .../kafka/common/requests/LeaveGroupResponse.java  | 22 +++++++++------
 .../kafka/common/requests/ListGroupsRequest.java   | 22 +++++++++------
 .../kafka/common/requests/ListGroupsResponse.java  | 22 +++++++++------
 .../kafka/common/requests/ListOffsetRequest.java   |  6 ++--
 .../kafka/common/requests/ListOffsetResponse.java  |  6 ++--
 .../kafka/common/requests/MetadataRequest.java     | 22 +++++++++------
 .../kafka/common/requests/MetadataResponse.java    | 22 +++++++++------
 .../kafka/common/requests/OffsetCommitRequest.java | 22 +++++++++------
 .../common/requests/OffsetCommitResponse.java      | 22 +++++++++------
 .../kafka/common/requests/OffsetFetchRequest.java  | 22 +++++++++------
 .../kafka/common/requests/OffsetFetchResponse.java | 22 +++++++++------
 .../kafka/common/requests/PartitionState.java      | 23 ++++++++-------
 .../kafka/common/requests/ProduceRequest.java      | 23 ++++++++-------
 .../kafka/common/requests/ProduceResponse.java     | 26 +++++++++--------
 .../apache/kafka/common/requests/RecordsSend.java  | 14 ++++-----
 .../kafka/common/requests/RequestAndSize.java      |  6 ++--
 .../kafka/common/requests/RequestHeader.java       | 26 +++++++++--------
 .../kafka/common/requests/ResponseHeader.java      |  6 ++--
 .../common/requests/SaslHandshakeRequest.java      | 18 ++++++------
 .../common/requests/SaslHandshakeResponse.java     | 18 ++++++------
 .../kafka/common/requests/StopReplicaRequest.java  | 23 ++++++++-------
 .../kafka/common/requests/StopReplicaResponse.java | 23 ++++++++-------
 .../kafka/common/requests/SyncGroupRequest.java    |  6 ++--
 .../kafka/common/requests/SyncGroupResponse.java   |  6 ++--
 .../common/requests/UpdateMetadataRequest.java     | 23 ++++++++-------
 .../common/requests/UpdateMetadataResponse.java    | 23 ++++++++-------
 .../apache/kafka/common/security/JaasConfig.java   |  7 ++---
 .../apache/kafka/common/security/JaasContext.java  |  9 +++---
 .../apache/kafka/common/security/JaasUtils.java    |  8 +++---
 .../common/security/auth/AuthCallbackHandler.java  |  7 ++---
 .../security/auth/DefaultPrincipalBuilder.java     |  7 ++---
 .../kafka/common/security/auth/KafkaPrincipal.java | 12 ++++----
 .../apache/kafka/common/security/auth/Login.java   | 18 ++++++------
 .../common/security/auth/PrincipalBuilder.java     |  7 ++---
 .../security/authenticator/AbstractLogin.java      | 18 ++++++------
 .../security/authenticator/CredentialCache.java    | 18 ++++++------
 .../security/authenticator/DefaultLogin.java       | 18 ++++++------
 .../security/authenticator/LoginManager.java       | 18 ++++++------
 .../authenticator/SaslClientAuthenticator.java     | 18 ++++++------
 .../authenticator/SaslClientCallbackHandler.java   | 17 ++++++-----
 .../authenticator/SaslServerAuthenticator.java     |  7 ++---
 .../authenticator/SaslServerCallbackHandler.java   | 18 ++++++------
 .../common/security/kerberos/BadFormatString.java  | 18 ++++++------
 .../common/security/kerberos/KerberosLogin.java    | 18 ++++++------
 .../common/security/kerberos/KerberosName.java     | 18 ++++++------
 .../common/security/kerberos/KerberosRule.java     | 18 ++++++------
 .../security/kerberos/KerberosShortNamer.java      | 18 ++++++------
 .../common/security/kerberos/NoMatchingRule.java   | 18 ++++++------
 .../common/security/plain/PlainLoginModule.java    | 18 ++++++------
 .../common/security/plain/PlainSaslServer.java     | 18 ++++++------
 .../security/plain/PlainSaslServerProvider.java    | 18 ++++++------
 .../common/security/scram/ScramCredential.java     | 18 ++++++------
 .../security/scram/ScramCredentialCallback.java    |  7 ++---
 .../security/scram/ScramCredentialUtils.java       | 20 ++++++-------
 .../common/security/scram/ScramFormatter.java      | 18 ++++++------
 .../common/security/scram/ScramLoginModule.java    | 18 ++++++------
 .../common/security/scram/ScramMechanism.java      | 18 ++++++------
 .../kafka/common/security/scram/ScramMessages.java | 18 ++++++------
 .../common/security/scram/ScramSaslClient.java     | 18 ++++++------
 .../security/scram/ScramSaslClientProvider.java    | 18 ++++++------
 .../common/security/scram/ScramSaslServer.java     | 18 ++++++------
 .../security/scram/ScramSaslServerProvider.java    | 18 ++++++------
 .../security/scram/ScramServerCallbackHandler.java |  7 ++---
 .../kafka/common/security/ssl/SslFactory.java      |  6 ++--
 .../serialization/ByteArrayDeserializer.java       | 23 ++++++++-------
 .../common/serialization/ByteArraySerializer.java  | 23 ++++++++-------
 .../serialization/ByteBufferDeserializer.java      | 22 +++++++++------
 .../common/serialization/ByteBufferSerializer.java | 22 +++++++++------
 .../common/serialization/BytesDeserializer.java    | 22 +++++++++------
 .../common/serialization/BytesSerializer.java      | 22 +++++++++------
 .../kafka/common/serialization/Deserializer.java   | 23 ++++++++-------
 .../common/serialization/DoubleDeserializer.java   | 22 +++++++++------
 .../common/serialization/DoubleSerializer.java     | 22 +++++++++------
 .../common/serialization/IntegerDeserializer.java  | 22 +++++++++------
 .../common/serialization/IntegerSerializer.java    | 22 +++++++++------
 .../common/serialization/LongDeserializer.java     | 22 +++++++++------
 .../kafka/common/serialization/LongSerializer.java | 22 +++++++++------
 .../apache/kafka/common/serialization/Serde.java   | 23 ++++++++-------
 .../apache/kafka/common/serialization/Serdes.java  | 23 ++++++++-------
 .../kafka/common/serialization/Serializer.java     | 23 ++++++++-------
 .../common/serialization/StringDeserializer.java   | 22 +++++++++------
 .../common/serialization/StringSerializer.java     | 22 +++++++++------
 .../kafka/common/utils/AbstractIterator.java       |  6 ++--
 .../apache/kafka/common/utils/AppInfoParser.java   |  6 ++--
 .../java/org/apache/kafka/common/utils/Bytes.java  |  7 ++---
 .../kafka/common/utils/CircularIterator.java       |  9 +++---
 .../apache/kafka/common/utils/CollectionUtils.java | 22 +++++++++------
 .../apache/kafka/common/utils/CopyOnWriteMap.java  | 26 +++++++++--------
 .../java/org/apache/kafka/common/utils/Crc32.java  | 26 +++++++++--------
 .../java/org/apache/kafka/common/utils/Exit.java   |  7 ++---
 .../org/apache/kafka/common/utils/KafkaThread.java | 26 +++++++++--------
 .../java/org/apache/kafka/common/utils/Shell.java  | 19 ++++++-------
 .../org/apache/kafka/common/utils/SystemTime.java  |  6 ++--
 .../java/org/apache/kafka/common/utils/Time.java   |  6 ++--
 .../java/org/apache/kafka/common/utils/Utils.java  | 22 +++++++++------
 .../kafka/server/policy/CreateTopicPolicy.java     | 23 ++++++++-------
 .../org/apache/kafka/clients/ClientUtilsTest.java  |  6 ++--
 .../org/apache/kafka/clients/MetadataTest.java     | 22 +++++++++------
 .../java/org/apache/kafka/clients/MockClient.java  |  6 ++--
 .../apache/kafka/clients/NetworkClientTest.java    |  6 ++--
 .../apache/kafka/clients/NodeApiVersionsTest.java  |  6 ++--
 .../kafka/clients/consumer/ConsumerConfigTest.java | 12 ++++----
 .../kafka/clients/consumer/ConsumerRecordTest.java | 14 ++++-----
 .../clients/consumer/ConsumerRecordsTest.java      | 11 ++++----
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  6 ++--
 .../kafka/clients/consumer/MockConsumerTest.java   |  6 ++--
 .../kafka/clients/consumer/RangeAssignorTest.java  | 12 ++++----
 .../clients/consumer/RoundRobinAssignorTest.java   | 26 +++++++++--------
 ...erializeCompatibilityOffsetAndMetadataTest.java | 23 ++++++++-------
 .../internals/AbstractCoordinatorTest.java         | 14 ++++-----
 .../internals/ConsumerCoordinatorTest.java         |  6 ++--
 .../internals/ConsumerInterceptorsTest.java        |  6 ++--
 .../internals/ConsumerNetworkClientTest.java       | 22 +++++++++------
 .../consumer/internals/ConsumerProtocolTest.java   | 12 ++++----
 .../clients/consumer/internals/FetcherTest.java    |  6 ++--
 .../clients/consumer/internals/HeartbeatTest.java  |  6 ++--
 .../consumer/internals/MockPartitionAssignor.java  | 12 ++++----
 .../consumer/internals/RequestFutureTest.java      | 22 +++++++++------
 .../consumer/internals/SubscriptionStateTest.java  |  6 ++--
 .../kafka/clients/producer/KafkaProducerTest.java  |  8 +++---
 .../kafka/clients/producer/MockProducerTest.java   |  6 ++--
 .../kafka/clients/producer/ProducerRecordTest.java |  6 ++--
 .../kafka/clients/producer/RecordSendTest.java     |  6 ++--
 .../clients/producer/internals/BufferPoolTest.java |  6 ++--
 .../producer/internals/DefaultPartitionerTest.java | 22 +++++++++------
 .../internals/ProducerInterceptorsTest.java        | 22 +++++++++------
 .../producer/internals/RecordAccumulatorTest.java  | 26 +++++++++--------
 .../clients/producer/internals/SenderTest.java     | 22 +++++++++------
 .../java/org/apache/kafka/common/ClusterTest.java  | 22 +++++++++------
 .../org/apache/kafka/common/PartitionInfoTest.java | 22 +++++++++------
 .../SerializeCompatibilityTopicPartitionTest.java  | 23 ++++++++-------
 .../apache/kafka/common/cache/LRUCacheTest.java    |  9 +++---
 .../kafka/common/config/AbstractConfigTest.java    | 26 +++++++++--------
 .../apache/kafka/common/config/ConfigDefTest.java  | 22 +++++++++------
 .../common/internals/PartitionStatesTest.java      |  7 ++---
 .../kafka/common/metrics/FakeMetricsReporter.java  | 26 +++++++++--------
 .../kafka/common/metrics/JmxReporterTest.java      |  6 ++--
 .../apache/kafka/common/metrics/MetricsTest.java   | 26 +++++++++--------
 .../apache/kafka/common/metrics/SensorTest.java    | 22 +++++++++------
 .../kafka/common/metrics/stats/HistogramTest.java  |  6 ++--
 .../apache/kafka/common/network/CertStores.java    | 22 +++++++++------
 .../apache/kafka/common/network/EchoServer.java    | 22 +++++++++------
 .../kafka/common/network/NetworkTestUtils.java     | 22 +++++++++------
 .../apache/kafka/common/network/NioEchoServer.java | 22 +++++++++------
 .../apache/kafka/common/network/SelectorTest.java  | 22 +++++++++------
 .../kafka/common/network/SslSelectorTest.java      | 22 +++++++++------
 .../common/network/SslTransportLayerTest.java      | 22 +++++++++------
 .../apache/kafka/common/protocol/ApiKeysTest.java  |  7 ++---
 .../apache/kafka/common/protocol/ErrorsTest.java   |  6 ++--
 .../protocol/types/ProtocolSerializationTest.java  |  6 ++--
 .../record/ByteBufferLogInputStreamTest.java       | 14 ++++-----
 .../kafka/common/record/CompressionTypeTest.java   | 14 ++++-----
 .../kafka/common/record/FileRecordsTest.java       | 14 ++++-----
 .../apache/kafka/common/record/KafkaLZ4Test.java   |  6 ++--
 .../common/record/MemoryRecordsBuilderTest.java    | 14 ++++-----
 .../kafka/common/record/MemoryRecordsTest.java     |  6 ++--
 .../org/apache/kafka/common/record/RecordTest.java |  6 ++--
 .../kafka/common/record/SimpleRecordTest.java      |  6 ++--
 .../kafka/common/record/TimestampTypeTest.java     | 14 ++++-----
 .../kafka/common/requests/RequestResponseTest.java | 23 ++++++++-------
 .../kafka/common/security/JaasContextTest.java     | 12 ++++----
 .../kafka/common/security/TestSecurityConfig.java  | 22 +++++++++------
 .../common/security/auth/KafkaPrincipalTest.java   | 12 ++++----
 .../authenticator/SaslAuthenticatorTest.java       | 22 +++++++++------
 .../authenticator/TestDigestLoginModule.java       | 22 +++++++++------
 .../security/authenticator/TestJaasConfig.java     | 22 +++++++++------
 .../common/security/kerberos/KerberosNameTest.java |  7 ++---
 .../security/scram/ScramCredentialUtilsTest.java   |  7 ++---
 .../common/security/scram/ScramFormatterTest.java  |  7 ++---
 .../common/security/scram/ScramMessagesTest.java   |  7 ++---
 .../kafka/common/security/ssl/SslFactoryTest.java  | 22 +++++++++------
 .../common/serialization/SerializationTest.java    | 22 +++++++++------
 .../kafka/common/utils/AbstractIteratorTest.java   |  6 ++--
 .../org/apache/kafka/common/utils/CrcTest.java     |  6 ++--
 .../org/apache/kafka/common/utils/MockTime.java    | 22 +++++++++------
 .../org/apache/kafka/common/utils/Serializer.java  | 23 ++++++++-------
 .../org/apache/kafka/common/utils/UtilsTest.java   |  6 ++--
 .../java/org/apache/kafka/test/DelayedReceive.java |  6 ++--
 .../java/org/apache/kafka/test/MetricsBench.java   | 26 +++++++++--------
 .../org/apache/kafka/test/Microbenchmarks.java     | 26 +++++++++--------
 .../kafka/test/MockClusterResourceListener.java    |  7 ++---
 .../apache/kafka/test/MockConsumerInterceptor.java |  6 ++--
 .../org/apache/kafka/test/MockDeserializer.java    |  6 ++--
 .../org/apache/kafka/test/MockMetricsReporter.java |  6 ++--
 .../org/apache/kafka/test/MockPartitioner.java     |  6 ++--
 .../apache/kafka/test/MockProducerInterceptor.java |  6 ++--
 .../java/org/apache/kafka/test/MockSelector.java   | 22 +++++++++------
 .../java/org/apache/kafka/test/MockSerializer.java |  6 ++--
 .../java/org/apache/kafka/test/TestCondition.java  | 30 ++++++++++----------
 .../java/org/apache/kafka/test/TestSslUtils.java   |  7 ++---
 .../test/java/org/apache/kafka/test/TestUtils.java | 12 ++++----
 .../kafka/connect/connector/ConnectRecord.java     | 15 +++++-----
 .../apache/kafka/connect/connector/Connector.java  |  9 +++---
 .../kafka/connect/connector/ConnectorContext.java  |  9 +++---
 .../org/apache/kafka/connect/connector/Task.java   |  9 +++---
 .../apache/kafka/connect/data/ConnectSchema.java   |  9 +++---
 .../java/org/apache/kafka/connect/data/Date.java   |  9 +++---
 .../org/apache/kafka/connect/data/Decimal.java     |  9 +++---
 .../java/org/apache/kafka/connect/data/Field.java  |  9 +++---
 .../java/org/apache/kafka/connect/data/Schema.java |  9 +++---
 .../apache/kafka/connect/data/SchemaAndValue.java  |  9 +++---
 .../apache/kafka/connect/data/SchemaBuilder.java   |  9 +++---
 .../apache/kafka/connect/data/SchemaProjector.java | 27 +++++++++---------
 .../java/org/apache/kafka/connect/data/Struct.java |  9 +++---
 .../java/org/apache/kafka/connect/data/Time.java   |  9 +++---
 .../org/apache/kafka/connect/data/Timestamp.java   |  9 +++---
 .../connect/errors/AlreadyExistsException.java     |  9 +++---
 .../kafka/connect/errors/ConnectException.java     |  9 +++---
 .../apache/kafka/connect/errors/DataException.java |  9 +++---
 .../errors/IllegalWorkerStateException.java        |  9 +++---
 .../kafka/connect/errors/NotFoundException.java    |  9 +++---
 .../kafka/connect/errors/RetriableException.java   |  9 +++---
 .../connect/errors/SchemaBuilderException.java     |  9 +++---
 .../connect/errors/SchemaProjectorException.java   | 26 +++++++++--------
 .../apache/kafka/connect/sink/SinkConnector.java   |  9 +++---
 .../org/apache/kafka/connect/sink/SinkRecord.java  | 15 +++++-----
 .../org/apache/kafka/connect/sink/SinkTask.java    |  8 +++---
 .../apache/kafka/connect/sink/SinkTaskContext.java |  9 +++---
 .../kafka/connect/source/SourceConnector.java      |  8 +++---
 .../apache/kafka/connect/source/SourceRecord.java  | 15 +++++-----
 .../apache/kafka/connect/source/SourceTask.java    |  9 +++---
 .../kafka/connect/source/SourceTaskContext.java    |  8 +++---
 .../apache/kafka/connect/storage/Converter.java    |  9 +++---
 .../kafka/connect/storage/OffsetStorageReader.java |  9 +++---
 .../kafka/connect/storage/StringConverter.java     |  9 +++---
 .../kafka/connect/transforms/Transformation.java   |  9 +++---
 .../apache/kafka/connect/util/ConnectorUtils.java  |  9 +++---
 .../connector/ConnectorReconfigurationTest.java    |  9 +++---
 .../kafka/connect/data/ConnectSchemaTest.java      |  9 +++---
 .../org/apache/kafka/connect/data/DateTest.java    |  9 +++---
 .../org/apache/kafka/connect/data/DecimalTest.java |  9 +++---
 .../org/apache/kafka/connect/data/FakeSchema.java  |  9 +++---
 .../org/apache/kafka/connect/data/FieldTest.java   |  9 +++---
 .../kafka/connect/data/SchemaBuilderTest.java      |  9 +++---
 .../kafka/connect/data/SchemaProjectorTest.java    | 27 +++++++++---------
 .../org/apache/kafka/connect/data/StructTest.java  |  9 +++---
 .../org/apache/kafka/connect/data/TimeTest.java    |  9 +++---
 .../apache/kafka/connect/data/TimestampTest.java   |  9 +++---
 .../kafka/connect/storage/StringConverterTest.java |  9 +++---
 .../kafka/connect/util/ConnectorUtilsTest.java     |  9 +++---
 .../connect/file/FileStreamSinkConnector.java      |  9 +++---
 .../kafka/connect/file/FileStreamSinkTask.java     |  9 +++---
 .../connect/file/FileStreamSourceConnector.java    |  9 +++---
 .../kafka/connect/file/FileStreamSourceTask.java   |  9 +++---
 .../connect/file/FileStreamSinkConnectorTest.java  |  9 +++---
 .../kafka/connect/file/FileStreamSinkTaskTest.java |  9 +++---
 .../file/FileStreamSourceConnectorTest.java        |  9 +++---
 .../connect/file/FileStreamSourceTaskTest.java     |  9 +++---
 .../apache/kafka/connect/json/JsonConverter.java   | 15 +++++-----
 .../kafka/connect/json/JsonDeserializer.java       | 14 ++++-----
 .../org/apache/kafka/connect/json/JsonSchema.java  |  9 +++---
 .../apache/kafka/connect/json/JsonSerializer.java  | 14 ++++-----
 .../kafka/connect/json/JsonConverterTest.java      |  9 +++---
 .../kafka/connect/cli/ConnectDistributed.java      |  9 +++---
 .../kafka/connect/cli/ConnectStandalone.java       | 15 +++++-----
 .../kafka/connect/runtime/AbstractHerder.java      | 14 ++++-----
 .../kafka/connect/runtime/AbstractStatus.java      | 14 ++++-----
 .../org/apache/kafka/connect/runtime/Connect.java  | 15 +++++-----
 .../kafka/connect/runtime/ConnectorConfig.java     | 15 +++++-----
 .../kafka/connect/runtime/ConnectorFactory.java    | 29 +++++++++----------
 .../kafka/connect/runtime/ConnectorStatus.java     |  8 +++---
 .../org/apache/kafka/connect/runtime/Herder.java   | 15 +++++-----
 .../connect/runtime/HerderConnectorContext.java    | 15 +++++-----
 .../kafka/connect/runtime/PluginDiscovery.java     | 15 +++++-----
 .../kafka/connect/runtime/SinkConnectorConfig.java | 15 +++++-----
 .../connect/runtime/SourceConnectorConfig.java     | 15 +++++-----
 .../connect/runtime/SourceTaskOffsetCommitter.java | 15 +++++-----
 .../apache/kafka/connect/runtime/TargetState.java  | 14 ++++-----
 .../apache/kafka/connect/runtime/TaskConfig.java   |  9 +++---
 .../apache/kafka/connect/runtime/TaskStatus.java   | 14 ++++-----
 .../kafka/connect/runtime/TransformationChain.java | 15 +++++-----
 .../org/apache/kafka/connect/runtime/Worker.java   | 15 +++++-----
 .../apache/kafka/connect/runtime/WorkerConfig.java | 15 +++++-----
 .../kafka/connect/runtime/WorkerConnector.java     | 14 ++++-----
 .../kafka/connect/runtime/WorkerSinkTask.java      | 15 +++++-----
 .../connect/runtime/WorkerSinkTaskContext.java     | 27 ++++++++++--------
 .../kafka/connect/runtime/WorkerSourceTask.java    | 15 +++++-----
 .../connect/runtime/WorkerSourceTaskContext.java   |  9 +++---
 .../apache/kafka/connect/runtime/WorkerTask.java   | 15 +++++-----
 .../runtime/distributed/ClusterConfigState.java    |  9 +++---
 .../runtime/distributed/ConnectProtocol.java       |  9 +++---
 .../runtime/distributed/DistributedConfig.java     |  9 +++---
 .../runtime/distributed/DistributedHerder.java     |  9 +++---
 .../runtime/distributed/NotAssignedException.java  | 14 ++++-----
 .../runtime/distributed/NotLeaderException.java    |  9 +++---
 .../distributed/RebalanceNeededException.java      | 14 ++++-----
 .../distributed/RequestTargetException.java        | 14 ++++-----
 .../runtime/distributed/WorkerCoordinator.java     |  8 +++---
 .../runtime/distributed/WorkerGroupMember.java     |  9 +++---
 .../distributed/WorkerRebalanceListener.java       |  9 +++---
 .../kafka/connect/runtime/rest/RestServer.java     |  9 +++---
 .../connect/runtime/rest/entities/ConfigInfo.java  | 15 +++++-----
 .../connect/runtime/rest/entities/ConfigInfos.java | 15 +++++-----
 .../runtime/rest/entities/ConfigKeyInfo.java       | 15 +++++-----
 .../runtime/rest/entities/ConfigValueInfo.java     | 15 +++++-----
 .../runtime/rest/entities/ConnectorInfo.java       |  9 +++---
 .../runtime/rest/entities/ConnectorPluginInfo.java | 27 ++++++++++--------
 .../runtime/rest/entities/ConnectorStateInfo.java  | 14 ++++-----
 .../rest/entities/CreateConnectorRequest.java      |  9 +++---
 .../runtime/rest/entities/ErrorMessage.java        |  9 +++---
 .../connect/runtime/rest/entities/ServerInfo.java  |  9 +++---
 .../connect/runtime/rest/entities/TaskInfo.java    |  9 +++---
 .../runtime/rest/errors/BadRequestException.java   | 14 ++++-----
 .../rest/errors/ConnectExceptionMapper.java        |  9 +++---
 .../runtime/rest/errors/ConnectRestException.java  |  9 +++---
 .../rest/resources/ConnectorPluginsResource.java   |  9 +++---
 .../runtime/rest/resources/ConnectorsResource.java |  9 +++---
 .../runtime/rest/resources/RootResource.java       |  9 +++---
 .../runtime/standalone/StandaloneConfig.java       |  9 +++---
 .../runtime/standalone/StandaloneHerder.java       | 15 +++++-----
 .../kafka/connect/storage/ConfigBackingStore.java  | 14 ++++-----
 .../connect/storage/FileOffsetBackingStore.java    | 15 +++++-----
 .../connect/storage/KafkaConfigBackingStore.java   | 15 +++++-----
 .../connect/storage/KafkaOffsetBackingStore.java   |  9 +++---
 .../connect/storage/KafkaStatusBackingStore.java   | 14 ++++-----
 .../connect/storage/MemoryConfigBackingStore.java  | 14 ++++-----
 .../connect/storage/MemoryOffsetBackingStore.java  | 15 +++++-----
 .../connect/storage/MemoryStatusBackingStore.java  | 14 ++++-----
 .../kafka/connect/storage/OffsetBackingStore.java  | 15 +++++-----
 .../connect/storage/OffsetStorageReaderImpl.java   | 15 +++++-----
 .../kafka/connect/storage/OffsetStorageWriter.java | 15 +++++-----
 .../apache/kafka/connect/storage/OffsetUtils.java  |  9 +++---
 .../kafka/connect/storage/StatusBackingStore.java  | 14 ++++-----
 .../apache/kafka/connect/tools/MockConnector.java  | 14 ++++-----
 .../kafka/connect/tools/MockSinkConnector.java     | 14 ++++-----
 .../apache/kafka/connect/tools/MockSinkTask.java   | 14 ++++-----
 .../kafka/connect/tools/MockSourceConnector.java   | 14 ++++-----
 .../apache/kafka/connect/tools/MockSourceTask.java | 14 ++++-----
 .../kafka/connect/tools/SchemaSourceConnector.java |  9 +++---
 .../kafka/connect/tools/SchemaSourceTask.java      |  9 +++---
 .../kafka/connect/tools/TransformationDoc.java     | 15 +++++-----
 .../connect/tools/VerifiableSinkConnector.java     |  9 +++---
 .../kafka/connect/tools/VerifiableSinkTask.java    |  9 +++---
 .../connect/tools/VerifiableSourceConnector.java   |  9 +++---
 .../kafka/connect/tools/VerifiableSourceTask.java  |  9 +++---
 .../org/apache/kafka/connect/util/Callback.java    | 15 +++++-----
 .../apache/kafka/connect/util/ConnectUtils.java    | 14 ++++-----
 .../apache/kafka/connect/util/ConnectorTaskId.java | 15 +++++-----
 .../connect/util/ConvertingFutureCallback.java     |  9 +++---
 .../apache/kafka/connect/util/FutureCallback.java  | 15 +++++-----
 .../apache/kafka/connect/util/KafkaBasedLog.java   |  9 +++---
 .../apache/kafka/connect/util/ReflectionsUtil.java | 30 +++++++++++---------
 .../kafka/connect/util/ShutdownableThread.java     | 15 +++++-----
 .../org/apache/kafka/connect/util/SinkUtils.java   | 14 ++++-----
 .../java/org/apache/kafka/connect/util/Table.java  | 14 ++++-----
 .../kafka/connect/runtime/AbstractHerderTest.java  | 14 ++++-----
 .../kafka/connect/runtime/ConnectorConfigTest.java | 15 +++++-----
 .../runtime/SourceTaskOffsetCommitterTest.java     | 15 +++++-----
 .../kafka/connect/runtime/WorkerConnectorTest.java | 14 ++++-----
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |  9 +++---
 .../runtime/WorkerSinkTaskThreadedTest.java        | 15 +++++-----
 .../connect/runtime/WorkerSourceTaskTest.java      | 15 +++++-----
 .../kafka/connect/runtime/WorkerTaskTest.java      | 14 ++++-----
 .../apache/kafka/connect/runtime/WorkerTest.java   | 15 +++++-----
 .../runtime/distributed/DistributedHerderTest.java |  9 +++---
 .../runtime/distributed/WorkerCoordinatorTest.java |  8 +++---
 .../kafka/connect/runtime/rest/RestServerTest.java |  9 +++---
 .../resources/ConnectorPluginsResourceTest.java    |  9 +++---
 .../rest/resources/ConnectorsResourceTest.java     |  9 +++---
 .../runtime/standalone/StandaloneHerderTest.java   | 15 +++++-----
 .../storage/FileOffsetBackingStoreTest.java        | 15 +++++-----
 .../storage/KafkaConfigBackingStoreTest.java       |  9 +++---
 .../storage/KafkaOffsetBackingStoreTest.java       |  9 +++---
 .../storage/KafkaStatusBackingStoreTest.java       | 14 ++++-----
 .../storage/MemoryStatusBackingStoreTest.java      | 14 ++++-----
 .../connect/storage/OffsetStorageWriterTest.java   | 15 +++++-----
 .../util/ByteArrayProducerRecordEquals.java        |  9 +++---
 .../kafka/connect/util/KafkaBasedLogTest.java      |  9 +++---
 .../org/apache/kafka/connect/util/MockTime.java    |  8 +++---
 .../kafka/connect/util/ShutdownableThreadTest.java | 15 +++++-----
 .../org/apache/kafka/connect/util/TableTest.java   | 14 ++++-----
 .../util/TestBackgroundThreadExceptionHandler.java | 15 +++++-----
 .../org/apache/kafka/connect/util/TestFuture.java  |  9 +++---
 .../apache/kafka/connect/util/ThreadedTest.java    | 15 +++++-----
 .../kafka/connect/transforms/ExtractField.java     | 15 +++++-----
 .../kafka/connect/transforms/HoistField.java       | 15 +++++-----
 .../kafka/connect/transforms/InsertField.java      | 15 +++++-----
 .../apache/kafka/connect/transforms/MaskField.java | 15 +++++-----
 .../kafka/connect/transforms/RegexRouter.java      | 15 +++++-----
 .../kafka/connect/transforms/ReplaceField.java     | 15 +++++-----
 .../connect/transforms/SetSchemaMetadata.java      | 15 +++++-----
 .../kafka/connect/transforms/TimestampRouter.java  | 15 +++++-----
 .../kafka/connect/transforms/ValueToKey.java       | 15 +++++-----
 .../transforms/util/NonEmptyListValidator.java     | 15 +++++-----
 .../connect/transforms/util/RegexValidator.java    | 15 +++++-----
 .../connect/transforms/util/Requirements.java      | 15 +++++-----
 .../kafka/connect/transforms/util/SchemaUtil.java  | 15 +++++-----
 .../connect/transforms/util/SimpleConfig.java      | 15 +++++-----
 .../kafka/connect/transforms/ExtractFieldTest.java | 15 +++++-----
 .../kafka/connect/transforms/HoistFieldTest.java   | 15 +++++-----
 .../kafka/connect/transforms/InsertFieldTest.java  | 15 +++++-----
 .../kafka/connect/transforms/MaskFieldTest.java    | 15 +++++-----
 .../kafka/connect/transforms/RegexRouterTest.java  | 15 +++++-----
 .../kafka/connect/transforms/ReplaceFieldTest.java | 15 +++++-----
 .../connect/transforms/SetSchemaMetadataTest.java  | 15 +++++-----
 .../connect/transforms/TimestampRouterTest.java    | 15 +++++-----
 .../kafka/connect/transforms/ValueToKeyTest.java   | 15 +++++-----
 .../scala/kafka/consumer/ConsumerConnector.scala   |  9 +++---
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  9 +++---
 .../consumer/ConsumerRebalanceListener.java        |  7 ++---
 core/src/main/scala/kafka/metrics/KafkaTimer.scala |  7 ++---
 .../main/scala/kafka/server/LeaderElector.scala    |  6 ++--
 .../main/scala/kafka/tools/StreamsResetter.java    | 12 ++++----
 .../src/main/java/kafka/examples/Consumer.java     |  6 ++--
 .../kafka/examples/KafkaConsumerProducerDemo.java  |  6 ++--
 .../main/java/kafka/examples/KafkaProperties.java  | 12 ++++----
 .../src/main/java/kafka/examples/Producer.java     |  6 ++--
 .../java/kafka/examples/SimpleConsumerDemo.java    |  6 ++--
 .../kafka/log4jappender/KafkaLog4jAppender.java    |  7 ++---
 .../log4jappender/KafkaLog4jAppenderTest.java      |  6 ++--
 .../log4jappender/MockKafkaLog4jAppender.java      |  6 ++--
 .../examples/pageview/JsonPOJODeserializer.java    | 14 ++++-----
 .../examples/pageview/JsonPOJOSerializer.java      | 14 ++++-----
 .../examples/pageview/JsonTimestampExtractor.java  |  7 ++---
 .../examples/pageview/PageViewTypedDemo.java       |  7 ++---
 .../examples/pageview/PageViewUntypedDemo.java     |  7 ++---
 .../kafka/streams/examples/pipe/PipeDemo.java      |  7 ++---
 .../streams/examples/wordcount/WordCountDemo.java  |  7 ++---
 .../examples/wordcount/WordCountProcessorDemo.java |  7 ++---
 .../apache/kafka/streams/KafkaClientSupplier.java  | 13 ++++-----
 .../org/apache/kafka/streams/KafkaStreams.java     | 13 ++++-----
 .../java/org/apache/kafka/streams/KeyValue.java    |  7 ++---
 .../org/apache/kafka/streams/StreamsConfig.java    | 13 ++++-----
 .../org/apache/kafka/streams/StreamsMetrics.java   |  7 ++---
 .../streams/errors/InvalidStateStoreException.java | 24 ++++++++--------
 .../apache/kafka/streams/errors/LockException.java | 24 ++++++++--------
 .../streams/errors/ProcessorStateException.java    |  7 ++---
 .../kafka/streams/errors/StreamsException.java     |  9 +++---
 .../streams/errors/TaskAssignmentException.java    |  6 ++--
 .../streams/errors/TaskIdFormatException.java      |  7 ++---
 .../streams/errors/TopologyBuilderException.java   |  7 ++---
 .../apache/kafka/streams/kstream/Aggregator.java   | 13 ++++-----
 .../kafka/streams/kstream/ForeachAction.java       | 12 ++++----
 .../apache/kafka/streams/kstream/GlobalKTable.java | 13 ++++-----
 .../apache/kafka/streams/kstream/Initializer.java  |  7 ++---
 .../apache/kafka/streams/kstream/JoinWindows.java  | 13 ++++-----
 .../kafka/streams/kstream/KGroupedStream.java      | 28 +++++++++---------
 .../kafka/streams/kstream/KGroupedTable.java       |  7 ++---
 .../org/apache/kafka/streams/kstream/KStream.java  | 12 ++++----
 .../kafka/streams/kstream/KStreamBuilder.java      |  7 ++---
 .../org/apache/kafka/streams/kstream/KTable.java   |  7 ++---
 .../kafka/streams/kstream/KeyValueMapper.java      | 12 ++++----
 .../org/apache/kafka/streams/kstream/Merger.java   |  7 ++---
 .../apache/kafka/streams/kstream/Predicate.java    |  6 ++--
 .../org/apache/kafka/streams/kstream/Reducer.java  | 13 ++++-----
 .../kafka/streams/kstream/SessionWindows.java      | 12 ++++----
 .../apache/kafka/streams/kstream/TimeWindows.java  | 13 ++++-----
 .../apache/kafka/streams/kstream/Transformer.java  |  7 ++---
 .../kafka/streams/kstream/TransformerSupplier.java |  7 ++---
 .../kafka/streams/kstream/UnlimitedWindows.java    | 13 ++++-----
 .../apache/kafka/streams/kstream/ValueJoiner.java  |  6 ++--
 .../apache/kafka/streams/kstream/ValueMapper.java  |  6 ++--
 .../kafka/streams/kstream/ValueTransformer.java    |  7 ++---
 .../streams/kstream/ValueTransformerSupplier.java  |  6 ++--
 .../org/apache/kafka/streams/kstream/Window.java   | 12 ++++----
 .../org/apache/kafka/streams/kstream/Windowed.java |  7 ++---
 .../org/apache/kafka/streams/kstream/Windows.java  | 12 ++++----
 ...bstractKTableKTableJoinValueGetterSupplier.java | 12 ++++----
 .../streams/kstream/internals/AbstractStream.java  |  7 ++---
 .../kstream/internals/CacheFlushListener.java      | 12 ++++----
 .../kafka/streams/kstream/internals/Change.java    |  7 ++---
 .../kstream/internals/ChangedDeserializer.java     |  7 ++---
 .../kstream/internals/ChangedSerializer.java       |  7 ++---
 .../internals/ForwardingCacheFlushListener.java    | 12 ++++----
 .../kstream/internals/GlobalKTableImpl.java        | 12 ++++----
 .../kstream/internals/KGroupedStreamImpl.java      | 28 +++++++++---------
 .../kstream/internals/KGroupedTableImpl.java       |  7 ++---
 .../internals/KStreamAggProcessorSupplier.java     |  7 ++---
 .../kstream/internals/KStreamAggregate.java        |  7 ++---
 .../streams/kstream/internals/KStreamBranch.java   |  7 ++---
 .../streams/kstream/internals/KStreamFilter.java   |  7 ++---
 .../streams/kstream/internals/KStreamFlatMap.java  |  7 ++---
 .../kstream/internals/KStreamFlatMapValues.java    |  7 ++---
 .../streams/kstream/internals/KStreamForeach.java  |  7 ++---
 .../kstream/internals/KStreamGlobalKTableJoin.java | 13 ++++-----
 .../streams/kstream/internals/KStreamImpl.java     | 13 ++++-----
 .../kstream/internals/KStreamJoinWindow.java       |  7 ++---
 .../kstream/internals/KStreamKStreamJoin.java      | 13 ++++-----
 .../kstream/internals/KStreamKTableJoin.java       | 13 ++++-----
 .../internals/KStreamKTableJoinProcessor.java      | 12 ++++----
 .../streams/kstream/internals/KStreamMap.java      |  7 ++---
 .../kstream/internals/KStreamMapValues.java        |  7 ++---
 .../kstream/internals/KStreamPassThrough.java      |  7 ++---
 .../streams/kstream/internals/KStreamPeek.java     |  7 ++---
 .../streams/kstream/internals/KStreamReduce.java   |  7 ++---
 .../internals/KStreamSessionWindowAggregate.java   | 13 ++++-----
 .../kstream/internals/KStreamTransform.java        |  7 ++---
 .../kstream/internals/KStreamTransformValues.java  |  7 ++---
 .../kstream/internals/KStreamWindowAggregate.java  |  7 ++---
 .../kstream/internals/KStreamWindowReduce.java     |  7 ++---
 .../streams/kstream/internals/KTableAggregate.java |  7 ++---
 .../streams/kstream/internals/KTableFilter.java    |  7 ++---
 .../streams/kstream/internals/KTableImpl.java      | 13 ++++-----
 .../internals/KTableKTableAbstractJoin.java        |  7 ++---
 .../kstream/internals/KTableKTableJoin.java        | 13 ++++-----
 .../kstream/internals/KTableKTableJoinMerger.java  |  7 ++---
 .../internals/KTableKTableJoinValueGetter.java     | 12 ++++----
 .../kstream/internals/KTableKTableLeftJoin.java    | 13 ++++-----
 .../internals/KTableKTableLeftJoinValueGetter.java | 12 ++++----
 .../kstream/internals/KTableKTableOuterJoin.java   | 13 ++++-----
 .../kstream/internals/KTableKTableRightJoin.java   | 13 ++++-----
 .../streams/kstream/internals/KTableMapValues.java |  7 ++---
 .../kstream/internals/KTableProcessorSupplier.java |  7 ++---
 .../streams/kstream/internals/KTableReduce.java    |  7 ++---
 .../kstream/internals/KTableRepartitionMap.java    |  7 ++---
 .../streams/kstream/internals/KTableSource.java    |  7 ++---
 .../internals/KTableSourceValueGetterSupplier.java |  7 ++---
 .../kstream/internals/KTableValueGetter.java       |  7 ++---
 .../internals/KTableValueGetterSupplier.java       |  7 ++---
 .../streams/kstream/internals/KeyValuePrinter.java | 13 ++++-----
 .../streams/kstream/internals/SessionKeySerde.java | 12 ++++----
 .../streams/kstream/internals/SessionWindow.java   | 32 ++++++++++-----------
 .../streams/kstream/internals/TimeWindow.java      |  6 ++--
 .../streams/kstream/internals/TupleForwarder.java  |  7 ++---
 .../streams/kstream/internals/UnlimitedWindow.java | 12 ++++----
 .../kstream/internals/WindowedDeserializer.java    |  7 ++---
 .../kstream/internals/WindowedSerializer.java      |  7 ++---
 .../internals/WindowedStreamPartitioner.java       |  6 ++--
 .../kafka/streams/processor/AbstractProcessor.java |  4 +--
 .../streams/processor/DefaultPartitionGrouper.java |  7 ++---
 .../processor/ExtractRecordMetadataTimestamp.java  |  7 ++---
 .../streams/processor/FailOnInvalidTimestamp.java  |  7 ++---
 .../processor/LogAndSkipOnInvalidTimestamp.java    |  7 ++---
 .../kafka/streams/processor/PartitionGrouper.java  |  7 ++---
 .../apache/kafka/streams/processor/Processor.java  |  7 ++---
 .../kafka/streams/processor/ProcessorContext.java  |  7 ++---
 .../kafka/streams/processor/ProcessorSupplier.java |  7 ++---
 .../streams/processor/StateRestoreCallback.java    |  7 ++---
 .../apache/kafka/streams/processor/StateStore.java | 13 ++++-----
 .../streams/processor/StateStoreSupplier.java      | 13 ++++-----
 .../kafka/streams/processor/StreamPartitioner.java |  6 ++--
 .../org/apache/kafka/streams/processor/TaskId.java |  7 ++---
 .../streams/processor/TimestampExtractor.java      |  7 ++---
 .../kafka/streams/processor/TopologyBuilder.java   | 13 ++++-----
 .../UsePreviousTimeOnInvalidTimestamp.java         |  7 ++---
 .../processor/WallclockTimestampExtractor.java     |  7 ++---
 .../internals/AbstractProcessorContext.java        | 12 ++++----
 .../streams/processor/internals/AbstractTask.java  |  7 ++---
 .../processor/internals/ChangelogReader.java       | 12 ++++----
 .../processor/internals/Checkpointable.java        | 12 ++++----
 .../internals/DefaultKafkaClientSupplier.java      | 13 ++++-----
 .../internals/DefaultStreamPartitioner.java        | 12 ++++----
 .../internals/GlobalProcessorContextImpl.java      |  7 ++---
 .../processor/internals/GlobalStateMaintainer.java | 12 ++++----
 .../processor/internals/GlobalStateManager.java    | 12 ++++----
 .../internals/GlobalStateManagerImpl.java          | 12 ++++----
 .../processor/internals/GlobalStateUpdateTask.java | 12 ++++----
 .../processor/internals/GlobalStreamThread.java    | 12 ++++----
 .../internals/InternalProcessorContext.java        | 12 ++++----
 .../processor/internals/InternalTopicConfig.java   | 12 ++++----
 .../processor/internals/InternalTopicManager.java  |  7 ++---
 .../processor/internals/MinTimestampTracker.java   |  7 ++---
 .../processor/internals/PartitionGroup.java        | 13 ++++-----
 .../processor/internals/ProcessorContextImpl.java  |  7 ++---
 .../streams/processor/internals/ProcessorNode.java | 13 ++++-----
 .../internals/ProcessorRecordContext.java          | 12 ++++----
 .../processor/internals/ProcessorStateManager.java | 13 ++++-----
 .../processor/internals/ProcessorTopology.java     |  7 ++---
 .../processor/internals/PunctuationQueue.java      |  7 ++---
 .../processor/internals/PunctuationSchedule.java   |  7 ++---
 .../streams/processor/internals/Punctuator.java    |  7 ++---
 .../streams/processor/internals/QuickUnion.java    |  7 ++---
 .../processor/internals/RecordCollector.java       | 12 ++++----
 .../processor/internals/RecordCollectorImpl.java   |  7 ++---
 .../streams/processor/internals/RecordContext.java | 12 ++++----
 .../processor/internals/RecordDeserializer.java    | 12 ++++----
 .../streams/processor/internals/RecordQueue.java   |  7 ++---
 .../streams/processor/internals/SinkNode.java      |  7 ++---
 .../streams/processor/internals/SourceNode.java    |  7 ++---
 .../internals/SourceNodeRecordDeserializer.java    | 12 ++++----
 .../kafka/streams/processor/internals/Stamped.java |  7 ++---
 .../streams/processor/internals/StampedRecord.java |  7 ++---
 .../processor/internals/StandbyContextImpl.java    |  7 ++---
 .../streams/processor/internals/StandbyTask.java   | 13 ++++-----
 .../processor/internals/StateDirectory.java        | 12 ++++----
 .../streams/processor/internals/StateManager.java  | 12 ++++----
 .../streams/processor/internals/StateRestorer.java | 12 ++++----
 .../processor/internals/StoreChangelogReader.java  | 12 ++++----
 .../internals/StreamPartitionAssignor.java         |  7 ++---
 .../streams/processor/internals/StreamTask.java    | 13 ++++-----
 .../streams/processor/internals/StreamThread.java  | 13 ++++-----
 .../processor/internals/StreamsKafkaClient.java    | 23 ++++++++-------
 .../processor/internals/StreamsMetadataState.java  | 12 ++++----
 .../processor/internals/StreamsMetricsImpl.java    | 13 ++++-----
 .../processor/internals/TimestampTracker.java      |  7 ++---
 .../internals/assignment/AssignmentInfo.java       | 13 ++++-----
 .../internals/assignment/ClientState.java          |  7 ++---
 .../internals/assignment/StickyTaskAssignor.java   | 12 ++++----
 .../internals/assignment/SubscriptionInfo.java     | 13 ++++-----
 .../internals/assignment/TaskAssignor.java         | 12 ++++----
 .../org/apache/kafka/streams/state/HostInfo.java   | 12 ++++----
 .../kafka/streams/state/KeyValueIterator.java      | 33 ++++++++++------------
 .../apache/kafka/streams/state/KeyValueStore.java  | 33 ++++++++++------------
 .../kafka/streams/state/QueryableStoreType.java    | 24 ++++++++--------
 .../kafka/streams/state/QueryableStoreTypes.java   | 24 ++++++++--------
 .../kafka/streams/state/ReadOnlyKeyValueStore.java | 24 ++++++++--------
 .../kafka/streams/state/ReadOnlySessionStore.java  | 12 ++++----
 .../kafka/streams/state/ReadOnlyWindowStore.java   | 24 ++++++++--------
 .../kafka/streams/state/RocksDBConfigSetter.java   | 12 ++++----
 .../apache/kafka/streams/state/SessionStore.java   | 12 ++++----
 .../apache/kafka/streams/state/StateSerdes.java    |  4 +--
 .../org/apache/kafka/streams/state/Stores.java     |  4 +--
 .../kafka/streams/state/StreamsMetadata.java       | 12 ++++----
 .../apache/kafka/streams/state/WindowStore.java    | 33 ++++++++++------------
 .../kafka/streams/state/WindowStoreIterator.java   | 33 ++++++++++------------
 .../AbstractMergedSortedCacheStoreIterator.java    | 33 ++++++++++------------
 .../state/internals/AbstractStoreSupplier.java     | 12 ++++----
 .../streams/state/internals/CachedStateStore.java  | 12 ++++----
 .../state/internals/CachingKeyValueStore.java      | 12 ++++----
 .../state/internals/CachingSessionStore.java       | 12 ++++----
 .../state/internals/CachingWindowStore.java        | 12 ++++----
 .../internals/ChangeLoggingKeyValueBytesStore.java | 12 ++++----
 .../internals/ChangeLoggingKeyValueStore.java      | 12 ++++----
 .../ChangeLoggingSegmentedBytesStore.java          | 12 ++++----
 .../internals/CompositeReadOnlyKeyValueStore.java  | 28 +++++++++---------
 .../internals/CompositeReadOnlySessionStore.java   | 12 ++++----
 .../internals/CompositeReadOnlyWindowStore.java    | 24 ++++++++--------
 .../DelegatingPeekingKeyValueIterator.java         | 12 ++++----
 .../state/internals/GlobalStateStoreProvider.java  | 12 ++++----
 .../streams/state/internals/HasNextCondition.java  | 12 ++++----
 .../internals/InMemoryKeyValueLoggedStore.java     |  7 ++---
 .../state/internals/InMemoryKeyValueStore.java     | 24 ++++++++--------
 .../internals/InMemoryKeyValueStoreSupplier.java   |  7 ++---
 .../internals/InMemoryLRUCacheStoreSupplier.java   |  7 ++---
 .../streams/state/internals/LRUCacheEntry.java     |  8 +++---
 .../streams/state/internals/MemoryLRUCache.java    |  4 +--
 .../state/internals/MemoryNavigableLRUCache.java   |  4 +--
 .../MergedSortedCacheKeyValueStoreIterator.java    | 12 ++++----
 .../MergedSortedCacheSessionStoreIterator.java     | 32 ++++++++++-----------
 .../MergedSortedCacheWindowStoreIterator.java      | 12 ++++----
 .../state/internals/MeteredKeyValueStore.java      |  7 ++---
 .../internals/MeteredSegmentedBytesStore.java      |  7 ++---
 .../kafka/streams/state/internals/NamedCache.java  | 12 ++++----
 .../streams/state/internals/OffsetCheckpoint.java  | 13 ++++-----
 .../state/internals/PeekingKeyValueIterator.java   | 12 ++++----
 .../state/internals/QueryableStoreProvider.java    | 28 +++++++++---------
 .../internals/RocksDBKeyValueStoreSupplier.java    |  7 ++---
 .../internals/RocksDBSegmentedBytesStore.java      | 12 ++++----
 .../state/internals/RocksDBSessionStore.java       | 12 ++++----
 .../internals/RocksDBSessionStoreSupplier.java     | 13 ++++-----
 .../streams/state/internals/RocksDBStore.java      |  7 ++---
 .../state/internals/RocksDBWindowStore.java        | 33 ++++++++++------------
 .../internals/RocksDBWindowStoreSupplier.java      |  7 ++---
 .../kafka/streams/state/internals/Segment.java     | 12 ++++----
 .../streams/state/internals/SegmentIterator.java   | 12 ++++----
 .../state/internals/SegmentedBytesStore.java       | 12 ++++----
 .../kafka/streams/state/internals/Segments.java    | 12 ++++----
 .../internals/SerializedKeyValueIterator.java      | 12 ++++----
 .../streams/state/internals/SessionKeySchema.java  | 12 ++++----
 .../state/internals/StateStoreProvider.java        | 24 ++++++++--------
 .../streams/state/internals/StoreChangeLogger.java |  7 ++---
 .../internals/StreamThreadStateStoreProvider.java  | 24 ++++++++--------
 .../kafka/streams/state/internals/ThreadCache.java |  8 +++---
 .../streams/state/internals/WindowKeySchema.java   | 12 ++++----
 .../state/internals/WindowStoreSupplier.java       | 12 ++++----
 .../streams/state/internals/WindowStoreUtils.java  | 33 ++++++++++------------
 .../internals/WrappedSessionStoreIterator.java     | 32 ++++++++++-----------
 .../streams/state/internals/WrappedStateStore.java | 32 ++++++++++-----------
 .../internals/WrappedWindowStoreIterator.java      | 32 ++++++++++-----------
 .../state/internals/WrappingStoreProvider.java     | 24 ++++++++--------
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 13 ++++-----
 .../org/apache/kafka/streams/KeyValueTest.java     | 13 ++++-----
 .../apache/kafka/streams/StreamsConfigTest.java    | 13 ++++-----
 .../streams/integration/FanoutIntegrationTest.java | 13 ++++-----
 .../integration/GlobalKTableIntegrationTest.java   | 28 +++++++++---------
 .../integration/InternalTopicIntegrationTest.java  | 12 ++++----
 .../streams/integration/JoinIntegrationTest.java   | 12 ++++----
 .../KStreamAggregationDedupIntegrationTest.java    | 24 ++++++++++------
 .../KStreamAggregationIntegrationTest.java         | 28 +++++++++---------
 .../KStreamKTableJoinIntegrationTest.java          | 28 +++++++++---------
 .../integration/KStreamRepartitionJoinTest.java    | 28 +++++++++---------
 ...StreamsFineGrainedAutoResetIntegrationTest.java | 30 ++++++++++----------
 .../KTableKTableJoinIntegrationTest.java           | 28 +++++++++---------
 .../integration/QueryableStateIntegrationTest.java | 28 +++++++++---------
 .../integration/RegexSourceIntegrationTest.java    | 30 ++++++++++----------
 .../streams/integration/ResetIntegrationTest.java  | 13 ++++-----
 .../integration/utils/EmbeddedKafkaCluster.java    | 13 ++++-----
 .../integration/utils/IntegrationTestUtils.java    | 13 ++++-----
 .../streams/integration/utils/KafkaEmbedded.java   | 13 ++++-----
 .../kafka/streams/kstream/JoinWindowsTest.java     | 33 ++++++++++------------
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  7 ++---
 .../kafka/streams/kstream/SessionWindowsTest.java  | 33 ++++++++++------------
 .../kafka/streams/kstream/TimeWindowsTest.java     | 33 ++++++++++------------
 .../streams/kstream/UnlimitedWindowsTest.java      | 33 ++++++++++------------
 .../apache/kafka/streams/kstream/WindowTest.java   | 32 ++++++++++-----------
 .../apache/kafka/streams/kstream/WindowsTest.java  | 12 ++++----
 .../kstream/internals/GlobalKTableJoinsTest.java   | 12 ++++----
 .../kstream/internals/KGroupedStreamImplTest.java  | 13 ++++-----
 .../kstream/internals/KGroupedTableImplTest.java   |  7 ++---
 .../kstream/internals/KStreamBranchTest.java       |  7 ++---
 .../kstream/internals/KStreamFilterTest.java       |  7 ++---
 .../kstream/internals/KStreamFlatMapTest.java      |  7 ++---
 .../internals/KStreamFlatMapValuesTest.java        |  7 ++---
 .../kstream/internals/KStreamForeachTest.java      |  7 ++---
 .../streams/kstream/internals/KStreamImplTest.java |  7 ++---
 .../kstream/internals/KStreamKStreamJoinTest.java  |  7 ++---
 .../internals/KStreamKStreamLeftJoinTest.java      | 13 ++++-----
 .../kstream/internals/KStreamKTableJoinTest.java   | 13 ++++-----
 .../internals/KStreamKTableLeftJoinTest.java       |  7 ++---
 .../streams/kstream/internals/KStreamMapTest.java  |  7 ++---
 .../kstream/internals/KStreamMapValuesTest.java    |  7 ++---
 .../streams/kstream/internals/KStreamPeekTest.java | 19 ++++++-------
 .../kstream/internals/KStreamSelectKeyTest.java    |  9 ++----
 ...KStreamSessionWindowAggregateProcessorTest.java | 13 ++++-----
 .../kstream/internals/KStreamTransformTest.java    |  7 ++---
 .../internals/KStreamTransformValuesTest.java      |  7 ++---
 .../internals/KStreamWindowAggregateTest.java      | 13 ++++-----
 .../kstream/internals/KTableAggregateTest.java     |  7 ++---
 .../kstream/internals/KTableFilterTest.java        |  7 ++---
 .../kstream/internals/KTableForeachTest.java       |  7 ++---
 .../streams/kstream/internals/KTableImplTest.java  |  7 ++---
 .../kstream/internals/KTableKTableJoinTest.java    | 13 ++++-----
 .../internals/KTableKTableLeftJoinTest.java        | 13 ++++-----
 .../internals/KTableKTableOuterJoinTest.java       | 13 ++++-----
 .../kstream/internals/KTableMapKeysTest.java       |  7 ++---
 .../kstream/internals/KTableMapValuesTest.java     |  7 ++---
 .../kstream/internals/KTableSourceTest.java        |  7 ++---
 .../internals/KeyValuePrinterProcessorTest.java    | 13 ++++-----
 .../kstream/internals/SessionKeySerdeTest.java     | 13 ++++-----
 .../kstream/internals/SessionWindowTest.java       | 32 ++++++++++-----------
 .../streams/kstream/internals/TimeWindowTest.java  | 32 ++++++++++-----------
 .../kstream/internals/UnlimitedWindowTest.java     | 32 ++++++++++-----------
 .../internals/WindowedStreamPartitionerTest.java   |  7 ++---
 .../apache/kafka/streams/perf/SimpleBenchmark.java |  7 ++---
 .../processor/DefaultPartitionGrouperTest.java     |  7 ++---
 .../processor/FailOnInvalidTimestampTest.java      | 12 ++++----
 .../LogAndSkipOnInvalidTimestampTest.java          | 12 ++++----
 .../streams/processor/TimestampExtractorTest.java  | 12 ++++----
 .../streams/processor/TopologyBuilderTest.java     |  7 ++---
 .../UsePreviousTimeOnInvalidTimestampTest.java     | 12 ++++----
 .../processor/WallclockTimestampExtractorTest.java | 12 ++++----
 .../internals/AbstractProcessorContextTest.java    | 13 ++++-----
 .../processor/internals/AbstractTaskTest.java      | 13 ++++-----
 .../CopartitionedTopicsValidatorTest.java          | 13 ++++-----
 .../internals/GlobalStateManagerImplTest.java      | 13 ++++-----
 .../processor/internals/GlobalStateTaskTest.java   | 13 ++++-----
 .../internals/GlobalStreamThreadTest.java          | 13 ++++-----
 .../internals/InternalTopicConfigTest.java         | 13 ++++-----
 .../internals/InternalTopicManagerTest.java        | 13 ++++-----
 .../internals/MinTimestampTrackerTest.java         |  7 ++---
 .../processor/internals/MockStreamsMetrics.java    | 12 ++++----
 .../processor/internals/PartitionGroupTest.java    | 13 ++++-----
 .../processor/internals/ProcessorNodeTest.java     | 13 ++++-----
 .../internals/ProcessorStateManagerTest.java       |  7 ++---
 .../processor/internals/ProcessorTopologyTest.java |  7 ++---
 .../processor/internals/PunctuationQueueTest.java  |  7 ++---
 .../processor/internals/QuickUnionTest.java        |  7 ++---
 .../processor/internals/RecordCollectorTest.java   | 16 ++++-------
 .../processor/internals/RecordContextStub.java     | 12 ++++----
 .../processor/internals/RecordQueueTest.java       | 13 ++++-----
 .../internals/SingleGroupPartitionGrouperStub.java | 13 ++++-----
 .../streams/processor/internals/SinkNodeTest.java  | 13 ++++-----
 .../SourceNodeRecordDeserializerTest.java          | 13 ++++-----
 .../processor/internals/StandbyTaskTest.java       |  7 ++---
 .../processor/internals/StateConsumerTest.java     | 13 ++++-----
 .../processor/internals/StateDirectoryTest.java    | 13 ++++-----
 .../processor/internals/StateManagerStub.java      | 12 ++++----
 .../processor/internals/StateRestorerTest.java     | 13 ++++-----
 .../internals/StoreChangelogReaderTest.java        | 13 ++++-----
 .../internals/StreamPartitionAssignorTest.java     |  7 ++---
 .../processor/internals/StreamTaskTest.java        |  7 ++---
 .../processor/internals/StreamThreadTest.java      | 13 ++++-----
 .../internals/StreamsKafkaClientTest.java          | 29 ++++++++++---------
 .../internals/StreamsMetadataStateTest.java        | 12 ++++----
 .../internals/StreamsMetricsImplTest.java          | 12 ++++----
 .../internals/assignment/AssignmentInfoTest.java   |  7 ++---
 .../internals/assignment/ClientStateTest.java      | 13 ++++-----
 .../assignment/StickyTaskAssignorTest.java         | 12 ++++----
 .../internals/assignment/SubscriptionInfoTest.java |  7 ++---
 .../streams/state/KeyValueStoreTestDriver.java     | 12 ++++----
 .../kafka/streams/state/NoOpWindowStore.java       | 12 ++++----
 .../org/apache/kafka/streams/state/StoresTest.java | 13 ++++-----
 .../state/internals/AbstractKeyValueStoreTest.java |  7 ++---
 .../state/internals/CachingKeyValueStoreTest.java  | 13 ++++-----
 .../state/internals/CachingSessionStoreTest.java   | 13 ++++-----
 .../state/internals/CachingWindowStoreTest.java    | 13 ++++-----
 .../ChangeLoggingKeyValueBytesStoreTest.java       | 12 ++++----
 .../internals/ChangeLoggingKeyValueStoreTest.java  | 12 ++++----
 .../ChangeLoggingSegmentedBytesStoreTest.java      | 13 ++++-----
 .../CompositeReadOnlyKeyValueStoreTest.java        | 24 ++++++++--------
 .../CompositeReadOnlySessionStoreTest.java         | 13 ++++-----
 .../CompositeReadOnlyWindowStoreTest.java          | 24 ++++++++--------
 .../DelegatingPeekingKeyValueIteratorTest.java     | 13 ++++-----
 .../internals/GlobalStateStoreProviderTest.java    | 13 ++++-----
 .../state/internals/InMemoryKeyValueStoreTest.java |  6 ++--
 .../state/internals/InMemoryLRUCacheStoreTest.java |  4 +--
 ...MergedSortedCacheKeyValueStoreIteratorTest.java | 13 ++++-----
 ...SortedCacheWrappedSessionStoreIteratorTest.java | 13 ++++-----
 ...dSortedCacheWrappedWindowStoreIteratorTest.java | 13 ++++-----
 .../internals/MeteredSegmentedBytesStoreTest.java  | 13 ++++-----
 .../streams/state/internals/NamedCacheTest.java    | 13 ++++-----
 .../state/internals/OffsetCheckpointTest.java      | 13 ++++-----
 .../internals/QueryableStoreProviderTest.java      | 24 ++++++++--------
 .../state/internals/ReadOnlyWindowStoreStub.java   | 24 ++++++++--------
 .../RocksDBKeyValueStoreSupplierTest.java          | 13 ++++-----
 .../state/internals/RocksDBKeyValueStoreTest.java  |  6 ++--
 .../internals/RocksDBSegmentedBytesStoreTest.java  | 13 ++++-----
 .../internals/RocksDBSessionStoreSupplierTest.java | 13 ++++-----
 .../state/internals/RocksDBSessionStoreTest.java   | 13 ++++-----
 .../internals/RocksDBWindowStoreSupplierTest.java  | 13 ++++-----
 .../state/internals/RocksDBWindowStoreTest.java    |  7 ++---
 .../state/internals/SegmentIteratorTest.java       | 13 ++++-----
 .../streams/state/internals/SegmentsTest.java      | 13 ++++-----
 .../internals/SerializedKeyValueIteratorTest.java  | 13 ++++-----
 .../state/internals/StateStoreTestUtils.java       | 12 ++++----
 .../state/internals/StoreChangeLoggerTest.java     | 33 ++++++++++------------
 .../StreamThreadStateStoreProviderTest.java        | 24 ++++++++--------
 .../streams/state/internals/ThreadCacheTest.java   |  8 +++---
 .../state/internals/WindowStoreUtilsTest.java      | 32 ++++++++++-----------
 .../state/internals/WrappingStoreProviderTest.java | 12 ++++----
 .../streams/tests/BrokerCompatibilityTest.java     |  6 ++--
 .../kafka/streams/tests/ShutdownDeadlockTest.java  | 12 ++++----
 .../kafka/streams/tests/SmokeTestClient.java       |  7 ++---
 .../kafka/streams/tests/SmokeTestDriver.java       |  7 ++---
 .../apache/kafka/streams/tests/SmokeTestUtil.java  |  7 ++---
 .../kafka/streams/tests/StreamsSmokeTest.java      |  7 ++---
 .../apache/kafka/test/GlobalStateManagerStub.java  | 12 ++++----
 .../org/apache/kafka/test/KStreamTestDriver.java   |  7 ++---
 .../apache/kafka/test/KTableValueGetterStub.java   | 12 ++++----
 .../apache/kafka/test/KeyValueIteratorStub.java    | 12 ++++----
 .../java/org/apache/kafka/test/MockAggregator.java |  7 ++---
 .../org/apache/kafka/test/MockChangelogReader.java | 12 ++++----
 .../org/apache/kafka/test/MockClientSupplier.java  |  7 ++---
 .../org/apache/kafka/test/MockInitializer.java     |  7 ++---
 .../kafka/test/MockInternalTopicManager.java       |  7 ++---
 .../org/apache/kafka/test/MockKeyValueMapper.java  |  7 ++---
 .../apache/kafka/test/MockProcessorContext.java    |  7 ++---
 .../org/apache/kafka/test/MockProcessorNode.java   |  7 ++---
 .../apache/kafka/test/MockProcessorSupplier.java   |  7 ++---
 .../java/org/apache/kafka/test/MockReducer.java    |  7 ++---
 .../org/apache/kafka/test/MockRestoreCallback.java | 12 ++++----
 .../org/apache/kafka/test/MockRestoreConsumer.java | 12 ++++----
 .../java/org/apache/kafka/test/MockSourceNode.java |  7 ++---
 .../apache/kafka/test/MockStateStoreSupplier.java  |  7 ++---
 .../apache/kafka/test/MockTimestampExtractor.java  |  7 ++---
 .../org/apache/kafka/test/MockValueJoiner.java     |  7 ++---
 .../apache/kafka/test/NoOpProcessorContext.java    | 12 ++++----
 .../org/apache/kafka/test/NoOpReadOnlyStore.java   | 12 ++++----
 .../org/apache/kafka/test/NoOpRecordCollector.java | 12 ++++----
 .../kafka/test/ProcessorTopologyTestDriver.java    | 12 ++++----
 .../kafka/test/ReadOnlySessionStoreStub.java       | 12 ++++----
 .../apache/kafka/test/SegmentedBytesStoreStub.java | 12 ++++----
 .../apache/kafka/test/StateStoreProviderStub.java  | 24 ++++++++--------
 .../org/apache/kafka/test/StreamsTestUtils.java    | 28 +++++++++---------
 .../kafka/tools/ClientCompatibilityTest.java       | 12 ++++----
 .../apache/kafka/tools/ProducerPerformance.java    | 22 +++++++++------
 .../apache/kafka/tools/ThroughputThrottler.java    |  7 ++---
 .../org/apache/kafka/tools/VerifiableConsumer.java |  7 ++---
 .../kafka/tools/VerifiableLog4jAppender.java       |  7 ++---
 .../org/apache/kafka/tools/VerifiableProducer.java |  7 ++---
 1100 files changed, 7765 insertions(+), 7406 deletions(-)
53a39bb2cc9ee2e0f13e5658495152d5117889a6

 tests/docker/Dockerfile                              | 20 +++++++-------------
 tests/docker/run_tests.sh                            | 14 ++------------
 .../sanity_checks/test_verifiable_producer.py        |  4 +++-
 3 files changed, 12 insertions(+), 26 deletions(-)
f3fab2e476cf5101ba6ae68e4d61ae9ab957b26c

 tests/docker/Dockerfile                              | 20 +++++++-------------
 tests/docker/run_tests.sh                            | 14 ++------------
 .../sanity_checks/test_verifiable_producer.py        |  4 +++-
 3 files changed, 12 insertions(+), 26 deletions(-)
8e6fbe8fed592e7cc15731a0827c350794413767

 .../src/main/java/org/apache/kafka/connect/json/JsonConverter.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
9231cc439e58d6ac252ca960e15c703366e32e1a

 tests/kafkatest/services/streams.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
35684acad2df18c8f39c2f72a596714263b64f64

 .../main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java   | 4 ++++
 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 2 +-
 2 files changed, 5 insertions(+), 1 deletion(-)
9260e8563c19cc1c5ac2d47ad05955774138036d

 .../main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java   | 4 ++++
 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 2 +-
 2 files changed, 5 insertions(+), 1 deletion(-)
8488b81a52e32c4efcec16c05efa6ab9ed0d3c87

 clients/src/main/java/org/apache/kafka/common/protocol/ApiKeys.java  | 2 +-
 clients/src/main/java/org/apache/kafka/common/protocol/Protocol.java | 3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)
5b682baad546e41fe7aa27be0865ea6adaca2d2a

 clients/src/main/java/org/apache/kafka/common/protocol/ApiKeys.java  | 2 +-
 clients/src/main/java/org/apache/kafka/common/protocol/Protocol.java | 3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)
5b22b53f0e581e3239ca6bbeceec6c01ce0f8ce0

 .../clients/producer/internals/BufferPool.java     | 24 ++++++++++++-----
 .../authenticator/SaslClientAuthenticator.java     |  2 +-
 .../clients/producer/internals/BufferPoolTest.java | 30 ++++++++++++++++++++++
 3 files changed, 48 insertions(+), 8 deletions(-)
a9f4b671f5c429e57eff5a543c8ce8a58edea118

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
3749832637b58b291a45076658feb8cd6e830247

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
b917af19014c6a8860d6523d24c87783c51bab4e

 .../main/scala/kafka/network/RequestChannel.scala  |  8 ++---
 core/src/main/scala/kafka/utils/NotNothing.scala   | 41 ++++++++++++++++++++++
 2 files changed, 45 insertions(+), 4 deletions(-)
43524442dc10c5dc731248674eb1a811287e88f7

 .../apache/kafka/clients/consumer/internals/AbstractCoordinator.java | 2 +-
 .../apache/kafka/connect/runtime/distributed/WorkerCoordinator.java  | 5 -----
 2 files changed, 1 insertion(+), 6 deletions(-)
0483a0b0b70e1ec7cd12c17f622f91ebc3932fc4

 .../kafka/api/IntegrationTestHarness.scala         |  7 +--
 .../kafka/api/ProducerFailureHandlingTest.scala    | 15 +++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 51 +++++++++++++---------
 3 files changed, 39 insertions(+), 34 deletions(-)
151b23689ea1c2e13a1d38f403bf5839eddbe377

 .../kafka/clients/consumer/MockConsumer.java       |  21 +-
 .../streams/processor/internals/AbstractTask.java  |   4 +-
 .../processor/internals/ChangelogReader.java       |  52 +++
 .../internals/GlobalStateManagerImpl.java          |   1 -
 .../processor/internals/ProcessorStateManager.java | 112 +----
 .../streams/processor/internals/StandbyTask.java   |   5 +-
 .../streams/processor/internals/StateRestorer.java |  78 ++++
 .../processor/internals/StoreChangelogReader.java  | 199 +++++++++
 .../streams/processor/internals/StreamTask.java    |   4 +-
 .../streams/processor/internals/StreamThread.java  | 129 +++---
 .../integration/QueryableStateIntegrationTest.java |   2 +-
 .../processor/internals/AbstractTaskTest.java      |   3 +-
 .../internals/ProcessorStateManagerTest.java       | 473 ++-------------------
 .../processor/internals/StandbyTaskTest.java       |  19 +-
 .../processor/internals/StateRestorerTest.java     |  70 +++
 .../internals/StoreChangelogReaderTest.java        | 258 +++++++++++
 .../processor/internals/StreamTaskTest.java        |  12 +-
 .../processor/internals/StreamThreadTest.java      |   4 +-
 .../StreamThreadStateStoreProviderTest.java        |   3 +-
 .../org/apache/kafka/test/MockChangelogReader.java |  54 +++
 .../org/apache/kafka/test/MockRestoreCallback.java |  28 ++
 .../org/apache/kafka/test/MockRestoreConsumer.java | 155 +++++++
 .../kafka/test/ProcessorTopologyTestDriver.java    |   3 +-
 23 files changed, 1067 insertions(+), 622 deletions(-)
ac05c343a190d2e7649e42485c62a80e5dede382

 tests/kafkatest/services/kafka/kafka.py                     | 7 ++++++-
 tests/kafkatest/services/security/security_config.py        | 4 ++++
 tests/kafkatest/tests/core/security_rolling_upgrade_test.py | 8 ++++----
 3 files changed, 14 insertions(+), 5 deletions(-)
2a7b18a2ac1213b189df8585671b713373dae383

 tests/kafkatest/services/kafka/kafka.py                     | 7 ++++++-
 tests/kafkatest/services/security/security_config.py        | 4 ++++
 tests/kafkatest/tests/core/security_rolling_upgrade_test.py | 8 ++++----
 3 files changed, 14 insertions(+), 5 deletions(-)
0be3a7226f816bd4b612477ea3b9916bddade290

 .../src/main/java/org/apache/kafka/clients/producer/KafkaProducer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
01898ebbadec6d9df72bd9a89752d7f5bd128a7d

 .../apache/kafka/common/config/AbstractConfig.java |   4 +-
 .../org/apache/kafka/common/config/Config.java     |   2 +-
 .../org/apache/kafka/common/config/ConfigDef.java  | 101 +++++++++++----------
 .../apache/kafka/common/config/ConfigValue.java    |   4 +-
 4 files changed, 56 insertions(+), 55 deletions(-)
11b637ec7d2b8dbd2ac57ca2f2b360b2a0707ab9

 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java     | 2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala                | 8 +++++---
 .../src/test/scala/integration/kafka/api/ConsumerBounceTest.scala | 4 ++--
 .../scala/unit/kafka/integration/KafkaServerTestHarness.scala     | 6 +++---
 4 files changed, 11 insertions(+), 9 deletions(-)
1ed4b48d5a43af743229fafc22f78846c9c3134d

 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java     | 2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala                | 8 +++++---
 .../src/test/scala/integration/kafka/api/ConsumerBounceTest.scala | 4 ++--
 .../scala/unit/kafka/integration/KafkaServerTestHarness.scala     | 6 +++---
 4 files changed, 11 insertions(+), 9 deletions(-)
e0447192854435b5b5aa84027b5f95a26fb9a2b5

 docs/upgrade.html | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
6a55d41fe326d72052ca8214809c2e346f8ae775

 docs/upgrade.html | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
3428bc1a2549778378ffeb781ad62ca719ca3b7f

 .../apache/kafka/streams/processor/internals/StreamThread.java    | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
9c6fa257d8e3558a9d849619c8f09079e7dc1c98

 core/src/main/scala/kafka/log/LogConfig.scala          | 11 -----------
 core/src/test/scala/unit/kafka/log/LogConfigTest.scala | 10 ----------
 2 files changed, 21 deletions(-)
5a2abc51821fab4d3834b615e577d97e0f0e6494

 core/src/main/scala/kafka/log/LogConfig.scala          | 11 -----------
 core/src/test/scala/unit/kafka/log/LogConfigTest.scala | 10 ----------
 2 files changed, 21 deletions(-)
015f1d73811e52b3b7a578cf4c1ca4c48b6c2f5c

 .../org/apache/kafka/clients/ClientRequest.java    |  2 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 12 ++--
 .../org/apache/kafka/clients/NodeApiVersions.java  | 22 +++----
 .../kafka/clients/consumer/internals/Fetcher.java  |  4 +-
 .../org/apache/kafka/common/protocol/ApiKeys.java  | 47 ++++++++++++++
 .../apache/kafka/common/protocol/ProtoUtils.java   | 73 ----------------------
 .../kafka/common/requests/AbstractRequest.java     |  5 +-
 .../kafka/common/requests/AbstractResponse.java    |  3 +-
 .../kafka/common/requests/ApiVersionsRequest.java  |  7 +--
 .../kafka/common/requests/ApiVersionsResponse.java | 11 ++--
 .../common/requests/ControlledShutdownRequest.java |  9 ++-
 .../requests/ControlledShutdownResponse.java       |  5 +-
 .../kafka/common/requests/CreateTopicsRequest.java |  9 ++-
 .../common/requests/CreateTopicsResponse.java      |  5 +-
 .../kafka/common/requests/DeleteTopicsRequest.java |  9 ++-
 .../common/requests/DeleteTopicsResponse.java      |  5 +-
 .../common/requests/DescribeGroupsRequest.java     | 13 ++--
 .../common/requests/DescribeGroupsResponse.java    |  7 +--
 .../apache/kafka/common/requests/FetchRequest.java |  7 +--
 .../kafka/common/requests/FetchResponse.java       |  5 +-
 .../common/requests/GroupCoordinatorRequest.java   | 10 ++-
 .../common/requests/GroupCoordinatorResponse.java  |  5 +-
 .../kafka/common/requests/HeartbeatRequest.java    |  9 ++-
 .../kafka/common/requests/HeartbeatResponse.java   |  5 +-
 .../kafka/common/requests/JoinGroupRequest.java    |  7 +--
 .../kafka/common/requests/JoinGroupResponse.java   |  5 +-
 .../kafka/common/requests/LeaderAndIsrRequest.java |  9 ++-
 .../common/requests/LeaderAndIsrResponse.java      |  5 +-
 .../kafka/common/requests/LeaveGroupRequest.java   |  9 ++-
 .../kafka/common/requests/LeaveGroupResponse.java  |  5 +-
 .../kafka/common/requests/ListGroupsRequest.java   |  9 ++-
 .../kafka/common/requests/ListGroupsResponse.java  |  7 +--
 .../kafka/common/requests/ListOffsetRequest.java   | 13 ++--
 .../kafka/common/requests/ListOffsetResponse.java  |  5 +-
 .../kafka/common/requests/MetadataRequest.java     |  9 ++-
 .../kafka/common/requests/MetadataResponse.java    |  5 +-
 .../kafka/common/requests/OffsetCommitRequest.java | 11 ++--
 .../common/requests/OffsetCommitResponse.java      |  5 +-
 .../kafka/common/requests/OffsetFetchRequest.java  |  9 ++-
 .../kafka/common/requests/OffsetFetchResponse.java |  5 +-
 .../kafka/common/requests/ProduceRequest.java      |  9 ++-
 .../kafka/common/requests/ProduceResponse.java     |  5 +-
 .../common/requests/SaslHandshakeRequest.java      | 11 ++--
 .../common/requests/SaslHandshakeResponse.java     |  5 +-
 .../kafka/common/requests/StopReplicaRequest.java  |  9 ++-
 .../kafka/common/requests/StopReplicaResponse.java |  7 +--
 .../kafka/common/requests/SyncGroupRequest.java    |  9 ++-
 .../kafka/common/requests/SyncGroupResponse.java   |  5 +-
 .../common/requests/UpdateMetadataRequest.java     | 10 ++-
 .../common/requests/UpdateMetadataResponse.java    |  5 +-
 .../apache/kafka/clients/NetworkClientTest.java    |  3 +-
 .../apache/kafka/clients/NodeApiVersionsTest.java  | 18 +++---
 .../apache/kafka/common/protocol/ApiKeysTest.java  |  5 ++
 .../kafka/common/protocol/ProtoUtilsTest.java      | 26 --------
 .../kafka/common/requests/RequestResponseTest.java | 23 ++++---
 .../authenticator/SaslAuthenticatorTest.java       |  5 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      | 14 ++---
 .../server/AbstractCreateTopicsRequestTest.scala   |  5 +-
 .../scala/unit/kafka/server/ApiVersionsTest.scala  |  6 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |  4 +-
 .../unit/kafka/server/MetadataCacheTest.scala      | 14 ++---
 61 files changed, 253 insertions(+), 352 deletions(-)
ba4eafa7874988374abcd9f48fbab96abb2032a4

 .../consumer/internals/AbstractCoordinator.java    | 46 ++++++++++++++++------
 1 file changed, 33 insertions(+), 13 deletions(-)
5916ef0227d099e5fa05341db3f918f5ef035816

 .../consumer/internals/AbstractCoordinator.java    | 46 ++++++++++++++++------
 1 file changed, 33 insertions(+), 13 deletions(-)
913c09e4a94447a953cb55ccd702d7131d1764a8

 core/src/main/scala/kafka/admin/AdminClient.scala          | 14 +++++++++++++-
 .../main/scala/kafka/admin/BrokerApiVersionsCommand.scala  |  4 +++-
 .../kafka/admin/BrokerApiVersionsCommandTest.scala         |  2 +-
 3 files changed, 17 insertions(+), 3 deletions(-)
c231f528026df6d5346963461345e5b983614c74

 tests/kafkatest/__init__.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
696b1d311c89671cdebd6e8ade4d2c2e55a0696c

 .../main/java/org/apache/kafka/clients/NetworkClient.java    | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)
7b302add35762139c265b7658add144cd12c8278

 .../apache/kafka/streams/perf/SimpleBenchmark.java | 43 ++++++++++++++--------
 1 file changed, 28 insertions(+), 15 deletions(-)
8bd06482d0562a518bce67dd06c590da4391d12a

 .../kafka/common/record/CompressionTypeTest.java   |  55 +++++
 .../apache/kafka/common/record/KafkaLZ4Test.java   |   2 +-
 .../message/ByteBufferBackedInputStream.scala      |  40 ----
 .../scala/kafka/message/CompressionFactory.scala   |  56 -----
 .../main/scala/kafka/message/MessageWriter.scala   | 229 ---------------------
 .../kafka/message/MessageCompressionTest.scala     |  21 --
 .../unit/kafka/message/MessageWriterTest.scala     | 131 ------------
 7 files changed, 56 insertions(+), 478 deletions(-)
f48e8c1a88404c9ef386707c5ac79e21dc8df5af

 .gitignore | 1 +
 1 file changed, 1 insertion(+)
0cdf5c935605db3e0e8e159faea427bb4b1d0eb2

 .../main/java/org/apache/kafka/clients/NodeApiVersions.java   | 11 +++++------
 .../java/org/apache/kafka/clients/NodeApiVersionsTest.java    |  8 ++++++++
 2 files changed, 13 insertions(+), 6 deletions(-)
3b8b7a4be39cb4a3f7257f8a17f74a887572e627

 .../main/java/org/apache/kafka/clients/NodeApiVersions.java   | 11 +++++------
 .../java/org/apache/kafka/clients/NodeApiVersionsTest.java    |  8 ++++++++
 2 files changed, 13 insertions(+), 6 deletions(-)
ddde79a351331d12c8811354a7011c0bfce2c9a1

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
d42159215da99a88d2b3984474d0c503aba39e2d
e41e782006d807a1ca8098dbfb95b8ab2295d6af

 .../kafka/common/record/MemoryRecordsBuilder.java  | 17 ++++++----
 .../org/apache/kafka/common/record/Record.java     |  1 -
 .../kafka/common/record/RecordsIterator.java       | 11 ++++--
 .../common/record/MemoryRecordsBuilderTest.java    | 12 +++++++
 .../kafka/common/record/SimpleRecordTest.java      | 39 ++++++++++++++++++++++
 5 files changed, 71 insertions(+), 9 deletions(-)
3db3d73de6bc1fbb846d0943a8fe73dcca96b78a

 .../apache/kafka/streams/kstream/internals/KStreamPassThrough.java    | 4 ++--
 .../kafka/streams/kstream/internals/KTableKTableJoinMerger.java       | 3 ++-
 .../org/apache/kafka/streams/processor/internals/ProcessorNode.java   | 4 ++--
 3 files changed, 6 insertions(+), 5 deletions(-)
0790b352ab4f427584af8a7a2d18744c8f544ac8

 tests/kafkatest/tests/core/throttling_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d24d932efb980b1fc15bb4dbba4d67d464e97ab3

 core/src/main/scala/kafka/server/KafkaApis.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
dcea49856805a039f0859facf169a87a574c06d3

 .../kafka/clients/consumer/internals/AbstractCoordinator.java     | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
916edc3a4ed0b44e64d0a0410137bf96e2a5558d

 .../main/java/org/apache/kafka/common/security/ssl/SslFactory.java    | 2 +-
 .../kafka/connect/runtime/rest/resources/ConnectorsResource.java      | 4 ++--
 .../kafka/streams/processor/internals/GlobalStateUpdateTask.java      | 2 +-
 .../streams/processor/internals/assignment/StickyTaskAssignor.java    | 2 +-
 .../java/org/apache/kafka/streams/state/internals/NamedCache.java     | 2 +-
 5 files changed, 6 insertions(+), 6 deletions(-)
c6fcc721e2973f0bf2610d76bee4072bc30d48c9

 tests/kafkatest/tests/core/throttling_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d734f4e56d276f84b8c52b602edd67d41cbb6c35

 .../java/org/apache/kafka/common/metrics/Sensor.java | 19 ++++++++-----------
 .../org/apache/kafka/common/metrics/stats/Avg.java   |  3 +--
 .../org/apache/kafka/common/metrics/stats/Count.java |  4 ++--
 .../org/apache/kafka/common/metrics/stats/Max.java   |  4 ++--
 .../org/apache/kafka/common/metrics/stats/Min.java   |  4 ++--
 .../kafka/common/metrics/stats/Percentiles.java      |  4 ++--
 .../org/apache/kafka/common/metrics/stats/Rate.java  |  4 ++--
 .../kafka/common/metrics/stats/SampledStat.java      |  3 +--
 .../kafka/common/requests/MetadataResponse.java      | 20 +++++++++++---------
 .../java/org/apache/kafka/common/utils/Utils.java    |  6 +++---
 10 files changed, 34 insertions(+), 37 deletions(-)
a515e93570c5c117ca29fb05137898817f058fb9

 core/src/main/scala/kafka/network/RequestChannel.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1f1e794ad0025bb2a33b7d8378a481f224b3bccc

 .../streams/processor/internals/AbstractTask.java  |  18 +-
 .../processor/internals/Checkpointable.java        |  27 +++
 .../internals/GlobalStateManagerImpl.java          |  16 +-
 .../processor/internals/GlobalStateUpdateTask.java |   3 +-
 .../processor/internals/ProcessorStateManager.java |  57 +++----
 .../streams/processor/internals/StandbyTask.java   |  23 +--
 .../streams/processor/internals/StateManager.java  |   4 +-
 .../streams/processor/internals/StreamTask.java    |   5 +-
 .../state/internals/InMemoryKeyValueStore.java     |   2 +-
 .../processor/internals/AbstractTaskTest.java      |   3 +-
 .../internals/GlobalStateManagerImplTest.java      |  49 +++++-
 .../processor/internals/GlobalStateTaskTest.java   |  16 +-
 .../internals/ProcessorStateManagerTest.java       | 186 ++++++++++++++-------
 .../processor/internals/StandbyTaskTest.java       |  51 +++++-
 .../processor/internals/StateManagerStub.java      |   7 +-
 .../processor/internals/StreamTaskTest.java        |  60 +++++++
 .../apache/kafka/test/GlobalStateManagerStub.java  |   7 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   3 +-
 18 files changed, 401 insertions(+), 136 deletions(-)
fc1cfe475e8ae8458d8ddf119ce18d0c64653a70

 .../org/apache/kafka/clients/ClientRequest.java    |   5 +-
 .../org/apache/kafka/clients/NetworkClient.java    |  21 +-
 .../consumer/internals/ConsumerCoordinator.java    |   9 +-
 .../consumer/internals/ConsumerNetworkClient.java  |   5 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  19 +-
 .../kafka/common/requests/AbstractRequest.java     | 110 ++++---
 .../common/requests/AbstractRequestResponse.java   |  53 +---
 .../kafka/common/requests/AbstractResponse.java    |  25 +-
 .../kafka/common/requests/ApiVersionsRequest.java  |  26 +-
 .../kafka/common/requests/ApiVersionsResponse.java |  49 +--
 .../common/requests/ControlledShutdownRequest.java |  23 +-
 .../requests/ControlledShutdownResponse.java       |  40 ++-
 .../kafka/common/requests/CreateTopicsRequest.java | 106 ++++---
 .../common/requests/CreateTopicsResponse.java      |  45 ++-
 .../kafka/common/requests/DeleteTopicsRequest.java |  28 +-
 .../common/requests/DeleteTopicsResponse.java      |  35 +--
 .../common/requests/DescribeGroupsRequest.java     |  25 +-
 .../common/requests/DescribeGroupsResponse.java    |  67 ++--
 .../apache/kafka/common/requests/FetchRequest.java | 109 +++----
 .../kafka/common/requests/FetchResponse.java       |  74 ++---
 .../common/requests/GroupCoordinatorRequest.java   |  20 +-
 .../common/requests/GroupCoordinatorResponse.java  |  26 +-
 .../kafka/common/requests/HeartbeatRequest.java    |  27 +-
 .../kafka/common/requests/HeartbeatResponse.java   |  17 +-
 .../kafka/common/requests/JoinGroupRequest.java    |  51 ++-
 .../kafka/common/requests/JoinGroupResponse.java   |  57 ++--
 .../kafka/common/requests/LeaderAndIsrRequest.java |  86 ++---
 .../common/requests/LeaderAndIsrResponse.java      |  46 ++-
 .../kafka/common/requests/LeaveGroupRequest.java   |  24 +-
 .../kafka/common/requests/LeaveGroupResponse.java  |  22 +-
 .../kafka/common/requests/ListGroupsRequest.java   |  19 +-
 .../kafka/common/requests/ListGroupsResponse.java  |  33 +-
 .../kafka/common/requests/ListOffsetRequest.java   | 113 +++----
 .../kafka/common/requests/ListOffsetResponse.java  |  76 +++--
 .../kafka/common/requests/MetadataRequest.java     |  33 +-
 .../kafka/common/requests/MetadataResponse.java    | 129 ++++----
 .../kafka/common/requests/OffsetCommitRequest.java | 135 +++-----
 .../common/requests/OffsetCommitResponse.java      |  52 ++--
 .../kafka/common/requests/OffsetFetchRequest.java  |  75 ++---
 .../kafka/common/requests/OffsetFetchResponse.java |  77 ++---
 .../kafka/common/requests/ProduceRequest.java      |  70 +++--
 .../kafka/common/requests/ProduceResponse.java     |  42 +--
 .../kafka/common/requests/RequestAndSize.java      |  27 ++
 .../kafka/common/requests/RequestHeader.java       |  21 +-
 .../kafka/common/requests/ResponseHeader.java      |  15 +-
 .../common/requests/SaslHandshakeRequest.java      |  21 +-
 .../common/requests/SaslHandshakeResponse.java     |  21 +-
 .../kafka/common/requests/StopReplicaRequest.java  |  50 +--
 .../kafka/common/requests/StopReplicaResponse.java |  49 ++-
 .../kafka/common/requests/SyncGroupRequest.java    |  44 +--
 .../kafka/common/requests/SyncGroupResponse.java   |  21 +-
 .../common/requests/UpdateMetadataRequest.java     | 130 ++++----
 .../common/requests/UpdateMetadataResponse.java    |  18 +-
 .../authenticator/SaslServerAuthenticator.java     |  11 +-
 .../apache/kafka/common/utils/CollectionUtils.java |  12 +-
 .../java/org/apache/kafka/clients/MockClient.java  |  17 +-
 .../apache/kafka/clients/NetworkClientTest.java    |  10 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   2 +-
 .../clients/consumer/internals/FetcherTest.java    |   2 +-
 .../kafka/common/requests/RequestResponseTest.java | 345 +++++++++++----------
 .../authenticator/SaslAuthenticatorTest.java       |   2 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   2 +-
 .../scala/kafka/api/GenericRequestAndHeader.scala  |  56 ----
 .../scala/kafka/api/GenericResponseAndHeader.scala |  47 ---
 .../src/main/scala/kafka/api/ProducerRequest.scala |   2 +-
 .../controller/ControllerChannelManager.scala      |  11 +-
 .../main/scala/kafka/network/RequestChannel.scala  |  36 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  97 +++---
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  15 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  33 +-
 .../unit/kafka/network/SocketServerTest.scala      |  26 +-
 .../server/AbstractCreateTopicsRequestTest.scala   |  20 +-
 .../unit/kafka/server/ApiVersionsRequestTest.scala |  14 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |  70 +++--
 .../kafka/server/CreateTopicsRequestTest.scala     |  21 +-
 .../kafka/server/DeleteTopicsRequestTest.scala     |   6 +-
 .../unit/kafka/server/EdgeCaseRequestTest.scala    |  20 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |  15 +-
 .../unit/kafka/server/MetadataCacheTest.scala      |  32 +-
 .../unit/kafka/server/MetadataRequestTest.scala    |  16 +-
 .../unit/kafka/server/ProduceRequestTest.scala     |   4 +-
 .../kafka/server/SaslApiVersionsRequestTest.scala  |  31 +-
 .../internals/InternalTopicManagerTest.java        |   4 +-
 83 files changed, 1681 insertions(+), 1819 deletions(-)
1f2ee5f0a9dfc33e34362f7cd4ac45edaabe421b

 core/src/main/scala/kafka/log/LogValidator.scala   |  6 ++--
 .../main/scala/kafka/server/ConfigHandler.scala    | 13 ++++----
 core/src/main/scala/kafka/server/KafkaConfig.scala | 15 +++++++--
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 28 +++++++++++-----
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  2 ++
 docs/upgrade.html                                  | 39 +++++++++++++++++++++-
 7 files changed, 82 insertions(+), 23 deletions(-)
a88737929e880d5c6892a306d3c9b1358853b76b

 .../main/java/org/apache/kafka/tools/ClientCompatibilityTest.java   | 6 +++---
 tools/src/main/java/org/apache/kafka/tools/ThroughputThrottler.java | 6 ++----
 tools/src/main/java/org/apache/kafka/tools/VerifiableProducer.java  | 2 +-
 3 files changed, 6 insertions(+), 8 deletions(-)
505af6bfdafa4719e4faeefab4d334cb0eebf784

 .../java/org/apache/kafka/streams/state/internals/RocksDBStore.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
022d2017a781286d223d80d8eae505fbc3fb369c

 .../kafka/common/record/ByteBufferInputStream.java |  36 ++---
 .../common/record/ByteBufferOutputStream.java      |  53 +++-----
 .../kafka/common/record/CompressionType.java       | 147 ++++++++++++++++++++-
 .../kafka/common/record/MemoryRecordsBuilder.java  | 137 +------------------
 .../org/apache/kafka/common/record/Record.java     |   2 +-
 .../kafka/common/record/RecordsIterator.java       |   3 +-
 .../clients/consumer/internals/FetcherTest.java    |   3 +-
 7 files changed, 191 insertions(+), 190 deletions(-)
6c839395b7b43d8e9c0dfbb3c12470fc9284a94a

 .../apache/kafka/connect/data/ConnectSchema.java   | 15 +++-
 .../java/org/apache/kafka/connect/data/Struct.java |  2 +-
 .../org/apache/kafka/connect/data/FakeSchema.java  | 83 ++++++++++++++++++++++
 .../org/apache/kafka/connect/data/StructTest.java  | 33 +++++++++
 4 files changed, 129 insertions(+), 4 deletions(-)
a1900ada7fdc3318f24e94e4aac956dca3463bbf

 clients/src/test/java/org/apache/kafka/clients/ClientUtilsTest.java | 6 +++---
 .../java/org/apache/kafka/clients/consumer/KafkaConsumerTest.java   | 2 +-
 .../java/org/apache/kafka/clients/producer/KafkaProducerTest.java   | 2 +-
 .../src/test/java/org/apache/kafka/common/network/SelectorTest.java | 6 +++---
 4 files changed, 8 insertions(+), 8 deletions(-)
cb725c6a2d21651fe8b2e50225635209aa949bb5

 .../org/apache/kafka/streams/kstream/KStream.java  | 14 ++++
 .../streams/kstream/internals/KStreamImpl.java     | 12 +++
 .../streams/kstream/internals/KStreamPeek.java     | 45 ++++++++++++
 .../streams/kstream/internals/KStreamPeekTest.java | 85 ++++++++++++++++++++++
 4 files changed, 156 insertions(+)
5d1bb0a9a0f650e500ee47cfc30d2045963410ec

 docs/streams.html | 392 +++++++++++++++++++++++++++---------------------------
 1 file changed, 196 insertions(+), 196 deletions(-)
af182480d2f31f8ef44764fc8cfa250ec76a878f

 docs/streams.html | 392 +++++++++++++++++++++++++++---------------------------
 1 file changed, 196 insertions(+), 196 deletions(-)
167d5a33fd05bbd281ee2afc56b0b1f70ffaf7fe

 docs/streams.html | 7 +++++++
 1 file changed, 7 insertions(+)
abe5e0e489a1d93867098da8d472060055b31b72

 docs/streams.html | 7 +++++++
 1 file changed, 7 insertions(+)
f6d07e206799f1caabccc3e2a30eea62e4d4881d

 docs/ops.html | 130 +++++++++++++++++++++++++++++++++++++++++++++++++++++++---
 1 file changed, 124 insertions(+), 6 deletions(-)
2e1b00f262947c4c3211df205df259ef517763f4

 docs/ops.html | 130 +++++++++++++++++++++++++++++++++++++++++++++++++++++++---
 1 file changed, 124 insertions(+), 6 deletions(-)
f6226777d9797b476763c397db550021504ebca0

 docs/api.html          |   2 +-
 docs/introduction.html |   6 +--
 docs/streams.html      | 123 ++++++++++++++++++++++++++++++++++---------------
 docs/toc.html          |   4 +-
 docs/upgrade.html      |  48 ++++---------------
 docs/uses.html         |  49 +++++++++++++++-----
 6 files changed, 138 insertions(+), 94 deletions(-)
2c91b324d4798138dd479f54269bdc4f39339817

 docs/api.html          |   2 +-
 docs/introduction.html |   6 +--
 docs/streams.html      | 123 ++++++++++++++++++++++++++++++++++---------------
 docs/toc.html          |   4 +-
 docs/upgrade.html      |  47 ++++---------------
 docs/uses.html         |  49 +++++++++++++++-----
 6 files changed, 137 insertions(+), 94 deletions(-)
4db048d61206bc6efbd143d6293216b7cb4b86c5

 .../org/apache/kafka/streams/processor/internals/StreamThread.java    | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
576d93a8dc0cf4215f9a6e35851399f54c5cb348

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
71a511c3460bfbc2a47e8f03926be8bff19fe916

 .../kafka/common/record/MemoryRecordsBuilder.java  | 18 ++++++++++++-
 .../kafka/common/record/FileRecordsTest.java       |  4 +--
 .../common/record/MemoryRecordsBuilderTest.java    | 29 ++++++++++++++++++++
 .../kafka/common/record/MemoryRecordsTest.java     |  6 ++---
 .../test/java/org/apache/kafka/test/TestUtils.java | 26 +++++-------------
 .../kafka/api/BaseProducerSendTest.scala           | 31 +++++++++++++++++++---
 .../kafka/api/PlaintextProducerSendTest.scala      |  8 ++++++
 .../javaapi/message/BaseMessageSetTestCases.scala  |  4 +--
 8 files changed, 96 insertions(+), 30 deletions(-)
3b36d5cff0b7a51e737a97144d6d479af708b2d7

 .../kafka/common/record/MemoryRecordsBuilder.java  | 18 ++++++++++++-
 .../kafka/common/record/FileRecordsTest.java       |  4 +--
 .../common/record/MemoryRecordsBuilderTest.java    | 29 ++++++++++++++++++++
 .../kafka/common/record/MemoryRecordsTest.java     |  6 ++---
 .../test/java/org/apache/kafka/test/TestUtils.java | 26 +++++-------------
 .../kafka/api/BaseProducerSendTest.scala           | 31 +++++++++++++++++++---
 .../kafka/api/PlaintextProducerSendTest.scala      |  8 ++++++
 .../javaapi/message/BaseMessageSetTestCases.scala  |  4 +--
 8 files changed, 96 insertions(+), 30 deletions(-)
dfbe944e96e4f26bb99bf122e8cac122d069764c

 .../apache/kafka/common/config/AbstractConfig.java | 17 ++++++++++++++-
 .../org/apache/kafka/common/metrics/Metrics.java   |  4 ++++
 core/src/main/scala/kafka/server/KafkaConfig.scala |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 23 ++++++++++----------
 .../server/KafkaMetricReporterClusterIdTest.scala  | 25 +++++++++++++++++++++-
 5 files changed, 57 insertions(+), 14 deletions(-)
ed91af512fcb5c0ea3032ed259451817c96b5ee1

 .../apache/kafka/common/config/AbstractConfig.java | 17 ++++++++++++++-
 .../org/apache/kafka/common/metrics/Metrics.java   |  4 ++++
 core/src/main/scala/kafka/server/KafkaConfig.scala |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 23 ++++++++++----------
 .../server/KafkaMetricReporterClusterIdTest.scala  | 25 +++++++++++++++++++++-
 5 files changed, 57 insertions(+), 14 deletions(-)
5dabca02594e4b71fb6ff275283a3851f1c62d60

 .../kafka/connect/runtime/WorkerSinkTask.java      |  4 +--
 .../kafka/connect/runtime/WorkerSourceTask.java    |  4 ++-
 .../apache/kafka/connect/util/ConnectUtils.java    | 31 ++++++++++++++++
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |  4 +--
 .../connect/runtime/WorkerSourceTaskTest.java      | 41 ++++++++++++++++++++++
 5 files changed, 79 insertions(+), 5 deletions(-)
260d487cdd689c9689b7f4ddcc67978ed72ab413

 core/src/main/scala/kafka/security/auth/SimpleAclAuthorizer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
8bc9d583930110cf209f8ab20f9ff640ace3ed35

 .../main/scala/kafka/server/ConfigHandler.scala    | 34 +++++++---
 core/src/main/scala/kafka/server/KafkaConfig.scala |  5 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  1 +
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |  1 +
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  1 +
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 79 ++++++++++++----------
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  1 +
 .../unit/kafka/server/ReplicaManagerTest.scala     | 10 ++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  1 +
 9 files changed, 84 insertions(+), 49 deletions(-)
3ac10d5aefc6d12805ee6b43d5ce8d566ad4abdd

 docs/quickstart.html | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
601d4040d446599bb01c45389b3e90645245e9af

 docs/quickstart.html | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
415df0052c5aa3016bfaac841a660ddb287e4fc1

 docs/streams.html | 29 +++++++++++++++++++++--------
 1 file changed, 21 insertions(+), 8 deletions(-)
1c45f79c91a9f2b98f9549f51f80de2e89146490

 docs/streams.html | 29 +++++++++++++++++++++--------
 1 file changed, 21 insertions(+), 8 deletions(-)
253dfcf4756e8e0d434da69516993ea784f830c9

 streams/src/main/java/org/apache/kafka/streams/KafkaStreams.java | 2 ++
 1 file changed, 2 insertions(+)
516d3284943b3fdb0bf1f6208b84210def9a8a9b

 README.md    | 6 ++++++
 build.gradle | 6 +++++-
 2 files changed, 11 insertions(+), 1 deletion(-)
9898d665d1ab201405d66c70e3ea9710d9dcecd7

 .../org/apache/kafka/clients/NetworkClient.java    |   4 +-
 .../consumer/internals/AbstractCoordinator.java    |  10 +-
 .../consumer/internals/ConsumerCoordinator.java    |   4 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |   4 +-
 .../kafka/common/requests/ApiVersionsRequest.java  |   3 +-
 .../kafka/common/requests/ApiVersionsResponse.java |  18 +-
 .../common/requests/ControlledShutdownRequest.java |   2 +-
 .../requests/ControlledShutdownResponse.java       |  15 +-
 .../common/requests/CreateTopicsResponse.java      |   4 +-
 .../common/requests/DeleteTopicsResponse.java      |   4 +-
 .../common/requests/DescribeGroupsResponse.java    |  18 +-
 .../apache/kafka/common/requests/FetchRequest.java |   2 +-
 .../kafka/common/requests/FetchResponse.java       |  17 +-
 .../common/requests/GroupCoordinatorRequest.java   |   2 +-
 .../common/requests/GroupCoordinatorResponse.java  |  17 +-
 .../kafka/common/requests/HeartbeatRequest.java    |   2 +-
 .../kafka/common/requests/HeartbeatResponse.java   |  18 +-
 .../kafka/common/requests/JoinGroupRequest.java    |   2 +-
 .../kafka/common/requests/JoinGroupResponse.java   |  19 +-
 .../kafka/common/requests/LeaderAndIsrRequest.java |   6 +-
 .../common/requests/LeaderAndIsrResponse.java      |  32 +--
 .../kafka/common/requests/LeaveGroupRequest.java   |   2 +-
 .../kafka/common/requests/LeaveGroupResponse.java  |  15 +-
 .../kafka/common/requests/ListGroupsRequest.java   |   3 +-
 .../kafka/common/requests/ListGroupsResponse.java  |  16 +-
 .../kafka/common/requests/ListOffsetRequest.java   |   4 +-
 .../kafka/common/requests/ListOffsetResponse.java  |  23 +-
 .../kafka/common/requests/OffsetCommitRequest.java |   8 +-
 .../common/requests/OffsetCommitResponse.java      |  23 +-
 .../common/requests/SaslHandshakeRequest.java      |   2 +-
 .../common/requests/SaslHandshakeResponse.java     |  15 +-
 .../kafka/common/requests/StopReplicaRequest.java  |   6 +-
 .../kafka/common/requests/StopReplicaResponse.java |  32 +--
 .../kafka/common/requests/SyncGroupRequest.java    |   2 +-
 .../kafka/common/requests/SyncGroupResponse.java   |  15 +-
 .../common/requests/UpdateMetadataRequest.java     |   2 +-
 .../common/requests/UpdateMetadataResponse.java    |  15 +-
 .../authenticator/SaslClientAuthenticator.java     |   4 +-
 .../authenticator/SaslServerAuthenticator.java     |   4 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  56 ++--
 .../internals/AbstractCoordinatorTest.java         |   8 +-
 .../internals/ConsumerCoordinatorTest.java         | 320 ++++++++++-----------
 .../internals/ConsumerNetworkClientTest.java       |  16 +-
 .../clients/consumer/internals/FetcherTest.java    |  48 ++--
 .../clients/producer/internals/SenderTest.java     |  21 +-
 .../kafka/common/requests/RequestResponseTest.java |  46 +--
 .../authenticator/SaslAuthenticatorTest.java       |   6 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |  40 +--
 core/src/main/scala/kafka/admin/AdminClient.scala  |   8 +-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |   4 +-
 .../kafka/api/ControlledShutdownRequest.scala      |   4 +-
 .../kafka/api/ControlledShutdownResponse.scala     |   8 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   2 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |   8 +-
 .../scala/kafka/api/GroupCoordinatorRequest.scala  |   2 +-
 .../scala/kafka/api/GroupCoordinatorResponse.scala |  10 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |   4 +-
 .../scala/kafka/api/OffsetCommitResponse.scala     |  10 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |   4 +-
 .../main/scala/kafka/api/OffsetFetchResponse.scala |  16 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   2 +-
 core/src/main/scala/kafka/api/OffsetResponse.scala |  10 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   2 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |   8 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  |  20 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   2 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |   2 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |  20 +-
 .../kafka/common/OffsetMetadataAndError.scala      |  22 +-
 .../kafka/consumer/ConsumerFetcherThread.scala     |   5 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   5 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  20 +-
 .../kafka/controller/TopicDeletionManager.scala    |   4 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala | 138 ++++-----
 .../kafka/coordinator/GroupMetadataManager.scala   |  14 +-
 .../scala/kafka/coordinator/MemberMetadata.scala   |   4 +-
 .../main/scala/kafka/javaapi/FetchResponse.scala   |   4 +-
 .../kafka/javaapi/GroupCoordinatorResponse.scala   |   4 +-
 .../scala/kafka/javaapi/OffsetCommitResponse.scala |   6 +-
 .../main/scala/kafka/javaapi/OffsetResponse.scala  |   4 +-
 .../main/scala/kafka/javaapi/TopicMetadata.scala   |   9 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  12 +-
 .../kafka/producer/async/DefaultEventHandler.scala |   6 +-
 .../scala/kafka/security/auth/ResourceType.scala   |   8 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 112 ++++----
 core/src/main/scala/kafka/server/KafkaServer.scala |   8 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   6 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  40 +--
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   4 +-
 .../kafka/tools/ReplicaVerificationTool.scala      |   2 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  38 +--
 .../ReplicaFetcherThreadFatalErrorTest.scala       |   2 +-
 .../kafka/tools/ReplicaVerificationToolTest.scala  |   2 +-
 .../test/scala/other/kafka/TestOffsetManager.scala |   4 +-
 .../api/RequestResponseSerializationTest.scala     |  28 +-
 .../coordinator/GroupCoordinatorResponseTest.scala | 300 +++++++++----------
 .../coordinator/GroupMetadataManagerTest.scala     |  36 +--
 .../kafka/integration/BaseTopicMetadataTest.scala  |  26 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   4 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |   6 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  18 +-
 .../server/AbstractCreateTopicsRequestTest.scala   |   2 +-
 .../kafka/server/AbstractFetcherThreadTest.scala   |   2 +-
 .../unit/kafka/server/ApiVersionsRequestTest.scala |   2 +-
 .../kafka/server/DeleteTopicsRequestTest.scala     |   2 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |   8 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   2 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   2 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  50 ++--
 .../unit/kafka/server/ReplicaManagerTest.scala     |   8 +-
 .../kafka/server/SaslApiVersionsRequestTest.scala  |   4 +-
 112 files changed, 1054 insertions(+), 1034 deletions(-)
54301ec2680c206d61108c155109c7a429c3398b

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
b11768460fbdd3691a5c957b9b34c544782a2685

 docs/documentation.html                       | 144 +------
 docs/documentation/streams.html               |  19 +
 docs/images/streams-architecture-overview.jpg | Bin 0 -> 420929 bytes
 docs/images/streams-architecture-states.jpg   | Bin 0 -> 147338 bytes
 docs/images/streams-architecture-tasks.jpg    | Bin 0 -> 130435 bytes
 docs/images/streams-architecture-threads.jpg  | Bin 0 -> 153622 bytes
 docs/images/streams-architecture-topology.jpg | Bin 0 -> 182199 bytes
 docs/introduction.html                        |  17 +-
 docs/js/templateData.js                       |   4 +-
 docs/migration.html                           |   4 +-
 docs/protocol.html                            |   8 +-
 docs/quickstart.html                          |  12 +-
 docs/streams.html                             | 544 ++++++++++++++++++++------
 docs/toc.html                                 | 154 ++++++++
 docs/upgrade.html                             |   2 +-
 docs/uses.html                                |   2 +-
 16 files changed, 630 insertions(+), 280 deletions(-)
a15fcea799a843c1b4888fffbb2d382ee2e2ee36

 docs/documentation.html                       | 144 +------
 docs/documentation/streams.html               |  19 +
 docs/images/streams-architecture-overview.jpg | Bin 0 -> 420929 bytes
 docs/images/streams-architecture-states.jpg   | Bin 0 -> 147338 bytes
 docs/images/streams-architecture-tasks.jpg    | Bin 0 -> 130435 bytes
 docs/images/streams-architecture-threads.jpg  | Bin 0 -> 153622 bytes
 docs/images/streams-architecture-topology.jpg | Bin 0 -> 182199 bytes
 docs/introduction.html                        |  17 +-
 docs/js/templateData.js                       |   4 +-
 docs/migration.html                           |   4 +-
 docs/protocol.html                            |   8 +-
 docs/quickstart.html                          |  12 +-
 docs/streams.html                             | 544 ++++++++++++++++++++------
 docs/toc.html                                 | 154 ++++++++
 docs/upgrade.html                             |   2 +-
 docs/uses.html                                |   2 +-
 16 files changed, 630 insertions(+), 280 deletions(-)
b5dd39dda68e8bab555eea1b80de8f969f8641ea

 .../org/apache/kafka/common/config/SslConfigs.java     |  2 +-
 .../apache/kafka/common/security/ssl/SslFactory.java   |  8 ++++----
 .../kafka/common/network/SslTransportLayerTest.java    | 18 ++++++++++++++++++
 .../kafka/common/security/ssl/SslFactoryTest.java      | 16 ++++++++++++++++
 docs/security.html                                     |  5 +++++
 5 files changed, 44 insertions(+), 5 deletions(-)
b6c34e2df5dc4e3f6cda9b64786d7e929acb963b

 README.md    |  4 ++++
 build.gradle | 37 ++++++++++++++++++++++++++++++++++++-
 2 files changed, 40 insertions(+), 1 deletion(-)
d24616777ade24a37c5e7e517bcd1d8912eaf19d

 .../state/internals/InMemoryLRUCacheStoreTest.java | 45 ++++++++++++++++++++++
 1 file changed, 45 insertions(+)
bad631a7c6d06a9bf3985af0881538a5dda60d59

 .../processor/internals/InternalTopicManager.java  | 13 +++---
 .../processor/internals/StreamsKafkaClient.java    | 52 +++++++++++++++-------
 .../internals/InternalTopicManagerTest.java        | 13 +++---
 3 files changed, 52 insertions(+), 26 deletions(-)
b865a8b1dcae642b80280b8a7b5e23e82666061b

 .../processor/internals/InternalTopicManager.java  | 13 +++---
 .../processor/internals/StreamsKafkaClient.java    | 52 +++++++++++++++-------
 .../apache/kafka/streams/perf/SimpleBenchmark.java |  5 +++
 .../internals/InternalTopicManagerTest.java        | 13 +++---
 .../streams/streams_simple_benchmark_test.py       |  2 +-
 .../kafkatest/tests/streams/streams_smoke_test.py  |  4 +-
 6 files changed, 60 insertions(+), 29 deletions(-)
f8c11eb0c34b0c2b4330aea9181ccb0452a62ce7

 tests/kafkatest/services/streams.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
69d3af8be26c8f3abb2c9dfd43d2462d5aa27c69

 .../java/org/apache/kafka/streams/perf/SimpleBenchmark.java    | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
6c1478d19f5a9c8dede9e7c3b047533ba61cc731

 .../apache/kafka/clients/consumer/internals/AbstractCoordinator.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
39f1a7d8c62fe2525d933e92a85fcd882cc770ce

 docs/ops.html | 53 ++++++++++++++++++++---------------------------------
 1 file changed, 20 insertions(+), 33 deletions(-)
8bd8751aa776990d1847e4d6ab187a0aea90c051

 docs/ops.html | 53 ++++++++++++++++++++---------------------------------
 1 file changed, 20 insertions(+), 33 deletions(-)
13a82b48cab5f13feeb9d3597b24d26416eb4033

 .../apache/kafka/streams/perf/SimpleBenchmark.java | 444 +++++++++++++--------
 .../streams/streams_simple_benchmark_test.py       |  89 ++++-
 .../services/performance/streams_performance.py    |  10 +-
 tests/kafkatest/services/streams.py                |   9 +-
 4 files changed, 351 insertions(+), 201 deletions(-)
c7c113af63d8b4c49f16297af22b3a02528a500c

 .../org/apache/kafka/streams/processor/internals/StreamTask.java  | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)
b75d37a2a97a6c75ceeb06914128fa7bc9176fe4

 .../tests/streams/streams_broker_compatibility.py  | 90 ----------------------
 .../streams/streams_broker_compatibility_test.py   | 90 ++++++++++++++++++++++
 2 files changed, 90 insertions(+), 90 deletions(-)
e7c869e65d25dcf2d0a8f949da31c15d1d843950

 .../tests/streams/streams_broker_compatibility.py  | 90 ----------------------
 .../streams/streams_broker_compatibility_test.py   | 90 ++++++++++++++++++++++
 2 files changed, 90 insertions(+), 90 deletions(-)
b621703706118b383153da60937c1d31d518d5b8

 .../streams/processor/internals/StreamTask.java    |   6 +
 .../processor/internals/StreamTaskTest.java        | 192 ++++++++++++++-------
 .../org/apache/kafka/test/MockProcessorNode.java   |  21 ++-
 .../java/org/apache/kafka/test/MockSourceNode.java |   7 +
 4 files changed, 157 insertions(+), 69 deletions(-)
effa19c045b15c0f82568e91d7f485ae564123a2

 .../clients/producer/internals/RecordAccumulator.java      | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)
2e662a061608a0755274da3e2ccf87401936febf

 .../main/scala/kafka/tools/StreamsResetter.java    | 26 +++++++++++++++++++---
 1 file changed, 23 insertions(+), 3 deletions(-)
2e0b9a70d0163a1817ca2371aea503ec16f25f8c

 .../src/main/java/org/apache/kafka/common/requests/ProduceRequest.java   | 1 +
 1 file changed, 1 insertion(+)
bec105d48a5cce57080fec949da48cb79f4c1994

 .../src/main/java/org/apache/kafka/common/requests/ProduceRequest.java   | 1 +
 1 file changed, 1 insertion(+)
7f6bf5d44796ac14665d5ba8c2243f5d7f5d30bd

 .../src/main/java/org/apache/kafka/common/requests/ProduceRequest.java   | 1 +
 1 file changed, 1 insertion(+)
aca81877fbdaa17649ada327370526a713e751e4

 core/src/main/scala/kafka/log/Log.scala          | 4 ++++
 core/src/test/scala/unit/kafka/log/LogTest.scala | 4 +++-
 2 files changed, 7 insertions(+), 1 deletion(-)
6cef4f5e4c3a73911a43378caf5cfc2736814333

 core/src/main/scala/kafka/log/Log.scala          | 4 ++++
 core/src/test/scala/unit/kafka/log/LogTest.scala | 4 +++-
 2 files changed, 7 insertions(+), 1 deletion(-)
6bdc0da9a53ffe527fe2f75439221087009d72c6

 docs/ops.html | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)
be98865dfcddd38e3e411d41126fa6049c509cae

 docs/ops.html | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)
7bb1d2a44cab8209557e6427c61f05a00140b73e

 .../apache/kafka/streams/kstream/KStreamBuilder.java   | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
45d9fb3d5f13bef0bf6809ea71b2cbd73996a1b6

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)
2c0055e62fc6308e45ff8a9c1c386b43fa3a3905

 .../streams/integration/utils/IntegrationTestUtils.java  | 16 +---------------
 1 file changed, 1 insertion(+), 15 deletions(-)
588c5667f2e460dfd23ea40da5b2ee958567308e

 tests/kafkatest/tests/streams/streams_broker_compatibility.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
82e75b960737b50456e862f127f857832b22624e

 tests/kafkatest/tests/streams/streams_broker_compatibility.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
13a09557a4949cb795bc2dec07a2ae488fd273cb

 core/src/main/scala/kafka/cluster/Replica.scala    |   5 +-
 .../scala/kafka/controller/KafkaController.scala   |  10 +-
 .../MetricsDuringTopicCreationDeletionTest.scala   | 161 +++++++++++++++++++++
 3 files changed, 172 insertions(+), 4 deletions(-)
48aec6ef1e8065bd14e54172d6443144fb80738b

 core/src/main/scala/kafka/cluster/Replica.scala    |   5 +-
 .../scala/kafka/controller/KafkaController.scala   |  10 +-
 .../MetricsDuringTopicCreationDeletionTest.scala   | 161 +++++++++++++++++++++
 3 files changed, 172 insertions(+), 4 deletions(-)
f4276b7cfb2aefd61a937b7138094b936e6bceca

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
b31a7a9022bfb645cb61e6fbc0b22829108b3a3f

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
1f8a2ad2edc5d9de4dc3a3311a0650f25d2b9114

 .../processor/internals/ProcessorTopologyTest.java    | 19 +++++++++++++++++++
 .../kafka/test/ProcessorTopologyTestDriver.java       | 15 +++++++++++++--
 2 files changed, 32 insertions(+), 2 deletions(-)
7de22453bbd05a7ac629543e09626ac6987ce306

 .../org/apache/kafka/streams/KafkaStreams.java     |  6 ++---
 .../org/apache/kafka/streams/StreamsConfig.java    |  4 +--
 .../processor/internals/StateDirectory.java        | 29 ++++++++++++++--------
 .../streams/processor/internals/StreamThread.java  |  4 +--
 .../processor/internals/AbstractTaskTest.java      |  3 ++-
 .../internals/GlobalStateManagerImplTest.java      | 24 +++++++++++-------
 .../internals/GlobalStreamThreadTest.java          |  5 ++--
 .../internals/ProcessorStateManagerTest.java       |  3 ++-
 .../processor/internals/StandbyTaskTest.java       |  3 ++-
 .../processor/internals/StateDirectoryTest.java    | 22 +++++++++++++---
 .../processor/internals/StreamTaskTest.java        |  2 +-
 .../processor/internals/StreamThreadTest.java      |  9 ++++---
 .../StreamThreadStateStoreProviderTest.java        |  2 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |  3 ++-
 14 files changed, 76 insertions(+), 43 deletions(-)
e321cd4f5daf78046554d24e0f454a8cd2d5b394

 core/src/main/scala/kafka/tools/JmxTool.scala     | 35 +++++++++++++++++++++--
 tests/kafkatest/services/console_consumer.py      | 34 ++++++++++++++++++++--
 tests/kafkatest/services/monitor/jmx.py           |  6 ++--
 tests/kafkatest/tests/core/throttling_test.py     |  5 ++--
 tests/kafkatest/tests/produce_consume_validate.py | 20 +++++++++++--
 5 files changed, 89 insertions(+), 11 deletions(-)
d0932b0286d8e69a704211aeaba9fa9503c0fb42

 core/src/main/scala/kafka/tools/JmxTool.scala     | 35 +++++++++++++++++++++--
 tests/kafkatest/services/console_consumer.py      | 34 ++++++++++++++++++++--
 tests/kafkatest/services/monitor/jmx.py           |  6 ++--
 tests/kafkatest/tests/core/throttling_test.py     |  5 ++--
 tests/kafkatest/tests/produce_consume_validate.py | 20 +++++++++++--
 5 files changed, 89 insertions(+), 11 deletions(-)
0578e294500b220d09e46ec1c11cea42829e39f4

 tests/kafkatest/services/verifiable_producer.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
88809b9b8eb7895f3756a39ee2ad7dffd0b4d516

 tests/kafkatest/services/verifiable_producer.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7ebc5da606fb806bde8b7176fed0e60243e0f7f3

 .../streams/kstream/internals/AbstractStream.java  |   28 +-
 .../streams/kstream/internals/SessionKeySerde.java |   23 +-
 .../kafka/streams/processor/TopologyBuilder.java   |    4 +-
 .../streams/processor/internals/AbstractTask.java  |    1 -
 .../processor/internals/ProcessorStateManager.java |    2 -
 .../apache/kafka/streams/state/KeyValueStore.java  |    5 +-
 .../apache/kafka/streams/state/WindowStore.java    |    1 -
 .../kafka/streams/state/WindowStoreIterator.java   |    2 +-
 .../AbstractMergedSortedCacheStoreIterator.java    |    2 +-
 .../state/internals/AbstractStoreSupplier.java     |    9 +-
 .../state/internals/CachingKeyValueStore.java      |   38 +-
 .../state/internals/CachingSessionStore.java       |   76 +-
 .../state/internals/CachingWindowStore.java        |   38 +-
 .../internals/ChangeLoggingKeyValueBytesStore.java |   13 +-
 .../internals/ChangeLoggingKeyValueStore.java      |   16 +-
 .../ChangeLoggingSegmentedBytesStore.java          |    3 +-
 .../internals/CompositeReadOnlyWindowStore.java    |    1 +
 .../DelegatingPeekingKeyValueIterator.java         |   10 +-
 .../internals/InMemoryKeyValueLoggedStore.java     |   40 +-
 .../state/internals/InMemoryKeyValueStore.java     |  187 +++
 .../internals/InMemoryKeyValueStoreSupplier.java   |  165 +--
 .../streams/state/internals/LRUCacheEntry.java     |   17 +-
 .../streams/state/internals/MemoryLRUCache.java    |    2 +-
 .../MergedSortedCacheKeyValueStoreIterator.java    |    6 +-
 .../MergedSortedCacheSessionStoreIterator.java     |    2 +-
 .../state/internals/MeteredKeyValueStore.java      |   20 +-
 .../internals/MeteredSegmentedBytesStore.java      |    4 +-
 .../kafka/streams/state/internals/NamedCache.java  |    6 +-
 .../internals/RocksDBSegmentedBytesStore.java      |   14 +-
 .../state/internals/RocksDBSessionStore.java       |  122 +-
 .../internals/RocksDBSessionStoreSupplier.java     |   11 +-
 .../streams/state/internals/RocksDBStore.java      |   33 +-
 .../state/internals/RocksDBWindowStore.java        |  124 +-
 .../internals/RocksDBWindowStoreSupplier.java      |    2 +-
 .../kafka/streams/state/internals/Segment.java     |    8 +-
 .../streams/state/internals/SegmentIterator.java   |   12 +-
 .../state/internals/SegmentedBytesStore.java       |    7 +-
 .../kafka/streams/state/internals/Segments.java    |    5 +-
 .../internals/SerializedKeyValueIterator.java      |    2 +-
 .../kafka/streams/state/internals/ThreadCache.java |   40 +-
 .../streams/state/internals/WindowKeySchema.java   |   59 +
 .../state/internals/WindowStoreKeySchema.java      |   59 -
 .../state/internals/WindowStoreSupplier.java       |    7 +
 .../streams/state/internals/WindowStoreUtils.java  |   21 +-
 .../internals/WrappedSessionStoreIterator.java     |   89 ++
 .../streams/state/internals/WrappedStateStore.java |    6 +-
 .../internals/WrappedWindowStoreIterator.java      |   93 ++
 .../kstream/internals/SessionKeySerdeTest.java     |   67 +-
 .../internals/ProcessorStateManagerTest.java       |    1 +
 .../state/internals/CachingKeyValueStoreTest.java  |    3 +-
 .../state/internals/CachingWindowStoreTest.java    |    8 +-
 .../ChangeLoggingKeyValueBytesStoreTest.java       |    3 +-
 .../internals/ChangeLoggingKeyValueStoreTest.java  |    3 +-
 .../CompositeReadOnlyKeyValueStoreTest.java        |    2 +-
 .../DelegatingPeekingKeyValueIteratorTest.java     |    4 +-
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |   45 +-
 .../MergedSortedCacheSessionStoreIteratorTest.java |  113 --
 .../MergedSortedCacheWindowStoreIteratorTest.java  |   88 --
 ...SortedCacheWrappedSessionStoreIteratorTest.java |  113 ++
 ...dSortedCacheWrappedWindowStoreIteratorTest.java |   89 ++
 .../state/internals/ReadOnlyWindowStoreStub.java   |    2 +-
 .../state/internals/RocksDBWindowStoreTest.java    | 1191 ++++++++------------
 .../state/internals/SegmentIteratorTest.java       |   16 +-
 .../streams/state/internals/ThreadCacheTest.java   |  143 ++-
 .../state/internals/WindowStoreUtilsTest.java      |   10 +-
 .../apache/kafka/test/InMemoryKeyValueStore.java   |  152 ---
 66 files changed, 1559 insertions(+), 1929 deletions(-)
d95f22c12c36a92f9c71a78cabf897d65ddef65f

 .../internals/AbstractProcessorContext.java        |   5 +-
 .../internals/AbstractProcessorContextTest.java    | 173 +++++++++++++++++++++
 .../processor/internals/StateManagerStub.java      |  63 ++++++++
 .../org/apache/kafka/test/StreamsTestUtils.java    |   7 +
 4 files changed, 246 insertions(+), 2 deletions(-)
47517da40dcb37d91925c1888ce01d06c28ce4cc

 .../internals/GlobalStateManagerImplTest.java      | 45 ++++++++++++++--------
 1 file changed, 30 insertions(+), 15 deletions(-)
da082900b3d800ba43616706def611df7a00308f

 .../streams/processor/TopologyBuilderTest.java     | 88 ++++++++++++++++++++++
 1 file changed, 88 insertions(+)
d952d94e5f0dad08af3ec935fe43e3a17ea97359

 docs/streams.html | 84 +++++++++++++++++++++++++++++++++++++++++++++++++++++++
 docs/upgrade.html | 20 +++++++------
 2 files changed, 96 insertions(+), 8 deletions(-)
ab4ebb4bb93fbaab432d3f91dbc362d18796c83c

 docs/streams.html | 84 +++++++++++++++++++++++++++++++++++++++++++++++++++++++
 docs/upgrade.html | 20 +++++++------
 2 files changed, 96 insertions(+), 8 deletions(-)
ea70a9bcfc8a9ce317e8fa9b8cc4f7cb1aba26a9

 .../kafka/common/record/AbstractRecords.java       |  4 +-
 .../kafka/common/record/MemoryRecordsBuilder.java  |  3 ++
 .../org/apache/kafka/common/record/Record.java     | 24 +++++++----
 .../org/apache/kafka/common/record/Records.java    |  3 +-
 .../apache/kafka/common/record/TimestampType.java  |  3 ++
 .../kafka/common/record/FileRecordsTest.java       | 10 ++---
 .../kafka/common/record/SimpleRecordTest.java      | 12 +++++-
 .../kafka/common/record/TimestampTypeTest.java     |  5 +++
 core/src/main/scala/kafka/log/LogSegment.scala     | 10 +++--
 core/src/main/scala/kafka/log/LogValidator.scala   | 20 ++++-----
 core/src/main/scala/kafka/server/KafkaApis.scala   | 17 ++++----
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  4 +-
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 48 +++++++++++++++-------
 14 files changed, 110 insertions(+), 55 deletions(-)
cb674e5487f3f56647546b323dfe4fd45ccf0186

 checkstyle/import-control.xml                      |   1 +
 .../kafka/common/internals/FatalExitError.java     |  47 +++++++
 .../java/org/apache/kafka/common/utils/Exit.java   |  79 +++++++++++
 .../java/org/apache/kafka/common/utils/Utils.java  |   2 +-
 .../kafka/connect/cli/ConnectDistributed.java      |   3 +-
 .../kafka/connect/cli/ConnectStandalone.java       |   3 +-
 .../runtime/distributed/DistributedHerder.java     |   3 +-
 core/src/main/scala/kafka/Kafka.scala              |  16 +--
 core/src/main/scala/kafka/admin/AclCommand.scala   |   2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |   4 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |   2 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |   4 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   3 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   7 +-
 .../main/scala/kafka/server/KafkaHealthcheck.scala |   1 -
 .../scala/kafka/server/KafkaRequestHandler.scala   |  32 +++--
 core/src/main/scala/kafka/server/KafkaServer.scala |  10 +-
 .../scala/kafka/server/KafkaServerStartable.scala  |  27 ++--
 .../main/scala/kafka/server/OffsetCheckpoint.scala |   4 +-
 .../scala/kafka/server/ReplicaFetcherManager.scala |  14 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  20 +--
 .../main/scala/kafka/server/ReplicaManager.scala   |  25 ++--
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  13 +-
 .../main/scala/kafka/tools/ConsoleProducer.scala   |   8 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   2 +-
 .../main/scala/kafka/tools/EndToEndLatency.scala   |   3 +-
 .../main/scala/kafka/tools/ExportZkOffsets.scala   |   6 +-
 .../main/scala/kafka/tools/GetOffsetShell.scala    |   6 +-
 .../main/scala/kafka/tools/ImportZkOffsets.scala   |   5 +-
 core/src/main/scala/kafka/tools/JmxTool.scala      |   6 +-
 .../scala/kafka/tools/ProducerPerformance.scala    |   7 +-
 .../kafka/tools/ReplicaVerificationTool.scala      |   4 +-
 .../kafka/tools/SimpleConsumerPerformance.scala    |   2 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  14 +-
 .../scala/kafka/tools/StateChangeLogMerger.scala   |  12 +-
 .../main/scala/kafka/tools/StreamsResetter.java    |   3 +-
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala |   4 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |   5 +-
 .../scala/kafka/tools/ZooKeeperMainWrapper.scala   |   3 +-
 .../main/scala/kafka/utils/CommandLineUtils.scala  |  20 +--
 core/src/main/scala/kafka/utils/Exit.scala         |  53 ++++++++
 .../scala/kafka/utils/ShutdownableThread.scala     |  27 ++--
 .../api/GroupCoordinatorIntegrationTest.scala      |   2 +-
 .../ReplicaFetcherThreadFatalErrorTest.scala       | 145 +++++++++++++++++++++
 .../scala/kafka/security/minikdc/MiniKdc.scala     |   4 +-
 .../test/scala/kafka/tools/TestLogCleaning.scala   |   2 +-
 .../other/kafka/ReplicationQuotasTestRig.scala     |   4 +-
 .../test/scala/other/kafka/TestKafkaAppender.scala |   6 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   2 +-
 .../test/scala/other/kafka/TestOffsetManager.scala |   9 +-
 .../test/scala/unit/kafka/KafkaConfigTest.scala    |  36 ++---
 .../admin/ReassignPartitionsCommandArgsTest.scala  |   9 +-
 .../test/scala/unit/kafka/log/OffsetMapTest.scala  |   4 +-
 .../scala/unit/kafka/server/ApiVersionsTest.scala  |   2 +-
 .../unit/kafka/server/BaseReplicaFetchTest.scala   |   1 -
 .../unit/kafka/utils/ShutdownableThreadTest.scala  |  54 ++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   4 +-
 .../kafka/streams/tests/ShutdownDeadlockTest.java  |   3 +-
 .../kafka/streams/tests/SmokeTestDriver.java       |   3 +-
 .../kafka/tools/ClientCompatibilityTest.java       |  11 +-
 .../apache/kafka/tools/ProducerPerformance.java    |   5 +-
 .../org/apache/kafka/tools/VerifiableConsumer.java |   5 +-
 .../kafka/tools/VerifiableLog4jAppender.java       |   5 +-
 .../org/apache/kafka/tools/VerifiableProducer.java |   5 +-
 64 files changed, 602 insertions(+), 231 deletions(-)
7b5bceeb4c58f4d236482228c2c82d8f80866293

 tests/kafkatest/services/verifiable_consumer.py   | 32 +++++++++++++++--------
 tests/kafkatest/services/verifiable_producer.py   |  6 ++++-
 tests/kafkatest/tests/client/consumer_test.py     |  6 +++--
 tests/kafkatest/tests/verifiable_consumer_test.py | 13 ++++++---
 4 files changed, 39 insertions(+), 18 deletions(-)
76550dd8956b07f24713f10992fc15aeedabe2c9

 tests/kafkatest/services/verifiable_consumer.py   | 32 +++++++++++++++--------
 tests/kafkatest/services/verifiable_producer.py   |  6 ++++-
 tests/kafkatest/tests/client/consumer_test.py     |  6 +++--
 tests/kafkatest/tests/verifiable_consumer_test.py | 13 ++++++---
 4 files changed, 39 insertions(+), 18 deletions(-)
dfd34aeb29d73551a6c91a65aeeadd85b79508a7

 docs/images/streams-concepts-topology.jpg | Bin 0 -> 136983 bytes
 docs/images/streams-table-duality-01.png  | Bin 0 -> 14534 bytes
 docs/images/streams-table-duality-02.png  | Bin 0 -> 56736 bytes
 docs/images/streams-table-duality-03.png  | Bin 0 -> 91331 bytes
 docs/images/streams-table-updates-01.png  | Bin 0 -> 78069 bytes
 docs/images/streams-table-updates-02.png  | Bin 0 -> 91880 bytes
 docs/js/templateData.js                   |   1 +
 docs/quickstart.html                      |  61 ++++++++--
 docs/streams.html                         | 189 ++++++++++++++++++++----------
 9 files changed, 181 insertions(+), 70 deletions(-)
c8baf28545984ef8c88d43899004224c6ef54013

 docs/images/streams-concepts-topology.jpg | Bin 0 -> 136983 bytes
 docs/images/streams-table-duality-01.png  | Bin 0 -> 14534 bytes
 docs/images/streams-table-duality-02.png  | Bin 0 -> 56736 bytes
 docs/images/streams-table-duality-03.png  | Bin 0 -> 91331 bytes
 docs/images/streams-table-updates-01.png  | Bin 0 -> 78069 bytes
 docs/images/streams-table-updates-02.png  | Bin 0 -> 91880 bytes
 docs/js/templateData.js                   |   1 +
 docs/quickstart.html                      |  61 ++++++++--
 docs/streams.html                         | 189 ++++++++++++++++++++----------
 9 files changed, 181 insertions(+), 70 deletions(-)
7436d28a243295ae7c8c3723e97ea43a10f2771c

 .../integration/KStreamRepartitionJoinTest.java    | 30 ++++++++--------------
 .../integration/utils/IntegrationTestUtils.java    | 23 +++++++++--------
 2 files changed, 24 insertions(+), 29 deletions(-)
35cd008e5a1ec89d09f956a6f9952ad834e556d7

 .../processor/internals/ProcessorTopologyTest.java | 88 ++++++++++++++++------
 1 file changed, 67 insertions(+), 21 deletions(-)
da70316a588172585a3960f2b0edb0e2d4ba5461

 .../internals/GlobalStreamThreadTest.java          | 36 ++++++++++++++++++++--
 1 file changed, 34 insertions(+), 2 deletions(-)
3e85f131e6af5d2ef34499d0b2aca7afca85d79c

 .../internals/ProcessorStateManagerTest.java       | 237 ++++++++++++++++++++-
 1 file changed, 231 insertions(+), 6 deletions(-)
063d534c5160316cdf22e476d128e872a1412783

 config/server.properties                             |  5 +++++
 core/src/main/scala/kafka/server/KafkaApis.scala     | 20 ++++++++++++--------
 core/src/main/scala/kafka/server/KafkaConfig.scala   |  5 +----
 core/src/test/scala/unit/kafka/utils/TestUtils.scala |  1 +
 docs/upgrade.html                                    |  1 +
 .../integration/utils/EmbeddedKafkaCluster.java      |  1 +
 .../services/kafka/templates/kafka.properties        |  1 +
 7 files changed, 22 insertions(+), 12 deletions(-)
c347a5e38e8e6547207e4abae4c0308d86101cff

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
3d9f34dd84a1c802b18874ba365c23713bfb189a

 .../java/org/apache/kafka/streams/state/internals/RocksDBStore.java     | 2 ++
 1 file changed, 2 insertions(+)
9cf6f9790abea84681285b17da1c5abd0c314915

 docs/api.html           | 14 +++++++-------
 docs/documentation.html |  4 ++--
 docs/quickstart.html    |  8 ++++----
 3 files changed, 13 insertions(+), 13 deletions(-)
cea46135338150e409e140b8b96856e060be8780

 docs/api.html           | 14 +++++++-------
 docs/documentation.html |  4 ++--
 docs/quickstart.html    |  8 ++++----
 3 files changed, 13 insertions(+), 13 deletions(-)
0b48ea1c81f22465cf32a19c012e0fb3c849afcc

 .../internals/StreamPartitionAssignor.java         |  34 +-
 .../streams/processor/internals/StreamThread.java  |  12 +-
 .../internals/assignment/ClientState.java          | 116 ++++-
 .../internals/assignment/StickyTaskAssignor.java   | 283 +++++++++++
 .../internals/assignment/TaskAssignor.java         | 208 +--------
 .../kstream/internals/KTableAggregateTest.java     |   5 +
 .../internals/StreamPartitionAssignorTest.java     |  20 +-
 .../processor/internals/StreamThreadTest.java      |   4 +-
 .../internals/assignment/ClientStateTest.java      | 151 ++++++
 .../assignment/StickyTaskAssignorTest.java         | 515 +++++++++++++++++++++
 .../internals/assignment/TaskAssignorTest.java     | 312 -------------
 11 files changed, 1085 insertions(+), 575 deletions(-)
850ceb74ca8bafc2c22735612feb67dc9c46fc36

 build.gradle | 42 +++++++++++++++++++++---------------------
 1 file changed, 21 insertions(+), 21 deletions(-)
54512cbaf7b624103cb1ad43bec455bbb0709c55

 build.gradle | 42 +++++++++++++++++++++---------------------
 1 file changed, 21 insertions(+), 21 deletions(-)
82744414d50d28a7bf7b0084118b68a4411c5781

 build.gradle | 42 +++++++++++++++++++++---------------------
 1 file changed, 21 insertions(+), 21 deletions(-)
a5063521943f8d0f6940b18d4f0d57045aa395ae

 .../org/apache/kafka/clients/NetworkClient.java    |  9 +++++
 .../kafka/clients/consumer/KafkaConsumer.java      |  8 ++---
 .../consumer/internals/AbstractCoordinator.java    | 33 ++++++++++-------
 .../consumer/internals/ConsumerCoordinator.java    | 41 +++++++++++++---------
 .../consumer/internals/ConsumerNetworkClient.java  |  9 ++---
 .../kafka/clients/consumer/internals/Fetcher.java  |  5 +--
 .../org/apache/kafka/common/utils/KafkaThread.java |  9 +++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  2 --
 .../internals/ConsumerCoordinatorTest.java         | 30 ++++++++--------
 9 files changed, 90 insertions(+), 56 deletions(-)
5afe959647fcad9d01365427f4b455e1586b1fd5

 .../org/apache/kafka/clients/NetworkClient.java    |  9 +++++
 .../kafka/clients/consumer/KafkaConsumer.java      |  8 ++---
 .../consumer/internals/AbstractCoordinator.java    | 33 ++++++++++-------
 .../consumer/internals/ConsumerCoordinator.java    | 41 +++++++++++++---------
 .../consumer/internals/ConsumerNetworkClient.java  |  9 ++---
 .../kafka/clients/consumer/internals/Fetcher.java  |  5 +--
 .../org/apache/kafka/common/utils/KafkaThread.java |  9 +++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  2 --
 .../internals/ConsumerCoordinatorTest.java         | 30 ++++++++--------
 9 files changed, 90 insertions(+), 56 deletions(-)
b948f43278e7641977c07df0069158a61fd3b443

 core/src/main/scala/kafka/tools/ConsoleProducer.scala | 1 +
 1 file changed, 1 insertion(+)
61024c9d2a2a1bc462a70d7c8af8ee7566716cc9

 .../apache/kafka/streams/kstream/KStreamBuilder.java  | 12 ++++++------
 .../java/org/apache/kafka/streams/kstream/KTable.java | 19 ++++++++++++-------
 2 files changed, 18 insertions(+), 13 deletions(-)
e108a8b4ed4512b021f9326cf079517523c83060

 .../apache/kafka/streams/kstream/KStreamBuilder.java  | 12 ++++++------
 .../java/org/apache/kafka/streams/kstream/KTable.java | 19 ++++++++++++-------
 2 files changed, 18 insertions(+), 13 deletions(-)
619a9b09e5d6b226881014c4e9579ee30c51f628

 .../org/apache/kafka/streams/kstream/KTable.java    | 21 ++++++++-------------
 .../streams/kstream/internals/KTableKTableJoin.java | 11 ++++-------
 .../kstream/internals/KTableKTableLeftJoin.java     | 11 ++++-------
 .../kstream/internals/KTableKTableOuterJoin.java    | 11 ++++-------
 .../kstream/internals/KTableKTableRightJoin.java    | 11 ++++-------
 .../streams/kstream/internals/KTableSource.java     |  5 ++---
 .../kstream/internals/KTableKTableJoinTest.java     |  8 ++++++++
 .../kstream/internals/KTableKTableLeftJoinTest.java |  4 ++++
 .../internals/KTableKTableOuterJoinTest.java        |  4 ++++
 9 files changed, 42 insertions(+), 44 deletions(-)
b559846f2f8151e41a6259e8a570b9422932c836

 .../org/apache/kafka/streams/kstream/KTable.java    | 21 ++++++++-------------
 .../streams/kstream/internals/KTableKTableJoin.java | 11 ++++-------
 .../kstream/internals/KTableKTableLeftJoin.java     | 11 ++++-------
 .../kstream/internals/KTableKTableOuterJoin.java    | 11 ++++-------
 .../kstream/internals/KTableKTableRightJoin.java    | 11 ++++-------
 .../streams/kstream/internals/KTableSource.java     |  5 ++---
 .../kstream/internals/KTableKTableJoinTest.java     |  8 ++++++++
 .../kstream/internals/KTableKTableLeftJoinTest.java |  4 ++++
 .../internals/KTableKTableOuterJoinTest.java        |  4 ++++
 9 files changed, 42 insertions(+), 44 deletions(-)
ba64b918af4c2363b0c6829d2a0f348096839255

 .../org/apache/kafka/streams/KafkaStreams.java     |  21 +-
 .../apache/kafka/streams/kstream/Aggregator.java   |   6 +-
 .../kafka/streams/kstream/ForeachAction.java       |   2 +-
 .../apache/kafka/streams/kstream/GlobalKTable.java |  18 +-
 .../apache/kafka/streams/kstream/Initializer.java  |   4 +-
 .../apache/kafka/streams/kstream/JoinWindows.java  |  10 +-
 .../kafka/streams/kstream/KGroupedStream.java      |   4 +-
 .../kafka/streams/kstream/KGroupedTable.java       |   4 +-
 .../org/apache/kafka/streams/kstream/KStream.java  | 274 ++++++++++-----------
 .../kafka/streams/kstream/KStreamBuilder.java      |   2 +-
 .../org/apache/kafka/streams/kstream/KTable.java   | 250 +++++++++----------
 .../kafka/streams/kstream/KeyValueMapper.java      |   4 +-
 .../apache/kafka/streams/kstream/Predicate.java    |   2 +-
 .../org/apache/kafka/streams/kstream/Reducer.java  |   4 +-
 .../kafka/streams/kstream/SessionWindows.java      |   6 +-
 .../apache/kafka/streams/kstream/TimeWindows.java  |   9 +-
 .../apache/kafka/streams/kstream/Transformer.java  |   4 +-
 .../kafka/streams/kstream/TransformerSupplier.java |   2 +-
 .../kafka/streams/kstream/UnlimitedWindows.java    |   4 +-
 .../apache/kafka/streams/kstream/ValueJoiner.java  |   2 +-
 .../apache/kafka/streams/kstream/ValueMapper.java  |   4 +-
 .../kafka/streams/kstream/ValueTransformer.java    |   6 +-
 .../streams/kstream/ValueTransformerSupplier.java  |   2 +-
 .../org/apache/kafka/streams/kstream/Window.java   |   6 +-
 .../org/apache/kafka/streams/kstream/Windowed.java |   2 +-
 25 files changed, 324 insertions(+), 328 deletions(-)
413444c0ec01ea51019df436cc1f2b664ac61e5a

 .../org/apache/kafka/streams/KafkaStreams.java     |  21 +-
 .../apache/kafka/streams/kstream/Aggregator.java   |   6 +-
 .../kafka/streams/kstream/ForeachAction.java       |   2 +-
 .../apache/kafka/streams/kstream/GlobalKTable.java |  18 +-
 .../apache/kafka/streams/kstream/Initializer.java  |   4 +-
 .../apache/kafka/streams/kstream/JoinWindows.java  |  10 +-
 .../kafka/streams/kstream/KGroupedStream.java      |   4 +-
 .../kafka/streams/kstream/KGroupedTable.java       |   4 +-
 .../org/apache/kafka/streams/kstream/KStream.java  | 274 ++++++++++-----------
 .../kafka/streams/kstream/KStreamBuilder.java      |   2 +-
 .../org/apache/kafka/streams/kstream/KTable.java   | 250 +++++++++----------
 .../kafka/streams/kstream/KeyValueMapper.java      |   4 +-
 .../apache/kafka/streams/kstream/Predicate.java    |   2 +-
 .../org/apache/kafka/streams/kstream/Reducer.java  |   4 +-
 .../kafka/streams/kstream/SessionWindows.java      |   6 +-
 .../apache/kafka/streams/kstream/TimeWindows.java  |   9 +-
 .../apache/kafka/streams/kstream/Transformer.java  |   4 +-
 .../kafka/streams/kstream/TransformerSupplier.java |   2 +-
 .../kafka/streams/kstream/UnlimitedWindows.java    |   4 +-
 .../apache/kafka/streams/kstream/ValueJoiner.java  |   2 +-
 .../apache/kafka/streams/kstream/ValueMapper.java  |   4 +-
 .../kafka/streams/kstream/ValueTransformer.java    |   6 +-
 .../streams/kstream/ValueTransformerSupplier.java  |   2 +-
 .../org/apache/kafka/streams/kstream/Window.java   |   6 +-
 .../org/apache/kafka/streams/kstream/Windowed.java |   2 +-
 25 files changed, 324 insertions(+), 328 deletions(-)
84323eea23aa8e1f2485b0ff43b3d316e7b0d06a

 .../main/java/org/apache/kafka/connect/connector/ConnectRecord.java    | 2 --
 .../src/main/java/org/apache/kafka/connect/connector/Connector.java    | 2 --
 .../main/java/org/apache/kafka/connect/connector/ConnectorContext.java | 3 ---
 connect/api/src/main/java/org/apache/kafka/connect/connector/Task.java | 3 ---
 .../main/java/org/apache/kafka/connect/errors/ConnectException.java    | 2 --
 .../api/src/main/java/org/apache/kafka/connect/sink/SinkConnector.java | 2 --
 .../api/src/main/java/org/apache/kafka/connect/sink/SinkRecord.java    | 2 --
 connect/api/src/main/java/org/apache/kafka/connect/sink/SinkTask.java  | 2 --
 .../src/main/java/org/apache/kafka/connect/sink/SinkTaskContext.java   | 2 --
 .../src/main/java/org/apache/kafka/connect/source/SourceConnector.java | 2 --
 .../src/main/java/org/apache/kafka/connect/source/SourceRecord.java    | 2 --
 .../api/src/main/java/org/apache/kafka/connect/source/SourceTask.java  | 2 --
 .../main/java/org/apache/kafka/connect/source/SourceTaskContext.java   | 2 --
 .../api/src/main/java/org/apache/kafka/connect/storage/Converter.java  | 2 --
 .../java/org/apache/kafka/connect/storage/OffsetStorageReader.java     | 3 ---
 .../src/main/java/org/apache/kafka/connect/util/ConnectorUtils.java    | 3 ---
 .../src/main/java/org/apache/kafka/connect/cli/ConnectDistributed.java | 2 --
 .../src/main/java/org/apache/kafka/connect/cli/ConnectStandalone.java  | 2 --
 .../src/main/java/org/apache/kafka/connect/runtime/Connect.java        | 2 --
 .../src/main/java/org/apache/kafka/connect/runtime/WorkerConfig.java   | 2 --
 20 files changed, 44 deletions(-)
1434b61d5d5511e5297d6ad81e2417db157986aa

 .../main/java/org/apache/kafka/connect/connector/ConnectRecord.java    | 2 --
 .../src/main/java/org/apache/kafka/connect/connector/Connector.java    | 2 --
 .../main/java/org/apache/kafka/connect/connector/ConnectorContext.java | 3 ---
 connect/api/src/main/java/org/apache/kafka/connect/connector/Task.java | 3 ---
 .../main/java/org/apache/kafka/connect/errors/ConnectException.java    | 2 --
 .../api/src/main/java/org/apache/kafka/connect/sink/SinkConnector.java | 2 --
 .../api/src/main/java/org/apache/kafka/connect/sink/SinkRecord.java    | 2 --
 connect/api/src/main/java/org/apache/kafka/connect/sink/SinkTask.java  | 2 --
 .../src/main/java/org/apache/kafka/connect/sink/SinkTaskContext.java   | 2 --
 .../src/main/java/org/apache/kafka/connect/source/SourceConnector.java | 2 --
 .../src/main/java/org/apache/kafka/connect/source/SourceRecord.java    | 2 --
 .../api/src/main/java/org/apache/kafka/connect/source/SourceTask.java  | 2 --
 .../main/java/org/apache/kafka/connect/source/SourceTaskContext.java   | 2 --
 .../api/src/main/java/org/apache/kafka/connect/storage/Converter.java  | 2 --
 .../java/org/apache/kafka/connect/storage/OffsetStorageReader.java     | 3 ---
 .../src/main/java/org/apache/kafka/connect/util/ConnectorUtils.java    | 3 ---
 .../src/main/java/org/apache/kafka/connect/cli/ConnectDistributed.java | 2 --
 .../src/main/java/org/apache/kafka/connect/cli/ConnectStandalone.java  | 2 --
 .../src/main/java/org/apache/kafka/connect/runtime/Connect.java        | 2 --
 .../src/main/java/org/apache/kafka/connect/runtime/WorkerConfig.java   | 2 --
 20 files changed, 44 deletions(-)
6cb76b95af8c00cdfb6d49401da7362744e72d64

 tests/docker/run_tests.sh                              |  4 ++--
 tests/kafkatest/__init__.py                            |  2 +-
 tests/kafkatest/benchmarks/core/benchmark_test.py      | 18 +++++++++---------
 tests/kafkatest/directory_layout/kafka_path.py         | 14 +++++++-------
 tests/kafkatest/sanity_checks/test_kafka_version.py    |  6 +++---
 .../sanity_checks/test_performance_services.py         |  6 +++---
 .../sanity_checks/test_verifiable_producer.py          | 16 ++++++++--------
 tests/kafkatest/services/console_consumer.py           |  4 ++--
 tests/kafkatest/services/kafka/kafka.py                |  4 ++--
 .../services/performance/consumer_performance.py       |  4 ++--
 .../services/performance/end_to_end_latency.py         |  4 ++--
 .../services/performance/producer_performance.py       | 12 ++++++------
 tests/kafkatest/services/security/minikdc.py           |  6 +++---
 tests/kafkatest/services/verifiable_consumer.py        |  4 ++--
 tests/kafkatest/services/verifiable_producer.py        | 10 +++++-----
 tests/kafkatest/services/zookeeper.py                  |  4 ++--
 .../tests/client/client_compatibility_features_test.py |  4 ++--
 .../client_compatibility_produce_consume_test.py       |  4 ++--
 .../tests/client/message_format_change_test.py         |  8 ++++----
 .../tests/core/compatibility_test_new_broker_test.py   | 17 +++++++++--------
 tests/kafkatest/tests/core/upgrade_test.py             | 11 +++++++----
 tests/kafkatest/version.py                             | 17 +++++++----------
 tests/unit/directory_layout/check_project_paths.py     | 14 +++++++-------
 tests/unit/version/check_version.py                    |  6 +++---
 .../apache/kafka/tools/VerifiableLog4jAppender.java    |  2 +-
 .../org/apache/kafka/tools/VerifiableProducer.java     |  2 +-
 vagrant/base.sh                                        |  6 +++---
 vagrant/broker.sh                                      |  2 +-
 vagrant/zk.sh                                          |  2 +-
 29 files changed, 107 insertions(+), 106 deletions(-)
6264cc155757216c878bcce48e02099a9f5a7d6f

 tests/docker/run_tests.sh                              |  4 ++--
 tests/kafkatest/__init__.py                            |  2 +-
 tests/kafkatest/benchmarks/core/benchmark_test.py      | 18 +++++++++---------
 tests/kafkatest/directory_layout/kafka_path.py         | 14 +++++++-------
 tests/kafkatest/sanity_checks/test_kafka_version.py    |  6 +++---
 .../sanity_checks/test_performance_services.py         |  6 +++---
 .../sanity_checks/test_verifiable_producer.py          | 16 ++++++++--------
 tests/kafkatest/services/console_consumer.py           |  4 ++--
 tests/kafkatest/services/kafka/kafka.py                |  4 ++--
 .../services/performance/consumer_performance.py       |  4 ++--
 .../services/performance/end_to_end_latency.py         |  4 ++--
 .../services/performance/producer_performance.py       | 12 ++++++------
 tests/kafkatest/services/security/minikdc.py           |  6 +++---
 tests/kafkatest/services/verifiable_consumer.py        |  4 ++--
 tests/kafkatest/services/verifiable_producer.py        | 10 +++++-----
 tests/kafkatest/services/zookeeper.py                  |  4 ++--
 .../tests/client/client_compatibility_features_test.py |  4 ++--
 .../client_compatibility_produce_consume_test.py       |  4 ++--
 .../tests/client/message_format_change_test.py         |  8 ++++----
 .../tests/core/compatibility_test_new_broker_test.py   | 17 +++++++++--------
 tests/kafkatest/tests/core/upgrade_test.py             | 11 +++++++----
 tests/kafkatest/version.py                             | 17 +++++++----------
 tests/unit/directory_layout/check_project_paths.py     | 14 +++++++-------
 tests/unit/version/check_version.py                    |  6 +++---
 .../apache/kafka/tools/VerifiableLog4jAppender.java    |  2 +-
 .../org/apache/kafka/tools/VerifiableProducer.java     |  2 +-
 vagrant/base.sh                                        |  6 +++---
 vagrant/broker.sh                                      |  2 +-
 vagrant/zk.sh                                          |  2 +-
 29 files changed, 107 insertions(+), 106 deletions(-)
6829d9615ab13d1314a73b77b6781e8daec18ea8

 .../org/apache/kafka/clients/NetworkClient.java    | 23 +++---
 .../org/apache/kafka/clients/NodeApiVersions.java  | 72 ++++++++++++-------
 .../kafka/clients/consumer/KafkaConsumer.java      |  9 ++-
 .../kafka/clients/consumer/OffsetAndTimestamp.java |  9 +--
 .../kafka/clients/consumer/internals/Fetcher.java  | 82 +++++++++++++++-------
 .../kafka/clients/producer/KafkaProducer.java      |  4 ++
 .../common/errors/ObsoleteBrokerException.java     | 31 --------
 .../kafka/common/requests/CreateTopicsRequest.java |  5 +-
 .../kafka/common/requests/ListOffsetRequest.java   |  6 +-
 .../kafka/common/requests/OffsetFetchRequest.java  |  5 +-
 .../apache/kafka/clients/NodeApiVersionsTest.java  | 29 +++++++-
 .../kafka/common/requests/RequestResponseTest.java |  4 +-
 .../kafka/tools/ClientCompatibilityTest.java       |  6 +-
 13 files changed, 171 insertions(+), 114 deletions(-)
8827a5b34ed2a2a570219fb8f29d955918867796

 .../org/apache/kafka/clients/NetworkClient.java    | 23 +++---
 .../org/apache/kafka/clients/NodeApiVersions.java  | 72 ++++++++++++-------
 .../kafka/clients/consumer/KafkaConsumer.java      |  9 ++-
 .../kafka/clients/consumer/OffsetAndTimestamp.java |  9 +--
 .../kafka/clients/consumer/internals/Fetcher.java  | 82 +++++++++++++++-------
 .../kafka/clients/producer/KafkaProducer.java      |  4 ++
 .../common/errors/ObsoleteBrokerException.java     | 31 --------
 .../kafka/common/requests/CreateTopicsRequest.java |  5 +-
 .../kafka/common/requests/ListOffsetRequest.java   |  6 +-
 .../kafka/common/requests/OffsetFetchRequest.java  |  5 +-
 .../apache/kafka/clients/NodeApiVersionsTest.java  | 29 +++++++-
 .../kafka/common/requests/RequestResponseTest.java |  4 +-
 .../kafka/tools/ClientCompatibilityTest.java       |  6 +-
 13 files changed, 171 insertions(+), 114 deletions(-)
903548f1a0f4365ae11315a4c36a5e80b90d1ff8

 .../apache/kafka/streams/KafkaClientSupplier.java  |  42 +-
 .../org/apache/kafka/streams/KafkaStreams.java     | 393 ++++++++-----
 .../java/org/apache/kafka/streams/KeyValue.java    |  30 +-
 .../org/apache/kafka/streams/StreamsConfig.java    | 648 +++++++++++----------
 .../org/apache/kafka/streams/StreamsMetrics.java   | 116 ++--
 .../kafka/streams/kstream/KGroupedStream.java      |   6 +-
 .../kafka/streams/kstream/KStreamBuilder.java      | 483 ++++++++++-----
 .../processor/WallclockTimestampExtractor.java     |   1 +
 .../processor/internals/StreamsKafkaClient.java    |  12 +-
 .../integration/GlobalKTableIntegrationTest.java   |   1 -
 .../streams/integration/JoinIntegrationTest.java   |   1 -
 .../KTableKTableJoinIntegrationTest.java           |   1 -
 12 files changed, 1043 insertions(+), 691 deletions(-)
4c42654b1eecebae272dfe5ce018b85ad4db7709

 .../apache/kafka/streams/KafkaClientSupplier.java  |  42 +-
 .../org/apache/kafka/streams/KafkaStreams.java     | 393 ++++++++-----
 .../java/org/apache/kafka/streams/KeyValue.java    |  30 +-
 .../org/apache/kafka/streams/StreamsConfig.java    | 648 +++++++++++----------
 .../org/apache/kafka/streams/StreamsMetrics.java   | 116 ++--
 .../kafka/streams/kstream/KGroupedStream.java      |   6 +-
 .../kafka/streams/kstream/KStreamBuilder.java      | 483 ++++++++++-----
 .../processor/WallclockTimestampExtractor.java     |   1 +
 .../processor/internals/StreamsKafkaClient.java    |  12 +-
 .../integration/GlobalKTableIntegrationTest.java   |   1 -
 .../streams/integration/JoinIntegrationTest.java   |   1 -
 .../KTableKTableJoinIntegrationTest.java           |   1 -
 12 files changed, 1043 insertions(+), 691 deletions(-)
05b1ebd9ea6ca36a77269c71d598a7f613b277ba

 .../producer/internals/RecordAccumulator.java      | 13 ++++--
 .../clients/producer/internals/RecordBatch.java    | 48 ++++++++++++++--------
 .../producer/internals/RecordAccumulatorTest.java  | 45 ++++++++++++++++++++
 3 files changed, 85 insertions(+), 21 deletions(-)
aef6927a42cde193dd6acc36cd4d9f32167da622

 .../producer/internals/RecordAccumulator.java      | 13 ++++--
 .../clients/producer/internals/RecordBatch.java    | 48 ++++++++++++++--------
 .../producer/internals/RecordAccumulatorTest.java  | 45 ++++++++++++++++++++
 3 files changed, 85 insertions(+), 21 deletions(-)
6ba7470ed1cf34ba36401586a479d79ded0772fc

 NOTICE | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b81f311bcc915a3a27643c64e04786862a345646

 NOTICE | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1b964396b88b3d6eea3148fe7c8b4b870910cd8b

 NOTICE | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f0f5c345446fc7eb47c0acf48a862b501c6aaa4b

 docs/protocol.html | 25 ++++++++++++-------------
 1 file changed, 12 insertions(+), 13 deletions(-)
4a14adbb63205e052b7620420b306e29320a4343

 docs/protocol.html | 25 ++++++++++++-------------
 1 file changed, 12 insertions(+), 13 deletions(-)
f328f77fd359c7fbb9e14ca31f8986c6a21af481

 .../scala/kafka/coordinator/GroupCoordinator.scala |   2 +-
 .../scala/kafka/coordinator/GroupMetadata.scala    |   6 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 220 +++++++++++----------
 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  44 ++---
 .../main/scala/kafka/server/ReplicaManager.scala   |  12 +-
 .../coordinator/GroupMetadataManagerTest.scala     | 215 ++++++++++++++++++--
 .../unit/kafka/coordinator/GroupMetadataTest.scala |  16 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |   3 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   5 +
 10 files changed, 358 insertions(+), 167 deletions(-)
57f0cb29973bb40e76ed6deb64b934b4b2e0592a

 .../scala/kafka/coordinator/GroupCoordinator.scala |   2 +-
 .../scala/kafka/coordinator/GroupMetadata.scala    |   6 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 220 +++++++++++----------
 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  44 ++---
 .../main/scala/kafka/server/ReplicaManager.scala   |  12 +-
 .../coordinator/GroupMetadataManagerTest.scala     | 215 ++++++++++++++++++--
 .../unit/kafka/coordinator/GroupMetadataTest.scala |  16 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |   3 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   5 +
 10 files changed, 358 insertions(+), 167 deletions(-)
063fe5e8b0e568ea62e13369c94720e3d315fe47

 .../kafka/common/network/ByteBufferReceive.java    |  4 +--
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 31 +++++++++++-----------
 .../kstream/internals/KTableKTableJoinTest.java    | 16 +++++------
 3 files changed, 26 insertions(+), 25 deletions(-)
9213de8f14dfd2754d913667ae9a703f76277022

 .../kafka/common/network/ByteBufferReceive.java    |  4 +--
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 31 +++++++++++-----------
 .../kstream/internals/KTableKTableJoinTest.java    | 16 +++++------
 3 files changed, 26 insertions(+), 25 deletions(-)
634c167348e9548ed2ef87239fbd5d881fa019e7

 .../internals/StreamPartitionAssignor.java         | 109 ++++++++--------
 .../CopartitionedTopicsValidatorTest.java          | 137 +++++++++++++++++++++
 .../internals/StreamPartitionAssignorTest.java     | 128 ++++++-------------
 3 files changed, 237 insertions(+), 137 deletions(-)
662c2f893c95128a9d5033f730f1538d368fd151

 .../internals/StreamPartitionAssignor.java         | 109 ++++++++--------
 .../CopartitionedTopicsValidatorTest.java          | 137 +++++++++++++++++++++
 .../internals/StreamPartitionAssignorTest.java     | 128 ++++++-------------
 3 files changed, 237 insertions(+), 137 deletions(-)
e992aca9eda38d8dfbf9488eadcc1b58b9998e99

 .../apache/kafka/streams/kstream/GlobalKTable.java |  51 +-
 .../kafka/streams/kstream/KGroupedStream.java      | 377 ++++----
 .../kafka/streams/kstream/KGroupedTable.java       | 539 ++++++++++--
 .../org/apache/kafka/streams/kstream/KStream.java  |  37 +-
 .../org/apache/kafka/streams/kstream/KTable.java   | 972 +++++++++++++++------
 5 files changed, 1434 insertions(+), 542 deletions(-)
1bd11b23ab55b25d5669813f47ad1d5670c6ec9c

 .../apache/kafka/streams/kstream/GlobalKTable.java |  51 +-
 .../kafka/streams/kstream/KGroupedStream.java      | 377 ++++----
 .../kafka/streams/kstream/KGroupedTable.java       | 539 ++++++++++--
 .../org/apache/kafka/streams/kstream/KStream.java  |  37 +-
 .../org/apache/kafka/streams/kstream/KTable.java   | 972 +++++++++++++++------
 5 files changed, 1434 insertions(+), 542 deletions(-)
02a516f125c2320eca8e98f7a587ad4b9f1f3c2a

 .../src/main/java/org/apache/kafka/common/config/ConfigDef.java   | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
ec76ea343616df27ae2a4e42f5078e081d5878e2

 .../src/main/java/org/apache/kafka/common/config/ConfigDef.java   | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
fcdfe8e98db3ad1f490f954162dc299c95de07c2

 docs/upgrade.html | 62 ++++++++++++++++++++++++++++++++++++++++++++++---------
 1 file changed, 52 insertions(+), 10 deletions(-)
1956b462527972217447c5e2a5743df8547451c1

 docs/upgrade.html | 62 ++++++++++++++++++++++++++++++++++++++++++++++---------
 1 file changed, 52 insertions(+), 10 deletions(-)
a2a3e9dd81fb04d9f8c784d765426a0f750040b7

 .../apache/kafka/streams/kstream/JoinWindows.java  |   5 +-
 .../kafka/streams/kstream/KGroupedStream.java      | 101 ++--
 .../org/apache/kafka/streams/kstream/KStream.java  | 628 +++++++++++----------
 .../kafka/streams/kstream/KeyValueMapper.java      |  10 +-
 .../apache/kafka/streams/kstream/Predicate.java    |   7 +-
 .../org/apache/kafka/streams/kstream/Reducer.java  |   6 +-
 .../kafka/streams/kstream/SessionWindows.java      |   3 +-
 .../apache/kafka/streams/kstream/TimeWindows.java  |   5 +-
 .../kafka/streams/kstream/UnlimitedWindows.java    |   5 +-
 .../org/apache/kafka/streams/kstream/Window.java   |   5 +-
 .../org/apache/kafka/streams/kstream/Windows.java  |   5 +-
 11 files changed, 396 insertions(+), 384 deletions(-)
4277645d25e3be0276cb443a36c7ebaa0638034c

 .../apache/kafka/streams/kstream/JoinWindows.java  |   5 +-
 .../kafka/streams/kstream/KGroupedStream.java      | 101 ++--
 .../org/apache/kafka/streams/kstream/KStream.java  | 628 +++++++++++----------
 .../kafka/streams/kstream/KeyValueMapper.java      |  10 +-
 .../apache/kafka/streams/kstream/Predicate.java    |   7 +-
 .../org/apache/kafka/streams/kstream/Reducer.java  |   6 +-
 .../kafka/streams/kstream/SessionWindows.java      |   3 +-
 .../apache/kafka/streams/kstream/TimeWindows.java  |   5 +-
 .../kafka/streams/kstream/UnlimitedWindows.java    |   5 +-
 .../org/apache/kafka/streams/kstream/Window.java   |   5 +-
 .../org/apache/kafka/streams/kstream/Windows.java  |   5 +-
 11 files changed, 396 insertions(+), 384 deletions(-)
890b4ac6abe2a927e3273773cb119ba516f4971e

 .../org/apache/kafka/streams/KafkaStreams.java     |  21 +++-
 .../processor/internals/InternalTopicManager.java  |   2 +-
 .../processor/internals/StreamsKafkaClient.java    | 101 ++++++++++++++-----
 .../streams/tests/BrokerCompatibilityTest.java     | 110 +++++++++++++++++++++
 tests/kafkatest/services/streams.py                |   8 ++
 .../tests/streams/streams_broker_compatibility.py  |  90 +++++++++++++++++
 6 files changed, 304 insertions(+), 28 deletions(-)
89fb02aa81fe67f5a506f579e463f30f3020dee5

 .../org/apache/kafka/streams/KafkaStreams.java     |  21 +++-
 .../processor/internals/InternalTopicManager.java  |   2 +-
 .../processor/internals/StreamsKafkaClient.java    | 101 ++++++++++++++-----
 .../streams/tests/BrokerCompatibilityTest.java     | 110 +++++++++++++++++++++
 tests/kafkatest/services/streams.py                |   8 ++
 .../tests/streams/streams_broker_compatibility.py  |  90 +++++++++++++++++
 6 files changed, 304 insertions(+), 28 deletions(-)
b2bcef7f35650088d3ca8882be7c49186b6a27cc

 .../src/main/scala/kafka/server/AdminManager.scala |  1 +
 .../server/CreateTopicsRequestWithPolicyTest.scala | 49 ++++++++++++++++++----
 2 files changed, 42 insertions(+), 8 deletions(-)
2f9e9195abada7c2bcbd41147cb9d4c00f3a712d

 .../src/main/scala/kafka/server/AdminManager.scala |  1 +
 .../server/CreateTopicsRequestWithPolicyTest.scala | 49 ++++++++++++++++++----
 2 files changed, 42 insertions(+), 8 deletions(-)
5f1ab1419ef20a3da6cc1fd3e4542a3d77be8a10

 .../org/apache/kafka/streams/kstream/KStream.java  | 20 +++--
 .../kafka/streams/kstream/KeyValueMapper.java      |  3 +-
 .../org/apache/kafka/streams/kstream/Merger.java   |  2 +-
 .../apache/kafka/streams/kstream/Transformer.java  | 76 +++++++++++++++----
 .../kafka/streams/kstream/TransformerSupplier.java | 15 +++-
 .../apache/kafka/streams/kstream/ValueMapper.java  |  7 +-
 .../kafka/streams/kstream/ValueTransformer.java    | 86 +++++++++++++++++-----
 .../streams/kstream/ValueTransformerSupplier.java  | 18 ++++-
 8 files changed, 180 insertions(+), 47 deletions(-)
a01b72236926d2bcc52dd7d0378147f8fae8117d

 .../org/apache/kafka/streams/kstream/KStream.java  | 20 +++--
 .../kafka/streams/kstream/KeyValueMapper.java      |  3 +-
 .../org/apache/kafka/streams/kstream/Merger.java   |  2 +-
 .../apache/kafka/streams/kstream/Transformer.java  | 76 +++++++++++++++----
 .../kafka/streams/kstream/TransformerSupplier.java | 15 +++-
 .../apache/kafka/streams/kstream/ValueMapper.java  |  7 +-
 .../kafka/streams/kstream/ValueTransformer.java    | 86 +++++++++++++++++-----
 .../streams/kstream/ValueTransformerSupplier.java  | 18 ++++-
 8 files changed, 180 insertions(+), 47 deletions(-)
ca0c071c108c9fd31a759e1cd1c4f89bdc5ac47e

 .../java/org/apache/kafka/clients/ClientUtils.java |  15 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +-
 .../kafka/clients/producer/KafkaProducer.java      |   2 +-
 .../apache/kafka/common/config/AbstractConfig.java |  48 +++-
 .../org/apache/kafka/common/config/ConfigDef.java  |  38 +--
 .../kafka/common/network/ChannelBuilders.java      |  56 ++--
 .../apache/kafka/common/network/ListenerName.java  |   6 +
 .../org/apache/kafka/common/network/LoginType.java |  39 ---
 .../java/org/apache/kafka/common/network/Mode.java |   3 +
 .../kafka/common/network/SaslChannelBuilder.java   |  48 +++-
 .../apache/kafka/common/security/JaasConfig.java   |   7 +-
 .../apache/kafka/common/security/JaasContext.java  | 190 +++++++++++++
 .../apache/kafka/common/security/JaasUtils.java    | 111 --------
 .../security/auth/DefaultPrincipalBuilder.java     |   1 -
 .../apache/kafka/common/security/auth/Login.java   |   5 +-
 .../security/authenticator/AbstractLogin.java      |  17 +-
 .../security/authenticator/LoginManager.java       |  54 ++--
 .../authenticator/SaslClientCallbackHandler.java   |   2 +-
 .../authenticator/SaslServerAuthenticator.java     |  10 +-
 .../authenticator/SaslServerCallbackHandler.java   |  15 +-
 .../common/security/kerberos/KerberosLogin.java    |  44 +--
 .../common/security/plain/PlainSaslServer.java     |  29 +-
 .../security/scram/ScramServerCallbackHandler.java |   2 +-
 .../kafka/common/config/AbstractConfigTest.java    |  58 ++++
 .../kafka/common/network/NetworkTestUtils.java     |   9 +-
 .../apache/kafka/common/network/NioEchoServer.java |  10 +-
 .../common/network/SslTransportLayerTest.java      |  94 +++++--
 .../kafka/common/security/JaasContextTest.java     | 308 +++++++++++++++++++++
 .../kafka/common/security/JaasUtilsTest.java       | 255 -----------------
 .../kafka/common/security/TestSecurityConfig.java  |  38 +++
 .../authenticator/SaslAuthenticatorTest.java       | 133 ++++++---
 .../security/authenticator/TestJaasConfig.java     |  10 +-
 .../java/org/apache/kafka/test/TestSslUtils.java   |   2 +-
 .../runtime/distributed/WorkerGroupMember.java     |   2 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |   2 +-
 .../controller/ControllerChannelManager.scala      |   8 +-
 .../main/scala/kafka/network/SocketServer.scala    |   8 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  13 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   8 +-
 .../kafka/api/IntegrationTestHarness.scala         |   6 +
 .../kafka/api/SaslEndToEndAuthorizationTest.scala  |   7 +-
 .../kafka/api/SaslPlainPlaintextConsumerTest.scala |   7 +
 .../scala/integration/kafka/api/SaslSetup.scala    |  18 +-
 .../integration/kafka/api/SaslTestHarness.scala    |   6 +-
 .../kafka/api/SslEndToEndAuthorizationTest.scala   |   2 +-
 ...ipleListenersWithSameSecurityProtocolTest.scala |  10 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   2 +-
 .../unit/kafka/network/SocketServerTest.scala      |   2 +-
 .../scala/unit/kafka/utils/JaasTestUtils.scala     |  20 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   2 +-
 .../processor/internals/StreamsKafkaClient.java    |   2 +-
 51 files changed, 1087 insertions(+), 699 deletions(-)
af4f4df1898109857c2da2b718c68ad8ebd501a3

 .../apache/kafka/streams/processor/internals/StreamsMetricsImpl.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1eac3f33f5de3490046203a8e408970da161b84e

 .../apache/kafka/streams/processor/internals/StreamsMetricsImpl.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f68c7e0f3fa005ac1476a1593067a365fe58dd73

 docs/quickstart.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
0c83eddcda8ed1b483a869f0915815204e3faade

 docs/quickstart.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
4f61359318f2e7c25ec46d99fd134cf61de28a93

 .../org/apache/kafka/streams/StreamsConfig.java    |  7 ++++
 .../processor/internals/StreamsKafkaClient.java    | 23 +++++++++++-
 .../internals/StreamsKafkaClientTest.java          | 42 ++++++++++++++++++++++
 3 files changed, 71 insertions(+), 1 deletion(-)
31716590454e1bdd53a65836741f316bf4715c9d

 .../org/apache/kafka/streams/StreamsConfig.java    |  7 ++++
 .../processor/internals/StreamsKafkaClient.java    | 23 +++++++++++-
 .../internals/StreamsKafkaClientTest.java          | 42 ++++++++++++++++++++++
 3 files changed, 71 insertions(+), 1 deletion(-)
1f4f9c74c1a42bb9ef84e5ef45a7fe175302e73b

 bin/windows/kafka-run-class.bat | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)
dc4d1bb81b37908725e3bcefd21bade9c2297ebd

 bin/windows/kafka-run-class.bat | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)
e2cc88602fb49f36feec21e965d185d5c3c52d4d

 .../scala/kafka/coordinator/GroupMetadata.scala    | 15 ++--
 .../kafka/coordinator/GroupMetadataManager.scala   | 96 ++++++++++------------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  4 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  1 -
 4 files changed, 55 insertions(+), 61 deletions(-)
8301cc608e0e3c334da96b546bf6d943a1704024

 .../scala/kafka/coordinator/GroupMetadata.scala    | 15 ++--
 .../kafka/coordinator/GroupMetadataManager.scala   | 96 ++++++++++------------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  4 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  1 -
 4 files changed, 55 insertions(+), 61 deletions(-)
29bc8905acea32c8a34b889edb17107132b80037

 .../kafka/clients/producer/MockProducer.java       |  3 ++-
 .../producer/internals/ProduceRequestResult.java   | 14 ++++++++++---
 .../clients/producer/internals/RecordBatch.java    |  5 +++--
 .../kafka/clients/producer/RecordSendTest.java     |  6 ++++--
 .../runtime/SourceTaskOffsetCommitterTest.java     |  2 +-
 .../kafka/api/PlaintextConsumerTest.scala          | 24 +++++++++++-----------
 6 files changed, 33 insertions(+), 21 deletions(-)
254e3b77d656a610f19efd1124802e073dfda4b8

 .../kafka/clients/producer/MockProducer.java       |  3 ++-
 .../producer/internals/ProduceRequestResult.java   | 14 ++++++++++---
 .../clients/producer/internals/RecordBatch.java    |  5 +++--
 .../kafka/clients/producer/RecordSendTest.java     |  6 ++++--
 .../runtime/SourceTaskOffsetCommitterTest.java     |  2 +-
 .../kafka/api/PlaintextConsumerTest.scala          | 24 +++++++++++-----------
 6 files changed, 33 insertions(+), 21 deletions(-)
8812d151a9cb7d3a71fdb7c170a661ebf5214358

 .../org/apache/kafka/clients/NodeApiVersions.java  | 37 ++++++++++
 .../kafka/clients/consumer/internals/Fetcher.java  | 82 ++++++++++++----------
 .../apache/kafka/common/requests/FetchRequest.java |  1 +
 .../kafka/common/requests/FetchResponse.java       |  6 ++
 .../java/org/apache/kafka/clients/MockClient.java  |  7 +-
 .../apache/kafka/clients/NodeApiVersionsTest.java  |  3 +-
 .../clients/consumer/internals/FetcherTest.java    | 58 +++++++++++++++
 .../kafka/admin/BrokerApiVersionsCommandTest.scala |  2 +-
 .../client/client_compatibility_features_test.py   |  4 ++
 .../kafka/tools/ClientCompatibilityTest.java       | 62 ++++++++++------
 10 files changed, 198 insertions(+), 64 deletions(-)
5b4e299a46a8ee92e450c54880408713606e4f52

 .../org/apache/kafka/clients/NodeApiVersions.java  | 37 ++++++++++
 .../kafka/clients/consumer/internals/Fetcher.java  | 82 ++++++++++++----------
 .../apache/kafka/common/requests/FetchRequest.java |  1 +
 .../kafka/common/requests/FetchResponse.java       |  6 ++
 .../java/org/apache/kafka/clients/MockClient.java  |  7 +-
 .../apache/kafka/clients/NodeApiVersionsTest.java  |  3 +-
 .../clients/consumer/internals/FetcherTest.java    | 58 +++++++++++++++
 .../kafka/admin/BrokerApiVersionsCommandTest.scala |  2 +-
 .../client/client_compatibility_features_test.py   |  4 ++
 .../kafka/tools/ClientCompatibilityTest.java       | 62 ++++++++++------
 10 files changed, 198 insertions(+), 64 deletions(-)
d8f9e18aa0f16b97e71719ca5983f8ff39134a4a

 .../consumer/ConsumerRebalanceListener.java        |   4 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +-
 .../kafka/clients/consumer/MockConsumer.java       |   3 +-
 .../consumer/internals/ConsumerCoordinator.java    |   2 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 107 +++++++++++----------
 .../consumer/internals/SubscriptionState.java      |  62 +++++++-----
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   2 +-
 .../internals/ConsumerCoordinatorTest.java         |   2 +-
 .../clients/consumer/internals/FetcherTest.java    |  16 ++-
 .../consumer/internals/SubscriptionStateTest.java  |  44 ++++++---
 .../integration/kafka/api/BaseConsumerTest.scala   | 101 +------------------
 .../kafka/api/PlaintextConsumerTest.scala          | 102 +++++++++++++++++++-
 12 files changed, 250 insertions(+), 197 deletions(-)
135488352cbe646334a274418d7014a91e92057f

 .../consumer/ConsumerRebalanceListener.java        |   4 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +-
 .../kafka/clients/consumer/MockConsumer.java       |   3 +-
 .../consumer/internals/ConsumerCoordinator.java    |   2 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 107 +++++++++++----------
 .../consumer/internals/SubscriptionState.java      |  62 +++++++-----
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   2 +-
 .../internals/ConsumerCoordinatorTest.java         |   2 +-
 .../clients/consumer/internals/FetcherTest.java    |  16 ++-
 .../consumer/internals/SubscriptionStateTest.java  |  44 ++++++---
 .../integration/kafka/api/BaseConsumerTest.scala   | 101 +------------------
 .../kafka/api/PlaintextConsumerTest.scala          | 102 +++++++++++++++++++-
 12 files changed, 250 insertions(+), 197 deletions(-)
6493e5d8dbafb84dc9502b56ba651049dca7d72d

 .../apache/kafka/streams/examples/wordcount/WordCountProcessorDemo.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
51e745ef30c777009c2d1f75965e63a3fe7bb474

 .../apache/kafka/streams/examples/wordcount/WordCountProcessorDemo.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d54855a481da9b98d5abc413f57927d0bc2546d2

 .../java/org/apache/kafka/streams/examples/wordcount/WordCountDemo.java | 2 ++
 1 file changed, 2 insertions(+)
9a7032720f4600099b130a0bb7b578cedc83e5ff

 .../java/org/apache/kafka/streams/examples/wordcount/WordCountDemo.java | 2 ++
 1 file changed, 2 insertions(+)
47154d804e687b021dc16661fc28b27a2fc6c34d

 bin/windows/kafka-configs.bat | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
e9426291aa989ac2624905b844724eeffa608773

 bin/windows/kafka-configs.bat | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
e74a924638d6bf17bf1cdae5a42c7a4d3dc527ca

 .../kafka/clients/producer/MockProducer.java       | 13 ++---
 .../producer/internals/FutureRecordMetadata.java   | 38 +++++----------
 .../producer/internals/ProduceRequestResult.java   | 37 ++++++++++++---
 .../clients/producer/internals/RecordBatch.java    | 55 ++++++++++------------
 .../kafka/clients/producer/internals/Sender.java   | 25 +++++-----
 .../org/apache/kafka/common/protocol/Protocol.java |  2 +-
 .../kafka/common/requests/ProduceRequest.java      |  7 ++-
 .../kafka/common/requests/ProduceResponse.java     | 36 ++++++++------
 .../kafka/clients/producer/KafkaProducerTest.java  | 15 ++++++
 .../kafka/clients/producer/RecordSendTest.java     | 18 ++++---
 .../clients/producer/internals/SenderTest.java     |  3 +-
 .../kafka/common/requests/RequestResponseTest.java |  6 ++-
 .../kafka/coordinator/GroupMetadataManager.scala   | 18 ++++---
 .../src/main/scala/kafka/server/DelayedFetch.scala |  2 +-
 .../main/scala/kafka/server/DelayedProduce.scala   |  8 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 14 +++---
 .../main/scala/kafka/server/ReplicaManager.scala   | 41 ++++++++--------
 .../kafka/api/AuthorizerIntegrationTest.scala      |  2 +-
 .../kafka/api/BaseProducerSendTest.scala           | 23 +++++----
 .../kafka/api/PlaintextProducerSendTest.scala      | 54 ++++-----------------
 .../coordinator/GroupCoordinatorResponseTest.scala |  4 +-
 .../coordinator/GroupMetadataManagerTest.scala     |  2 +-
 .../unit/kafka/server/EdgeCaseRequestTest.scala    |  4 +-
 .../unit/kafka/server/ProduceRequestTest.scala     |  8 ++--
 .../unit/kafka/server/ReplicaManagerTest.scala     | 10 ++--
 25 files changed, 217 insertions(+), 228 deletions(-)
8b3c6c0a1c1bb8f098a7013dbf9c2cb97720e106

 .../kafka/clients/producer/MockProducer.java       | 13 ++---
 .../producer/internals/FutureRecordMetadata.java   | 38 +++++----------
 .../producer/internals/ProduceRequestResult.java   | 37 ++++++++++++---
 .../clients/producer/internals/RecordBatch.java    | 55 ++++++++++------------
 .../kafka/clients/producer/internals/Sender.java   | 25 +++++-----
 .../org/apache/kafka/common/protocol/Protocol.java |  2 +-
 .../kafka/common/requests/ProduceRequest.java      |  7 ++-
 .../kafka/common/requests/ProduceResponse.java     | 36 ++++++++------
 .../kafka/clients/producer/KafkaProducerTest.java  | 15 ++++++
 .../kafka/clients/producer/RecordSendTest.java     | 18 ++++---
 .../clients/producer/internals/SenderTest.java     |  3 +-
 .../kafka/common/requests/RequestResponseTest.java |  6 ++-
 .../kafka/coordinator/GroupMetadataManager.scala   | 18 ++++---
 .../src/main/scala/kafka/server/DelayedFetch.scala |  2 +-
 .../main/scala/kafka/server/DelayedProduce.scala   |  8 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 14 +++---
 .../main/scala/kafka/server/ReplicaManager.scala   | 41 ++++++++--------
 .../kafka/api/AuthorizerIntegrationTest.scala      |  2 +-
 .../kafka/api/BaseProducerSendTest.scala           | 23 +++++----
 .../kafka/api/PlaintextProducerSendTest.scala      | 54 ++++-----------------
 .../coordinator/GroupCoordinatorResponseTest.scala |  4 +-
 .../coordinator/GroupMetadataManagerTest.scala     |  2 +-
 .../unit/kafka/server/EdgeCaseRequestTest.scala    |  4 +-
 .../unit/kafka/server/ProduceRequestTest.scala     |  8 ++--
 .../unit/kafka/server/ReplicaManagerTest.scala     | 10 ++--
 25 files changed, 217 insertions(+), 228 deletions(-)
94c0da2b7946569b3da7c5fcc49157e3283b2be3

 build.gradle | 1 -
 1 file changed, 1 deletion(-)
23f6951961060ad9a07b42f392470a227269e65a

 build.gradle | 1 -
 1 file changed, 1 deletion(-)
1d2426683b0dba7f57d064b9ed0ddcf1c9c25c3c

 .../org/apache/kafka/streams/StreamsMetrics.java   | 16 +++---
 .../streams/processor/internals/ProcessorNode.java | 17 +++----
 .../streams/processor/internals/SourceNode.java    |  2 +-
 .../streams/processor/internals/StreamTask.java    |  2 +-
 .../streams/processor/internals/StreamThread.java  | 58 +++++++++++-----------
 .../processor/internals/StreamsMetricsImpl.java    |  8 +--
 .../state/internals/MeteredKeyValueStore.java      | 18 +++----
 .../internals/MeteredSegmentedBytesStore.java      | 12 ++---
 .../processor/internals/ProcessorNodeTest.java     | 10 ++--
 .../processor/internals/StreamTaskTest.java        |  6 +--
 .../processor/internals/StreamThreadTest.java      | 42 ++++++++--------
 .../internals/StreamsMetricsImplTest.java          |  4 +-
 .../internals/MeteredSegmentedBytesStoreTest.java  |  2 +-
 13 files changed, 99 insertions(+), 98 deletions(-)
0971e62e50b94a74aae170fb49d1e532e39b2136

 .../org/apache/kafka/streams/StreamsMetrics.java   | 16 +++---
 .../streams/processor/internals/ProcessorNode.java | 17 +++----
 .../streams/processor/internals/SourceNode.java    |  2 +-
 .../streams/processor/internals/StreamTask.java    |  2 +-
 .../streams/processor/internals/StreamThread.java  | 58 +++++++++++-----------
 .../processor/internals/StreamsMetricsImpl.java    |  8 +--
 .../state/internals/MeteredKeyValueStore.java      | 18 +++----
 .../internals/MeteredSegmentedBytesStore.java      | 12 ++---
 .../processor/internals/ProcessorNodeTest.java     | 10 ++--
 .../processor/internals/StreamTaskTest.java        |  6 +--
 .../processor/internals/StreamThreadTest.java      | 42 ++++++++--------
 .../internals/StreamsMetricsImplTest.java          |  4 +-
 .../internals/MeteredSegmentedBytesStoreTest.java  |  2 +-
 13 files changed, 99 insertions(+), 98 deletions(-)
ec3975978582dfec63986b67c38d6e3bb7742f81

 .../state/internals/CachingKeyValueStore.java      | 26 +++++++--------
 .../state/internals/CachingSessionStore.java       | 16 +++++-----
 .../streams/state/internals/RocksDBStore.java      |  1 +
 .../kstream/internals/GlobalKTableJoinsTest.java   | 19 ++++++++---
 .../kstream/internals/KGroupedStreamImplTest.java  | 37 ++++++++++++----------
 .../kstream/internals/KGroupedTableImplTest.java   | 27 +++++++++-------
 .../kstream/internals/KTableAggregateTest.java     |  8 ++---
 .../internals/KTableKTableLeftJoinTest.java        |  5 ++-
 .../internals/KeyValuePrinterProcessorTest.java    | 10 +++---
 .../org/apache/kafka/test/KStreamTestDriver.java   |  5 ++-
 10 files changed, 87 insertions(+), 67 deletions(-)
2ca3e59bb6054cc8ecf6926a74859efe3df000ba

 .../state/internals/CachingKeyValueStore.java      | 26 +++++++--------
 .../state/internals/CachingSessionStore.java       | 16 +++++-----
 .../streams/state/internals/RocksDBStore.java      |  1 +
 .../kstream/internals/GlobalKTableJoinsTest.java   | 19 ++++++++---
 .../kstream/internals/KGroupedStreamImplTest.java  | 37 ++++++++++++----------
 .../kstream/internals/KGroupedTableImplTest.java   | 27 +++++++++-------
 .../kstream/internals/KTableAggregateTest.java     |  8 ++---
 .../internals/KTableKTableLeftJoinTest.java        |  5 ++-
 .../internals/KeyValuePrinterProcessorTest.java    | 10 +++---
 .../org/apache/kafka/test/KStreamTestDriver.java   |  5 ++-
 10 files changed, 87 insertions(+), 67 deletions(-)
b0742c2024c3c07f8b2d7f9a7c77fa2b7c9e228f

 .../scala/kafka/coordinator/GroupCoordinator.scala |  4 +++
 .../scala/kafka/coordinator/GroupMetadata.scala    | 21 +++++++++++++---
 .../kafka/coordinator/GroupMetadataManager.scala   | 12 +++++++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  3 ++-
 .../main/scala/kafka/server/MetadataCache.scala    |  8 ++++--
 .../main/scala/kafka/server/ReplicaManager.scala   |  5 ++--
 .../scala/unit/kafka/server/OffsetCommitTest.scala | 29 +++++++++++++++++++++-
 7 files changed, 71 insertions(+), 11 deletions(-)
b22a4f0782d0f4d3e07075403e8e5dc318d8d387

 .../scala/kafka/coordinator/GroupCoordinator.scala |  4 +++
 .../scala/kafka/coordinator/GroupMetadata.scala    | 21 +++++++++++++---
 .../kafka/coordinator/GroupMetadataManager.scala   | 12 +++++++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  3 ++-
 .../main/scala/kafka/server/MetadataCache.scala    |  8 ++++--
 .../main/scala/kafka/server/ReplicaManager.scala   |  5 ++--
 .../scala/unit/kafka/server/OffsetCommitTest.scala | 29 +++++++++++++++++++++-
 7 files changed, 71 insertions(+), 11 deletions(-)
f0388d923e1d7564e8831d59bf3aab88db36d30d

 .../kafka/admin/ReassignPartitionsCommand.scala    | 13 ++--
 .../admin/ReassignPartitionsClusterTest.scala      | 91 ++++++++++++++++++++--
 .../admin/ReassignPartitionsCommandTest.scala      | 33 ++++++++
 3 files changed, 124 insertions(+), 13 deletions(-)
b8c3b7c964c6167be7f8ad72c96733dfa0d648a2

 .../kafka/admin/ReassignPartitionsCommand.scala    | 13 ++--
 .../admin/ReassignPartitionsClusterTest.scala      | 91 ++++++++++++++++++++--
 .../admin/ReassignPartitionsCommandTest.scala      | 33 ++++++++
 3 files changed, 124 insertions(+), 13 deletions(-)
e0eefdd36ca2606286a14cb033879ff4a9f56d58

 .../apache/kafka/streams/perf/SimpleBenchmark.java |   9 +-
 .../streams/smoketest/ShutdownDeadlockTest.java    |  95 ----
 .../kafka/streams/smoketest/SmokeTestClient.java   | 217 --------
 .../kafka/streams/smoketest/SmokeTestDriver.java   | 596 ---------------------
 .../kafka/streams/smoketest/SmokeTestUtil.java     | 157 ------
 .../kafka/streams/smoketest/StreamsSmokeTest.java  |  74 ---
 .../kafka/streams/tests/ShutdownDeadlockTest.java  |  95 ++++
 .../kafka/streams/tests/SmokeTestClient.java       | 217 ++++++++
 .../kafka/streams/tests/SmokeTestDriver.java       | 596 +++++++++++++++++++++
 .../apache/kafka/streams/tests/SmokeTestUtil.java  | 157 ++++++
 .../kafka/streams/tests/StreamsSmokeTest.java      |  74 +++
 .../streams/streams_simple_benchmark_test.py       |  11 +-
 .../services/performance/streams_performance.py    |   9 +
 tests/kafkatest/services/streams.py                |   4 +-
 14 files changed, 1165 insertions(+), 1146 deletions(-)
87bd754095c3dd24daf13f4078a7bb28028a4a9d

 .../apache/kafka/streams/perf/SimpleBenchmark.java | 26 +++++++++-------------
 .../streams/smoketest/ShutdownDeadlockTest.java    |  7 +-----
 .../kafka/streams/smoketest/SmokeTestClient.java   |  8 +++----
 .../kafka/streams/smoketest/SmokeTestDriver.java   |  8 +++----
 .../kafka/streams/smoketest/StreamsSmokeTest.java  | 10 ++++-----
 5 files changed, 23 insertions(+), 36 deletions(-)
448c1a4114798892bef60d44199a07a86fc4505a

 .../apache/kafka/streams/perf/SimpleBenchmark.java |   9 +-
 .../streams/smoketest/ShutdownDeadlockTest.java    |  95 ----
 .../kafka/streams/smoketest/SmokeTestClient.java   | 217 --------
 .../kafka/streams/smoketest/SmokeTestDriver.java   | 596 ---------------------
 .../kafka/streams/smoketest/SmokeTestUtil.java     | 157 ------
 .../kafka/streams/smoketest/StreamsSmokeTest.java  |  74 ---
 .../kafka/streams/tests/ShutdownDeadlockTest.java  |  95 ++++
 .../kafka/streams/tests/SmokeTestClient.java       | 217 ++++++++
 .../kafka/streams/tests/SmokeTestDriver.java       | 596 +++++++++++++++++++++
 .../apache/kafka/streams/tests/SmokeTestUtil.java  | 157 ++++++
 .../kafka/streams/tests/StreamsSmokeTest.java      |  74 +++
 .../streams/streams_simple_benchmark_test.py       |  11 +-
 .../services/performance/streams_performance.py    |   9 +
 tests/kafkatest/services/streams.py                |   4 +-
 14 files changed, 1165 insertions(+), 1146 deletions(-)
d2d92b7ef990ce440ebe79056ca971fded517fb9

 .../processor/internals/RecordCollector.java       |  19 ++-
 .../processor/internals/RecordCollectorImpl.java   |  34 ++++--
 .../streams/processor/internals/SinkNode.java      |   3 +-
 .../processor/internals/StandbyContextImpl.java    |  19 ++-
 .../streams/state/internals/StoreChangeLogger.java |   3 +-
 .../processor/internals/RecordCollectorTest.java   |  48 ++++----
 .../streams/state/KeyValueStoreTestDriver.java     |  33 +++--
 .../ChangeLoggingKeyValueBytesStoreTest.java       |  11 +-
 .../internals/ChangeLoggingKeyValueStoreTest.java  |  11 +-
 .../ChangeLoggingSegmentedBytesStoreTest.java      |  11 +-
 .../RocksDBKeyValueStoreSupplierTest.java          |  20 +++-
 .../internals/RocksDBSessionStoreSupplierTest.java |  20 +++-
 .../internals/RocksDBWindowStoreSupplierTest.java  |  20 +++-
 .../state/internals/RocksDBWindowStoreTest.java    | 133 ++++++++++++++++-----
 .../state/internals/StoreChangeLoggerTest.java     |  23 +++-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  23 +++-
 .../org/apache/kafka/test/NoOpRecordCollector.java |  20 +++-
 17 files changed, 324 insertions(+), 127 deletions(-)
abe19fe693d81ea65a018041f157c58ebecd014d

 .../processor/internals/RecordCollector.java       |  19 ++-
 .../processor/internals/RecordCollectorImpl.java   |  34 ++++--
 .../streams/processor/internals/SinkNode.java      |   3 +-
 .../processor/internals/StandbyContextImpl.java    |  19 ++-
 .../streams/state/internals/StoreChangeLogger.java |   3 +-
 .../processor/internals/RecordCollectorTest.java   |  48 ++++----
 .../streams/state/KeyValueStoreTestDriver.java     |  33 +++--
 .../ChangeLoggingKeyValueBytesStoreTest.java       |  11 +-
 .../internals/ChangeLoggingKeyValueStoreTest.java  |  11 +-
 .../ChangeLoggingSegmentedBytesStoreTest.java      |  11 +-
 .../RocksDBKeyValueStoreSupplierTest.java          |  20 +++-
 .../internals/RocksDBSessionStoreSupplierTest.java |  20 +++-
 .../internals/RocksDBWindowStoreSupplierTest.java  |  20 +++-
 .../state/internals/RocksDBWindowStoreTest.java    | 133 ++++++++++++++++-----
 .../state/internals/StoreChangeLoggerTest.java     |  23 +++-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  23 +++-
 .../org/apache/kafka/test/NoOpRecordCollector.java |  20 +++-
 17 files changed, 324 insertions(+), 127 deletions(-)
218a7651a89df262ae4c8415b11ec771c9c812f8

 docs/ops.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
63cf0e58775b8f0b4abf907866bd7c955500902c

 docs/ops.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
3633489324ccc53fd0a9e30ac3c1bb4c7f13297b

 .../kafka/streams/state/internals/CachingSessionStoreTest.java      | 6 ++++++
 1 file changed, 6 insertions(+)
675881b0f1138c6c09ff4700b17f008ea9053aa4

 .../kafka/streams/state/internals/CachingSessionStoreTest.java      | 6 ++++++
 1 file changed, 6 insertions(+)
c310a1bc658bf4cea146e620f988ff19589bca14

 .../kafka/clients/consumer/KafkaConsumer.java      |  6 +--
 .../kafka/clients/consumer/internals/Fetcher.java  |  2 +-
 .../consumer/internals/SubscriptionState.java      | 14 +++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 55 +++++++++++++++++++
 .../clients/consumer/internals/FetcherTest.java    | 62 ++++++++++++++++++++++
 5 files changed, 132 insertions(+), 7 deletions(-)
c1c680e18c01332a78848f6d837319e24daa8594

 core/src/main/scala/kafka/controller/KafkaController.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
2a5db4d6c46fbc9c42cdaef1da19cdbda945a3d3

 core/src/main/scala/kafka/controller/KafkaController.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
3a169837b864886f19c57dfaa6c9b3a188ffbb4d

 core/src/main/scala/kafka/controller/KafkaController.scala    | 11 ++++++++---
 core/src/main/scala/kafka/server/ZookeeperLeaderElector.scala |  2 +-
 2 files changed, 9 insertions(+), 4 deletions(-)
3f0168cd35c1baaa5a032e9a534f28a1bd9221b9

 core/src/main/scala/kafka/controller/KafkaController.scala    | 11 ++++++++---
 core/src/main/scala/kafka/server/ZookeeperLeaderElector.scala |  2 +-
 2 files changed, 9 insertions(+), 4 deletions(-)
02745514629a2c8c8956a9e741fa1a1020e4eb71

 tests/kafkatest/services/verifiable_consumer.py | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)
cd304076706d7ebb0b3ea7e638313a39ffd423e8

 tests/kafkatest/services/verifiable_consumer.py | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)
9b8d99b1b866a90b07c8a9a61fe79a75d01ae272

 tests/kafkatest/services/verifiable_consumer.py | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)
f8b8edd4e1145b04979bd841cdb98e4e9d64e090

 core/src/main/scala/kafka/admin/AdminUtils.scala       | 18 ++++++++++--------
 core/src/test/scala/unit/kafka/admin/AdminTest.scala   | 16 ++++++++++++++++
 .../unit/kafka/server/CreateTopicsRequestTest.scala    |  2 +-
 .../server/CreateTopicsRequestWithPolicyTest.scala     |  2 +-
 4 files changed, 28 insertions(+), 10 deletions(-)
8dfb8afb93f3f1026f868466edb66a4cc63b4455

 core/src/main/scala/kafka/admin/AdminUtils.scala       | 18 ++++++++++--------
 core/src/test/scala/unit/kafka/admin/AdminTest.scala   | 16 ++++++++++++++++
 .../unit/kafka/server/CreateTopicsRequestTest.scala    |  2 +-
 .../server/CreateTopicsRequestWithPolicyTest.scala     |  2 +-
 4 files changed, 28 insertions(+), 10 deletions(-)
5dbb4b8bfe4f02b31a6b5652ba7fac123d035edd

 .../client/client_compatibility_features_test.py   | 100 ++++++
 .../client_compatibility_produce_consume_test.py   |  75 +++++
 .../tests/client/test_producer_consumer_compat.py  |  75 -----
 .../kafka/tools/ClientCompatibilityTest.java       | 359 +++++++++++++++++++++
 4 files changed, 534 insertions(+), 75 deletions(-)
3df60e7eb8b6fb38cd560708f5b909a9b2e61de2

 .../client/client_compatibility_features_test.py   | 100 ++++++
 .../client_compatibility_produce_consume_test.py   |  75 +++++
 .../tests/client/test_producer_consumer_compat.py  |  75 -----
 .../kafka/tools/ClientCompatibilityTest.java       | 359 +++++++++++++++++++++
 4 files changed, 534 insertions(+), 75 deletions(-)
f34831c7603fb69ff196e2f99cd4b00bc59abf53

 .../processor/internals/InternalTopicManager.java  | 86 ++++++++++------------
 .../internals/StreamPartitionAssignor.java         | 42 ++++++++---
 .../processor/internals/StreamsKafkaClient.java    | 40 +---------
 .../integration/KStreamRepartitionJoinTest.java    |  8 +-
 .../integration/utils/IntegrationTestUtils.java    |  4 +-
 .../internals/InternalTopicManagerTest.java        | 66 +++++++----------
 .../kafka/test/MockInternalTopicManager.java       | 28 +++++--
 7 files changed, 123 insertions(+), 151 deletions(-)
7837d3e54850fc6ecd16f9bc4dd28a02779572c2

 .../processor/internals/InternalTopicManager.java  | 86 ++++++++++------------
 .../internals/StreamPartitionAssignor.java         | 42 ++++++++---
 .../processor/internals/StreamsKafkaClient.java    | 40 +---------
 .../integration/KStreamRepartitionJoinTest.java    |  8 +-
 .../integration/utils/IntegrationTestUtils.java    |  4 +-
 .../internals/InternalTopicManagerTest.java        | 66 +++++++----------
 .../kafka/test/MockInternalTopicManager.java       | 28 +++++--
 7 files changed, 123 insertions(+), 151 deletions(-)
740abdb7bf6dff841a09baf84f1bacd88401f50e

 .../apache/kafka/streams/kstream/JoinWindows.java  |  90 ++++++++++++-----
 .../kafka/streams/kstream/SessionWindows.java      |  60 ++++++++----
 .../apache/kafka/streams/kstream/TimeWindows.java  | 107 +++++++++++++--------
 .../kafka/streams/kstream/UnlimitedWindows.java    |  83 +++++++++++-----
 .../org/apache/kafka/streams/kstream/Window.java   |  40 +++++---
 .../org/apache/kafka/streams/kstream/Windowed.java |  28 +++++-
 .../org/apache/kafka/streams/kstream/Windows.java  |  61 ++++++++----
 .../streams/kstream/internals/SessionWindow.java   |  18 ++--
 .../streams/kstream/internals/TimeWindow.java      |  37 ++++++-
 .../streams/kstream/internals/UnlimitedWindow.java |  34 ++++++-
 10 files changed, 403 insertions(+), 155 deletions(-)
b938c03b0aa7a0cebdaad0cbb22689cc719c6ebc

 .../apache/kafka/streams/kstream/JoinWindows.java  |  90 ++++++++++++-----
 .../kafka/streams/kstream/SessionWindows.java      |  60 ++++++++----
 .../apache/kafka/streams/kstream/TimeWindows.java  | 107 +++++++++++++--------
 .../kafka/streams/kstream/UnlimitedWindows.java    |  83 +++++++++++-----
 .../org/apache/kafka/streams/kstream/Window.java   |  40 +++++---
 .../org/apache/kafka/streams/kstream/Windowed.java |  28 +++++-
 .../org/apache/kafka/streams/kstream/Windows.java  |  61 ++++++++----
 .../streams/kstream/internals/SessionWindow.java   |  18 ++--
 .../streams/kstream/internals/TimeWindow.java      |  37 ++++++-
 .../streams/kstream/internals/UnlimitedWindow.java |  34 ++++++-
 10 files changed, 403 insertions(+), 155 deletions(-)
90b9a8a3cc7f9443101f9f95c0acc87873453f68

 .../org/apache/kafka/common/requests/ProduceResponse.java     | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)
3bb0d3cd888c29a002400253d9ff84ce73ebc03c

 .../org/apache/kafka/common/requests/ProduceResponse.java     | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)
b676f51dd54125b950fee35fe867057778866bcb

 tests/docker/Dockerfile    | 1 +
 tests/kafkatest/version.py | 3 ++-
 vagrant/base.sh            | 2 ++
 3 files changed, 5 insertions(+), 1 deletion(-)
567180605c0a8cf74b8d2cad52e2873c83065a95

 tests/docker/Dockerfile    | 1 +
 tests/kafkatest/version.py | 3 ++-
 vagrant/base.sh            | 2 ++
 3 files changed, 5 insertions(+), 1 deletion(-)
928f69ce883c8e30050d2e6f5e72e77e6740bdb9

 .../kafka/common/record/FileLogInputStream.java    |  13 +-
 .../apache/kafka/common/record/FileRecords.java    |   9 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  52 ++++++++
 .../org/apache/kafka/common/utils/UtilsTest.java   | 140 ++++++++++++++++++++-
 4 files changed, 201 insertions(+), 13 deletions(-)
337f576f5979bf8924c5707b338cf4d3c76a53fd

 .../kafka/common/record/FileLogInputStream.java    |  13 +-
 .../apache/kafka/common/record/FileRecords.java    |   9 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  52 ++++++++
 .../org/apache/kafka/common/utils/UtilsTest.java   | 140 ++++++++++++++++++++-
 4 files changed, 201 insertions(+), 13 deletions(-)
bf5aebadb54dd67d27e85cda0109bfc40f7e2883

 tests/kafkatest/tests/client/consumer_test.py | 25 ++++++++++++++++---------
 1 file changed, 16 insertions(+), 9 deletions(-)
4218c02478a213935afbb2c2d661d8a29a5f29ee

 .../apache/kafka/streams/kstream/JoinWindows.java  |  60 +++++-----
 .../kafka/streams/kstream/SessionWindows.java      |  19 +++-
 .../apache/kafka/streams/kstream/TimeWindows.java  |  68 +++++++-----
 .../kafka/streams/kstream/UnlimitedWindows.java    |  38 ++++---
 .../org/apache/kafka/streams/kstream/Window.java   |  42 ++++---
 .../org/apache/kafka/streams/kstream/Windowed.java |  15 ++-
 .../org/apache/kafka/streams/kstream/Windows.java  |  24 ++--
 .../streams/kstream/internals/KStreamImpl.java     |  12 +-
 .../streams/kstream/internals/SessionWindow.java   |   6 +-
 .../streams/kstream/internals/TimeWindow.java      |  11 +-
 .../streams/kstream/internals/UnlimitedWindow.java |  12 +-
 .../kafka/streams/kstream/JoinWindowsTest.java     |  64 +++++++++--
 .../kafka/streams/kstream/SessionWindowsTest.java  |  68 ++++++++++++
 .../kafka/streams/kstream/TimeWindowsTest.java     |  92 ++++++++++++----
 .../streams/kstream/UnlimitedWindowsTest.java      |  22 +++-
 .../apache/kafka/streams/kstream/WindowTest.java   |  85 ++++++++++++++
 .../apache/kafka/streams/kstream/WindowsTest.java  |  62 +++++++++++
 .../streams/kstream/internals/TimeWindowTest.java  | 122 +++++++++++++++++++++
 .../kstream/internals/UnlimitedWindowTest.java     |  42 +++++++
 .../internals/WindowedStreamPartitionerTest.java   |   2 +-
 .../CompositeReadOnlySessionStoreTest.java         |  18 +--
 21 files changed, 701 insertions(+), 183 deletions(-)
79987590e3e96351ff75ce86718801ec605b2419

 .../apache/kafka/streams/kstream/JoinWindows.java  |  60 +++++-----
 .../kafka/streams/kstream/SessionWindows.java      |  19 +++-
 .../apache/kafka/streams/kstream/TimeWindows.java  |  68 +++++++-----
 .../kafka/streams/kstream/UnlimitedWindows.java    |  38 ++++---
 .../org/apache/kafka/streams/kstream/Window.java   |  42 ++++---
 .../org/apache/kafka/streams/kstream/Windowed.java |  15 ++-
 .../org/apache/kafka/streams/kstream/Windows.java  |  24 ++--
 .../streams/kstream/internals/KStreamImpl.java     |  12 +-
 .../streams/kstream/internals/SessionWindow.java   |   6 +-
 .../streams/kstream/internals/TimeWindow.java      |  11 +-
 .../streams/kstream/internals/UnlimitedWindow.java |  12 +-
 .../kafka/streams/kstream/JoinWindowsTest.java     |  64 +++++++++--
 .../kafka/streams/kstream/SessionWindowsTest.java  |  68 ++++++++++++
 .../kafka/streams/kstream/TimeWindowsTest.java     |  92 ++++++++++++----
 .../streams/kstream/UnlimitedWindowsTest.java      |  22 +++-
 .../apache/kafka/streams/kstream/WindowTest.java   |  85 ++++++++++++++
 .../apache/kafka/streams/kstream/WindowsTest.java  |  62 +++++++++++
 .../streams/kstream/internals/TimeWindowTest.java  | 122 +++++++++++++++++++++
 .../kstream/internals/UnlimitedWindowTest.java     |  42 +++++++
 .../internals/WindowedStreamPartitionerTest.java   |   2 +-
 .../CompositeReadOnlySessionStoreTest.java         |  18 +--
 21 files changed, 701 insertions(+), 183 deletions(-)
0f87991d5dbe8741953be04628810d76a9ee7434

 .../consumer/internals/ConsumerCoordinator.java    |  59 ++-
 .../consumer/internals/SubscriptionState.java      |  13 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   6 +-
 .../internals/ConsumerCoordinatorTest.java         | 410 +++++++++++++--------
 .../consumer/internals/SubscriptionStateTest.java  |  53 ++-
 .../streams/kstream/internals/AbstractStream.java  |   6 -
 .../kafka/streams/processor/TopologyBuilder.java   | 182 ++++-----
 .../streams/processor/internals/SinkNode.java      |   4 +-
 .../streams/processor/internals/SourceNode.java    |   9 +-
 .../streams/processor/internals/StreamThread.java  |  13 +-
 .../processor/internals/StreamsMetadataState.java  |  16 +-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   2 +
 .../integration/KStreamRepartitionJoinTest.java    |   6 +-
 .../integration/utils/EmbeddedKafkaCluster.java    |   2 +-
 .../integration/utils/IntegrationTestUtils.java    |   4 +-
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  12 +-
 .../streams/processor/TopologyBuilderTest.java     |  21 +-
 .../SourceNodeRecordDeserializerTest.java          |   4 +-
 .../java/org/apache/kafka/test/MockSourceNode.java |   3 +-
 19 files changed, 478 insertions(+), 347 deletions(-)
3400d0c3cc07d5d3136bf9a19142b36cca93f92d

 .../consumer/internals/ConsumerCoordinator.java    |  59 ++-
 .../consumer/internals/SubscriptionState.java      |  13 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   6 +-
 .../internals/ConsumerCoordinatorTest.java         | 410 +++++++++++++--------
 .../consumer/internals/SubscriptionStateTest.java  |  53 ++-
 .../streams/kstream/internals/AbstractStream.java  |   6 -
 .../kafka/streams/processor/TopologyBuilder.java   | 182 ++++-----
 .../streams/processor/internals/SinkNode.java      |   4 +-
 .../streams/processor/internals/SourceNode.java    |   9 +-
 .../streams/processor/internals/StreamThread.java  |  13 +-
 .../processor/internals/StreamsMetadataState.java  |  16 +-
 .../org/apache/kafka/streams/KafkaStreamsTest.java |   2 +
 .../integration/KStreamRepartitionJoinTest.java    |   6 +-
 .../integration/utils/EmbeddedKafkaCluster.java    |   2 +-
 .../integration/utils/IntegrationTestUtils.java    |   4 +-
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  12 +-
 .../streams/processor/TopologyBuilderTest.java     |  21 +-
 .../SourceNodeRecordDeserializerTest.java          |   4 +-
 .../java/org/apache/kafka/test/MockSourceNode.java |   3 +-
 19 files changed, 478 insertions(+), 347 deletions(-)
80ceb75d2acf5c3d8c21e03bf55e706c637d9fd9

 docs/upgrade.html | 2 ++
 1 file changed, 2 insertions(+)
62206de4e52dbec32b99baffa0ebf7f5303d7b7f

 docs/upgrade.html | 2 ++
 1 file changed, 2 insertions(+)
afde87804211dfea2b9ee87c5f6470e8460dcd33

 .../streams/processor/DefaultPartitionGrouper.java |  2 +-
 .../processor/DefaultPartitionGrouperTest.java     | 72 ++++++++++++++--------
 2 files changed, 49 insertions(+), 25 deletions(-)
dd897bdb2e9cc8790d1e0494fb7867a5cd09ecc6

 .../streams/processor/DefaultPartitionGrouper.java |  2 +-
 .../processor/DefaultPartitionGrouperTest.java     | 72 ++++++++++++++--------
 2 files changed, 49 insertions(+), 25 deletions(-)
a321750646733aa0a2e6346b5e785a4dd5d7675c

 core/src/main/scala/kafka/security/auth/Authorizer.scala | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)
f0449d3248801facca442d93552a829e8b8d06a7

 core/src/main/scala/kafka/server/KafkaConfig.scala |  1 +
 core/src/main/scala/kafka/server/KafkaServer.scala | 12 +++--
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  4 ++
 .../unit/kafka/server/ServerMetricsTest.scala      | 51 ++++++++++++++++++++++
 4 files changed, 64 insertions(+), 4 deletions(-)
1eb1e2f60ae006144757fc9fc10ab423c58970bb

 core/src/main/scala/kafka/server/KafkaConfig.scala |  1 +
 core/src/main/scala/kafka/server/KafkaServer.scala | 12 +++--
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  4 ++
 .../unit/kafka/server/ServerMetricsTest.scala      | 51 ++++++++++++++++++++++
 4 files changed, 64 insertions(+), 4 deletions(-)
22782ccfc47af219ee50d61549558a5eeb83efe5

 core/src/main/scala/kafka/server/KafkaConfig.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
e393c9928972c00677250ae2df3b4f061fdccd58

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java     | 2 +-
 .../java/org/apache/kafka/streams/kstream/internals/KStreamImpl.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
20e957c9b1f389621bb8ae9e9f5554b66cd92a4f

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java     | 2 +-
 .../java/org/apache/kafka/streams/kstream/internals/KStreamImpl.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
db57c1a0c7e057e19ec165d3cf9fa35d54b97c8f

 .../streams/processor/DefaultPartitionGrouper.java |   2 +
 .../internals/StreamPartitionAssignor.java         |  59 +++++-------
 .../internals/StreamPartitionAssignorTest.java     | 103 +++++++++++++--------
 3 files changed, 90 insertions(+), 74 deletions(-)
0b99bea590842018e8e97e7fd1c71b1471db4d08

 .../streams/processor/DefaultPartitionGrouper.java |   2 +
 .../internals/StreamPartitionAssignor.java         |  59 +++++-------
 .../internals/StreamPartitionAssignorTest.java     | 103 +++++++++++++--------
 3 files changed, 90 insertions(+), 74 deletions(-)
c3f923cbf9f686bf42adda44d34a975167a13159

 build.gradle                                       |   9 +-
 .../kafka/connect/tools/TransformationDoc.java     |  87 ++++++++
 .../kafka/connect/transforms/ExtractField.java     | 114 ++++++++++
 .../kafka/connect/transforms/HoistField.java       | 127 ++++++++++++
 .../kafka/connect/transforms/HoistToStruct.java    | 127 ------------
 .../kafka/connect/transforms/InsertField.java      | 170 +++++++--------
 .../apache/kafka/connect/transforms/MaskField.java | 172 +++++++++++++++
 .../kafka/connect/transforms/RegexRouter.java      |  75 +++++++
 .../kafka/connect/transforms/ReplaceField.java     | 230 +++++++++++++++++++++
 .../connect/transforms/SetSchemaMetadata.java      | 124 +++++++++++
 .../kafka/connect/transforms/TimestampRouter.java  |  30 +--
 .../kafka/connect/transforms/ValueToKey.java       | 111 ++++++++++
 .../transforms/util/NonEmptyListValidator.java     |  39 ++++
 .../connect/transforms/util/RegexValidator.java    |  41 ++++
 .../connect/transforms/util/Requirements.java      |  61 ++++++
 .../kafka/connect/transforms/util/SchemaUtil.java  |  40 ++++
 .../kafka/connect/transforms/ExtractFieldTest.java |  59 ++++++
 .../kafka/connect/transforms/HoistFieldTest.java   |  57 +++++
 .../connect/transforms/HoistToStructTest.java      |  44 ----
 .../kafka/connect/transforms/MaskFieldTest.java    | 156 ++++++++++++++
 .../kafka/connect/transforms/RegexRouterTest.java  |  70 +++++++
 .../kafka/connect/transforms/ReplaceFieldTest.java |  92 +++++++++
 .../connect/transforms/SetSchemaMetadataTest.java  |  67 ++++++
 .../kafka/connect/transforms/ValueToKeyTest.java   |  87 ++++++++
 docs/connect.html                                  |  16 ++
 .../tests/connect/connect_distributed_test.py      |   2 +-
 26 files changed, 1924 insertions(+), 283 deletions(-)
a8aa75616602363847848f004fd0b1a36d0de78c

 build.gradle                                       |   9 +-
 .../kafka/connect/tools/TransformationDoc.java     |  87 ++++++++
 .../kafka/connect/transforms/ExtractField.java     | 114 ++++++++++
 .../kafka/connect/transforms/HoistField.java       | 127 ++++++++++++
 .../kafka/connect/transforms/HoistToStruct.java    | 127 ------------
 .../kafka/connect/transforms/InsertField.java      | 170 +++++++--------
 .../apache/kafka/connect/transforms/MaskField.java | 172 +++++++++++++++
 .../kafka/connect/transforms/RegexRouter.java      |  75 +++++++
 .../kafka/connect/transforms/ReplaceField.java     | 230 +++++++++++++++++++++
 .../connect/transforms/SetSchemaMetadata.java      | 124 +++++++++++
 .../kafka/connect/transforms/TimestampRouter.java  |  30 +--
 .../kafka/connect/transforms/ValueToKey.java       | 111 ++++++++++
 .../transforms/util/NonEmptyListValidator.java     |  39 ++++
 .../connect/transforms/util/RegexValidator.java    |  41 ++++
 .../connect/transforms/util/Requirements.java      |  61 ++++++
 .../kafka/connect/transforms/util/SchemaUtil.java  |  40 ++++
 .../kafka/connect/transforms/ExtractFieldTest.java |  59 ++++++
 .../kafka/connect/transforms/HoistFieldTest.java   |  57 +++++
 .../connect/transforms/HoistToStructTest.java      |  44 ----
 .../kafka/connect/transforms/MaskFieldTest.java    | 156 ++++++++++++++
 .../kafka/connect/transforms/RegexRouterTest.java  |  70 +++++++
 .../kafka/connect/transforms/ReplaceFieldTest.java |  92 +++++++++
 .../connect/transforms/SetSchemaMetadataTest.java  |  67 ++++++
 .../kafka/connect/transforms/ValueToKeyTest.java   |  87 ++++++++
 docs/connect.html                                  |  16 ++
 .../tests/connect/connect_distributed_test.py      |   2 +-
 26 files changed, 1924 insertions(+), 283 deletions(-)
05237367d7a12f395c9b2a1c2b354e1564f21aae

 .../java/org/apache/kafka/streams/state/internals/NamedCache.java   | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
50e035dc341bb595decbac0851354a10c90b0e06

 .../java/org/apache/kafka/streams/state/internals/NamedCache.java   | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
3e1abac4c7d298d47567d23d6390eae4cd9ac1f8

 .../apache/kafka/tools/ProducerPerformance.java    | 82 +++++++++++++++++++---
 1 file changed, 72 insertions(+), 10 deletions(-)
a37bf5fffa4a607ded14ec055276d76f19df2d50

 .../apache/kafka/tools/ProducerPerformance.java    | 82 +++++++++++++++++++---
 1 file changed, 72 insertions(+), 10 deletions(-)
17dd4db29fe7f930ca1c5d0fb5687a48c364f2d7

 .../kafka/clients/consumer/KafkaConsumer.java      |  6 +--
 .../kafka/clients/consumer/internals/Fetcher.java  |  2 +-
 .../consumer/internals/SubscriptionState.java      | 14 +++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 55 +++++++++++++++++++
 .../clients/consumer/internals/FetcherTest.java    | 62 ++++++++++++++++++++++
 5 files changed, 132 insertions(+), 7 deletions(-)
813897a00653351710d37acbbb598235e86db824

 .../kafka/clients/consumer/KafkaConsumer.java      |  6 +--
 .../kafka/clients/consumer/internals/Fetcher.java  |  2 +-
 .../consumer/internals/SubscriptionState.java      | 14 +++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 55 +++++++++++++++++++
 .../clients/consumer/internals/FetcherTest.java    | 62 ++++++++++++++++++++++
 5 files changed, 132 insertions(+), 7 deletions(-)
770bab39916e213443aff8f696c6097b551b9408

 core/src/main/scala/kafka/log/AbstractIndex.scala | 16 ++++++++++++----
 1 file changed, 12 insertions(+), 4 deletions(-)
5fc530bc483db145e0cba3b63a57d6d6a7c547f2

 core/src/main/scala/kafka/log/AbstractIndex.scala | 16 ++++++++++++----
 1 file changed, 12 insertions(+), 4 deletions(-)
ae5591a3af45832d9a50e2aaa31b11c039d8d389

 docs/security.html | 317 ++++++++++++++++++++++++++++++++++++-----------------
 1 file changed, 218 insertions(+), 99 deletions(-)
666abafcc54f8cab64912355dba4c8ada8e44827

 docs/security.html | 317 ++++++++++++++++++++++++++++++++++++-----------------
 1 file changed, 218 insertions(+), 99 deletions(-)
5562d63e8a02fdddaabe066437fe7674d28d5d01

 .../processor/internals/InternalTopicManager.java  |  28 ++---
 .../processor/internals/StreamsKafkaClient.java    | 104 ++++++-----------
 .../internals/InternalTopicManagerTest.java        | 124 +++++++++++++++++++++
 .../internals/StreamPartitionAssignorTest.java     |  25 -----
 4 files changed, 174 insertions(+), 107 deletions(-)
8e2cbae8b12cd71f99f13953b744163f68021323

 .../processor/internals/InternalTopicManager.java  |  28 ++---
 .../processor/internals/StreamsKafkaClient.java    | 104 ++++++-----------
 .../internals/InternalTopicManagerTest.java        | 124 +++++++++++++++++++++
 .../internals/StreamPartitionAssignorTest.java     |  25 -----
 4 files changed, 174 insertions(+), 107 deletions(-)
866b33c16496ab654d59e69cb3e83587c52da673

 bin/kafka-broker-api-versions.sh                   | 17 +++++
 .../org/apache/kafka/clients/NodeApiVersions.java  | 34 ++++++++-
 .../apache/kafka/clients/NodeApiVersionsTest.java  |  8 +--
 core/src/main/scala/kafka/admin/AdminClient.scala  | 49 ++++++++-----
 .../kafka/admin/BrokerApiVersionsCommand.scala     | 81 ++++++++++++++++++++++
 .../kafka/admin/BrokerApiVersionsCommandTest.scala | 61 ++++++++++++++++
 .../integration/kafka/api/AdminClientTest.scala    | 19 +++++
 7 files changed, 244 insertions(+), 25 deletions(-)
4a6f2c6cc0647a08f016a2d712a01ec02630cf87

 bin/kafka-broker-api-versions.sh                   | 17 +++++
 .../org/apache/kafka/clients/NodeApiVersions.java  | 34 ++++++++-
 .../apache/kafka/clients/NodeApiVersionsTest.java  |  8 +--
 core/src/main/scala/kafka/admin/AdminClient.scala  | 49 ++++++++-----
 .../kafka/admin/BrokerApiVersionsCommand.scala     | 81 ++++++++++++++++++++++
 .../kafka/admin/BrokerApiVersionsCommandTest.scala | 61 ++++++++++++++++
 .../integration/kafka/api/AdminClientTest.scala    | 19 +++++
 7 files changed, 244 insertions(+), 25 deletions(-)
dbca4a3b60d6039558c6fec99c86400c2131f9e8

 .../apache/kafka/streams/perf/SimpleBenchmark.java |   2 +-
 .../services/performance/streams_performance.py    | 112 ++-------------------
 tests/kafkatest/services/streams.py                |  54 ++++++----
 .../streams/streams_shutdown_deadlock_test.py      |   3 +-
 4 files changed, 43 insertions(+), 128 deletions(-)
d8a77560c2fa2c209353e3ba2366ad3d4cfdf22c

 .../apache/kafka/streams/perf/SimpleBenchmark.java |   2 +-
 .../services/performance/streams_performance.py    | 112 ++-------------------
 tests/kafkatest/services/streams.py                |  54 ++++++----
 .../streams/streams_shutdown_deadlock_test.py      |   3 +-
 4 files changed, 43 insertions(+), 128 deletions(-)
638a82b7bbf5b375f951e5827983753e9771dda0

 .../kafka/streams/state/internals/ChangeLoggingKeyValueStore.java  | 7 +------
 .../streams/state/internals/ChangeLoggingKeyValueStoreTest.java    | 5 +++++
 2 files changed, 6 insertions(+), 6 deletions(-)
961ebca57fdd4f8f84df8cf26a835f07ea1718c9

 .../kafka/streams/state/internals/ChangeLoggingKeyValueStore.java  | 7 +------
 .../streams/state/internals/ChangeLoggingKeyValueStoreTest.java    | 5 +++++
 2 files changed, 6 insertions(+), 6 deletions(-)
9b751f0c54e0409380632c4ee4618d78daca87d5

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
ccb183f9fca20a37b9b39761dedcd197e3cf2033

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
919548ba0e1d0e231008c381f824f91a8924dc6a

 .../kafka/api/BaseProducerSendTest.scala           |  4 +--
 .../kafka/api/EndToEndAuthorizationTest.scala      |  2 +-
 .../kafka/api/EndToEndClusterIdTest.scala          |  2 +-
 .../kafka/api/IntegrationTestHarness.scala         | 10 +++---
 .../kafka/api/PlaintextConsumerTest.scala          |  2 +-
 .../kafka/api/SaslEndToEndAuthorizationTest.scala  | 17 +++++-----
 .../kafka/api/SaslMultiMechanismConsumerTest.scala |  6 ++--
 .../kafka/api/SaslPlainPlaintextConsumerTest.scala |  3 +-
 .../scala/integration/kafka/api/SaslSetup.scala    | 37 ++++++++++++++--------
 .../integration/kafka/api/SaslTestHarness.scala    |  8 ++---
 .../kafka/api/SslEndToEndAuthorizationTest.scala   |  2 +-
 .../integration/kafka/api/UserQuotaTest.scala      |  3 +-
 .../kafka/integration/KafkaServerTestHarness.scala |  3 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |  2 +-
 .../kafka/server/SaslApiVersionsRequestTest.scala  |  3 +-
 .../scala/unit/kafka/utils/JaasTestUtils.scala     | 14 ++++----
 16 files changed, 64 insertions(+), 54 deletions(-)
4c492975a05e4a646f7140c560ed403c48925331

 .../kafka/api/BaseProducerSendTest.scala           |  4 +--
 .../kafka/api/EndToEndAuthorizationTest.scala      |  2 +-
 .../kafka/api/EndToEndClusterIdTest.scala          |  2 +-
 .../kafka/api/IntegrationTestHarness.scala         | 10 +++---
 .../kafka/api/PlaintextConsumerTest.scala          |  2 +-
 .../kafka/api/SaslEndToEndAuthorizationTest.scala  | 17 +++++-----
 .../kafka/api/SaslMultiMechanismConsumerTest.scala |  6 ++--
 .../kafka/api/SaslPlainPlaintextConsumerTest.scala |  3 +-
 .../scala/integration/kafka/api/SaslSetup.scala    | 37 ++++++++++++++--------
 .../integration/kafka/api/SaslTestHarness.scala    |  8 ++---
 .../kafka/api/SslEndToEndAuthorizationTest.scala   |  2 +-
 .../integration/kafka/api/UserQuotaTest.scala      |  3 +-
 .../kafka/integration/KafkaServerTestHarness.scala |  3 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |  2 +-
 .../kafka/server/SaslApiVersionsRequestTest.scala  |  3 +-
 .../scala/unit/kafka/utils/JaasTestUtils.scala     | 14 ++++----
 16 files changed, 64 insertions(+), 54 deletions(-)
e38794e020951adec5a5d0bbfe42c57294bf67bd

 .../streams/state/internals/RocksDBStore.java      |  21 ++--
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  58 ++++++-----
 .../internals/KStreamKTableLeftJoinTest.java       |   2 -
 ...KStreamSessionWindowAggregateProcessorTest.java |   4 +-
 .../streams/state/KeyValueStoreTestDriver.java     |   2 +-
 .../state/internals/CachingKeyValueStoreTest.java  |   2 +-
 .../state/internals/CachingSessionStoreTest.java   |   2 +-
 .../state/internals/CachingWindowStoreTest.java    |   2 +-
 .../ChangeLoggingKeyValueBytesStoreTest.java       |   3 +-
 .../internals/ChangeLoggingKeyValueStoreTest.java  |   3 +-
 .../ChangeLoggingSegmentedBytesStoreTest.java      |   3 +-
 .../internals/MeteredSegmentedBytesStoreTest.java  |   3 +-
 .../RocksDBKeyValueStoreSupplierTest.java          |   9 +-
 .../internals/RocksDBSegmentedBytesStoreTest.java  |   3 +-
 .../internals/RocksDBSessionStoreSupplierTest.java |   9 +-
 .../state/internals/RocksDBSessionStoreTest.java   |   3 +-
 .../internals/RocksDBWindowStoreSupplierTest.java  |   9 +-
 .../state/internals/RocksDBWindowStoreTest.java    |  24 ++---
 .../state/internals/SegmentIteratorTest.java       |  27 +++--
 .../streams/state/internals/SegmentsTest.java      |   3 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   | 113 +++++----------------
 .../apache/kafka/test/MockProcessorContext.java    |  57 +++++++----
 22 files changed, 153 insertions(+), 209 deletions(-)
1974e1b0e54abe5fdebd8ff3338df864b7ab60f3

 .../streams/state/internals/RocksDBStore.java      |  21 ++--
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  58 ++++++-----
 .../internals/KStreamKTableLeftJoinTest.java       |   2 -
 ...KStreamSessionWindowAggregateProcessorTest.java |   4 +-
 .../streams/state/KeyValueStoreTestDriver.java     |   2 +-
 .../state/internals/CachingKeyValueStoreTest.java  |   2 +-
 .../state/internals/CachingSessionStoreTest.java   |   2 +-
 .../state/internals/CachingWindowStoreTest.java    |   2 +-
 .../ChangeLoggingKeyValueBytesStoreTest.java       |   3 +-
 .../internals/ChangeLoggingKeyValueStoreTest.java  |   3 +-
 .../ChangeLoggingSegmentedBytesStoreTest.java      |   3 +-
 .../internals/MeteredSegmentedBytesStoreTest.java  |   3 +-
 .../RocksDBKeyValueStoreSupplierTest.java          |   9 +-
 .../internals/RocksDBSegmentedBytesStoreTest.java  |   3 +-
 .../internals/RocksDBSessionStoreSupplierTest.java |   9 +-
 .../state/internals/RocksDBSessionStoreTest.java   |   3 +-
 .../internals/RocksDBWindowStoreSupplierTest.java  |   9 +-
 .../state/internals/RocksDBWindowStoreTest.java    |  24 ++---
 .../state/internals/SegmentIteratorTest.java       |  27 +++--
 .../streams/state/internals/SegmentsTest.java      |   3 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   | 113 +++++----------------
 .../apache/kafka/test/MockProcessorContext.java    |  57 +++++++----
 22 files changed, 153 insertions(+), 209 deletions(-)
eb62e5695506ae13bd37102c3c08e8a067eca0c8

 .../common/errors/PolicyViolationException.java    |  3 +
 .../org/apache/kafka/common/protocol/Errors.java   |  2 +-
 .../kafka/server/policy/CreateTopicPolicy.java     | 72 +++++++++++++++++++---
 core/src/main/scala/kafka/admin/AdminUtils.scala   | 36 ++++++-----
 .../src/main/scala/kafka/server/AdminManager.scala | 56 +++++++++++------
 core/src/main/scala/kafka/server/KafkaConfig.scala |  6 +-
 .../server/AbstractCreateTopicsRequestTest.scala   |  2 +-
 .../server/CreateTopicsRequestWithPolicyTest.scala | 59 +++++++++++++++---
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  2 +-
 9 files changed, 183 insertions(+), 55 deletions(-)
fd6d7bcf335166a524dc9a29a50c96af8f1c1c02

 .../common/errors/PolicyViolationException.java    |  3 +
 .../org/apache/kafka/common/protocol/Errors.java   |  2 +-
 .../kafka/server/policy/CreateTopicPolicy.java     | 72 +++++++++++++++++++---
 core/src/main/scala/kafka/admin/AdminUtils.scala   | 36 ++++++-----
 .../src/main/scala/kafka/server/AdminManager.scala | 56 +++++++++++------
 core/src/main/scala/kafka/server/KafkaConfig.scala |  6 +-
 .../server/AbstractCreateTopicsRequestTest.scala   |  2 +-
 .../server/CreateTopicsRequestWithPolicyTest.scala | 59 +++++++++++++++---
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  2 +-
 9 files changed, 183 insertions(+), 55 deletions(-)
e3bdc84d864a5ca655f985473770f7b7cb24b79b

 .../apache/kafka/streams/perf/SimpleBenchmark.java | 26 +++++++++-------------
 .../streams/smoketest/ShutdownDeadlockTest.java    |  7 +-----
 .../kafka/streams/smoketest/SmokeTestClient.java   |  8 +++----
 .../kafka/streams/smoketest/SmokeTestDriver.java   |  8 +++----
 .../kafka/streams/smoketest/StreamsSmokeTest.java  | 10 ++++-----
 5 files changed, 23 insertions(+), 36 deletions(-)
6f72a5a53c444278187fa6be58031168bcaffb26

 .../streams/kstream/internals/SessionKeySerde.java |  17 ++
 .../kafka/streams/state/WindowStoreIterator.java   |   3 +-
 .../AbstractMergedSortedCacheStoreIterator.java    | 166 +++++++++++++++++
 .../state/internals/CachingKeyValueStore.java      |  10 +-
 .../state/internals/CachingSessionStore.java       |  63 ++-----
 .../state/internals/CachingWindowStore.java        |  64 +++----
 .../internals/ChangeLoggingKeyValueBytesStore.java |  93 +++++++++
 .../internals/ChangeLoggingKeyValueStore.java      | 127 +++++++++++++
 .../ChangeLoggingSegmentedBytesStore.java          |  28 +--
 .../internals/CompositeReadOnlyWindowStore.java    |   5 +
 .../DelegatingPeekingKeyValueIterator.java         |  10 +-
 .../MergedSortedCacheKeyValueStoreIterator.java    | 130 ++-----------
 .../MergedSortedCacheSessionStoreIterator.java     |  71 +++++++
 .../MergedSortedCacheWindowStoreIterator.java      |  58 ++++++
 .../MergedSortedCachedWindowStoreIterator.java     | 107 -----------
 .../state/internals/MeteredKeyValueStore.java      |  27 +--
 .../internals/MeteredSegmentedBytesStore.java      |  27 +--
 .../state/internals/MeteredWindowStore.java        | 180 ------------------
 .../internals/RocksDBKeyValueStoreSupplier.java    |  54 ++++--
 .../internals/RocksDBSessionStoreSupplier.java     |  54 ++++--
 .../streams/state/internals/RocksDBStore.java      |  28 +--
 .../state/internals/RocksDBWindowStore.java        |  25 ++-
 .../internals/RocksDBWindowStoreSupplier.java      |  37 ++--
 .../internals/SerializedKeyValueIterator.java      |  70 +++++++
 .../streams/state/internals/WindowStoreUtils.java  |   3 +
 .../streams/state/internals/WrappedStateStore.java |  90 +++++++++
 .../kstream/internals/KGroupedStreamImplTest.java  |  42 ++++-
 .../state/internals/CachingSessionStoreTest.java   |   3 +-
 .../state/internals/CachingWindowStoreTest.java    |   5 +-
 .../ChangeLoggingKeyValueBytesStoreTest.java       | 165 ++++++++++++++++
 .../internals/ChangeLoggingKeyValueStoreTest.java  | 207 +++++++++++++++++++++
 .../DelegatingPeekingKeyValueIteratorTest.java     |  12 +-
 .../MergedSortedCacheSessionStoreIteratorTest.java | 113 +++++++++++
 .../MergedSortedCacheWindowStoreIteratorTest.java  |  35 +++-
 .../state/internals/ReadOnlyWindowStoreStub.java   |   5 +
 .../RocksDBKeyValueStoreSupplierTest.java          | 155 +++++++++++++++
 .../internals/RocksDBSessionStoreSupplierTest.java | 169 +++++++++++++++++
 .../internals/RocksDBWindowStoreSupplierTest.java  | 168 +++++++++++++++++
 .../state/internals/RocksDBWindowStoreTest.java    |   2 -
 .../internals/SerializedKeyValueIteratorTest.java  |  95 ++++++++++
 40 files changed, 2081 insertions(+), 642 deletions(-)
73b7ae0019d387407375f3865e263225c986a6ce

 .../streams/kstream/internals/SessionKeySerde.java |  17 ++
 .../kafka/streams/state/WindowStoreIterator.java   |   3 +-
 .../AbstractMergedSortedCacheStoreIterator.java    | 166 +++++++++++++++++
 .../state/internals/CachingKeyValueStore.java      |  10 +-
 .../state/internals/CachingSessionStore.java       |  63 ++-----
 .../state/internals/CachingWindowStore.java        |  64 +++----
 .../internals/ChangeLoggingKeyValueBytesStore.java |  93 +++++++++
 .../internals/ChangeLoggingKeyValueStore.java      | 127 +++++++++++++
 .../ChangeLoggingSegmentedBytesStore.java          |  28 +--
 .../internals/CompositeReadOnlyWindowStore.java    |   5 +
 .../DelegatingPeekingKeyValueIterator.java         |  10 +-
 .../MergedSortedCacheKeyValueStoreIterator.java    | 130 ++-----------
 .../MergedSortedCacheSessionStoreIterator.java     |  71 +++++++
 .../MergedSortedCacheWindowStoreIterator.java      |  58 ++++++
 .../MergedSortedCachedWindowStoreIterator.java     | 107 -----------
 .../state/internals/MeteredKeyValueStore.java      |  27 +--
 .../internals/MeteredSegmentedBytesStore.java      |  27 +--
 .../state/internals/MeteredWindowStore.java        | 180 ------------------
 .../internals/RocksDBKeyValueStoreSupplier.java    |  54 ++++--
 .../internals/RocksDBSessionStoreSupplier.java     |  54 ++++--
 .../streams/state/internals/RocksDBStore.java      |  28 +--
 .../state/internals/RocksDBWindowStore.java        |  25 ++-
 .../internals/RocksDBWindowStoreSupplier.java      |  37 ++--
 .../internals/SerializedKeyValueIterator.java      |  70 +++++++
 .../streams/state/internals/WindowStoreUtils.java  |   3 +
 .../streams/state/internals/WrappedStateStore.java |  90 +++++++++
 .../kstream/internals/KGroupedStreamImplTest.java  |  42 ++++-
 .../state/internals/CachingSessionStoreTest.java   |   3 +-
 .../state/internals/CachingWindowStoreTest.java    |   5 +-
 .../ChangeLoggingKeyValueBytesStoreTest.java       | 165 ++++++++++++++++
 .../internals/ChangeLoggingKeyValueStoreTest.java  | 207 +++++++++++++++++++++
 .../DelegatingPeekingKeyValueIteratorTest.java     |  12 +-
 .../MergedSortedCacheSessionStoreIteratorTest.java | 113 +++++++++++
 .../MergedSortedCacheWindowStoreIteratorTest.java  |  35 +++-
 .../state/internals/ReadOnlyWindowStoreStub.java   |   5 +
 .../RocksDBKeyValueStoreSupplierTest.java          | 155 +++++++++++++++
 .../internals/RocksDBSessionStoreSupplierTest.java | 169 +++++++++++++++++
 .../internals/RocksDBWindowStoreSupplierTest.java  | 168 +++++++++++++++++
 .../state/internals/RocksDBWindowStoreTest.java    |   2 -
 .../internals/SerializedKeyValueIteratorTest.java  |  95 ++++++++++
 40 files changed, 2081 insertions(+), 642 deletions(-)
c9b9acf6a8b5433332c2d0d825c17a4a20cf3fa5

 checkstyle/import-control.xml                      |  1 +
 .../integration/GlobalKTableIntegrationTest.java   |  4 +-
 .../KStreamAggregationDedupIntegrationTest.java    |  4 +-
 .../KStreamAggregationIntegrationTest.java         |  4 +-
 .../KStreamKTableJoinIntegrationTest.java          |  2 +-
 .../integration/KStreamRepartitionJoinTest.java    |  8 ++--
 .../integration/QueryableStateIntegrationTest.java | 14 +++----
 .../integration/utils/EmbeddedKafkaCluster.java    | 24 ++++++++++--
 .../integration/utils/IntegrationTestUtils.java    | 43 ++++++++++++++++++++++
 .../streams/integration/utils/KafkaEmbedded.java   |  3 ++
 .../org/apache/kafka/test/StreamsTestUtils.java    |  1 +
 11 files changed, 87 insertions(+), 21 deletions(-)
825f225bc5706b16af8ec44ca47ee1452c11e6f3

 checkstyle/import-control.xml                      |  1 +
 .../integration/GlobalKTableIntegrationTest.java   |  4 +-
 .../KStreamAggregationDedupIntegrationTest.java    |  4 +-
 .../KStreamAggregationIntegrationTest.java         |  4 +-
 .../KStreamKTableJoinIntegrationTest.java          |  2 +-
 .../integration/KStreamRepartitionJoinTest.java    |  8 ++--
 .../integration/QueryableStateIntegrationTest.java | 14 +++----
 .../integration/utils/EmbeddedKafkaCluster.java    | 24 ++++++++++--
 .../integration/utils/IntegrationTestUtils.java    | 43 ++++++++++++++++++++++
 .../streams/integration/utils/KafkaEmbedded.java   |  3 ++
 .../org/apache/kafka/test/StreamsTestUtils.java    |  1 +
 11 files changed, 87 insertions(+), 21 deletions(-)
60d759a227087079e6fd270c68fd9e38441cb34a

 .../kafka/common/requests/OffsetFetchRequest.java  | 24 +++++-
 .../kafka/common/requests/OffsetFetchResponse.java | 83 +++++++--------------
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  2 +-
 .../internals/ConsumerCoordinatorTest.java         |  4 +-
 .../kafka/common/requests/RequestResponseTest.java | 23 ++++--
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |  1 -
 .../scala/kafka/coordinator/GroupCoordinator.scala |  4 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 31 ++++----
 core/src/main/scala/kafka/server/KafkaApis.scala   | 86 +++++++++-------------
 .../kafka/api/AuthorizerIntegrationTest.scala      | 37 +++++++++-
 .../coordinator/GroupCoordinatorResponseTest.scala | 58 ++++++++++++++-
 11 files changed, 211 insertions(+), 142 deletions(-)
2b19ad9d8c47fb0f78a6e90d2f5711df6110bf1f

 tests/kafkatest/services/console_consumer.py       |  4 ++--
 .../kafkatest/services/security/security_config.py | 28 +++++++++++++++++-----
 .../services/security/templates/jaas.conf          |  4 ++++
 tests/kafkatest/services/verifiable_consumer.py    |  5 ++--
 tests/kafkatest/services/verifiable_producer.py    |  9 ++++---
 5 files changed, 35 insertions(+), 15 deletions(-)
3f6c4f63c9c17424cf717ca76c74554bcf3b2e9a

 tests/kafkatest/services/console_consumer.py       |  4 ++--
 .../kafkatest/services/security/security_config.py | 28 +++++++++++++++++-----
 .../services/security/templates/jaas.conf          |  4 ++++
 tests/kafkatest/services/verifiable_consumer.py    |  5 ++--
 tests/kafkatest/services/verifiable_producer.py    |  9 ++++---
 5 files changed, 35 insertions(+), 15 deletions(-)
7a84b241eeb8cb63400a9512b066c3f733f94b8c

 .../kafka/common/requests/OffsetFetchRequest.java  | 24 +++++-
 .../kafka/common/requests/OffsetFetchResponse.java | 83 +++++++--------------
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  2 +-
 .../internals/ConsumerCoordinatorTest.java         |  4 +-
 .../kafka/common/requests/RequestResponseTest.java | 23 ++++--
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |  1 -
 .../scala/kafka/coordinator/GroupCoordinator.scala |  4 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 31 ++++----
 core/src/main/scala/kafka/server/KafkaApis.scala   | 86 +++++++++-------------
 .../kafka/api/AuthorizerIntegrationTest.scala      | 37 +++++++++-
 .../coordinator/GroupCoordinatorResponseTest.scala | 58 ++++++++++++++-
 11 files changed, 211 insertions(+), 142 deletions(-)
e3f4cdd0e249f78a7f4e8f064533bcd15eb11cbf

 .../sanity_checks/test_console_consumer.py         |  2 +-
 tests/kafkatest/services/kafka/kafka.py            |  6 ++++++
 .../kafkatest/services/security/security_config.py | 25 ++++++++++++++++++++++
 .../services/security/templates/jaas.conf          |  9 ++++++++
 tests/kafkatest/tests/core/replication_test.py     |  6 +++++-
 5 files changed, 46 insertions(+), 2 deletions(-)
621dff22e79dc64b9a8748186dd985774044f91a

 docs/security.html | 147 ++++++++++++++++++++++++++++++++++++-----------------
 1 file changed, 99 insertions(+), 48 deletions(-)
55abe65e0996008d54bd5bb8440906ac4a359937

 .../sanity_checks/test_console_consumer.py         |  2 +-
 tests/kafkatest/services/kafka/kafka.py            |  6 ++++++
 .../kafkatest/services/security/security_config.py | 25 ++++++++++++++++++++++
 .../services/security/templates/jaas.conf          |  9 ++++++++
 tests/kafkatest/tests/core/replication_test.py     |  6 +++++-
 5 files changed, 46 insertions(+), 2 deletions(-)
b4d8668d6d47fca8cc6de4f550d703cd8926c436

 docs/security.html | 147 ++++++++++++++++++++++++++++++++++++-----------------
 1 file changed, 99 insertions(+), 48 deletions(-)
7946b2f35c0e3811ba7d706fc9c761d73ece47bb

 .../kafka/streams/processor/internals/AbstractTask.java  |  2 +-
 .../processor/internals/ProcessorStateManager.java       |  3 +--
 .../processor/internals/ProcessorStateManagerTest.java   | 16 ++++++++--------
 3 files changed, 10 insertions(+), 11 deletions(-)
b62804a252b96932952006a483b3afd7da7363ab

 .../kafka/streams/processor/internals/AbstractTask.java  |  2 +-
 .../processor/internals/ProcessorStateManager.java       |  3 +--
 .../processor/internals/ProcessorStateManagerTest.java   | 16 ++++++++--------
 3 files changed, 10 insertions(+), 11 deletions(-)
6e42ce8fe8035872af2815368f707abf6e6ad8b5

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
a8eb1d13e0d962ca3bb3f7708cbf92bd97b54ffd

 .../kstream/internals/KStreamTransformValues.java  | 119 +++++++++++++++++++--
 .../internals/KStreamTransformValuesTest.java      |  81 +++++++++++++-
 2 files changed, 189 insertions(+), 11 deletions(-)
b712b8675d6977a9171edc6569cf382ffcd91354

 .../consumer/internals/ConsumerCoordinator.java    | 16 ++++++-----
 .../kafka/common/requests/OffsetFetchResponse.java |  1 -
 .../internals/ConsumerCoordinatorTest.java         | 32 ++++++++++++++++------
 3 files changed, 33 insertions(+), 16 deletions(-)
d2f6b934bcbd8feca561e050ff8e18d0a4db7d61

 .../java/org/apache/kafka/streams/state/internals/RocksDBStore.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
da57bc27e7cb52cb1e817010ed5101188cbeb68e

 checkstyle/import-control.xml                      |   6 +
 .../common/errors/PolicyViolationException.java    |  29 ++++
 .../org/apache/kafka/common/protocol/Errors.java   |   4 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  28 +++-
 .../kafka/common/requests/CreateTopicsRequest.java |  43 +++++-
 .../common/requests/CreateTopicsResponse.java      |  74 +++++++---
 .../kafka/common/requests/JoinGroupResponse.java   |   4 +
 .../kafka/server/policy/CreateTopicPolicy.java     |  67 +++++++++
 .../kafka/common/requests/RequestResponseTest.java |  74 ++++++----
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  15 +-
 .../src/main/scala/kafka/server/AdminManager.scala |  47 +++---
 .../scala/kafka/server/DelayedCreateTopics.scala   |  11 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  28 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |   6 +
 core/src/main/scala/kafka/utils/CoreUtils.scala    |   2 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |   2 +-
 .../test/scala/unit/kafka/KafkaConfigTest.scala    |   1 -
 .../server/AbstractCreateTopicsRequestTest.scala   | 147 ++++++++++++++++++
 .../scala/unit/kafka/server/BaseRequestTest.scala  |   5 +-
 .../kafka/server/CreateTopicsRequestTest.scala     | 164 ++++++---------------
 .../server/CreateTopicsRequestWithPolicyTest.scala |  81 ++++++++++
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   1 +
 .../processor/internals/StreamsKafkaClient.java    |  28 ++--
 23 files changed, 636 insertions(+), 231 deletions(-)
bc61d9bee67f7f6d403f834a80b517e59405930b

 core/src/main/scala/kafka/log/LogCleanerManager.scala | 5 +++++
 1 file changed, 5 insertions(+)
c2d9b95f36a9bb853bb3851696161d7f7f790bec

 .../consumer/internals/ConsumerCoordinator.java    |  28 ++-
 .../org/apache/kafka/common/protocol/Protocol.java |  24 +-
 .../kafka/common/requests/OffsetFetchRequest.java  |  93 +++++---
 .../kafka/common/requests/OffsetFetchResponse.java | 140 ++++++++++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  10 +-
 .../internals/ConsumerCoordinatorTest.java         |  22 +-
 .../kafka/common/requests/RequestResponseTest.java |   7 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |  12 +
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |  66 +++---
 core/src/main/scala/kafka/api/ApiVersion.scala     |   2 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |  32 ++-
 .../main/scala/kafka/api/OffsetFetchResponse.scala |  30 ++-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   6 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |  22 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |  22 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 118 ++++++----
 .../kafka/api/AuthorizerIntegrationTest.scala      |   4 +-
 .../kafka/admin/DescribeConsumerGroupTest.scala    | 249 ++++++++++++++++++++-
 .../api/RequestResponseSerializationTest.scala     |   6 +-
 .../coordinator/GroupMetadataManagerTest.scala     |  16 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   4 +-
 21 files changed, 693 insertions(+), 220 deletions(-)
88fdca26a0881d12e9f3ba942cd580c8e8154025

 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +-
 .../kafka/clients/consumer/MockConsumer.java       |   8 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  44 ++++++++-
 .../consumer/internals/SubscriptionState.java      |  27 +++++-
 .../apache/kafka/common/metrics/stats/Value.java   |  33 +++++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   8 +-
 .../internals/ConsumerCoordinatorTest.java         |  10 +-
 .../clients/consumer/internals/FetcherTest.java    |   6 +-
 .../consumer/internals/SubscriptionStateTest.java  |   3 +-
 .../integration/kafka/api/BaseConsumerTest.scala   | 102 ++++++++++++++++++++-
 10 files changed, 218 insertions(+), 25 deletions(-)
e90db3e3af0718a80d729809186d45076e71a241

 .../kafka/streams/kstream/KStreamBuilder.java      | 24 +++---
 .../kafka/streams/processor/TopologyBuilder.java   | 38 ++++++----
 .../streams/processor/internals/AbstractTask.java  |  2 +-
 .../internals/GlobalStateManagerImpl.java          |  2 +-
 .../processor/internals/GlobalStateUpdateTask.java |  2 +-
 .../processor/internals/ProcessorStateManager.java | 85 +++++++++-------------
 .../processor/internals/ProcessorTopology.java     | 26 +++----
 .../kafka/streams/kstream/KStreamBuilderTest.java  | 51 ++++---------
 .../streams/processor/TopologyBuilderTest.java     |  1 -
 .../processor/internals/AbstractTaskTest.java      |  1 -
 .../internals/GlobalStateManagerImplTest.java      |  1 -
 .../processor/internals/GlobalStateTaskTest.java   |  1 -
 .../internals/ProcessorStateManagerTest.java       | 52 +++++++++----
 .../processor/internals/StandbyTaskTest.java       | 19 +++--
 .../processor/internals/StreamTaskTest.java        |  7 +-
 .../processor/internals/StreamThreadTest.java      | 10 +--
 .../org/apache/kafka/test/KStreamTestDriver.java   | 15 +---
 .../kafka/test/ProcessorTopologyTestDriver.java    |  2 +-
 18 files changed, 160 insertions(+), 179 deletions(-)
fc0d612b0806032675b433a48f56ccd04f7e52cf

 .../kstream/internals/WindowedDeserializer.java    | 30 +++++++++++-
 .../kstream/internals/WindowedSerializer.java      | 29 ++++++++++-
 .../internals/WindowedStreamPartitionerTest.java   | 57 ++++++++++++++++++++++
 3 files changed, 114 insertions(+), 2 deletions(-)
d1956d4b6c3ab30cba78bc6f6034ec20303e4801

 .../kafka/streams/processor/internals/InternalTopicManager.java       | 3 +--
 tests/kafkatest/tests/streams/streams_smoke_test.py                   | 4 ++--
 2 files changed, 3 insertions(+), 4 deletions(-)
f6fee34a2d6315cd25855b9805e2f4129e24e5c3

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java   |  3 ++-
 .../src/test/java/org/apache/kafka/clients/MockClient.java | 14 +++++++++++++-
 .../apache/kafka/clients/consumer/KafkaConsumerTest.java   |  6 +++++-
 .../consumer/internals/ConsumerCoordinatorTest.java        |  9 +++++++--
 4 files changed, 27 insertions(+), 5 deletions(-)
6496271a11003195d703292a68c6a6c04e56d79d

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java  | 15 +--------------
 .../org/apache/kafka/clients/producer/KafkaProducer.java  |  8 --------
 .../connect/runtime/distributed/WorkerGroupMember.java    | 11 +----------
 3 files changed, 2 insertions(+), 32 deletions(-)
7a61ce4cf40c0a9c75fab4757722010576d3f18d

 tests/cluster_file_generator.sh | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d25671884bbbdf7843ada3e7797573a00ac7cd56

 .../java/org/apache/kafka/clients/ClientUtils.java |   2 +-
 .../apache/kafka/common/network/ListenerName.java  |  68 +++++++++++
 .../org/apache/kafka/common/protocol/Protocol.java |  26 +++-
 .../common/requests/UpdateMetadataRequest.java     |  61 ++++++----
 .../kafka/common/requests/RequestResponseTest.java |  32 +++--
 config/server.properties                           |   5 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  32 +++--
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |   3 +-
 core/src/main/scala/kafka/api/ApiVersion.scala     |  12 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |  67 ++++++-----
 core/src/main/scala/kafka/cluster/Broker.scala     | 106 +++++++++++-----
 core/src/main/scala/kafka/cluster/EndPoint.scala   |  59 +++++----
 .../kafka/consumer/ConsumerFetcherManager.scala    |   2 +-
 .../controller/ControllerChannelManager.scala      |  32 ++---
 .../scala/kafka/controller/KafkaController.scala   |  12 +-
 .../main/scala/kafka/network/RequestChannel.scala  |  24 ++--
 .../main/scala/kafka/network/SocketServer.scala    |  35 +++---
 core/src/main/scala/kafka/server/KafkaApis.scala   |  15 +--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 133 +++++++++++++--------
 .../main/scala/kafka/server/KafkaHealthcheck.scala |  16 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |  15 +--
 .../main/scala/kafka/server/MetadataCache.scala    |  43 +++----
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   3 +-
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala |  14 +--
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  24 +++-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  42 ++-----
 .../kafka/api/AuthorizerIntegrationTest.scala      |   7 +-
 .../integration/kafka/api/ProducerBounceTest.scala |   2 +-
 .../kafka/api/ProducerCompressionTest.scala        |   2 +-
 ...ipleListenersWithSameSecurityProtocolTest.scala | 124 +++++++++++++++++++
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  27 +++--
 .../admin/ReassignPartitionsCommandTest.scala      |   6 +-
 .../api/RequestResponseSerializationTest.scala     |  24 ++--
 .../unit/kafka/cluster/BrokerEndPointTest.scala    |  58 ++++-----
 .../kafka/integration/BaseTopicMetadataTest.scala  |  41 +++----
 .../scala/unit/kafka/integration/FetcherTest.scala |   4 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   7 ++
 .../integration/ProducerConsumerTestHarness.scala  |   2 +-
 .../unit/kafka/network/SocketServerTest.scala      |  12 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |   3 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |   4 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  18 +--
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |  78 ++++++++----
 .../scala/unit/kafka/server/BaseRequestTest.scala  |   3 +-
 .../ControlledShutdownLeaderSelectorTest.scala     |   2 +-
 .../unit/kafka/server/EdgeCaseRequestTest.scala    |   3 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 131 +++++++++++++++++---
 .../unit/kafka/server/LeaderElectionTest.scala     |   8 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   2 +-
 .../unit/kafka/server/MetadataCacheTest.scala      |  50 +++++---
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   2 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |   6 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 +-
 .../unit/kafka/server/ServerStartupTest.scala      |   2 +-
 .../kafka/server/SessionExpireListenerTest.scala   |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  27 ++++-
 .../streams/integration/utils/KafkaEmbedded.java   |   3 +-
 58 files changed, 1049 insertions(+), 498 deletions(-)
80d6c64c1b83c25e11e653abb0356f1cbcbba6e8

 docs/upgrade.html | 2 ++
 1 file changed, 2 insertions(+)
8d9d847904e28759b44ffc87752802e8e6f1f659

 .../java/org/apache/kafka/common/security/JaasUtils.java    | 10 ++++++++--
 .../org/apache/kafka/common/security/JaasUtilsTest.java     |  4 +---
 .../security/authenticator/SaslAuthenticatorTest.java       | 13 +++++++++++++
 3 files changed, 22 insertions(+), 5 deletions(-)
2eb32d6a70bcdef86bf87f9afd56b70de9df505e

 .../kafka/clients/consumer/KafkaConsumer.java      |  9 +++---
 .../consumer/internals/AbstractCoordinator.java    | 34 +++++++++++-----------
 .../consumer/internals/ConsumerCoordinator.java    | 25 +++++++++++-----
 .../consumer/internals/ConsumerNetworkClient.java  | 15 ++++++++--
 .../internals/ConsumerNetworkClientTest.java       |  2 +-
 5 files changed, 52 insertions(+), 33 deletions(-)
2b6ba55c73b72fb3bfb6ebb2e2c8507cbacd5690

 core/src/test/scala/unit/kafka/utils/JaasTestUtils.scala | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)
ad8ddf737aea629b607693dbb2ee631937db698f

 .../main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
b6011918fbc36bfaa465bdcc750e2435985d9101

 .../org/apache/kafka/streams/kstream/KStream.java   |  8 ++++----
 .../streams/kstream/internals/GlobalKTableImpl.java |  1 -
 .../kstream/internals/KStreamGlobalKTableJoin.java  |  8 ++++----
 .../streams/kstream/internals/KStreamImpl.java      | 21 ++++++++-------------
 .../internals/KStreamKTableJoinProcessor.java       |  8 ++++----
 5 files changed, 20 insertions(+), 26 deletions(-)
2f904883237c476fd82a202f7ddda93fe56eef36

 bin/kafka-run-class.sh                             |   2 +-
 build.gradle                                       |  42 ++-
 checkstyle/import-control.xml                      |   7 +
 .../org/apache/kafka/common/config/ConfigDef.java  | 173 ++++++++----
 .../kafka/connect/connector/ConnectRecord.java     |   5 +-
 .../org/apache/kafka/connect/sink/SinkRecord.java  |   7 +-
 .../apache/kafka/connect/source/SourceRecord.java  |   7 +-
 .../apache/kafka/connect/source/SourceTask.java    |   3 +-
 .../kafka/connect/transforms/Transformation.java   |  48 ++++
 .../kafka/connect/file/FileStreamSourceTask.java   |   3 +-
 .../kafka/connect/runtime/AbstractHerder.java      |  57 +---
 .../kafka/connect/runtime/ConnectorConfig.java     | 148 ++++++++++-
 .../kafka/connect/runtime/PluginDiscovery.java     | 127 +++++++++
 .../kafka/connect/runtime/TransformationChain.java |  69 +++++
 .../org/apache/kafka/connect/runtime/Worker.java   |  13 +-
 .../kafka/connect/runtime/WorkerSinkTask.java      |  22 +-
 .../kafka/connect/runtime/WorkerSourceTask.java    |  15 +-
 .../rest/resources/ConnectorPluginsResource.java   |   4 +-
 .../kafka/connect/runtime/ConnectorConfigTest.java | 162 +++++++++++
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |  35 ++-
 .../runtime/WorkerSinkTaskThreadedTest.java        |  12 +-
 .../connect/runtime/WorkerSourceTaskTest.java      |  47 +++-
 .../apache/kafka/connect/runtime/WorkerTest.java   |   3 +
 .../kafka/connect/transforms/HoistToStruct.java    | 127 +++++++++
 .../kafka/connect/transforms/InsertField.java      | 296 +++++++++++++++++++++
 .../kafka/connect/transforms/TimestampRouter.java  |  95 +++++++
 .../connect/transforms/util/SimpleConfig.java      |  34 +++
 .../connect/transforms/HoistToStructTest.java      |  44 +++
 .../kafka/connect/transforms/InsertFieldTest.java  | 113 ++++++++
 .../connect/transforms/TimestampRouterTest.java    |  43 +++
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |   2 +
 settings.gradle                                    |   2 +-
 tests/kafkatest/services/console_consumer.py       |  10 +-
 .../tests/connect/connect_distributed_test.py      |  67 ++++-
 tests/kafkatest/tests/connect/connect_rest_test.py |   4 +-
 35 files changed, 1692 insertions(+), 156 deletions(-)
a1e8b507d274f03f542866d72b14d9d664acfad0

 .../java/org/apache/kafka/streams/state/internals/SegmentIterator.java  | 2 --
 1 file changed, 2 deletions(-)
8079c980ac5c9c00d7577fa05857b4de6864dbb5

 .../org/apache/kafka/streams/KafkaStreams.java     |  92 ++++-
 .../apache/kafka/streams/kstream/GlobalKTable.java |  59 +++
 .../org/apache/kafka/streams/kstream/KStream.java  |  68 +++-
 .../kafka/streams/kstream/KStreamBuilder.java      |  54 +++
 .../org/apache/kafka/streams/kstream/KTable.java   |   1 +
 .../kstream/internals/GlobalKTableImpl.java        |  34 ++
 .../kstream/internals/KStreamGlobalKTableJoin.java |  46 +++
 .../streams/kstream/internals/KStreamImpl.java     |  39 +-
 .../kstream/internals/KStreamKTableJoin.java       |  47 +--
 .../internals/KStreamKTableJoinProcessor.java      |  62 ++++
 .../streams/kstream/internals/KTableImpl.java      |   4 +-
 .../kstream/internals/KTableKTableJoin.java        |  46 +--
 .../internals/KTableKTableJoinValueGetter.java     |  62 ++++
 .../internals/KTableKTableLeftJoinValueGetter.java |  58 +++
 .../internals/KTableSourceValueGetterSupplier.java |   6 +-
 .../kafka/streams/processor/TopologyBuilder.java   | 185 +++++++--
 .../internals/AbstractProcessorContext.java        | 195 ++++++++++
 .../streams/processor/internals/AbstractTask.java  |   1 +
 .../internals/GlobalProcessorContextImpl.java      |  81 ++++
 .../processor/internals/GlobalStateMaintainer.java |  37 ++
 .../processor/internals/GlobalStateManager.java    |  23 ++
 .../internals/GlobalStateManagerImpl.java          | 246 ++++++++++++
 .../processor/internals/GlobalStateUpdateTask.java | 110 ++++++
 .../processor/internals/GlobalStreamThread.java    | 199 ++++++++++
 .../internals/InternalProcessorContext.java        |   6 +
 .../processor/internals/PartitionGroup.java        |   2 +-
 .../processor/internals/ProcessorContextImpl.java  | 222 ++---------
 .../streams/processor/internals/ProcessorNode.java |   2 +-
 .../processor/internals/ProcessorStateManager.java |  16 +-
 .../processor/internals/ProcessorTopology.java     |  22 +-
 .../processor/internals/RecordDeserializer.java    |  23 ++
 .../streams/processor/internals/RecordQueue.java   |  43 +--
 .../internals/SourceNodeRecordDeserializer.java    |  57 +++
 .../processor/internals/StandbyContextImpl.java    | 100 +----
 .../processor/internals/StateDirectory.java        |  65 +++-
 .../streams/processor/internals/StateManager.java  |  41 ++
 .../streams/processor/internals/StreamTask.java    |  14 +-
 .../streams/processor/internals/StreamThread.java  |  10 +-
 .../processor/internals/StreamsMetadataState.java  |  37 +-
 .../state/internals/CachingKeyValueStore.java      |   3 +
 .../DelegatingPeekingKeyValueIterator.java         |   4 +-
 .../state/internals/GlobalStateStoreProvider.java  |  46 +++
 .../kafka/streams/state/internals/NamedCache.java  |   4 +
 .../streams/state/internals/OffsetCheckpoint.java  |   5 +-
 .../state/internals/QueryableStoreProvider.java    |  17 +-
 .../kafka/streams/state/internals/ThreadCache.java |   4 +
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  57 +--
 .../integration/GlobalKTableIntegrationTest.java   | 280 ++++++++++++++
 .../integration/RegexSourceIntegrationTest.java    |   3 +-
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  83 +++++
 .../kstream/internals/GlobalKTableJoinsTest.java   | 110 ++++++
 .../streams/kstream/internals/KStreamImplTest.java |  44 +++
 .../kstream/internals/KTableKTableJoinTest.java    |   1 +
 .../streams/processor/TopologyBuilderTest.java     |   4 +-
 .../processor/internals/AbstractTaskTest.java      |   4 +-
 .../internals/GlobalStateManagerImplTest.java      | 413 +++++++++++++++++++++
 .../processor/internals/GlobalStateTaskTest.java   | 144 +++++++
 .../internals/GlobalStreamThreadTest.java          | 116 ++++++
 .../processor/internals/PartitionGroupTest.java    |   4 +-
 .../processor/internals/ProcessorTopologyTest.java |  21 ++
 .../processor/internals/RecordQueueTest.java       |  26 +-
 .../SourceNodeRecordDeserializerTest.java          | 109 ++++++
 .../processor/internals/StandbyTaskTest.java       |   6 +-
 .../processor/internals/StateConsumerTest.java     | 165 ++++++++
 .../processor/internals/StateDirectoryTest.java    |  22 ++
 .../internals/StreamPartitionAssignorTest.java     |  52 ++-
 .../processor/internals/StreamTaskTest.java        |  22 +-
 .../processor/internals/StreamThreadTest.java      |  40 +-
 .../internals/StreamsMetadataStateTest.java        |  75 +++-
 .../state/internals/CachingKeyValueStoreTest.java  |   6 +
 .../CompositeReadOnlyKeyValueStoreTest.java        |   5 +-
 .../CompositeReadOnlySessionStoreTest.java         |   2 +-
 .../CompositeReadOnlyWindowStoreTest.java          |  23 +-
 .../DelegatingPeekingKeyValueIteratorTest.java     |   1 +
 .../internals/GlobalStateStoreProviderTest.java    |  61 +++
 .../state/internals/InMemoryKeyValueStore.java     | 151 --------
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |   1 +
 .../streams/state/internals/NamedCacheTest.java    |   4 +
 .../internals/QueryableStoreProviderTest.java      |  15 +-
 .../state/internals/StateStoreTestUtils.java       |  57 ---
 .../StreamThreadStateStoreProviderTest.java        |   3 +-
 .../streams/state/internals/ThreadCacheTest.java   |   7 +
 .../apache/kafka/test/GlobalStateManagerStub.java  |  83 +++++
 .../apache/kafka/test/InMemoryKeyValueStore.java   | 152 ++++++++
 .../org/apache/kafka/test/KStreamTestDriver.java   |  28 +-
 .../apache/kafka/test/KTableValueGetterStub.java   |  46 +++
 .../org/apache/kafka/test/MockKeyValueMapper.java  |  14 +
 .../apache/kafka/test/MockProcessorContext.java    |   5 +
 .../org/apache/kafka/test/MockProcessorNode.java   |   8 +
 .../java/org/apache/kafka/test/MockSourceNode.java |   8 +
 .../apache/kafka/test/NoOpProcessorContext.java    |  84 +++++
 .../org/apache/kafka/test/NoOpReadOnlyStore.java   |  91 +++++
 .../kafka/test/ProcessorTopologyTestDriver.java    | 142 +++++--
 .../org/apache/kafka/test/StreamsTestUtils.java    |  13 +
 94 files changed, 4468 insertions(+), 841 deletions(-)
c063172c23394db94320bf095f15f82999da321b

 docs/design.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
7ff407eaa2761d8f86f39cf99e703634761e038c

 core/src/main/scala/kafka/admin/ZkSecurityMigrator.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
3c60511655df3349323e394bdc3836300991352f

 .../org/apache/kafka/streams/kstream/Window.java   |  21 +++-
 .../internals/KStreamSessionWindowAggregate.java   |  12 +-
 .../streams/kstream/internals/SessionKeySerde.java |   2 +-
 .../streams/kstream/internals/SessionWindow.java   |  58 ++++++++++
 .../streams/kstream/internals/TimeWindow.java      |   7 +-
 .../streams/kstream/internals/UnlimitedWindow.java |   6 +-
 .../streams/state/internals/SessionKeySchema.java  |   6 +-
 .../KStreamAggregationIntegrationTest.java         |  34 +++---
 .../kstream/internals/KGroupedStreamImplTest.java  |  18 +--
 ...KStreamSessionWindowAggregateProcessorTest.java |  40 +++----
 .../kstream/internals/SessionKeySerdeTest.java     |  10 +-
 .../kstream/internals/SessionWindowTest.java       | 124 +++++++++++++++++++++
 .../state/internals/CachingSessionStoreTest.java   |  42 +++----
 .../internals/RocksDBSegmentedBytesStoreTest.java  |  44 ++++----
 .../state/internals/RocksDBSessionStoreTest.java   |  46 ++++----
 15 files changed, 335 insertions(+), 135 deletions(-)
23dff4b04a4c4cd338b5f39c9bb7d384857c482c

 .../kafka/streams/kstream/KStreamBuilder.java      | 118 ++++++++++-
 .../kstream/internals/KGroupedTableImpl.java       |   1 -
 .../kafka/streams/processor/TopologyBuilder.java   | 225 +++++++++++++++++++--
 .../streams/processor/internals/StreamThread.java  |  54 ++++-
 ...StreamsFineGrainedAutoResetIntegrationTest.java | 223 ++++++++++++++++++++
 .../streams/processor/TopologyBuilderTest.java     |   2 +-
 6 files changed, 595 insertions(+), 28 deletions(-)
6508e63c7ab1fbabb322754fabf41eb75bbbcec2

 .../security/authenticator/LoginManager.java       | 57 ++++++++++----
 .../common/security/kerberos/KerberosLogin.java    | 59 +++++++-------
 .../kafka/api/EndToEndAuthorizationTest.scala      | 22 ++----
 .../kafka/api/SaslEndToEndAuthorizationTest.scala  | 89 ++++++++++++++++++++++
 .../SaslGssapiSslEndToEndAuthorizationTest.scala   | 36 +++++++++
 .../SaslPlainSslEndToEndAuthorizationTest.scala    | 19 +----
 .../SaslScramSslEndToEndAuthorizationTest.scala    |  5 +-
 .../scala/integration/kafka/api/SaslSetup.scala    |  4 +-
 .../api/SaslSslEndToEndAuthorizationTest.scala     | 32 --------
 .../kafka/api/SslEndToEndAuthorizationTest.scala   |  8 +-
 .../integration/kafka/api/UserQuotaTest.scala      |  3 +-
 .../scala/unit/kafka/utils/JaasTestUtils.scala     | 47 ++++++++----
 12 files changed, 250 insertions(+), 131 deletions(-)
f72203ee9223d3b724ee67bdad9912612dd72f63

 .../apache/kafka/clients/consumer/Consumer.java    |   6 +
 .../kafka/clients/consumer/KafkaConsumer.java      |  45 ++++-
 .../kafka/clients/consumer/MockConsumer.java       |   6 +
 .../consumer/internals/AbstractCoordinator.java    |  46 ++++-
 .../consumer/internals/ConsumerCoordinator.java    |  57 +++---
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  82 ++++++--
 .../internals/ConsumerCoordinatorTest.java         | 203 +++++++++++++++++--
 core/src/main/scala/kafka/admin/AdminClient.scala  |   2 +-
 .../integration/kafka/api/ConsumerBounceTest.scala | 218 ++++++++++++++++++++-
 .../kafka/integration/KafkaServerTestHarness.scala |   6 +-
 10 files changed, 603 insertions(+), 68 deletions(-)
ecff8544dd45e8cf0fcf04f5e0e716d3e21c9f20

 .../apache/kafka/clients/CommonClientConfigs.java  |   3 +
 .../kafka/clients/consumer/ConsumerConfig.java     |  12 ++
 .../apache/kafka/common/metrics/MetricConfig.java  |  13 ++
 .../org/apache/kafka/common/metrics/Metrics.java   |  80 ++++++--
 .../org/apache/kafka/common/metrics/Sensor.java    | 102 ++++++++--
 .../apache/kafka/common/metrics/SensorTest.java    |  58 ++++++
 core/src/main/scala/kafka/server/KafkaConfig.scala |   7 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   1 +
 .../org/apache/kafka/streams/KafkaStreams.java     |  13 ++
 .../org/apache/kafka/streams/StreamsConfig.java    |  11 ++
 .../org/apache/kafka/streams/StreamsMetrics.java   |  72 ++++++-
 .../streams/processor/internals/ProcessorNode.java | 111 ++++++++++-
 .../streams/processor/internals/SinkNode.java      |   7 +-
 .../streams/processor/internals/SourceNode.java    |   7 +-
 .../processor/internals/StandbyContextImpl.java    |   4 +-
 .../streams/processor/internals/StreamTask.java    |  58 ++++--
 .../streams/processor/internals/StreamThread.java  | 200 +++++++-------------
 .../processor/internals/StreamsMetricsImpl.java    | 210 +++++++++++++++++++++
 .../state/internals/MeteredKeyValueStore.java      | 134 +++++++------
 .../internals/MeteredSegmentedBytesStore.java      |  12 +-
 .../state/internals/MeteredWindowStore.java        |  80 +++++---
 .../kafka/streams/state/internals/NamedCache.java  |  59 +++++-
 .../kafka/streams/state/internals/ThreadCache.java |  29 +--
 .../state/internals/ThreadCacheMetrics.java        |  40 ----
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  40 ++++
 ...KStreamSessionWindowAggregateProcessorTest.java |   5 +-
 .../apache/kafka/streams/perf/SimpleBenchmark.java |  38 +++-
 .../processor/internals/AbstractTaskTest.java      |   3 +-
 .../processor/internals/MockStreamsMetrics.java    |  28 +++
 .../processor/internals/ProcessorNodeTest.java     |  65 +++++++
 .../processor/internals/StandbyTaskTest.java       |  16 +-
 .../processor/internals/StreamTaskTest.java        |  54 +++++-
 .../processor/internals/StreamThreadTest.java      | 136 ++++++++-----
 .../internals/StreamsMetricsImplTest.java          | 110 +++++++++++
 .../streams/state/KeyValueStoreTestDriver.java     |  57 +++---
 .../state/internals/CachingKeyValueStoreTest.java  |   4 +-
 .../state/internals/CachingSessionStoreTest.java   |   4 +-
 .../state/internals/CachingWindowStoreTest.java    |   4 +-
 .../ChangeLoggingSegmentedBytesStoreTest.java      |   4 +-
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |   6 +-
 .../MergedSortedCacheWindowStoreIteratorTest.java  |   4 +-
 .../internals/MeteredSegmentedBytesStoreTest.java  |  40 +++-
 .../streams/state/internals/NamedCacheTest.java    |  32 +++-
 .../internals/RocksDBSegmentedBytesStoreTest.java  |   4 +-
 .../state/internals/RocksDBSessionStoreTest.java   |   4 +-
 .../state/internals/RocksDBWindowStoreTest.java    |  36 ++--
 .../state/internals/SegmentIteratorTest.java       |   4 +-
 .../streams/state/internals/SegmentsTest.java      |   4 +-
 .../StreamThreadStateStoreProviderTest.java        |  23 +--
 .../streams/state/internals/ThreadCacheTest.java   |  59 +++---
 .../org/apache/kafka/test/KStreamTestDriver.java   |   4 +-
 .../apache/kafka/test/MockProcessorContext.java    |  40 ++--
 .../kafka/test/ProcessorTopologyTestDriver.java    |  61 +++---
 53 files changed, 1627 insertions(+), 585 deletions(-)
3d60f1e64350710a5fd2a6036da353cc83195741

 .../org/apache/kafka/clients/ClientRequest.java    |  45 ++--
 .../org/apache/kafka/clients/ClientResponse.java   |  11 +-
 .../java/org/apache/kafka/clients/ClientUtils.java |  14 --
 .../org/apache/kafka/clients/ConnectionState.java  |   2 +-
 .../java/org/apache/kafka/clients/KafkaClient.java |  54 +++--
 .../org/apache/kafka/clients/NetworkClient.java    | 266 ++++++++++----------
 .../org/apache/kafka/clients/NodeApiVersions.java  | 109 +++++++++
 .../kafka/clients/consumer/KafkaConsumer.java      |   7 +-
 .../kafka/clients/consumer/OffsetAndTimestamp.java |   5 +-
 .../consumer/internals/AbstractCoordinator.java    |  47 ++--
 .../consumer/internals/ConsumerCoordinator.java    |  19 +-
 .../consumer/internals/ConsumerNetworkClient.java  |  25 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 142 ++++++++---
 .../kafka/clients/producer/KafkaProducer.java      |   5 +-
 .../kafka/clients/producer/internals/Sender.java   |  16 +-
 .../common/errors/ObsoleteBrokerException.java     |  31 +++
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   6 +-
 .../apache/kafka/common/protocol/ProtoUtils.java   |   4 -
 .../org/apache/kafka/common/protocol/Protocol.java |   4 +-
 .../kafka/common/requests/AbstractRequest.java     |  43 +++-
 .../kafka/common/requests/ApiVersionsRequest.java  |  38 ++-
 .../kafka/common/requests/ApiVersionsResponse.java |   3 +-
 .../common/requests/ControlledShutdownRequest.java |  41 +++-
 .../kafka/common/requests/CreateTopicsRequest.java |  58 ++++-
 .../kafka/common/requests/DeleteTopicsRequest.java |  48 +++-
 .../common/requests/DescribeGroupsRequest.java     |  41 +++-
 .../apache/kafka/common/requests/FetchRequest.java | 106 +++++---
 .../common/requests/GroupCoordinatorRequest.java   |  44 +++-
 .../kafka/common/requests/HeartbeatRequest.java    |  48 +++-
 .../kafka/common/requests/JoinGroupRequest.java    | 101 +++++---
 .../kafka/common/requests/LeaderAndIsrRequest.java |  59 ++++-
 .../kafka/common/requests/LeaveGroupRequest.java   |  46 +++-
 .../kafka/common/requests/ListGroupsRequest.java   |  35 ++-
 .../kafka/common/requests/ListOffsetRequest.java   | 143 ++++++++---
 .../kafka/common/requests/ListOffsetResponse.java  |  18 ++
 .../kafka/common/requests/MetadataRequest.java     |  76 +++++-
 .../kafka/common/requests/OffsetCommitRequest.java | 103 ++++++--
 .../kafka/common/requests/OffsetFetchRequest.java  |  52 ++--
 .../kafka/common/requests/ProduceRequest.java      |  53 +++-
 .../kafka/common/requests/RequestHeader.java       |   5 -
 .../common/requests/SaslHandshakeRequest.java      |  14 +-
 .../kafka/common/requests/StopReplicaRequest.java  |  56 ++++-
 .../kafka/common/requests/SyncGroupRequest.java    |  60 ++++-
 .../common/requests/UpdateMetadataRequest.java     | 110 +++++----
 .../authenticator/SaslClientAuthenticator.java     |   3 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  22 ++
 .../java/org/apache/kafka/clients/MockClient.java  |  32 +--
 .../clients/NetworkClientApiVersionsCheckTest.java |  89 -------
 .../apache/kafka/clients/NetworkClientTest.java    |  93 ++++---
 .../apache/kafka/clients/NodeApiVersionsTest.java  | 101 ++++++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   6 +-
 .../internals/ConsumerNetworkClientTest.java       |  19 +-
 .../clients/consumer/internals/FetcherTest.java    |  11 +-
 .../clients/producer/internals/SenderTest.java     |   2 +-
 .../kafka/common/requests/RequestResponseTest.java | 269 ++++++++++-----------
 .../authenticator/SaslAuthenticatorTest.java       |  30 ++-
 .../runtime/distributed/WorkerGroupMember.java     |   5 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |  20 +-
 .../controller/ControllerChannelManager.scala      |  71 +++---
 .../scala/kafka/controller/KafkaController.scala   |   5 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   6 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  10 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  41 ++--
 .../kafka/utils/NetworkClientBlockingOps.scala     |   5 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  44 ++--
 .../unit/kafka/network/SocketServerTest.scala      |  10 +-
 .../unit/kafka/server/ApiVersionsRequestTest.scala |  13 +-
 .../scala/unit/kafka/server/ApiVersionsTest.scala  |   8 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |  10 +-
 .../kafka/server/CreateTopicsRequestTest.scala     |  68 +++---
 .../kafka/server/DeleteTopicsRequestTest.scala     |  29 +--
 .../unit/kafka/server/EdgeCaseRequestTest.scala    |   3 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |  13 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   6 +-
 .../unit/kafka/server/MetadataCacheTest.scala      |  18 +-
 .../unit/kafka/server/MetadataRequestTest.scala    |  32 +--
 .../unit/kafka/server/ProduceRequestTest.scala     |   6 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  12 +-
 .../kafka/server/SaslApiVersionsRequestTest.scala  |  23 +-
 .../processor/internals/StreamsKafkaClient.java    |  28 +--
 81 files changed, 2184 insertions(+), 1194 deletions(-)
d1733953742236e0430aff4e502bd8ee7c642591

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4b71c0bdc1acf244e3c96fa809a1a0e48471d586

 build.gradle                                       |  15 -
 .../examples/pageview/PageViewTypedDemo.java       |   1 -
 .../examples/pageview/PageViewUntypedDemo.java     |   1 -
 .../streams/examples/wordcount/WordCountDemo.java  |   1 -
 .../examples/wordcount/WordCountProcessorDemo.java |   1 -
 .../org/apache/kafka/streams/StreamsConfig.java    | 301 +++++++++++++--------
 .../processor/internals/InternalTopicManager.java  | 264 +++++-------------
 .../internals/StreamPartitionAssignor.java         |  22 +-
 .../streams/processor/internals/StreamThread.java  |  11 +-
 .../processor/internals/StreamsKafkaClient.java    | 270 ++++++++++++++++++
 .../streams/integration/FanoutIntegrationTest.java |   1 -
 .../integration/InternalTopicIntegrationTest.java  |  33 +--
 .../KStreamAggregationDedupIntegrationTest.java    |   1 -
 .../KStreamAggregationIntegrationTest.java         |   2 +-
 .../KStreamKTableJoinIntegrationTest.java          |   1 -
 .../integration/KStreamRepartitionJoinTest.java    |   1 -
 .../integration/QueryableStateIntegrationTest.java |   1 -
 .../streams/integration/ResetIntegrationTest.java  |   1 -
 .../integration/utils/EmbeddedKafkaCluster.java    |   1 -
 .../apache/kafka/streams/perf/SimpleBenchmark.java |   4 -
 .../internals/StreamPartitionAssignorTest.java     |  70 +++--
 .../processor/internals/StreamThreadTest.java      |  24 +-
 .../kafka/streams/smoketest/SmokeTestClient.java   |   1 -
 .../kafka/test/MockInternalTopicManager.java       |  55 ++++
 24 files changed, 672 insertions(+), 411 deletions(-)
a95170f822227c50414c57860e8547dc2e9d84cb

 .../org/apache/kafka/streams/KafkaStreams.java     |  2 +-
 .../kafka/streams/kstream/KGroupedStream.java      | 14 ++--
 .../kafka/streams/kstream/KGroupedTable.java       | 12 +--
 .../org/apache/kafka/streams/kstream/KStream.java  | 56 ++++++-------
 .../org/apache/kafka/streams/kstream/KTable.java   | 28 +++----
 .../kstream/internals/KGroupedStreamImpl.java      |  8 +-
 .../kstream/internals/KGroupedTableImpl.java       | 34 ++++----
 .../kstream/internals/KStreamAggregate.java        |  4 +-
 .../streams/kstream/internals/KStreamFlatMap.java  |  6 +-
 .../kstream/internals/KStreamFlatMapValues.java    |  6 +-
 .../streams/kstream/internals/KStreamImpl.java     | 96 ++++++++++++----------
 .../kstream/internals/KStreamKStreamJoin.java      |  4 +-
 .../kstream/internals/KStreamKTableJoin.java       |  4 +-
 .../streams/kstream/internals/KStreamMap.java      |  6 +-
 .../kstream/internals/KStreamTransform.java        | 12 +--
 .../kstream/internals/KStreamWindowAggregate.java  |  4 +-
 .../streams/kstream/internals/KTableAggregate.java |  6 +-
 .../streams/kstream/internals/KTableFilter.java    |  4 +-
 .../streams/kstream/internals/KTableImpl.java      | 32 ++++----
 .../internals/KTableKTableAbstractJoin.java        |  4 +-
 .../kstream/internals/KTableKTableJoin.java        |  2 +-
 .../kstream/internals/KTableKTableLeftJoin.java    |  2 +-
 .../kstream/internals/KTableKTableOuterJoin.java   |  2 +-
 .../kstream/internals/KTableKTableRightJoin.java   |  2 +-
 .../streams/kstream/internals/KTableMapValues.java |  4 +-
 .../kstream/internals/KTableRepartitionMap.java    |  8 +-
 .../kafka/streams/processor/TopologyBuilder.java   |  2 +-
 .../processor/internals/RecordCollector.java       |  2 +-
 .../processor/internals/RecordCollectorImpl.java   |  2 +-
 .../processor/internals/StandbyContextImpl.java    |  2 +-
 .../processor/internals/StreamsMetadataState.java  |  4 +-
 .../integration/KStreamRepartitionJoinTest.java    | 35 ++------
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  2 +-
 .../kstream/internals/KGroupedStreamImplTest.java  | 24 +++---
 .../kstream/internals/KGroupedTableImplTest.java   | 38 +++++----
 .../kstream/internals/KStreamBranchTest.java       | 22 +++++
 .../kstream/internals/KStreamFilterTest.java       | 19 ++++-
 .../kstream/internals/KStreamFlatMapTest.java      | 12 +--
 .../internals/KStreamFlatMapValuesTest.java        | 19 ++---
 .../kstream/internals/KStreamForeachTest.java      | 12 +++
 .../streams/kstream/internals/KStreamImplTest.java |  6 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  | 10 +--
 .../internals/KStreamKStreamLeftJoinTest.java      |  4 +-
 .../kstream/internals/KStreamKTableJoinTest.java   |  2 +-
 .../internals/KStreamKTableLeftJoinTest.java       |  2 +-
 .../streams/kstream/internals/KStreamMapTest.java  | 17 +++-
 .../kstream/internals/KStreamMapValuesTest.java    |  6 +-
 .../kstream/internals/KStreamSelectKeyTest.java    | 20 ++++-
 .../kstream/internals/KStreamTransformTest.java    | 14 ++--
 .../internals/KStreamTransformValuesTest.java      | 12 +--
 .../internals/KStreamWindowAggregateTest.java      |  6 +-
 .../kstream/internals/KTableAggregateTest.java     | 12 +--
 .../kstream/internals/KTableFilterTest.java        | 16 ++++
 .../kstream/internals/KTableForeachTest.java       | 12 +++
 .../streams/kstream/internals/KTableImplTest.java  |  8 +-
 .../kstream/internals/KTableKTableJoinTest.java    |  6 +-
 .../internals/KTableKTableLeftJoinTest.java        | 20 ++---
 .../internals/KTableKTableOuterJoinTest.java       |  6 +-
 .../kstream/internals/KTableMapValuesTest.java     | 14 ++--
 .../processor/internals/ProcessorTopologyTest.java |  6 +-
 .../processor/internals/RecordCollectorTest.java   |  4 +-
 .../kafka/streams/smoketest/SmokeTestClient.java   | 10 +--
 .../kafka/streams/smoketest/SmokeTestUtil.java     | 12 +--
 .../streams/state/KeyValueStoreTestDriver.java     |  2 +-
 .../state/internals/StoreChangeLoggerTest.java     |  2 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  2 +-
 .../java/org/apache/kafka/test/MockAggregator.java | 28 +++----
 .../org/apache/kafka/test/MockValueJoiner.java     | 19 +++--
 .../org/apache/kafka/test/NoOpRecordCollector.java |  2 +-
 69 files changed, 465 insertions(+), 372 deletions(-)
75469a3b602c26ea81d6fc0a409d39d321195ea4

 .../kstream/internals/KStreamBranchTest.java       |   4 +-
 .../kstream/internals/KStreamFilterTest.java       |   8 +-
 .../kstream/internals/KStreamFlatMapTest.java      |   4 +-
 .../internals/KStreamFlatMapValuesTest.java        |   4 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  | 184 ++++++++++-----------
 .../internals/KStreamKStreamLeftJoinTest.java      |  48 +++---
 .../kstream/internals/KStreamKTableJoinTest.java   |  16 +-
 .../internals/KStreamKTableLeftJoinTest.java       |  16 +-
 .../streams/kstream/internals/KStreamMapTest.java  |   4 +-
 .../kstream/internals/KStreamMapValuesTest.java    |   4 +-
 .../kstream/internals/KStreamTransformTest.java    |   4 +-
 .../internals/KStreamTransformValuesTest.java      |   4 +-
 .../kstream/internals/KTableAggregateTest.java     |   9 +-
 .../kstream/internals/KTableKTableJoinTest.java    |  32 ++--
 .../internals/KTableKTableLeftJoinTest.java        |  48 +++---
 .../internals/KTableKTableOuterJoinTest.java       |  48 +++---
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |  16 +-
 17 files changed, 227 insertions(+), 226 deletions(-)
fe82330f0be1d478b134732a9d29c229b37afe3b

 .../kstream/internals/KStreamSessionWindowAggregate.java |  6 +++---
 .../org/apache/kafka/streams/state/SessionStore.java     |  2 +-
 .../streams/state/internals/CachingSessionStore.java     |  8 ++++----
 .../streams/state/internals/RocksDBSessionStore.java     |  4 ++--
 .../KStreamSessionWindowAggregateProcessorTest.java      | 16 ++++++++--------
 .../streams/state/internals/CachingSessionStoreTest.java | 12 ++++++------
 .../streams/state/internals/RocksDBSessionStoreTest.java | 10 +++++-----
 7 files changed, 29 insertions(+), 29 deletions(-)
275c5e1df237808fe72b8d9933f826949d4b5781

 checkstyle/import-control.xml                      |   5 +
 .../java/org/apache/kafka/clients/ClientUtils.java |   3 +-
 .../kafka/common/network/ChannelBuilders.java      |  43 ++-
 .../kafka/common/network/SaslChannelBuilder.java   |   9 +-
 .../apache/kafka/common/security/JaasUtils.java    |  12 +-
 .../security/authenticator/CredentialCache.java    |  71 +++++
 .../authenticator/SaslServerAuthenticator.java     |  12 +-
 .../common/security/kerberos/KerberosLogin.java    |   2 +-
 .../common/security/plain/PlainSaslServer.java     |   2 +-
 .../common/security/scram/ScramCredential.java     |  50 +++
 .../security/scram/ScramCredentialCallback.java    |  32 ++
 .../security/scram/ScramCredentialUtils.java       |  86 +++++
 .../common/security/scram/ScramFormatter.java      | 169 ++++++++++
 .../common/security/scram/ScramLoginModule.java    |  67 ++++
 .../common/security/scram/ScramMechanism.java      |  79 +++++
 .../kafka/common/security/scram/ScramMessages.java | 272 ++++++++++++++++
 .../common/security/scram/ScramSaslClient.java     | 239 ++++++++++++++
 .../security/scram/ScramSaslClientProvider.java    |  39 +++
 .../common/security/scram/ScramSaslServer.java     | 212 +++++++++++++
 .../security/scram/ScramSaslServerProvider.java    |  39 +++
 .../security/scram/ScramServerCallbackHandler.java |  60 ++++
 .../apache/kafka/common/network/NioEchoServer.java |  15 +-
 .../authenticator/SaslAuthenticatorTest.java       | 143 ++++++++-
 .../security/authenticator/TestJaasConfig.java     |  32 +-
 .../security/scram/ScramCredentialUtilsTest.java   |  97 ++++++
 .../common/security/scram/ScramFormatterTest.java  |  94 ++++++
 .../common/security/scram/ScramMessagesTest.java   | 348 +++++++++++++++++++++
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   7 +-
 .../src/main/scala/kafka/admin/ConfigCommand.scala |  34 +-
 .../controller/ControllerChannelManager.scala      |   5 +-
 .../main/scala/kafka/network/SocketServer.scala    |  13 +-
 .../scala/kafka/security/CredentialProvider.scala  |  52 +++
 .../main/scala/kafka/server/ConfigHandler.scala    |   6 +-
 .../main/scala/kafka/server/DynamicConfig.scala    |  13 +
 core/src/main/scala/kafka/server/KafkaServer.scala |  10 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   3 +-
 .../kafka/api/EndToEndAuthorizationTest.scala      |   2 +-
 .../SaslScramSslEndToEndAuthorizationTest.scala    |  49 +++
 .../scala/unit/kafka/admin/ConfigCommandTest.scala |  48 +++
 .../kafka/integration/KafkaServerTestHarness.scala |   6 +-
 .../unit/kafka/network/SocketServerTest.scala      |  14 +-
 .../scala/unit/kafka/utils/JaasTestUtils.scala     |  31 ++
 42 files changed, 2462 insertions(+), 63 deletions(-)
1fea1c390846673fd39452100e949be61c21b9ce

 core/src/main/scala/kafka/server/ConfigHandler.scala   | 2 +-
 core/src/main/scala/kafka/tools/ConsoleConsumer.scala  | 2 +-
 core/src/test/scala/unit/kafka/log/LogConfigTest.scala | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
044b56b8b5106f5115de7054ac95e199f1b621ea

 build.gradle                                       |   1 +
 .../other/kafka/ReplicationQuotasTestRig.scala     | 334 +++++++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   4 +-
 gradle/dependencies.gradle                         |   4 +-
 4 files changed, 340 insertions(+), 3 deletions(-)
54e2bd210029b124be4835d5c50c56aa5edc5b38

 streams/src/main/java/org/apache/kafka/streams/KafkaStreams.java        | 2 +-
 .../java/org/apache/kafka/streams/processor/internals/StreamThread.java | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
5401a17ad7b9f0879cf66c4dbc6167512c2523a8

 streams/src/main/java/org/apache/kafka/streams/state/Stores.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e4720569bb5fc866351c0887a8a8dcd9b8f5bc32

 core/src/main/scala/kafka/controller/PartitionLeaderSelector.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
109aa353686cc0a9e4448c2b48da63f1d79acae6

 .../org/apache/kafka/streams/KafkaStreams.java     | 17 +++++++++--
 .../kafka/streams/processor/TopologyBuilder.java   | 26 +++++++++++++---
 .../streams/processor/internals/AbstractTask.java  | 26 ++++++++++------
 .../streams/processor/internals/ProcessorNode.java | 22 +++++++++-----
 .../processor/internals/ProcessorTopology.java     | 35 ++++++++++++++--------
 .../streams/processor/internals/SinkNode.java      | 17 +++++++++--
 .../streams/processor/internals/SourceNode.java    | 24 ++++++++++-----
 .../streams/processor/internals/StreamThread.java  | 25 +++++++++++-----
 8 files changed, 138 insertions(+), 54 deletions(-)
64514ff5ec2ec9616dd7b11308d8da4f095edb37

 .../apache/kafka/streams/kstream/Aggregator.java   |  4 +-
 .../kafka/streams/kstream/ForeachAction.java       |  2 +-
 .../apache/kafka/streams/kstream/Initializer.java  |  2 +
 .../kafka/streams/kstream/KGroupedStream.java      | 44 ++++++++++++----------
 .../kafka/streams/kstream/KeyValueMapper.java      |  4 +-
 .../org/apache/kafka/streams/kstream/Merger.java   |  4 +-
 .../apache/kafka/streams/kstream/Predicate.java    |  2 +-
 .../org/apache/kafka/streams/kstream/Reducer.java  |  4 +-
 .../apache/kafka/streams/kstream/Transformer.java  |  6 +--
 .../apache/kafka/streams/kstream/ValueJoiner.java  |  2 +-
 .../apache/kafka/streams/kstream/ValueMapper.java  |  2 +-
 .../kafka/streams/kstream/ValueTransformer.java    |  6 +--
 12 files changed, 46 insertions(+), 36 deletions(-)
52e397962b624f3c881b6f99e71c94da32cf6a33

 .../kafka/streams/kstream/UnlimitedWindows.java    |   4 +
 .../kafka/streams/smoketest/SmokeTestClient.java   |  25 +-
 .../kafka/streams/smoketest/SmokeTestDriver.java   | 318 +++++++++++----------
 .../streams/smoketest/TestTimestampExtractor.java  |  37 ---
 4 files changed, 178 insertions(+), 206 deletions(-)
42a6b7166348455482934f7845160d10cd435eaa

 .../producer/internals/DefaultPartitioner.java     | 18 ++++++++++--
 .../producer/internals/DefaultPartitionerTest.java | 34 +++++++++++++++++++++-
 2 files changed, 49 insertions(+), 3 deletions(-)
fa80093c067e6684e005bfd548770541b5b2778b

 build.gradle                     |  4 ++-
 tests/.gitignore                 |  1 +
 tests/README.md                  | 25 ++++++++++++++
 tests/cluster_file_generator.sh  | 63 +++++++++++++++++++++++++++++++++++
 tests/docker/Dockerfile          | 36 ++++++++++++++++++++
 tests/docker/run_tests.sh        | 72 ++++++++++++++++++++++++++++++++++++++++
 tests/docker/ssh/authorized_keys | 15 +++++++++
 tests/docker/ssh/config          | 21 ++++++++++++
 tests/docker/ssh/id_rsa          | 27 +++++++++++++++
 tests/docker/ssh/id_rsa.pub      |  1 +
 10 files changed, 264 insertions(+), 1 deletion(-)
10b330cf057a90038407a89fdb59d096da01bc55

 .../streams/errors/InvalidStateStoreException.java  | 21 +++++++++++++++++----
 .../apache/kafka/streams/errors/LockException.java  | 17 +++++++++++------
 .../streams/errors/ProcessorStateException.java     | 17 +++++++++++------
 .../kafka/streams/errors/StreamsException.java      | 14 ++++++++------
 .../streams/errors/TaskAssignmentException.java     | 14 ++++++++------
 .../kafka/streams/errors/TaskIdFormatException.java | 20 +++++++++++++++++---
 .../streams/errors/TopologyBuilderException.java    | 16 ++++++++++++++--
 7 files changed, 86 insertions(+), 33 deletions(-)
e0de3a4211a3701c98230b115fadfb67b655e3cf

 .../kafka/streams/kstream/KGroupedStream.java      | 267 +++++++++++++++
 .../org/apache/kafka/streams/kstream/Merger.java   |  40 +++
 .../kafka/streams/kstream/SessionWindows.java      | 105 ++++++
 .../org/apache/kafka/streams/kstream/Window.java   |   7 +
 .../org/apache/kafka/streams/kstream/Windows.java  |   2 +-
 .../kafka/streams/kstream/internals/Change.java    |  16 +
 .../kstream/internals/KGroupedStreamImpl.java      | 153 ++++++++-
 .../kstream/internals/KStreamAggregate.java        |   4 +-
 .../streams/kstream/internals/KStreamReduce.java   |   4 +-
 .../internals/KStreamSessionWindowAggregate.java   | 165 +++++++++
 .../kstream/internals/KStreamWindowAggregate.java  |   6 +-
 .../kstream/internals/KStreamWindowReduce.java     |   6 +-
 .../streams/kstream/internals/KTableAggregate.java |   4 +-
 .../streams/kstream/internals/KTableReduce.java    |   4 +-
 .../streams/kstream/internals/KTableSource.java    |   4 +-
 .../streams/kstream/internals/SessionKeySerde.java | 149 ++++++++
 .../streams/kstream/internals/TupleForwarder.java  |  21 +-
 .../kafka/streams/processor/TopologyBuilder.java   |   6 +-
 .../kafka/streams/state/KeyValueIterator.java      |   6 +
 .../kafka/streams/state/QueryableStoreTypes.java   |  20 ++
 .../kafka/streams/state/ReadOnlySessionStore.java  |  40 +++
 .../apache/kafka/streams/state/SessionStore.java   |  47 +++
 .../org/apache/kafka/streams/state/Stores.java     |  23 +-
 .../state/internals/CachingKeyValueStore.java      |   7 +-
 .../state/internals/CachingSessionStore.java       | 242 +++++++++++++
 .../state/internals/CachingWindowStore.java        |  28 +-
 .../ChangeLoggingSegmentedBytesStore.java          |  95 ++++++
 .../internals/CompositeReadOnlyKeyValueStore.java  |   9 +-
 .../internals/CompositeReadOnlySessionStore.java   |  89 +++++
 .../DelegatingPeekingKeyValueIterator.java         |  20 +-
 .../internals/DelegatingPeekingWindowIterator.java |  73 ----
 .../streams/state/internals/HasNextCondition.java  |  24 ++
 .../internals/InMemoryKeyValueStoreSupplier.java   |   9 +-
 .../streams/state/internals/LRUCacheEntry.java     |   2 +-
 .../state/internals/MemoryNavigableLRUCache.java   |   7 +-
 .../MergedSortedCacheKeyValueStoreIterator.java    |  93 +++--
 .../MergedSortedCachedWindowStoreIterator.java     |  22 +-
 .../state/internals/MeteredKeyValueStore.java      |   5 +
 .../internals/MeteredSegmentedBytesStore.java      | 177 ++++++++++
 .../kafka/streams/state/internals/NamedCache.java  |   8 +-
 .../state/internals/PeekingKeyValueIterator.java   |   3 +-
 .../state/internals/PeekingWindowIterator.java     |  25 --
 .../internals/RocksDBSegmentedBytesStore.java      | 134 ++++++++
 .../state/internals/RocksDBSessionStore.java       | 143 ++++++++
 .../internals/RocksDBSessionStoreSupplier.java     |  68 ++++
 .../streams/state/internals/RocksDBStore.java      |  17 +-
 .../state/internals/RocksDBWindowStore.java        | 374 +++------------------
 .../internals/RocksDBWindowStoreSupplier.java      |  19 +-
 .../kafka/streams/state/internals/Segment.java     |  42 +++
 .../streams/state/internals/SegmentIterator.java   |  94 ++++++
 .../state/internals/SegmentedBytesStore.java       | 122 +++++++
 .../kafka/streams/state/internals/Segments.java    | 179 ++++++++++
 .../streams/state/internals/SessionKeySchema.java  |  73 ++++
 .../kafka/streams/state/internals/ThreadCache.java |  15 +-
 .../state/internals/WindowStoreKeySchema.java      |  59 ++++
 .../state/internals/WindowStoreSupplier.java       |  24 ++
 .../streams/integration/JoinIntegrationTest.java   |   2 +-
 .../KStreamAggregationIntegrationTest.java         | 203 +++++++++++
 .../kstream/internals/KGroupedStreamImplTest.java  | 229 ++++++++++++-
 ...KStreamSessionWindowAggregateProcessorTest.java | 286 ++++++++++++++++
 .../kstream/internals/SessionKeySerdeTest.java     |  87 +++++
 .../state/internals/CachingSessionStoreTest.java   | 204 +++++++++++
 .../state/internals/CachingWindowStoreTest.java    |  18 +-
 .../ChangeLoggingSegmentedBytesStoreTest.java      | 114 +++++++
 .../CompositeReadOnlySessionStoreTest.java         | 121 +++++++
 .../DelegatingPeekingKeyValueIteratorTest.java     |  11 +-
 .../DelegatingPeekingWindowIteratorTest.java       |  92 -----
 .../state/internals/InMemoryKeyValueStore.java     |   9 +-
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |  36 +-
 .../MergedSortedCacheWindowStoreIteratorTest.java  |  44 +--
 .../internals/MeteredSegmentedBytesStoreTest.java  | 122 +++++++
 .../streams/state/internals/NamedCacheTest.java    |  17 +
 .../internals/RocksDBSegmentedBytesStoreTest.java  | 171 ++++++++++
 .../state/internals/RocksDBSessionStoreTest.java   | 156 +++++++++
 .../state/internals/RocksDBWindowStoreTest.java    |  91 ++---
 .../state/internals/SegmentIteratorTest.java       | 148 ++++++++
 .../streams/state/internals/SegmentsTest.java      | 193 +++++++++++
 .../streams/state/internals/ThreadCacheTest.java   |  17 +-
 .../apache/kafka/test/KeyValueIteratorStub.java    |  56 +++
 .../apache/kafka/test/MockProcessorContext.java    |   4 +
 .../kafka/test/ReadOnlySessionStoreStub.java       |  89 +++++
 .../apache/kafka/test/SegmentedBytesStoreStub.java |  95 ++++++
 82 files changed, 5257 insertions(+), 758 deletions(-)
00964ec74d0b3124c88958d5c0db4266e4e38f37

 .../kafka/streams/kstream/ForeachAction.java       | 29 +++++++------
 .../kafka/streams/kstream/KeyValueMapper.java      | 47 ++++++++++++++++------
 .../apache/kafka/streams/kstream/Predicate.java    | 25 ++++++++----
 .../apache/kafka/streams/kstream/ValueJoiner.java  | 38 ++++++++++++-----
 .../apache/kafka/streams/kstream/ValueMapper.java  | 27 +++++++++----
 5 files changed, 116 insertions(+), 50 deletions(-)
b7da847f6ae5786925d65a673b7e80f2de8fe389

 .../kafka/admin/ReassignPartitionsCommand.scala    |  16 +-
 .../admin/ReassignPartitionsIntegrationTest.scala  |  46 +++++
 .../admin/ReassignPartitionsCommandTest.scala      | 227 ++++++++++++++++++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   6 +
 4 files changed, 255 insertions(+), 40 deletions(-)
2e1bcf661df8f22ee05f5bd883a8b501588fc4e2

 .../kafka/connect/tools/VerifiableSourceTask.java     | 19 +++++++++++++++++++
 tests/kafkatest/services/connect.py                   |  6 ++++++
 .../tests/connect/connect_distributed_test.py         | 17 ++++++++++-------
 3 files changed, 35 insertions(+), 7 deletions(-)
050288ab121bfdf486fd94d1a4926e3a819d18d0

 .../apache/kafka/streams/kstream/Aggregator.java   | 40 +++++++++++++++-------
 .../apache/kafka/streams/kstream/Initializer.java  | 17 ++++++---
 .../org/apache/kafka/streams/kstream/Reducer.java  | 28 +++++++++++----
 3 files changed, 61 insertions(+), 24 deletions(-)
d436fa2cae98df485cd2f55af41d5b9503e9b05c

 core/src/main/scala/kafka/server/KafkaServer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
77c4eb13a4edf82a7fa6850974673eb743c463c9

 core/src/main/scala/kafka/server/KafkaServer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d3572648b6c3524784fc3f60964a7f28817cbd55

 .../org/apache/kafka/common/PartitionInfo.java     | 19 +++++-------
 .../org/apache/kafka/common/PartitionInfoTest.java | 36 ++++++++++++++++++++++
 2 files changed, 44 insertions(+), 11 deletions(-)
0cd5afdb611d6d35009b9806be6bdf9874999bb3

 tests/kafkatest/services/kafka/kafka.py            |  5 ++
 .../tests/client/test_producer_consumer_compat.py  | 75 ++++++++++++++++++++++
 2 files changed, 80 insertions(+)
7959bf50696f309c7bf8022461b8cad113ceda8a

 clients/src/test/java/org/apache/kafka/clients/MockClient.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
ac57d1751186967bcba6aceffa6857a4449fa70c

 .../main/java/org/apache/kafka/clients/producer/KafkaProducer.java    | 2 +-
 .../main/java/org/apache/kafka/clients/producer/ProducerConfig.java   | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)
d62ef55252594bbfa1c26fab19207a9632f7bdd3

 core/src/main/scala/kafka/admin/ConfigCommand.scala        | 14 +++++++-------
 .../test/scala/unit/kafka/admin/ConfigCommandTest.scala    | 10 ++++++++++
 2 files changed, 17 insertions(+), 7 deletions(-)
6d6c77a7a9c102f7508e4bc48e0d6eba1fcbc9c6

 .../org/apache/kafka/clients/MetadataUpdater.java  |   4 +-
 .../kafka/clients/producer/ProducerConfig.java     |   4 +-
 .../java/org/apache/kafka/common/Configurable.java |   2 +-
 .../kafka/common/network/ByteBufferSend.java       |   7 +-
 .../org/apache/kafka/common/network/MultiSend.java |  40 +++---
 .../apache/kafka/common/network/NetworkSend.java   |  23 ++-
 .../org/apache/kafka/common/network/Receive.java   |   6 +-
 .../java/org/apache/kafka/common/network/Send.java |   8 +-
 .../kafka/common/network/TransportLayers.java      |  34 +++++
 .../kafka/common/record/ByteBufferInputStream.java |   6 +-
 .../common/record/ByteBufferLogInputStream.java    |  12 +-
 .../apache/kafka/common/record/FileRecords.java    |  23 +--
 .../apache/kafka/common/record/MemoryRecords.java  |  27 ++--
 .../kafka/common/record/MemoryRecordsBuilder.java  |  17 +--
 .../org/apache/kafka/common/record/Records.java    |   4 +-
 .../kafka/common/record/RecordsIterator.java       |  10 +-
 .../apache/kafka/common/requests/FetchRequest.java |  14 +-
 .../kafka/common/requests/FetchResponse.java       |  42 +++---
 .../apache/kafka/common/requests/RecordsSend.java  |  15 +-
 .../authenticator/SaslServerAuthenticator.java     |   2 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |   5 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   3 +-
 .../clients/consumer/internals/FetcherTest.java    |   5 +-
 .../org/apache/kafka/common/record/RecordTest.java |  14 +-
 .../kafka/common/requests/RequestResponseTest.java |  12 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |  12 +-
 core/src/main/scala/kafka/api/ApiUtils.scala       |   7 -
 core/src/main/scala/kafka/api/FetchRequest.scala   |  14 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  | 138 ------------------
 .../main/scala/kafka/api/OffsetCommitRequest.scala |   2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  | 113 ++++++---------
 core/src/main/scala/kafka/cluster/Replica.scala    |  75 +++++-----
 .../scala/kafka/common/TopicAndPartition.scala     |   4 +-
 .../controller/ControllerChannelManager.scala      |   2 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |   2 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |   9 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   2 +-
 core/src/main/scala/kafka/log/LogValidator.scala   | 158 +++++++++++----------
 core/src/main/scala/kafka/message/Message.scala    |  16 +--
 .../scala/kafka/server/AbstractFetcherThread.scala |   2 +-
 .../scala/kafka/server/DelayedOperationKey.scala   |   2 -
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../scala/kafka/server/LogOffsetMetadata.scala     |   2 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  33 ++---
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  22 ---
 .../kafka/utils/NetworkClientBlockingOps.scala     |   2 +-
 core/src/main/scala/kafka/utils/Pool.scala         |  47 +++---
 .../api/GroupCoordinatorIntegrationTest.scala      |  11 +-
 .../kafka/api/IntegrationTestHarness.scala         |   2 -
 .../kafka/message/BaseMessageSetTestCases.scala    |  12 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |  36 ++---
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   1 -
 .../integration/InternalTopicIntegrationTest.java  |   4 +-
 54 files changed, 458 insertions(+), 617 deletions(-)
ce1cb329d5aa788968e47d7dfe307128f2ddc2ff

 vagrant/vagrant-up.sh | 23 +++++++++++++++++------
 1 file changed, 17 insertions(+), 6 deletions(-)
b565dd7eb184da5ef3b08c88a8acc3df221aaa08

 .../kafka/clients/consumer/internals/Fetcher.java  |  3 ++
 .../clients/consumer/internals/FetcherTest.java    | 49 ++++++++++++++++------
 2 files changed, 40 insertions(+), 12 deletions(-)
a565a77b1f9c42e5255afc096b58602869cb0cc5

 .../java/org/apache/kafka/connect/data/Schema.java | 61 +++++++++++++++++++++-
 1 file changed, 60 insertions(+), 1 deletion(-)
7f22ab6550813124ce2bb5254a925c0da3eb1ab9

 .../scala/unit/kafka/producer/ProducerTest.scala   | 30 ++++++++++++----------
 1 file changed, 16 insertions(+), 14 deletions(-)
9e9e6d8752646436cb836af03a8906605fa76471

 .../scala/kafka/consumer/PartitionAssignor.scala   | 31 ++++--------
 .../consumer/ZookeeperConsumerConnector.scala      |  2 +-
 .../kafka/consumer/PartitionAssignorTest.scala     | 55 ++++++++++++++++++++++
 3 files changed, 66 insertions(+), 22 deletions(-)
cea2a669b34b2f94d445aace2b6e95e70af7e2f6

 .../streams/processor/internals/AbstractTask.java  |   5 +-
 .../processor/internals/ProcessorStateManager.java |  48 ++---
 .../processor/internals/RecordCollector.java       |   5 +
 .../processor/internals/RecordCollectorImpl.java   |   3 +-
 .../processor/internals/StandbyContextImpl.java    |   7 +
 .../streams/processor/internals/StreamTask.java    |  20 +-
 .../streams/processor/internals/StreamThread.java  | 129 ++++++------
 .../integration/utils/IntegrationTestUtils.java    |   2 +
 .../internals/ProcessorStateManagerTest.java       |  24 +++
 .../processor/internals/StandbyTaskTest.java       |   4 +-
 .../processor/internals/StreamTaskTest.java        |  34 +++-
 .../processor/internals/StreamThreadTest.java      | 220 ++++++++++++++++++++-
 .../StreamThreadStateStoreProviderTest.java        |   7 +-
 .../apache/kafka/test/MockStateStoreSupplier.java  |  17 +-
 .../org/apache/kafka/test/NoOpRecordCollector.java |  16 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |  18 +-
 16 files changed, 431 insertions(+), 128 deletions(-)
7411ed89be151be4b3df6f0d2adab956b79e2885

 .../kafka/api/BaseProducerSendTest.scala           | 94 +++++++++-------------
 1 file changed, 40 insertions(+), 54 deletions(-)
252e7e958a2fabfa680d23a00e7f0ce7c74f6ad8

 .../src/test/scala/unit/kafka/admin/AclCommandTest.scala |  2 +-
 .../unit/kafka/admin/DescribeConsumerGroupTest.scala     | 16 +++++++---------
 .../scala/unit/kafka/admin/ListConsumerGroupTest.scala   |  2 +-
 .../scala/unit/kafka/admin/ReplicationQuotaUtils.scala   |  2 +-
 core/src/test/scala/unit/kafka/common/TopicTest.scala    |  4 ++--
 .../test/scala/unit/kafka/consumer/TopicFilterTest.scala | 10 +++++-----
 .../unit/kafka/integration/KafkaServerTestHarness.scala  |  2 +-
 7 files changed, 18 insertions(+), 20 deletions(-)
6f09bcb59cd42521152cd8439df94606036ad85f

 core/src/main/scala/kafka/admin/ConfigCommand.scala | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)
29d456cd21d8f3430d52db50a8fd17cc8d700f36

 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 17 ++---
 .../kafka/tools/MirrorMakerIntegrationTest.scala   | 73 ++++++++++++++++++++++
 docs/upgrade.html                                  | 22 +++----
 3 files changed, 92 insertions(+), 20 deletions(-)
3d7e88456f14fbac66309973f1334cb32c10e3ea

 .../main/java/org/apache/kafka/clients/consumer/ConsumerRecord.java  | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
64bab80520e4a5452cd60de8e982ffd2be806ff7

 core/src/main/scala/kafka/utils/Mx4jLoader.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e79954637782c104171bad2a1227b0d7a12e2efa

 bin/windows/kafka-run-class.bat | 37 ++++++++++++++++++++++++++++++++-----
 1 file changed, 32 insertions(+), 5 deletions(-)
dc550259ea04011b22501c82dd6510a29b5a9b0f

 .../main/scala/kafka/network/SocketServer.scala    | 21 +++++++++++------
 .../unit/kafka/server/ServerStartupTest.scala      | 26 +++++++++++++++++++---
 2 files changed, 37 insertions(+), 10 deletions(-)
88a439ed8e78803ae47783c3e5a75d4e4cad2a77

 .../common/record/KafkaLZ4BlockOutputStream.java   |  1 +
 .../apache/kafka/common/record/KafkaLZ4Test.java   | 40 +++++++++++++++-------
 2 files changed, 29 insertions(+), 12 deletions(-)
8e1395b1702fcf7465324a3f52b391245137fd54

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4ca5abe8ee7578f602fb7653cb8a09640607ea85

 core/src/main/scala/kafka/log/LogConfig.scala          | 11 +++++++++++
 core/src/test/scala/unit/kafka/log/LogConfigTest.scala | 10 ++++++++++
 2 files changed, 21 insertions(+)
d092146247f3b3de061ecdb4ddfeac9321d8cf73

 .../kafka/connect/runtime/WorkerSinkTask.java      |  3 +
 .../kafka/connect/runtime/WorkerSourceTask.java    |  5 +-
 .../apache/kafka/connect/runtime/WorkerTask.java   | 71 +++++++++++-----------
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |  7 ++-
 .../connect/runtime/WorkerSourceTaskTest.java      | 20 ++----
 5 files changed, 53 insertions(+), 53 deletions(-)
9eb665c39af1950548f903ad959449f2e69d7671

 .../apache/kafka/common/config/SaslConfigs.java    |   8 +-
 .../kafka/common/network/SaslChannelBuilder.java   |   8 +-
 .../apache/kafka/common/security/JaasConfig.java   | 123 ++++++++++
 .../apache/kafka/common/security/JaasUtils.java    |  64 ++++-
 .../apache/kafka/common/security/auth/Login.java   |   3 +-
 .../security/authenticator/AbstractLogin.java      |  23 +-
 .../security/authenticator/LoginManager.java       |   9 +-
 .../authenticator/SaslServerAuthenticator.java     |   6 +-
 .../common/security/kerberos/KerberosLogin.java    |  16 +-
 .../common/security/plain/PlainSaslServer.java     |   3 +-
 .../kafka/common/security/JaasUtilsTest.java       | 257 +++++++++++++++++++++
 .../authenticator/SaslAuthenticatorTest.java       |  46 ++++
 .../security/authenticator/TestJaasConfig.java     |   5 +
 .../SaslPlainSslEndToEndAuthorizationTest.scala    |  12 +
 .../scala/unit/kafka/utils/JaasTestUtils.scala     |  14 +-
 15 files changed, 551 insertions(+), 46 deletions(-)
76169f9e24fb62dbc6bcd6520bc910272c43aceb

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
8ff5a9f3cf1765674e21dc35e9d7570816954e25

 core/src/main/scala/kafka/admin/ReassignPartitionsCommand.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
7599d5d78be2d67119e6e56b67acd50b1a8fba67

 docs/migration.html | 4 ++--
 docs/protocol.html  | 8 ++++----
 2 files changed, 6 insertions(+), 6 deletions(-)
3c1df09cd50b8c4796f698d0ceec9160fad3f434

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3619ad3935962b8cbbe8077c70956ffed2cbffbb

 core/src/main/scala/kafka/log/LogCleaner.scala     | 27 +++++++++++------
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 35 ++++++++++++++++++++--
 2 files changed, 50 insertions(+), 12 deletions(-)
05d76643174e64b183cb9c315e9dad94d5775d4f

 docs/ops.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
baab43f0d218e743693a933c0d6c44c428ebfc93

 .../java/org/apache/kafka/streams/kstream/KStream.java    | 15 ++++++---------
 1 file changed, 6 insertions(+), 9 deletions(-)
8c628580abc4955887d8c8944b42b11a79dcf523

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
fc88bac66686ef963b5aec53a3eba717336e4ba7

 .../kafka/clients/producer/ProducerConfig.java     |  4 +-
 core/src/main/scala/kafka/cluster/Partition.scala  | 35 ++++++++++++----
 core/src/main/scala/kafka/cluster/Replica.scala    | 42 +++++++++++++++----
 .../main/scala/kafka/server/ReplicaManager.scala   | 49 ++++++++++++++--------
 .../unit/kafka/server/ISRExpirationTest.scala      | 36 ++++++++++++----
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  6 ++-
 6 files changed, 130 insertions(+), 42 deletions(-)
ecc0fc447a496494130648820e5b9c3536fc78f6

 config/server.properties | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
68f204e01bb6fd8b9b6c56dff7a2b0daa448764d

 core/src/main/scala/kafka/cluster/Partition.scala  |  28 ++--
 .../scala/kafka/common/TopicAndPartition.scala     |   7 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |  48 +++---
 core/src/main/scala/kafka/log/Log.scala            |  52 +++---
 core/src/main/scala/kafka/log/LogCleaner.scala     |  53 +++---
 .../main/scala/kafka/log/LogCleanerManager.scala   |  97 +++++------
 core/src/main/scala/kafka/log/LogManager.scala     |  70 ++++----
 .../kafka/server/AbstractFetcherManager.scala      |   8 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |  21 ++-
 .../main/scala/kafka/server/DelayedProduce.scala   |   6 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  19 ++-
 .../main/scala/kafka/server/OffsetCheckpoint.scala |  10 +-
 .../src/main/scala/kafka/server/QuotaFactory.scala |   6 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  23 ++-
 .../main/scala/kafka/server/ReplicaManager.scala   | 178 +++++++++------------
 .../kafka/server/ReplicationQuotaManager.scala     |   8 +-
 .../kafka/tools/ReplicaVerificationTool.scala      |   2 +-
 core/src/main/scala/kafka/utils/Pool.scala         |   2 +-
 .../main/scala/kafka/utils/ReplicationUtils.scala  |   5 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |   2 +-
 .../api/GroupCoordinatorIntegrationTest.scala      |   4 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  11 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  63 ++++----
 .../coordinator/GroupCoordinatorResponseTest.scala |   4 +-
 .../coordinator/GroupMetadataManagerTest.scala     |  10 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  30 ++--
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  13 +-
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |  12 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |  24 +--
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |  35 ++--
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  27 ++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   6 +-
 .../kafka/server/AbstractFetcherThreadTest.scala   |  10 +-
 .../unit/kafka/server/BaseReplicaFetchTest.scala   |   7 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |   3 +-
 .../server/HighwatermarkPersistenceTest.scala      |  18 ++-
 .../unit/kafka/server/ISRExpirationTest.scala      |   3 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  19 +--
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  53 +++---
 .../kafka/server/ReplicaManagerQuotasTest.scala    |  26 ++-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  18 +--
 .../kafka/server/ReplicationQuotaManagerTest.scala |  13 +-
 .../unit/kafka/server/ReplicationQuotasTest.scala  |   8 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  12 +-
 .../unit/kafka/utils/ReplicationUtilsTest.scala    |   6 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  29 ++--
 46 files changed, 546 insertions(+), 563 deletions(-)
0f86dbe89da19ed1cc9142a5362cfa2fe3bc48ee

 .../clients/producer/internals/RecordBatch.java    |  3 +-
 .../apache/kafka/common/record/MemoryRecords.java  |  9 ++-
 .../kafka/common/record/MemoryRecordsBuilder.java  | 58 +++++++++++++------
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  4 +-
 .../clients/consumer/internals/FetcherTest.java    | 22 ++++----
 .../record/ByteBufferLogInputStreamTest.java       | 12 ++--
 .../common/record/MemoryRecordsBuilderTest.java    | 66 +++++++++++++++-------
 .../kafka/common/record/MemoryRecordsTest.java     | 34 +++++------
 core/src/main/scala/kafka/log/LogValidator.scala   |  2 +-
 9 files changed, 131 insertions(+), 79 deletions(-)
3930dd7e7502ab94a7594a0ca41f27638663ae7c

 .../test/java/org/apache/kafka/test/TestUtils.java | 24 ---------
 .../kafka/tools/ReplicaVerificationTool.scala      | 21 ++++----
 .../kafka/tools/ReplicaVerificationToolTest.scala  | 60 ++++++++++++++++++++++
 .../unit/kafka/server/ProduceRequestTest.scala     | 19 +++----
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  2 +-
 5 files changed, 78 insertions(+), 48 deletions(-)
7f4b278c030f6e5cff8caca6428f0e631c8918ec

 .../kafka/streams/processor/internals/ProcessorStateManager.java   | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
56c61745deeadd299e5ef24577c1bdf5d9d231a0

 .../streams/processor/internals/StreamThread.java  |  98 +++++------
 .../processor/internals/StreamThreadTest.java      | 191 +++++++++++++++++++--
 2 files changed, 225 insertions(+), 64 deletions(-)
0321bf5aa67b52d7fab82a326b15ca8e058faee6

 .../processor/internals/RecordCollectorImpl.java   | 16 ++++++-
 .../processor/internals/RecordCollectorTest.java   | 49 ++++++++++++++++++++++
 2 files changed, 64 insertions(+), 1 deletion(-)
a5c15ba0374acbb43f69b1a556077e4ad53332e8

 .../main/java/org/apache/kafka/common/config/ConfigValue.java  |  2 +-
 .../org/apache/kafka/common/metrics/stats/Percentiles.java     |  2 +-
 .../src/main/java/org/apache/kafka/common/network/Mode.java    |  2 +-
 .../src/main/java/org/apache/kafka/common/protocol/Errors.java |  2 +-
 .../org/apache/kafka/common/protocol/SecurityProtocol.java     |  2 +-
 .../apache/kafka/common/record/KafkaLZ4BlockInputStream.java   |  3 +--
 .../kafka/common/requests/ControlledShutdownRequest.java       |  4 ++--
 .../clients/producer/internals/ProducerInterceptorsTest.java   |  3 +--
 .../java/org/apache/kafka/test/MockProducerInterceptor.java    |  3 +--
 .../org/apache/kafka/connect/storage/OffsetBackingStore.java   | 10 +++++-----
 .../kafka/connect/runtime/standalone/StandaloneHerderTest.java |  2 +-
 core/src/main/scala/kafka/consumer/SimpleConsumer.scala        |  2 +-
 .../org/apache/kafka/log4jappender/KafkaLog4jAppender.java     |  4 +---
 .../main/java/org/apache/kafka/tools/ThroughputThrottler.java  |  9 +++++----
 .../main/java/org/apache/kafka/tools/VerifiableConsumer.java   |  4 ++--
 .../java/org/apache/kafka/tools/VerifiableLog4jAppender.java   |  7 +------
 .../main/java/org/apache/kafka/tools/VerifiableProducer.java   |  7 +------
 17 files changed, 27 insertions(+), 41 deletions(-)
135860225ecb579d77d6f364b33471fa261ae0b0

 .gitignore  |   3 +-
 gradlew     | 169 ------------------------------------------------------------
 gradlew.bat |  84 ------------------------------
 3 files changed, 2 insertions(+), 254 deletions(-)
a786be94788816bbce32a6cd6ffcf8949ed95556

 .../consumer/ZookeeperConsumerConnector.scala      |   8 +-
 .../consumer/ZookeeperTopicEventWatcher.scala      |   6 +-
 .../kafka/controller/ControllerZkListener.scala    |  62 ++++++++++++
 .../scala/kafka/controller/KafkaController.scala   | 105 ++++++++-------------
 .../kafka/controller/PartitionStateMachine.scala   |  62 +++++-------
 .../kafka/controller/ReplicaStateMachine.scala     |  16 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |   4 +-
 .../main/scala/kafka/server/KafkaHealthcheck.scala |   4 +-
 .../kafka/server/ZookeeperLeaderElector.scala      |  11 +--
 .../kafka/controller/ControllerFailoverTest.scala  |   2 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |   4 +-
 .../unit/kafka/server/MetadataRequestTest.scala    |   4 +-
 12 files changed, 156 insertions(+), 132 deletions(-)
8b84d14c6fb338e9e6a6d41fe0a6298a63cfc5c0

 .../main/java/org/apache/kafka/common/record/FileRecords.java    | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)
8dbdc90bae940b47dfaf28a0066b061ebfa87b87

 tests/kafkatest/tests/core/throttling_test.py | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
529ca3293254cc84fef82dbe5931e98129f6dba3

 tests/kafkatest/services/mirror_maker.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
bc9ef716af8ac387d63b22ee973a9fc6f864bebb

 .../runtime/distributed/WorkerCoordinator.java     |  38 +++---
 .../runtime/distributed/WorkerCoordinatorTest.java | 134 ++++++++++++++++-----
 2 files changed, 123 insertions(+), 49 deletions(-)
65acff32d195a2ac6e3d7ca4542702065417ba66

 .../internals/StreamPartitionAssignor.java         | 30 ++++++---------
 .../internals/StreamPartitionAssignorTest.java     | 44 ++++++++++++++++++++++
 2 files changed, 56 insertions(+), 18 deletions(-)
d6b0b520fc0755fa560af84f5fc4c9f86699739c

 .../java/org/apache/kafka/clients/ClientUtils.java |  13 ++
 .../kafka/clients/ClusterConnectionStates.java     |  71 +++++----
 .../org/apache/kafka/clients/ConnectionState.java  |   7 +-
 .../kafka/clients/ManualMetadataUpdater.java       |   4 +-
 .../org/apache/kafka/clients/MetadataUpdater.java  |   4 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 172 +++++++++++++++++----
 .../kafka/clients/consumer/KafkaConsumer.java      |  19 ++-
 .../kafka/clients/producer/KafkaProducer.java      |  15 +-
 .../apache/kafka/common/protocol/ProtoUtils.java   |   6 +
 .../kafka/common/requests/ApiVersionsRequest.java  |   2 +-
 .../kafka/common/requests/ApiVersionsResponse.java |  17 +-
 .../authenticator/SaslClientAuthenticator.java     |   3 +
 .../authenticator/SaslServerAuthenticator.java     |   2 +-
 .../clients/NetworkClientApiVersionsCheckTest.java |  89 +++++++++++
 .../apache/kafka/clients/NetworkClientTest.java    |  73 +++++++--
 .../java/org/apache/kafka/test/DelayedReceive.java |  40 +++++
 .../java/org/apache/kafka/test/MockSelector.java   |  20 ++-
 .../runtime/distributed/WorkerGroupMember.java     |  16 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 .../unit/kafka/server/ApiVersionsRequestTest.scala |   2 +-
 .../scala/unit/kafka/server/ApiVersionsTest.scala  |   4 +-
 tests/kafkatest/version.py                         |   7 +-
 22 files changed, 484 insertions(+), 104 deletions(-)
e156f5179f18e045b8f47e8fe5c1e39eaee2afec

 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b58b6a1bef0ecdc2107a415e222af099fcd9bce3

 .../kafka/clients/consumer/internals/Fetcher.java  |  5 +--
 .../kafka/common/record/AbstractRecords.java       | 47 ++++++++++---------
 .../apache/kafka/common/record/FileRecords.java    | 52 +++++++++++++++-------
 .../apache/kafka/common/record/MemoryRecords.java  | 45 ++++++++++++-------
 .../org/apache/kafka/common/record/Records.java    |  9 ++--
 .../producer/internals/RecordAccumulatorTest.java  |  9 ++--
 .../record/ByteBufferLogInputStreamTest.java       | 10 ++---
 .../kafka/common/record/FileRecordsTest.java       | 22 +++------
 .../common/record/MemoryRecordsBuilderTest.java    | 21 +++------
 .../kafka/common/record/MemoryRecordsTest.java     |  8 ++--
 .../test/java/org/apache/kafka/test/TestUtils.java |  9 +++-
 .../kafka/coordinator/GroupMetadataManager.scala   |  2 +-
 core/src/main/scala/kafka/log/Log.scala            |  6 +--
 core/src/main/scala/kafka/log/LogCleaner.scala     |  4 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  9 ++--
 core/src/main/scala/kafka/log/LogValidator.scala   | 10 ++---
 .../scala/kafka/message/ByteBufferMessageSet.scala |  6 +--
 core/src/main/scala/kafka/message/MessageSet.scala |  2 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  2 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  7 ++-
 .../kafka/tools/ReplicaVerificationTool.scala      | 12 ++---
 .../api/GroupCoordinatorIntegrationTest.scala      |  4 +-
 .../test/scala/kafka/tools/TestLogCleaning.scala   |  2 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |  2 +-
 .../javaapi/message/BaseMessageSetTestCases.scala  |  8 ++--
 .../unit/kafka/log/BrokerCompressionTest.scala     |  2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  2 +-
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |  2 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 16 +++----
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 24 +++++-----
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 35 ++++++++-------
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 38 ++++++++--------
 .../kafka/message/BaseMessageSetTestCases.scala    |  5 ++-
 .../kafka/server/AbstractFetcherThreadTest.scala   |  2 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |  4 +-
 .../kafka/server/ReplicaManagerQuotasTest.scala    | 16 +++----
 .../unit/kafka/server/ReplicaManagerTest.scala     |  2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  4 +-
 38 files changed, 241 insertions(+), 224 deletions(-)
e55205b810b6717c5135a463d2fe98975b117187

 docs/introduction.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
056ed86600ebf884057ea24daafc9e3b1ab85b81

 .../kafka/clients/consumer/MockConsumer.java       |  5 +-
 .../streams/processor/internals/StreamThread.java  | 55 ++++++++--------
 .../processor/internals/StreamThreadTest.java      | 77 ++++++++++++++++++++++
 3 files changed, 108 insertions(+), 29 deletions(-)
233cd4b18af83e9f9eadfaf048cdaa1888faf546

 .../internals/StreamPartitionAssignor.java         |  2 +-
 .../internals/StreamPartitionAssignorTest.java     | 49 ++++++++++++++++++++++
 2 files changed, 50 insertions(+), 1 deletion(-)
c2cfadf254c9d5da14db1db9a4a3889c20192f60

 .../org/apache/kafka/streams/kstream/KStream.java  | 66 ----------------------
 1 file changed, 66 deletions(-)
e36e8079d8a005550c5281ecebb4b7b622cc41b1

 .../apache/kafka/common/record/MemoryRecords.java  |  9 ++++-
 core/src/main/scala/kafka/log/Log.scala            | 35 ++++++++++++++-----
 core/src/main/scala/kafka/log/LogCleaner.scala     |  8 +++--
 core/src/main/scala/kafka/log/LogSegment.scala     | 13 +++++--
 core/src/main/scala/kafka/log/OffsetIndex.scala    |  2 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 38 ++++++++++----------
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 40 ++++++++++++++++++++++
 7 files changed, 109 insertions(+), 36 deletions(-)
7226d6ed9d4e61395c624ee875a2b12972ede664

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 50 +++++++++++++++++++++--
 1 file changed, 46 insertions(+), 4 deletions(-)
908b6d1148df963d21a70aaa73a7a87571b965a9

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 50 +++++++++++++++++++++--
 1 file changed, 46 insertions(+), 4 deletions(-)
a9687bc0d8ddab27c83f7e6f3e87d9e74e32c8df

 core/src/main/scala/kafka/log/LogCleaner.scala     |  8 +++---
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 29 ++++++++++++++++++++++
 2 files changed, 33 insertions(+), 4 deletions(-)
f10ef2720b03b247883db7e02afb767203176ea3

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
ea724497a85e922af6acccd02d7e7466871fb339

 .../org/apache/kafka/streams/KafkaStreams.java     | 24 +++++++++++++++----
 .../streams/processor/internals/StreamThread.java  |  7 +++---
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  8 +++++++
 .../integration/QueryableStateIntegrationTest.java | 27 +++++++++++++++-------
 .../processor/internals/StreamThreadTest.java      |  2 +-
 5 files changed, 50 insertions(+), 18 deletions(-)
70499381658e85cfdcfc4f0cd65424b92a8620cd

 tests/kafkatest/tests/streams/streams_smoke_test.py | 1 -
 1 file changed, 1 deletion(-)
395e85412fc3881c9f28c8c5382459236a1d4670

 core/src/main/scala/kafka/log/LogCleaner.scala     |  6 ++---
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 29 ++++++++++++++++++++++
 2 files changed, 32 insertions(+), 3 deletions(-)
1ba2ee80e06470aed367e3b0dcae6d13f1240a75

 .../org/apache/kafka/clients/consumer/internals/AbstractCoordinator.java | 1 +
 1 file changed, 1 insertion(+)
53428694a624a1956cb8fa3a6a674638f9b09816

 docs/api.html            |  158 +--
 docs/configuration.html  |  474 ++++----
 docs/connect.html        |  594 +++++-----
 docs/design.html         | 1130 +++++++++----------
 docs/documentation.html  |    2 +
 docs/implementation.html |  778 +++++++-------
 docs/introduction.html   |  386 +++----
 docs/js/templateData.js  |   21 +
 docs/ops.html            | 2686 +++++++++++++++++++++++-----------------------
 docs/security.html       | 1350 +++++++++++------------
 docs/streams.html        |  737 +++++++------
 11 files changed, 4215 insertions(+), 4101 deletions(-)
448f194c70e7a66ae2f1a7e89c822032359b14c9

 .../kafka/streams/processor/TopologyBuilder.java      |  7 +++++++
 .../kafka/streams/kstream/KStreamBuilderTest.java     | 19 +++++++++++++++++++
 2 files changed, 26 insertions(+)
859113786957a36381222f21287a940767e92f1c

 .../apache/kafka/streams/errors/LockException.java |  36 ++++++
 .../processor/internals/ProcessorStateManager.java |  11 +-
 .../streams/processor/internals/StreamThread.java  | 123 ++++++++++++++++++---
 .../processor/internals/StreamThreadTest.java      |  88 ++++++++++++++-
 4 files changed, 233 insertions(+), 25 deletions(-)
67f1e5b91bf073151ff57d5d656693e385726697

 checkstyle/import-control.xml                      |   1 +
 .../kafka/clients/consumer/internals/Fetcher.java  |   7 +-
 .../clients/producer/internals/BufferPool.java     |   2 +-
 .../producer/internals/RecordAccumulator.java      |  30 +-
 .../clients/producer/internals/RecordBatch.java    |  58 +-
 .../kafka/clients/producer/internals/Sender.java   |  10 +-
 .../kafka/common/record/AbstractRecords.java       |  92 ++++
 .../kafka/common/record/ByteBufferInputStream.java |  37 +-
 .../common/record/ByteBufferLogInputStream.java    | 119 ++++
 .../common/record/ByteBufferOutputStream.java      |  54 +-
 .../kafka/common/record/CompressionType.java       |   2 +-
 .../org/apache/kafka/common/record/Compressor.java | 332 -----------
 .../kafka/common/record/FileLogInputStream.java    | 166 ++++++
 .../apache/kafka/common/record/FileRecords.java    | 465 ++++++++++++++--
 .../common/record/InvalidRecordException.java      |   4 +-
 .../org/apache/kafka/common/record/LogEntry.java   | 151 ++++-
 .../apache/kafka/common/record/LogInputStream.java |  12 +-
 .../apache/kafka/common/record/MemoryRecords.java  | 443 +++++++++------
 .../kafka/common/record/MemoryRecordsBuilder.java  | 461 ++++++++++++++++
 .../org/apache/kafka/common/record/Record.java     | 538 ++++++++++++------
 .../org/apache/kafka/common/record/Records.java    |  64 ++-
 .../kafka/common/record/RecordsIterator.java       | 179 +++---
 .../apache/kafka/common/record/TimestampType.java  |   1 +
 .../java/org/apache/kafka/common/utils/Utils.java  |  51 ++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   7 +-
 .../clients/consumer/internals/FetcherTest.java    | 100 ++--
 .../producer/internals/RecordAccumulatorTest.java  |  51 +-
 .../record/ByteBufferLogInputStreamTest.java       | 110 ++++
 .../kafka/common/record/FileRecordsTest.java       | 410 ++++++++++++++
 .../common/record/MemoryRecordsBuilderTest.java    | 253 +++++++++
 .../kafka/common/record/MemoryRecordsTest.java     | 194 ++++++-
 .../org/apache/kafka/common/record/RecordTest.java |  46 +-
 .../kafka/common/record/SimpleRecordTest.java      |  52 +-
 .../kafka/common/record/TimestampTypeTest.java     |  37 ++
 .../test/java/org/apache/kafka/test/TestUtils.java |  32 +-
 core/src/main/scala/kafka/api/ApiVersion.scala     |  20 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  10 +-
 .../kafka/consumer/ConsumerFetcherThread.scala     |  10 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |   6 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 170 +++---
 core/src/main/scala/kafka/log/FileMessageSet.scala | 445 ---------------
 core/src/main/scala/kafka/log/Log.scala            | 128 ++---
 core/src/main/scala/kafka/log/LogCleaner.scala     |  55 +-
 core/src/main/scala/kafka/log/LogManager.scala     |   2 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  98 ++--
 core/src/main/scala/kafka/log/LogValidator.scala   | 239 ++++++++
 core/src/main/scala/kafka/log/TimeIndex.scala      |   6 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala | 613 +--------------------
 core/src/main/scala/kafka/message/Message.scala    |  64 +--
 .../scala/kafka/message/MessageAndOffset.scala     |  14 +-
 core/src/main/scala/kafka/message/MessageSet.scala |   8 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  10 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |   5 +-
 .../main/scala/kafka/server/FetchDataInfo.scala    |   7 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  32 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  22 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  85 +--
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 150 +++--
 .../kafka/tools/ReplicaVerificationTool.scala      |  52 +-
 .../api/GroupCoordinatorIntegrationTest.scala      |   6 +-
 .../test/scala/kafka/tools/TestLogCleaning.scala   |  19 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |  22 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  19 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |   2 +-
 .../coordinator/GroupCoordinatorResponseTest.scala |  30 +-
 .../coordinator/GroupMetadataManagerTest.scala     | 100 +++-
 .../unit/kafka/log/BrokerCompressionTest.scala     |  15 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  | 354 ------------
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  66 +--
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |  24 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |  29 +-
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 275 ++++-----
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  22 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 136 +++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 204 +++----
 .../scala/unit/kafka/log/LogValidatorTest.scala    | 395 +++++++++++++
 .../kafka/message/BaseMessageSetTestCases.scala    |  20 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   | 348 ------------
 .../kafka/message/MessageCompressionTest.scala     |   2 +-
 .../scala/unit/kafka/message/MessageTest.scala     |  38 +-
 .../kafka/server/AbstractFetcherThreadTest.scala   |  32 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |  53 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |  27 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  14 +-
 .../unit/kafka/server/ProduceRequestTest.scala     |   8 +-
 .../kafka/server/ReplicaManagerQuotasTest.scala    |  33 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  28 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  21 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  19 +-
 89 files changed, 5269 insertions(+), 3914 deletions(-)
6626b058c7893ce1192456b3fc7617f98da6f3cc

 docs/streams.html | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)
21d7e6f19bd36a7ad16291294fc933f9abfac9b7

 .../state/internals/CachingKeyValueStore.java      | 15 ++++++
 .../state/internals/CachingWindowStore.java        | 10 ++++
 .../kafka/streams/state/internals/NamedCache.java  |  8 +++
 .../kafka/streams/state/internals/ThreadCache.java |  9 ++++
 .../state/internals/CachingKeyValueStoreTest.java  | 62 +++++++++++++++++++++-
 .../state/internals/CachingWindowStoreTest.java    | 22 ++++++++
 .../streams/state/internals/ThreadCacheTest.java   | 11 ++++
 7 files changed, 135 insertions(+), 2 deletions(-)
efeaf129890c2195b4753d5b9eece4f1b7cdf756

 .../kafka/clients/consumer/KafkaConsumer.java      |  5 +--
 .../kafka/clients/consumer/internals/Fetcher.java  | 19 +++++++----
 .../consumer/internals/SubscriptionState.java      |  2 +-
 .../clients/consumer/internals/FetcherTest.java    | 38 +++++++++++-----------
 4 files changed, 36 insertions(+), 28 deletions(-)
f0acc4a0dd49c80929c36a073733c0147b2cd64a

 .../org/apache/kafka/clients/consumer/internals/AbstractCoordinator.java | 1 +
 1 file changed, 1 insertion(+)
62e043a86565cc9bc485658d6c6d176e9aff620f

 tests/kafkatest/benchmarks/core/benchmark_test.py  |  13 ++-
 .../streams/streams_simple_benchmark_test.py       |   5 +-
 .../sanity_checks/test_console_consumer.py         |  12 ++-
 .../kafkatest/sanity_checks/test_kafka_version.py  |   3 +
 .../sanity_checks/test_performance_services.py     |   2 +
 .../sanity_checks/test_verifiable_producer.py      |   2 +
 tests/kafkatest/services/connect.py                |   3 +-
 tests/kafkatest/services/console_consumer.py       |   5 +-
 tests/kafkatest/services/kafka/kafka.py            |  10 +-
 tests/kafkatest/services/kafka_log4j_appender.py   |   3 +-
 tests/kafkatest/services/mirror_maker.py           |   4 +-
 tests/kafkatest/services/monitor/jmx.py            |  44 ++++++---
 .../services/performance/producer_performance.py   |  12 ++-
 .../services/performance/streams_performance.py    |   2 +-
 .../services/replica_verification_tool.py          |   3 +-
 tests/kafkatest/services/security/minikdc.py       |  43 ++++++++-
 .../kafkatest/services/security/security_config.py |  49 ++++++----
 tests/kafkatest/services/verifiable_consumer.py    |   4 +-
 tests/kafkatest/services/verifiable_producer.py    | 102 ++++++++++++++-------
 tests/kafkatest/services/zookeeper.py              |   8 +-
 tests/kafkatest/tests/client/compression_test.py   |   3 +
 .../tests/client/consumer_rolling_upgrade_test.py  |   4 +-
 tests/kafkatest/tests/client/consumer_test.py      |  11 ++-
 .../tests/client/message_format_change_test.py     |   4 +-
 tests/kafkatest/tests/client/quota_test.py         |   2 +
 .../tests/connect/connect_distributed_test.py      |  30 +++---
 tests/kafkatest/tests/connect/connect_rest_test.py |   9 +-
 tests/kafkatest/tests/connect/connect_test.py      |  19 ++--
 .../core/compatibility_test_new_broker_test.py     |   4 +-
 .../tests/core/consumer_group_command_test.py      |   4 +
 .../kafkatest/tests/core/get_offset_shell_test.py  |   6 +-
 tests/kafkatest/tests/core/mirror_maker_test.py    |  13 ++-
 .../tests/core/reassign_partitions_test.py         |   3 +
 tests/kafkatest/tests/core/replication_test.py     |   5 +-
 .../tests/core/security_rolling_upgrade_test.py    |  12 ++-
 tests/kafkatest/tests/core/security_test.py        |  55 +++++++----
 .../tests/core/simple_consumer_shell_test.py       |   4 +
 tests/kafkatest/tests/core/throttling_test.py      |   2 +
 tests/kafkatest/tests/core/upgrade_test.py         |   5 +
 .../tests/core/zookeeper_security_upgrade_test.py  |   6 +-
 .../kafkatest/tests/streams/streams_bounce_test.py |   8 +-
 .../kafkatest/tests/streams/streams_smoke_test.py  |  11 ++-
 tests/kafkatest/tests/tools/log4j_appender_test.py |   8 +-
 .../tests/tools/replica_verification_test.py       |   8 +-
 tests/setup.py                                     |   2 +-
 45 files changed, 400 insertions(+), 167 deletions(-)
5b869e7ee4c6b554787330c386988b5447b127ca

 core/src/main/scala/kafka/log/LogCleaner.scala | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
6f7ed15dad8d914ae65a595eef327c0510f11469

 .../processor/internals/InternalTopicManager.java   |  2 +-
 .../internals/StreamPartitionAssignor.java          |  2 +-
 .../streams/processor/internals/StreamThread.java   | 21 ++++++++++++++++-----
 3 files changed, 18 insertions(+), 7 deletions(-)
1d586cb50a94540f6b931a8d525ba75273f314f0

 .../internals/StreamPartitionAssignor.java         | 28 ++++++---
 .../streams/integration/ResetIntegrationTest.java  | 54 +++++++---------
 .../internals/StreamPartitionAssignorTest.java     | 73 ++++++++++++++++++++++
 3 files changed, 114 insertions(+), 41 deletions(-)
8e9e1776790abb0a9b103f75d0231dd66d09e68f

 .../runtime/distributed/DistributedHerder.java     | 25 +++++++++++++---------
 .../runtime/distributed/DistributedHerderTest.java | 13 +++++++++++
 2 files changed, 28 insertions(+), 10 deletions(-)
7c7becd4cb88b372d199b05661f8efb1e1d022e6

 .../kafka/streams/processor/internals/StreamThread.java       | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)
9bed8fbcfc52ced719f2dcafa3f30cbfd5e6bd57

 checkstyle/import-control.xml                      |  2 +-
 docs/upgrade.html                                  | 13 ++++
 .../examples/pageview/JsonTimestampExtractor.java  |  2 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |  4 +-
 .../ConsumerRecordTimestampExtractor.java          | 40 -----------
 .../processor/ExtractRecordMetadataTimestamp.java  | 77 ++++++++++++++++++++++
 .../streams/processor/FailOnInvalidTimestamp.java  | 68 +++++++++++++++++++
 .../processor/LogAndSkipOnInvalidTimestamp.java    | 69 +++++++++++++++++++
 .../streams/processor/TimestampExtractor.java      | 12 ++--
 .../UsePreviousTimeOnInvalidTimestamp.java         | 70 ++++++++++++++++++++
 .../processor/WallclockTimestampExtractor.java     | 16 +++--
 .../streams/processor/internals/RecordQueue.java   |  9 +--
 .../streams/processor/internals/SinkNode.java      |  5 +-
 .../streams/processor/internals/StreamTask.java    | 15 +++--
 .../streams/processor/internals/StreamThread.java  |  8 ++-
 .../processor/FailOnInvalidTimestampTest.java      | 36 ++++++++++
 .../LogAndSkipOnInvalidTimestampTest.java          | 56 ++++++++++++++++
 .../streams/processor/TimestampExtractorTest.java  | 48 ++++++++++++++
 .../UsePreviousTimeOnInvalidTimestampTest.java     | 45 +++++++++++++
 .../processor/WallclockTimestampExtractorTest.java | 62 +++++++++++++++++
 .../processor/internals/ProcessorTopologyTest.java | 10 +--
 .../processor/internals/RecordQueueTest.java       | 22 +++++++
 .../streams/smoketest/TestTimestampExtractor.java  |  2 +-
 .../apache/kafka/test/MockTimestampExtractor.java  |  2 +-
 24 files changed, 617 insertions(+), 76 deletions(-)
7f8edbc8e848d22b1cb016a7208bee1e52a65b73

 .../kafka/clients/consumer/internals/Fetcher.java  | 45 ++++++++++++++++------
 1 file changed, 34 insertions(+), 11 deletions(-)
055ca9b7a235564f6766d1f2505e900db2d17a4f

 bin/windows/connect-distributed.bat | 34 ++++++++++++++++++++++++++++++++++
 bin/windows/connect-standalone.bat  | 34 ++++++++++++++++++++++++++++++++++
 2 files changed, 68 insertions(+)
9684487b43234b0800d31f689bde48422b7faf87

 clients/src/main/java/org/apache/kafka/common/metrics/Metrics.java       | 1 +
 .../java/org/apache/kafka/common/security/kerberos/KerberosLogin.java    | 1 +
 clients/src/main/java/org/apache/kafka/common/utils/SystemTime.java      | 1 +
 clients/src/main/java/org/apache/kafka/common/utils/Utils.java           | 1 +
 4 files changed, 4 insertions(+)
36528df088a28b4373f148627627d7c116297209

 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java     | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
01d58ad8e039181ade742cf896a08199e3cb7483

 build.gradle               | 2 +-
 gradle/dependencies.gradle | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
006630fd93d8efb823e5b5f7d61584138df984a6

 .../org/apache/kafka/common/metrics/Metrics.java   |  4 +++
 .../main/scala/kafka/network/SocketServer.scala    |  7 +++--
 .../unit/kafka/network/SocketServerTest.scala      | 34 ++++++++++++++++------
 3 files changed, 33 insertions(+), 12 deletions(-)
1949a76bc4189534b853e21c476bb11172fa3fc9

 .../kafka/streams/kstream/KGroupedStream.java      |  634 ++++--
 .../org/apache/kafka/streams/kstream/KStream.java  | 2020 +++++++++++++++-----
 2 files changed, 2028 insertions(+), 626 deletions(-)
600859e77c8e9a93212815ac26a6ae8b778fee6f

 .../kafka/streams/processor/internals/StateDirectory.java   | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)
442543fd9c3acbdf41fac0a73d4ef938b1163e4c

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
dce2e3f593aba3195ceef5ec506b2182d51505eb

 .../kafka/streams/state/internals/NamedCache.java  | 55 +++++++++++++---
 .../kafka/streams/state/internals/ThreadCache.java | 13 +++-
 .../internals/KTableKTableLeftJoinTest.java        | 74 +++++++++++++++++++++-
 .../streams/state/internals/NamedCacheTest.java    | 62 ++++++++++++++++++
 .../streams/state/internals/ThreadCacheTest.java   | 34 ++++++++++
 5 files changed, 224 insertions(+), 14 deletions(-)
e9a67a8daaf4be35f292dd06ae3c7797200658fa

 .../kafka/streams/state/internals/NamedCache.java  | 55 ++++++++++++++---
 .../kafka/streams/state/internals/ThreadCache.java | 12 +++-
 .../internals/KTableKTableLeftJoinTest.java        | 72 ++++++++++++++++++++++
 .../streams/state/internals/NamedCacheTest.java    | 62 +++++++++++++++++++
 .../streams/state/internals/ThreadCacheTest.java   | 34 ++++++++++
 5 files changed, 222 insertions(+), 13 deletions(-)
56e5627da5bfa01d1fa95e760a6f45949f89996a

 .../PreferredReplicaLeaderElectionCommand.scala    | 34 +++++++---------------
 1 file changed, 11 insertions(+), 23 deletions(-)
febfa11692f1b8b65a197861f06967a9e4688e18

 tests/kafkatest/tests/streams/streams_smoke_test.py | 1 -
 1 file changed, 1 deletion(-)
9e72c12e9811811997b6ca99a6dc56a9af46e43d

 core/src/main/scala/kafka/cluster/Partition.scala | 32 +++++++++++++++++------
 1 file changed, 24 insertions(+), 8 deletions(-)
c1385887fc02e3bd393c18f36e97101faad9b97d

 tests/kafkatest/tests/streams/streams_smoke_test.py | 1 +
 1 file changed, 1 insertion(+)
b6af35161caa7629ee8c75ab400556cb1ea9c1fd

 tests/kafkatest/tests/streams/streams_smoke_test.py | 1 +
 1 file changed, 1 insertion(+)
c9e99f297f3090cd348e231dbeaf69c388de1234

 .../runtime/distributed/DistributedHerder.java     | 42 ++++++++++++----------
 1 file changed, 23 insertions(+), 19 deletions(-)
88db95c5733adf91782cc93c7e89c7ca28c13fc3

 tests/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1845bb5d2efb9235e333f61e31656ac94b6ff11d

 tests/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
39f62ddcec9f3f915b3ca5941429e79190c93e7b

 tests/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
abfee8549b920ca88b008b59f651324ce0b0c05e

 .../processor/internals/RecordCollector.java       | 113 +++----------------
 .../processor/internals/RecordCollectorImpl.java   | 123 +++++++++++++++++++++
 .../processor/internals/StandbyContextImpl.java    |  27 ++++-
 .../streams/processor/internals/StreamTask.java    |   4 +-
 .../integration/QueryableStateIntegrationTest.java |   1 +
 .../processor/internals/RecordCollectorTest.java   |   8 +-
 .../streams/processor/internals/SinkNodeTest.java  | 117 ++------------------
 .../processor/internals/StandbyTaskTest.java       |  31 ++++++
 .../streams/state/KeyValueStoreTestDriver.java     |   3 +-
 .../state/internals/RocksDBWindowStoreTest.java    |  25 +++--
 .../state/internals/StoreChangeLoggerTest.java     |   4 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |   4 +-
 .../apache/kafka/test/MockProcessorContext.java    |   6 +-
 .../org/apache/kafka/test/NoOpRecordCollector.java |   4 +-
 14 files changed, 232 insertions(+), 238 deletions(-)
02e75a27ce1b2a34a54142cfd3c6bf0931c94c10

 .../scala/kafka/coordinator/DelayedHeartbeat.scala |  5 ++
 .../main/scala/kafka/coordinator/DelayedJoin.scala |  8 +-
 .../main/scala/kafka/server/DelayedOperation.scala | 93 ++++++++++++----------
 .../other/kafka/TestPurgatoryPerformance.scala     |  1 -
 .../unit/kafka/server/DelayedOperationTest.scala   |  4 +-
 5 files changed, 62 insertions(+), 49 deletions(-)
a4592a18641f84a1983c5fe7e697a8b0ab43eb25

 .../processor/internals/RecordCollector.java       | 113 +++----------------
 .../processor/internals/RecordCollectorImpl.java   | 123 +++++++++++++++++++++
 .../processor/internals/StandbyContextImpl.java    |  27 ++++-
 .../streams/processor/internals/StreamTask.java    |   4 +-
 .../integration/QueryableStateIntegrationTest.java |   1 +
 .../processor/internals/RecordCollectorTest.java   |   8 +-
 .../streams/processor/internals/SinkNodeTest.java  |   4 +-
 .../processor/internals/StandbyTaskTest.java       |  31 ++++++
 .../streams/state/KeyValueStoreTestDriver.java     |   3 +-
 .../state/internals/RocksDBWindowStoreTest.java    |  25 +++--
 .../state/internals/StoreChangeLoggerTest.java     |   4 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |   4 +-
 .../apache/kafka/test/MockProcessorContext.java    |   6 +-
 .../org/apache/kafka/test/NoOpRecordCollector.java |   4 +-
 14 files changed, 226 insertions(+), 131 deletions(-)
8fd5b6a6669b5e2ba921904596a14936b1317304

 .../org/apache/kafka/streams/integration/ResetIntegrationTest.java  | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
f46032f64299d0c1c263fdd242efc5f78c7ec138

 .../scala/kafka/coordinator/GroupCoordinator.scala | 24 +++++++++------
 .../kafka/coordinator/GroupCoordinatorTest.scala   | 36 ++++++++++++++++++++++
 2 files changed, 50 insertions(+), 10 deletions(-)
f4f0f8222276b630b61355b30827bf1b50160712

 .../scala/kafka/coordinator/GroupCoordinator.scala | 24 +++++++++------
 .../kafka/coordinator/GroupCoordinatorTest.scala   | 36 ++++++++++++++++++++++
 2 files changed, 50 insertions(+), 10 deletions(-)
34aa538bf3e0a38fe61de66a4536dfe48a6cdc57

 .../apache/kafka/connect/util/KafkaBasedLog.java   |  9 ++---
 .../kafka/connect/util/KafkaBasedLogTest.java      | 38 ++++++++++++++++++++++
 2 files changed, 43 insertions(+), 4 deletions(-)
a55e2963116eb11252b957304b4f399eff3df9c2

 .../scala/kafka/coordinator/DelayedHeartbeat.scala |  5 ++
 .../main/scala/kafka/coordinator/DelayedJoin.scala |  8 +-
 .../main/scala/kafka/server/DelayedOperation.scala | 90 ++++++++++++----------
 .../other/kafka/TestPurgatoryPerformance.scala     |  1 -
 .../unit/kafka/server/DelayedOperationTest.scala   |  4 +-
 5 files changed, 61 insertions(+), 47 deletions(-)
c4766089f75c0e3627dbd3d596256622d0c1beb7

 core/src/main/scala/kafka/log/Log.scala            | 12 ++++++-----
 .../main/scala/kafka/log/LogCleanerManager.scala   |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 23 ++++++++++++----------
 .../scala/unit/kafka/server/LogOffsetTest.scala    | 19 ++++++++++++++++++
 4 files changed, 40 insertions(+), 16 deletions(-)
2d19ad4bb07b4f10f2a314e86bbf4171cdcd7765

 core/src/main/scala/kafka/log/Log.scala            | 12 ++++++-----
 .../main/scala/kafka/log/LogCleanerManager.scala   |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 23 ++++++++++++----------
 .../scala/unit/kafka/server/LogOffsetTest.scala    | 19 ++++++++++++++++++
 4 files changed, 40 insertions(+), 16 deletions(-)
e43bbce493192ea5f936867e8cdae163ab850650

 core/src/main/scala/kafka/log/Log.scala | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)
5908a2523995505bb9da8a47a0da2b713569f805

 core/src/main/scala/kafka/cluster/Partition.scala  |   2 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 116 +++++++++------------
 .../coordinator/GroupMetadataManagerTest.scala     |  67 +++++++++++-
 3 files changed, 113 insertions(+), 72 deletions(-)
b06fc322bf008f55bb8b14c5b02c9af5a90a92ed

 core/src/main/scala/kafka/cluster/Partition.scala  |   2 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 116 +++++++++------------
 .../coordinator/GroupMetadataManagerTest.scala     |  67 +++++++++++-
 3 files changed, 113 insertions(+), 72 deletions(-)
93804d50ffc40fb6cdc61c073f4a62f0931f042d

 .../apache/kafka/streams/processor/internals/StreamThread.java    | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
128d0ff91d84a3a1f5a5237133f9ec01caf18d66

 .../kafka/clients/consumer/KafkaConsumer.java      |  3 +-
 .../kafka/clients/producer/KafkaProducer.java      |  5 +-
 .../org/apache/kafka/common/metrics/Metrics.java   |  3 +-
 .../common/security/kerberos/KerberosLogin.java    |  5 +-
 .../org/apache/kafka/common/utils/SystemTime.java  | 10 +++-
 .../java/org/apache/kafka/common/utils/Time.java   | 23 +++++++-
 .../clients/producer/internals/BufferPoolTest.java | 11 ++--
 .../producer/internals/RecordAccumulatorTest.java  |  5 +-
 .../org/apache/kafka/common/utils/MockTime.java    | 39 ++++++++++---
 .../org/apache/kafka/test/Microbenchmarks.java     |  4 +-
 .../kafka/connect/cli/ConnectDistributed.java      |  3 +-
 .../kafka/connect/cli/ConnectStandalone.java       |  3 +-
 .../connect/storage/KafkaConfigBackingStore.java   |  4 +-
 .../connect/storage/KafkaOffsetBackingStore.java   |  4 +-
 .../connect/runtime/WorkerSourceTaskTest.java      |  4 +-
 .../org/apache/kafka/connect/util/MockTime.java    | 16 ++++--
 core/src/main/scala/kafka/admin/AdminClient.scala  |  7 +--
 core/src/main/scala/kafka/cluster/Partition.scala  |  1 +
 core/src/main/scala/kafka/cluster/Replica.scala    |  9 +--
 .../common/ZkNodeChangeNotificationListener.scala  |  8 ++-
 .../kafka/consumer/ConsumerFetcherManager.scala    |  9 ++-
 .../consumer/ZookeeperConsumerConnector.scala      |  3 +-
 .../scala/kafka/controller/KafkaController.scala   |  2 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |  3 +-
 core/src/main/scala/kafka/log/Log.scala            | 23 ++++----
 core/src/main/scala/kafka/log/LogCleaner.scala     |  5 +-
 .../main/scala/kafka/log/LogCleanerManager.scala   |  3 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  3 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  8 +--
 .../main/scala/kafka/network/RequestChannel.scala  |  9 +--
 .../kafka/producer/async/DefaultEventHandler.scala | 16 +++---
 .../kafka/producer/async/ProducerSendThread.scala  | 14 +++--
 .../main/scala/kafka/server/DelayedOperation.scala |  2 -
 .../scala/kafka/server/DynamicConfigManager.scala  |  9 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 19 ++++---
 .../scala/kafka/server/KafkaRequestHandler.scala   | 15 +++--
 core/src/main/scala/kafka/server/KafkaServer.scala | 35 ++++++------
 .../main/scala/kafka/server/ReplicaManager.scala   |  9 ++-
 .../kafka/server/ZookeeperLeaderElector.scala      |  8 ++-
 .../kafka/tools/ReplicaVerificationTool.scala      | 16 ++++--
 .../kafka/tools/SimpleConsumerPerformance.scala    |  6 +-
 core/src/main/scala/kafka/utils/DelayedItem.scala  | 12 ++--
 .../kafka/utils/NetworkClientBlockingOps.scala     | 10 ++--
 core/src/main/scala/kafka/utils/Throttler.scala    | 31 +++++++----
 core/src/main/scala/kafka/utils/Time.scala         | 65 ----------------------
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  3 +-
 core/src/main/scala/kafka/utils/timer/Timer.scala  |  7 +--
 .../scala/kafka/utils/timer/TimerTaskList.scala    |  9 +--
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  4 +-
 .../other/kafka/TestPurgatoryPerformance.scala     |  5 +-
 .../api/RequestResponseSerializationTest.scala     | 14 ++---
 .../ZkNodeChangeNotificationListenerTest.scala     |  2 +-
 .../kafka/controller/ControllerFailoverTest.scala  |  6 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |  2 +-
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |  2 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |  2 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 11 ++--
 .../unit/kafka/network/SocketServerTest.scala      | 12 ++--
 .../unit/kafka/producer/AsyncProducerTest.scala    |  2 +
 .../scala/unit/kafka/producer/ProducerTest.scala   |  5 +-
 .../unit/kafka/producer/SyncProducerTest.scala     | 13 +++--
 .../unit/kafka/server/DelayedOperationTest.scala   |  6 +-
 .../server/HighwatermarkPersistenceTest.scala      | 21 +++----
 .../unit/kafka/server/ISRExpirationTest.scala      | 11 ++--
 .../unit/kafka/server/LeaderElectionTest.scala     |  4 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  2 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  9 +--
 .../kafka/server/ReplicaManagerQuotasTest.scala    |  6 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 18 +++---
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  6 +-
 .../scala/unit/kafka/utils/MockScheduler.scala     |  2 +
 .../src/test/scala/unit/kafka/utils/MockTime.scala | 43 ++++----------
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  5 +-
 .../org/apache/kafka/streams/KafkaStreams.java     |  4 +-
 .../state/internals/MeteredKeyValueStore.java      |  3 +-
 .../state/internals/MeteredWindowStore.java        |  3 +-
 .../integration/RegexSourceIntegrationTest.java    |  9 ++-
 .../streams/integration/ResetIntegrationTest.java  | 47 ++++++++++------
 .../integration/utils/EmbeddedKafkaCluster.java    | 25 ++++++---
 .../integration/utils/IntegrationTestUtils.java    |  2 +-
 .../internals/StreamPartitionAssignorTest.java     | 30 +++++-----
 .../processor/internals/StreamThreadTest.java      |  4 +-
 .../StreamThreadStateStoreProviderTest.java        |  6 +-
 83 files changed, 435 insertions(+), 432 deletions(-)
0e20e5fbfe683257882f0426357b6c2e75bcacca

 .../kafka/coordinator/GroupMetadataManager.scala   | 106 ++++++++++-----------
 1 file changed, 48 insertions(+), 58 deletions(-)
ea370be518a783f3a5d8d834f78c82e36bf968b3

 .../kafka/coordinator/GroupMetadataManager.scala   | 106 ++++++++++-----------
 1 file changed, 48 insertions(+), 58 deletions(-)
b45a67ede9021985c8df87c633b225231092c0c9

 .../org/apache/kafka/connect/sink/SinkTask.java    |  27 ++-
 .../apache/kafka/connect/sink/SinkTaskContext.java |   9 +
 .../kafka/connect/runtime/WorkerSinkTask.java      |  71 ++++++--
 .../connect/runtime/WorkerSinkTaskContext.java     |  15 ++
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 192 +++++++++++++++++++--
 .../runtime/WorkerSinkTaskThreadedTest.java        |  38 ++--
 6 files changed, 301 insertions(+), 51 deletions(-)
b65f9a777d46fbe4edfed8a4c7216dd1e741be53

 .../connect/runtime/SourceTaskOffsetCommitter.java | 104 +++++------
 .../org/apache/kafka/connect/runtime/Worker.java   | 173 +++++++++++++-----
 .../apache/kafka/connect/runtime/WorkerTask.java   |   2 +-
 .../runtime/distributed/DistributedHerder.java     | 178 ++++++++++++++-----
 .../runtime/SourceTaskOffsetCommitterTest.java     | 194 +++++++++++++++++++++
 .../apache/kafka/connect/runtime/WorkerTest.java   |  14 --
 .../runtime/distributed/DistributedHerderTest.java |  59 ++++---
 .../runtime/standalone/StandaloneHerderTest.java   |  12 +-
 8 files changed, 539 insertions(+), 197 deletions(-)
88d8508b85bb11d452658ff5c32afcb12c314f9a

 .../src/main/scala/kafka/controller/KafkaController.scala | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)
9ffadbfdc6f1b1fc47d48cbb7edf0f2f3a5f8f5e

 build.gradle                                           | 4 ++--
 core/src/main/scala/kafka/utils/IteratorTemplate.scala | 2 +-
 gradle/dependencies.gradle                             | 7 +++++--
 3 files changed, 8 insertions(+), 5 deletions(-)
ea42d65354b5905668d45dedae1cd1f7f39c888c

 .../org/apache/kafka/streams/KafkaStreams.java     | 144 ++++++++++++++++++---
 .../streams/processor/internals/StreamThread.java  | 140 +++++++++++++++++---
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  28 +++-
 .../integration/QueryableStateIntegrationTest.java |   2 +
 .../processor/internals/StreamThreadTest.java      |  36 +++++-
 5 files changed, 309 insertions(+), 41 deletions(-)
aec74ae5b2cd1815fce0227b0f2773ca972457bf

 .../kafka/clients/consumer/internals/Fetcher.java  | 82 +++++++++++-----------
 1 file changed, 41 insertions(+), 41 deletions(-)
f9d7808bab52a0a6fa879aaac0b1da80e0f33adb

 .../kafka/clients/consumer/internals/Fetcher.java  | 82 +++++++++++-----------
 1 file changed, 41 insertions(+), 41 deletions(-)
b1f8fc7b6e40f371ebf5617b5f7f8b7ca5693903

 bin/windows/kafka-server-start.bat | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
8d188c9110f7f2a6f9f16f1340d9d254bf583741

 bin/windows/kafka-server-start.bat | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
497e669dd806fc984f5dceaede4a1f40f4e77c48

 core/src/main/scala/kafka/cluster/Partition.scala  |  5 +-
 core/src/main/scala/kafka/log/AbstractIndex.scala  | 23 +++---
 core/src/main/scala/kafka/log/Log.scala            | 31 +++++---
 core/src/main/scala/kafka/log/LogManager.scala     | 91 +++++++++++++++++-----
 .../main/scala/kafka/server/ReplicaManager.scala   | 17 ++--
 5 files changed, 114 insertions(+), 53 deletions(-)
1503f7603c1d5e0511bf71175d84bde555c80e9a

 .../kafka/clients/consumer/KafkaConsumer.java      | 32 +++++++++++++++-
 .../clients/consumer/OffsetCommitCallback.java     |  2 +
 .../consumer/internals/AbstractCoordinator.java    |  4 +-
 .../consumer/internals/ConsumerCoordinator.java    |  7 ++--
 .../consumer/internals/ConsumerNetworkClient.java  | 13 +++++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 43 ++++++++++++++++++++++
 docs/upgrade.html                                  | 11 ++++++
 7 files changed, 106 insertions(+), 6 deletions(-)
5819b06fafd8a1a32276018560e0ff731191caf5

 .../apache/kafka/connect/util/KafkaBasedLog.java   | 29 ++--------------------
 .../kafka/connect/util/KafkaBasedLogTest.java      | 14 +++--------
 2 files changed, 6 insertions(+), 37 deletions(-)
d98ca230a14b0aedae752fa97f5d55b3a0c49b9c

 .../kafka/connect/cli/ConnectDistributed.java      |  3 +-
 .../kafka/connect/storage/ConfigBackingStore.java  |  3 -
 .../connect/storage/KafkaConfigBackingStore.java   | 75 +++++++++++-----------
 .../connect/storage/KafkaStatusBackingStore.java   |  4 +-
 .../connect/storage/MemoryConfigBackingStore.java  |  5 --
 .../storage/KafkaConfigBackingStoreTest.java       | 30 +++++----
 6 files changed, 58 insertions(+), 62 deletions(-)
f37dab76f494e313eafc4f64d0eeaed82ddad0f7

 .../controller/ControllerChannelManager.scala      | 94 +++++++++++-----------
 1 file changed, 45 insertions(+), 49 deletions(-)
b11ead58041f6618b4d585dda32f2d71ef0da46a

 release_notes.py | 23 ++++++++++++++++++++---
 1 file changed, 20 insertions(+), 3 deletions(-)
7d0f3e75ad2934b8ad5b84f81707b01285022523

 .../internals/StreamPartitionAssignor.java         | 19 +++++----
 .../internals/SingleGroupPartitionGrouperStub.java | 47 ++++++++++++++++++++++
 .../internals/StreamPartitionAssignorTest.java     | 40 ++++++++++++++++++
 3 files changed, 98 insertions(+), 8 deletions(-)
7d3aa01ced15d30cd1c5390e76a68a06403cd2c1

 core/src/main/scala/kafka/api/ApiUtils.scala       | 11 ------
 core/src/main/scala/kafka/api/LeaderAndIsr.scala   | 44 +---------------------
 .../scala/kafka/api/TopicMetadataRequest.scala     |  2 -
 3 files changed, 1 insertion(+), 56 deletions(-)
7ed3768fb6e16ec97815e1676d27833569ec2a98

 core/src/main/scala/kafka/controller/KafkaController.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
6f0cbe7212ba9124488d13e00a24a23e083cb918

 docs/ops.html | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
a5d28149fb67ab68d9de7d8de63c0de93b80a82c

 .travis.yml                                        |  48 ----
 gradle/wrapper/gradle-wrapper.jar                  | Bin 52928 -> 0 bytes
 gradle/wrapper/gradle-wrapper.properties           |   6 -
 tests/README.md                                    |  37 ---
 tests/cluster_file.json                            |  97 -------
 tests/kafkatest/directory_layout/kafka_path.py     |  10 +-
 tests/kafkatest/services/mirror_maker.py           |   4 +-
 tests/kafkatest/tests/client/__init__.py           |  14 +
 tests/kafkatest/tests/client/compression_test.py   |  85 ++++++
 .../tests/client/consumer_rolling_upgrade_test.py  |  82 ++++++
 tests/kafkatest/tests/client/consumer_test.py      | 297 +++++++++++++++++++++
 .../tests/client/message_format_change_test.py     |  90 +++++++
 tests/kafkatest/tests/client/quota_test.py         | 219 +++++++++++++++
 tests/kafkatest/tests/client1/__init__.py          |   0
 .../tests/client1/consumer_rolling_upgrade_test.py |  82 ------
 .../tests/client1/message_format_change_test.py    |  90 -------
 tests/kafkatest/tests/client1/quota_test.py        | 219 ---------------
 tests/kafkatest/tests/client2/__init__.py          |  14 -
 tests/kafkatest/tests/client2/compression_test.py  |  85 ------
 tests/kafkatest/tests/client2/consumer_test.py     | 297 ---------------------
 tests/kafkatest/tests/core/__init__.py             |  14 +
 .../core/compatibility_test_new_broker_test.py     |  80 ++++++
 .../tests/core/consumer_group_command_test.py      | 106 ++++++++
 .../kafkatest/tests/core/get_offset_shell_test.py  |  91 +++++++
 tests/kafkatest/tests/core/mirror_maker_test.py    | 179 +++++++++++++
 .../tests/core/reassign_partitions_test.py         | 110 ++++++++
 tests/kafkatest/tests/core/replication_test.py     | 154 +++++++++++
 .../tests/core/security_rolling_upgrade_test.py    | 190 +++++++++++++
 tests/kafkatest/tests/core/security_test.py        | 106 ++++++++
 .../tests/core/simple_consumer_shell_test.py       |  75 ++++++
 tests/kafkatest/tests/core/throttling_test.py      | 173 ++++++++++++
 tests/kafkatest/tests/core/upgrade_test.py         | 128 +++++++++
 .../tests/core/zookeeper_security_upgrade_test.py  | 115 ++++++++
 tests/kafkatest/tests/core1/__init__.py            |   0
 .../tests/core1/consumer_group_command_test.py     | 106 --------
 .../kafkatest/tests/core1/get_offset_shell_test.py |  91 -------
 .../tests/core1/reassign_partitions_test.py        | 110 --------
 .../tests/core1/simple_consumer_shell_test.py      |  75 ------
 tests/kafkatest/tests/core1/throttling_test.py     | 173 ------------
 tests/kafkatest/tests/core2/__init__.py            |  14 -
 .../core2/compatibility_test_new_broker_test.py    |  80 ------
 tests/kafkatest/tests/mirror_maker/__init__.py     |   0
 .../tests/mirror_maker/mirror_maker_test.py        | 179 -------------
 tests/kafkatest/tests/produce_consume_validate.py  |   3 +-
 tests/kafkatest/tests/replication/__init__.py      |   0
 .../tests/replication/replication_test.py          | 154 -----------
 tests/kafkatest/tests/security1/__init__.py        |   0
 tests/kafkatest/tests/security1/security_test.py   | 106 --------
 .../security1/zookeeper_security_upgrade_test.py   | 115 --------
 tests/kafkatest/tests/security2/__init__.py        |   0
 .../security2/security_rolling_upgrade_test.py     | 190 -------------
 tests/kafkatest/tests/upgrade/__init__.py          |   0
 tests/kafkatest/tests/upgrade/upgrade_test.py      | 128 ---------
 tests/travis/Dockerfile                            |  38 ---
 tests/travis/run_tests.sh                          |  58 ----
 tests/travis/ssh/authorized_keys                   |  15 --
 tests/travis/ssh/config                            |  21 --
 tests/travis/ssh/id_rsa                            |  27 --
 tests/travis/ssh/id_rsa.pub                        |   1 -
 59 files changed, 2316 insertions(+), 2665 deletions(-)
ee0ab7dd0fefacb93cbb2a91217b13288042bb35

 .../scala/kafka/server/AbstractFetcherThread.scala | 18 ++--
 .../kafka/server/AbstractFetcherThreadTest.scala   | 99 ++++++++++++++++++++--
 2 files changed, 101 insertions(+), 16 deletions(-)
3e3b7a010be9959ac6f205a0ea66a2595bb62ae6

 .../scala/kafka/server/AbstractFetcherThread.scala | 18 ++--
 .../kafka/server/AbstractFetcherThreadTest.scala   | 99 ++++++++++++++++++++--
 2 files changed, 101 insertions(+), 16 deletions(-)
68e7af812b94494e5798f3644b569e454036ac12

 .../kafka/streams/processor/DefaultPartitionGrouper.java   | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)
ecb51680a982120691becc37c302aa78135dcfdf

 .../main/scala/kafka/tools/StreamsResetter.java    |   8 +-
 .../streams/integration/ResetIntegrationTest.java  | 195 +++++++++++++++++----
 2 files changed, 164 insertions(+), 39 deletions(-)
e035fc039598127e88f31739458f705290b1fdba

 .travis.yml                                        |  48 ++++
 gradle/wrapper/gradle-wrapper.jar                  | Bin 0 -> 52928 bytes
 gradle/wrapper/gradle-wrapper.properties           |   6 +
 tests/README.md                                    |  37 +++
 tests/cluster_file.json                            |  97 +++++++
 tests/kafkatest/directory_layout/kafka_path.py     |  10 +-
 tests/kafkatest/services/mirror_maker.py           |   4 +-
 tests/kafkatest/tests/client/__init__.py           |  14 -
 tests/kafkatest/tests/client/compression_test.py   |  85 ------
 .../tests/client/consumer_rolling_upgrade_test.py  |  82 ------
 tests/kafkatest/tests/client/consumer_test.py      | 297 ---------------------
 .../tests/client/message_format_change_test.py     |  90 -------
 tests/kafkatest/tests/client/quota_test.py         | 219 ---------------
 tests/kafkatest/tests/client1/__init__.py          |   0
 .../tests/client1/consumer_rolling_upgrade_test.py |  82 ++++++
 .../tests/client1/message_format_change_test.py    |  90 +++++++
 tests/kafkatest/tests/client1/quota_test.py        | 219 +++++++++++++++
 tests/kafkatest/tests/client2/__init__.py          |  14 +
 tests/kafkatest/tests/client2/compression_test.py  |  85 ++++++
 tests/kafkatest/tests/client2/consumer_test.py     | 297 +++++++++++++++++++++
 tests/kafkatest/tests/core/__init__.py             |  14 -
 .../core/compatibility_test_new_broker_test.py     |  80 ------
 .../tests/core/consumer_group_command_test.py      | 106 --------
 .../kafkatest/tests/core/get_offset_shell_test.py  |  91 -------
 tests/kafkatest/tests/core/mirror_maker_test.py    | 179 -------------
 .../tests/core/reassign_partitions_test.py         | 110 --------
 tests/kafkatest/tests/core/replication_test.py     | 154 -----------
 .../tests/core/security_rolling_upgrade_test.py    | 190 -------------
 tests/kafkatest/tests/core/security_test.py        | 106 --------
 .../tests/core/simple_consumer_shell_test.py       |  75 ------
 tests/kafkatest/tests/core/throttling_test.py      | 173 ------------
 tests/kafkatest/tests/core/upgrade_test.py         | 128 ---------
 .../tests/core/zookeeper_security_upgrade_test.py  | 115 --------
 tests/kafkatest/tests/core1/__init__.py            |   0
 .../tests/core1/consumer_group_command_test.py     | 106 ++++++++
 .../kafkatest/tests/core1/get_offset_shell_test.py |  91 +++++++
 .../tests/core1/reassign_partitions_test.py        | 110 ++++++++
 .../tests/core1/simple_consumer_shell_test.py      |  75 ++++++
 tests/kafkatest/tests/core1/throttling_test.py     | 173 ++++++++++++
 tests/kafkatest/tests/core2/__init__.py            |  14 +
 .../core2/compatibility_test_new_broker_test.py    |  80 ++++++
 tests/kafkatest/tests/mirror_maker/__init__.py     |   0
 .../tests/mirror_maker/mirror_maker_test.py        | 179 +++++++++++++
 tests/kafkatest/tests/produce_consume_validate.py  |   3 +-
 tests/kafkatest/tests/replication/__init__.py      |   0
 .../tests/replication/replication_test.py          | 154 +++++++++++
 tests/kafkatest/tests/security1/__init__.py        |   0
 tests/kafkatest/tests/security1/security_test.py   | 106 ++++++++
 .../security1/zookeeper_security_upgrade_test.py   | 115 ++++++++
 tests/kafkatest/tests/security2/__init__.py        |   0
 .../security2/security_rolling_upgrade_test.py     | 190 +++++++++++++
 tests/kafkatest/tests/upgrade/__init__.py          |   0
 tests/kafkatest/tests/upgrade/upgrade_test.py      | 128 +++++++++
 tests/travis/Dockerfile                            |  38 +++
 tests/travis/run_tests.sh                          |  58 ++++
 tests/travis/ssh/authorized_keys                   |  15 ++
 tests/travis/ssh/config                            |  21 ++
 tests/travis/ssh/id_rsa                            |  27 ++
 tests/travis/ssh/id_rsa.pub                        |   1 +
 59 files changed, 2665 insertions(+), 2316 deletions(-)
724cddbc56fec227727db4caf75c77adb62438e6

 .../main/scala/kafka/tools/StreamsResetter.java    |   8 +-
 .../streams/integration/ResetIntegrationTest.java  | 196 +++++++++++++++++----
 2 files changed, 164 insertions(+), 40 deletions(-)
9d3003b32dfc744c478277123c8878fa65dd9ec7

 .../state/internals/CachingKeyValueStore.java      | 21 +++--
 .../internals/InMemoryKeyValueLoggedStore.java     | 23 ++----
 .../streams/state/internals/RocksDBStore.java      | 24 ++----
 .../state/internals/RocksDBWindowStore.java        | 26 ++-----
 .../streams/state/internals/StoreChangeLogger.java | 89 +++-------------------
 .../state/internals/RocksDBKeyValueStoreTest.java  |  8 +-
 .../state/internals/StoreChangeLoggerTest.java     | 53 ++++---------
 .../org/apache/kafka/test/KStreamTestDriver.java   |  5 +-
 8 files changed, 61 insertions(+), 188 deletions(-)
c000eb22ae82184f3ec2bfeb91609bef7a1e875d

 .../java/org/apache/kafka/streams/processor/internals/StreamThread.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c1fb615a6ef6cbd0a725bd70a2a602ca31402f8a

 .../internals/ForwardingCacheFlushListener.java    | 22 +++++--
 .../internals/InternalProcessorContext.java        |  1 +
 .../processor/internals/ProcessorContextImpl.java  | 13 ++--
 .../processor/internals/StandbyContextImpl.java    |  5 ++
 .../streams/processor/internals/StreamTask.java    | 28 +++------
 .../kafka/streams/state/internals/NamedCache.java  |  8 ++-
 .../kstream/internals/KTableAggregateTest.java     | 72 ++++++++++++++++++++++
 .../processor/internals/ProcessorTopologyTest.java |  1 +
 .../streams/state/KeyValueStoreTestDriver.java     |  7 +++
 .../streams/state/internals/NamedCacheTest.java    |  6 ++
 .../org/apache/kafka/test/KStreamTestDriver.java   | 23 ++++++-
 .../apache/kafka/test/MockProcessorContext.java    |  7 +++
 12 files changed, 160 insertions(+), 33 deletions(-)
f91d95ac9aa6c5fe9b7ee091b7759fee53e465d4

 .../org/apache/kafka/streams/StreamsConfig.java    | 21 +++++++----
 .../apache/kafka/streams/StreamsConfigTest.java    | 43 ++++++++++++++++++++++
 2 files changed, 56 insertions(+), 8 deletions(-)
34f987f60a49eb12b67d88fbbac35a2081dd4081

 streams/src/main/java/org/apache/kafka/streams/kstream/Windows.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
2dedd8d95aa56214f82822c54ff50e0ef9c4f2c8

 .../main/scala/kafka/tools/StreamsResetter.java    | 155 ++++++++++-----------
 1 file changed, 74 insertions(+), 81 deletions(-)
0a24d3a258a544314d8ea995157a351f9ca8994e

 .../streams/kstream/internals/KTableImpl.java      |  14 +-
 .../KTableKTableJoinIntegrationTest.java           | 280 +++++++++++++++++++++
 2 files changed, 287 insertions(+), 7 deletions(-)
4fdbc72fe099cbab200cc690f6075c69cbbefb4a

 .../kafka/streams/state/internals/ThreadCache.java | 14 ++++++--
 .../streams/state/internals/ThreadCacheTest.java   | 37 ++++++++++++++++++++++
 2 files changed, 48 insertions(+), 3 deletions(-)
3c0713923e41b15cb64e0c3c4d5aeb856ee9125d

 core/src/main/scala/kafka/log/LogConfig.scala          |  4 ++++
 core/src/main/scala/kafka/server/KafkaConfig.scala     |  7 +++----
 core/src/test/scala/unit/kafka/log/LogConfigTest.scala | 17 +++++++++++++++++
 3 files changed, 24 insertions(+), 4 deletions(-)
0ea540552a52b3265c48aacbb9790ea6e71431a5

 core/src/main/scala/kafka/log/LogConfig.scala          |  4 ++++
 core/src/main/scala/kafka/server/KafkaConfig.scala     |  7 +++----
 core/src/test/scala/unit/kafka/log/LogConfigTest.scala | 17 +++++++++++++++++
 3 files changed, 24 insertions(+), 4 deletions(-)
951c5500c1201ca860e8a12f63b898a05ba1a9fd

 .../scala/kafka/coordinator/GroupCoordinator.scala |  16 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 390 +++++++++++----------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  11 +
 .../coordinator/GroupMetadataManagerTest.scala     |  74 +++-
 4 files changed, 298 insertions(+), 193 deletions(-)
4b003d8bcfffded55a00b8ecc9eed8eb373fb6c7

 .../scala/kafka/coordinator/GroupCoordinator.scala |  16 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 390 +++++++++++----------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  11 +
 .../coordinator/GroupMetadataManagerTest.scala     |  74 +++-
 4 files changed, 298 insertions(+), 193 deletions(-)
dcea5f83888bb346c8ae20887b57904e046463a7

 .../streams/processor/DefaultPartitionGrouper.java | 19 ++++--
 .../internals/StreamPartitionAssignor.java         | 13 ++--
 .../internals/StreamPartitionAssignorTest.java     | 79 +++++++++++++++++++---
 3 files changed, 91 insertions(+), 20 deletions(-)
44f61ba4f96df995265f9cfa004aa49c82b02374

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
c8f70742e85eee38bf0749ba79d1be73a042c635

 tests/kafkatest/services/streams.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
bbe84051c724023171370f15d74188eecfeace49

 tests/kafkatest/services/streams.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e53babab9cada20cc54a18c0fd63aa5ab84fd012

 .../consumer/internals/ConsumerCoordinator.java    |  14 +++
 .../apache/kafka/common/network/KafkaChannel.java  |  21 +++-
 .../org/apache/kafka/common/network/Selector.java  | 133 +++++++++++++++------
 .../kafka/common/network/SslTransportLayer.java    |   8 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  81 +++++++++++++
 .../apache/kafka/common/network/NioEchoServer.java |  46 +++++--
 .../common/network/SslTransportLayerTest.java      |  48 +++++++-
 .../main/scala/kafka/network/SocketServer.scala    |  13 +-
 .../unit/kafka/network/SocketServerTest.scala      |  15 +++
 9 files changed, 321 insertions(+), 58 deletions(-)
edfa2806712da9663998195c1a7eed0c96bfa509

 .../scala/kafka/controller/ControllerChannelManager.scala     | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)
0e7ba70008fa8961ae55861a4dd3a5370d1d5a69

 core/src/main/scala/kafka/Kafka.scala              |  4 ++--
 core/src/main/scala/kafka/admin/AdminClient.scala  | 16 +++++++--------
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  8 ++------
 .../src/main/scala/kafka/admin/ConfigCommand.scala | 24 +++++++++++-----------
 core/src/main/scala/kafka/admin/TopicCommand.scala | 16 +++++++--------
 core/src/main/scala/kafka/api/FetchResponse.scala  |  8 ++++----
 .../main/scala/kafka/consumer/BaseConsumer.scala   | 22 +++++---------------
 .../consumer/ZookeeperConsumerConnector.scala      | 17 ++++++++-------
 .../consumer/ZookeeperTopicEventWatcher.scala      |  8 ++++----
 .../kafka/controller/PartitionStateMachine.scala   | 13 ++++--------
 .../kafka/controller/ReplicaStateMachine.scala     | 16 +++++++--------
 .../scala/kafka/javaapi/OffsetCommitRequest.scala  |  7 ++-----
 .../scala/kafka/javaapi/OffsetCommitResponse.scala |  7 ++-----
 .../scala/kafka/javaapi/OffsetFetchRequest.scala   | 10 ++-------
 .../scala/kafka/javaapi/OffsetFetchResponse.scala  |  7 ++-----
 .../main/scala/kafka/javaapi/OffsetRequest.scala   |  8 ++------
 .../main/scala/kafka/javaapi/TopicMetadata.scala   | 22 +++++---------------
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |  7 ++-----
 .../consumer/ZookeeperConsumerConnector.scala      | 11 ++++------
 core/src/main/scala/kafka/log/Log.scala            | 13 +++++-------
 core/src/main/scala/kafka/log/LogManager.scala     |  7 ++++---
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |  3 ++-
 .../scala/kafka/server/ClientQuotaManager.scala    |  4 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 22 ++++++++------------
 core/src/main/scala/kafka/server/KafkaConfig.scala | 19 +++--------------
 .../main/scala/kafka/tools/ConsoleProducer.scala   |  7 ++++---
 .../scala/kafka/tools/ConsumerPerformance.scala    | 16 ++++++++-------
 .../main/scala/kafka/tools/EndToEndLatency.scala   | 11 +++++-----
 .../main/scala/kafka/tools/ExportZkOffsets.scala   |  5 ++---
 core/src/main/scala/kafka/tools/JmxTool.scala      |  8 ++++----
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  6 +++---
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  4 ++--
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  4 ++--
 core/src/main/scala/kafka/utils/Pool.scala         | 18 ++++++----------
 .../scala/kafka/utils/VerifiableProperties.scala   |  8 +++-----
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 11 +++-------
 .../integration/kafka/api/AdminClientTest.scala    | 11 +++++-----
 .../integration/kafka/api/ConsumerBounceTest.scala | 17 ++++++++-------
 .../other/kafka/TestPurgatoryPerformance.scala     |  4 ++--
 .../javaapi/message/BaseMessageSetTestCases.scala  | 10 +++------
 .../unit/kafka/log/BrokerCompressionTest.scala     |  6 +++---
 .../scala/unit/kafka/metrics/MetricsTest.scala     |  6 +++---
 .../unit/kafka/server/ApiVersionsRequestTest.scala |  4 ++--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  3 +--
 44 files changed, 181 insertions(+), 277 deletions(-)
f7795a525179699ec6702c976e58c1d59ba8eb3c

 .../ConsumerRecordTimestampExtractor.java          | 52 +++++-----------------
 1 file changed, 11 insertions(+), 41 deletions(-)
079ea89b369f13d3c0edcab8dd3f6bd32a31983d

 build.gradle               | 21 +++++++++++----------
 docs/ops.html              |  2 +-
 docs/security.html         |  2 +-
 gradle/dependencies.gradle | 14 +++++++-------
 gradle/rat.gradle          |  2 +-
 5 files changed, 21 insertions(+), 20 deletions(-)
eaf0e4af341818b335d17400b0a02be87a7fff9b

 .../kafka/streams/kstream/KGroupedStream.java      |  88 ++++++++++++
 .../kafka/streams/kstream/KGroupedTable.java       |  47 +++++++
 .../streams/kstream/internals/AbstractStream.java  |  38 ++++++
 .../kstream/internals/KGroupedStreamImpl.java      | 148 ++++++++++++---------
 .../kstream/internals/KGroupedTableImpl.java       |  77 ++++++-----
 .../kstream/internals/KStreamAggregate.java        |   5 +-
 .../streams/kstream/internals/KStreamReduce.java   |   7 +-
 .../kstream/internals/KStreamWindowAggregate.java  |   9 +-
 .../kstream/internals/KStreamWindowReduce.java     |   7 +-
 .../streams/kstream/internals/KTableAggregate.java |   5 +-
 .../streams/kstream/internals/KTableReduce.java    |   7 +-
 .../streams/kstream/internals/KTableSource.java    |   7 +-
 .../streams/kstream/internals/TupleForwarder.java  |  51 +++++++
 .../streams/processor/StateStoreSupplier.java      |  11 +-
 .../state/internals/AbstractStoreSupplier.java     |   3 +-
 .../internals/InMemoryKeyValueStoreSupplier.java   |   4 +-
 .../internals/InMemoryLRUCacheStoreSupplier.java   |  13 +-
 .../internals/RocksDBKeyValueStoreSupplier.java    |  15 +--
 .../internals/RocksDBWindowStoreSupplier.java      |   6 +-
 .../kstream/internals/KGroupedStreamImplTest.java  |  25 +++-
 .../kstream/internals/KGroupedTableImplTest.java   |  19 ++-
 21 files changed, 442 insertions(+), 150 deletions(-)
2daa10d77f8f177a8db6ff5de5c511165fedc2f5

 .../org/apache/kafka/streams/KafkaStreams.java     |  93 ++++++++++++-------
 .../streams/processor/internals/StreamThread.java  |  11 +--
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  60 ++++++++++++-
 .../streams/smoketest/ShutdownDeadlockTest.java    | 100 +++++++++++++++++++++
 .../kafka/streams/smoketest/StreamsSmokeTest.java  |   4 +
 tests/kafkatest/services/streams.py                |  13 ++-
 .../streams/streams_shutdown_deadlock_test.py      |  46 ++++++++++
 7 files changed, 282 insertions(+), 45 deletions(-)
f3aad3b54b7cbc5109d8398829a31100fd82b3e0

 build.gradle                                           | 4 ++--
 core/src/main/scala/kafka/utils/IteratorTemplate.scala | 2 +-
 gradle/dependencies.gradle                             | 7 +++++--
 3 files changed, 8 insertions(+), 5 deletions(-)
aad93840668ae895fce5762c2491b09c32bc3e0c

 README.md                       |  2 +-
 bin/kafka-run-class.sh          |  2 +-
 bin/windows/kafka-run-class.bat | 10 +++++++++-
 3 files changed, 11 insertions(+), 3 deletions(-)
249e4136852be49579eef53b2bce0b2506797666

 .../sanity_checks/test_console_consumer.py         |  2 +-
 .../sanity_checks/test_performance_services.py     |  8 ++++----
 tests/kafkatest/services/console_consumer.py       |  2 +-
 tests/kafkatest/services/kafka/kafka.py            |  4 ++--
 tests/kafkatest/services/mirror_maker.py           |  2 +-
 .../services/performance/consumer_performance.py   |  2 +-
 .../tests/client/message_format_change_test.py     |  2 +-
 tests/kafkatest/tests/client/quota_test.py         |  1 -
 tests/kafkatest/tests/connect/connect_test.py      |  2 +-
 .../core/compatibility_test_new_broker_test.py     | 22 +++++++++++-----------
 .../tests/core/security_rolling_upgrade_test.py    |  2 +-
 tests/kafkatest/tests/core/security_test.py        |  2 +-
 tests/kafkatest/tests/core/throttling_test.py      |  1 -
 tests/kafkatest/tests/core/upgrade_test.py         | 22 +++++++++++-----------
 .../tests/core/zookeeper_security_upgrade_test.py  |  2 +-
 15 files changed, 37 insertions(+), 39 deletions(-)
04a13e82a6cb6346589262faf65e8b484a1948b6

 .../KStreamKTableJoinIntegrationTest.java          | 27 +++++++++++++---------
 .../integration/KStreamRepartitionJoinTest.java    |  1 -
 .../KTableKTableJoinIntegrationTest.java           |  5 ----
 .../integration/QueryableStateIntegrationTest.java |  1 -
 .../streams/integration/ResetIntegrationTest.java  |  1 -
 5 files changed, 16 insertions(+), 19 deletions(-)
39a1c42dfc78b1a55df1312c66daec4a491f0708

 core/src/main/scala/kafka/server/KafkaConfig.scala  | 2 +-
 examples/src/main/java/kafka/examples/Consumer.java | 2 +-
 examples/src/main/java/kafka/examples/Producer.java | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
b902ef985a8d4ce304950fcb2c02499054fe6d24

 .../scala/kafka/controller/KafkaController.scala   |   5 +-
 .../kafka/utils/ByteBoundedBlockingQueue.scala     | 230 ---------------------
 .../ControlledShutdownLeaderSelectorTest.scala     |   2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   2 +-
 .../kafka/utils/ByteBoundedBlockingQueueTest.scala |  98 ---------
 5 files changed, 4 insertions(+), 333 deletions(-)
31203efcb20b7efcbad5984b377ad87c58673dbc

 .../src/main/java/org/apache/kafka/connect/json/JsonConverter.java     | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
a32962af1427483eb103868497d3bfb6d5537fc6

 .../tests/connect/connect_distributed_test.py      | 37 ----------------------
 1 file changed, 37 deletions(-)
3b4c347949c02b1e2b1dd473deda0f8d2304d027

 checkstyle/import-control.xml                      |   2 +
 .../org/apache/kafka/clients/ClientRequest.java    |  65 +++---
 .../org/apache/kafka/clients/ClientResponse.java   |  56 ++++--
 .../org/apache/kafka/clients/InFlightRequests.java |  46 ++---
 .../java/org/apache/kafka/clients/KafkaClient.java |   1 -
 .../kafka/clients/ManualMetadataUpdater.java       |  11 +-
 .../org/apache/kafka/clients/MetadataUpdater.java  |  10 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 164 +++++++++------
 .../consumer/internals/AbstractCoordinator.java    |  33 +---
 .../consumer/internals/ConsumerCoordinator.java    |  12 --
 .../consumer/internals/ConsumerNetworkClient.java  |  30 ++-
 .../kafka/clients/consumer/internals/Fetcher.java  |  11 +-
 .../kafka/clients/producer/internals/Sender.java   |  68 +++----
 .../kafka/common/network/ByteBufferSend.java       |   5 +-
 .../apache/kafka/common/network/NetworkSend.java   |   4 +-
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   2 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  21 +-
 .../kafka/common/protocol/types/ArrayOf.java       |  13 +-
 .../apache/kafka/common/protocol/types/Schema.java |  18 +-
 .../apache/kafka/common/protocol/types/Struct.java |  16 +-
 .../apache/kafka/common/protocol/types/Type.java   |  48 +++++
 .../apache/kafka/common/record/FileRecords.java    | 126 ++++++++++++
 .../apache/kafka/common/record/LogInputStream.java |  35 ++++
 .../apache/kafka/common/record/MemoryRecords.java  | 186 ++++-------------
 .../org/apache/kafka/common/record/Records.java    |  15 ++
 .../kafka/common/record/RecordsIterator.java       | 170 ++++++++++++++++
 .../kafka/common/requests/AbstractRequest.java     |   8 +-
 .../common/requests/AbstractRequestResponse.java   |   9 +-
 .../kafka/common/requests/AbstractResponse.java    |  86 ++++++++
 .../kafka/common/requests/ApiVersionsRequest.java  |   2 +-
 .../kafka/common/requests/ApiVersionsResponse.java |   2 +-
 .../common/requests/ControlledShutdownRequest.java |   2 +-
 .../requests/ControlledShutdownResponse.java       |   2 +-
 .../kafka/common/requests/CreateTopicsRequest.java |   2 +-
 .../common/requests/CreateTopicsResponse.java      |   2 +-
 .../kafka/common/requests/DeleteTopicsRequest.java |   2 +-
 .../common/requests/DeleteTopicsResponse.java      |   2 +-
 .../common/requests/DescribeGroupsRequest.java     |   2 +-
 .../common/requests/DescribeGroupsResponse.java    |   2 +-
 .../apache/kafka/common/requests/FetchRequest.java |  17 +-
 .../kafka/common/requests/FetchResponse.java       | 163 +++++++++++----
 .../common/requests/GroupCoordinatorRequest.java   |   2 +-
 .../common/requests/GroupCoordinatorResponse.java  |   2 +-
 .../kafka/common/requests/HeartbeatRequest.java    |   2 +-
 .../kafka/common/requests/HeartbeatResponse.java   |   2 +-
 .../kafka/common/requests/JoinGroupRequest.java    |   2 +-
 .../kafka/common/requests/JoinGroupResponse.java   |   2 +-
 .../kafka/common/requests/LeaderAndIsrRequest.java |   2 +-
 .../common/requests/LeaderAndIsrResponse.java      |   2 +-
 .../kafka/common/requests/LeaveGroupRequest.java   |   2 +-
 .../kafka/common/requests/LeaveGroupResponse.java  |   2 +-
 .../kafka/common/requests/ListGroupsRequest.java   |   2 +-
 .../kafka/common/requests/ListGroupsResponse.java  |   2 +-
 .../kafka/common/requests/ListOffsetRequest.java   |   2 +-
 .../kafka/common/requests/ListOffsetResponse.java  |   2 +-
 .../kafka/common/requests/MetadataRequest.java     |   2 +-
 .../kafka/common/requests/MetadataResponse.java    |   2 +-
 .../kafka/common/requests/OffsetCommitRequest.java |   8 +-
 .../common/requests/OffsetCommitResponse.java      |   2 +-
 .../kafka/common/requests/OffsetFetchRequest.java  |  10 +-
 .../kafka/common/requests/OffsetFetchResponse.java |   2 +-
 .../kafka/common/requests/ProduceRequest.java      |  31 +--
 .../kafka/common/requests/ProduceResponse.java     |   8 +-
 .../apache/kafka/common/requests/RecordsSend.java  |  77 ++++++++
 .../apache/kafka/common/requests/RequestSend.java  |  55 ------
 .../apache/kafka/common/requests/ResponseSend.java |  41 ----
 .../common/requests/SaslHandshakeRequest.java      |   2 +-
 .../common/requests/SaslHandshakeResponse.java     |   2 +-
 .../kafka/common/requests/StopReplicaRequest.java  |   2 +-
 .../kafka/common/requests/StopReplicaResponse.java |   2 +-
 .../kafka/common/requests/SyncGroupRequest.java    |   2 +-
 .../kafka/common/requests/SyncGroupResponse.java   |   2 +-
 .../common/requests/UpdateMetadataRequest.java     |   2 +-
 .../common/requests/UpdateMetadataResponse.java    |   2 +-
 .../authenticator/SaslClientAuthenticator.java     |  57 +++---
 .../authenticator/SaslServerAuthenticator.java     |  71 ++++---
 .../kafka/common/utils/AbstractIterator.java       |   4 +-
 .../java/org/apache/kafka/clients/MockClient.java  | 101 +++++-----
 .../apache/kafka/clients/NetworkClientTest.java    |  31 ++-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  64 +++---
 .../internals/AbstractCoordinatorTest.java         |  64 +++---
 .../internals/ConsumerCoordinatorTest.java         |  85 ++++----
 .../internals/ConsumerNetworkClientTest.java       |  10 +-
 .../clients/consumer/internals/FetcherTest.java    |  40 ++--
 .../clients/producer/internals/SenderTest.java     |  40 ++--
 .../kafka/common/requests/RequestResponseTest.java | 174 +++++++++++-----
 .../authenticator/SaslAuthenticatorTest.java       |  54 ++---
 .../runtime/distributed/WorkerCoordinatorTest.java |  41 ++--
 core/src/main/scala/kafka/admin/AdminClient.scala  |  18 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   3 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |   3 +-
 .../scala/kafka/api/GenericRequestAndHeader.scala  |   5 +-
 .../scala/kafka/api/GenericResponseAndHeader.scala |   5 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   4 +-
 .../main/scala/kafka/api/RequestOrResponse.scala   |   2 +-
 .../controller/ControllerChannelManager.scala      |  59 +++---
 .../scala/kafka/controller/KafkaController.scala   |   8 +-
 .../kafka/controller/TopicDeletionManager.scala    |   7 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |  35 +---
 .../scala/kafka/message/ByteBufferMessageSet.scala |  17 +-
 core/src/main/scala/kafka/message/MessageSet.scala |  12 +-
 .../main/scala/kafka/network/RequestChannel.scala  |  45 ++---
 .../src/main/scala/kafka/server/DelayedFetch.scala |   9 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 219 ++++++++++-----------
 core/src/main/scala/kafka/server/KafkaServer.scala |  58 +++---
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  24 ++-
 .../main/scala/kafka/server/ReplicaManager.scala   |  31 +--
 .../kafka/server/ReplicationQuotaManager.scala     |   2 +-
 .../kafka/utils/NetworkClientBlockingOps.scala     |  14 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  20 +-
 .../kafka/message/BaseMessageSetTestCases.scala    |   4 +-
 .../unit/kafka/network/SocketServerTest.scala      |   7 +-
 .../kafka/server/CreateTopicsRequestTest.scala     |   2 +-
 .../unit/kafka/server/EdgeCaseRequestTest.scala    |   7 +-
 .../scala/unit/kafka/server/FetchRequestTest.scala |  10 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   4 +-
 .../unit/kafka/server/ProduceRequestTest.scala     |   6 +-
 .../kafka/server/ReplicaManagerQuotasTest.scala    |  11 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |   9 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  15 +-
 120 files changed, 1870 insertions(+), 1394 deletions(-)
1f1d4500623275ca05fe661b608a5119bde934ed

 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
b7d36b7261ddefea68667a65cc5e2ee0734ed4a1

 .../org/apache/kafka/common/config/ConfigDef.java  |  10 +-
 .../apache/kafka/common/config/ConfigValue.java    |   4 +-
 .../kafka/connect/runtime/AbstractHerder.java      |  43 ++++--
 .../org/apache/kafka/connect/runtime/Herder.java   |  12 +-
 .../kafka/connect/runtime/WorkerSinkTask.java      |   3 +-
 .../runtime/distributed/DistributedConfig.java     |   5 +-
 .../runtime/distributed/DistributedHerder.java     |  72 +++++++--
 .../runtime/rest/entities/ErrorMessage.java        |   4 +-
 .../runtime/rest/errors/BadRequestException.java   |  27 ++++
 .../rest/resources/ConnectorPluginsResource.java   |   8 +-
 .../runtime/rest/resources/ConnectorsResource.java |   2 +-
 .../runtime/standalone/StandaloneHerder.java       |  58 ++++---
 .../org/apache/kafka/connect/util/SinkUtils.java   |  27 ++++
 .../runtime/distributed/DistributedHerderTest.java | 168 ++++++++++++++++++++-
 .../resources/ConnectorPluginsResourceTest.java    |   2 +-
 .../rest/resources/ConnectorsResourceTest.java     |   6 +-
 .../runtime/standalone/StandaloneHerderTest.java   | 141 ++++++++++++++---
 17 files changed, 498 insertions(+), 94 deletions(-)
4f1d8c6859c5767c314de84bd654cb7e1153db4b

 tests/kafkatest/services/connect.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
7282de39f7b7cef1ca85f21771f2401a4a67eaec

 .../clients/consumer/internals/ConsumerCoordinator.java  |  3 +++
 .../consumer/internals/ConsumerCoordinatorTest.java      | 16 ++++++++++++++++
 2 files changed, 19 insertions(+)
64a860c5853e21ff91109d0acb74b42f2dc20c7c

 .../state/internals/CachingKeyValueStore.java      | 21 +++---
 .../internals/InMemoryKeyValueLoggedStore.java     | 23 ++-----
 .../streams/state/internals/RocksDBStore.java      | 24 ++-----
 .../state/internals/RocksDBWindowStore.java        | 26 ++------
 .../streams/state/internals/StoreChangeLogger.java | 78 +++-------------------
 .../state/internals/RocksDBKeyValueStoreTest.java  |  8 ++-
 .../state/internals/StoreChangeLoggerTest.java     | 52 ++++-----------
 .../org/apache/kafka/test/KStreamTestDriver.java   |  5 +-
 8 files changed, 60 insertions(+), 177 deletions(-)
97839344601cc67256e871bd461e877eed974104

 tests/kafkatest/services/connect.py                        | 13 +++++++++++--
 tests/kafkatest/services/kafka/kafka.py                    |  1 +
 tests/kafkatest/services/kafka/templates/log4j.properties  |  2 +-
 tests/kafkatest/services/mirror_maker.py                   | 14 ++++++++++++--
 .../services/templates/mirror_maker_consumer.properties    |  8 ++++++++
 .../services/templates/mirror_maker_producer.properties    |  4 ++++
 6 files changed, 37 insertions(+), 5 deletions(-)
8deb05d56b927c77824c10c257fe7bf22a677520

 .../kafka/streams/state/internals/CachingWindowStore.java      | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
0fc1898bf6b91ac5f79dbf3da7ebc90da410876d

 .../kafka/streams/state/internals/CachingWindowStore.java      | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
d8fa4006cb824aa2a8ab890b6754c920ac17182c

 .../streams/processor/internals/SinkNode.java      |  14 ++-
 .../streams/processor/internals/SinkNodeTest.java  | 132 +++++----------------
 2 files changed, 43 insertions(+), 103 deletions(-)
cc62b4f844ca16eee974e75b736af87b7532de0d

 .../ConsumerRecordTimestampExtractor.java          | 52 +++++-----------------
 1 file changed, 11 insertions(+), 41 deletions(-)
10cfc1628df024f7596d3af5c168fa90f59035ca

 docs/upgrade.html                                  | 37 +++++++++++++++
 .../ConsumerRecordTimestampExtractor.java          | 52 +++++++++++++++++-----
 2 files changed, 78 insertions(+), 11 deletions(-)
6972d9476fc036d5fdcc59fb82fb20f063091df8

 docs/upgrade.html                                  | 37 +++++++++++++++
 .../ConsumerRecordTimestampExtractor.java          | 52 +++++++++++++++++-----
 2 files changed, 78 insertions(+), 11 deletions(-)
da13b537871ee59d30fb82703de4b6b1fcb11dff

 .../src/main/java/org/apache/kafka/connect/runtime/TaskConfig.java      | 2 +-
 .../src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
a66ca1624c692d30b7ae1e25c29915331cbf41e3

 .../java/org/apache/kafka/streams/processor/internals/StreamThread.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f1e1b6e744cde036d75678575bd5e32c608ecdb1

 .../kafka/streams/kstream/KStreamBuilder.java      |  2 +-
 .../streams/kstream/internals/KTableImpl.java      | 22 ----------------------
 2 files changed, 1 insertion(+), 23 deletions(-)
7c36fc377650dac8a9d6e5f2d0049a78cd93d2e5

 .../internals/ForwardingCacheFlushListener.java    | 22 +++++--
 .../internals/InternalProcessorContext.java        |  1 +
 .../processor/internals/ProcessorContextImpl.java  | 13 ++--
 .../processor/internals/StandbyContextImpl.java    |  5 ++
 .../streams/processor/internals/StreamTask.java    | 30 +++------
 .../kafka/streams/state/internals/NamedCache.java  |  8 ++-
 .../kstream/internals/KTableAggregateTest.java     | 72 ++++++++++++++++++++++
 .../processor/internals/ProcessorTopologyTest.java |  1 +
 .../streams/state/KeyValueStoreTestDriver.java     |  7 +++
 .../streams/state/internals/NamedCacheTest.java    |  6 ++
 .../org/apache/kafka/test/KStreamTestDriver.java   | 23 ++++++-
 .../apache/kafka/test/MockProcessorContext.java    |  7 +++
 12 files changed, 160 insertions(+), 35 deletions(-)
8ab8f37b43e3274ad0d8fb3883e3f432992058ba

 .../src/main/java/org/apache/kafka/streams/kstream/ForeachAction.java | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/Transformer.java   | 4 ++--
 streams/src/main/java/org/apache/kafka/streams/kstream/Windows.java   | 4 ++--
 3 files changed, 5 insertions(+), 5 deletions(-)
6dbe202b6dc3ba638d3a55ff89b594bd334bb8b0

 .../scala/kafka/controller/KafkaController.scala   |  3 ++-
 .../kafka/server/ZookeeperLeaderElector.scala      | 23 +++++++++++++++-------
 2 files changed, 18 insertions(+), 8 deletions(-)
11766ad31861e0350178f59127e471fde2b20970

 .../apache/kafka/streams/processor/internals/AbstractTask.java   | 6 ++++++
 .../kafka/streams/processor/internals/ProcessorStateManager.java | 1 +
 .../org/apache/kafka/streams/processor/internals/StreamTask.java | 2 +-
 .../apache/kafka/streams/processor/internals/StreamThread.java   | 4 ++--
 streams/src/main/java/org/apache/kafka/streams/state/Stores.java | 9 ++++++++-
 .../org/apache/kafka/streams/state/internals/RocksDBStore.java   | 3 ---
 .../org/apache/kafka/streams/state/internals/ThreadCache.java    | 1 +
 7 files changed, 19 insertions(+), 7 deletions(-)
92287849e46ee0dad360fcd971c6207aa11777a7

 .../KTableKTableJoinIntegrationTest.java           | 31 ----------------------
 1 file changed, 31 deletions(-)
fd2a9b4e2f395923fdabf0f4d500e325ec88a358

 .../kafka/streams/processor/TopologyBuilder.java   | 27 ++++++++++++-------
 .../internals/StreamPartitionAssignor.java         | 10 +++++--
 .../streams/processor/TopologyBuilderTest.java     | 31 ++++++++++++++++++++++
 3 files changed, 57 insertions(+), 11 deletions(-)
471a2ab17df66c52e0a98afa81e0b360560a5e9a

 .../kafka/clients/producer/KafkaProducer.java      |  1 +
 .../apache/kafka/clients/producer/Partitioner.java |  4 +-
 .../kafka/clients/producer/KafkaProducerTest.java  | 22 ++++++++++
 .../org/apache/kafka/test/MockPartitioner.java     | 51 ++++++++++++++++++++++
 4 files changed, 77 insertions(+), 1 deletion(-)
8f2e0a5ec1dd285fcf47e2df396b897176c2008b

 .../apache/kafka/connect/runtime/rest/resources/ConnectorsResource.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5307efe1ae447cc1ba01c699af002b154b3b04e3

 tests/kafkatest/tests/produce_consume_validate.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7868e657757d66aed13546dcdba97feeba8f1b14

 .../src/main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0a659e50f7d98c0a195a7dca4ef9f117ab2aa257

 .../runtime/rest/resources/ConnectorsResource.java      |  5 ++++-
 .../runtime/rest/resources/ConnectorsResourceTest.java  | 17 +++++++++++++++++
 2 files changed, 21 insertions(+), 1 deletion(-)
5e7190cf83860190d54815aab957a58c26fd816e

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java   | 1 +
 1 file changed, 1 insertion(+)
e795ad96ca9f26cdef01d063b79483a6c9221f27

 .../kafka/clients/ClusterConnectionStates.java     |  9 ++
 .../java/org/apache/kafka/clients/Metadata.java    | 25 +++---
 .../org/apache/kafka/clients/NetworkClient.java    | 82 +++++++++++-------
 .../org/apache/kafka/clients/MetadataTest.java     | 98 ++++++++++++++++++++++
 4 files changed, 172 insertions(+), 42 deletions(-)
1a2ed8633d6d7194b398a4aa0f0b6f0b4fe4178e

 core/src/main/scala/kafka/api/TopicMetadata.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
508711d09e7c6070868aadfff1b2627e77f7f3d9

 .../src/main/java/org/apache/kafka/connect/storage/OffsetUtils.java     | 2 ++
 1 file changed, 2 insertions(+)
2959bc2ad382fa786bd6209fe742b8218edfa4a8

 core/src/main/scala/kafka/api/TopicMetadata.scala  |  6 ++--
 .../kafka/network/RequestOrResponseSend.scala      |  2 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 38 ++++++++++++----------
 3 files changed, 25 insertions(+), 21 deletions(-)
c62dc28ceb215da003dba39fa845c29bbd7271fa

 docs/design.html | 9 +++------
 1 file changed, 3 insertions(+), 6 deletions(-)
94909a8f83bfe214726f85130ad04d867e022894

 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 35 +++++++++++-----------
 .../kafka/admin/DescribeConsumerGroupTest.scala    | 29 +++++++++++++++++-
 2 files changed, 46 insertions(+), 18 deletions(-)
fc6540023b08344b8b2cdb8ce3253ba859668793

 .../org/apache/kafka/streams/integration/ResetIntegrationTest.java     | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
fbbe5821c26d5e4c7d0dff130ea722fbf90169d8

 .../org/apache/kafka/streams/integration/ResetIntegrationTest.java     | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
f3e5e6d65d00204a4f15f60b1f534a3b03048e71

 .../streams/processor/internals/SinkNode.java      |  12 +-
 .../streams/processor/internals/SinkNodeTest.java  | 145 +++++++++++++++++++++
 2 files changed, 156 insertions(+), 1 deletion(-)
baae90a1e40c219d37c67167a9a65b21202f9ad6

 .../kafka/streams/kstream/KStreamBuilder.java      | 13 +++++++++--
 .../streams/kstream/internals/KTableImpl.java      | 25 ----------------------
 .../streams/kstream/internals/KTableSource.java    | 22 +------------------
 3 files changed, 12 insertions(+), 48 deletions(-)
ba322e54203ffec5779944753f264d70b87a24fd

 .../org/apache/kafka/streams/StreamsConfig.java    | 21 +++++++----
 .../apache/kafka/streams/StreamsConfigTest.java    | 43 ++++++++++++++++++++++
 2 files changed, 56 insertions(+), 8 deletions(-)
979a7baa7b3039060d1a788ae179dc3593c6821e

 .../test/scala/unit/kafka/producer/AsyncProducerTest.scala    | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)
76b070284142635d2be78e8f86e779dfdbb0a2e0

 .../streams/processor/internals/SinkNode.java      |  12 +-
 .../streams/processor/internals/SinkNodeTest.java  | 145 +++++++++++++++++++++
 2 files changed, 156 insertions(+), 1 deletion(-)
18223415b091b0c05af4767191bb97b366aa8fa5

 .../kafka/streams/kstream/KStreamBuilder.java      | 13 +++++++++--
 .../streams/kstream/internals/KTableImpl.java      | 25 ----------------------
 .../streams/kstream/internals/KTableSource.java    | 22 +------------------
 3 files changed, 12 insertions(+), 48 deletions(-)
29ea4b0f1481aa2ee29694f2b469c16059f9c17e

 .../streams/processor/internals/AbstractTask.java  |   3 +
 .../processor/internals/PartitionGroup.java        |   7 +
 .../streams/processor/internals/RecordQueue.java   |   7 +
 .../streams/processor/internals/StandbyTask.java   |  10 ++
 .../streams/processor/internals/StreamTask.java    |  49 ++++---
 .../streams/processor/internals/StreamThread.java  | 162 +++++++++++++++++++--
 .../KStreamAggregationDedupIntegrationTest.java    |  44 ++++++
 .../KStreamAggregationIntegrationTest.java         |  17 +--
 .../processor/internals/AbstractTaskTest.java      |  10 ++
 .../processor/internals/StreamThreadTest.java      |  18 +++
 10 files changed, 277 insertions(+), 50 deletions(-)
a4ab9d02a22e77f0ebca0450e608898d83d4fe18

 .../main/java/org/apache/kafka/common/Cluster.java |  20 +-
 .../org/apache/kafka/streams/KafkaStreams.java     |   4 +-
 .../kafka/streams/processor/TopologyBuilder.java   |   8 +-
 .../processor/internals/InternalTopicConfig.java   |   3 +-
 .../streams/processor/internals/SinkNode.java      |   5 -
 .../streams/processor/internals/SourceNode.java    |   5 -
 .../internals/StreamPartitionAssignor.java         | 717 +++++++++++----------
 .../streams/processor/internals/StreamThread.java  |  39 +-
 .../internals/assignment/AssignmentInfo.java       |  14 +-
 .../internals/assignment/ClientState.java          |  16 +-
 .../internals/assignment/TaskAssignor.java         |  37 +-
 .../org/apache/kafka/streams/state/HostInfo.java   |   2 +-
 .../streams/state/internals/StoreChangeLogger.java |  10 -
 .../streams/integration/FanoutIntegrationTest.java |   1 -
 .../streams/kstream/internals/KStreamImplTest.java |   2 +-
 .../streams/kstream/internals/KTableImplTest.java  |  16 +-
 .../streams/processor/TopologyBuilderTest.java     |   4 +-
 .../internals/StreamPartitionAssignorTest.java     | 148 +++--
 .../internals/StreamsMetadataStateTest.java        |   2 +-
 .../internals/assignment/AssignmentInfoTest.java   |   2 +-
 .../internals/assignment/TaskAssignorTest.java     | 115 ++--
 .../state/internals/StoreChangeLoggerTest.java     |  21 +-
 22 files changed, 642 insertions(+), 549 deletions(-)
0dd9607f9ca50a385e78af06b66e0e90c1f37076

 core/src/main/scala/kafka/log/LogCleaner.scala     | 139 +++-------------
 .../scala/kafka/message/ByteBufferMessageSet.scala | 178 ++++++++++++++++++---
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  50 +++---
 3 files changed, 210 insertions(+), 157 deletions(-)
34e9cc5dfae1f0a7b2cab51cb2939d48ba048964

 core/src/main/scala/kafka/admin/AdminClient.scala  | 10 +++++--
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 31 ++++++++++++----------
 2 files changed, 25 insertions(+), 16 deletions(-)
53fc26723ec0a5dfe6b5ce5f17db8b306953a1fb

 .../test/scala/unit/kafka/utils/TestUtils.scala    | 24 +++++++++++-----------
 1 file changed, 12 insertions(+), 12 deletions(-)
dab3617e1af6efe9898b2675d7266272107d9105

 streams/src/main/java/org/apache/kafka/streams/kstream/Windows.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
a4413fc8a42b0222107cad20835e4461141c2ea2

 .../java/org/apache/kafka/common/network/SslTransportLayer.java     | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
2ac332e9c9015964d993692c99c5ad19c9e2d56b

 tests/kafkatest/services/kafka/kafka.py                   | 2 +-
 tests/kafkatest/tests/core/consumer_group_command_test.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
986c15450df8fce4a57bb606959c4ccfb4cde080

 core/src/main/scala/kafka/security/auth/SimpleAclAuthorizer.scala | 4 ++--
 core/src/main/scala/kafka/server/KafkaServer.scala                | 8 ++++----
 2 files changed, 6 insertions(+), 6 deletions(-)
d092673838173d9dedbf5acf3f4e2cd8c736294f

 .../consumer/internals/AbstractCoordinator.java    |  2 -
 .../consumer/internals/ConsumerCoordinator.java    |  2 -
 .../consumer/internals/SubscriptionState.java      |  7 --
 .../kafka/clients/producer/KafkaProducer.java      |  1 -
 .../kafka/clients/producer/internals/Sender.java   | 10 +--
 .../org/apache/kafka/common/network/MultiSend.java |  6 +-
 .../common/network/PlaintextChannelBuilder.java    |  4 +-
 .../kafka/common/network/SslChannelBuilder.java    |  4 +-
 .../kafka/common/network/SslTransportLayer.java    |  5 +-
 .../authenticator/SaslServerAuthenticator.java     |  5 +-
 .../apache/kafka/clients/NetworkClientTest.java    |  3 +-
 .../clients/producer/internals/BufferPoolTest.java |  2 +-
 .../clients/producer/internals/SenderTest.java     |  3 -
 .../org/apache/kafka/connect/data/Timestamp.java   |  4 --
 .../runtime/distributed/WorkerCoordinator.java     |  5 +-
 .../runtime/rest/entities/ConnectorInfo.java       |  9 ---
 core/src/main/scala/kafka/admin/AclCommand.scala   |  1 -
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  6 +-
 .../src/main/scala/kafka/admin/ConfigCommand.scala | 10 +--
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |  2 +-
 .../PreferredReplicaLeaderElectionCommand.scala    |  2 +-
 .../kafka/admin/ReassignPartitionsCommand.scala    |  4 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |  4 +-
 .../scala/kafka/admin/ZkSecurityMigrator.scala     |  1 -
 .../kafka/api/ControlledShutdownResponse.scala     |  2 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |  7 +-
 core/src/main/scala/kafka/api/LeaderAndIsr.scala   |  4 +-
 .../scala/kafka/api/OffsetCommitResponse.scala     |  2 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |  5 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |  5 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |  6 +-
 .../main/scala/kafka/cluster/BrokerEndPoint.scala  |  2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  3 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |  7 +-
 .../common/ZkNodeChangeNotificationListener.scala  |  2 +-
 .../scala/kafka/consumer/PartitionAssignor.scala   |  4 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |  4 +-
 .../main/scala/kafka/consumer/TopicFilter.scala    |  2 +-
 .../consumer/ZookeeperConsumerConnector.scala      | 24 ++++---
 .../scala/kafka/controller/KafkaController.scala   | 74 ++++++++++------------
 .../kafka/controller/PartitionStateMachine.scala   | 12 ++--
 .../kafka/controller/ReplicaStateMachine.scala     |  2 +-
 .../kafka/controller/TopicDeletionManager.scala    |  4 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |  2 +-
 core/src/main/scala/kafka/log/Log.scala            |  4 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  2 +-
 .../main/scala/kafka/log/LogCleanerManager.scala   | 10 ++-
 .../scala/kafka/message/ByteBufferMessageSet.scala |  2 +-
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    | 19 ++----
 .../main/scala/kafka/network/BlockingChannel.scala |  2 +-
 .../scala/kafka/producer/DefaultPartitioner.scala  |  2 -
 core/src/main/scala/kafka/producer/Producer.scala  |  2 +-
 .../main/scala/kafka/security/auth/Resource.scala  |  2 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  4 +-
 .../kafka/server/AbstractFetcherManager.scala      |  2 +-
 .../src/main/scala/kafka/server/AdminManager.scala |  2 +-
 .../kafka/server/BrokerMetadataCheckpoint.scala    |  2 +-
 .../scala/kafka/server/ClientQuotaManager.scala    |  8 +--
 .../src/main/scala/kafka/server/DelayedFetch.scala |  4 +-
 .../scala/kafka/server/DynamicConfigManager.scala  |  3 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  2 +-
 .../main/scala/kafka/server/KafkaHealthcheck.scala |  1 -
 .../main/scala/kafka/server/OffsetCheckpoint.scala |  2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 21 +++---
 .../kafka/server/ZookeeperLeaderElector.scala      |  2 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  6 +-
 .../scala/kafka/tools/ConsumerPerformance.scala    |  2 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 10 ++-
 .../main/scala/kafka/tools/EndToEndLatency.scala   |  3 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 10 +--
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  5 +-
 .../kafka/tools/ReplicaVerificationTool.scala      | 21 +++---
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  4 +-
 core/src/main/scala/kafka/utils/FileLock.scala     |  4 +-
 core/src/main/scala/kafka/utils/Mx4jLoader.scala   |  6 +-
 .../main/scala/kafka/utils/ReplicationUtils.scala  |  4 +-
 .../scala/kafka/utils/VerifiableProperties.scala   |  4 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 30 ++++-----
 .../integration/kafka/api/AdminClientTest.scala    |  1 -
 .../kafka/api/AuthorizerIntegrationTest.scala      | 15 ++---
 .../integration/kafka/api/BaseConsumerTest.scala   |  2 +-
 .../kafka/api/BaseProducerSendTest.scala           | 21 +++---
 .../kafka/api/EndToEndAuthorizationTest.scala      |  2 +-
 .../integration/kafka/api/FixedPortTestUtils.scala |  2 +-
 .../kafka/api/IntegrationTestHarness.scala         |  4 +-
 .../kafka/api/PlaintextConsumerTest.scala          | 13 ++--
 .../kafka/api/PlaintextProducerSendTest.scala      |  4 +-
 .../integration/kafka/api/ProducerBounceTest.scala |  4 +-
 .../scala/kafka/security/minikdc/MiniKdc.scala     |  5 +-
 .../test/scala/kafka/tools/TestLogCleaning.scala   |  2 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |  3 +-
 .../scala/other/kafka/TestCrcPerformance.scala     | 14 ++--
 .../test/scala/other/kafka/TestKafkaAppender.scala |  9 +--
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  3 +-
 .../test/scala/other/kafka/TestOffsetManager.scala |  6 +-
 .../other/kafka/TestPurgatoryPerformance.scala     |  2 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  6 +-
 .../scala/unit/kafka/admin/ConfigCommandTest.scala |  4 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  7 +-
 .../kafka/admin/DescribeConsumerGroupTest.scala    |  4 +-
 .../admin/ReassignPartitionsCommandTest.scala      |  2 +-
 .../test/scala/unit/kafka/api/ApiUtilsTest.scala   | 12 ++--
 .../api/RequestResponseSerializationTest.scala     | 36 -----------
 .../test/scala/unit/kafka/common/ConfigTest.scala  |  8 +--
 .../test/scala/unit/kafka/common/TopicTest.scala   |  6 +-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala | 13 ++--
 .../kafka/consumer/PartitionAssignorTest.scala     | 26 ++++----
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 19 +++---
 .../kafka/controller/ControllerFailoverTest.scala  |  4 +-
 .../coordinator/GroupMetadataManagerTest.scala     |  4 +-
 .../unit/kafka/coordinator/GroupMetadataTest.scala |  2 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |  6 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  9 +--
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  6 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  4 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |  9 ++-
 .../kafka/log/LogCleanerLagIntegrationTest.scala   |  6 +-
 .../unit/kafka/log/LogCleanerManagerTest.scala     |  9 ---
 .../test/scala/unit/kafka/log/LogCleanerTest.scala |  5 +-
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  6 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 24 +++----
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  6 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 62 +++++++++---------
 .../scala/unit/kafka/log/OffsetIndexTest.scala     |  2 +-
 .../test/scala/unit/kafka/log/OffsetMapTest.scala  |  3 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   |  4 +-
 .../kafka/message/MessageCompressionTest.scala     |  5 +-
 .../unit/kafka/network/SocketServerTest.scala      |  6 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    | 20 +++---
 .../scala/unit/kafka/producer/ProducerTest.scala   | 66 ++++++++-----------
 .../unit/kafka/producer/SyncProducerTest.scala     |  6 +-
 .../unit/kafka/security/auth/OperationTest.scala   |  2 +-
 .../kafka/security/auth/PermissionTypeTest.scala   |  2 +-
 .../kafka/security/auth/ResourceTypeTest.scala     |  2 +-
 .../security/auth/SimpleAclAuthorizerTest.scala    |  2 +-
 .../kafka/security/auth/ZkAuthorizationTest.scala  |  8 +--
 .../unit/kafka/server/ClientQuotaManagerTest.scala |  4 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |  8 +--
 .../unit/kafka/server/ISRExpirationTest.scala      | 25 ++++----
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 13 ++--
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  8 +--
 .../unit/kafka/server/MetadataCacheTest.scala      |  2 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  1 -
 .../unit/kafka/server/ReplicationQuotasTest.scala  |  4 +-
 .../kafka/server/SaslApiVersionsRequestTest.scala  |  2 +-
 .../kafka/server/ServerGenerateBrokerIdTest.scala  |  2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |  8 +--
 .../unit/kafka/server/ServerStartupTest.scala      |  2 +-
 .../unit/kafka/tools/ConsoleProducerTest.scala     |  2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  8 +--
 .../unit/kafka/utils/timer/TimerTaskListTest.scala |  4 +-
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  7 +-
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala | 50 ++++-----------
 .../scala/unit/kafka/zk/ZkFourLetterWords.scala    |  2 +-
 .../state/internals/RocksDBKeyValueStoreTest.java  |  2 +-
 155 files changed, 477 insertions(+), 704 deletions(-)
1fc450fdb5f7b16c3bfb39832d7fe348995e2cf4

 clients/src/test/java/org/apache/kafka/clients/MetadataTest.java | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
b2fa0d75df6ae2959da8c3dbe7d83f692043e577

 .../main/scala/kafka/tools/StreamsResetter.java    | 159 ++++++++++-----------
 1 file changed, 76 insertions(+), 83 deletions(-)
ed5076923483bba36df6d4b70575ee0ffd6a046c

 .../src/main/java/org/apache/kafka/connect/connector/ConnectRecord.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
63da487213765cb543a4255a83acb876a57d3634

 core/src/main/scala/kafka/tools/StreamsResetter.java         |  2 +-
 .../kafka/streams/integration/ResetIntegrationTest.java      | 12 +++++++-----
 2 files changed, 8 insertions(+), 6 deletions(-)
7afdad8c37cde4a32ad7ce66ca7a878cf730495e

 core/src/main/scala/kafka/admin/AdminClient.scala  |  56 ++--
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 297 +++++++++++++--------
 .../scala/kafka/coordinator/GroupMetadata.scala    |   6 +-
 .../main/scala/kafka/tools/StreamsResetter.java    |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  17 +-
 .../integration/kafka/api/AdminClientTest.scala    |  30 +--
 .../kafka/admin/DescribeConsumerGroupTest.scala    | 128 +++++++++
 .../unit/kafka/admin/ListConsumerGroupTest.scala   |  87 ++++++
 .../streams/integration/ResetIntegrationTest.java  |   2 +-
 9 files changed, 463 insertions(+), 162 deletions(-)
74014af8332c6ec95133cd7fda3848bcd7fb4ce6

 tests/kafkatest/services/kafka/kafka.py | 9 +++++++++
 1 file changed, 9 insertions(+)
302a246c72677b1045696f4d6dda51da8c6a1da0

 core/src/main/scala/kafka/log/LogCleaner.scala     | 102 +--
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 801 --------------------
 .../test/scala/unit/kafka/log/LogCleanerTest.scala | 839 +++++++++++++++++++++
 3 files changed, 896 insertions(+), 846 deletions(-)
3b0a8d6dfc89d77310079969bbfeeeb532aa59fd

 tests/kafkatest/services/kafka/kafka.py | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
2ac70c0b744780c8a7af1f9c8be27a45059da6cc

 tests/kafkatest/services/kafka/kafka.py | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
5cf579a7e43e0d2e6a2a26ede88ee850127aa4a1

 Vagrantfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
62c0972efc525cc0677bd3fd470bd9fbbd70b004

 .../org/apache/kafka/streams/kstream/KStream.java  |  44 ++-
 .../streams/kstream/internals/KStreamImpl.java     | 272 ++++++-------
 .../kstream/internals/KStreamKStreamJoin.java      |  27 +-
 .../kstream/internals/KStreamKTableJoin.java       |  75 ++++
 .../kstream/internals/KStreamKTableLeftJoin.java   |  66 ----
 .../kstream/internals/KStreamWindowAggregate.java  |   2 +-
 .../streams/kstream/internals/KTableImpl.java      | 103 ++---
 .../kstream/internals/KTableKTableJoin.java        |  21 +-
 .../kstream/internals/KTableKTableLeftJoin.java    |  19 +-
 .../kstream/internals/KTableKTableOuterJoin.java   |  16 +-
 .../kstream/internals/KTableKTableRightJoin.java   |  24 +-
 .../processor/internals/ProcessorContextImpl.java  |   4 -
 .../streams/integration/JoinIntegrationTest.java   | 433 +++++++++++++++++++++
 .../KTableKTableJoinIntegrationTest.java           |  74 ++--
 .../internals/KStreamKStreamLeftJoinTest.java      |  98 +++--
 .../kstream/internals/KStreamKTableJoinTest.java   | 146 +++++++
 .../internals/KStreamWindowAggregateTest.java      |  22 +-
 .../kstream/internals/KTableKTableJoinTest.java    |  93 +++--
 .../internals/KTableKTableLeftJoinTest.java        |  18 +-
 .../internals/KTableKTableOuterJoinTest.java       |  12 +-
 20 files changed, 1075 insertions(+), 494 deletions(-)
9c4f1d54f52afdb3eb1e4127b671f64c8ea4d939

 .../scala/kafka/server/AbstractFetcherThread.scala |  8 +++
 .../src/main/scala/kafka/server/DelayedFetch.scala | 17 +++--
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 12 +++-
 .../main/scala/kafka/server/ReplicaManager.scala   | 30 +++++++--
 .../kafka/server/ReplicaManagerQuotasTest.scala    | 74 +++++++++++++++++++---
 .../scala/unit/kafka/server/SimpleFetchTest.scala  | 18 +++++-
 6 files changed, 133 insertions(+), 26 deletions(-)
24067e40764d91e1a6b2d80be45407841bbb72a2

 .../scala/kafka/server/AbstractFetcherThread.scala |  8 +++
 .../src/main/scala/kafka/server/DelayedFetch.scala | 17 +++--
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 12 +++-
 .../main/scala/kafka/server/ReplicaManager.scala   | 30 +++++++--
 .../kafka/server/ReplicaManagerQuotasTest.scala    | 74 +++++++++++++++++++---
 .../scala/unit/kafka/server/SimpleFetchTest.scala  | 18 +++++-
 6 files changed, 133 insertions(+), 26 deletions(-)
4c295a78446be6eba24ca4a9b7e506657e55c875

 .../kafka/streams/processor/TopologyBuilder.java   | 27 ++++++++++++-------
 .../internals/StreamPartitionAssignor.java         | 10 +++++--
 .../streams/processor/TopologyBuilderTest.java     | 31 ++++++++++++++++++++++
 3 files changed, 57 insertions(+), 11 deletions(-)
17cb4fe52f74fcc1b7c43baa4649e0a4aba80fa3

 .../streams/kstream/internals/KTableImpl.java      |  14 +-
 .../KTableKTableJoinIntegrationTest.java           | 280 +++++++++++++++++++++
 2 files changed, 287 insertions(+), 7 deletions(-)
46666a1f64af3617d7f47f50fedf3b9a6ae5cddb

 .../src/main/java/org/apache/kafka/clients/consumer/ConsumerRecord.java | 2 +-
 .../src/main/java/org/apache/kafka/clients/producer/ProducerRecord.java | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
b51002c576ea9758132d75a8a0fe454e1bc270a2

 .../org/apache/kafka/streams/kstream/internals/KStreamImpl.java     | 3 +++
 .../java/org/apache/kafka/streams/kstream/internals/KTableImpl.java | 4 ++++
 .../org/apache/kafka/streams/kstream/internals/KStreamImplTest.java | 6 ++++++
 .../org/apache/kafka/streams/kstream/internals/KTableImplTest.java  | 6 ++++++
 4 files changed, 19 insertions(+)
6a255f81cb62c4ff7ddb1be7b58c0499c1fe258a

 docs/streams.html | 45 ++++++++++++++++++++++++++++++++++++++++++---
 1 file changed, 42 insertions(+), 3 deletions(-)
c2a8b86117ede2ffda4cc4a8800b46f65ef9922d

 docs/streams.html | 45 ++++++++++++++++++++++++++++++++++++++++++---
 1 file changed, 42 insertions(+), 3 deletions(-)
6bd866b92fc5cf6e7a669e2d66c92c18b0ce869e

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
179d4dc0f2a23d7e67caf4875a0563e74027933a

 .../kafka/streams/state/internals/ThreadCache.java | 14 ++++++--
 .../streams/state/internals/ThreadCacheTest.java   | 37 ++++++++++++++++++++++
 2 files changed, 48 insertions(+), 3 deletions(-)
fb3f1f978a70fc0c49d6b26bd4cb5f5c54eb6ad6

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
5bdcbebdada5c77464b5ab608d804f40232df1af

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
332b8b9afd04b975a42b91775edebdef5c27ff6b

 core/src/main/scala/kafka/server/AbstractFetcherManager.scala | 4 ++++
 1 file changed, 4 insertions(+)
2965f50e0de755cd36cf5e13bd9968493a0f8279

 .../scala/kafka/security/auth/SimpleAclAuthorizer.scala    | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)
b729ac520605b5f8eec5bc23d8625891a3709547

 docs/ops.html | 94 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 94 insertions(+)
b8cfa167edfefbae52bec98eb357121e6437cef6

 docs/ops.html | 94 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 94 insertions(+)
d273480c424b74f59c6c6e8387833acc990080bb

 docs/quickstart.html | 2 --
 docs/upgrade.html    | 4 ----
 2 files changed, 6 deletions(-)
3c02e5a20f2c4f1112e9ba79560f0afcd6b09e5d

 docs/quickstart.html | 2 --
 docs/upgrade.html    | 4 ----
 2 files changed, 6 deletions(-)
6f842c1e9e2b95c3faa81c0822bae88dc9ac9899

 bin/windows/kafka-consumer-groups.bat | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
9f8dc1301d598d9686a2a4818fa4ab456bb935d6

 ...bstractKTableKTableJoinValueGetterSupplier.java | 45 +++++++++++++++
 .../kstream/internals/KStreamAggregate.java        |  4 ++
 .../streams/kstream/internals/KStreamImpl.java     |  5 +-
 .../streams/kstream/internals/KStreamReduce.java   |  4 ++
 .../kstream/internals/KStreamWindowAggregate.java  |  6 +-
 .../kstream/internals/KStreamWindowReduce.java     |  4 ++
 .../streams/kstream/internals/KTableAggregate.java |  4 ++
 .../streams/kstream/internals/KTableFilter.java    |  4 ++
 .../streams/kstream/internals/KTableImpl.java      |  8 ++-
 .../kstream/internals/KTableKTableJoin.java        | 15 +++--
 .../kstream/internals/KTableKTableLeftJoin.java    | 16 ++++--
 .../kstream/internals/KTableKTableOuterJoin.java   | 21 ++++---
 .../kstream/internals/KTableKTableRightJoin.java   | 15 +++--
 .../streams/kstream/internals/KTableMapValues.java |  4 ++
 .../streams/kstream/internals/KTableReduce.java    |  4 ++
 .../kstream/internals/KTableRepartitionMap.java    |  5 ++
 .../internals/KTableSourceValueGetterSupplier.java |  5 ++
 .../internals/KTableValueGetterSupplier.java       |  1 +
 .../processor/internals/ProcessorContextImpl.java  | 10 ++--
 .../streams/processor/TopologyBuilderTest.java     | 66 ++++++++++++++++++++++
 20 files changed, 214 insertions(+), 32 deletions(-)
925310aac0b6a0fb32e3e2d614198ffc78f34f96

 ...bstractKTableKTableJoinValueGetterSupplier.java | 45 +++++++++++++++
 .../kstream/internals/KStreamAggregate.java        |  4 ++
 .../streams/kstream/internals/KStreamImpl.java     |  5 +-
 .../streams/kstream/internals/KStreamReduce.java   |  4 ++
 .../kstream/internals/KStreamWindowAggregate.java  |  6 +-
 .../kstream/internals/KStreamWindowReduce.java     |  4 ++
 .../streams/kstream/internals/KTableAggregate.java |  4 ++
 .../streams/kstream/internals/KTableFilter.java    |  4 ++
 .../streams/kstream/internals/KTableImpl.java      |  8 ++-
 .../kstream/internals/KTableKTableJoin.java        | 15 +++--
 .../kstream/internals/KTableKTableLeftJoin.java    | 16 ++++--
 .../kstream/internals/KTableKTableOuterJoin.java   | 21 ++++---
 .../kstream/internals/KTableKTableRightJoin.java   | 15 +++--
 .../streams/kstream/internals/KTableMapValues.java |  4 ++
 .../streams/kstream/internals/KTableReduce.java    |  4 ++
 .../kstream/internals/KTableRepartitionMap.java    |  5 ++
 .../internals/KTableSourceValueGetterSupplier.java |  5 ++
 .../internals/KTableValueGetterSupplier.java       |  1 +
 .../processor/internals/ProcessorContextImpl.java  | 10 ++--
 .../streams/processor/TopologyBuilderTest.java     | 66 ++++++++++++++++++++++
 20 files changed, 214 insertions(+), 32 deletions(-)
4e0b0b83a7af8fd7d6041d39275e9f82dba9d606

 core/src/main/scala/kafka/client/ClientUtils.scala        | 2 +-
 core/src/main/scala/kafka/consumer/ConsumerConfig.scala   | 2 +-
 core/src/main/scala/kafka/producer/SyncProducer.scala     | 2 +-
 core/src/main/scala/kafka/tools/ConsoleConsumer.scala     | 2 +-
 core/src/main/scala/kafka/tools/SimpleConsumerShell.scala | 4 ++--
 5 files changed, 6 insertions(+), 6 deletions(-)
3402a74efb23d1d4fef1e7284de8d4b151cde784

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
f287efaff4bfd8a22f18859aff3dba538f08ac04

 .../org/apache/kafka/clients/InFlightRequests.java | 16 +++++++------
 .../kafka/clients/consumer/KafkaConsumer.java      |  8 +------
 .../consumer/internals/ConsumerNetworkClient.java  |  8 +++++--
 .../kafka/clients/consumer/internals/Fetcher.java  | 16 +------------
 .../internals/ConsumerNetworkClientTest.java       | 27 +++++++++++++++++++++-
 .../clients/consumer/internals/FetcherTest.java    |  4 ----
 6 files changed, 43 insertions(+), 36 deletions(-)
6199c62776bf3ce9467703ca651a0119b261e60e

 .../org/apache/kafka/clients/InFlightRequests.java | 16 +++++++------
 .../kafka/clients/consumer/KafkaConsumer.java      |  8 +------
 .../consumer/internals/ConsumerNetworkClient.java  |  8 +++++--
 .../kafka/clients/consumer/internals/Fetcher.java  | 16 +------------
 .../internals/ConsumerNetworkClientTest.java       | 27 +++++++++++++++++++++-
 .../clients/consumer/internals/FetcherTest.java    |  4 ----
 6 files changed, 43 insertions(+), 36 deletions(-)
dbe676720a2e2648091aace675b7ac70ce8db4f4

 .../streams/processor/DefaultPartitionGrouper.java |   6 +-
 .../streams/processor/internals/AbstractTask.java  |   7 +-
 .../processor/internals/ProcessorStateManager.java |  45 ++++---
 .../processor/internals/RecordCollector.java       |  13 +-
 .../streams/processor/internals/RecordQueue.java   |   6 +
 .../streams/processor/internals/StandbyTask.java   |   7 +-
 .../streams/processor/internals/StreamTask.java    |  31 +++--
 .../streams/processor/internals/StreamThread.java  | 148 ++++++++++++---------
 8 files changed, 152 insertions(+), 111 deletions(-)
e7663a306f40e9fcbc3096d17fb0f99fa3d11d1d

 .../streams/processor/DefaultPartitionGrouper.java |   6 +-
 .../streams/processor/internals/AbstractTask.java  |   7 +-
 .../processor/internals/ProcessorStateManager.java |  45 ++++---
 .../processor/internals/RecordCollector.java       |  13 +-
 .../streams/processor/internals/RecordQueue.java   |   6 +
 .../streams/processor/internals/StandbyTask.java   |   7 +-
 .../streams/processor/internals/StreamTask.java    |  31 +++--
 .../streams/processor/internals/StreamThread.java  | 148 ++++++++++++---------
 8 files changed, 152 insertions(+), 111 deletions(-)
94769ec55ce37e2a059a3851ce157671e3c6a6ab

 docs/design.html         | 4 ++--
 docs/implementation.html | 2 +-
 docs/introduction.html   | 2 +-
 3 files changed, 4 insertions(+), 4 deletions(-)
9662e466d90093c9bc5315d0b9949dfbf353b988

 docs/design.html         | 4 ++--
 docs/implementation.html | 2 +-
 docs/introduction.html   | 2 +-
 3 files changed, 4 insertions(+), 4 deletions(-)
fc1551d40d571745e9932d552808f82e254e5002

 core/src/main/scala/kafka/log/LogCleaner.scala     |  82 ++++++++-------
 .../scala/kafka/message/ByteBufferMessageSet.scala |  28 +++---
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 110 ++++++++++++++++++++-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  56 ++++++++++-
 .../kafka/message/ByteBufferMessageSetTest.scala   |  52 ++++++++++
 5 files changed, 280 insertions(+), 48 deletions(-)
d09043637d5ea4094e3ee9808f29d037e8afaba6

 core/src/main/scala/kafka/log/LogCleaner.scala     |  82 ++++++++-------
 .../scala/kafka/message/ByteBufferMessageSet.scala |  28 +++---
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 110 ++++++++++++++++++++-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  56 ++++++++++-
 .../kafka/message/ByteBufferMessageSetTest.scala   |  52 ++++++++++
 5 files changed, 280 insertions(+), 48 deletions(-)
ed8c797af35fa52311422ce6af43f72ca6e7c1f8

 .../kafka/clients/producer/KafkaProducer.java      | 82 ++++++++++---------
 .../kafka/clients/producer/ProducerRecord.java     |  8 +-
 .../kafka/clients/producer/KafkaProducerTest.java  | 92 ++++++++++++++++++++--
 .../kafka/clients/producer/ProducerRecordTest.java | 40 ++++++++--
 .../kafka/api/BaseProducerSendTest.scala           | 90 +++++++++++++++++----
 .../kafka/api/ProducerFailureHandlingTest.scala    | 26 +++---
 6 files changed, 255 insertions(+), 83 deletions(-)
1a67739c2f3d0418a8f2d8f7b15d5af2ed3a324a

 .../kafka/clients/producer/KafkaProducer.java      | 82 ++++++++++---------
 .../kafka/clients/producer/ProducerRecord.java     |  8 +-
 .../kafka/clients/producer/KafkaProducerTest.java  | 92 ++++++++++++++++++++--
 .../kafka/clients/producer/ProducerRecordTest.java | 40 ++++++++--
 .../kafka/api/BaseProducerSendTest.scala           | 90 +++++++++++++++++----
 .../kafka/api/ProducerFailureHandlingTest.scala    | 26 +++---
 6 files changed, 255 insertions(+), 83 deletions(-)
5ed8fc00d00f9ccb9a5c926cc0d0be8cb0a3214d

 .../java/org/apache/kafka/streams/state/internals/NamedCache.java    | 3 +++
 .../org/apache/kafka/streams/state/internals/NamedCacheTest.java     | 5 +++++
 2 files changed, 8 insertions(+)
65f6a7964f5e59e789eae3cdd4d301bb6a649064

 .../java/org/apache/kafka/streams/state/internals/NamedCache.java    | 3 +++
 .../org/apache/kafka/streams/state/internals/NamedCacheTest.java     | 5 +++++
 2 files changed, 8 insertions(+)
83116c733d09f5c85ced56701cdb614ce6efc847

 gradle/rat.gradle | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)
ee212d1de3ca9b058364f34c5b8c30585298d51f

 .../java/org/apache/kafka/streams/smoketest/SmokeTestDriver.java    | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
c04486f4a5ec1101e6f1344658db359647ffa791

 .../java/org/apache/kafka/streams/smoketest/SmokeTestDriver.java    | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
c3b19ce021eb2bd93d69681a43bf3224227144a3

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
704308a6352461f09ac5adc37028b6c7b9f4f83f

 core/src/main/scala/kafka/log/FileMessageSet.scala     | 9 ++++++---
 core/src/main/scala/kafka/network/RequestChannel.scala | 2 +-
 2 files changed, 7 insertions(+), 4 deletions(-)
aaefe686bc5bc668e140c4f42278613411a71fdc

 docs/api.html    | 8 ++++----
 docs/design.html | 8 ++++++--
 docs/ops.html    | 4 +++-
 3 files changed, 13 insertions(+), 7 deletions(-)
ae9532c6b3befe2b18d336004bb0976e9d27d08e

 docs/api.html    | 8 ++++----
 docs/design.html | 8 ++++++--
 docs/ops.html    | 4 +++-
 3 files changed, 13 insertions(+), 7 deletions(-)
5fe9b81c1ceed738503e5df9a23bfd92274b3ee9

 .../MergedSortedCacheKeyValueStoreIterator.java    |  15 +++
 .../kafka/streams/state/internals/ThreadCache.java |   7 ++
 .../state/internals/CachingKeyValueStoreTest.java  |  20 ++++
 ...MergedSortedCacheKeyValueStoreIteratorTest.java | 107 +++++++++++++++++++--
 4 files changed, 141 insertions(+), 8 deletions(-)
93b940016348fcf64034f36e4b4f3fc53a966f74

 .../MergedSortedCacheKeyValueStoreIterator.java    |  15 +++
 .../kafka/streams/state/internals/ThreadCache.java |   7 ++
 .../state/internals/CachingKeyValueStoreTest.java  |  20 ++++
 ...MergedSortedCacheKeyValueStoreIteratorTest.java | 107 +++++++++++++++++++--
 4 files changed, 141 insertions(+), 8 deletions(-)
77bf1dc7cbc4332837d8efd3687749a1f31f7583

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9179bbc067cef5211107d19f96e0d836c3a007e1

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a1afb73941a578cc337ed44321780d3fa69c8df8

 .../connect/runtime/distributed/WorkerCoordinator.java | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)
c1e840050c11d2f1d20118273c572e4c8491866d

 .../connect/runtime/distributed/WorkerCoordinator.java | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)
72d5675a7cfc64a5547b921672856ea4afc4f4c2

 .../org/apache/kafka/common/config/ConfigDef.java  | 122 ++++++++++++++++-----
 .../apache/kafka/common/config/ConfigDefTest.java  |  97 +++++++++++++++-
 2 files changed, 189 insertions(+), 30 deletions(-)
d981dd25bc1890a40f0f3b1c759ecca1e29b3fd0

 docs/images/kafka-apis.png   | Bin 0 -> 86640 bytes
 docs/images/log_consumer.png | Bin 0 -> 139658 bytes
 2 files changed, 0 insertions(+), 0 deletions(-)
2e82bc0a105be5d19e3f6960184659db6eb4e74b

 docs/images/kafka-apis.png   | Bin 0 -> 86640 bytes
 docs/images/log_consumer.png | Bin 0 -> 139658 bytes
 2 files changed, 0 insertions(+), 0 deletions(-)
d1f691a566a34ea3e2703ff99e24ac6984bf7aef

 docs/documentation.html | 1 -
 docs/ops.html           | 4 ++--
 2 files changed, 2 insertions(+), 3 deletions(-)
8e9e63138d96a607c1f0482c395e7f9d1005a182

 docs/documentation.html | 1 -
 docs/ops.html           | 4 ++--
 2 files changed, 2 insertions(+), 3 deletions(-)
6956a3819abfd4b7804a8f77ec781be9f391c438

 .../kafka/clients/producer/ProducerConfig.java     |   2 +-
 .../org/apache/kafka/common/config/SslConfigs.java |   4 +-
 .../runtime/distributed/DistributedConfig.java     |   2 +-
 docs/api.html                                      |   2 +-
 docs/configuration.html                            |   2 +-
 docs/connect.html                                  |   4 +-
 docs/design.html                                   | 378 +++++++++++++++------
 docs/implementation.html                           |   2 +-
 docs/introduction.html                             |  12 +-
 docs/ops.html                                      |   7 +-
 docs/quickstart.html                               |   8 +-
 docs/security.html                                 |   6 +-
 docs/upgrade.html                                  |   4 +-
 13 files changed, 308 insertions(+), 125 deletions(-)
e972d2afd31913acdef8979c6cac7cf48f99da7b

 .../kafka/clients/producer/ProducerConfig.java     |   2 +-
 .../org/apache/kafka/common/config/SslConfigs.java |   4 +-
 .../runtime/distributed/DistributedConfig.java     |   2 +-
 docs/api.html                                      |   2 +-
 docs/configuration.html                            |   2 +-
 docs/connect.html                                  |   4 +-
 docs/design.html                                   | 378 +++++++++++++++------
 docs/implementation.html                           |   2 +-
 docs/introduction.html                             |  12 +-
 docs/ops.html                                      |   7 +-
 docs/quickstart.html                               |   8 +-
 docs/security.html                                 |   6 +-
 docs/upgrade.html                                  |   4 +-
 13 files changed, 308 insertions(+), 125 deletions(-)
401fe0a9b61110d94b880fb0273fc13220f30a62

 docs/api.html           |  10 +-
 docs/documentation.html | 313 +++++++++++++++++++++++++-----------------------
 2 files changed, 166 insertions(+), 157 deletions(-)
06d6d98bed616a66799585fc1f9166dc87247f8c

 docs/api.html           |  12 +-
 docs/documentation.html | 313 +++++++++++++++++++++++++-----------------------
 2 files changed, 167 insertions(+), 158 deletions(-)
1bce0d1b5120743a9a0559a6c9a98249d463fe02

 .../kafka/controller/PartitionStateMachine.scala   | 39 +++++++++++++---------
 .../kafka/controller/TopicDeletionManager.scala    | 19 ++++++++---
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 23 +++++++++++--
 3 files changed, 59 insertions(+), 22 deletions(-)
e7407529f6fc030d303161829d98ff97c667edad

 docs/documentation.html |   4 +-
 docs/introduction.html  | 112 ++++++++++++++++++++++++++++++------------------
 docs/protocol.html      |  12 +++++-
 docs/quickstart.html    |  84 ++++++++++++++++++++++--------------
 docs/uses.html          |   2 +-
 5 files changed, 134 insertions(+), 80 deletions(-)
bf98c47389baa735aab9cfbf513190a8205447f9

 docs/documentation.html |   4 +-
 docs/introduction.html  | 112 ++++++++++++++++++++++++++++++------------------
 docs/protocol.html      |  12 +++++-
 docs/quickstart.html    |  84 ++++++++++++++++++++++--------------
 docs/uses.html          |   2 +-
 5 files changed, 134 insertions(+), 80 deletions(-)
d4bd00afa6510a3bb7969182d8d2b239b539634c

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
75632e3d1236461d2dc0f0f3cd5d00ed135e6f46

 docs/introduction.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7a5133d5545fbffa5bea89818a5b6b3e2175e418

 docs/introduction.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8cd3875a2fb47b8e67bb5122fe77913f121515df

 docs/introduction.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
210ffe2b9e45d4f77e9c91e65d3844a97a6a2f81

 docs/api.html           | 183 ++++++++++++------------------------------------
 docs/documentation.html |  33 ++++-----
 docs/ecosystem.html     |   2 -
 docs/introduction.html  | 148 ++++++++++++++++++++++++++++-----------
 docs/uses.html          |   2 -
 5 files changed, 168 insertions(+), 200 deletions(-)
fb22685fa9e2df7793605ea6f41181ad51c76686

 docs/introduction.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e696f17a6463ec92b45e44726b88ca1e6f56ddf6

 docs/quickstart.html | 21 ++++++++++++++++-----
 1 file changed, 16 insertions(+), 5 deletions(-)
179d0698573bfc75b2c91185bdcb8b4d2f3038e0

 docs/quickstart.html | 21 ++++++++++++++++-----
 1 file changed, 16 insertions(+), 5 deletions(-)
7614523568a9e6958a718df5c96b77ab66c2d725

 core/src/test/scala/unit/kafka/server/ReplicationQuotasTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
44d18d273c36bb76fa16baec68a9294d697a1c9b

 core/src/test/scala/unit/kafka/server/ReplicationQuotasTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
cbf16eac7b8db0d7335989c2ecc4a057f1debfe8

 .../main/java/org/apache/kafka/clients/consumer/internals/Fetcher.java | 3 +++
 .../java/org/apache/kafka/clients/consumer/internals/FetcherTest.java  | 2 ++
 core/src/main/scala/kafka/api/ApiVersion.scala                         | 2 +-
 3 files changed, 6 insertions(+), 1 deletion(-)
6b91f83fbaef26fefb9ec221529c29872a04c004

 .../main/java/org/apache/kafka/clients/consumer/internals/Fetcher.java | 3 +++
 .../java/org/apache/kafka/clients/consumer/internals/FetcherTest.java  | 2 ++
 core/src/main/scala/kafka/api/ApiVersion.scala                         | 2 +-
 3 files changed, 6 insertions(+), 1 deletion(-)
1a23ac5cbb8828a0c52c474187b22e33d3dc742c

 .../org/apache/kafka/streams/KafkaStreams.java     | 86 +++++++++++-----------
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 49 ++----------
 .../streams/integration/ResetIntegrationTest.java  |  2 +-
 3 files changed, 50 insertions(+), 87 deletions(-)
e876df8b37fc6ea54b0a0571306c4a833c919cda

 .../org/apache/kafka/streams/KafkaStreams.java     | 86 +++++++++++-----------
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 49 ++----------
 .../streams/integration/ResetIntegrationTest.java  |  2 +-
 3 files changed, 50 insertions(+), 87 deletions(-)
d6b54da3e433da5a650e397d24db59c7bc05d6e4

 .../streams/processor/internals/StreamThread.java  | 23 +++++++++++-----------
 1 file changed, 12 insertions(+), 11 deletions(-)
454f6845b34d0e3faabd9427f3cd8bbe6209c30d

 .../streams/processor/internals/StreamThread.java  | 23 +++++++++++-----------
 1 file changed, 12 insertions(+), 11 deletions(-)
e409d8afd235a719f44cc4ec2473a99c53ad0bc2

 core/src/test/scala/unit/kafka/server/DelayedOperationTest.scala | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
615cd4fd3ad7abe7600e4f80ce6c36f7125f599e

 core/src/test/scala/unit/kafka/server/DelayedOperationTest.scala | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
7232a031b5d9454fe917025875f6f04fcf36e282

 .../test/scala/unit/kafka/admin/ReassignPartitionsClusterTest.scala   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
5e4600ae469559b9cdb36c17efb90cc6b6388826

 .../test/scala/unit/kafka/admin/ReassignPartitionsClusterTest.scala   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
db45b1819f0608ef266608058c2fbdd972a4a4a3

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  2 +-
 .../kafka/server/DynamicConfigChangeTest.scala     | 31 ++++++++++++++++++++++
 2 files changed, 32 insertions(+), 1 deletion(-)
8b75a016db16e20c5d5180deb6859bf0ad4c48fd

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  2 +-
 .../kafka/server/DynamicConfigChangeTest.scala     | 31 ++++++++++++++++++++++
 2 files changed, 32 insertions(+), 1 deletion(-)
378e92506ba86c0147f2ca15664edb6be56a8881

 docs/ops.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
3c8925946ddfe7be8bea521c7d08a56aec756a2d

 docs/ops.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d9ea35e6d34933efb4f16eaca8551fa834d8b292

 .../streams/processor/internals/AbstractTask.java  |  14 ++-
 .../processor/internals/ProcessorStateManager.java |   5 +-
 .../streams/processor/internals/StandbyTask.java   |  10 ++
 .../streams/processor/internals/StreamTask.java    |  13 ++-
 .../streams/processor/internals/StreamThread.java  | 112 +++++++++++++++------
 .../streams/state/internals/RocksDBStore.java      |   1 -
 .../processor/internals/AbstractTaskTest.java      |  10 ++
 .../internals/ProcessorStateManagerTest.java       |   6 +-
 .../processor/internals/StandbyTaskTest.java       |   4 +-
 .../processor/internals/StreamThreadTest.java      |   6 ++
 .../state/internals/StateStoreTestUtils.java       |  31 +-----
 .../org/apache/kafka/test/NoOpRecordCollector.java |  48 +++++++++
 12 files changed, 189 insertions(+), 71 deletions(-)
c9da62794547ee75a7e2ade1aa8bbf4a1443c49c

 .../streams/processor/internals/AbstractTask.java  |  14 ++-
 .../processor/internals/ProcessorStateManager.java |   5 +-
 .../streams/processor/internals/StandbyTask.java   |  10 ++
 .../streams/processor/internals/StreamTask.java    |  13 ++-
 .../streams/processor/internals/StreamThread.java  | 112 +++++++++++++++------
 .../streams/state/internals/RocksDBStore.java      |   1 -
 .../processor/internals/AbstractTaskTest.java      |  10 ++
 .../internals/ProcessorStateManagerTest.java       |   6 +-
 .../processor/internals/StandbyTaskTest.java       |   4 +-
 .../processor/internals/StreamThreadTest.java      |   6 ++
 .../state/internals/StateStoreTestUtils.java       |  31 +-----
 .../org/apache/kafka/test/NoOpRecordCollector.java |  48 +++++++++
 12 files changed, 189 insertions(+), 71 deletions(-)
53474ae6c7c87f2fb938701f4e5dcd4654bfb90c

 docs/upgrade.html | 17 ++++++++++-------
 1 file changed, 10 insertions(+), 7 deletions(-)
4efa833f45c5765ce3a5179f20fd384e2f2e210c

 docs/upgrade.html | 17 ++++++++++-------
 1 file changed, 10 insertions(+), 7 deletions(-)
561f45d747cd2a8cdac6a05e275d10d8094aeb03

 .../kafkatest/services/security/security_config.py | 24 +++++++++++-----------
 1 file changed, 12 insertions(+), 12 deletions(-)
b049606aebbb6c08120e53a6bf3d9519bb14b076

 .../kafkatest/services/security/security_config.py | 24 +++++++++++-----------
 1 file changed, 12 insertions(+), 12 deletions(-)
97b40a10d9cbbdc5db292420eda93cb288d11d5a

 .../apache/kafka/streams/kstream/internals/KeyValuePrinter.java   | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)
3e9f357fb56fd2b030a616b0d9d475cfa481e149

 .../apache/kafka/streams/kstream/internals/KeyValuePrinter.java   | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)
e529f3a38350e371f6bb0adc4a559900a160e36b

 Vagrantfile | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
305fb59b13da8b0b0a1a657688c0fa5f5916c91f

 Vagrantfile | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
f4c186d313a7157007287f0e8ee185f0aa6ac8bd

 docs/api.html           | 12 ++++++------
 docs/documentation.html |  4 ++--
 docs/quickstart.html    |  6 +++---
 3 files changed, 11 insertions(+), 11 deletions(-)
68d973cf4fb61f7dd645505fc1a962354303525f

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
017defcd13061c5c8c4b55696b31e105da3cc27a

 tests/kafkatest/tests/core/compatibility_test_new_broker_test.py | 3 ++-
 tests/kafkatest/tests/core/upgrade_test.py                       | 7 +++----
 2 files changed, 5 insertions(+), 5 deletions(-)
b3eef7bc72743b006d068ae6c3edf71d413ef433

 tests/kafkatest/tests/core/compatibility_test_new_broker_test.py | 3 ++-
 tests/kafkatest/tests/core/upgrade_test.py                       | 7 +++----
 2 files changed, 5 insertions(+), 5 deletions(-)
41b12a6ad7093f1a45c904bc9fb33d69a23d1757

 docs/upgrade.html | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)
d8d2f3aac44562d2eec0911a44aec6b699dd0212

 docs/upgrade.html | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)
aafc869286473ca480e5529a8c1ae86284976503

 docs/upgrade.html | 1 +
 1 file changed, 1 insertion(+)
1a396c9cf22441a7afa8ec9c4a94a48f881cdd90

 docs/upgrade.html | 1 +
 1 file changed, 1 insertion(+)
3d7e3d68570f8a1ec759f1bd671e9271c3dd99cc

 core/src/main/scala/kafka/log/LogCleaner.scala     | 26 +++++++------
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 43 +++++++++++++++++++---
 2 files changed, 53 insertions(+), 16 deletions(-)
672dfaa243850a835c1b01da4fb20311ba6455bc

 core/src/main/scala/kafka/log/LogCleaner.scala     | 26 +++++++------
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 43 +++++++++++++++++++---
 2 files changed, 53 insertions(+), 16 deletions(-)
0397c77775b9eb17aff27fbfde8ea3d7c73fdc3e

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
91d025e063e9f2b8e5799f84f6f3f7f1e9b0916c

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
82929f5c9bd519bc41f40d230164e721258d1860

 core/src/main/scala/kafka/api/FetchRequest.scala   | 10 +++-
 .../scala/unit/kafka/api/FetchRequestTest.scala    | 63 ++++++++++++++++++++++
 docs/upgrade.html                                  | 18 +++++--
 3 files changed, 85 insertions(+), 6 deletions(-)
cf0bf7c7a24aa5a19069b6e8456353c9b498dffc

 core/src/main/scala/kafka/api/FetchRequest.scala   | 10 +++-
 .../scala/unit/kafka/api/FetchRequestTest.scala    | 63 ++++++++++++++++++++++
 docs/upgrade.html                                  | 18 +++++--
 3 files changed, 85 insertions(+), 6 deletions(-)
780419f261f8381df5bd80220aa8f106b487820c

 .../consumer/internals/ConsumerCoordinator.java    |   4 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  28 +++--
 .../kafka/clients/producer/internals/Sender.java   |   8 +-
 .../common/requests/OffsetCommitResponse.java      |   1 +
 .../kafka/common/requests/OffsetFetchResponse.java |   2 +-
 .../internals/ConsumerCoordinatorTest.java         |  20 ++++
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  17 ++-
 core/src/main/scala/kafka/utils/Logging.scala      |   2 +
 .../kafka/api/AuthorizerIntegrationTest.scala      | 133 +++++++++++++--------
 .../kafka/api/EndToEndAuthorizationTest.scala      | 115 ++++++------------
 .../kafka/api/IntegrationTestHarness.scala         |  18 +--
 docs/upgrade.html                                  |   7 +-
 13 files changed, 186 insertions(+), 171 deletions(-)
7115c66aefb11efa802e61a42bcc13fadf92598d

 .../consumer/internals/ConsumerCoordinator.java    |   4 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  28 +++--
 .../kafka/clients/producer/internals/Sender.java   |   8 +-
 .../common/requests/OffsetCommitResponse.java      |   1 +
 .../kafka/common/requests/OffsetFetchResponse.java |   2 +-
 .../internals/ConsumerCoordinatorTest.java         |  20 ++++
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  17 ++-
 core/src/main/scala/kafka/utils/Logging.scala      |   2 +
 .../kafka/api/AuthorizerIntegrationTest.scala      | 133 +++++++++++++--------
 .../kafka/api/EndToEndAuthorizationTest.scala      | 115 ++++++------------
 .../kafka/api/IntegrationTestHarness.scala         |  18 +--
 docs/upgrade.html                                  |   7 +-
 13 files changed, 186 insertions(+), 171 deletions(-)
3013c6bcac93af8e14a597533f7909dc9447bdd4

 .../kafka/clients/consumer/KafkaConsumer.java      |   3 +
 .../consumer/internals/ConsumerCoordinator.java    |  31 ++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 177 ++++++++++++++++++---
 3 files changed, 175 insertions(+), 36 deletions(-)
a23859e5686bf93ed7e0d310f949757694d47a1b

 .../kafka/clients/consumer/KafkaConsumer.java      |   3 +
 .../consumer/internals/ConsumerCoordinator.java    |  31 ++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 177 ++++++++++++++++++---
 3 files changed, 175 insertions(+), 36 deletions(-)
e62e3b745141d5fd6b461634f3768ef8a42d2eaa

 .../kafka/admin/ReassignPartitionsCommand.scala    | 16 ++++++-------
 core/src/main/scala/kafka/log/LogConfig.scala      | 24 +++++++++----------
 .../main/scala/kafka/server/ConfigHandler.scala    | 10 ++++----
 .../main/scala/kafka/server/DynamicConfig.scala    | 18 +++++++-------
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 24 +++++++++----------
 .../admin/ReassignPartitionsCommandTest.scala      | 28 +++++++++++-----------
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   | 16 ++++++-------
 .../kafka/server/DynamicConfigChangeTest.scala     | 16 ++++++-------
 .../unit/kafka/server/DynamicConfigTest.scala      |  4 ++--
 .../unit/kafka/server/ReplicationQuotasTest.scala  | 12 +++++-----
 10 files changed, 84 insertions(+), 84 deletions(-)
496594a12c67d468c5ab58d83bf31caea3154e56

 .../kafka/admin/ReassignPartitionsCommand.scala    | 16 ++++++-------
 core/src/main/scala/kafka/log/LogConfig.scala      | 24 +++++++++----------
 .../main/scala/kafka/server/ConfigHandler.scala    | 10 ++++----
 .../main/scala/kafka/server/DynamicConfig.scala    | 18 +++++++-------
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 24 +++++++++----------
 .../admin/ReassignPartitionsCommandTest.scala      | 28 +++++++++++-----------
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   | 16 ++++++-------
 .../kafka/server/DynamicConfigChangeTest.scala     | 16 ++++++-------
 .../unit/kafka/server/DynamicConfigTest.scala      |  4 ++--
 .../unit/kafka/server/ReplicationQuotasTest.scala  | 12 +++++-----
 10 files changed, 84 insertions(+), 84 deletions(-)
49e4f85d3ef471edd9edb18f54e7c29e03aef530

 vagrant/README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9e8934065a85437767617d06d922a4f6591bb63d

 vagrant/README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a6ea4df5c2c32e609b281fe1dccf6c89a5fdccde

 .../org/apache/kafka/streams/StreamsConfig.java    | 63 +++++++++++-----------
 .../apache/kafka/streams/StreamsConfigTest.java    | 24 +++++++++
 2 files changed, 54 insertions(+), 33 deletions(-)
c78a3b173d019e8bb58f4e31c94bf4dd3f7ab614

 .../org/apache/kafka/streams/StreamsConfig.java    | 63 +++++++++++-----------
 .../apache/kafka/streams/StreamsConfigTest.java    | 24 +++++++++
 2 files changed, 54 insertions(+), 33 deletions(-)
cd39f071c0117e6518c232d36a443345bc6bb8e9

 tests/kafkatest/services/console_consumer.py                 | 4 ++--
 tests/kafkatest/services/kafka/kafka.py                      | 4 ++--
 tests/kafkatest/services/monitor/jmx.py                      | 6 +++---
 tests/kafkatest/services/performance/producer_performance.py | 8 ++++----
 4 files changed, 11 insertions(+), 11 deletions(-)
33c7b88ffe3fc0de9f0154c5667b20ea34c94849

 tests/kafkatest/services/console_consumer.py                 | 4 ++--
 tests/kafkatest/services/kafka/kafka.py                      | 4 ++--
 tests/kafkatest/services/monitor/jmx.py                      | 6 +++---
 tests/kafkatest/services/performance/producer_performance.py | 8 ++++----
 4 files changed, 11 insertions(+), 11 deletions(-)
4cb726fde57675239d831882c8bb5296e0fa2249

 .../consumer/internals/ConsumerCoordinator.java    |   6 +
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 132 +++++++-----
 .../main/scala/kafka/server/MetadataCache.scala    |   6 -
 .../kafka/api/AuthorizerIntegrationTest.scala      | 233 +++++++++++++++++----
 .../kafka/api/EndToEndAuthorizationTest.scala      | 176 +++++++++++++---
 .../kafka/api/IntegrationTestHarness.scala         |  48 ++++-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |   6 +-
 .../kafka/server/DeleteTopicsRequestTest.scala     |   4 +-
 docs/upgrade.html                                  |   2 +
 11 files changed, 474 insertions(+), 147 deletions(-)
8124f6e0996cb673760750b3aba004ae11e34c6a

 .../consumer/internals/ConsumerCoordinator.java    |   6 +
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 132 +++++++-----
 .../main/scala/kafka/server/MetadataCache.scala    |   6 -
 .../kafka/api/AuthorizerIntegrationTest.scala      | 233 +++++++++++++++++----
 .../kafka/api/EndToEndAuthorizationTest.scala      | 176 +++++++++++++---
 .../kafka/api/IntegrationTestHarness.scala         |  48 ++++-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |   6 +-
 .../kafka/server/DeleteTopicsRequestTest.scala     |   4 +-
 docs/upgrade.html                                  |   2 +
 11 files changed, 474 insertions(+), 147 deletions(-)
8ad31173e52bf304a40c675680bade35c1f97bfb

 .../kafka/clients/consumer/KafkaConsumer.java      | 141 +++++++++++----------
 1 file changed, 73 insertions(+), 68 deletions(-)
f8b69aacd4ed1af1263e46b93879cea2d855df3b

 .../kafka/clients/consumer/KafkaConsumer.java      | 141 +++++++++++----------
 1 file changed, 73 insertions(+), 68 deletions(-)
8ed5958366c3ef7269fd363cde99b308d93fbd47

 tests/kafkatest/tests/produce_consume_validate.py | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
788989158a466aa89f030940a28d4f868e275ed7

 tests/kafkatest/tests/produce_consume_validate.py | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
abf056c08565d6966f4feccf722dac98be18dc31

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java     |  4 ----
 .../org/apache/kafka/clients/consumer/KafkaConsumerTest.java | 12 +-----------
 2 files changed, 1 insertion(+), 15 deletions(-)
20322446aa261dec8b51e6e4514307e926a29ba5

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java     |  4 ----
 .../org/apache/kafka/clients/consumer/KafkaConsumerTest.java | 12 +-----------
 2 files changed, 1 insertion(+), 15 deletions(-)
ac6cce77e2738e981e7a956dcaf1c54791ff1cad

 core/src/main/scala/kafka/metrics/KafkaMetricsGroup.scala | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
095475d481a230b81f312f94034a8d4d2b581eb9

 core/src/main/scala/kafka/metrics/KafkaMetricsGroup.scala | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
b43f2ededcd6db258fab22bb5d29788c4363416e

 clients/src/test/java/org/apache/kafka/test/TestUtils.java  | 13 ++++++++-----
 .../kafka/streams/integration/ResetIntegrationTest.java     |  3 ++-
 2 files changed, 10 insertions(+), 6 deletions(-)
451d263bb4df844bc4a359c320e7265ea25f3c8e

 clients/src/test/java/org/apache/kafka/test/TestUtils.java  | 13 ++++++++-----
 .../kafka/streams/integration/ResetIntegrationTest.java     |  3 ++-
 2 files changed, 10 insertions(+), 6 deletions(-)
55b06838c094143bede328a73a375860c95aeb33

 tests/kafkatest/services/kafka/config_property.py  |   2 +-
 tests/kafkatest/services/kafka/kafka.py            |  35 ++++-
 .../tests/core/reassign_partitions_test.py         |   4 +-
 tests/kafkatest/tests/core/throttling_test.py      | 174 +++++++++++++++++++++
 tests/kafkatest/tests/produce_consume_validate.py  |  49 ++++--
 5 files changed, 242 insertions(+), 22 deletions(-)
5a989d1748426004212d44abad4567f9034a04ef

 tests/kafkatest/services/kafka/config_property.py  |   2 +-
 tests/kafkatest/services/kafka/kafka.py            |  35 ++++-
 .../tests/core/reassign_partitions_test.py         |   4 +-
 tests/kafkatest/tests/core/throttling_test.py      | 174 +++++++++++++++++++++
 tests/kafkatest/tests/produce_consume_validate.py  |  49 ++++--
 5 files changed, 242 insertions(+), 22 deletions(-)
cbf4bf4ff0162a16039258cd8e2006492a7631f9

 .../streams/processor/internals/StateDirectory.java      | 16 ++++++++++------
 .../streams/processor/internals/StateDirectoryTest.java  | 10 ++++++++++
 2 files changed, 20 insertions(+), 6 deletions(-)
5f3746d135697f364aaacf877ce288267d00b9a2

 .../streams/processor/internals/StateDirectory.java      | 16 ++++++++++------
 .../streams/processor/internals/StateDirectoryTest.java  | 10 ++++++++++
 2 files changed, 20 insertions(+), 6 deletions(-)
45f608997621060dbdfa48a3ad8993adcf1b99c7

 .../main/java/org/apache/kafka/clients/producer/internals/Sender.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
18a0812618a151e8ac700545699173b10caf692b

 .../main/java/org/apache/kafka/clients/producer/internals/Sender.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
c57a7259bf2661fa6dfdac2cc58f5cbd735c078c

 .../org/apache/kafka/streams/processor/internals/RecordCollector.java   | 2 +-
 .../test/java/org/apache/kafka/test/ProcessorTopologyTestDriver.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
4292243009c066c9ab5477ce886d8eb00534587e

 .../org/apache/kafka/streams/processor/internals/RecordCollector.java   | 2 +-
 .../test/java/org/apache/kafka/test/ProcessorTopologyTestDriver.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
cfe3f257e361fd792c504cad0d81d1267a442584

 .../apache/kafka/streams/integration/KStreamRepartitionJoinTest.java   | 3 +++
 .../apache/kafka/streams/integration/RegexSourceIntegrationTest.java   | 1 +
 .../apache/kafka/streams/integration/utils/EmbeddedKafkaCluster.java   | 1 +
 3 files changed, 5 insertions(+)
43c30b8c3970d6a6252490c42b3300c445d80d37

 .../apache/kafka/streams/integration/KStreamRepartitionJoinTest.java   | 3 +++
 .../apache/kafka/streams/integration/RegexSourceIntegrationTest.java   | 1 +
 .../apache/kafka/streams/integration/utils/EmbeddedKafkaCluster.java   | 1 +
 3 files changed, 5 insertions(+)
946af8e1f0dc4af0fed1f6a531ba964941b2b3e6

 .../kafka/admin/ReassignPartitionsCommand.scala    | 30 ++++++++-----
 core/src/main/scala/kafka/log/LogConfig.scala      | 12 ++---
 .../main/scala/kafka/server/ConfigHandler.scala    | 12 +++--
 .../main/scala/kafka/server/DynamicConfig.scala    | 17 ++++---
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 13 ++++--
 .../admin/ReassignPartitionsCommandTest.scala      | 52 +++++++++++++++++++---
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   | 21 +++++----
 .../unit/kafka/server/DynamicConfigTest.scala      | 11 ++++-
 .../unit/kafka/server/ReplicationQuotasTest.scala  | 10 +++--
 9 files changed, 131 insertions(+), 47 deletions(-)
0bc1f41fc02062ff224f12ffac053ea3753ecb98

 .../kafka/admin/ReassignPartitionsCommand.scala    | 30 ++++++++-----
 core/src/main/scala/kafka/log/LogConfig.scala      | 12 ++---
 .../main/scala/kafka/server/ConfigHandler.scala    | 12 +++--
 .../main/scala/kafka/server/DynamicConfig.scala    | 17 ++++---
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 13 ++++--
 .../admin/ReassignPartitionsCommandTest.scala      | 52 +++++++++++++++++++---
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   | 21 +++++----
 .../unit/kafka/server/DynamicConfigTest.scala      | 11 ++++-
 .../unit/kafka/server/ReplicationQuotasTest.scala  | 10 +++--
 9 files changed, 131 insertions(+), 47 deletions(-)
2b431b551252a65113cb720b102a2f3e8b301099

 .../streams/state/internals/RocksDBStore.java      | 49 ++++++++++++++++------
 .../state/internals/RocksDBKeyValueStoreTest.java  | 49 ++++++++++++++++++++++
 .../state/internals/RocksDBWindowStoreTest.java    | 41 ++++++++++++++++++
 3 files changed, 126 insertions(+), 13 deletions(-)
9edc71230ee7b77fd512f6d923e76469508c3280

 .../streams/state/internals/RocksDBStore.java      | 49 ++++++++++++++++------
 .../state/internals/RocksDBKeyValueStoreTest.java  | 49 ++++++++++++++++++++++
 .../state/internals/RocksDBWindowStoreTest.java    | 41 ++++++++++++++++++
 3 files changed, 126 insertions(+), 13 deletions(-)
7de050ee50e78992706e0c7f72a80a422650c23a

 docs/configuration.html  | 13 +++++++------
 docs/documentation.html  |  4 ++--
 docs/implementation.html |  4 ++--
 docs/ops.html            |  8 ++++----
 docs/quickstart.html     | 10 +++++-----
 docs/security.html       |  2 +-
 docs/upgrade.html        |  2 +-
 7 files changed, 22 insertions(+), 21 deletions(-)
d2a267b111d23d6b98f2784382095b9ae5ddf886

 docs/configuration.html  | 13 +++++++------
 docs/documentation.html  |  4 ++--
 docs/implementation.html |  4 ++--
 docs/ops.html            |  8 ++++----
 docs/quickstart.html     | 10 +++++-----
 docs/security.html       |  2 +-
 docs/upgrade.html        |  2 +-
 7 files changed, 22 insertions(+), 21 deletions(-)
2a059fa6882998972f2fe8d21411582c6d999c63

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 1 +
 1 file changed, 1 insertion(+)
7c6d70655a7de6a3b688a3e869a091f863de2eef

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 1 +
 1 file changed, 1 insertion(+)
472b3a5584c3486e2f351ff330cd4e319d3f144f

 tests/kafkatest/services/kafka/templates/kafka.properties     |  4 +++-
 .../kafkatest/services/templates/console_consumer.properties  |  3 +++
 tests/kafkatest/tests/produce_consume_validate.py             | 11 ++++++-----
 3 files changed, 12 insertions(+), 6 deletions(-)
0c8c167e844e53f64df80fca52b9b9b1d3dba8b7

 tests/kafkatest/services/kafka/templates/kafka.properties     |  4 +++-
 .../kafkatest/services/templates/console_consumer.properties  |  3 +++
 tests/kafkatest/tests/produce_consume_validate.py             | 11 ++++++-----
 3 files changed, 12 insertions(+), 6 deletions(-)
18e05117a320fc2a2c6e63a2da29d565c72fb173

 .../kafka/admin/ReassignPartitionsCommand.scala    | 104 +++++++++++------
 core/src/main/scala/kafka/log/LogConfig.scala      |  25 ++--
 .../main/scala/kafka/server/ConfigHandler.scala    |  52 +++++----
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  12 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  53 ++++++---
 .../admin/ReassignPartitionsClusterTest.scala      |  30 +++--
 .../admin/ReassignPartitionsCommandTest.scala      | 128 ++++++++++++++-------
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   |  11 +-
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  13 ++-
 .../kafka/server/DynamicConfigChangeTest.scala     |  28 +++--
 .../unit/kafka/server/DynamicConfigTest.scala      |  10 +-
 .../unit/kafka/server/ReplicationQuotasTest.scala  |  14 ++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   7 --
 13 files changed, 315 insertions(+), 172 deletions(-)
2ca9177f499a07262db0072bbbb252d3ca2dfb58

 .../kafka/admin/ReassignPartitionsCommand.scala    | 104 +++++++++++------
 core/src/main/scala/kafka/log/LogConfig.scala      |  25 ++--
 .../main/scala/kafka/server/ConfigHandler.scala    |  52 +++++----
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  12 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  53 ++++++---
 .../admin/ReassignPartitionsClusterTest.scala      |  30 +++--
 .../admin/ReassignPartitionsCommandTest.scala      | 128 ++++++++++++++-------
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   |  11 +-
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  13 ++-
 .../kafka/server/DynamicConfigChangeTest.scala     |  28 +++--
 .../unit/kafka/server/DynamicConfigTest.scala      |  10 +-
 .../unit/kafka/server/ReplicationQuotasTest.scala  |  14 ++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   7 --
 13 files changed, 315 insertions(+), 172 deletions(-)
f20aaaa66b7d940c1af5fbb010733d28be61f038

 tests/kafkatest/services/console_consumer.py                 | 4 +++-
 tests/kafkatest/services/performance/consumer_performance.py | 9 +++++----
 2 files changed, 8 insertions(+), 5 deletions(-)
a6f3cf56b3ce5c97e89f4b80c34d54ea608950ee

 tests/kafkatest/services/console_consumer.py                 | 4 +++-
 tests/kafkatest/services/performance/consumer_performance.py | 9 +++++----
 2 files changed, 8 insertions(+), 5 deletions(-)
fe57fe6943338b136e722e85fa9c860646a06da7

 build.gradle | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)
2353f100fb7502ab2dc6c527485c3263f618df52

 build.gradle | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)
67e99d0869dd49358d7ca549ac715b722fda89f5

 build.gradle | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)
003c333f62d7edddcd12f8936fef3b22e27bd605

 .../apache/kafka/clients/consumer/Consumer.java    |  1 -
 .../kafka/clients/consumer/KafkaConsumer.java      | 23 ++++---
 .../kafka/clients/consumer/MockConsumer.java       |  3 +-
 .../kafka/clients/consumer/OffsetAndTimestamp.java | 60 +++++++++++++++++
 .../consumer/internals/ConsumerNetworkClient.java  | 15 ++++-
 .../kafka/clients/consumer/internals/Fetcher.java  | 63 +++++++++++-------
 .../UnsupportedForMessageFormatException.java      | 29 +++++++++
 .../org/apache/kafka/common/protocol/Errors.java   |  5 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  2 +-
 .../kafka/common/record/OffsetAndTimestamp.java    | 58 -----------------
 .../kafka/common/requests/ListOffsetRequest.java   |  3 +-
 .../kafka/common/requests/ListOffsetResponse.java  |  2 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  4 ++
 .../java/org/apache/kafka/clients/MockClient.java  | 30 +++++++++
 .../internals/ConsumerNetworkClientTest.java       |  7 +-
 .../clients/consumer/internals/FetcherTest.java    | 76 +++++++++++++++++++---
 .../kafka/common/requests/RequestResponseTest.java |  4 ++
 core/src/main/scala/kafka/log/FileMessageSet.scala |  2 -
 core/src/main/scala/kafka/log/Log.scala            |  9 +--
 core/src/main/scala/kafka/log/LogSegment.scala     |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 75 ++++++++++-----------
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  2 +-
 docs/upgrade.html                                  |  3 +-
 23 files changed, 319 insertions(+), 159 deletions(-)
aa506a6919e8ec0381657db2c2f15dc1f62b00f6

 .../apache/kafka/clients/consumer/Consumer.java    |  1 -
 .../kafka/clients/consumer/KafkaConsumer.java      | 23 ++++---
 .../kafka/clients/consumer/MockConsumer.java       |  3 +-
 .../kafka/clients/consumer/OffsetAndTimestamp.java | 60 +++++++++++++++++
 .../consumer/internals/ConsumerNetworkClient.java  | 15 ++++-
 .../kafka/clients/consumer/internals/Fetcher.java  | 63 +++++++++++-------
 .../UnsupportedForMessageFormatException.java      | 29 +++++++++
 .../org/apache/kafka/common/protocol/Errors.java   |  5 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  2 +-
 .../kafka/common/record/OffsetAndTimestamp.java    | 58 -----------------
 .../kafka/common/requests/ListOffsetRequest.java   |  3 +-
 .../kafka/common/requests/ListOffsetResponse.java  |  2 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  4 ++
 .../java/org/apache/kafka/clients/MockClient.java  | 30 +++++++++
 .../internals/ConsumerNetworkClientTest.java       |  7 +-
 .../clients/consumer/internals/FetcherTest.java    | 76 +++++++++++++++++++---
 .../kafka/common/requests/RequestResponseTest.java |  4 ++
 core/src/main/scala/kafka/log/FileMessageSet.scala |  2 -
 core/src/main/scala/kafka/log/Log.scala            |  9 +--
 core/src/main/scala/kafka/log/LogSegment.scala     |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 75 ++++++++++-----------
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  2 +-
 docs/upgrade.html                                  |  3 +-
 23 files changed, 319 insertions(+), 159 deletions(-)
71036527e949c5c165e866163c55df9678327044

 .../integration/kafka/api/BaseQuotaTest.scala      | 98 +++++++++++-----------
 1 file changed, 51 insertions(+), 47 deletions(-)
16f85e84ce8c01329b3298d5fca8b27cfcacddb6

 docs/api.html           | 187 ++++++++++++------------------------------------
 docs/documentation.html |  33 ++++-----
 docs/ecosystem.html     |   2 -
 docs/introduction.html  | 148 ++++++++++++++++++++++++++++----------
 docs/uses.html          |   2 -
 5 files changed, 170 insertions(+), 202 deletions(-)
7e67d87c121414fa16465fa34309053c9531b9ac

 core/src/main/scala/kafka/server/AdminManager.scala | 4 ++++
 core/src/main/scala/kafka/server/KafkaServer.scala  | 2 ++
 2 files changed, 6 insertions(+)
281fac9ed626b16190d56e609c9bf04a3188374a

 core/src/main/scala/kafka/server/AdminManager.scala | 4 ++++
 core/src/main/scala/kafka/server/KafkaServer.scala  | 2 ++
 2 files changed, 6 insertions(+)
66b2caafe9f8eef4476558277401760ee9077480

 .../org/apache/kafka/streams/StreamsConfig.java    | 23 ++++--
 .../streams/processor/internals/AbstractTask.java  | 15 +++-
 .../streams/processor/internals/ProcessorNode.java | 13 ++-
 .../processor/internals/ProcessorStateManager.java | 31 ++++++--
 .../processor/internals/RecordCollector.java       | 37 ++++++---
 .../streams/processor/internals/RecordQueue.java   | 19 ++++-
 .../streams/processor/internals/StreamTask.java    | 13 +++
 .../streams/processor/internals/StreamThread.java  |  9 ---
 .../apache/kafka/streams/StreamsConfigTest.java    | 39 +++++++++
 .../processor/internals/AbstractTaskTest.java      | 92 ++++++++++++++++++++++
 .../processor/internals/ProcessorNodeTest.java     | 65 +++++++++++++++
 .../processor/internals/RecordCollectorTest.java   | 42 ++++++++++
 .../processor/internals/RecordQueueTest.java       | 21 +++++
 .../processor/internals/StreamTaskTest.java        | 89 +++++++++++++++++++++
 14 files changed, 469 insertions(+), 39 deletions(-)
d83cde7cabe4e86951c6760e68e65b99752cfe0e

 .../org/apache/kafka/streams/StreamsConfig.java    | 23 ++++--
 .../streams/processor/internals/AbstractTask.java  | 15 +++-
 .../streams/processor/internals/ProcessorNode.java | 13 ++-
 .../processor/internals/ProcessorStateManager.java | 31 ++++++--
 .../processor/internals/RecordCollector.java       | 37 ++++++---
 .../streams/processor/internals/RecordQueue.java   | 19 ++++-
 .../streams/processor/internals/StreamTask.java    | 13 +++
 .../streams/processor/internals/StreamThread.java  |  9 ---
 .../apache/kafka/streams/StreamsConfigTest.java    | 39 +++++++++
 .../processor/internals/AbstractTaskTest.java      | 92 ++++++++++++++++++++++
 .../processor/internals/ProcessorNodeTest.java     | 65 +++++++++++++++
 .../processor/internals/RecordCollectorTest.java   | 42 ++++++++++
 .../processor/internals/RecordQueueTest.java       | 21 +++++
 .../processor/internals/StreamTaskTest.java        | 89 +++++++++++++++++++++
 14 files changed, 469 insertions(+), 39 deletions(-)
8bbb0b216fe2573c1f9716bcdb1021daf784968a

 docs/streams.html | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
1fcf9fd6287db7de1abd9be9a73f1fa8a4ecd402

 .../streams/processor/internals/ProcessorStateManagerTest.java   | 9 +++++++++
 1 file changed, 9 insertions(+)
c526c0c3f6f153ef8f84a3e66d9f997d8c31e20c

 .../streams/processor/internals/ProcessorStateManagerTest.java   | 9 +++++++++
 1 file changed, 9 insertions(+)
aef1c13a32404a4534d72ba30c5d7652391c1488

 .../processor/internals/ProcessorStateManager.java |  8 ++++----
 .../processor/internals/RecordCollector.java       |  2 +-
 .../streams/processor/internals/StandbyTask.java   |  4 ++--
 .../processor/internals/StateDirectory.java        |  2 +-
 .../streams/processor/internals/StreamThread.java  | 22 ++++++++++------------
 5 files changed, 18 insertions(+), 20 deletions(-)
0c4cc5a4466d0dfce01903c29d97af3e428597f3

 .../processor/internals/ProcessorStateManager.java |  8 ++++----
 .../processor/internals/RecordCollector.java       |  2 +-
 .../streams/processor/internals/StandbyTask.java   |  4 ++--
 .../processor/internals/StateDirectory.java        |  2 +-
 .../streams/processor/internals/StreamThread.java  | 22 ++++++++++------------
 5 files changed, 18 insertions(+), 20 deletions(-)
65b85e6a490a1f121071da735e2abfce807c87d1

 .../kafka/streams/processor/internals/StreamsMetadataState.java      | 2 +-
 .../kafka/streams/processor/internals/StreamsMetadataStateTest.java  | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)
0c25c73782e6e70b8f37e3dda2fa2a5b0b1c8c65

 .../kafka/streams/processor/internals/StreamsMetadataState.java      | 2 +-
 .../kafka/streams/processor/internals/StreamsMetadataStateTest.java  | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)
dfdf2e6cc026caef0dd02b2d870ef7bf86508b22

 .../main/scala/kafka/admin/ConsumerGroupCommand.scala  |  4 ++--
 docs/ops.html                                          | 18 +++++++++++-------
 docs/security.html                                     |  2 +-
 docs/upgrade.html                                      |  3 +++
 4 files changed, 17 insertions(+), 10 deletions(-)
61d3378bc84914a521a65cdfffb7299928fa8671

 .../main/scala/kafka/admin/ConsumerGroupCommand.scala  |  4 ++--
 docs/ops.html                                          | 18 +++++++++++-------
 docs/security.html                                     |  2 +-
 docs/upgrade.html                                      |  3 +++
 4 files changed, 17 insertions(+), 10 deletions(-)
aadda5aaceadf40d8dbebcdd577962485854f0cb

 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 49 ++++++++++++++--------
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 16 +++++--
 tests/kafkatest/services/console_consumer.py       |  2 +-
 tests/kafkatest/services/mirror_maker.py           |  2 -
 .../services/performance/consumer_performance.py   |  1 -
 5 files changed, 44 insertions(+), 26 deletions(-)
3db752a565071c78e4b11eaafa739844fa785b04

 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 49 ++++++++++++++--------
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 16 +++++--
 tests/kafkatest/services/console_consumer.py       |  2 +-
 tests/kafkatest/services/mirror_maker.py           |  2 -
 .../services/performance/consumer_performance.py   |  1 -
 5 files changed, 44 insertions(+), 26 deletions(-)
bb3a86087ca6ac089bf10382e5cacd6f85437315

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  6 +-
 .../src/main/scala/kafka/admin/ConfigCommand.scala | 18 ++---
 .../kafka/admin/ReassignPartitionsCommand.scala    |  8 +-
 .../main/scala/kafka/server/ConfigHandler.scala    | 17 ++---
 .../main/scala/kafka/server/DynamicConfig.scala    | 86 ++++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaConfig.scala |  7 --
 .../integration/kafka/api/BaseQuotaTest.scala      | 10 +--
 .../integration/kafka/api/ClientIdQuotaTest.scala  |  6 +-
 .../kafka/api/UserClientIdQuotaTest.scala          |  6 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 26 +++----
 .../admin/ReassignPartitionsClusterTest.scala      |  6 +-
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   |  6 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |  5 +-
 .../unit/kafka/server/DynamicConfigTest.scala      | 58 +++++++++++++++
 .../unit/kafka/server/ReplicationQuotasTest.scala  | 26 +++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  6 ++
 16 files changed, 211 insertions(+), 86 deletions(-)
b8ed4a51134ca8b98d1445871a55ed33b6ad5b92

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  6 +-
 .../src/main/scala/kafka/admin/ConfigCommand.scala | 18 ++---
 .../kafka/admin/ReassignPartitionsCommand.scala    |  8 +-
 .../main/scala/kafka/server/ConfigHandler.scala    | 17 ++---
 .../main/scala/kafka/server/DynamicConfig.scala    | 86 ++++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaConfig.scala |  7 --
 .../integration/kafka/api/BaseQuotaTest.scala      | 10 +--
 .../integration/kafka/api/ClientIdQuotaTest.scala  |  6 +-
 .../kafka/api/UserClientIdQuotaTest.scala          |  6 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 26 +++----
 .../admin/ReassignPartitionsClusterTest.scala      |  6 +-
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   |  6 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |  5 +-
 .../unit/kafka/server/DynamicConfigTest.scala      | 58 +++++++++++++++
 .../unit/kafka/server/ReplicationQuotasTest.scala  | 26 +++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  6 ++
 16 files changed, 211 insertions(+), 86 deletions(-)
55631c976639c5c9295055553a6fe3bd06a66b21

 .../kafka/admin/ReassignPartitionsCommand.scala    |  71 ++++---
 .../main/scala/kafka/utils/CommandLineUtils.scala  |  18 +-
 .../admin/ReassignPartitionsCommandArgsTest.scala  | 232 +++++++++++++++++++++
 3 files changed, 292 insertions(+), 29 deletions(-)
5d6408f6cfda3f8ab366195f69e90de048cde25d

 .../kafka/admin/ReassignPartitionsCommand.scala    |  71 ++++---
 .../main/scala/kafka/utils/CommandLineUtils.scala  |  18 +-
 .../admin/ReassignPartitionsCommandArgsTest.scala  | 232 +++++++++++++++++++++
 3 files changed, 292 insertions(+), 29 deletions(-)
98a625028994e84bafd1cf7d96233dfdb9579555

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a208478f37f216324a87b530f18f30ecd79601c8

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6b8bcf65e87a1fcdc32137e3fc877d3296bae074

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 31 +++++++++++++----------
 1 file changed, 18 insertions(+), 13 deletions(-)
60ad6d727861a87fa756918a7be7547e9b1f4c3d

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 31 +++++++++++++----------
 1 file changed, 18 insertions(+), 13 deletions(-)
823c08067c189791d97ca4bd0548ffa308684dd7

 .../scala/kafka/controller/KafkaController.scala    | 21 +++++++--------------
 1 file changed, 7 insertions(+), 14 deletions(-)
be6056abc9970600347c95c4c8658799b76dbe6b

 .../scala/kafka/controller/KafkaController.scala    | 21 +++++++--------------
 1 file changed, 7 insertions(+), 14 deletions(-)
d6b3ff142a8ab19264b7af76bda7ddaa8c4bea1d

 .../kafka/connect/runtime/WorkerSinkTask.java      | 84 +++++++++++-----------
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 36 +++++-----
 2 files changed, 60 insertions(+), 60 deletions(-)
b75245cfbbefc712103b9329da0f27a205baa6aa

 .../kafka/connect/runtime/WorkerSinkTask.java      | 84 +++++++++++-----------
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 36 +++++-----
 2 files changed, 60 insertions(+), 60 deletions(-)
4104f014e92bbf6878e575a93a850ff3a569ccf0

 tests/kafkatest/services/kafka/config_property.py  |   2 -
 tests/kafkatest/services/kafka/kafka.py            |   3 +-
 .../services/kafka/templates/kafka.properties      |  16 ---
 tests/kafkatest/tests/client/quota_test.py         | 118 +++++++++++++++------
 4 files changed, 85 insertions(+), 54 deletions(-)
c0a62b70a8eadc550c937bb18e0203ab691618f5

 tests/kafkatest/services/kafka/config_property.py  |   2 -
 tests/kafkatest/services/kafka/kafka.py            |   3 +-
 .../services/kafka/templates/kafka.properties      |  16 ---
 tests/kafkatest/tests/client/quota_test.py         | 118 +++++++++++++++------
 4 files changed, 85 insertions(+), 54 deletions(-)
e4d8059d7eddb3399ef3888c70a2c939ff599cca

 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 34 +++++++++---------
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 41 +++++++++++++---------
 .../scala/kafka/tools/ConsumerPerformance.scala    | 17 +++++----
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 32 ++++++++++++-----
 4 files changed, 76 insertions(+), 48 deletions(-)
1d055f7551d138324d2540095a1cfc1c8f74d76f

 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 34 +++++++++---------
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 41 +++++++++++++---------
 .../scala/kafka/tools/ConsumerPerformance.scala    | 17 +++++----
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 32 ++++++++++++-----
 4 files changed, 76 insertions(+), 48 deletions(-)
97f41a5c1193146f9c064a7c2c6265ee340036a5

 docs/implementation.html | 11 ++++++++++-
 docs/upgrade.html        |  9 ++++++++-
 2 files changed, 18 insertions(+), 2 deletions(-)
36242b846a42b33d7d4c1931f2dae93ebe1547c7

 docs/implementation.html | 11 ++++++++++-
 docs/upgrade.html        |  9 ++++++++-
 2 files changed, 18 insertions(+), 2 deletions(-)
cd252352cf7aacaf3987c15a2edf3f3dd4751fac

 .../java/org/apache/kafka/clients/ClientUtils.java     | 18 ++++++++++--------
 .../main/java/org/apache/kafka/common/utils/Utils.java |  2 +-
 .../java/org/apache/kafka/common/utils/UtilsTest.java  |  1 +
 core/src/main/scala/kafka/cluster/BrokerEndPoint.scala |  2 +-
 core/src/main/scala/kafka/cluster/EndPoint.scala       |  2 +-
 .../scala/unit/kafka/cluster/BrokerEndPointTest.scala  | 11 +++++++++++
 6 files changed, 25 insertions(+), 11 deletions(-)
0de807357be4d776747e960b5fd17ddeae9a6cad

 .../java/org/apache/kafka/clients/ClientUtils.java     | 18 ++++++++++--------
 .../main/java/org/apache/kafka/common/utils/Utils.java |  2 +-
 .../java/org/apache/kafka/common/utils/UtilsTest.java  |  1 +
 core/src/main/scala/kafka/cluster/BrokerEndPoint.scala |  2 +-
 core/src/main/scala/kafka/cluster/EndPoint.scala       |  2 +-
 .../scala/unit/kafka/cluster/BrokerEndPointTest.scala  | 11 +++++++++++
 6 files changed, 25 insertions(+), 11 deletions(-)
a859cedf0b9d3b91dd411623d769961d245cc7af

 .../scala/kafka/coordinator/GroupCoordinator.scala | 24 +++---
 .../kafka/coordinator/GroupMetadataManager.scala   | 92 +++++++++++++---------
 .../coordinator/GroupMetadataManagerTest.scala     | 71 ++++++++++++++---
 3 files changed, 127 insertions(+), 60 deletions(-)
6a13a3dbaddf99850b2583007577fa2a6e1e6d3a

 .../scala/kafka/coordinator/GroupCoordinator.scala | 24 +++---
 .../kafka/coordinator/GroupMetadataManager.scala   | 92 +++++++++++++---------
 .../coordinator/GroupMetadataManagerTest.scala     | 71 ++++++++++++++---
 3 files changed, 127 insertions(+), 60 deletions(-)
106a7456060750ab0604d290b8c1e33a57adbf20

 .../kafka/api/PlaintextConsumerTest.scala          | 82 ++++++++++++++++++++--
 1 file changed, 75 insertions(+), 7 deletions(-)
dc5fc239eef887c18db130ade65779b5821c737a

 core/src/test/scala/unit/kafka/producer/SyncProducerTest.scala | 4 ++--
 core/src/test/scala/unit/kafka/zk/ZooKeeperTestHarness.scala   | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)
d32f3f2828c199a5a09bbba779d07430e43fb190

 core/src/test/scala/unit/kafka/producer/SyncProducerTest.scala | 4 ++--
 core/src/test/scala/unit/kafka/zk/ZooKeeperTestHarness.scala   | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)
5006afe81defaf6690fcdf05303465907ef40960

 .../test/java/org/apache/kafka/streams/smoketest/SmokeTestClient.java    | 1 +
 1 file changed, 1 insertion(+)
4112bc3af7bec63ae1248c1b9db745ba8ac4c63c

 .../test/java/org/apache/kafka/streams/smoketest/SmokeTestClient.java    | 1 +
 1 file changed, 1 insertion(+)
d1c8592b319f0ed1d8a3f70bee2b8b994c22e694

 .../kstream/internals/KStreamKStreamJoinTest.java  | 40 +++++++++++-----------
 1 file changed, 20 insertions(+), 20 deletions(-)
27e3edc791760dea7ff4d048f87d1585f9e235d7

 .../kstream/internals/KStreamKStreamJoinTest.java  | 40 +++++++++++-----------
 1 file changed, 20 insertions(+), 20 deletions(-)
c9f7fa29d1b0c165f13ff6e18442580b04cd8ec9

 .../consumer/internals/AbstractCoordinator.java    |  23 +-
 .../internals/AbstractCoordinatorTest.java         | 323 ++++++++++++++++++++-
 2 files changed, 330 insertions(+), 16 deletions(-)
732fabf94ebc9631d31f2feb2116ee8b63beabef

 .../consumer/internals/AbstractCoordinator.java    |  23 +-
 .../internals/AbstractCoordinatorTest.java         | 323 ++++++++++++++++++++-
 2 files changed, 330 insertions(+), 16 deletions(-)
be20ea52892c91f59323e0be1108f689e5a44f95

 .../processor/internals/InternalTopicManager.java       | 17 -----------------
 1 file changed, 17 deletions(-)
a632716a3c9a871f325c6f13aefa9aed0add4b82

 .../processor/internals/InternalTopicManager.java       | 17 -----------------
 1 file changed, 17 deletions(-)
5b29bb8b039c96634d82352c7e17922c83dad48f

 streams/src/main/java/org/apache/kafka/streams/state/Stores.java | 4 ++++
 1 file changed, 4 insertions(+)
24f81ea764a493b4422b6a3ef6b3e771d0e4d63b

 streams/src/main/java/org/apache/kafka/streams/state/Stores.java | 4 ++++
 1 file changed, 4 insertions(+)
29e30a79e5ba4f137d77943976b1e8e77f6ccaac

 tests/kafkatest/tests/core/reassign_partitions_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4f821830bc6b726cddf90999fff76006745b1a3f

 tests/kafkatest/tests/core/reassign_partitions_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d48415f185d1882f0a3b89a3ce03ea84893393ba

 .../kafka/server/ReplicationQuotaManagerTest.scala |  3 +-
 .../unit/kafka/server/ReplicationQuotasTest.scala  | 93 +++++++++++-----------
 2 files changed, 49 insertions(+), 47 deletions(-)
3663275cf066b7715cc11b26fd9c144bbff1c373

 .../kafka/server/ReplicationQuotaManagerTest.scala |  3 +-
 .../unit/kafka/server/ReplicationQuotasTest.scala  | 93 +++++++++++-----------
 2 files changed, 49 insertions(+), 47 deletions(-)
fc5f48aad4952df88147675a663ad034ce15d13d

 .../kafka/streams/integration/QueryableStateIntegrationTest.java      | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
c195003cb6e05f2d8c49285ff7e77b1cb3aa4361

 .../kafka/streams/integration/QueryableStateIntegrationTest.java      | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
f66e88a30b2aabd02bc0ef35fa27f8bd9b35466f

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f396fdac197409fb955f00a6f642f04e4926ba41

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6acbf27aebbe5b6b4f230ce44ea5151c4c53ffbd

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
eaaa433fc97b86450833d8fcc8c9289ea35d47c0

 .../apache/kafka/clients/consumer/Consumer.java    |  16 ++
 .../kafka/clients/consumer/KafkaConsumer.java      |  54 +++++++
 .../kafka/clients/consumer/MockConsumer.java       |  30 ++++
 .../kafka/clients/consumer/internals/Fetcher.java  | 179 ++++++++++++++-------
 .../org/apache/kafka/common/protocol/Protocol.java |  40 ++++-
 .../kafka/common/record/OffsetAndTimestamp.java    |  58 +++++++
 .../kafka/common/requests/ListOffsetRequest.java   | 109 ++++++++++---
 .../kafka/common/requests/ListOffsetResponse.java  |  65 +++++++-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   4 +-
 .../internals/AbstractCoordinatorTest.java         |  10 +-
 .../clients/consumer/internals/FetcherTest.java    |  31 ++--
 .../kafka/common/requests/RequestResponseTest.java |  43 +++--
 core/src/main/scala/kafka/api/ApiVersion.scala     |  11 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |  33 ++--
 core/src/main/scala/kafka/log/Log.scala            |  83 ++++------
 core/src/main/scala/kafka/log/LogSegment.scala     |  22 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 130 ++++++++++++---
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  31 ++--
 .../kafka/api/PlaintextConsumerTest.scala          |  84 +++++++++-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  21 +--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   8 +-
 docs/upgrade.html                                  |  26 ++-
 22 files changed, 837 insertions(+), 251 deletions(-)
cf8f4a713b64f010c15a4a7b8dae616edb8a1b74

 .../apache/kafka/streams/kstream/JoinWindows.java  |   2 +-
 .../streams/kstream/internals/KStreamImpl.java     |   2 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  | 217 +++++++++++++++++++++
 3 files changed, 219 insertions(+), 2 deletions(-)
4e1c7d844f743e5b439447e645fa41d2f92b8b5f

 .../kafka/clients/consumer/KafkaConsumer.java      |  6 ++++
 .../consumer/internals/SubscriptionState.java      |  4 +++
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 32 ++++++++++++++++++++++
 3 files changed, 42 insertions(+)
3281b3c9043edec0b1f8cadfb137851a60d509ef

 docs/api.html           | 50 +++++++++++++++++++++++++------------------------
 docs/documentation.html |  6 +++---
 docs/upgrade.html       |  2 ++
 3 files changed, 31 insertions(+), 27 deletions(-)
64acd90859af0c3ec0a1b7a042a95e53fe2ea6df

 .../java/org/apache/kafka/connect/data/ConnectSchema.java     | 10 ++++++----
 .../java/org/apache/kafka/connect/data/SchemaBuilder.java     |  5 +++--
 .../java/org/apache/kafka/connect/data/ConnectSchemaTest.java |  7 +++++++
 .../java/org/apache/kafka/connect/data/SchemaBuilderTest.java | 11 ++++++++++-
 4 files changed, 26 insertions(+), 7 deletions(-)
d37b036090ce296809774bfaa1739aab39c6eeb3

 .../apache/kafka/connect/json/JsonConverter.java   | 41 +++--------
 .../kafka/connect/json/JsonConverterTest.java      | 79 +++++++++++++++++++++-
 2 files changed, 88 insertions(+), 32 deletions(-)
fbcff9b50788497ca548fdfb44c7dc1eb53af1ee

 .../apache/kafka/connect/data/SchemaProjector.java  | 12 +++++-------
 .../kafka/connect/data/SchemaProjectorTest.java     | 21 +++++++++++++++++++++
 2 files changed, 26 insertions(+), 7 deletions(-)
1e5bf02ab338ba05342709666e47d76bdb5670b0

 .../apache/kafka/connect/json/JsonConverter.java   |  4 +++
 .../kafka/connect/json/JsonConverterTest.java      | 38 ++++++++++++++++++++++
 2 files changed, 42 insertions(+)
57ee6ffc897a26fea381a13b6e2b00d024c49ee8

 core/src/main/scala/kafka/server/KafkaServerStartable.scala | 2 ++
 1 file changed, 2 insertions(+)
431c3b0937da103b6e79e9f970c0862898205909

 .../apache/kafka/connect/json/JsonConverter.java   | 41 +++--------
 .../kafka/connect/json/JsonConverterTest.java      | 79 +++++++++++++++++++++-
 2 files changed, 88 insertions(+), 32 deletions(-)
896ad63f14c5240207daeedea304c62c8fc7bb7e

 .../processor/internals/ProcessorStateManager.java        | 15 ++++++++++-----
 1 file changed, 10 insertions(+), 5 deletions(-)
f27a6f319ac058288a8cd3d7f95247cf45fea817

 docs/design.html | 39 +++++++++++++++++++------
 docs/ops.html    | 87 +++++++++++++++++++++++++++++++++++++++++++++++---------
 2 files changed, 105 insertions(+), 21 deletions(-)
3d74196f205c53946b6fc3dd0501aa2095f0031a

 .../org/apache/kafka/streams/KafkaStreams.java     |  8 +++-
 .../processor/internals/StreamsMetadataState.java  | 23 ++++++++-
 .../kafka/streams/state/StreamsMetadata.java       |  9 ++++
 .../internals/CompositeReadOnlyKeyValueStore.java  | 24 ++++++++--
 .../internals/CompositeReadOnlyWindowStore.java    | 15 ++++--
 .../state/internals/QueryableStoreProvider.java    |  2 +-
 .../internals/StreamThreadStateStoreProvider.java  |  4 +-
 .../state/internals/WrappingStoreProvider.java     |  3 +-
 .../integration/QueryableStateIntegrationTest.java | 45 +++++++++---------
 .../internals/StreamsMetadataStateTest.java        |  7 +++
 .../CompositeReadOnlyKeyValueStoreTest.java        | 21 +++++----
 .../CompositeReadOnlyWindowStoreTest.java          | 19 +++++++-
 .../internals/QueryableStoreProviderTest.java      |  3 +-
 .../state/internals/ReadOnlyWindowStoreStub.java   | 11 ++++-
 .../state/internals/StateStoreProviderStub.java    | 43 -----------------
 .../state/internals/WrappingStoreProviderTest.java |  5 +-
 .../apache/kafka/test/StateStoreProviderStub.java  | 54 ++++++++++++++++++++++
 17 files changed, 194 insertions(+), 102 deletions(-)
70afd5f9dd2eddc784a24fa2518992ef3371f0a4

 .../kafka/streams/processor/internals/StreamPartitionAssignor.java   | 3 ++-
 .../streams/processor/internals/StreamPartitionAssignorTest.java     | 5 ++++-
 .../java/org/apache/kafka/streams/smoketest/SmokeTestClient.java     | 2 +-
 3 files changed, 7 insertions(+), 3 deletions(-)
8c07e0f31d6a7b6bfa119bc557da6781324758bf

 .../kafka/streams/integration/QueryableStateIntegrationTest.java      | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d9206500bf2f99ce93f6ad64c7a89483100b3b5f

 core/src/main/scala/kafka/log/LogSegment.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d04b0998c043a6a430921585ffd4c42572a3bf5a

 .../kafka/clients/consumer/ConsumerConfig.java     |  23 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   1 +
 .../kafka/clients/consumer/internals/Fetcher.java  |  42 ++--
 .../consumer/internals/SubscriptionState.java      |  82 ++++----
 .../kafka/common/internals/PartitionStates.java    | 174 +++++++++++++++
 .../org/apache/kafka/common/protocol/Protocol.java |  25 ++-
 .../apache/kafka/common/requests/FetchRequest.java |  96 +++++++--
 .../kafka/common/requests/FetchResponse.java       |  91 ++++----
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   2 +
 .../clients/consumer/internals/FetcherTest.java    |  23 +-
 .../common/internals/PartitionStatesTest.java      | 219 +++++++++++++++++++
 .../kafka/common/requests/RequestResponseTest.java |  26 ++-
 .../src/main/scala/kafka/admin/ConfigCommand.scala |  18 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |  48 -----
 core/src/main/scala/kafka/api/ApiVersion.scala     |  11 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |  86 ++++++--
 core/src/main/scala/kafka/api/FetchResponse.scala  |  41 ++--
 .../main/scala/kafka/consumer/ConsumerConfig.scala |   6 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |  24 +--
 .../kafka/consumer/ConsumerFetcherThread.scala     |  33 +--
 .../kafka/coordinator/GroupMetadataManager.scala   |   2 +-
 .../main/scala/kafka/javaapi/FetchRequest.scala    |  48 +++--
 core/src/main/scala/kafka/log/FileMessageSet.scala |  12 +-
 core/src/main/scala/kafka/log/Log.scala            |   5 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  46 ++--
 .../kafka/server/AbstractFetcherManager.scala      |  13 +-
 .../scala/kafka/server/AbstractFetcherThread.scala | 118 ++++++-----
 .../src/main/scala/kafka/server/DelayedFetch.scala |  22 +-
 .../main/scala/kafka/server/FetchDataInfo.scala    |   3 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  31 +--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  16 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  93 ++++----
 .../main/scala/kafka/server/ReplicaManager.scala   | 199 ++++++++++--------
 .../kafka/api/AuthorizerIntegrationTest.scala      |   5 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  30 +--
 .../kafka/api/PlaintextConsumerTest.scala          | 133 ++++++++++--
 .../kafka/api/ProducerFailureHandlingTest.scala    |  94 +++++----
 .../api/RequestResponseSerializationTest.scala     |   8 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   6 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |  38 ++--
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |   2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  58 +++++
 .../kafka/server/AbstractFetcherThreadTest.scala   |  26 ++-
 .../scala/unit/kafka/server/FetchRequestTest.scala | 233 +++++++++++++++++++++
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   1 +
 .../kafka/server/ReplicaManagerQuotasTest.scala    |  30 +--
 .../unit/kafka/server/ReplicaManagerTest.scala     |  26 ++-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  25 +--
 48 files changed, 1716 insertions(+), 678 deletions(-)
6fb25f080fc07948ce2ea620b15b934d91b67d16

 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ee6e50024d8a09960b2b72628c62c6532c09d84d

 tests/kafkatest/services/replica_verification_tool.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
b5bc1a1caaa8a4ad3b10bfdfa9c2250ef8e09b1d

 tests/kafkatest/services/replica_verification_tool.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
ea8c1b394205342e988e4afd318c6b8338d04887

 docs/quickstart.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
b8683026ea7ebfddcec41274b12e8a579dc4ca71

 docs/quickstart.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
932e4d7ba781b9ea920d34b49810381afe5069b4

 tests/kafkatest/services/streams.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
69356fbc6e76ab4291ff4957f0d6ea04e7245909

 .../apache/kafka/common/metrics/KafkaMetric.java   |   2 +-
 .../org/apache/kafka/common/metrics/Quota.java     |   5 +
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  72 +++--
 .../src/main/scala/kafka/admin/ConfigCommand.scala | 192 ++++++++++--
 .../main/scala/kafka/network/RequestChannel.scala  |   5 +-
 .../scala/kafka/server/ClientQuotaManager.scala    | 332 +++++++++++++++++----
 .../main/scala/kafka/server/ConfigHandler.scala    |  66 ++--
 .../scala/kafka/server/DynamicConfigManager.scala  |  94 ++++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |   3 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   6 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   7 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   3 +
 .../integration/kafka/api/BaseQuotaTest.scala      | 195 ++++++++++++
 .../integration/kafka/api/ClientIdQuotaTest.scala  |  55 ++++
 .../integration/kafka/api/ClientQuotasTest.scala   | 206 -------------
 .../kafka/api/UserClientIdQuotaTest.scala          |  66 ++++
 .../integration/kafka/api/UserQuotaTest.scala      |  61 ++++
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   4 +-
 .../scala/unit/kafka/admin/ConfigCommandTest.scala | 186 +++++++++++-
 .../scala/unit/kafka/admin/TestAdminUtils.scala    |   1 +
 .../unit/kafka/server/ClientQuotaManagerTest.scala | 217 ++++++++++++--
 .../kafka/server/DynamicConfigChangeTest.scala     |  77 +++--
 22 files changed, 1449 insertions(+), 406 deletions(-)
ecc1fb10fad39c2da82731a36552cb5dd9ac2858

 checkstyle/import-control.xml                      |   1 +
 .../java/org/apache/kafka/clients/Metadata.java    |  32 ++-
 .../clients/consumer/ConsumerInterceptor.java      |   2 +
 .../kafka/clients/consumer/KafkaConsumer.java      |  59 +++---
 .../kafka/clients/producer/KafkaProducer.java      |  62 +++---
 .../clients/producer/ProducerInterceptor.java      |   2 +
 .../main/java/org/apache/kafka/common/Cluster.java |  32 +--
 .../org/apache/kafka/common/ClusterResource.java   |  50 +++++
 .../kafka/common/ClusterResourceListener.java      |  50 +++++
 .../common/internals/ClusterResourceListeners.java |  63 ++++++
 .../kafka/common/metrics/MetricsReporter.java      |   2 +
 .../org/apache/kafka/common/protocol/Protocol.java |  16 +-
 .../kafka/common/requests/MetadataRequest.java     |   3 +-
 .../kafka/common/requests/MetadataResponse.java    |  32 ++-
 .../kafka/common/serialization/Deserializer.java   |   2 +
 .../kafka/common/serialization/Serializer.java     |   2 +
 .../org/apache/kafka/clients/MetadataTest.java     |  44 +++-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   3 +
 .../clients/consumer/internals/FetcherTest.java    |   2 +-
 .../kafka/clients/producer/KafkaProducerTest.java  |   6 +-
 .../kafka/clients/producer/MockProducerTest.java   |  17 +-
 .../producer/internals/DefaultPartitionerTest.java |   4 +-
 .../producer/internals/RecordAccumulatorTest.java  |   3 +-
 .../clients/producer/internals/SenderTest.java     |   3 +-
 .../kafka/common/requests/RequestResponseTest.java |  12 +-
 .../kafka/test/MockClusterResourceListener.java    |  39 ++++
 .../apache/kafka/test/MockConsumerInterceptor.java |  23 ++-
 .../org/apache/kafka/test/MockDeserializer.java    |  59 ++++++
 .../org/apache/kafka/test/MockMetricsReporter.java |   4 +-
 .../apache/kafka/test/MockProducerInterceptor.java |  22 +-
 .../java/org/apache/kafka/test/MockSerializer.java |  16 +-
 .../test/java/org/apache/kafka/test/TestUtils.java |  41 +++-
 .../scala/kafka/metrics/KafkaMetricsReporter.scala |  12 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  58 ++++--
 .../scala/kafka/server/KafkaServerStartable.scala  |   8 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  25 ++-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  30 +++
 .../kafka/api/EndToEndClusterIdTest.scala          | 225 +++++++++++++++++++++
 .../kafka/api/PlaintextConsumerTest.scala          |   3 +
 .../scala/unit/kafka/metrics/MetricsTest.scala     |  11 +-
 .../server/KafkaMetricReporterClusterIdTest.scala  |  93 +++++++++
 .../unit/kafka/server/MetadataRequestTest.scala    |  17 +-
 .../kafka/server/ServerGenerateClusterIdTest.scala | 140 +++++++++++++
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  28 ++-
 .../test/scala/unit/kafka/utils/ZkUtilsTest.scala  |   6 +
 .../internals/WindowedStreamPartitionerTest.java   |   4 +-
 .../processor/DefaultPartitionGrouperTest.java     |   2 +-
 .../processor/internals/RecordCollectorTest.java   |   2 +-
 .../internals/StreamPartitionAssignorTest.java     |   2 +-
 .../processor/internals/StreamThreadTest.java      |   2 +-
 tests/kafkatest/tests/core/upgrade_test.py         |  21 +-
 tests/kafkatest/version.py                         |   6 +-
 vagrant/base.sh                                    |   3 +
 54 files changed, 1265 insertions(+), 145 deletions(-)
d7bffebca05aa91a69da03fe29add4f29b964fd9

 .../apache/kafka/connect/data/SchemaProjector.java  | 12 +++++-------
 .../kafka/connect/data/SchemaProjectorTest.java     | 21 +++++++++++++++++++++
 2 files changed, 26 insertions(+), 7 deletions(-)
567cc3d78746391a3b050d4eea76571e4bf20e89

 .../apache/kafka/connect/json/JsonConverter.java   |  4 +++
 .../kafka/connect/json/JsonConverterTest.java      | 38 ++++++++++++++++++++++
 2 files changed, 42 insertions(+)
86aa0eb0f274c6e44eb190ce250433419e011a67

 .../org/apache/kafka/streams/StreamsConfig.java    |  11 +-
 .../apache/kafka/streams/kstream/JoinWindows.java  |   5 +
 .../apache/kafka/streams/kstream/TimeWindows.java  |   5 +
 .../kafka/streams/kstream/UnlimitedWindows.java    |   5 +
 .../org/apache/kafka/streams/kstream/Windows.java  |   1 +
 .../kstream/internals/CacheFlushListener.java      |  35 ++
 .../internals/ForwardingCacheFlushListener.java    |  38 ++
 .../kstream/internals/KGroupedStreamImpl.java      |  12 +-
 .../kstream/internals/KGroupedTableImpl.java       |   1 +
 .../kstream/internals/KStreamAggregate.java        |  10 +-
 .../streams/kstream/internals/KStreamImpl.java     |   2 +-
 .../kstream/internals/KStreamMapValues.java        |   2 +-
 .../streams/kstream/internals/KStreamReduce.java   |   7 +-
 .../kstream/internals/KStreamWindowAggregate.java  |  17 +-
 .../kstream/internals/KStreamWindowReduce.java     |  12 +-
 .../streams/kstream/internals/KTableAggregate.java |  13 +-
 .../streams/kstream/internals/KTableImpl.java      |   3 +-
 .../streams/kstream/internals/KTableReduce.java    |  11 +-
 .../streams/kstream/internals/KTableSource.java    |   5 +-
 .../apache/kafka/streams/processor/Processor.java  |   2 +-
 .../kafka/streams/processor/ProcessorContext.java  |   1 +
 .../kafka/streams/processor/TopologyBuilder.java   |  14 +-
 .../streams/processor/internals/AbstractTask.java  |  19 +-
 .../internals/InternalProcessorContext.java        |  49 +++
 .../processor/internals/ProcessorContextImpl.java  | 113 ++++--
 .../streams/processor/internals/ProcessorNode.java |   9 +-
 .../internals/ProcessorRecordContext.java          |  72 ++++
 .../processor/internals/ProcessorStateManager.java |  17 +-
 .../processor/internals/ProcessorTopology.java     |  22 +-
 .../streams/processor/internals/RecordContext.java |  45 +++
 .../streams/processor/internals/SinkNode.java      |   4 +-
 .../streams/processor/internals/SourceNode.java    |   3 +-
 .../processor/internals/StandbyContextImpl.java    |  27 +-
 .../streams/processor/internals/StandbyTask.java   |   4 +-
 .../streams/processor/internals/StreamTask.java    |  88 ++---
 .../streams/processor/internals/StreamThread.java  |  64 ++-
 .../org/apache/kafka/streams/state/Stores.java     |  22 +-
 .../state/internals/AbstractStoreSupplier.java     |   1 +
 .../streams/state/internals/CachedStateStore.java  |  28 ++
 .../state/internals/CachingKeyValueStore.java      | 219 +++++++++++
 .../state/internals/CachingWindowStore.java        | 170 ++++++++
 .../DelegatingPeekingKeyValueIterator.java         |  73 ++++
 .../internals/DelegatingPeekingWindowIterator.java |  73 ++++
 .../streams/state/internals/LRUCacheEntry.java     |  92 +++++
 .../MergedSortedCacheKeyValueStoreIterator.java    | 109 ++++++
 .../MergedSortedCachedWindowStoreIterator.java     | 105 +++++
 .../kafka/streams/state/internals/NamedCache.java  | 298 ++++++++++++++
 .../state/internals/PeekingKeyValueIterator.java   |  24 ++
 .../state/internals/PeekingWindowIterator.java     |  25 ++
 .../internals/RocksDBKeyValueStoreSupplier.java    |  28 +-
 .../streams/state/internals/RocksDBStore.java      | 201 ++--------
 .../state/internals/RocksDBWindowStore.java        |  48 +--
 .../internals/RocksDBWindowStoreSupplier.java      |  25 +-
 .../kafka/streams/state/internals/ThreadCache.java | 311 +++++++++++++++
 .../state/internals/ThreadCacheMetrics.java        |  40 ++
 .../streams/state/internals/WindowStoreUtils.java  |   8 +
 .../streams/integration/FanoutIntegrationTest.java |  16 +
 .../KStreamAggregationDedupIntegrationTest.java    | 264 +++++++++++++
 .../KStreamAggregationIntegrationTest.java         |  19 +-
 .../KStreamKTableJoinIntegrationTest.java          | 102 +++--
 .../integration/KStreamRepartitionJoinTest.java    |  51 ++-
 .../integration/QueryableStateIntegrationTest.java | 127 +++---
 .../kstream/internals/KGroupedTableImplTest.java   |  46 +++
 .../kstream/internals/KStreamKStreamJoinTest.java  |  58 +--
 .../internals/KStreamKStreamLeftJoinTest.java      |  68 ++--
 .../internals/KStreamWindowAggregateTest.java      | 119 ++++--
 .../kstream/internals/KTableAggregateTest.java     |  98 ++++-
 .../kstream/internals/KTableFilterTest.java        |  18 +-
 .../kstream/internals/KTableForeachTest.java       |   1 +
 .../streams/kstream/internals/KTableImplTest.java  |  10 +
 .../kstream/internals/KTableKTableJoinTest.java    |  32 +-
 .../internals/KTableKTableLeftJoinTest.java        |  41 +-
 .../internals/KTableKTableOuterJoinTest.java       |  51 ++-
 .../kstream/internals/KTableMapKeysTest.java       |   2 +-
 .../kstream/internals/KTableMapValuesTest.java     |  17 +-
 .../kstream/internals/KTableSourceTest.java        |  13 +-
 .../apache/kafka/streams/perf/SimpleBenchmark.java |   9 +-
 .../streams/processor/TopologyBuilderTest.java     |   6 +-
 .../internals/ProcessorStateManagerTest.java       |  13 +-
 .../processor/internals/ProcessorTopologyTest.java |   2 +
 .../processor/internals/PunctuationQueueTest.java  |   4 +-
 .../processor/internals/RecordContextStub.java     |  55 +++
 .../processor/internals/StandbyTaskTest.java       |  20 +-
 .../processor/internals/StreamTaskTest.java        |  14 +-
 .../processor/internals/StreamThreadTest.java      |   2 +-
 .../kafka/streams/smoketest/SmokeTestUtil.java     |   3 +-
 .../streams/state/KeyValueStoreTestDriver.java     |   9 +-
 .../state/internals/AbstractKeyValueStoreTest.java |   1 -
 .../state/internals/CachingKeyValueStoreTest.java  | 151 +++++++
 .../state/internals/CachingWindowStoreTest.java    | 166 ++++++++
 .../DelegatingPeekingKeyValueIteratorTest.java     |  78 ++++
 .../DelegatingPeekingWindowIteratorTest.java       |  92 +++++
 ...MergedSortedCacheKeyValueStoreIteratorTest.java |  57 +++
 .../MergedSortedCacheWindowStoreIteratorTest.java  |  97 +++++
 .../streams/state/internals/NamedCacheTest.java    | 189 +++++++++
 .../state/internals/RocksDBKeyValueStoreTest.java  |  56 ++-
 .../state/internals/RocksDBWindowStoreTest.java    | 259 ++++++------
 .../state/internals/StateStoreTestUtils.java       |   1 +
 .../StreamThreadStateStoreProviderTest.java        |   4 +-
 .../streams/state/internals/ThreadCacheTest.java   | 434 +++++++++++++++++++++
 .../org/apache/kafka/test/KStreamTestDriver.java   |  51 ++-
 .../apache/kafka/test/MockProcessorContext.java    |  66 +++-
 .../apache/kafka/test/MockProcessorSupplier.java   |   5 +-
 .../java/org/apache/kafka/test/MockReducer.java    |  21 +
 .../kafka/test/ProcessorTopologyTestDriver.java    |   6 +-
 105 files changed, 4784 insertions(+), 888 deletions(-)
143a33bc506c703ea02fe5daa61f90b7094da13c

 .../common/metrics/QuotaViolationException.java    |  27 ++-
 .../org/apache/kafka/common/metrics/Sensor.java    |  12 +-
 .../apache/kafka/common/metrics/stats/Rate.java    |   4 +-
 .../kafka/common/metrics/stats/SimpleRate.java     |  39 ++++
 .../apache/kafka/common/metrics/MetricsTest.java   |  59 +++++
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  26 ++-
 .../src/main/scala/kafka/admin/ConfigCommand.scala |  67 +++---
 .../kafka/admin/ReassignPartitionsCommand.scala    | 142 ++++++++++--
 .../kafka/consumer/ConsumerFetcherThread.scala     |   4 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |  16 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   1 -
 .../scala/kafka/server/ClientQuotaManager.scala    | 101 +++------
 .../main/scala/kafka/server/ConfigHandler.scala    |  98 +++++++--
 .../src/main/scala/kafka/server/DelayedFetch.scala |  18 +-
 .../scala/kafka/server/DynamicConfigManager.scala  |   6 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  62 ++----
 core/src/main/scala/kafka/server/KafkaConfig.scala |  25 ++-
 core/src/main/scala/kafka/server/KafkaServer.scala |  14 +-
 .../src/main/scala/kafka/server/QuotaFactory.scala |  74 +++++++
 .../scala/kafka/server/ReplicaFetcherManager.scala |  10 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  22 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  27 ++-
 .../kafka/server/ReplicationQuotaManager.scala     | 202 +++++++++++++++++
 .../src/main/scala/kafka/server/SensorAccess.scala |  76 +++++++
 core/src/main/scala/kafka/utils/CoreUtils.scala    |   1 +
 core/src/main/scala/kafka/utils/Time.scala         |   2 +-
 .../integration/kafka/api/ClientQuotasTest.scala   | 206 ++++++++++++++++++
 .../scala/integration/kafka/api/QuotasTest.scala   | 207 ------------------
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 102 +++++++--
 .../scala/unit/kafka/admin/ConfigCommandTest.scala | 188 ++++++++++++++--
 .../admin/ReassignPartitionsClusterTest.scala      | 152 ++++++++++++-
 .../admin/ReassignPartitionsCommandTest.scala      |  88 ++++++++
 .../unit/kafka/admin/ReplicationQuotaUtils.scala   |  51 +++++
 .../scala/unit/kafka/admin/TestAdminUtils.scala    |  27 +++
 .../scala/unit/kafka/integration/FetcherTest.scala |   1 -
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  31 ++-
 .../kafka/server/AbstractFetcherThreadTest.scala   |   1 +
 .../unit/kafka/server/ClientQuotaManagerTest.scala |  22 +-
 .../kafka/server/DynamicConfigChangeTest.scala     | 103 ++++++---
 .../server/HighwatermarkPersistenceTest.scala      |   9 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   2 +-
 .../kafka/server/ReplicaManagerQuotasTest.scala    | 154 +++++++++++++
 .../unit/kafka/server/ReplicaManagerTest.scala     |  10 +-
 .../kafka/server/ReplicationQuotaManagerTest.scala | 123 +++++++++++
 .../unit/kafka/server/ReplicationQuotasTest.scala  | 242 +++++++++++++++++++++
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  24 +-
 .../server/ThrottledResponseExpirationTest.scala   |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  14 +-
 48 files changed, 2324 insertions(+), 570 deletions(-)
d4366610241321a58d62c0b919d60ccfe3c3d698

 .../internals/StreamPartitionAssignor.java         | 15 +++--
 .../integration/RegexSourceIntegrationTest.java    | 76 ++++++++++++++++++++++
 2 files changed, 85 insertions(+), 6 deletions(-)
f3bb10413d11525a396851eb7e6b9d75b8c6fe23

 .../test/java/org/apache/kafka/streams/smoketest/SmokeTestClient.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3262ae29ae57966850b8dc064111ba30714b2f08

 .../java/org/apache/kafka/streams/kstream/internals/KStreamImpl.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f197ad4997032a848540a7d577b5846f76a26bfb

 .../consumer/internals/AbstractCoordinator.java    | 100 ++++++++++++---------
 .../internals/ConsumerCoordinatorTest.java         |  28 +++---
 .../kafkatest/tests/streams/streams_smoke_test.py  |   1 -
 3 files changed, 73 insertions(+), 56 deletions(-)
084a19e9acb43666cfcaa2ca155a775d47cd8b39

 .../kafka/clients/consumer/internals/Fetcher.java  | 15 ++++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 62 +++++++++++++++++-----
 2 files changed, 65 insertions(+), 12 deletions(-)
068f93511a93917c3894feecfd0810248461985a

 README.md                                                               | 2 +-
 .../org/apache/kafka/connect/runtime/distributed/DistributedHerder.java | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
c1bce2d757c5a93bebc1abaf1304bf84375a4cc9

 README.md                                                               | 2 +-
 .../org/apache/kafka/connect/runtime/distributed/DistributedHerder.java | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
f2cd17010267b0e219d339d4bbc1157f5290cdfe

 .../apache/kafka/clients/consumer/internals/AbstractCoordinator.java  | 4 ++++
 1 file changed, 4 insertions(+)
41e676d29587042994a72baa5000a8861a075c8c

 .../main/scala/kafka/server/ClientQuotaManager.scala  |  8 ++++++++
 core/src/main/scala/kafka/server/ConfigHandler.scala  |  4 ++++
 .../unit/kafka/server/DynamicConfigChangeTest.scala   | 19 +++++++++++++++++--
 3 files changed, 29 insertions(+), 2 deletions(-)
2a660f13d2a805f0e27351996e904b1ea2365eba

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
a7ab9cb83d2c47d980b0b9f6b702e01bd1cf4139

 .../kafka/streams/integration/QueryableStateIntegrationTest.java   | 7 +++++++
 1 file changed, 7 insertions(+)
5f040cd77f4b8fbe12b3e3389fab1fc2565dda82

 core/src/main/scala/kafka/log/LogCleaner.scala     |  32 ++--
 .../main/scala/kafka/log/LogCleanerManager.scala   | 130 +++++++++-----
 core/src/main/scala/kafka/log/LogConfig.scala      |   7 +
 core/src/main/scala/kafka/server/KafkaConfig.scala |   5 +
 core/src/main/scala/kafka/server/KafkaServer.scala |   1 +
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 117 ++++++++++---
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   6 +-
 .../kafka/log/LogCleanerLagIntegrationTest.scala   | 188 +++++++++++++++++++++
 .../unit/kafka/log/LogCleanerManagerTest.scala     | 115 +++++++++++--
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   1 +
 docs/design.html                                   |  13 +-
 11 files changed, 520 insertions(+), 95 deletions(-)
1933f12a5368f1f60816d986a2777fa324754f80

 .../consumer/internals/AbstractCoordinator.java    | 10 ++++++--
 .../internals/ConsumerCoordinatorTest.java         | 29 +++++++++++-----------
 2 files changed, 23 insertions(+), 16 deletions(-)
ac99a3c86d5d8a56b61b1e0d1b2594e627016718

 .../kafka/api/BaseProducerSendTest.scala           | 73 +--------------------
 .../kafka/api/PlaintextProducerSendTest.scala      | 74 +++++++++++++++++++++-
 2 files changed, 76 insertions(+), 71 deletions(-)
4af50bb8600c37ee2e3597fba9a54a29cef94afa

 .../kafka/clients/consumer/KafkaConsumer.java      |  24 ++-
 .../consumer/internals/ConsumerNetworkClient.java  |  51 ++++--
 .../kafka/clients/consumer/internals/Fetcher.java  |  24 +++
 .../clients/consumer/internals/RequestFuture.java  |  93 +++++++----
 .../internals/ConsumerNetworkClientTest.java       |  42 +++++
 .../clients/consumer/internals/FetcherTest.java    |  30 +++-
 .../consumer/internals/RequestFutureTest.java      | 184 ++++++++++++++++++++-
 7 files changed, 395 insertions(+), 53 deletions(-)
3759d7f764a94f27ba2d5f7f4eca58730a84b1b1

 tests/kafkatest/tests/streams/streams_smoke_test.py | 1 +
 1 file changed, 1 insertion(+)
54767bbba5bf18c01f50bb40c339433bfed09627

 .../kafka/clients/consumer/KafkaConsumer.java      |  13 +-
 .../consumer/internals/ConsumerCoordinator.java    |  36 +-
 .../consumer/internals/SubscriptionState.java      |   9 -
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 653 +++++++++++++++------
 .../consumer/internals/SubscriptionStateTest.java  |  63 +-
 5 files changed, 568 insertions(+), 206 deletions(-)
eb59c8124e41fce176bfa6087d5aa4dce18f3642

 .../integration/QueryableStateIntegrationTest.java     | 18 +++++-------------
 1 file changed, 5 insertions(+), 13 deletions(-)
6cf2cb6f294d0d4766f57e9da660fb4efac7d258

 .../consumer/internals/AbstractCoordinator.java    | 31 +++++++++++-----------
 .../internals/AbstractCoordinatorTest.java         | 17 ++++++++++++
 2 files changed, 32 insertions(+), 16 deletions(-)
69ebf6f7be2fc0e471ebd5b7a166468017ff2651

 .../org/apache/kafka/streams/StreamsConfig.java    |  12 +-
 .../streams/kstream/internals/KTableImpl.java      |  11 +-
 .../kstream/internals/KTableStoreSupplier.java     |  58 ----
 .../streams/processor/StateStoreSupplier.java      |  16 ++
 .../streams/processor/TimestampExtractor.java      |   8 +-
 .../kafka/streams/processor/TopologyBuilder.java   |  71 +++--
 .../processor/internals/InternalTopicConfig.java   | 110 ++++++++
 .../processor/internals/InternalTopicManager.java  |  65 +++--
 .../processor/internals/ProcessorContextImpl.java  |  56 ++--
 .../internals/StreamPartitionAssignor.java         | 106 ++++---
 .../streams/processor/internals/StreamTask.java    |   7 +-
 .../org/apache/kafka/streams/state/Stores.java     |  87 +++++-
 .../state/internals/AbstractStoreSupplier.java     |  53 ++++
 .../internals/InMemoryKeyValueStoreSupplier.java   |  24 +-
 .../internals/InMemoryLRUCacheStoreSupplier.java   |  29 +-
 .../internals/RocksDBKeyValueStoreSupplier.java    |  29 +-
 .../internals/RocksDBWindowStoreSupplier.java      |  29 +-
 .../streams/state/internals/StoreChangeLogger.java |   2 +-
 .../integration/InternalTopicIntegrationTest.java  | 110 ++++++--
 .../streams/processor/TopologyBuilderTest.java     | 101 ++++++-
 .../internals/InternalTopicConfigTest.java         | 122 ++++++++
 .../internals/StreamPartitionAssignorTest.java     |   8 +-
 .../org/apache/kafka/streams/state/StoresTest.java |  84 ++++++
 .../state/internals/AbstractKeyValueStoreTest.java | 312 ++++++++++-----------
 .../state/internals/InMemoryLRUCacheStoreTest.java |  82 +++---
 .../state/internals/RocksDBWindowStoreTest.java    |  10 +-
 .../state/internals/StateStoreTestUtils.java       |   8 +-
 .../state/internals/StoreChangeLoggerTest.java     |   4 +-
 .../apache/kafka/test/MockStateStoreSupplier.java  |  12 +
 29 files changed, 1094 insertions(+), 532 deletions(-)
eba0ede878bd9c42431cc702bc58f56354c595a6

 .../streams/errors/InvalidStateStoreException.java | 31 ++++++++++
 .../processor/internals/ProcessorStateManager.java |  4 +-
 .../streams/processor/internals/StreamThread.java  |  7 +++
 .../kafka/streams/state/ReadOnlyKeyValueStore.java | 10 ++-
 .../kafka/streams/state/ReadOnlyWindowStore.java   |  2 +
 .../internals/InvalidStateStoreException.java      | 27 --------
 .../state/internals/QueryableStoreProvider.java    |  3 +-
 .../streams/state/internals/RocksDBStore.java      |  5 +-
 .../state/internals/RocksDBWindowStore.java        |  7 +++
 .../internals/StreamThreadStateStoreProvider.java  |  4 ++
 .../state/internals/WrappingStoreProvider.java     |  1 +
 .../integration/QueryableStateIntegrationTest.java | 71 +++++++++++++++++++++-
 .../CompositeReadOnlyKeyValueStoreTest.java        |  1 +
 .../internals/QueryableStoreProviderTest.java      | 26 ++++----
 .../StreamThreadStateStoreProviderTest.java        | 14 +++++
 .../state/internals/WrappingStoreProviderTest.java |  1 +
 16 files changed, 166 insertions(+), 48 deletions(-)
ca3f3a492c1f10eda965c8402075a3e666f47885

 docs/connect.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
3a244b78372373ea1028fa77eef8b7c739001bd2

 .../main/java/org/apache/kafka/streams/kstream/KGroupedTable.java | 8 ++++----
 .../src/main/java/org/apache/kafka/streams/kstream/Windowed.java  | 6 +++---
 .../apache/kafka/streams/kstream/internals/KGroupedTableImpl.java | 4 ++--
 3 files changed, 9 insertions(+), 9 deletions(-)
85c441023b2cfb0860115a52ad36075a618b0fc1

 .../src/main/java/org/apache/kafka/clients/producer/ProducerConfig.java | 2 +-
 core/src/main/scala/kafka/tools/ConsoleProducer.scala                   | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
2586226a9a5300fea427ca001608ad86d393df1b

 .../test/java/org/apache/kafka/test/TestUtils.java | 112 ++++++++++---------
 .../main/scala/kafka/tools/StreamsResetter.java    |   2 +-
 .../streams/integration/ResetIntegrationTest.java  | 123 ++++++++++++++-------
 3 files changed, 147 insertions(+), 90 deletions(-)
16469d7f94f0a7d82c2a74515ab0903ce6ca9c5e

 .../main/java/org/apache/kafka/common/network/SslTransportLayer.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d2acd676c3eb0c11d0042bc3b9ae314165c68443

 .../kafka/clients/consumer/internals/Fetcher.java  | 15 +++--
 .../org/apache/kafka/common/record/Record.java     | 15 +++--
 .../java/org/apache/kafka/common/utils/Crc32.java  |  3 +
 .../kafka/common/record/SimpleRecordTest.java      | 66 ++++++++++++++++++++++
 4 files changed, 87 insertions(+), 12 deletions(-)
286411cbb19ad267516c73e0a5a8a22e8341b9ad

 core/src/main/scala/kafka/network/SocketServer.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
8248caf1ca514adcbc6130d6674cad39275fdd36

 core/src/main/scala/kafka/log/LogCleanerManager.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
de1b853c3ed326cf296a56538ca9570b0ecc0636

 .../streams/integration/FanoutIntegrationTest.java |  56 +++---
 .../integration/InternalTopicIntegrationTest.java  |  66 +++----
 .../KStreamAggregationIntegrationTest.java         | 127 ++++++-------
 .../KStreamKTableJoinIntegrationTest.java          |  58 +++---
 .../integration/KStreamRepartitionJoinTest.java    | 167 ++++++++---------
 .../integration/QueryableStateIntegrationTest.java | 203 +++++++++++----------
 .../integration/RegexSourceIntegrationTest.java    | 127 ++++++-------
 .../integration/utils/EmbeddedKafkaCluster.java    |  35 ++--
 .../integration/utils/IntegrationTestUtils.java    | 124 +++++++------
 .../streams/integration/utils/KafkaEmbedded.java   |  86 ++++-----
 10 files changed, 538 insertions(+), 511 deletions(-)
ed639e8263d9409a9836a55938174122d6ff3ffa

 .../processor/internals/ProcessorStateManager.java | 22 +++++-----
 .../processor/internals/RecordCollector.java       |  7 ++-
 .../streams/processor/internals/StandbyTask.java   |  7 +++
 .../internals/StreamPartitionAssignor.java         | 30 ++++++-------
 .../streams/processor/internals/StreamTask.java    | 12 ++---
 .../streams/processor/internals/StreamThread.java  | 51 +++++++++++-----------
 .../internals/assignment/TaskAssignor.java         | 10 ++---
 .../processor/internals/RecordCollectorTest.java   |  8 ++--
 .../internals/assignment/TaskAssignorTest.java     | 24 +++++-----
 .../streams/state/KeyValueStoreTestDriver.java     |  2 +-
 .../state/internals/RocksDBWindowStoreTest.java    | 20 ++++-----
 .../state/internals/StateStoreTestUtils.java       |  2 +-
 .../state/internals/StoreChangeLoggerTest.java     |  2 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  2 +-
 14 files changed, 105 insertions(+), 94 deletions(-)
a960faf5f48025548de71a84b16e0ccf2a1837ca

 .../org/apache/kafka/streams/KafkaStreamsTest.java |   5 +-
 .../streams/integration/FanoutIntegrationTest.java |   5 +-
 .../integration/InternalTopicIntegrationTest.java  |   5 +-
 .../KStreamAggregationIntegrationTest.java         |   8 +-
 .../KStreamKTableJoinIntegrationTest.java          |   6 +-
 .../integration/KStreamRepartitionJoinTest.java    |   8 +-
 .../integration/QueryableStateIntegrationTest.java | 410 ++++++++++++++++++++-
 .../integration/RegexSourceIntegrationTest.java    |   5 +-
 .../streams/integration/ResetIntegrationTest.java  |   5 +-
 .../integration/utils/EmbeddedKafkaCluster.java    | 144 ++++++++
 .../utils/EmbeddedSingleNodeKafkaCluster.java      | 135 -------
 11 files changed, 566 insertions(+), 170 deletions(-)
af9fc503dea5058df890fbd79249abb7634e06bc

 core/src/main/scala/kafka/log/Log.scala          | 11 +++++++----
 core/src/main/scala/kafka/log/LogSegment.scala   | 21 +++++++++++++--------
 core/src/test/scala/unit/kafka/log/LogTest.scala | 19 +++++++++++++------
 docs/upgrade.html                                |  2 +-
 4 files changed, 34 insertions(+), 19 deletions(-)
8f3462552fa4d6a6d70a837c2ef7439bba512657

 .../internals/StreamPartitionAssignor.java         | 18 ++++++++++++
 .../internals/StreamPartitionAssignorTest.java     | 32 ++++++++++++++++++++++
 2 files changed, 50 insertions(+)
5a03416fe21f3e5f3425f5a62c35b0859d5baf6e

 docs/api.html     | 15 ++++++++-------
 docs/streams.html |  6 +++++-
 2 files changed, 13 insertions(+), 8 deletions(-)
268cff704994693e177c38cd2a16bf5179765f33

 docs/api.html     | 15 ++++++++-------
 docs/streams.html |  4 ++--
 2 files changed, 10 insertions(+), 9 deletions(-)
3a161db57138b8001a66bef19dfc6e865f4fdfcd

 tests/kafkatest/services/security/security_config.py | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
c3b64cc8f1cd1958c4522aff8743624105fef0af

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
bc397db0e13998160f0b4e723211d6662ca7e964

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java     | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
2e731a9ee002298b4b90f97e9c876b330b005539

 .../services/kafka/templates/kafka.properties      |   1 +
 tests/kafkatest/services/kafka_log4j_appender.py   |   2 +-
 .../kafkatest/services/security/security_config.py |  97 ++++++++++++-------
 tests/kafkatest/tests/core/security_test.py        | 106 +++++++++++++++++++++
 4 files changed, 170 insertions(+), 36 deletions(-)
2f20a398735f9c0d39487bedc2d5dd7f4d3eb179

 .../src/main/scala/kafka/tools/DumpLogSegments.scala | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)
bff5349a49c2bf7c3b30c8ddc126e53cb6e06dca

 .../java/org/apache/kafka/test/TestCondition.java  | 26 ++++++++
 .../test/java/org/apache/kafka/test/TestUtils.java | 76 ++++++++++++++--------
 .../main/scala/kafka/tools/StreamsResetter.java    |  2 +-
 .../streams/integration/ResetIntegrationTest.java  | 40 +++++++++++-
 4 files changed, 112 insertions(+), 32 deletions(-)
b91eeac9438b8718c410045b0e9191296ebb536d

 .../java/org/apache/kafka/connect/data/ConnectSchema.java     | 10 ++++++----
 .../java/org/apache/kafka/connect/data/SchemaBuilder.java     |  5 +++--
 .../java/org/apache/kafka/connect/data/ConnectSchemaTest.java |  7 +++++++
 .../java/org/apache/kafka/connect/data/SchemaBuilderTest.java | 11 ++++++++++-
 4 files changed, 26 insertions(+), 7 deletions(-)
9aaeb33c16d4a319967560215e2ea72082367f92

 .../org/apache/kafka/clients/NetworkClient.java    |  2 +-
 .../apache/kafka/clients/NetworkClientTest.java    | 38 +++++++++++++++++-----
 2 files changed, 30 insertions(+), 10 deletions(-)
71f7e7c3a29e8f7339430837065126256907bd2a

 .gitignore                                         |   1 +
 .../kafka/connect/cli/ConnectDistributed.java      |   4 +-
 .../kafka/connect/cli/ConnectStandalone.java       |   4 +-
 .../kafka/connect/runtime/AbstractHerder.java      |   2 +-
 .../kafka/connect/runtime/ConnectorFactory.java    | 102 +++++++
 .../org/apache/kafka/connect/runtime/Worker.java   | 319 ++++++++-------------
 .../runtime/distributed/DistributedHerder.java     |  88 +++---
 .../runtime/standalone/StandaloneHerder.java       |  64 ++---
 .../connect/storage/KafkaStatusBackingStore.java   |  22 +-
 .../apache/kafka/connect/runtime/WorkerTest.java   | 119 +++++---
 .../runtime/distributed/DistributedHerderTest.java | 165 +++++------
 .../runtime/standalone/StandaloneHerderTest.java   | 119 ++------
 .../storage/KafkaStatusBackingStoreTest.java       |  28 ++
 tests/kafkatest/services/connect.py                |   5 +-
 .../tests/connect/connect_distributed_test.py      |  42 ++-
 15 files changed, 548 insertions(+), 536 deletions(-)
190239441878d73ad0c50d59c73bcc8717a12ed6

 .../processor/internals/ProcessorTopologyTest.java | 72 ++++++++++++++--------
 .../kafka/test/ProcessorTopologyTestDriver.java    |  2 +-
 2 files changed, 49 insertions(+), 25 deletions(-)
ca45bd0317c024b3ec06fc235cf6a0377733c6c2

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d4c379832b525d1a9c20c5cb84f0e586b9d977e0

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b4ddd021b42225f8cb1d7049298f0e503cb09633

 docs/ops.html | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)
20155ef87e935a37779ee07d9605be9feabe2ad0

 docs/ops.html | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)
dca63fc0a50fe268b82ae5bdafa0b876f6389907

 bin/connect-distributed.sh | 20 +++++++++++++++++++-
 bin/connect-standalone.sh  | 20 +++++++++++++++++++-
 2 files changed, 38 insertions(+), 2 deletions(-)
c80649078bb38f8b3a32ace2c5d4aa328bb8246b

 core/src/main/scala/kafka/server/ReplicaManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
08ad2be0da23afdaf6af05213005c9f765f39d8e

 .../java/org/apache/kafka/connect/data/Struct.java    | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)
bf3dbcba4fe5fd8185a529ba216acf20f7e2d02d

 .../apache/kafka/tools/ProducerPerformance.java    | 22 ++++++++++++++++++++--
 1 file changed, 20 insertions(+), 2 deletions(-)
dddb79f3129497997dce9a0d3170eba169b72a57

 docs/configuration.html | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)
32feed25aefdda3a9f2b780d0709a3002777c9df

 .../kafka/admin/ReassignPartitionsCommand.scala    |  16 +--
 .../scala/kafka/controller/KafkaController.scala   |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 132 ++++++++++-----------
 .../admin/ReassignPartitionsClusterTest.scala      |   9 +-
 4 files changed, 77 insertions(+), 82 deletions(-)
53651937fa8a7750daf44d7e88e616f01e2e37d3

 .../kafka/controller/ControllerChannelManager.scala    |  9 +++++----
 .../scala/kafka/utils/NetworkClientBlockingOps.scala   | 18 ++++++++++++++----
 2 files changed, 19 insertions(+), 8 deletions(-)
4cdb96f4c396e331ec98fe881ab0255e247bc62a

 .../java/org/apache/kafka/streams/integration/ResetIntegrationTest.java | 2 ++
 1 file changed, 2 insertions(+)
36044fdc544f1b6b4829558691e0e7d280abce99

 .../org/apache/kafka/common/config/ConfigDef.java  |  25 ++++
 .../apache/kafka/common/config/ConfigDefTest.java  |   1 +
 core/src/main/scala/kafka/log/Log.scala            |  50 ++++++--
 core/src/main/scala/kafka/log/LogCleaner.scala     |  18 ++-
 .../main/scala/kafka/log/LogCleanerManager.scala   |  38 +++++-
 core/src/main/scala/kafka/log/LogConfig.scala      |   8 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  40 +------
 core/src/main/scala/kafka/server/KafkaConfig.scala |   7 +-
 .../test/scala/unit/kafka/KafkaConfigTest.scala    |   9 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    |   6 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  56 +++++++--
 .../unit/kafka/log/LogCleanerManagerTest.scala     | 117 +++++++++++++++++++
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  25 ++++
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 130 +++++++++++++++++++--
 14 files changed, 452 insertions(+), 78 deletions(-)
151288fe1f271391ebb53b14ff3146cfc3a4daee

 clients/src/main/java/org/apache/kafka/clients/Metadata.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
08bdffbe4d13fff202b2598b3732ef041183a5f4

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9b3e9f3dfeecdfa9a52a844ba133b7f9d3f4dd7a

 build.gradle | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
7a877895a1c8494d48bf2c18e2f74fb913ed036a

 build.gradle | 6 ++----
 gradlew      | 5 +++++
 gradlew.bat  | 6 ------
 3 files changed, 7 insertions(+), 10 deletions(-)
d85aaf95febca62cb03f4c2a2f84401cae4800d2

 .../apache/kafka/common/record/MemoryRecords.java  | 39 +++++++++++++---------
 .../java/org/apache/kafka/common/utils/Utils.java  | 13 ++++++++
 2 files changed, 37 insertions(+), 15 deletions(-)
cec2769e2281ac731e8cfd12b5d8e34e0ebe38cd

 .../kafka/connect/runtime/WorkerSinkTask.java      |  9 ++-
 .../runtime/WorkerSinkTaskThreadedTest.java        | 90 +++++++++++++++++++---
 2 files changed, 88 insertions(+), 11 deletions(-)
313aad423cb19618b8693af6f04b68138059c585

 .../kafka/clients/consumer/ConsumerConfig.java     |   3 +-
 .../kafka/clients/producer/ProducerConfig.java     |   2 +-
 .../apache/kafka/common/config/AbstractConfig.java |  17 ++-
 .../kafka/common/config/AbstractConfigTest.java    | 125 ++++++++++++++++++++-
 4 files changed, 133 insertions(+), 14 deletions(-)
4e4e2fb5085758ee9ccf6307433ad531a33198d3

 core/src/main/scala/kafka/tools/MirrorMaker.scala      |  4 +++-
 .../test/scala/unit/kafka/tools/MirrorMakerTest.scala  | 18 +++++++++++++++++-
 2 files changed, 20 insertions(+), 2 deletions(-)
a1e0b2240dba0740135621d959441eefa6fd3124

 core/src/main/scala/kafka/tools/MirrorMaker.scala      |  4 +++-
 .../test/scala/unit/kafka/tools/MirrorMakerTest.scala  | 18 +++++++++++++++++-
 2 files changed, 20 insertions(+), 2 deletions(-)
a2bac70a6634e9a78734d23158fb7e45f290ea26

 .../kafka/streams/kstream/KStreamBuilder.java      |   1 -
 .../kafka/streams/processor/TopologyBuilder.java   | 393 +++++++++++----------
 .../streams/processor/internals/StreamThread.java  |   4 +-
 .../kstream/internals/KStreamBranchTest.java       |   1 +
 .../streams/kstream/internals/KStreamImplTest.java |   2 +-
 .../streams/processor/TopologyBuilderTest.java     |  29 +-
 .../processor/internals/ProcessorTopologyTest.java |   4 +-
 .../processor/internals/StreamThreadTest.java      |  14 +-
 .../StreamThreadStateStoreProviderTest.java        |   3 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |   3 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   2 +-
 11 files changed, 232 insertions(+), 224 deletions(-)
24fd025d407d42176847143d3a0dc416a75d8f35

 .../org/apache/kafka/common/network/Selector.java  | 125 +++++++++++++++------
 .../controller/ControllerChannelManager.scala      |  19 ++--
 .../kafka/utils/NetworkClientBlockingOps.scala     |  58 ++++------
 3 files changed, 120 insertions(+), 82 deletions(-)
05d00b5aca2e1e59ad685a3f051d2ab022f75acc

 core/src/main/scala/kafka/server/KafkaApis.scala   |  4 ++--
 .../kafka/integration/BaseTopicMetadataTest.scala  | 25 ++++++++++++++++++++++
 2 files changed, 27 insertions(+), 2 deletions(-)
f903215536af06b7b79739882d9286abc2e50000

 .../test/java/org/apache/kafka/test/TestUtils.java |  1 -
 .../integration/RegexSourceIntegrationTest.java    | 62 ++++++++--------------
 2 files changed, 21 insertions(+), 42 deletions(-)
dedacd06e4d1e967261b9bca3e32ba0e44b52ba1

 core/src/main/scala/kafka/utils/Time.scala                | 4 ++++
 core/src/main/scala/kafka/utils/timer/Timer.scala         | 5 +++--
 core/src/main/scala/kafka/utils/timer/TimerTaskList.scala | 2 +-
 3 files changed, 8 insertions(+), 3 deletions(-)
8bf9addd25a0cccdd79a68ef792c106f671f842f

 build.gradle               | 8 +++++++-
 gradle/dependencies.gradle | 2 ++
 2 files changed, 9 insertions(+), 1 deletion(-)
d903babb726bdf725bd473c0590f9826b6fa2f14

 build.gradle               | 8 +++++++-
 gradle/dependencies.gradle | 2 ++
 2 files changed, 9 insertions(+), 1 deletion(-)
d851ce76fdaa469dcaed7f66340574529d79a3cd

 core/src/main/scala/kafka/tools/StreamsResetter.java | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)
f153407c42716f4f4d9abe8be39ab1112f36a8be

 docs/security.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
7b16b4731666ff321fbe46828d526872ff5f56d7

 .../consumer/internals/AbstractCoordinator.java    | 32 ++++++++++------------
 1 file changed, 15 insertions(+), 17 deletions(-)
6ed3e6b1cb8a73b1f5f78926ccb247a8953a554c

 core/src/main/scala/kafka/log/LogCleaner.scala     | 46 +++++-------
 core/src/main/scala/kafka/log/OffsetMap.scala      | 19 ++++-
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 85 ++++++++++++++++++++--
 3 files changed, 111 insertions(+), 39 deletions(-)
113d23e8fe290878120c1384b580181169777f4f

 core/src/main/scala/kafka/log/LogSegment.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
45259d11aa77bda708a2e9422c3dc3899668965d

 core/src/main/scala/kafka/tools/StreamsResetter.java | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)
317c4fdede41f2026b34f473af1ad69f8ee62a1d

 .../java/org/apache/kafka/clients/Metadata.java    |  13 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |  10 +-
 .../kafka/clients/consumer/MockConsumer.java       |   8 +-
 .../consumer/internals/AbstractCoordinator.java    |  20 +-
 .../consumer/internals/ConsumerCoordinator.java    |  59 +++--
 .../kafka/clients/consumer/internals/Fetcher.java  |  28 +--
 .../consumer/internals/SubscriptionState.java      | 100 ++++----
 .../java/org/apache/kafka/clients/MockClient.java  |   2 +-
 .../internals/ConsumerCoordinatorTest.java         | 280 ++++++++++++---------
 .../clients/consumer/internals/FetcherTest.java    |  65 ++---
 .../consumer/internals/SubscriptionStateTest.java  |  77 +++---
 11 files changed, 354 insertions(+), 308 deletions(-)
c5d26c4829583c95af7ca9e961a4d3954f8e09eb

 .../apache/kafka/streams/perf/SimpleBenchmark.java | 325 +++++++++++++++++----
 .../streams/streams_simple_benchmark_test.py       |   2 +-
 .../services/performance/streams_performance.py    |   6 +-
 3 files changed, 270 insertions(+), 63 deletions(-)
33447cb4beb8dd710a20556a6a2baf8307f03860

 core/src/main/scala/kafka/admin/TopicCommand.scala | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
880bde5ac5644c904eacc1c4a53159a58d107254

 .../src/main/java/org/apache/kafka/common/config/AbstractConfig.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
afb65688af643f72ccf1ab7414bdfc0adbb880e9

 .../java/org/apache/kafka/common/config/SslConfigs.java |  6 +++++-
 .../apache/kafka/common/security/ssl/SslFactory.java    | 13 ++++++++++++-
 .../kafka/common/network/SslTransportLayerTest.java     | 17 ++++++++++++++++-
 core/src/main/scala/kafka/server/KafkaConfig.scala      |  3 +++
 .../test/scala/unit/kafka/server/KafkaConfigTest.scala  |  1 +
 docs/security.html                                      |  9 +++++++++
 tests/kafkatest/services/kafka/config_property.py       |  1 +
 7 files changed, 47 insertions(+), 3 deletions(-)
104d2154b635c50efc80331ee2a4779cc3658414

 .../java/org/apache/kafka/common/config/SslConfigs.java |  6 +++++-
 .../apache/kafka/common/security/ssl/SslFactory.java    | 13 ++++++++++++-
 .../kafka/common/network/SslTransportLayerTest.java     | 17 ++++++++++++++++-
 core/src/main/scala/kafka/server/KafkaConfig.scala      |  3 +++
 .../test/scala/unit/kafka/server/KafkaConfigTest.scala  |  1 +
 docs/security.html                                      |  9 +++++++++
 tests/kafkatest/services/kafka/config_property.py       |  1 +
 7 files changed, 47 insertions(+), 3 deletions(-)
79d3fd2bf0e5c89ff74a2988c403882ae8a9852e

 core/src/main/scala/kafka/log/AbstractIndex.scala  | 287 +++++++++++++++++++
 core/src/main/scala/kafka/log/FileMessageSet.scala |  78 +++++-
 core/src/main/scala/kafka/log/IndexEntry.scala     |  46 ++++
 core/src/main/scala/kafka/log/Log.scala            | 196 ++++++++++---
 core/src/main/scala/kafka/log/LogCleaner.scala     |  41 ++-
 core/src/main/scala/kafka/log/LogManager.scala     |   6 +-
 core/src/main/scala/kafka/log/LogSegment.scala     | 169 ++++++++++--
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 306 +++------------------
 core/src/main/scala/kafka/log/OffsetPosition.scala |  25 --
 core/src/main/scala/kafka/log/TimeIndex.scala      | 208 ++++++++++++++
 .../scala/kafka/message/ByteBufferMessageSet.scala |  91 ++++--
 .../scala/kafka/message/MessageAndOffset.scala     |   8 +
 core/src/main/scala/kafka/server/KafkaApis.scala   |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 122 +++++++-
 .../test/scala/unit/kafka/log/CleanerTest.scala    |   5 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |  16 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   4 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 114 ++++++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 152 ++++++++--
 .../test/scala/unit/kafka/log/TimeIndexTest.scala  |  97 +++++++
 .../kafka/message/ByteBufferMessageSetTest.scala   | 135 +++++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 docs/upgrade.html                                  |  16 +-
 24 files changed, 1631 insertions(+), 499 deletions(-)
05ed54bf2b80691d413dbfa05065eb3afe33972f

 build.gradle                                       |   2 +-
 .../kafka/connect/runtime/ConnectorConfig.java     |  12 ++-
 .../org/apache/kafka/connect/runtime/Worker.java   |  31 ++++--
 .../runtime/distributed/DistributedHerder.java     |   6 +-
 .../runtime/standalone/StandaloneConfig.java       |   2 +-
 .../runtime/standalone/StandaloneHerder.java       |  15 ++-
 .../apache/kafka/connect/runtime/WorkerTest.java   | 113 ++++++++++++++++++--
 .../runtime/distributed/DistributedHerderTest.java |  20 ++--
 .../runtime/standalone/StandaloneHerderTest.java   | 117 +++++++++++----------
 docs/connect.html                                  |  16 ++-
 tests/kafkatest/tests/connect/connect_rest_test.py |   4 +-
 tests/kafkatest/tests/connect/connect_test.py      |  13 ++-
 .../connect/templates/connect-file-sink.properties |  10 +-
 .../templates/connect-file-source.properties       |  10 +-
 14 files changed, 272 insertions(+), 99 deletions(-)
e3ede843443ddb98b249d8ce1d111cc18aec6ed5

 bin/windows/kafka-run-class.bat | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c6e6fadeed3e060da34b0fc7ec4c8540f8dffa90

 .../main/java/org/apache/kafka/clients/producer/ProducerConfig.java  | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
a707f573de55a97782397f6cb5be90876e20cc3e

 tests/kafkatest/services/connect.py                | 62 ++++++++++++++--------
 tests/kafkatest/tests/connect/connect_rest_test.py | 12 ++---
 tests/kafkatest/utils/util.py                      | 10 ----
 3 files changed, 46 insertions(+), 38 deletions(-)
59cfa84801c67de9729385a8f9b536721e0c37b9

 tests/kafkatest/services/connect.py                | 62 ++++++++++++++--------
 tests/kafkatest/tests/connect/connect_rest_test.py | 12 ++---
 tests/kafkatest/utils/util.py                      | 10 ----
 3 files changed, 46 insertions(+), 38 deletions(-)
9af2e69ef4323dc6c8daf479226f25cc821b1bb6

 core/src/test/scala/unit/kafka/server/DeleteTopicsRequestTest.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
40b1dd3f495a59abef8a0cba5450526994c92c04

 .../clients/consumer/CommitFailedException.java    |   9 +-
 .../kafka/clients/consumer/ConsumerConfig.java     |  39 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |  78 ++-
 .../consumer/internals/AbstractCoordinator.java    | 532 ++++++++++++++-------
 .../consumer/internals/ConsumerCoordinator.java    | 264 +++++-----
 .../consumer/internals/ConsumerNetworkClient.java  | 267 ++++++-----
 .../clients/consumer/internals/DelayedTask.java    |  24 -
 .../consumer/internals/DelayedTaskQueue.java       |  96 ----
 .../kafka/clients/consumer/internals/Fetcher.java  |  21 +-
 .../clients/consumer/internals/Heartbeat.java      |  56 ++-
 .../clients/consumer/internals/RequestFuture.java  |   2 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  25 +-
 .../kafka/common/requests/JoinGroupRequest.java    |  49 +-
 .../kafka/common/requests/JoinGroupResponse.java   |  15 +-
 .../kafka/common/requests/OffsetFetchResponse.java |   2 -
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  49 +-
 .../internals/AbstractCoordinatorTest.java         |  68 ++-
 .../internals/ConsumerCoordinatorTest.java         | 179 +++----
 .../internals/ConsumerNetworkClientTest.java       |  26 +-
 .../consumer/internals/DelayedTaskQueueTest.java   |  89 ----
 .../clients/consumer/internals/FetcherTest.java    |   1 +
 .../clients/consumer/internals/HeartbeatTest.java  |   6 +-
 .../kafka/common/requests/RequestResponseTest.java |  14 +-
 .../runtime/distributed/DistributedConfig.java     |  29 +-
 .../runtime/distributed/WorkerCoordinator.java     |  38 +-
 .../runtime/distributed/WorkerGroupMember.java     |  15 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |   2 +
 core/src/main/scala/kafka/api/ApiVersion.scala     |  11 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |  90 ++--
 .../scala/kafka/coordinator/GroupMetadata.scala    |   4 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 150 +++---
 .../scala/kafka/coordinator/MemberMetadata.scala   |   1 +
 core/src/main/scala/kafka/server/KafkaApis.scala   |   6 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |   2 +-
 .../integration/kafka/api/BaseConsumerTest.scala   | 170 +------
 .../integration/kafka/api/ConsumerBounceTest.scala |  13 +-
 .../kafka/api/PlaintextConsumerTest.scala          | 223 +++++++--
 .../SaslPlainSslEndToEndAuthorizationTest.scala    |   1 -
 .../coordinator/GroupCoordinatorResponseTest.scala | 213 ++++++---
 .../coordinator/GroupMetadataManagerTest.scala     |  11 +-
 .../unit/kafka/coordinator/GroupMetadataTest.scala |  59 +--
 .../kafka/coordinator/MemberMetadataTest.scala     |  16 +-
 .../scala/unit/kafka/utils/timer/MockTimer.scala   |   2 +-
 43 files changed, 1686 insertions(+), 1281 deletions(-)
19997ede08bffeb95d17b2c41066e8943a391034

 clients/src/main/java/org/apache/kafka/common/network/Selector.java | 6 ++++++
 1 file changed, 6 insertions(+)
11f1801c3b637ac1d355b8e35f9f879f3b946517

 .../test/java/org/apache/kafka/streams/perf/SimpleBenchmark.java    | 6 ++++++
 1 file changed, 6 insertions(+)
ae237be1bbfd7d1b84a5095491a6131cd3cc9346

 .../kafka/clients/consumer/internals/Fetcher.java  |   3 +-
 .../kafka/clients/producer/internals/Sender.java   |   7 +-
 config/server.properties                           |   3 +
 .../org/apache/kafka/streams/StreamsMetrics.java   |  12 ++
 .../streams/processor/internals/StreamThread.java  | 159 ++++++++++++---------
 .../apache/kafka/streams/perf/SimpleBenchmark.java |  11 +-
 .../processor/internals/StreamThreadTest.java      |   6 +-
 .../StreamThreadStateStoreProviderTest.java        |   3 +-
 8 files changed, 123 insertions(+), 81 deletions(-)
801a706124af16f605abc6141f38f9eed916ffc2

 .../org/apache/kafka/streams/KafkaStreams.java     |  2 +
 .../kafka/streams/processor/TopologyBuilder.java   | 79 ++++++++++++++++------
 .../internals/StreamPartitionAssignor.java         |  2 +-
 .../streams/processor/internals/StreamThread.java  |  6 +-
 .../streams/kstream/internals/KStreamImplTest.java |  2 +-
 .../streams/processor/TopologyBuilderTest.java     | 25 +++----
 .../processor/internals/ProcessorTopologyTest.java |  2 +-
 .../internals/StreamPartitionAssignorTest.java     | 12 ++--
 .../processor/internals/StreamThreadTest.java      |  6 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  2 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |  2 +-
 11 files changed, 91 insertions(+), 49 deletions(-)
e49b3aee6b25b9b26275849c693d5dec41d6cf68

 core/src/main/scala/kafka/admin/AclCommand.scala          | 2 +-
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
e615d0be78decbc6fe2f508d5ab83fb3e05d6dc6

 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
55af7ec6b5a795997a5afc2643b45bd2ac243344

 .../kafka/clients/consumer/KafkaConsumer.java      | 22 +++++++----
 .../consumer/RetriableCommitFailedException.java   |  4 ++
 .../consumer/internals/AbstractCoordinator.java    | 25 +++++++++++-
 .../consumer/internals/ConsumerCoordinator.java    | 38 +++++++++++++++----
 .../kafka/clients/consumer/internals/Fetcher.java  | 13 ++++++-
 .../consumer/internals/SubscriptionState.java      |  2 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 44 +++++++++++++++++++++-
 .../kafka/api/AuthorizerIntegrationTest.scala      | 18 ++++++++-
 8 files changed, 147 insertions(+), 19 deletions(-)
be36b322749003581474e2c84a3ec9ba2aaec53c

 .../kafka/clients/consumer/KafkaConsumer.java      | 22 +++++++----
 .../consumer/RetriableCommitFailedException.java   |  4 ++
 .../consumer/internals/AbstractCoordinator.java    | 25 +++++++++++-
 .../consumer/internals/ConsumerCoordinator.java    | 38 +++++++++++++++----
 .../kafka/clients/consumer/internals/Fetcher.java  | 13 ++++++-
 .../consumer/internals/SubscriptionState.java      |  2 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 44 +++++++++++++++++++++-
 .../kafka/api/AuthorizerIntegrationTest.scala      | 18 ++++++++-
 8 files changed, 147 insertions(+), 19 deletions(-)
fc55f804e1b66a5ced14841d05e03f60cce65c63

 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b18c3f5caba51a07ec514b5d04bca8b85bae3748

 .../apache/kafka/common/security/kerberos/KerberosShortNamer.java  | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
539633ba0eba452960a4d2a3bf07abd79020b329

 .../org/apache/kafka/common/protocol/ApiKeys.java  |   3 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  19 ++
 .../kafka/common/requests/AbstractRequest.java     |   2 +
 .../common/requests/CreateTopicsResponse.java      |   1 +
 .../kafka/common/requests/DeleteTopicsRequest.java |  90 +++++++
 .../common/requests/DeleteTopicsResponse.java      |  88 +++++++
 .../kafka/common/requests/RequestResponseTest.java |  16 +-
 core/src/main/scala/kafka/admin/AclCommand.scala   |   2 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  28 ++-
 .../src/main/scala/kafka/server/AdminManager.scala |  44 ++++
 .../scala/kafka/server/DelayedDeleteTopics.scala   |  77 ++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  51 +++-
 .../kafka/api/AuthorizerIntegrationTest.scala      | 259 +++++++++++----------
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  11 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |   9 +-
 .../kafka/server/DeleteTopicsRequestTest.scala     | 121 ++++++++++
 16 files changed, 668 insertions(+), 153 deletions(-)
208ecae23994812d2a707b776de6b95d9f591bb7

 .../org/apache/kafka/connect/runtime/Worker.java     | 16 +++++++---------
 .../kafka/connect/runtime/WorkerSourceTask.java      |  2 +-
 .../kafka/connect/runtime/WorkerSourceTaskTest.java  | 20 ++++++++++++++++++++
 3 files changed, 28 insertions(+), 10 deletions(-)
39431f7347d994f18878d199cc268ee7cdcf063d

 core/src/main/scala/kafka/log/OffsetIndex.scala | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
68b5d014fa3bf2e18da253ded2bbcd4f5d4a9d8d

 .../producer/internals/DefaultPartitioner.java     |  22 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  16 ++
 .../org/apache/kafka/streams/KafkaStreams.java     |  94 +++++++-
 .../org/apache/kafka/streams/StreamsConfig.java    |  10 +
 .../internals/WindowedStreamPartitioner.java       |   5 +-
 .../kafka/streams/processor/TopologyBuilder.java   |  55 ++++-
 .../internals/DefaultStreamPartitioner.java        |  43 ++++
 .../internals/StreamPartitionAssignor.java         | 103 +++++++-
 .../streams/processor/internals/StreamThread.java  |  10 +-
 .../processor/internals/StreamsMetadataState.java  | 237 +++++++++++++++++++
 .../internals/assignment/AssignmentInfo.java       | 155 +++++++-----
 .../internals/assignment/SubscriptionInfo.java     |  91 ++++---
 .../org/apache/kafka/streams/state/HostInfo.java   |  81 +++++++
 .../kafka/streams/state/StreamsMetadata.java       |  93 ++++++++
 .../org/apache/kafka/streams/KafkaStreamsTest.java |  43 +++-
 .../integration/RegexSourceIntegrationTest.java    |   3 +-
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  51 ++++
 .../streams/processor/TopologyBuilderTest.java     |  35 +++
 .../internals/StreamPartitionAssignorTest.java     | 185 +++++++++++++--
 .../processor/internals/StreamThreadTest.java      |   8 +-
 .../internals/StreamsMetadataStateTest.java        | 262 +++++++++++++++++++++
 .../internals/assignment/AssginmentInfoTest.java   |  50 ----
 .../internals/assignment/AssignmentInfoTest.java   | 107 +++++++++
 .../internals/assignment/SubscriptionInfoTest.java |  57 ++++-
 .../StreamThreadStateStoreProviderTest.java        |   5 +-
 25 files changed, 1599 insertions(+), 222 deletions(-)
caa9bd0fcd2fab4758791408e2b145532153910e

 .../kstream/internals/KGroupedStreamImpl.java      |  13 +++
 .../kstream/internals/KGroupedTableImpl.java       |   8 ++
 .../streams/kstream/internals/KStreamImpl.java     |  26 +++++
 .../streams/kstream/internals/KTableImpl.java      |  15 +++
 .../kafka/streams/processor/TopologyBuilder.java   |  21 +++-
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  11 ++
 .../kstream/internals/KGroupedStreamImplTest.java  | 100 +++++++++++++++++
 .../kstream/internals/KGroupedTableImplTest.java   |  76 +++++++++++++
 .../streams/kstream/internals/KStreamImplTest.java | 122 +++++++++++++++++++++
 .../streams/kstream/internals/KTableImplTest.java  |  86 +++++++++++++++
 .../streams/processor/TopologyBuilderTest.java     |  65 +++++++++++
 .../StreamThreadStateStoreProviderTest.java        |   2 +-
 12 files changed, 540 insertions(+), 5 deletions(-)
8abcece40aea8860bd0c2feb25d2a91db529cc29

 docs/introduction.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
15722745831b6373817ca156b6d18b8dc1ee9de1

 bin/kafka-server-start.sh     | 6 +++---
 bin/zookeeper-server-start.sh | 6 +++---
 2 files changed, 6 insertions(+), 6 deletions(-)
cb7af0b7fb546cee7a3761b9a80078948f699b33

 bin/kafka-run-class.sh | 23 +++++++++++++++++++----
 1 file changed, 19 insertions(+), 4 deletions(-)
fb65ff40a8d89bc7ad9b079cf1f2a8b902abd182

 .../java/org/apache/kafka/clients/Metadata.java    |  4 ++-
 .../consumer/internals/ConsumerCoordinator.java    |  3 +-
 .../main/java/org/apache/kafka/common/Cluster.java | 33 +++++++++++++++++---
 .../kafka/common/internals/TopicConstants.java     | 33 --------------------
 .../kafka/common/requests/MetadataResponse.java    |  5 ++-
 .../org/apache/kafka/clients/MetadataTest.java     |  4 +++
 .../internals/ConsumerCoordinatorTest.java         |  5 ++-
 .../kafka/clients/producer/KafkaProducerTest.java  |  2 ++
 .../kafka/clients/producer/MockProducerTest.java   |  2 +-
 .../producer/internals/DefaultPartitionerTest.java |  3 +-
 .../producer/internals/RecordAccumulatorTest.java  |  2 +-
 .../test/java/org/apache/kafka/test/TestUtils.java |  6 +++-
 core/src/main/scala/kafka/admin/TopicCommand.scala |  3 +-
 core/src/main/scala/kafka/common/Topic.scala       |  9 ++++--
 .../main/scala/kafka/consumer/TopicFilter.scala    |  7 ++---
 .../kafka/coordinator/GroupMetadataManager.scala   | 27 ++++++++--------
 core/src/main/scala/kafka/server/KafkaApis.scala   | 36 +++++++++++-----------
 .../main/scala/kafka/server/ReplicaManager.scala   |  3 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  4 +--
 .../integration/kafka/api/BaseConsumerTest.scala   |  4 +--
 .../api/GroupCoordinatorIntegrationTest.scala      |  7 ++---
 .../kafka/api/IntegrationTestHarness.scala         |  7 +++--
 .../kafka/api/ProducerFailureHandlingTest.scala    |  8 ++---
 .../scala/unit/kafka/admin/TopicCommandTest.scala  | 11 +++----
 .../unit/kafka/consumer/TopicFilterTest.scala      | 14 ++++-----
 .../coordinator/GroupCoordinatorResponseTest.scala | 15 +++++----
 .../coordinator/GroupMetadataManagerTest.scala     | 15 +++++----
 .../unit/kafka/server/MetadataRequestTest.scala    |  6 ++--
 .../internals/WindowedStreamPartitionerTest.java   |  3 +-
 .../processor/DefaultPartitionGrouperTest.java     |  3 +-
 .../processor/internals/RecordCollectorTest.java   |  3 +-
 .../internals/StreamPartitionAssignorTest.java     |  3 +-
 .../processor/internals/StreamThreadTest.java      |  3 +-
 33 files changed, 148 insertions(+), 145 deletions(-)
da015585a94755d2e499e6fa4723cf1397404e7f

 .../apache/kafka/common/security/JaasUtils.java    |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 26 +++++++++++-----------
 2 files changed, 14 insertions(+), 14 deletions(-)
91b4e3c00d84bf05387d55869062a2f988a8a4eb

 .../kafka/common/security/authenticator/SaslServerCallbackHandler.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
aef20e8353df22894bb43474cb8e31d1afd5ce6b

 core/src/main/scala/kafka/admin/AdminUtils.scala | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
7b7f57df6229c02482e5176f2f265e7a890de2a3

 core/src/main/scala/kafka/admin/AdminUtils.scala | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
5852bb0e4bf6089fb43f54d81aa4493f7cf58b85

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
fa30db135cd4908a048d7d16f1adeb63b74b5840
aaa52996b9bc531fe8222a11fe732565c90388fb

 .gitignore              |   1 +
 docs/documentation.html |   5 +
 docs/ops.html           | 399 +++++++++++++++++++++++++++++++++++++-----------
 3 files changed, 314 insertions(+), 91 deletions(-)
6b2564811a6137f1fe639dee236f2538bb7160b1

 .gitignore              |   1 +
 docs/documentation.html |   5 +
 docs/ops.html           | 399 +++++++++++++++++++++++++++++++++++++-----------
 3 files changed, 314 insertions(+), 91 deletions(-)
29f44e75cd4ade107b169dbf43bbcb191013e75f

 .../src/main/java/org/apache/kafka/connect/runtime/WorkerConfig.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
8d303d0d389a1dfda93224ae6cc8b426ed6750fb

 .../src/main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java | 3 ---
 1 file changed, 3 deletions(-)
778fcd0e9192c8de4c17f23189029d5c1bf98e2a

 build.gradle                                       |  10 +-
 .../org/apache/kafka/common/config/ConfigDef.java  |  77 +++++----
 core/src/main/scala/kafka/log/LogConfig.scala      | 188 ++++++++++++++++-----
 core/src/main/scala/kafka/server/KafkaConfig.scala |  16 +-
 docs/configuration.html                            | 100 +----------
 5 files changed, 212 insertions(+), 179 deletions(-)
22f82abb5ac342ed94cacbe375495509f395b5cd

 .../kstream/internals/KTableRepartitionMap.java    |  9 +++--
 .../kstream/internals/KGroupedTableImplTest.java   |  2 +-
 .../kstream/internals/KTableAggregateTest.java     | 38 +++++++++++++---------
 3 files changed, 29 insertions(+), 20 deletions(-)
3dafb81da788294d4c2e9811f49437608e5b9ce8

 .../kstream/internals/KTableRepartitionMap.java    |  9 ++-
 .../kstream/internals/KTableAggregateTest.java     | 81 +++++++++++++++++++---
 2 files changed, 77 insertions(+), 13 deletions(-)
a7a17cdec9eaa6c57cc634da6a7c766d98d4160e

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
6fb33afff976e467bfa8e0b29eb82770a2a3aaec

 .../kafka/clients/producer/internals/RecordBatch.java      | 14 ++++++++++----
 .../scala/integration/kafka/api/BaseProducerSendTest.scala | 11 +++++++----
 2 files changed, 17 insertions(+), 8 deletions(-)
ac994dd7651937c19cfa50e7d4e3685b76eacac5

 build.gradle | 3 +++
 1 file changed, 3 insertions(+)
2e3722a234df5c0cd2e91c258cc0e4d825ee0626

 build.gradle | 3 +++
 1 file changed, 3 insertions(+)
27fc11d1c9b1ec8c63a991cb8c481f95eddb850b

 .../state/internals/CompositeReadOnlyKeyValueStore.java    |  8 ++++----
 .../state/internals/CompositeReadOnlyWindowStore.java      |  2 +-
 .../streams/state/internals/QueryableStoreProvider.java    |  2 +-
 .../kafka/streams/state/internals/StateStoreProvider.java  |  2 +-
 .../state/internals/StreamThreadStateStoreProvider.java    |  2 +-
 .../streams/state/internals/WrappingStoreProvider.java     |  4 ++--
 .../streams/state/internals/StateStoreProviderStub.java    |  2 +-
 .../internals/StreamThreadStateStoreProviderTest.java      | 14 +++++++-------
 .../streams/state/internals/WrappingStoreProviderTest.java |  6 +++---
 9 files changed, 21 insertions(+), 21 deletions(-)
127bb7fca2b55b13ceb3e94662b0be1f091b9da1

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7d513055671664433a783e4a62e9cbad6c44fc83

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
227c54fa9e240b7a7f060c2bbbb849379be0d072

 core/src/main/scala/kafka/tools/ConsoleProducer.scala | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
1b333c23f4159bfbd3b5cd986bc40c5cdf6ddae1

 docs/security.html | 22 ++++++++++++++++++++--
 1 file changed, 20 insertions(+), 2 deletions(-)
c89707f315a6fe654b764840a49cdf5d9bbcfc90

 docs/security.html | 22 ++++++++++++++++++++--
 1 file changed, 20 insertions(+), 2 deletions(-)
416817920bcc0a5f74ddf5231505160a68c7d2db

 .../org/apache/kafka/streams/kstream/KStream.java  | 28 ++++++++++++----------
 .../streams/kstream/internals/AbstractStream.java  |  4 ----
 .../streams/kstream/internals/KStreamImpl.java     |  8 ++++---
 3 files changed, 21 insertions(+), 19 deletions(-)
c840f2a95c2e247c384315846067daa839df77a7

 .../kafka/streams/state/internals/RocksDBStore.java      | 16 ++++++----------
 1 file changed, 6 insertions(+), 10 deletions(-)
e62dd4cb770e3662524d4f2f50547549e3ab2eaf

 .../streams/processor/internals/StreamTask.java    | 66 +++++++++++-----------
 1 file changed, 32 insertions(+), 34 deletions(-)
bb629f2243c4462db2a863793c190d734f11f3c6

 .../org/apache/kafka/streams/StreamsConfig.java    | 83 +++++++++++++++++++---
 .../apache/kafka/streams/StreamsConfigTest.java    | 64 +++++++++++++++++
 2 files changed, 139 insertions(+), 8 deletions(-)
00ab00b352d0db4194ff15499bd52ad1a20585f5

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
3bb38d37b7a3fe2dc794c717df1d67e8f9a8af21

 .../org/apache/kafka/streams/KafkaStreamsTest.java  | 21 ++++++++++++++-------
 1 file changed, 14 insertions(+), 7 deletions(-)
ce34614a43fb1f43ef6b5660fb37f7a0598d177a

 .../org/apache/kafka/streams/KafkaStreamsTest.java  | 21 ++++++++++++++-------
 1 file changed, 14 insertions(+), 7 deletions(-)
f7976d2fc1793d0f635b42eb4dca3810e40c4cc8

 bin/kafka-streams-application-reset.sh             |   2 +-
 build.gradle                                       |   2 -
 checkstyle/import-control-core.xml                 |   2 +
 checkstyle/import-control.xml                      |   4 +-
 .../main/scala/kafka/tools/StreamsResetter.java    | 268 +++++++++++++++++++++
 .../streams/integration/ResetIntegrationTest.java  |   2 +-
 .../org/apache/kafka/tools/StreamsResetter.java    | 260 --------------------
 7 files changed, 273 insertions(+), 267 deletions(-)
f2405a73ea2dd4b636832b7f8729fb06a04de1d5

 bin/kafka-streams-application-reset.sh             |   2 +-
 build.gradle                                       |   2 -
 checkstyle/import-control-core.xml                 |   2 +
 checkstyle/import-control.xml                      |   4 +-
 .../main/scala/kafka/tools/StreamsResetter.java    | 268 +++++++++++++++++++++
 .../streams/integration/ResetIntegrationTest.java  |   2 +-
 .../org/apache/kafka/tools/StreamsResetter.java    | 260 --------------------
 7 files changed, 273 insertions(+), 267 deletions(-)
2a9f7af6c28ace1fc0bf8f64127e39b7ec13940a

 core/src/main/scala/kafka/log/LogCleanerManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
cd767aee45fd522fb8dbbd911a5a82fc0f9d2623

 clients/src/main/java/org/apache/kafka/common/cache/LRUCache.java   | 2 +-
 clients/src/main/java/org/apache/kafka/common/config/ConfigDef.java | 1 -
 clients/src/main/java/org/apache/kafka/common/protocol/Errors.java  | 2 +-
 3 files changed, 2 insertions(+), 3 deletions(-)
44ad3ec77364fab869cb5e01a182341bd0ae2698

 .../consumer/internals/ConsumerCoordinator.java    | 22 +++--
 .../kafka/api/AuthorizerIntegrationTest.scala      | 98 ++++++++++++++++++++--
 2 files changed, 110 insertions(+), 10 deletions(-)
31264f69796b5b2f803bb6daeac7ecd76acd6f99

 .../src/main/java/org/apache/kafka/clients/producer/ProducerConfig.java | 2 +-
 clients/src/main/java/org/apache/kafka/common/protocol/Protocol.java    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
77ced78f1bed75649c90eb659a055d00c2011a17

 .../apache/kafka/streams/integration/InternalTopicIntegrationTest.java  | 2 +-
 .../java/org/apache/kafka/streams/integration/JoinIntegrationTest.java  | 2 +-
 .../org/apache/kafka/streams/integration/WordCountIntegrationTest.java  | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
ab242337a8fa6fedf632edfc47cb9425a51d8bf3

 docs/streams.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
676a604d53cc35a3231d173a768b3f84ce108419

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
38c65a9a39081068e05e3222ccb0dbc3c9f56942

 .../kafka/streams/integration/ResetIntegrationTest.java   | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)
ad1dab9c3d3ae14746ee5d94434ef98ef4889023

 .../kafka/streams/integration/ResetIntegrationTest.java   | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)
0d96bc469e7ef9fca8eb67ba1fb756a0a515e1dd

 docs/upgrade.html | 29 ++++++++++++++++-------------
 1 file changed, 16 insertions(+), 13 deletions(-)
071b76cc50b4f79c839306f40eb84ee2b9724ab2

 docs/upgrade.html | 29 ++++++++++++++++-------------
 1 file changed, 16 insertions(+), 13 deletions(-)
11c47dd953b2a59b37de5719454c523db3f34411

 .../java/org/apache/kafka/clients/consumer/internals/Fetcher.java     | 3 +--
 .../java/org/apache/kafka/clients/consumer/internals/FetcherTest.java | 4 ++--
 2 files changed, 3 insertions(+), 4 deletions(-)
131f96868aa24f38f69ee2ab769ea3f289e5c1fc

 .../java/org/apache/kafka/clients/consumer/internals/Fetcher.java     | 3 +--
 .../java/org/apache/kafka/clients/consumer/internals/FetcherTest.java | 4 ++--
 2 files changed, 3 insertions(+), 4 deletions(-)
6e8c6f17f5ccdcc12f6d568a15af7c3ee893e22c

 release_notes.py | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
25f435098589d01f5cc514636f5be0dae8666611

 release_notes.py | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
ff557f02ac628edbe220ea69888d39de834527d3

 .../kafka/clients/consumer/internals/Fetcher.java  | 325 +++++++++++----------
 .../org/apache/kafka/common/record/Compressor.java |   4 +-
 .../common/record/InvalidRecordException.java      |   4 +-
 .../clients/consumer/internals/FetcherTest.java    | 153 ++++++++--
 4 files changed, 310 insertions(+), 176 deletions(-)
0ea953f59245492e4e0455a02c9bab041eeb58d1

 .../kafka/clients/consumer/internals/Fetcher.java  | 325 +++++++++++----------
 .../org/apache/kafka/common/record/Compressor.java |   4 +-
 .../common/record/InvalidRecordException.java      |   4 +-
 .../clients/consumer/internals/FetcherTest.java    | 153 ++++++++--
 4 files changed, 310 insertions(+), 176 deletions(-)
f1430d0e5c3f0c3fc8e4eee0dcc84789e6d61c63

 release_notes.py | 84 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 84 insertions(+)
b297cead3ef7ee3516590e696975071cadb06fba

 bin/kafka-streams-application-reset.sh             |  21 ++
 build.gradle                                       |   2 +
 checkstyle/import-control.xml                      |   5 +-
 .../org/apache/kafka/streams/KafkaStreams.java     |  96 +++++---
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 129 +++++++---
 .../streams/integration/ResetIntegrationTest.java  | 253 ++++++++++++++++++++
 .../utils/EmbeddedSingleNodeKafkaCluster.java      |   9 +-
 .../integration/utils/IntegrationTestUtils.java    | 133 ++++++-----
 .../streams/integration/utils/KafkaEmbedded.java   | 105 +++++----
 .../org/apache/kafka/tools/StreamsResetter.java    | 260 +++++++++++++++++++++
 10 files changed, 849 insertions(+), 164 deletions(-)
d5c821c198dcfbc69bd393c7725f93b22b479bca

 release_notes.py | 84 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 84 insertions(+)
8deedcacb68ff8ebae802e086ff706ad7e5f38e9

 bin/kafka-streams-application-reset.sh             |  21 ++
 build.gradle                                       |   2 +
 checkstyle/import-control.xml                      |   3 +
 .../org/apache/kafka/streams/KafkaStreams.java     |  96 +++++---
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 129 +++++++---
 .../streams/integration/ResetIntegrationTest.java  | 255 ++++++++++++++++++++
 .../utils/EmbeddedSingleNodeKafkaCluster.java      |   3 +-
 .../org/apache/kafka/tools/StreamsResetter.java    | 260 +++++++++++++++++++++
 8 files changed, 709 insertions(+), 60 deletions(-)
279f89a67c8e884a345ff88a4bde6399f48b2e64

 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d58c2d9ac6047b14ab22e19c9f7c857bb85a970d

 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
0a37bedd95aa883a00fbd19c4a86ab53aeb2fcb2

 .../kafka/common/network/ByteBufferSend.java       |  2 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |  2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala | 18 ++++-
 .../kafka/message/BaseMessageSetTestCases.scala    | 80 +++++++++++++++++++---
 .../kafka/message/ByteBufferMessageSetTest.scala   | 10 +++
 5 files changed, 96 insertions(+), 16 deletions(-)
64842f47f8ad21c942be2e2dd1edb56e3bc76cb8

 .../kafka/common/network/ByteBufferSend.java       |  2 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |  2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala | 18 ++++-
 .../kafka/message/BaseMessageSetTestCases.scala    | 80 +++++++++++++++++++---
 .../kafka/message/ByteBufferMessageSetTest.scala   | 10 +++
 5 files changed, 96 insertions(+), 16 deletions(-)
817f237683750c815036c09a0c0fa64d4f45bff7

 .../connect/storage/KafkaOffsetBackingStore.java   |  7 ++-
 .../storage/KafkaOffsetBackingStoreTest.java       | 71 ++++++++++++++++++++++
 2 files changed, 76 insertions(+), 2 deletions(-)
4059f07216a07db0cdd88b46db40914069171838

 .../connect/storage/KafkaOffsetBackingStore.java   |  7 ++-
 .../storage/KafkaOffsetBackingStoreTest.java       | 71 ++++++++++++++++++++++
 2 files changed, 76 insertions(+), 2 deletions(-)
1e1c164cfa58d225c38de9f8aea3c666a9464808

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)
801fee89d801e6d222c7b1b76a97847ecc9f10ff

 config/server.properties                                       | 1 +
 tests/kafkatest/__init__.py                                    | 1 -
 tests/kafkatest/benchmarks/core/__init__.py                    | 1 -
 tests/kafkatest/benchmarks/streams/__init__.py                 | 1 -
 tests/kafkatest/services/__init__.py                           | 1 -
 tests/kafkatest/services/kafka/config.py                       | 5 -----
 tests/kafkatest/services/kafka/templates/kafka.properties      | 3 +--
 tests/kafkatest/services/templates/console_consumer.properties | 1 -
 tests/kafkatest/services/templates/zookeeper.properties        | 3 +--
 tests/kafkatest/tests/__init__.py                              | 1 -
 tests/kafkatest/tests/client/__init__.py                       | 1 -
 tests/kafkatest/tests/connect/__init__.py                      | 1 -
 tests/kafkatest/tests/core/__init__.py                         | 1 -
 tests/kafkatest/tests/tools/__init__.py                        | 1 -
 tests/kafkatest/utils/__init__.py                              | 1 -
 tests/setup.py                                                 | 1 -
 vagrant/aws/aws-access-keys-commands                           | 1 -
 vagrant/aws/aws-example-Vagrantfile.local                      | 1 -
 vagrant/aws/aws-init.sh                                        | 1 -
 vagrant/system-test-Vagrantfile.local                          | 3 +--
 20 files changed, 4 insertions(+), 26 deletions(-)
dc93f3bf49564db4c453c7e0b65b462a5415a788

 .../org/apache/kafka/connect/tools/MockConnector.java |  7 +++++++
 .../org/apache/kafka/connect/tools/MockSinkTask.java  | 19 ++++++++++++++++++-
 .../apache/kafka/connect/tools/MockSourceTask.java    |  9 ++++++++-
 .../tests/connect/connect_distributed_test.py         |  2 +-
 4 files changed, 34 insertions(+), 3 deletions(-)
d1546960de0aa43989680a59c8f6b1ae7cb333e9

 .../org/apache/kafka/connect/tools/MockConnector.java |  7 +++++++
 .../org/apache/kafka/connect/tools/MockSinkTask.java  | 19 ++++++++++++++++++-
 .../apache/kafka/connect/tools/MockSourceTask.java    |  9 ++++++++-
 .../tests/connect/connect_distributed_test.py         |  2 +-
 4 files changed, 34 insertions(+), 3 deletions(-)
c47c3b0b583a849fdf3ed0a06835427a2801950a

 .../scala/kafka/message/ByteBufferMessageSet.scala | 69 +++++++++++-----------
 1 file changed, 34 insertions(+), 35 deletions(-)
8a417c89d2f0b7861b2dec26f02e4e302b64b604

 .../scala/kafka/message/ByteBufferMessageSet.scala | 69 +++++++++++-----------
 1 file changed, 34 insertions(+), 35 deletions(-)
aebab7cab6af88f777c1fb83604a1573554549a9

 .../java/org/apache/kafka/common/serialization/Deserializer.java  | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
6b1a6d9551fc44d80c7cffc0b4c21427da9d8fda

 .../java/org/apache/kafka/common/serialization/Deserializer.java  | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
17914453e35cc29396685b7fd7665918861b9805

 .../consumer/internals/SubscriptionState.java      |  1 +
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 60 ++++++++++++++++++++++
 .../consumer/internals/SubscriptionStateTest.java  |  2 +
 3 files changed, 63 insertions(+)
932bb84c837807eeca3600007ae3030561fdcb37

 .../consumer/internals/SubscriptionState.java      |  1 +
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 58 ++++++++++++++++++++++
 .../consumer/internals/SubscriptionStateTest.java  |  2 +
 3 files changed, 61 insertions(+)
24daae7d2703adffcbc90ab903916fa39601ce32

 core/src/main/scala/kafka/network/SocketServer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
fa32545442ef6724aa9fb5f4e0e269b0c873288f

 core/src/main/scala/kafka/network/SocketServer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
427e638517d2efedb7e7cb1387b1c59363cda21d

 .../test/java/org/apache/kafka/test/TestUtils.java |  3 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 41 ++++++----------------
 2 files changed, 12 insertions(+), 32 deletions(-)
1ef7672ed6333c02cb0fb8096e5a700b1ef38ce1

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
71a598a179ea9f1ee897d755b6daf9fb99860b50

 tests/kafkatest/tests/connect/connect_distributed_test.py | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)
f5df13627aaa6052a19e4cd7896e94730dac7f64

 tests/kafkatest/tests/connect/connect_distributed_test.py | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)
f1b37eec7422fde2e9240ff56b031b6958887176

 tests/kafkatest/benchmarks/streams/__init__.py            | 15 +++++++++++++++
 .../kafkatest/services/performance/streams_performance.py | 11 ++---------
 tests/kafkatest/tests/streams/__init__.py                 |  1 -
 3 files changed, 17 insertions(+), 10 deletions(-)
8a6ddf4c4eda7919e24a8ae2a7c6a199e4cd3791

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
44723caec74067aee9b06836b048465f4cffc431

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1ccab26a325e6ee23396049a24a5b6eb4b7a1c8e

 .../kafka/streams/kstream/KStreamBuilder.java      | 14 +++++++-----
 .../streams/kstream/internals/KTableImpl.java      | 11 +++++++---
 .../kafka/streams/processor/TopologyBuilder.java   | 16 +++++++++++++-
 .../streams/processor/internals/AbstractTask.java  |  3 ++-
 .../processor/internals/ProcessorStateManager.java | 25 ++++++++++++++++------
 .../processor/internals/ProcessorTopology.java     | 19 +++++++---------
 .../kstream/internals/KTableFilterTest.java        |  2 +-
 .../kstream/internals/KTableForeachTest.java       | 13 ++++++++++-
 .../streams/kstream/internals/KTableImplTest.java  |  6 +++---
 .../kstream/internals/KTableMapKeysTest.java       | 12 ++++++++++-
 .../kstream/internals/KTableSourceTest.java        |  2 +-
 .../internals/ProcessorStateManagerTest.java       | 12 +++++------
 .../processor/internals/StandbyTaskTest.java       | 10 +++++++--
 .../processor/internals/StreamTaskTest.java        |  3 ++-
 14 files changed, 104 insertions(+), 44 deletions(-)
933a7506efb57add31a1e9dbd984c1230128b855

 .../org/apache/kafka/streams/KafkaStreams.java     | 16 ++++++
 .../kafka/streams/processor/TopologyBuilder.java   | 15 ++++--
 .../streams/processor/internals/AbstractTask.java  | 27 ++++++++++
 .../streams/processor/internals/ProcessorNode.java | 17 ++++++
 .../processor/internals/ProcessorTopology.java     | 62 +++++++++++++++++++++-
 .../streams/processor/internals/SinkNode.java      |  9 ++++
 .../streams/processor/internals/SourceNode.java    | 19 ++++++-
 .../streams/processor/internals/StandbyTask.java   |  9 ++++
 .../streams/processor/internals/StreamTask.java    |  8 +++
 .../streams/processor/internals/StreamThread.java  | 33 ++++++++++++
 .../processor/internals/PartitionGroupTest.java    |  9 ++--
 .../processor/internals/RecordQueueTest.java       |  3 +-
 .../processor/internals/StandbyTaskTest.java       |  2 +
 .../processor/internals/StreamTaskTest.java        | 16 +++---
 .../java/org/apache/kafka/test/MockSourceNode.java |  4 +-
 15 files changed, 228 insertions(+), 21 deletions(-)
9991086671b0a74bc5fd5698ba81aaf9a2985404

 .../org/apache/kafka/streams/StreamsConfig.java    | 11 ++++++-
 .../kafka/streams/state/RocksDBConfigSetter.java   | 37 ++++++++++++++++++++++
 .../streams/state/internals/RocksDBStore.java      | 12 ++++++-
 .../streams/state/KeyValueStoreTestDriver.java     | 15 +++++++--
 .../state/internals/RocksDBKeyValueStoreTest.java  | 28 ++++++++++++++++
 .../StreamThreadStateStoreProviderTest.java        | 12 ++++++-
 .../apache/kafka/test/MockProcessorContext.java    |  4 +--
 7 files changed, 111 insertions(+), 8 deletions(-)
e293ed1458a1bc2118fe37ed6a6002ffe05e3ecf

 .../kafka/common/requests/LeaderAndIsrRequest.java | 19 ---------
 .../kafka/common/requests/PartitionState.java      | 46 ++++++++++++++++++++++
 .../common/requests/UpdateMetadataRequest.java     | 18 ---------
 .../kafka/common/requests/RequestResponseTest.java | 16 ++++----
 core/src/main/scala/kafka/cluster/Partition.scala  | 12 +++---
 .../controller/ControllerChannelManager.scala      |  5 ++-
 .../main/scala/kafka/server/MetadataCache.scala    |  3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 18 +++++----
 .../kafka/api/AuthorizerIntegrationTest.scala      |  4 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  3 +-
 .../unit/kafka/server/MetadataCacheTest.scala      |  4 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  7 ++--
 12 files changed, 81 insertions(+), 74 deletions(-)
0e5700fb68671f3fb75bfdeceda40e84330aca69

 .../kafka/common/requests/LeaderAndIsrRequest.java | 19 ---------
 .../kafka/common/requests/PartitionState.java      | 46 ++++++++++++++++++++++
 .../common/requests/UpdateMetadataRequest.java     | 18 ---------
 .../kafka/common/requests/RequestResponseTest.java | 16 ++++----
 core/src/main/scala/kafka/cluster/Partition.scala  | 12 +++---
 .../controller/ControllerChannelManager.scala      |  5 ++-
 .../main/scala/kafka/server/MetadataCache.scala    |  3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 18 +++++----
 .../kafka/api/AuthorizerIntegrationTest.scala      |  4 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  3 +-
 .../unit/kafka/server/MetadataCacheTest.scala      |  4 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  7 ++--
 12 files changed, 81 insertions(+), 74 deletions(-)
e5a0d139861b58589233e2bcd3a10e9fb032ddbc

 core/src/main/scala/kafka/server/KafkaServer.scala              | 4 +++-
 core/src/test/scala/unit/kafka/server/MetadataRequestTest.scala | 2 +-
 2 files changed, 4 insertions(+), 2 deletions(-)
039e89a6ebcf914f06d83b7277bb7fc209547cc1

 core/src/main/scala/kafka/log/FileMessageSet.scala |   2 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  31 +---
 .../unit/kafka/log/LogCleanerIntegrationTest.scala | 184 +++++++++++++++------
 3 files changed, 142 insertions(+), 75 deletions(-)
0d19f58850282d16c14fd4abd04663eae817d012

 core/src/main/scala/kafka/log/FileMessageSet.scala |   2 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  31 +---
 .../unit/kafka/log/LogCleanerIntegrationTest.scala | 184 +++++++++++++++------
 3 files changed, 142 insertions(+), 75 deletions(-)
9cad9dbdac273e8fe893b0cbe4f0f22d4271fb7b

 .../kafka/admin/ReassignPartitionsCommand.scala    | 45 +++++++++-------------
 .../scala/kafka/controller/KafkaController.scala   |  4 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  6 +--
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  2 +-
 4 files changed, 25 insertions(+), 32 deletions(-)
a7f9396b07a8be2e2e7d43a8ac31f39c66a0f8da
7bd06e9255544c3b9c536b6b9417e4bb52c830b3

 .../internals/InMemoryKeyValueLoggedStore.java     | 27 ++++++++---------
 .../internals/InMemoryKeyValueStoreSupplier.java   | 26 ++++++++++++++--
 .../internals/InMemoryLRUCacheStoreSupplier.java   | 15 +++-------
 .../streams/state/internals/MemoryLRUCache.java    | 35 +++++++++++++++++++---
 .../state/internals/MemoryNavigableLRUCache.java   | 10 +++----
 .../internals/RocksDBKeyValueStoreSupplier.java    |  4 ++-
 .../streams/state/internals/RocksDBStore.java      |  2 +-
 .../internals/RocksDBWindowStoreSupplier.java      |  4 ++-
 .../processor/internals/StandbyTaskTest.java       |  4 ---
 9 files changed, 84 insertions(+), 43 deletions(-)
72c6b7d84a6f1bdece804d7e42642b7505c4a4eb

 .../state/internals/StreamThreadStateStoreProviderTest.java    | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
14934157df7aaf5e9c37a302ef9fd9317b95efa4

 .../streams/processor/internals/AbstractTask.java  |  11 +-
 .../processor/internals/ProcessorStateManager.java |  69 +---
 .../streams/processor/internals/StandbyTask.java   |   6 +-
 .../processor/internals/StateDirectory.java        | 184 +++++++++
 .../streams/processor/internals/StreamTask.java    |   7 +-
 .../streams/processor/internals/StreamThread.java  |  67 +--
 .../internals/ProcessorStateManagerTest.java       | 454 ++++++++++-----------
 .../processor/internals/StandbyTaskTest.java       | 258 ++++++------
 .../processor/internals/StateDirectoryTest.java    | 169 ++++++++
 .../processor/internals/StreamTaskTest.java        | 268 ++++++------
 .../processor/internals/StreamThreadTest.java      |  11 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   3 +-
 12 files changed, 850 insertions(+), 657 deletions(-)
0bb1d3ae53fc3f80fb096369951187630519eb04

 build.gradle | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
cfebfdfa5e537946e4c6e1cc986f20131899be31

 build.gradle | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
f1dd0d272313deceaf7021e54c09a63043acf4af

 .../org/apache/kafka/streams/KafkaStreams.java     |  31 +++
 .../apache/kafka/streams/processor/StateStore.java |   6 +
 .../streams/processor/internals/AbstractTask.java  |   3 +
 .../streams/processor/internals/StreamThread.java  |   5 +-
 .../apache/kafka/streams/state/KeyValueStore.java  |  38 +--
 .../kafka/streams/state/QueryableStoreType.java    |  48 ++++
 .../kafka/streams/state/QueryableStoreTypes.java   |  90 ++++++++
 .../kafka/streams/state/ReadOnlyKeyValueStore.java |  66 ++++++
 .../kafka/streams/state/ReadOnlyWindowStore.java   |  36 +++
 .../apache/kafka/streams/state/WindowStore.java    |   9 +-
 .../internals/CompositeReadOnlyKeyValueStore.java  | 145 ++++++++++++
 .../internals/CompositeReadOnlyWindowStore.java    |  74 ++++++
 .../internals/InMemoryKeyValueLoggedStore.java     |   5 +
 .../internals/InMemoryKeyValueStoreSupplier.java   |  26 ++-
 .../internals/InvalidStateStoreException.java      |  27 +++
 .../streams/state/internals/MemoryLRUCache.java    |  34 +--
 .../state/internals/MemoryNavigableLRUCache.java   |  42 ++--
 .../state/internals/MeteredKeyValueStore.java      |   5 +
 .../state/internals/MeteredWindowStore.java        |   5 +
 .../state/internals/QueryableStoreProvider.java    |  54 +++++
 .../streams/state/internals/RocksDBStore.java      |  48 ++--
 .../state/internals/RocksDBWindowStore.java        | 135 +++++++----
 .../state/internals/StateStoreProvider.java        |  41 ++++
 .../internals/StreamThreadStateStoreProvider.java  |  53 +++++
 .../streams/state/internals/WindowStoreUtils.java  |   3 -
 .../state/internals/WrappingStoreProvider.java     |  55 +++++
 .../integration/QueryableStateIntegrationTest.java | 256 +++++++++++++++++++++
 .../kafka/streams/state/NoOpWindowStore.java       |  58 +++++
 .../CompositeReadOnlyKeyValueStoreTest.java        | 199 ++++++++++++++++
 .../CompositeReadOnlyWindowStoreTest.java          | 114 +++++++++
 .../state/internals/InMemoryKeyValueStore.java     | 146 ++++++++++++
 .../state/internals/InMemoryLRUCacheStoreTest.java |   2 +-
 .../internals/QueryableStoreProviderTest.java      |  75 ++++++
 .../state/internals/ReadOnlyWindowStoreStub.java   | 113 +++++++++
 .../state/internals/RocksDBWindowStoreTest.java    |  45 +++-
 .../state/internals/StateStoreProviderStub.java    |  43 ++++
 .../state/internals/StateStoreTestUtils.java       | 125 ++++++++++
 .../StreamThreadStateStoreProviderTest.java        | 211 +++++++++++++++++
 .../state/internals/WrappingStoreProviderTest.java |  71 ++++++
 .../apache/kafka/test/MockStateStoreSupplier.java  |   5 +
 40 files changed, 2380 insertions(+), 167 deletions(-)
e9a1d69edd8302b584e9b6c813807a1a5447f2be

 .../org/apache/kafka/streams/kstream/internals/AbstractStream.java  | 6 ++++++
 1 file changed, 6 insertions(+)
b418922a3b48bef9d890abb471908ab2a8aeba18

 .../org/apache/kafka/streams/kstream/internals/AbstractStream.java  | 6 ++++++
 1 file changed, 6 insertions(+)
6ec48c1a87d898168a5ec605bd77e76ce1369f88

 .../kafka/streams/processor/TopologyBuilder.java   | 38 +++++++++++-----------
 1 file changed, 19 insertions(+), 19 deletions(-)
114945cb6297f909a7b1272bd61e17b662d42d24

 .../kafka/streams/processor/TopologyBuilder.java   | 46 +++++++++++-----------
 1 file changed, 23 insertions(+), 23 deletions(-)
e0fa9c2e50d3b37701dac9d0c1a82d430fb47822

 docs/ops.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0744449eaa0f80827b60f2be3a5a2cc306360ce7

 docs/ops.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b670790bc67de08bcd23806cd63c2454c3675664

 .../apache/kafka/clients/producer/ProducerConfig.java    | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)
7354cc1f487cea5c0422c8e80c3aed244321dbfd

 .../apache/kafka/clients/producer/ProducerConfig.java    | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)
61c568d8391de6fceb6c8d6a33d349def8d2ada8

 .../apache/kafka/streams/perf/SimpleBenchmark.java |  14 ++-
 .../streams/streams_simple_benchmark_test.py       |  43 +++++++
 .../services/performance/streams_performance.py    | 132 +++++++++++++++++++++
 3 files changed, 184 insertions(+), 5 deletions(-)
fbc5185543fd4895c7c81ff55b3c8b4c25ac7600

 .../examples/pageview/PageViewTypedDemo.java       |  5 +-
 .../examples/pageview/PageViewUntypedDemo.java     |  5 +-
 .../apache/kafka/streams/kstream/JoinWindows.java  | 13 ++--
 .../kafka/streams/kstream/KGroupedStream.java      | 55 ++++++++++++----
 .../kafka/streams/kstream/KGroupedTable.java       | 32 ++++++---
 .../org/apache/kafka/streams/kstream/KStream.java  | 25 ++++++-
 .../kafka/streams/kstream/KStreamBuilder.java      | 17 +++--
 .../org/apache/kafka/streams/kstream/KTable.java   | 46 +++++++++----
 .../apache/kafka/streams/kstream/TimeWindows.java  | 12 ++--
 .../kafka/streams/kstream/UnlimitedWindows.java    | 11 ++--
 .../org/apache/kafka/streams/kstream/Windows.java  | 12 +---
 .../kstream/internals/KGroupedStreamImpl.java      | 52 ++++++++-------
 .../kstream/internals/KGroupedTableImpl.java       | 28 ++++----
 .../streams/kstream/internals/KStreamImpl.java     | 66 ++++++++++---------
 .../streams/kstream/internals/KTableImpl.java      | 77 ++++++++++++----------
 .../streams/kstream/internals/KTableSource.java    | 12 ++--
 .../internals/KTableSourceValueGetterSupplier.java |  8 +--
 .../KStreamAggregationIntegrationTest.java         |  8 +--
 .../KStreamKTableJoinIntegrationTest.java          |  3 +-
 .../integration/KStreamRepartitionJoinTest.java    | 14 ++--
 .../kafka/streams/kstream/JoinWindowsTest.java     | 37 ++++-------
 .../kafka/streams/kstream/TimeWindowsTest.java     | 36 ++++------
 .../streams/kstream/UnlimitedWindowsTest.java      | 21 ++----
 .../streams/kstream/internals/KStreamImplTest.java |  4 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  | 10 ++-
 .../internals/KStreamKStreamLeftJoinTest.java      |  8 +--
 .../internals/KStreamKTableLeftJoinTest.java       |  2 +-
 .../internals/KStreamWindowAggregateTest.java      | 12 ++--
 .../kstream/internals/KTableAggregateTest.java     |  6 +-
 .../kstream/internals/KTableFilterTest.java        | 10 +--
 .../kstream/internals/KTableForeachTest.java       |  3 +-
 .../streams/kstream/internals/KTableImplTest.java  | 29 +++++---
 .../kstream/internals/KTableKTableJoinTest.java    | 14 ++--
 .../internals/KTableKTableLeftJoinTest.java        | 14 ++--
 .../internals/KTableKTableOuterJoinTest.java       | 14 ++--
 .../kstream/internals/KTableMapKeysTest.java       |  5 +-
 .../kstream/internals/KTableMapValuesTest.java     | 14 ++--
 .../kstream/internals/KTableSourceTest.java        | 11 ++--
 .../kafka/streams/smoketest/SmokeTestClient.java   | 24 +++----
 39 files changed, 431 insertions(+), 344 deletions(-)
c9f930e3fe25e5675e64550c8b396356c5349ca7

 core/src/main/scala/kafka/tools/VerifyConsumerRebalance.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
df562ad21ca4dad58b0eb6028d0e3d631eccfbc6

 core/src/main/scala/kafka/tools/VerifyConsumerRebalance.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
dfd5946d885d7c9ee796a013672dab16e3ccb7d3

 core/src/main/scala/kafka/tools/VerifyConsumerRebalance.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
7a70c1a1087ca78d5e6db3908f6d6b6b19e8aaab

 core/src/main/scala/kafka/tools/VerifyConsumerRebalance.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
9f94a7752a590c36186a7eb1eee16e992ec68c97

 .../kafka/clients/consumer/KafkaConsumer.java      |  41 +++++++--
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 102 +++++++++++++++++++++
 2 files changed, 136 insertions(+), 7 deletions(-)
78bd89786f1cc8d7e2be4428307450c265aef7a0

 .../internals/InMemoryKeyValueLoggedStore.java     | 31 ++++++++-----------
 .../internals/InMemoryKeyValueStoreSupplier.java   | 26 ++++++++++++++--
 .../internals/InMemoryLRUCacheStoreSupplier.java   | 15 +++-------
 .../streams/state/internals/MemoryLRUCache.java    | 35 +++++++++++++++++++---
 .../state/internals/MemoryNavigableLRUCache.java   | 10 +++----
 .../internals/RocksDBKeyValueStoreSupplier.java    |  4 ++-
 .../streams/state/internals/RocksDBStore.java      |  2 +-
 .../internals/RocksDBWindowStoreSupplier.java      |  4 ++-
 .../processor/internals/StandbyTaskTest.java       |  4 ---
 9 files changed, 84 insertions(+), 47 deletions(-)
f17790cd9952aecef67fbec58122c55c72e5c2b2

 .../internals/InMemoryKeyValueLoggedStore.java     | 31 ++++++++-----------
 .../internals/InMemoryKeyValueStoreSupplier.java   | 26 ++++++++++++++--
 .../internals/InMemoryLRUCacheStoreSupplier.java   | 15 +++-------
 .../streams/state/internals/MemoryLRUCache.java    | 35 +++++++++++++++++++---
 .../state/internals/MemoryNavigableLRUCache.java   | 10 +++----
 .../internals/RocksDBKeyValueStoreSupplier.java    |  4 ++-
 .../streams/state/internals/RocksDBStore.java      |  2 +-
 .../internals/RocksDBWindowStoreSupplier.java      |  4 ++-
 .../processor/internals/StandbyTaskTest.java       |  4 ---
 9 files changed, 84 insertions(+), 47 deletions(-)
3c0a0377eb26cfda540fdc2f2ccaca7bb50bab60

 .../test/java/org/apache/kafka/streams/smoketest/SmokeTestDriver.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
3537063a52b97b6d46f6bd17e3f03e1b03630a3e

 .../test/java/org/apache/kafka/streams/smoketest/SmokeTestDriver.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
28c55d040b04249e09a22d4a1f9cd42f72eaa5c1

 .../clients/consumer/internals/ConsumerCoordinator.java      | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)
98dfc4b307c2e41a7fb0fff330048aa9ff78addd

 .../clients/consumer/internals/ConsumerCoordinator.java      | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)
fc47b9fa6b89a612cd0f79dfc689ee3813fd405a

 .../errors/InvalidConfigurationException.java      |  31 +++
 .../common/errors/InvalidPartitionsException.java  |  31 +++
 .../errors/InvalidReplicaAssignmentException.java  |  31 +++
 .../errors/InvalidReplicationFactorException.java  |  31 +++
 .../common/errors/InvalidRequestException.java     |  36 ++++
 .../common/errors/NotControllerException.java      |  28 +++
 .../kafka/common/errors/TopicExistsException.java  |  31 +++
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   5 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  24 ++-
 .../org/apache/kafka/common/protocol/Protocol.java |  46 ++++
 .../kafka/common/requests/AbstractRequest.java     |   4 +-
 .../kafka/common/requests/CreateTopicsRequest.java | 231 ++++++++++++++++++++
 .../common/requests/CreateTopicsResponse.java      |  96 +++++++++
 .../kafka/common/requests/RequestResponseTest.java |  30 ++-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  19 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |   6 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |   3 -
 .../src/main/scala/kafka/common/ErrorMapping.scala |   9 +
 .../scala/kafka/common/InvalidTopicException.scala |  22 --
 .../scala/kafka/common/TopicExistsException.scala  |  22 --
 core/src/main/scala/kafka/log/LogConfig.scala      |   7 +-
 .../kafka/network/InvalidRequestException.scala    |  24 ---
 .../main/scala/kafka/network/RequestChannel.scala  |   5 +-
 .../main/scala/kafka/network/SocketServer.scala    |   1 +
 .../src/main/scala/kafka/server/AdminManager.scala | 114 ++++++++++
 .../scala/kafka/server/DelayedCreateTopics.scala   |  91 ++++++++
 .../scala/kafka/server/DelayedOperationKey.scala   |   6 +
 core/src/main/scala/kafka/server/KafkaApis.scala   |  53 ++++-
 core/src/main/scala/kafka/server/KafkaServer.scala |   5 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  22 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  12 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |   4 +-
 .../unit/kafka/server/ApiVersionsRequestTest.scala |   4 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |  46 +++-
 .../kafka/server/CreateTopicsRequestTest.scala     | 233 +++++++++++++++++++++
 .../unit/kafka/server/MetadataRequestTest.scala    |   2 +-
 .../unit/kafka/server/ProduceRequestTest.scala     |   5 +-
 .../kafka/server/SaslApiVersionsRequestTest.scala  |   4 +-
 38 files changed, 1250 insertions(+), 124 deletions(-)
136a8fabca8e266f67897cf5471b2e41c0a341be

 .../integration/InternalTopicIntegrationTest.java  |  14 +-
 .../streams/integration/JoinIntegrationTest.java   | 259 -----------
 .../integration/KGroupedStreamIntegrationTest.java | 472 ---------------------
 .../KStreamAggregationIntegrationTest.java         | 466 ++++++++++++++++++++
 .../KStreamKTableJoinIntegrationTest.java          | 258 +++++++++++
 .../integration/KStreamRepartitionJoinTest.java    |  69 +--
 .../integration/MapFunctionIntegrationTest.java    | 122 ------
 .../integration/PassThroughIntegrationTest.java    | 108 -----
 .../integration/WordCountIntegrationTest.java      | 154 -------
 .../kstream/internals/KGroupedTableImplTest.java   |  79 ----
 .../kstream/internals/KTableAggregateTest.java     |  57 ++-
 .../kstream/internals/KTableSourceTest.java        |   4 +-
 .../org/apache/kafka/test/MockKeyValueMapper.java  |  23 +-
 13 files changed, 808 insertions(+), 1277 deletions(-)
c439268224e3178002bfa28bc048722870f992e3

 build.gradle                                       |  3 ++
 .../kafka/clients/producer/KafkaProducer.java      | 41 +++++++++-----
 .../kafka/clients/producer/KafkaProducerTest.java  | 62 ++++++++++++++++++++++
 3 files changed, 93 insertions(+), 13 deletions(-)
383cec9cf38607cdfbda0256d3447d253dcdde7d

 .../org/apache/kafka/streams/integration/JoinIntegrationTest.java | 5 -----
 .../kafka/streams/integration/WordCountIntegrationTest.java       | 8 ++------
 .../kafka/streams/integration/utils/IntegrationTestUtils.java     | 5 +++--
 streams/src/test/java/org/apache/kafka/test/StreamsTestUtils.java | 2 +-
 4 files changed, 6 insertions(+), 14 deletions(-)
bc805bf2a63e52132f2273bfb601a071515ccea9

 docs/ops.html | 20 ++++++++++++++++----
 1 file changed, 16 insertions(+), 4 deletions(-)
e0eaa7f12e5e90b61b6793301053acad50cbd9ab

 docs/ops.html | 20 ++++++++++++++++----
 1 file changed, 16 insertions(+), 4 deletions(-)
f8a7ace9d4e508d29d664418446c37783a82cb3b

 .../apache/kafka/connect/runtime/WorkerConfig.java | 24 ++++++++++++++++++----
 1 file changed, 20 insertions(+), 4 deletions(-)
2dfbf4b5fdd7698a83a1c3d078a846f3674235f4

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)
a5da2a4f4c3b9d1917cbafc0e79d8e8318f7cbff

 core/src/main/scala/kafka/network/SocketServer.scala                | 2 +-
 core/src/test/scala/integration/kafka/api/ConsumerBounceTest.scala  | 2 +-
 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java | 4 ++--
 3 files changed, 4 insertions(+), 4 deletions(-)
c2459d3251cec538755b08ac35a742df5e3f2a76

 docs/design.html | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)
4b5ed36c2264808c33f92ccfdc456a19af3471bd

 .../src/main/java/org/apache/kafka/common/config/AbstractConfig.java  | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
0edaa89be35ad427b848e0d91164422871853640

 .../scala/kafka/tools/ConsumerPerformance.scala    | 49 ++++++++++++----------
 core/src/main/scala/kafka/tools/PerfConfig.scala   |  4 +-
 2 files changed, 29 insertions(+), 24 deletions(-)
542350d616e4638958d133d1d5599acf8546ed06

 .../kafka/connect/runtime/AbstractHerder.java      |   6 +-
 .../kafka/connect/tools/SchemaSourceConnector.java |  68 ++++++++
 .../kafka/connect/tools/SchemaSourceTask.java      | 174 +++++++++++++++++++++
 .../resources/ConnectorPluginsResourceTest.java    |   2 +
 4 files changed, 248 insertions(+), 2 deletions(-)
4c502ed83dc4ec3455875e6b13486719d689211e

 .../apache/kafka/streams/kstream/internals/KTableRepartitionMap.java | 5 +++--
 .../test/java/org/apache/kafka/streams/smoketest/SmokeTestUtil.java  | 2 +-
 2 files changed, 4 insertions(+), 3 deletions(-)
730bf9a37a08b2ca41dcda52d2c70e92e85980f7

 .../apache/kafka/streams/kstream/internals/KTableRepartitionMap.java | 5 +++--
 .../test/java/org/apache/kafka/streams/smoketest/SmokeTestUtil.java  | 2 +-
 2 files changed, 4 insertions(+), 3 deletions(-)
efc4c88811c93d11eeffe61310b7f8652ca73ceb

 .../integration/RegexSourceIntegrationTest.java    | 60 +++++++++++++---------
 1 file changed, 37 insertions(+), 23 deletions(-)
ded91fbce5c58e5bcc5a178e65a8652f88e1493d

 .../internals/InMemoryKeyValueLoggedStore.java      |  8 ++++++--
 .../kafka/streams/state/internals/RocksDBStore.java | 21 +++++++++++++++------
 2 files changed, 21 insertions(+), 8 deletions(-)
7218648ae7ac1ce93f3ff25702b99c3af236fd0f

 .../internals/InMemoryKeyValueLoggedStore.java      |  8 ++++++--
 .../kafka/streams/state/internals/RocksDBStore.java | 21 +++++++++++++++------
 2 files changed, 21 insertions(+), 8 deletions(-)
b64302f9cea0e3e95d740cbe7bbd4c64e147301c

 .../org/apache/kafka/streams/kstream/KStream.java  | 71 +++++++++++++++++++---
 .../org/apache/kafka/streams/kstream/KTable.java   | 54 +++++++++++++++-
 .../streams/kstream/internals/KStreamImpl.java     | 34 +++++++++--
 .../streams/kstream/internals/KTableImpl.java      | 34 +++++++++--
 .../streams/kstream/internals/KeyValuePrinter.java | 24 ++++----
 .../internals/KeyValuePrinterProcessorTest.java    | 32 ++++++++--
 6 files changed, 213 insertions(+), 36 deletions(-)
a462ebf2f8317f22a371b0c681a3600dab16458c

 core/src/main/scala/kafka/log/FileMessageSet.scala | 20 ++++---
 .../scala/unit/kafka/log/FileMessageSetTest.scala  | 67 +++++++++++++++++++++-
 2 files changed, 79 insertions(+), 8 deletions(-)
15e008783cf73dcaed851fe6cc587767031886e5

 core/src/main/scala/kafka/log/FileMessageSet.scala | 20 ++++---
 .../scala/unit/kafka/log/FileMessageSetTest.scala  | 67 +++++++++++++++++++++-
 2 files changed, 79 insertions(+), 8 deletions(-)
9d1c2daa5c416f614f3c9fcdc1641cef265f8efa

 streams/src/main/java/org/apache/kafka/streams/kstream/Windows.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
dca263b4e00b00983a4b9f74517b25b01492a4c6

 streams/src/main/java/org/apache/kafka/streams/kstream/Windows.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
416c3a7d97d473d0d9928c814d68d502c21077b7

 .../src/main/java/org/apache/kafka/streams/kstream/KStream.java   | 8 +++-----
 .../org/apache/kafka/streams/kstream/internals/KStreamImpl.java   | 6 +++---
 2 files changed, 6 insertions(+), 8 deletions(-)
12fa188b9aaeafa337c813f4a84a3117d6bf403f

 .../streams/kstream/internals/AbstractStream.java     | 14 ++++++--------
 .../kafka/streams/kstream/internals/KStreamImpl.java  | 19 +++++++++----------
 2 files changed, 15 insertions(+), 18 deletions(-)
00d5becbadd397a595072f91fc687182fe41543a

 docs/quickstart.html | 29 ++++++++++++++++++++++-------
 1 file changed, 22 insertions(+), 7 deletions(-)
87b3ce16c05eb105f1ee0da26b090e02b6c18678

 docs/quickstart.html | 28 ++++++++++++++++++++++------
 1 file changed, 22 insertions(+), 6 deletions(-)
cdf019a8249f95bb0080202b6f806a292a9dc8ef

 .../kafka/clients/consumer/KafkaConsumer.java      |  1 +
 .../consumer/internals/SubscriptionState.java      | 41 ++++++++---
 .../kafka/api/PlaintextConsumerTest.scala          | 83 +++++++++++++++++++++-
 3 files changed, 113 insertions(+), 12 deletions(-)
d7de59a579af5ba4ecb1aec8fed84054f8b86443

 .../kafka/clients/consumer/KafkaConsumer.java      |  1 +
 .../consumer/internals/SubscriptionState.java      | 41 ++++++++---
 .../kafka/api/PlaintextConsumerTest.scala          | 83 +++++++++++++++++++++-
 3 files changed, 113 insertions(+), 12 deletions(-)
31b4460cf9a520bd019ed98949ebfa9243e6e4a6

 .../java/org/apache/kafka/common/security/kerberos/KerberosLogin.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0f8b6790351cb6b078ad3ec73e8d36f5bb3ad270

 docs/ops.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f1323d4ffa451b8c7965d51f422f0933f35ff828

 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
32e24b7c28e357c051bbe21b08c4e8c6d45a3907

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java   | 1 -
 1 file changed, 1 deletion(-)
7b01f848a03d7f93a89012bf58fe40fb96c42247

 .../streams/kstream/internals/KTableFilter.java    |  3 ++
 .../kstream/internals/KTableFilterTest.java        | 39 ++++++++++++++++++++--
 .../apache/kafka/test/MockProcessorSupplier.java   |  6 ++++
 3 files changed, 46 insertions(+), 2 deletions(-)
2098529b44cad78731e478aa8af2b49e9c94db7d

 .../streams/kstream/internals/KTableFilter.java    |  3 ++
 .../kstream/internals/KTableFilterTest.java        | 39 ++++++++++++++++++++--
 .../apache/kafka/test/MockProcessorSupplier.java   |  6 ++++
 3 files changed, 46 insertions(+), 2 deletions(-)
5a97304170a697cb08f1c8d455d6661a37f92196

 vagrant/aws/aws-init.sh | 3 +--
 vagrant/base.sh         | 3 +--
 vagrant/broker.sh       | 3 +--
 vagrant/vagrant-up.sh   | 3 +--
 vagrant/zk.sh           | 3 +--
 5 files changed, 5 insertions(+), 10 deletions(-)
29c3c4ba05a7cd2085811ff7cd438d527f82c58d

 tests/kafkatest/services/kafka/kafka.py            | 13 ++++---
 .../services/kafka/templates/kafka.properties      |  4 +--
 tests/kafkatest/services/security/minikdc.py       |  2 +-
 .../kafkatest/services/security/security_config.py | 40 +++++++++++++---------
 tests/kafkatest/services/zookeeper.py              |  3 +-
 .../tests/core/zookeeper_security_upgrade_test.py  |  2 +-
 6 files changed, 36 insertions(+), 28 deletions(-)
7edaa3dd89d1a7300a12e101e23f66459a9cc33d

 tests/kafkatest/services/kafka/kafka.py            | 13 ++++---
 .../services/kafka/templates/kafka.properties      |  4 +--
 tests/kafkatest/services/security/minikdc.py       |  2 +-
 .../kafkatest/services/security/security_config.py | 40 +++++++++++++---------
 tests/kafkatest/services/zookeeper.py              |  3 +-
 .../tests/core/zookeeper_security_upgrade_test.py  |  2 +-
 6 files changed, 36 insertions(+), 28 deletions(-)
44ad7b574e376f958cf1d3893156d666f904cdd3

 .../kafka/connect/connector/ConnectRecord.java     | 19 +++++--
 .../org/apache/kafka/connect/sink/SinkRecord.java  | 21 +++++++-
 .../apache/kafka/connect/source/SourceRecord.java  | 10 +++-
 .../kafka/connect/runtime/WorkerSinkTask.java      |  5 +-
 .../kafka/connect/runtime/WorkerSourceTask.java    |  6 +--
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 59 +++++++++++++++++++++-
 .../runtime/WorkerSinkTaskThreadedTest.java        |  9 ++--
 .../connect/runtime/WorkerSourceTaskTest.java      | 21 ++++++++
 8 files changed, 133 insertions(+), 17 deletions(-)
3ff68ef6c9da82bf4e69bb37ca2f1cd7403e59dd

 .../processor/internals/RecordCollector.java       | 29 ++++++++++++----------
 1 file changed, 16 insertions(+), 13 deletions(-)
3605ffa30602ebf9373b47f92f2a9f399a4a36db

 .../processor/internals/RecordCollector.java       | 31 +++++++++++-----------
 1 file changed, 16 insertions(+), 15 deletions(-)
7d6b416f9e75f1d9f886b9b43637c488667222e1

 .../kafka/streams/processor/ProcessorContext.java  | 24 ++++++++++++++++++++++
 .../processor/internals/ProcessorContextImpl.java  | 13 ++++++++++++
 .../processor/internals/StandbyContextImpl.java    | 13 ++++++++++++
 .../streams/state/KeyValueStoreTestDriver.java     | 10 +++++++++
 .../apache/kafka/test/MockProcessorContext.java    | 10 +++++++++
 5 files changed, 70 insertions(+)
7e9f5a7ee6dfe22107c8cc3c9f57daa288d6c392

 .../apache/kafka/streams/kstream/JoinWindows.java  | 14 ++++------
 .../kafka/streams/kstream/JoinWindowsTest.java     | 32 ++++++++++++++--------
 2 files changed, 26 insertions(+), 20 deletions(-)
4091a13c5a3ef4805590357ab872333798a1bbe8

 .../apache/kafka/streams/kstream/JoinWindows.java  | 16 ++++++--
 .../kafka/streams/kstream/JoinWindowsTest.java     | 48 +++++++++++-----------
 .../streams/kstream/internals/KStreamImplTest.java |  4 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  |  6 +--
 .../internals/KStreamKStreamLeftJoinTest.java      |  6 ++-
 5 files changed, 46 insertions(+), 34 deletions(-)
6ba0aaaedfe39069ecd8826b73c5a530a529faeb

 .../java/org/apache/kafka/streams/kstream/JoinWindows.java  | 13 ++-----------
 .../org/apache/kafka/streams/kstream/JoinWindowsTest.java   |  4 ++--
 2 files changed, 4 insertions(+), 13 deletions(-)
9dc5dc461ea4fcaf4f429cfb6c83b4fd6284921f

 .../apache/kafka/streams/kstream/JoinWindows.java  | 21 ++++++++------
 .../kafka/streams/kstream/JoinWindowsTest.java     | 32 ++++++++++++++--------
 2 files changed, 34 insertions(+), 19 deletions(-)
73e2f090c58873d19d0fd8b568d733ec84effb92

 .../internals/assignment/ClientState.java          | 10 +++++++++
 .../internals/assignment/TaskAssignor.java         | 26 ++++++++++++++++++++++
 2 files changed, 36 insertions(+)
a34f78dcad1d7844a21d0afbf0f6eef183847d0d

 .../internals/assignment/ClientState.java          | 10 +++++++++
 .../internals/assignment/TaskAssignor.java         | 26 ++++++++++++++++++++++
 2 files changed, 36 insertions(+)
96ae0a5929bcd784dc632ddadf083bbedababbb6

 .../test/java/org/apache/kafka/test/TestUtils.java | 50 +++++++++++++---------
 .../integration/InternalTopicIntegrationTest.java  |  2 +-
 .../streams/integration/JoinIntegrationTest.java   |  2 +-
 .../integration/KGroupedStreamIntegrationTest.java |  2 +-
 .../integration/KStreamRepartitionJoinTest.java    |  2 +-
 .../integration/RegexSourceIntegrationTest.java    | 19 ++++----
 .../integration/utils/IntegrationTestUtils.java    | 17 ++------
 .../processor/internals/ProcessorTopologyTest.java |  2 +-
 .../streams/state/KeyValueStoreTestDriver.java     |  2 +-
 9 files changed, 49 insertions(+), 49 deletions(-)
cf03f349caa92592ec42c7864b7f9d9ef21fee94

 .../main/scala/kafka/controller/KafkaController.scala    |  1 -
 core/src/main/scala/kafka/server/BrokerStates.scala      | 16 +++++++---------
 docs/upgrade.html                                        |  6 ++++++
 3 files changed, 13 insertions(+), 10 deletions(-)
10abe858bd892863f1d01c29bfb6d0f4206de2d3

 .../streams/integration/KStreamRepartitionJoinTest.java | 17 ++++++++++++-----
 1 file changed, 12 insertions(+), 5 deletions(-)
f630cc79ac5d57b3ee4e948c36bb08ad96333923

 .../org/apache/kafka/streams/processor/PartitionGrouper.java   | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)
0e0b632b926f52451495ab254e74ab87848cb353

 .../org/apache/kafka/streams/processor/PartitionGrouper.java   | 10 ++++++++--
 1 file changed, 8 insertions(+), 2 deletions(-)
54f9a7012c05f3e2993463727d7e199e8589e68e

 .../src/main/java/org/apache/kafka/connect/json/JsonConverter.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
88924b03d511132212ee5d8dec02063deb8313f1

 .../java/org/apache/kafka/test/TestCondition.java  | 26 ++++++
 .../test/java/org/apache/kafka/test/TestUtils.java | 65 +++++++++++++++
 .../integration/InternalTopicIntegrationTest.java  |  4 +-
 .../streams/integration/JoinIntegrationTest.java   |  4 +-
 .../integration/KGroupedStreamIntegrationTest.java |  3 +-
 .../integration/KStreamRepartitionJoinTest.java    |  3 +-
 .../integration/RegexSourceIntegrationTest.java    | 92 +++++++++-------------
 .../integration/utils/IntegrationTestUtils.java    | 69 ++++++++++------
 .../processor/internals/ProcessorTopologyTest.java |  4 +-
 .../streams/state/KeyValueStoreTestDriver.java     |  3 +-
 .../apache/kafka/streams/state/StateTestUtils.java | 79 -------------------
 .../org/apache/kafka/test/StreamsTestUtils.java    | 56 +++++++++++++
 12 files changed, 236 insertions(+), 172 deletions(-)
cc884ee6a264d3552a99876b199d09bb3d640839

 .../java/org/apache/kafka/common/record/MemoryRecords.java    |  5 ++++-
 .../org/apache/kafka/common/record/MemoryRecordsTest.java     | 11 +++++++++++
 2 files changed, 15 insertions(+), 1 deletion(-)
ef42c224a701161a15e046de73c11982024bbc53

 .../unit/kafka/server/SessionExpireListenerTest.scala     | 15 ++++++++++-----
 1 file changed, 10 insertions(+), 5 deletions(-)
a06448b9b1131c3193c7ba8394035c81580772c2

 docs/quickstart.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6cd031e7cf189ed7748c5c62fc17dc097dcfde18

 docs/quickstart.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e467394a85471fbcf439cf90c7e0591161815789

 .../java/org/apache/kafka/streams/state/internals/RocksDBStore.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
41a54358bececc42ba680267281ba01b3f33f77f

 .../java/org/apache/kafka/streams/state/internals/RocksDBStore.java     | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b669b2786c69d2dfa719033eb7c02ac444f115f4

 .../apache/kafka/streams/kstream/JoinWindows.java  | 20 +++--
 .../kafka/streams/kstream/JoinWindowsTest.java     | 99 ++++++++++++++++++++++
 .../kafka/streams/kstream/TimeWindowsTest.java     | 30 +++----
 .../streams/kstream/internals/KStreamImplTest.java |  5 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  |  9 +-
 .../internals/KStreamKStreamLeftJoinTest.java      |  6 +-
 6 files changed, 140 insertions(+), 29 deletions(-)
8ec4e4b7a37164a1189a74815decb1d6f6410963

 .../apache/kafka/streams/kstream/JoinWindows.java  | 20 +++--
 .../integration/KStreamRepartitionJoinTest.java    | 11 ++-
 .../kafka/streams/kstream/JoinWindowsTest.java     | 99 ++++++++++++++++++++++
 .../kafka/streams/kstream/TimeWindowsTest.java     | 30 +++----
 .../streams/kstream/internals/KStreamImplTest.java |  5 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  |  9 +-
 .../internals/KStreamKStreamLeftJoinTest.java      |  8 +-
 7 files changed, 145 insertions(+), 37 deletions(-)
36f8de32414585c95aa6e8ff159cc990e1f3c8f4

 .../kafka/connect/runtime/AbstractHerder.java      |   7 +-
 .../org/apache/kafka/connect/runtime/Worker.java   |   1 +
 .../kafka/connect/runtime/WorkerConnector.java     |   3 +-
 .../apache/kafka/connect/tools/MockConnector.java  | 111 +++++++++++++++++++++
 .../kafka/connect/tools/MockSinkConnector.java     |  84 ++++++++++++++++
 .../apache/kafka/connect/tools/MockSinkTask.java   |  71 +++++++++++++
 .../kafka/connect/tools/MockSourceConnector.java   |  84 ++++++++++++++++
 .../apache/kafka/connect/tools/MockSourceTask.java |  66 ++++++++++++
 .../resources/ConnectorPluginsResourceTest.java    |   6 ++
 tests/kafkatest/services/connect.py                |  49 +++++++++
 .../tests/connect/connect_distributed_test.py      |  79 ++++++++++++++-
 11 files changed, 554 insertions(+), 7 deletions(-)
36cab7dbdff6981d0df4b355dadee3fac35508a6

 .../kafka/connect/runtime/AbstractHerder.java      |   7 +-
 .../org/apache/kafka/connect/runtime/Worker.java   |   1 +
 .../kafka/connect/runtime/WorkerConnector.java     |   3 +-
 .../apache/kafka/connect/tools/MockConnector.java  | 111 +++++++++++++++++++++
 .../kafka/connect/tools/MockSinkConnector.java     |  84 ++++++++++++++++
 .../apache/kafka/connect/tools/MockSinkTask.java   |  71 +++++++++++++
 .../kafka/connect/tools/MockSourceConnector.java   |  84 ++++++++++++++++
 .../apache/kafka/connect/tools/MockSourceTask.java |  66 ++++++++++++
 .../resources/ConnectorPluginsResourceTest.java    |   6 ++
 tests/kafkatest/services/connect.py                |  49 +++++++++
 .../tests/connect/connect_distributed_test.py      |  79 ++++++++++++++-
 11 files changed, 554 insertions(+), 7 deletions(-)
8bf18df1b6584d95a850a846b26046c2b79531b7

 .../test/scala/integration/kafka/api/EndToEndAuthorizationTest.scala    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
10bbffd75439e10fe9db6cf0aa48a7da7e386ef3

 .../main/scala/kafka/consumer/BaseConsumer.scala   | 42 ++++++++++------
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 58 +++++++++++-----------
 2 files changed, 56 insertions(+), 44 deletions(-)
8b7dce87a744837e5b3bba41b3e3c4c408c78b7f

 .../kafka/streams/integration/utils/EmbeddedSingleNodeKafkaCluster.java  | 1 +
 1 file changed, 1 insertion(+)
d546aa292aa8710f4285cef4e89c75b44d24a8b0

 docs/streams.html | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
9716768810635b75b7668730962c399048ca883e

 .../main/scala/kafka/consumer/BaseConsumer.scala   | 42 ++++++++++---
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 72 +++++++++++++++++-----
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 43 +++++++++++++
 3 files changed, 134 insertions(+), 23 deletions(-)
37244881efefd593169b15f702b74ab17a4394a7

 .../connect/runtime/WorkerSourceTaskTest.java      | 79 +++++++++++++++-------
 1 file changed, 53 insertions(+), 26 deletions(-)
280f09b8dc72d41f7b7efbce4fc4e3620a44cf4b

 .../kafka/connect/runtime/WorkerSourceTask.java    |  6 +-
 .../connect/runtime/WorkerSourceTaskTest.java      | 79 +++++++++++++++++-----
 2 files changed, 67 insertions(+), 18 deletions(-)
50781b75d8368ae67cf06d15ea11579a2aa4fb2c

 .../connect/runtime/WorkerSourceTaskTest.java      | 79 +++++++++++++++-------
 1 file changed, 53 insertions(+), 26 deletions(-)
44c8308ab1a6b950c5b12386d7864881b5d052a0

 .../integration/InternalTopicIntegrationTest.java  |   3 +-
 .../streams/integration/JoinIntegrationTest.java   |   4 +-
 .../integration/KGroupedStreamIntegrationTest.java |   3 +-
 .../integration/KStreamRepartitionJoinTest.java    | 348 +++++++--------------
 .../integration/RegexSourceIntegrationTest.java    |   1 -
 .../integration/WordCountIntegrationTest.java      |   2 +-
 .../apache/kafka/streams/state/StateTestUtils.java |   2 +-
 7 files changed, 122 insertions(+), 241 deletions(-)
8d63690ef5b3cbf040b1eeb091f2949581ae1aa6

 .../main/java/org/apache/kafka/connect/data/Struct.java   |  4 ++--
 .../java/org/apache/kafka/connect/data/StructTest.java    | 15 +++++++++++++++
 2 files changed, 17 insertions(+), 2 deletions(-)
4544ee448703b8c1900adcb7a605380eb99a00a2

 .../main/java/org/apache/kafka/connect/data/Struct.java   |  4 ++--
 .../java/org/apache/kafka/connect/data/StructTest.java    | 15 +++++++++++++++
 2 files changed, 17 insertions(+), 2 deletions(-)
412d2da29a7213faad4689758ecccbb55d53d415

 docs/upgrade.html | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
b9f1c60328da8a494424e30e7ebcb75d31c6fe85

 docs/upgrade.html | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
968e44cac5919b28ebf5fad14a7946e4db943dc0

 .../kafka/connect/runtime/WorkerSinkTask.java      | 27 +++++++----
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 54 ++++++++++++++++++++++
 2 files changed, 73 insertions(+), 8 deletions(-)
2c9796114d0a9638be79b4165d0096c7a63babe7

 .../kafka/connect/runtime/WorkerSinkTask.java      | 27 +++++++----
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 54 ++++++++++++++++++++++
 2 files changed, 73 insertions(+), 8 deletions(-)
40fb90937e7ce5e9a44ab634c5987da1ab73a04f

 core/src/main/scala/kafka/server/ReplicaManager.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
c179dee9d10b87f479bf1d90c57fff62bd5e585b

 .../clients/consumer/ConsumerRebalanceListener.java    | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
7fd4fe4487d328da0aab80ac658ba783ff1ebf9b

 .../clients/consumer/ConsumerRebalanceListener.java    | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
ec276b38fb36ed6b31365d19f2d1b34a7a3dd79d

 .../scala/kafka/server/AbstractFetcherThread.scala |  59 ++++++++--
 .../kafka/server/AbstractFetcherThreadTest.scala   | 127 +++++++++++++++++++++
 2 files changed, 176 insertions(+), 10 deletions(-)
84c995d8d55cb920c0fb139107fb08c766d9476e

 .../java/org/apache/kafka/streams/kstream/KStreamBuilder.java  |  2 ++
 .../apache/kafka/streams/kstream/internals/KTableSource.java   | 10 +++++++++-
 2 files changed, 11 insertions(+), 1 deletion(-)
91135ea33a7231e9b17cfc74c78dc5223475834b

 .../java/org/apache/kafka/streams/kstream/KStreamBuilder.java  |  2 ++
 .../apache/kafka/streams/kstream/internals/KTableSource.java   | 10 +++++++++-
 2 files changed, 11 insertions(+), 1 deletion(-)
175fbb559073f21d9ae2b65be22fddbae4e152ea

 .../apache/kafka/streams/kstream/internals/KStreamWindowReduce.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
73ec226d376abccac0db79e87b4058e25c27dd69
bef359ef2e53920d91dfac037c0fceefb51954d1

 .../examples/wordcount/WordCountProcessorDemo.java | 16 +++----
 .../kstream/internals/KStreamKStreamJoin.java      | 19 ++++----
 .../kstream/internals/KStreamWindowAggregate.java  | 49 +++++++++----------
 .../kstream/internals/KStreamWindowReduce.java     | 56 ++++++++++------------
 .../kafka/streams/state/KeyValueIterator.java      |  3 ++
 .../kafka/streams/state/WindowStoreIterator.java   |  8 +++-
 .../streams/state/internals/RocksDBStore.java      | 31 ++++++++----
 .../processor/internals/ProcessorTopologyTest.java |  8 ++--
 .../streams/state/KeyValueStoreTestDriver.java     |  8 ++--
 .../state/internals/RocksDBWindowStoreTest.java    |  7 +--
 10 files changed, 110 insertions(+), 95 deletions(-)
73949c288d43ed848550c1b5ba6cbbf297b110b8

 .../src/main/java/org/apache/kafka/streams/kstream/Windows.java    | 6 +-----
 .../org/apache/kafka/streams/processor/internals/RecordQueue.java  | 5 +++++
 .../org/apache/kafka/streams/processor/internals/StreamTask.java   | 7 ++++++-
 3 files changed, 12 insertions(+), 6 deletions(-)
c052002e75bfa6c835ca3d0654e806c998e0fce3

 .../kafka/streams/processor/internals/StreamPartitionAssignor.java      | 2 ++
 1 file changed, 2 insertions(+)
0b0925a16f6cc94ad96fbc4dc2bcf48bf96557e6

 .../apache/kafka/streams/kstream/internals/KStreamWindowReduce.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
4c6d7ed95a05e1f08e820305afbab983822e8b82

 docs/ops.html              | 2 +-
 docs/security.html         | 2 +-
 gradle/dependencies.gradle | 4 ++--
 3 files changed, 4 insertions(+), 4 deletions(-)
8d38c115ab6e61496eee84f790220f1643a1a804

 .../main/java/org/apache/kafka/streams/processor/StateStore.java | 4 +++-
 .../kafka/streams/processor/internals/ProcessorStateManager.java | 4 ++++
 .../org/apache/kafka/streams/state/internals/RocksDBStore.java   | 9 +++++++++
 3 files changed, 16 insertions(+), 1 deletion(-)
751fe9309011b99f60c1cb03c23a47d0444dce05

 .../main/java/org/apache/kafka/streams/processor/StateStore.java | 4 +++-
 .../kafka/streams/processor/internals/ProcessorStateManager.java | 4 ++++
 .../org/apache/kafka/streams/state/internals/RocksDBStore.java   | 9 +++++++++
 3 files changed, 16 insertions(+), 1 deletion(-)
47f5ae9e9c902e18fc0f7f153da945de2839c3e2

 .../main/java/org/apache/kafka/clients/producer/KafkaProducer.java | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
f62db5dd8886f467e1de7e534a9ef3a839a08e84

 core/src/main/scala/kafka/coordinator/GroupCoordinator.scala     | 8 +++++---
 core/src/main/scala/kafka/coordinator/GroupMetadataManager.scala | 9 ++-------
 2 files changed, 7 insertions(+), 10 deletions(-)
7d9d1cb2355e33270703280ed6bb712033b03d26

 checkstyle/import-control.xml                      |   2 +-
 .../test/java/org/apache/kafka/test/TestUtils.java |  15 +
 .../examples/pageview/PageViewTypedDemo.java       |  12 +-
 .../examples/pageview/PageViewUntypedDemo.java     |   3 +-
 .../streams/examples/wordcount/WordCountDemo.java  |   3 +-
 .../org/apache/kafka/streams/KafkaStreams.java     |   2 +
 .../kafka/streams/kstream/KGroupedStream.java      | 119 +++++
 .../org/apache/kafka/streams/kstream/KStream.java  | 215 +++-----
 .../kafka/streams/kstream/KStreamBuilder.java      |   4 +-
 .../kstream/internals/KGroupedStreamImpl.java      | 180 +++++++
 .../kstream/internals/KGroupedTableImpl.java       |   4 +-
 .../kstream/internals/KStreamAggregate.java        |   8 +-
 .../streams/kstream/internals/KStreamImpl.java     | 477 +++++++++--------
 .../kstream/internals/KStreamKStreamJoin.java      |   8 +-
 .../streams/kstream/internals/KStreamReduce.java   |   9 +-
 .../kstream/internals/KStreamWindowReduce.java     |   2 +-
 .../streams/kstream/internals/KTableImpl.java      |   2 +-
 .../kafka/streams/processor/PartitionGrouper.java  |   2 +-
 .../kafka/streams/processor/TopologyBuilder.java   |  56 +-
 .../processor/internals/RecordCollector.java       |   4 +-
 .../internals/StreamPartitionAssignor.java         |  59 ++-
 .../streams/processor/internals/StreamThread.java  |   2 +-
 .../integration/InternalTopicIntegrationTest.java  |   9 +-
 .../streams/integration/JoinIntegrationTest.java   |   5 +-
 .../integration/KGroupedStreamIntegrationTest.java | 472 +++++++++++++++++
 .../integration/KStreamRepartitionJoinTest.java    | 565 +++++++++++++++++++++
 .../integration/WordCountIntegrationTest.java      |  24 +-
 .../integration/utils/IntegrationTestUtils.java    |  14 +-
 .../internals/KStreamKStreamLeftJoinTest.java      |   6 +-
 .../internals/KStreamKTableLeftJoinTest.java       |  16 -
 .../internals/KStreamWindowAggregateTest.java      |  28 +-
 .../streams/processor/TopologyBuilderTest.java     |  10 +-
 .../internals/StreamPartitionAssignorTest.java     |  61 ++-
 .../kafka/streams/smoketest/SmokeTestClient.java   |  26 +-
 streams/src/test/resources/log4j.properties        |  21 +
 35 files changed, 1944 insertions(+), 501 deletions(-)
54ba2280f0c42b0bd3d74c197f97d8a12617a847

 .../kafka/clients/consumer/ConsumerConfig.java     |  4 +--
 .../kafka/clients/producer/ProducerConfig.java     |  4 +--
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 30 ++++++++++++++++++++++
 .../kafka/clients/producer/KafkaProducerTest.java  | 28 ++++++++++++++++++++
 4 files changed, 62 insertions(+), 4 deletions(-)
9ba2fdf8b70da85668966026d41b6fd4b8679108

 clients/src/main/java/org/apache/kafka/common/metrics/Sensor.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
eb2619cac0849dd54db956e87781d143a57b2477

 clients/src/main/java/org/apache/kafka/common/metrics/Sensor.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
8c551675adb11947e9f27b20a9195c9c4a20b432

 .../main/scala/kafka/coordinator/DelayedJoin.scala |   4 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala | 304 +++++++------
 .../scala/kafka/coordinator/GroupMetadata.scala    | 110 ++++-
 .../kafka/coordinator/GroupMetadataManager.scala   | 498 +++++++++++----------
 .../scala/kafka/coordinator/MemberMetadata.scala   |   1 +
 .../coordinator/GroupCoordinatorResponseTest.scala |   7 +-
 .../coordinator/GroupMetadataManagerTest.scala     | 407 +++++++++++++++++
 .../unit/kafka/coordinator/GroupMetadataTest.scala | 155 ++++++-
 .../kafka/coordinator/MemberMetadataTest.scala     |  11 +-
 9 files changed, 1081 insertions(+), 416 deletions(-)
fb42558e2500835722a4e5028896ddae4f407d6f

 .../java/org/apache/kafka/clients/Metadata.java    |  19 +-
 .../kafka/streams/kstream/KStreamBuilder.java      |  39 +++
 .../kafka/streams/processor/TopologyBuilder.java   | 150 ++++++++-
 .../internals/StreamPartitionAssignor.java         |  37 ++-
 .../streams/processor/internals/StreamThread.java  |  10 +-
 .../integration/RegexSourceIntegrationTest.java    | 365 +++++++++++++++++++++
 .../utils/EmbeddedSingleNodeKafkaCluster.java      |   7 +-
 .../streams/integration/utils/KafkaEmbedded.java   |  15 +
 .../streams/processor/TopologyBuilderTest.java     |  43 ++-
 9 files changed, 664 insertions(+), 21 deletions(-)
1ef7b494bbd937205ecd14dd30e625c2efdb3aa9

 .../apache/kafka/streams/state/KeyValueStore.java  | 10 ++++++
 .../internals/InMemoryKeyValueLoggedStore.java     |  5 +++
 .../internals/InMemoryKeyValueStoreSupplier.java   |  5 +++
 .../streams/state/internals/MemoryLRUCache.java    |  5 +++
 .../state/internals/MeteredKeyValueStore.java      |  5 +++
 .../streams/state/internals/RocksDBStore.java      | 37 ++++++++++++++++++++++
 .../state/internals/AbstractKeyValueStoreTest.java | 19 +++++++++++
 7 files changed, 86 insertions(+)
17668e81c95d89f6543657351abc0a18004ecde5

 .../streams/state/internals/WindowStoreUtils.java  |  4 ++
 .../state/internals/WindowStoreUtilsTest.java      | 44 ++++++++++++++++++++++
 2 files changed, 48 insertions(+)
78ac7b6b09b6c2c9062bcb98d7683c1f9a427b65

 .../java/org/apache/kafka/common/security/kerberos/KerberosLogin.java  | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
84ca887295efbd99a6a7d7363f77d59b7a42b642

 .../java/org/apache/kafka/common/security/kerberos/KerberosLogin.java  | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
9ff54cb5dd99fab83533ddfdf0ed89508e5525fb

 .../kafka/connect/runtime/WorkerSourceTask.java    |  6 +-
 .../connect/runtime/WorkerSourceTaskTest.java      | 79 +++++++++++++++++-----
 2 files changed, 67 insertions(+), 18 deletions(-)
7cc6e0e2d376c2504cf6fafd69ccd30f4c03f31f

 core/src/main/scala/kafka/log/Log.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9e2f067d11be908b86e50a79c6cb2b5138168db0

 docs/protocol.html | 26 ++++++++++++++++++++++++++
 1 file changed, 26 insertions(+)
b1ba54025fc872e14e1ff97fde018637826a3a5e

 docs/protocol.html | 26 ++++++++++++++++++++++++++
 1 file changed, 26 insertions(+)
b8ea094b427768bb360d87fc0a07f670cb667e1e

 .../kafka/clients/consumer/ConsumerConfig.java     |   5 +
 .../kafka/clients/producer/ProducerConfig.java     |   5 +
 .../org/apache/kafka/streams/StreamsConfig.java    | 120 +++++++++++++--------
 .../apache/kafka/streams/StreamsConfigTest.java    |  10 +-
 4 files changed, 93 insertions(+), 47 deletions(-)
b058fcf5ec3b818f7275d6d3591881c69033a830

 core/src/main/scala/kafka/tools/SimpleConsumerShell.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
250981fb98113d5c693132798225e075f162d92d

 docs/connect.html | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)
5b88af9929c12b587796ceed7d85238206131249

 tools/src/main/java/org/apache/kafka/tools/ThroughputThrottler.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
86cce341b8fd5439501a1451d7f2e90691494922

 .../kstream/internals/KTableRepartitionMap.java    | 31 +++++---------
 .../kstream/internals/KTableAggregateTest.java     | 50 ++++++++++++++++++++++
 2 files changed, 61 insertions(+), 20 deletions(-)
da8517182d2f30c4e03b33b38d41d2fa33621e24

 .../kstream/internals/KTableRepartitionMap.java    | 31 +++++---------
 .../kstream/internals/KTableAggregateTest.java     | 50 ++++++++++++++++++++++
 2 files changed, 61 insertions(+), 20 deletions(-)
eb6f04a8b12194b9e13e2a28d8ffdfa971516d68

 .../apache/kafka/common/config/AbstractConfig.java | 32 ++++++++++---
 .../kafka/common/config/AbstractConfigTest.java    | 54 +++++++++++++++++++++-
 2 files changed, 79 insertions(+), 7 deletions(-)
4b28d38ca463ff3788885a904591a5699127158a

 .../kafka/clients/consumer/RoundRobinAssignor.java       | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)
06a57cf19c45e82245ada886ea885087ce60ab80

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)
d9f052acc396871801edee13ef0a6042a9af6626

 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 20 ++++++++------
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 31 ++++++++++++++++++++--
 2 files changed, 41 insertions(+), 10 deletions(-)
b372c4bf4a65c25086fc7d8e60f1970d5486ce74

 .../src/main/java/org/apache/kafka/common/protocol/Errors.java |  4 ++--
 .../test/java/org/apache/kafka/common/protocol/ErrorsTest.java | 10 ++++++++++
 2 files changed, 12 insertions(+), 2 deletions(-)
feab5a374a33a7b7b8e96c6a88b872c4db33dcf1

 .../src/main/java/org/apache/kafka/common/protocol/Errors.java |  4 ++--
 .../test/java/org/apache/kafka/common/protocol/ErrorsTest.java | 10 ++++++++++
 2 files changed, 12 insertions(+), 2 deletions(-)
780bc646d543eab86faaa215a15f51fba7c1c4f8

 core/src/main/scala/kafka/utils/ZkUtils.scala      |  4 +-
 .../security/auth/SimpleAclAuthorizerTest.scala    | 20 +++++++-
 .../test/scala/unit/kafka/utils/ZkUtilsTest.scala  | 55 ++++++++++++++++++++++
 3 files changed, 76 insertions(+), 3 deletions(-)
f643d1b75d17bb27a378c7e66fcc49607454e445

 core/src/main/scala/kafka/utils/ZkUtils.scala      |  4 +-
 .../security/auth/SimpleAclAuthorizerTest.scala    | 20 +++++++-
 .../test/scala/unit/kafka/utils/ZkUtilsTest.scala  | 55 ++++++++++++++++++++++
 3 files changed, 76 insertions(+), 3 deletions(-)
430bf56cdfa32baffad21bb37dd50c080491dc03

 .../main/java/org/apache/kafka/clients/CommonClientConfigs.java  | 4 ++--
 core/src/main/scala/kafka/network/SocketServer.scala             | 9 ++++++---
 core/src/main/scala/kafka/server/KafkaConfig.scala               | 4 ++--
 3 files changed, 10 insertions(+), 7 deletions(-)
0cee0c321897b4fca4409651fdf28188870cb2f0

 .../java/org/apache/kafka/clients/Metadata.java    | 64 +++++++++++++++++-----
 .../kafka/clients/producer/KafkaProducer.java      |  8 +--
 .../producer/internals/RecordAccumulator.java      | 20 ++++---
 .../kafka/clients/producer/internals/Sender.java   |  8 ++-
 .../kafka/common/requests/MetadataResponse.java    | 17 ++++--
 .../org/apache/kafka/clients/MetadataTest.java     | 63 +++++++++++++++++++++
 .../internals/ConsumerCoordinatorTest.java         | 31 +++++++++++
 .../clients/producer/internals/SenderTest.java     | 39 ++++++++++++-
 8 files changed, 216 insertions(+), 34 deletions(-)
79aaf19f24bb48f90404a3e3896d115107991f4c

 core/src/main/scala/kafka/admin/TopicCommand.scala |   2 +-
 core/src/main/scala/kafka/api/ApiVersion.scala     |   2 +-
 .../kafka/api/ControlledShutdownRequest.scala      |   2 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   2 +-
 .../scala/kafka/api/GenericRequestAndHeader.scala  |   2 +-
 .../scala/kafka/api/GenericResponseAndHeader.scala |   2 +-
 core/src/main/scala/kafka/api/LeaderAndIsr.scala   |   4 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   2 +-
 core/src/main/scala/kafka/api/OffsetResponse.scala |   2 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   2 +-
 .../main/scala/kafka/api/RequestOrResponse.scala   |   2 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  |   4 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   2 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |   4 +-
 core/src/main/scala/kafka/cluster/Cluster.scala    |   2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  14 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |   4 +-
 core/src/main/scala/kafka/common/AppInfo.scala     |   2 +-
 .../common/ZkNodeChangeNotificationListener.scala  |   5 +-
 .../main/scala/kafka/consumer/KafkaStream.scala    |   2 +-
 .../scala/kafka/consumer/PartitionAssignor.scala   |   2 +-
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |   2 +-
 .../controller/ControllerChannelManager.scala      |  12 +-
 .../scala/kafka/controller/KafkaController.scala   |  70 +++++----
 .../kafka/controller/PartitionLeaderSelector.scala |   2 +-
 .../kafka/controller/PartitionStateMachine.scala   |  12 +-
 .../kafka/controller/ReplicaStateMachine.scala     |   6 +-
 .../kafka/controller/TopicDeletionManager.scala    |  16 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |   2 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |   2 +-
 .../scala/kafka/coordinator/MemberMetadata.scala   |   2 +-
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |   2 +-
 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   2 +-
 core/src/main/scala/kafka/message/Message.scala    |   2 +-
 .../scala/kafka/metrics/KafkaMetricsReporter.scala |   8 +-
 .../kafka/network/RequestOrResponseSend.scala      |   2 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |   2 +-
 .../kafka/producer/ProducerRequestStats.scala      |   2 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  14 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |   6 +-
 .../scala/kafka/server/ClientQuotaManager.scala    |   2 +-
 .../main/scala/kafka/server/DelayedOperation.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  13 +-
 .../scala/kafka/tools/ConsumerPerformance.scala    |   4 +-
 .../scala/kafka/tools/ProducerPerformance.scala    |   2 +-
 .../kafka/tools/ReplicaVerificationTool.scala      |   2 +-
 .../kafka/tools/SimpleConsumerPerformance.scala    |   4 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  10 +-
 .../scala/kafka/tools/StateChangeLogMerger.scala   |   8 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |   2 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala    |   4 +-
 core/src/main/scala/kafka/utils/ToolsUtils.scala   |   2 +-
 .../scala/kafka/utils/VerifiableProperties.scala   |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   8 +-
 .../integration/kafka/api/AdminClientTest.scala    |  22 +--
 .../kafka/api/AuthorizerIntegrationTest.scala      |  10 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  52 +++----
 .../kafka/api/BaseProducerSendTest.scala           |  14 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |   6 +-
 .../kafka/api/IntegrationTestHarness.scala         |   2 +-
 .../kafka/api/PlaintextConsumerTest.scala          | 164 ++++++++++-----------
 .../kafka/api/SaslMultiMechanismConsumerTest.scala |   4 +-
 .../test/scala/kafka/tools/TestLogCleaning.scala   |   4 +-
 .../test/scala/other/kafka/TestOffsetManager.scala |   2 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |   2 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  14 +-
 .../scala/unit/kafka/admin/ConfigCommandTest.scala |   2 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  18 +--
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |   4 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   2 +-
 .../kafka/controller/ControllerFailoverTest.scala  |   6 +-
 .../coordinator/GroupCoordinatorResponseTest.scala |   4 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   6 +-
 .../integration/ProducerConsumerTestHarness.scala  |   2 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    |   4 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |   2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   4 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   |   2 +-
 .../scala/unit/kafka/message/MessageTest.scala     |  12 +-
 .../unit/kafka/network/SocketServerTest.scala      |   2 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  10 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  10 +-
 .../kafka/security/auth/ZkAuthorizationTest.scala  |  10 +-
 .../unit/kafka/server/BaseReplicaFetchTest.scala   |   2 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |  12 +-
 .../server/HighwatermarkPersistenceTest.scala      |  12 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   3 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   2 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |   6 +-
 .../kafka/server/ServerGenerateBrokerIdTest.scala  |   4 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  10 +-
 .../unit/kafka/tools/ConsoleProducerTest.scala     |   4 +-
 .../unit/kafka/utils/IteratorTemplateTest.scala    |   2 +-
 .../scala/unit/kafka/utils/JaasTestUtils.scala     |   2 +-
 .../scala/unit/kafka/utils/MockScheduler.scala     |   4 +-
 .../src/test/scala/unit/kafka/utils/MockTime.scala |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  18 +--
 104 files changed, 401 insertions(+), 392 deletions(-)
2c7fae0a4a2b59133e53eb02a533cf8ffd0f864c

 .../scala/kafka/tools/ConsoleProducerTest.scala    | 79 ----------------------
 .../unit/kafka/tools/ConsoleProducerTest.scala     | 78 +++++++++++++++++++++
 2 files changed, 78 insertions(+), 79 deletions(-)
b60af34d4a200dbc5062ba40bfb7ffc7162e72d0

 .../scala/integration/kafka/api/BaseProducerSendTest.scala     |  4 ++++
 .../integration/kafka/api/PlaintextProducerSendTest.scala      | 10 +++++-----
 2 files changed, 9 insertions(+), 5 deletions(-)
6500b53c75495296275e83e4e4beb224d7ac0c4f

 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  4 +--
 .../scala/unit/kafka/tools/MirrorMakerTest.scala   | 42 ++++++++++++++++++++++
 2 files changed, 44 insertions(+), 2 deletions(-)
f4a263b5a89e028ad3b658dca2259b6da0197214

 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  4 +--
 .../scala/unit/kafka/tools/MirrorMakerTest.scala   | 42 ++++++++++++++++++++++
 2 files changed, 44 insertions(+), 2 deletions(-)
625e9400108b15e86b060768b082e196127d48ee

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
27cb6686fd678a1625fe3bb114e7ff0afb4f6448

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ab356060665b3b6502c7d531366b26e1e0f48f9c

 .../scala/kafka/controller/KafkaController.scala   | 98 +++++++++++-----------
 .../kafka/controller/PartitionLeaderSelector.scala | 32 ++++---
 .../kafka/controller/PartitionStateMachine.scala   | 11 ++-
 .../kafka/controller/ReplicaStateMachine.scala     | 15 ++--
 .../message/ByteBufferBackedInputStream.scala      | 24 +++---
 core/src/main/scala/kafka/producer/Producer.scala  | 14 ++--
 core/src/main/scala/kafka/tools/JmxTool.scala      |  7 +-
 .../kafka/security/auth/ZkAuthorizationTest.scala  | 26 +++---
 8 files changed, 111 insertions(+), 116 deletions(-)
ff300c9d4f45e4a355db11258965c3a3a6f6bbf7

 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 20 +++++--------------
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 23 +++++++---------------
 2 files changed, 12 insertions(+), 31 deletions(-)
717c7bbc39b56a17a413b3bd02c776d9b79e9b3e

 .../kafka/api/EndToEndAuthorizationTest.scala      | 22 +++++++++++++++++-----
 1 file changed, 17 insertions(+), 5 deletions(-)
49ddc897b8feda9c4786d5bcd03814b91ede7124

 .../kafka/api/EndToEndAuthorizationTest.scala      | 22 +++++++++++++++++-----
 1 file changed, 17 insertions(+), 5 deletions(-)
c0537b5f059e025fa268d92a58c27d98540b7c5a

 .../main/java/org/apache/kafka/streams/kstream/TimeWindows.java   | 4 +---
 .../java/org/apache/kafka/streams/kstream/TimeWindowsTest.java    | 8 ++++++++
 2 files changed, 9 insertions(+), 3 deletions(-)
234fa5a6949c9a5bfb4f543989c2ece84fcce033

 .../main/java/org/apache/kafka/streams/kstream/TimeWindows.java   | 4 +---
 .../java/org/apache/kafka/streams/kstream/TimeWindowsTest.java    | 8 ++++++++
 2 files changed, 9 insertions(+), 3 deletions(-)
a27030693bd89b16a436ba873192ebc98c4c7910

 build.gradle | 6 ++++++
 1 file changed, 6 insertions(+)
419e6517c75822d94974628151d399ae93e4a9f0

 README.md    | 1 +
 build.gradle | 4 +++-
 2 files changed, 4 insertions(+), 1 deletion(-)
76ca6f8cc1a6533866a2bd7ca6a7d32314d21dba

 README.md    | 1 +
 build.gradle | 4 +++-
 2 files changed, 4 insertions(+), 1 deletion(-)
c91f742deb8b83d59847f2afb7a786f18b34eb1d

 .../org/apache/kafka/clients/consumer/internals/Fetcher.java     | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)
7699b91f870f58e71dbdeddba79b58f009f9c0a2

 .../org/apache/kafka/clients/consumer/internals/Fetcher.java     | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)
de23c6376bead90249e1e4344d8b7a5ed148fba3

 .../kafka/api/EndToEndAuthorizationTest.scala      |  7 ++---
 .../kafka/integration/KafkaServerTestHarness.scala | 34 +++++++++++++---------
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    | 10 +++++++
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala | 13 ---------
 4 files changed, 33 insertions(+), 31 deletions(-)
1029030466f01937d416e11f93562bcaaecce253

 .../kafka/api/EndToEndAuthorizationTest.scala      |  7 ++---
 .../kafka/integration/KafkaServerTestHarness.scala | 34 +++++++++++++---------
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    | 10 +++++++
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala | 13 ---------
 4 files changed, 33 insertions(+), 31 deletions(-)
245fa2bd8c08bb17c0b2b7aad4aba145d3c49783

 streams/src/main/java/org/apache/kafka/streams/KafkaStreams.java | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)
e6ca328f80a8f7504d740c9f77dfc8b04db20324

 core/src/main/scala/kafka/tools/GetOffsetShell.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
107205a7f17a4b1e235089668cb283bf16fbb88a

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
946ae60a4c8b694bfad65f20348d8081f103830b

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
ab7325928164b0cc7c26c695ecdf431ce1d89b8d

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
61e0eaefd15a8bc158424d786ca4ec25eb6b39df

 clients/src/main/java/org/apache/kafka/common/PartitionInfo.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
fec24d19cc66e4d18cf87f0ff597eecfe5a7e000

 docs/streams.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c2f8a53e708ad8947be6d8320c9261bfadc877ee

 core/src/main/scala/kafka/network/SocketServer.scala | 2 ++
 1 file changed, 2 insertions(+)
fed3f1f8890b219e4247fd9de1305ad18679ff99

 core/src/main/scala/kafka/cluster/Partition.scala  | 42 +++++++++++-----------
 .../main/scala/kafka/server/DelayedProduce.scala   | 22 +++++-------
 2 files changed, 30 insertions(+), 34 deletions(-)
3fd9be49ac35adaca401f58552b3ffa68f8d4eaa

 .../kafka/connect/storage/MemoryOffsetBackingStore.java    | 14 +++++---------
 1 file changed, 5 insertions(+), 9 deletions(-)
404b696bea58aca17fbe528aed03cb3c94516c39

 core/src/main/scala/kafka/admin/AclCommand.scala           |  2 +-
 core/src/main/scala/kafka/admin/AdminClient.scala          | 14 +++++++-------
 core/src/main/scala/kafka/admin/AdminUtils.scala           | 12 ++++++------
 .../main/scala/kafka/admin/ReassignPartitionsCommand.scala |  2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala         |  4 ++--
 core/src/main/scala/kafka/admin/ZkSecurityMigrator.scala   | 14 ++++++--------
 .../main/scala/kafka/api/ControlledShutdownRequest.scala   |  2 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala         |  4 ++--
 core/src/main/scala/kafka/log/Log.scala                    |  4 ++--
 core/src/main/scala/kafka/log/LogCleaner.scala             |  4 ++--
 core/src/main/scala/kafka/log/LogCleanerManager.scala      |  2 +-
 core/src/main/scala/kafka/log/LogManager.scala             |  5 ++---
 core/src/main/scala/kafka/log/OffsetIndex.scala            |  8 ++++++--
 core/src/main/scala/kafka/tools/ConsoleProducer.scala      |  2 +-
 core/src/main/scala/kafka/tools/GetOffsetShell.scala       |  2 +-
 core/src/main/scala/kafka/tools/JmxTool.scala              |  6 +++---
 core/src/main/scala/kafka/tools/MirrorMaker.scala          |  2 +-
 17 files changed, 45 insertions(+), 44 deletions(-)
0aff450961a8dd14cc7820ee8d1c9eea855439b0

 core/src/main/scala/kafka/admin/AdminClient.scala  | 10 +++----
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 33 ++++++++++++----------
 .../integration/kafka/api/AdminClientTest.scala    |  2 +-
 3 files changed, 24 insertions(+), 21 deletions(-)
a4802962c9e87f9cc81e1820fc88c71bd70b6666

 connect/json/src/test/resources/connect-test.properties | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
7b7c4a7bb0fd25ddca4e4bdde9e605b3d5a1ba70

 .../apache/kafka/streams/integration/FanoutIntegrationTest.java    | 5 +----
 .../kafka/streams/integration/InternalTopicIntegrationTest.java    | 7 ++-----
 .../org/apache/kafka/streams/integration/JoinIntegrationTest.java  | 5 +----
 .../kafka/streams/integration/MapFunctionIntegrationTest.java      | 5 +----
 .../kafka/streams/integration/PassThroughIntegrationTest.java      | 5 +----
 .../apache/kafka/streams/integration/WordCountIntegrationTest.java | 7 ++-----
 6 files changed, 8 insertions(+), 26 deletions(-)
756ec494da75c49e6b537bd094b941c0492ec46e

 core/src/main/scala/kafka/log/OffsetMap.scala          |  5 +++++
 core/src/test/scala/unit/kafka/log/OffsetMapTest.scala | 14 +++++++++++++-
 2 files changed, 18 insertions(+), 1 deletion(-)
55225bd55ba6f9d84a2963942d52bd4d316c8274

 core/src/main/scala/kafka/consumer/BaseConsumer.scala | 2 +-
 core/src/main/scala/kafka/tools/ExportZkOffsets.scala | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
5aa20fb578dc8f20230a76ae8223fa013e590622

 core/src/main/scala/kafka/network/RequestChannel.scala | 2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala       | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
936e26aa8db991b51141b21df234d702bc05408f

 core/src/main/scala/kafka/network/RequestChannel.scala | 2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala       | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
f79db1a4234b4af75a2d027c86df62d77ba3d29e

 .../main/java/org/apache/kafka/clients/CommonClientConfigs.java    | 7 ++++++-
 .../java/org/apache/kafka/clients/consumer/ConsumerConfig.java     | 2 +-
 .../java/org/apache/kafka/clients/producer/ProducerConfig.java     | 2 +-
 core/src/main/scala/kafka/admin/AdminClient.scala                  | 2 +-
 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java  | 2 +-
 5 files changed, 10 insertions(+), 5 deletions(-)
ebed7ce3604d32d1b502888bc188904b43e5674f

 .../main/java/org/apache/kafka/connect/file/FileStreamSourceTask.java    | 1 -
 1 file changed, 1 deletion(-)
9355427efc4c2c6d0f0d61dd956e5ad187da2dfc

 .../connect/storage/MemoryOffsetBackingStore.java  | 24 ++++++++++++++++++----
 1 file changed, 20 insertions(+), 4 deletions(-)
3cf2de0694cf0e276d25d8c7048a9928b41969a3

 .../org/apache/kafka/connect/json/JsonConverter.java    |  2 +-
 .../apache/kafka/connect/json/JsonConverterTest.java    | 17 +++++++++++++++++
 connect/json/src/test/resources/connect-test.properties |  2 ++
 .../runtime/distributed/DistributedHerderTest.java      |  2 --
 4 files changed, 20 insertions(+), 3 deletions(-)
d5366471d2c1a611f2241362041debc0118e5422

 .../src/main/java/org/apache/kafka/clients/producer/KafkaProducer.java | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
c699b1a914260b7d6fd84596f78128369d2bf2bf

 core/src/main/scala/kafka/admin/AclCommand.scala          | 4 ++--
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala | 2 +-
 docs/security.html                                        | 2 +-
 3 files changed, 4 insertions(+), 4 deletions(-)
be0f3502da1f703b27d7a3fae5a01325dff44957

 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 .../unit/kafka/server/ServerStartupTest.scala      | 28 +++++++++++++++++++++-
 2 files changed, 28 insertions(+), 2 deletions(-)
5f9446498e24afdb1149af53583c0ab23345d965

 .../scala/kafka/coordinator/GroupCoordinator.scala | 10 ++--
 core/src/main/scala/kafka/server/KafkaServer.scala | 14 ++---
 .../kafka/api/AuthorizerIntegrationTest.scala      |  2 +-
 .../api/GroupCoordinatorIntegrationTest.scala      | 63 ++++++++++++++++++++++
 .../kafka/api/IntegrationTestHarness.scala         |  2 +-
 5 files changed, 78 insertions(+), 13 deletions(-)
62dc1afb69369c64207991ba59bcd203505d37ea

 .../scala/kafka/coordinator/GroupCoordinator.scala | 10 ++--
 core/src/main/scala/kafka/server/KafkaServer.scala | 14 ++---
 .../kafka/api/AuthorizerIntegrationTest.scala      |  2 +-
 .../api/GroupCoordinatorIntegrationTest.scala      | 63 ++++++++++++++++++++++
 .../kafka/api/IntegrationTestHarness.scala         |  2 +-
 5 files changed, 78 insertions(+), 13 deletions(-)
5653249e08b1050f0e2081bf1dcc50324b3ec409

 core/src/main/scala/kafka/admin/AclCommand.scala          | 10 +++++++---
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala |  4 +---
 docs/security.html                                        |  6 ++++++
 3 files changed, 14 insertions(+), 6 deletions(-)
cb8b6c07140b9d0cca2f17c2fdcdd0f1c7248b99

 .../streams/integration/FanoutIntegrationTest.java | 11 ++-
 .../integration/InternalTopicIntegrationTest.java  |  4 ++
 .../streams/integration/JoinIntegrationTest.java   | 10 ++-
 .../integration/MapFunctionIntegrationTest.java    |  8 +--
 .../integration/PassThroughIntegrationTest.java    |  8 +--
 .../integration/WordCountIntegrationTest.java      |  6 +-
 .../integration/utils/IntegrationTestUtils.java    | 80 ++++++++++++++++++++--
 7 files changed, 98 insertions(+), 29 deletions(-)
fee6f6f927b36ac74bc4a8b233711234558f3b51

 .../streams/integration/FanoutIntegrationTest.java | 11 ++-
 .../integration/InternalTopicIntegrationTest.java  |  4 ++
 .../streams/integration/JoinIntegrationTest.java   | 10 ++-
 .../integration/MapFunctionIntegrationTest.java    |  8 +--
 .../integration/PassThroughIntegrationTest.java    |  8 +--
 .../integration/WordCountIntegrationTest.java      |  6 +-
 .../integration/utils/IntegrationTestUtils.java    | 80 ++++++++++++++++++++--
 7 files changed, 98 insertions(+), 29 deletions(-)
8c8b54ee482306652af39d3682eb7a73599503c2

 tests/README.md | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
6193357d87f4dce4c6832ac4f9a208d2a7a0539c

 docs/ops.html | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)
0e1c012fb551f32cf27b6b7367749047c374ee97

 docs/ops.html | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)
98928f7ad0f556caf4b8ff4b212c946ce948d7d6

 docs/quickstart.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
11a50ff1031b6a44900f876bb89593352d9cf41b

 .../java/org/apache/kafka/clients/producer/ProducerConfig.java     | 7 +++----
 docs/documentation.html                                            | 3 ++-
 2 files changed, 5 insertions(+), 5 deletions(-)
5f498855d9e247b07af54c6329b5b5347e469ace

 .../java/org/apache/kafka/clients/producer/ProducerConfig.java     | 7 +++----
 docs/documentation.html                                            | 3 ++-
 2 files changed, 5 insertions(+), 5 deletions(-)
d1e24000c8770d6c207dca265f4cdafe33690325

 .../producer/internals/RecordAccumulator.java      | 63 +++++++++++++---------
 .../apache/kafka/common/record/MemoryRecords.java  |  5 ++
 .../producer/internals/RecordAccumulatorTest.java  | 18 ++++++-
 3 files changed, 60 insertions(+), 26 deletions(-)
fe27d8f787f38428e0add36edeac9d694f16af53

 .../producer/internals/RecordAccumulator.java      | 63 +++++++++++++---------
 .../apache/kafka/common/record/MemoryRecords.java  |  5 ++
 .../producer/internals/RecordAccumulatorTest.java  | 18 ++++++-
 3 files changed, 60 insertions(+), 26 deletions(-)
a86ae26fcb18d307d5d54f7061df613ce148fc33

 .../scala/kafka/server/KafkaRequestHandler.scala   | 42 +++++++++++++++++-----
 .../main/scala/kafka/server/ReplicaManager.scala   | 17 ++++-----
 .../scala/unit/kafka/metrics/MetricsTest.scala     | 15 ++++++--
 3 files changed, 56 insertions(+), 18 deletions(-)
23b70efa8d65ef56f7a31e22afcbe653dc736079

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java |  6 +++---
 .../org/apache/kafka/clients/producer/ProducerConfig.java     | 11 +++++------
 docs/upgrade.html                                             |  1 +
 3 files changed, 9 insertions(+), 9 deletions(-)
a1838755a206fc769ef1fe947eafe3ff245afeb6

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
76153128556869df6982fd00c80fbe9bbace20a0
2e456cb6167e33414ac88235701022e7b7d705bb

 docs/security.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
dee38806663b0062706dfaca40da9537792f05a9

 docs/security.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
177b2d0bea76f270ec087ebe73431307c1aef5a1

 .../examples/wordcount/WordCountProcessorDemo.java | 16 +++----
 .../kstream/internals/KStreamKStreamJoin.java      | 19 ++++----
 .../kstream/internals/KStreamWindowAggregate.java  | 49 +++++++++----------
 .../kstream/internals/KStreamWindowReduce.java     | 56 ++++++++++------------
 .../kafka/streams/state/KeyValueIterator.java      |  3 ++
 .../kafka/streams/state/WindowStoreIterator.java   |  8 +++-
 .../streams/state/internals/RocksDBStore.java      | 31 ++++++++----
 .../processor/internals/ProcessorTopologyTest.java |  8 ++--
 .../streams/state/KeyValueStoreTestDriver.java     |  8 ++--
 .../state/internals/RocksDBWindowStoreTest.java    |  7 +--
 10 files changed, 110 insertions(+), 95 deletions(-)
e18bbba77fcab9667536f624f85576516aff55be

 .../main/java/org/apache/kafka/connect/runtime/WorkerConfig.java   | 7 -------
 1 file changed, 7 deletions(-)
542f7af7ba7e562b57b5fd50bfd67a8320bf8963

 docs/security.html | 145 +++++++++++++++++++++++++++--------------------------
 1 file changed, 73 insertions(+), 72 deletions(-)
2ce3285297a8cf20d801c7ac479603dd5926851c

 docs/security.html | 145 +++++++++++++++++++++++++++--------------------------
 1 file changed, 73 insertions(+), 72 deletions(-)
4f3966cecef674ddda72acccb3e14b4bf7bcf1b9

 README.md    | 11 +++++++----
 build.gradle | 36 ++++++++++++++++++++++++++----------
 2 files changed, 33 insertions(+), 14 deletions(-)
9791401a778fee5a165373b923bbe0ece70defbe

 README.md    | 11 +++++++----
 build.gradle | 36 ++++++++++++++++++++++++++----------
 2 files changed, 33 insertions(+), 14 deletions(-)
42e96b8b90b959d2d4e2823715ef48be60b75994

 tests/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5b5f3ed0f29faa803e894fc3ee2797b3bfe5766a

 tests/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c36cc60f73ca1fe956fb8792bc538b1fdebb712d

 .../test/java/org/apache/kafka/test/TestUtils.java | 24 +++++++++++-
 .../unit/kafka/server/ProduceRequestTest.scala     | 45 ++++++++++++++--------
 2 files changed, 52 insertions(+), 17 deletions(-)
b8642491e78c5a137f5012e31d347c01f3b02339

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
e02a0dd6afa1a51bde4502ad4e733031bb13f6c3

 core/src/main/scala/kafka/api/ApiVersion.scala                | 11 ++++++++++-
 .../scala/kafka/controller/ControllerChannelManager.scala     |  2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala            |  4 ++--
 core/src/main/scala/kafka/utils/ZkUtils.scala                 |  4 ++--
 4 files changed, 15 insertions(+), 6 deletions(-)
2bd7b64506a2a7ecef562f5b7db8a34e28d4e957

 core/src/main/scala/kafka/api/ApiVersion.scala                | 11 ++++++++++-
 .../scala/kafka/controller/ControllerChannelManager.scala     |  2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala            |  4 ++--
 core/src/main/scala/kafka/utils/ZkUtils.scala                 |  4 ++--
 4 files changed, 15 insertions(+), 6 deletions(-)
050ca1f0304ad35dfb727fc8f67813b39df16c22

 build.gradle | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)
9a44d938da4badec25e30733409cf7299e945bf6

 build.gradle | 11 +++++++++--
 1 file changed, 9 insertions(+), 2 deletions(-)
ab8fc86382fc9f5a8a0f696a91c66806d51c05a5

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java |  6 +++---
 .../org/apache/kafka/clients/producer/ProducerConfig.java     | 11 +++++------
 docs/upgrade.html                                             |  1 +
 3 files changed, 9 insertions(+), 9 deletions(-)
53fd22a76613b309b7941a5b0c64f17523b39202

 .../src/main/java/org/apache/kafka/streams/kstream/Windows.java    | 6 +-----
 .../org/apache/kafka/streams/processor/internals/RecordQueue.java  | 5 +++++
 .../org/apache/kafka/streams/processor/internals/StreamTask.java   | 7 ++++++-
 3 files changed, 12 insertions(+), 6 deletions(-)
d54616bc31cec226cdb0ffd2003a41b4c27fdfed

 .../kafka/streams/processor/internals/StreamPartitionAssignor.java      | 2 ++
 1 file changed, 2 insertions(+)
fd9aa035abbc7a93d03ca23ef6f66c3fc1fe57e2

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
7c6ee8d5ecb2c6aca3bb92296f0e2c8b2ec0de6e

 .../java/org/apache/kafka/common/record/Compressor.java   | 11 ++++++-----
 docs/upgrade.html                                         | 15 +++++++++++----
 2 files changed, 17 insertions(+), 9 deletions(-)
9a3fcf41350ddda9a41db18cde718f892b95177c

 .../java/org/apache/kafka/common/record/Compressor.java   | 11 ++++++-----
 docs/upgrade.html                                         | 15 +++++++++++----
 2 files changed, 17 insertions(+), 9 deletions(-)
27a19b964af35390d78e1b3b50bc03d23327f4d0

 docs/implementation.html | 62 ++++++++++++++++++++++++++++--------------------
 1 file changed, 36 insertions(+), 26 deletions(-)
61f4c8b0923baa17bfc6160082fc2c8ca5a2c44d

 docs/implementation.html | 62 ++++++++++++++++++++++++++++--------------------
 1 file changed, 36 insertions(+), 26 deletions(-)
6a5d3e65c6ba9faa0f6cf4ec2871a83beb28c6c4

 .../scala/kafka/server/KafkaRequestHandler.scala   | 42 +++++++++++++++++-----
 .../main/scala/kafka/server/ReplicaManager.scala   | 17 ++++-----
 .../scala/unit/kafka/metrics/MetricsTest.scala     | 15 ++++++--
 3 files changed, 56 insertions(+), 18 deletions(-)
7bfeade97a120690ca179c71ea715e21ea40f6ea

 docs/upgrade.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
62985f313f4b66d3810b05650d2a3f42b6cb054e

 docs/upgrade.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
5834a6a562d0fcdf5dbebb4371b5fe2c783740ca

 docs/upgrade.html | 7 +++++++
 1 file changed, 7 insertions(+)
7ded19a29ec140de93d57a9eb01722e6a8f2012a

 docs/upgrade.html | 7 +++++++
 1 file changed, 7 insertions(+)
bca95cba96212dc3460d0a87fd4dceb6ce322ccc

 clients/src/main/java/org/apache/kafka/common/record/Record.java | 6 +++++-
 docs/upgrade.html                                                | 2 +-
 tests/kafkatest/services/performance/producer_performance.py     | 2 +-
 3 files changed, 7 insertions(+), 3 deletions(-)
13130139ff70d0127e87d2c87dd5e62e6320fa45

 clients/src/main/java/org/apache/kafka/common/record/Record.java | 6 +++++-
 docs/upgrade.html                                                | 2 +-
 tests/kafkatest/services/performance/producer_performance.py     | 2 +-
 3 files changed, 7 insertions(+), 3 deletions(-)
e0c741d4e7a8e996f8432d9cf803a0fddb76fc70

 clients/src/main/java/org/apache/kafka/common/serialization/Serdes.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
51b63c421460a00884e7f00a648c41ed31eb6dd5

 clients/src/main/java/org/apache/kafka/common/serialization/Serdes.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
08205de185090b0cd744844b58b1508c82459d28

 clients/src/main/java/org/apache/kafka/common/serialization/Serdes.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
cceaaf9eee0f52af9ef2bf8cde9509e7cbfeca5f

 core/src/main/scala/kafka/log/Log.scala          | 20 +++++++++--------
 core/src/test/scala/unit/kafka/log/LogTest.scala | 28 ++++++++++++++++++++++++
 2 files changed, 39 insertions(+), 9 deletions(-)
1c4b943f2d9cc90101026519769f142c07bc1785

 core/src/main/scala/kafka/log/Log.scala          | 20 +++++++++--------
 core/src/test/scala/unit/kafka/log/LogTest.scala | 28 ++++++++++++++++++++++++
 2 files changed, 39 insertions(+), 9 deletions(-)
c6ba42c7069377c0c3d46e8b6c2e63a420dc874c

 bin/kafka-run-class.sh | 50 +++++++++++++++++++++++++-------------------------
 1 file changed, 25 insertions(+), 25 deletions(-)
fb421dbcfe36c4a0d9df7a742c18c11515f095c5

 bin/kafka-run-class.sh | 50 +++++++++++++++++++++++++-------------------------
 1 file changed, 25 insertions(+), 25 deletions(-)
f696bd2244f018365d487424bd72b6195e120fff

 .../org/apache/kafka/streams/KafkaStreams.java     |  14 ++-
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 106 +++++++++++++++++++++
 2 files changed, 115 insertions(+), 5 deletions(-)
f34164eed53d791768f05df21f4dfeca89859b2e

 .../org/apache/kafka/streams/KafkaStreams.java     |  14 ++-
 .../org/apache/kafka/streams/KafkaStreamsTest.java | 106 +++++++++++++++++++++
 2 files changed, 115 insertions(+), 5 deletions(-)
d43ea744f4f2d02e5415b0669b1d7ecb5dcacf61

 tests/kafkatest/services/connect.py                |  9 ++++-
 .../tests/connect/connect_distributed_test.py      |  3 ++
 tests/kafkatest/tests/connect/connect_rest_test.py | 42 +++++++++++++++++-----
 tests/kafkatest/tests/connect/connect_test.py      |  3 ++
 .../connect/templates/connect-file-sink.properties |  2 +-
 .../templates/connect-file-source.properties       |  2 +-
 6 files changed, 49 insertions(+), 12 deletions(-)
81f76bde8565eaffd67e5adaa69ddfdb4f5cebaa

 tests/kafkatest/services/connect.py                |  9 ++++-
 .../tests/connect/connect_distributed_test.py      |  3 ++
 tests/kafkatest/tests/connect/connect_rest_test.py | 42 +++++++++++++++++-----
 tests/kafkatest/tests/connect/connect_test.py      |  3 ++
 .../connect/templates/connect-file-sink.properties |  2 +-
 .../templates/connect-file-source.properties       |  2 +-
 6 files changed, 49 insertions(+), 12 deletions(-)
c6e9717dfd3b9a9c16c32cb7ac64abc7ce3ebe6c

 config/connect-distributed.properties | 14 +++++++--
 docs/connect.html                     | 54 +++++++++++++++++++++++++----------
 2 files changed, 50 insertions(+), 18 deletions(-)
527b98d82f5142ab6a5efc26e84f6b0a21aec062

 config/connect-distributed.properties | 14 +++++++--
 docs/connect.html                     | 54 +++++++++++++++++++++++++----------
 2 files changed, 50 insertions(+), 18 deletions(-)
563611935d5d559722712cb00820c31a42d5726c

 doap_Kafka.rdf | 15 ++++-----------
 1 file changed, 4 insertions(+), 11 deletions(-)
056a78dff96ee96e8c9481d16081645f511960ab

 streams/src/test/java/org/apache/kafka/streams/StreamsConfigTest.java | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
ac434a4ebdc36338ff707c38e189f9d1668ff423

 streams/src/test/java/org/apache/kafka/streams/StreamsConfigTest.java | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
553cc6487e7bb032351aade0232fa8537be76a64

 .../java/org/apache/kafka/streams/StreamsConfig.java |  2 +-
 .../org/apache/kafka/streams/StreamsConfigTest.java  | 20 ++++++++++++++++++++
 2 files changed, 21 insertions(+), 1 deletion(-)
5aedde5b29cc5a1adea4c65d5c44fb657f162eab

 .../java/org/apache/kafka/streams/StreamsConfig.java |  2 +-
 .../org/apache/kafka/streams/StreamsConfigTest.java  | 20 ++++++++++++++++++++
 2 files changed, 21 insertions(+), 1 deletion(-)
addbaefa6a254013853f05c938996919d5097da8

 docs/upgrade.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
84d17bdf220292dc9950566afe1de34b64be4746

 docs/upgrade.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f4dc90e9e277abd70e6156e4b7e51194154be92c

 docs/connect.html | 49 +++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 49 insertions(+)
4807dd1df945f6e66c6276f0a85e8abeb24b568a

 docs/connect.html | 49 +++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 49 insertions(+)
05640c86eebc673f110604e0c7b3fa3315dfcd7b

 .../java/org/apache/kafka/common/record/Compressor.java | 17 ++++++-----------
 .../java/org/apache/kafka/common/record/Record.java     |  2 +-
 docs/upgrade.html                                       |  1 +
 3 files changed, 8 insertions(+), 12 deletions(-)
1182d61deb23b5cd86cbe462471f7df583a796e1

 .../java/org/apache/kafka/common/record/Compressor.java | 17 ++++++-----------
 .../java/org/apache/kafka/common/record/Record.java     |  2 +-
 docs/upgrade.html                                       |  1 +
 3 files changed, 8 insertions(+), 12 deletions(-)
dca78b586fd2561709793f163c7c3f05e194d768

 tests/kafkatest/services/kafka/kafka.py                  | 16 +++++++++++++++-
 .../kafkatest/services/kafka/templates/kafka.properties  |  1 +
 tests/kafkatest/tests/core/replication_test.py           | 11 ++++-------
 tests/kafkatest/tests/produce_consume_validate.py        |  2 +-
 4 files changed, 21 insertions(+), 9 deletions(-)
f892f0ca6d38cb21a93c2c05dd8b9a23c4165181

 tests/kafkatest/services/kafka/kafka.py                  | 16 +++++++++++++++-
 .../kafkatest/services/kafka/templates/kafka.properties  |  1 +
 tests/kafkatest/tests/core/replication_test.py           | 11 ++++-------
 tests/kafkatest/tests/produce_consume_validate.py        |  2 +-
 4 files changed, 21 insertions(+), 9 deletions(-)
2e078d9d8f8b5788ec7bf897cbfe65dce83c92b1

 .../apache/kafka/common/network/Authenticator.java | 10 +--
 .../apache/kafka/common/network/KafkaChannel.java  |  5 +-
 .../kafka/common/network/SslTransportLayer.java    |  9 ++-
 .../java/org/apache/kafka/common/utils/Utils.java  | 23 +++++++
 .../org/apache/kafka/common/utils/UtilsTest.java   | 80 ++++++++++++++++++++++
 5 files changed, 112 insertions(+), 15 deletions(-)
b28bc57a1fdb9b56c89c3cb9c3df60afbeda521c

 .../apache/kafka/common/network/Authenticator.java | 10 +--
 .../apache/kafka/common/network/KafkaChannel.java  |  5 +-
 .../kafka/common/network/SslTransportLayer.java    |  9 ++-
 .../java/org/apache/kafka/common/utils/Utils.java  | 23 +++++++
 .../org/apache/kafka/common/utils/UtilsTest.java   | 80 ++++++++++++++++++++++
 5 files changed, 112 insertions(+), 15 deletions(-)
8ec8267c2666e423414305e5daf89c1ce5fd96bd

 .../main/java/org/apache/kafka/connect/data/SchemaBuilder.java   | 2 +-
 .../java/org/apache/kafka/connect/data/SchemaBuilderTest.java    | 9 ++++++++-
 .../apache/kafka/connect/storage/KafkaConfigBackingStore.java    | 2 +-
 3 files changed, 10 insertions(+), 3 deletions(-)
bd8681cdd51d2878ea917941abe335f68a373716

 .../main/java/org/apache/kafka/connect/data/SchemaBuilder.java   | 2 +-
 .../java/org/apache/kafka/connect/data/SchemaBuilderTest.java    | 9 ++++++++-
 .../apache/kafka/connect/storage/KafkaConfigBackingStore.java    | 2 +-
 3 files changed, 10 insertions(+), 3 deletions(-)
3178ecf11331e9e3e643c7ccdbd28afaf4b0e9b9

 docs/ops.html | 11 +++++++++++
 1 file changed, 11 insertions(+)
6978115514fc74021e4f2c761402d6b0c954d50c

 docs/ops.html | 11 +++++++++++
 1 file changed, 11 insertions(+)
5bfba1decaf3c11bbd7563c8993d7f68739bedb5

 .../kafka/common/network/PlaintextTransportLayer.java      | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)
e20eba958d8de29cb4e3b6feea37ac3a1e1ab4f9

 .../kafka/common/network/PlaintextTransportLayer.java      | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)
3e89d2bc59b1bf6c73b262a36019df01af7a958c

 core/src/main/scala/kafka/server/KafkaConfig.scala   |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala        | 20 ++++++--------------
 .../kafka/server/ServerGenerateBrokerIdTest.scala    |  8 ++++++++
 3 files changed, 15 insertions(+), 15 deletions(-)
9ca393407ea8dfbacc5c8af388a6c815497751fd

 core/src/test/scala/integration/kafka/api/BaseProducerSendTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
fe0335ea1030ca61f38b343a67c78e6537d25717

 core/src/test/scala/integration/kafka/api/BaseProducerSendTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2a969664599c7f617fc16c47945a093e9950dd81

 docs/api.html           | 19 +++++++++++++++++++
 docs/documentation.html |  1 +
 docs/quickstart.html    | 18 +++++++++---------
 docs/upgrade.html       |  1 +
 docs/uses.html          |  2 +-
 5 files changed, 31 insertions(+), 10 deletions(-)
6f1873242c1a189770319e09f53467d26584112f

 docs/api.html           | 19 +++++++++++++++++++
 docs/documentation.html |  1 +
 docs/quickstart.html    | 18 +++++++++---------
 docs/upgrade.html       |  1 +
 docs/uses.html          |  2 +-
 5 files changed, 31 insertions(+), 10 deletions(-)
df485d68ca7337c4e1bb7c68afe38bf6b5302681

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
7c45a5ea76079a0ad402c3fa7c7461741dd857a9

 .../org/apache/kafka/connect/runtime/AbstractHerder.java |  2 +-
 .../apache/kafka/connect/runtime/ConnectorConfig.java    | 16 +++++-----------
 .../kafka/connect/runtime/SinkConnectorConfig.java       |  4 ++++
 .../kafka/connect/runtime/SourceConnectorConfig.java     |  4 ++++
 4 files changed, 14 insertions(+), 12 deletions(-)
9575e93070a480eb1ef1e136a67ce0226914b937

 .../org/apache/kafka/connect/runtime/AbstractHerder.java |  2 +-
 .../apache/kafka/connect/runtime/ConnectorConfig.java    | 16 +++++-----------
 .../kafka/connect/runtime/SinkConnectorConfig.java       |  4 ++++
 .../kafka/connect/runtime/SourceConnectorConfig.java     |  4 ++++
 4 files changed, 14 insertions(+), 12 deletions(-)
cb20e8442145c82e718f8b5ae20d40d068b5b4d9

 docs/implementation.html | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
18226ff0be6f98795b98dd505d8ac0b4f3cf8c07

 docs/implementation.html | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
e76d9e958157dc4838660811ec37af076e2e0454

 .../connect/storage/KafkaConfigBackingStore.java   |   2 +-
 tests/kafkatest/services/connect.py                |  28 +++-
 tests/kafkatest/services/kafka/kafka.py            |   2 +-
 .../tests/connect/connect_distributed_test.py      | 146 ++++++++++++++++++++-
 4 files changed, 166 insertions(+), 12 deletions(-)
f96da638ee9a4e1e47ece1ea337ee071d911c3da

 .../connect/storage/KafkaConfigBackingStore.java   |   2 +-
 tests/kafkatest/services/connect.py                |  28 +++-
 tests/kafkatest/services/kafka/kafka.py            |   2 +-
 .../tests/connect/connect_distributed_test.py      | 146 ++++++++++++++++++++-
 4 files changed, 166 insertions(+), 12 deletions(-)
7699f3a395cadd9d0078e9918744955b2c610136

 docs/introduction.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
eb1de107b0c29e322999d9052b82b1e042d8fcfd

 docs/introduction.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f4ed61cbdd785339e8db12685bd22358747bd35b

 .../tests/core/security_rolling_upgrade_test.py    | 63 ++++++++++++++++++++++
 tests/kafkatest/tests/core/upgrade_test.py         |  6 ++-
 2 files changed, 68 insertions(+), 1 deletion(-)
87285f36c9cd8e1d9861f6dfaacef978772fb7f1

 .../tests/core/security_rolling_upgrade_test.py    | 63 ++++++++++++++++++++++
 tests/kafkatest/tests/core/upgrade_test.py         |  6 ++-
 2 files changed, 68 insertions(+), 1 deletion(-)
57ae46f055a1e9db13a6e56a8997796a505bca03

 docs/connect.html | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
36ed00d9bf82d48b0a02b6414734b7698c9ac4ea

 docs/connect.html | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
22c098b71b38d22a01e142716d5ac8ee3d07b9c6

 build.gradle | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)
7876318c28bb477f536ddb48401980eb466a04c2

 .../kafka/clients/consumer/internals/PartitionAssignor.java  | 12 ++++++++++++
 1 file changed, 12 insertions(+)
ff8580da6fb1d65b206df544ebd574222abe7f3f

 .../kafka/clients/consumer/internals/PartitionAssignor.java  | 12 ++++++++++++
 1 file changed, 12 insertions(+)
48908fe60225e3af532888284eb347dd6b0a2ff9

 .../scala/kafka/message/ByteBufferMessageSet.scala | 13 ++--
 .../kafka/message/InvalidMessageException.scala    |  3 +-
 .../unit/kafka/server/ProduceRequestTest.scala     | 86 ++++++++++++++++++++++
 3 files changed, 95 insertions(+), 7 deletions(-)
4331bf4ff2d0e7ab1a24ea29382897162c1ed91c

 .../scala/kafka/message/ByteBufferMessageSet.scala | 13 ++--
 .../kafka/message/InvalidMessageException.scala    |  3 +-
 .../unit/kafka/server/ProduceRequestTest.scala     | 86 ++++++++++++++++++++++
 3 files changed, 95 insertions(+), 7 deletions(-)
9181ecf247297ea7f7cdd2b69a578a487c74fdf5

 core/src/main/scala/kafka/log/LogCleaner.scala     | 27 ++++++++++++------
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 33 ++++++++++++++++++++++
 2 files changed, 51 insertions(+), 9 deletions(-)
2caf872c2e51d689c6ac20240c4a306e36d98b15

 core/src/main/scala/kafka/log/LogCleaner.scala     | 27 ++++++++++++------
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 33 ++++++++++++++++++++++
 2 files changed, 51 insertions(+), 9 deletions(-)
2a1b3b93b661a00055878948023d5b3901e18621

 .../org/apache/kafka/streams/kstream/internals/KStreamJoinWindow.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
29a682e2ea1918b50c6fd4c36ce399242929e5ae

 .../org/apache/kafka/streams/kstream/internals/KStreamJoinWindow.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
1142f51bf72095c8817db52c23d3a20d2099a5dd

 docs/connect.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
b86378840a2a6defcbdc59c1c1462ecbfd2c47d4

 docs/connect.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
9f583d96f68578fa6fa395805b0e1057b58d1ac7

 core/src/test/scala/unit/kafka/network/SocketServerTest.scala | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
bce3415b18fd0d2b7ab05330f2590f98939b8850

 core/src/test/scala/unit/kafka/network/SocketServerTest.scala | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
7a0b9eb06342d23c985fc898c2a69c6e93bc3318

 tests/kafkatest/tests/core/upgrade_test.py | 4 ++++
 1 file changed, 4 insertions(+)
f5b98b8fa786ff0ca37c5cba6d43c3390d28436e

 tests/kafkatest/tests/core/upgrade_test.py | 4 ++++
 1 file changed, 4 insertions(+)
1ee36c940ee656e575b8a0aa7cc66df380bb0978

 .../runtime/distributed/DistributedHerder.java     |  22 +-
 .../connect/storage/KafkaConfigBackingStore.java   |  30 ++-
 .../connect/runtime/WorkerSourceTaskTest.java      |   4 +-
 .../runtime/distributed/DistributedHerderTest.java | 204 ++++++++++++++++
 .../storage/KafkaConfigBackingStoreTest.java       | 258 ++++++++++++++++++++-
 5 files changed, 498 insertions(+), 20 deletions(-)
8911660e2e7d9553502974393ad1aa04852c2da2

 .../runtime/distributed/DistributedHerder.java     |  22 +-
 .../connect/storage/KafkaConfigBackingStore.java   |  30 ++-
 .../connect/runtime/WorkerSourceTaskTest.java      |   4 +-
 .../runtime/distributed/DistributedHerderTest.java | 204 ++++++++++++++++
 .../storage/KafkaConfigBackingStoreTest.java       | 258 ++++++++++++++++++++-
 5 files changed, 498 insertions(+), 20 deletions(-)
18f643b82b05904516295e2734af0d8a9fb053ea

 .../src/main/java/org/apache/kafka/connect/cli/ConnectStandalone.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
fc89083f812a513699f5f0c02648f7a7927acf64

 .../src/main/java/org/apache/kafka/connect/cli/ConnectStandalone.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
76fa376e23e3442d4a57d239d696632d521279a6

 tests/kafkatest/services/connect.py                | 38 ++++++++++++----------
 tests/kafkatest/tests/connect/connect_rest_test.py | 25 +++++++-------
 tests/kafkatest/utils/util.py                      | 12 +++++++
 3 files changed, 45 insertions(+), 30 deletions(-)
dbafc631ad78c96f85361a3d5e1c4d203cedb26f

 tests/kafkatest/services/connect.py                | 38 ++++++++++++----------
 tests/kafkatest/tests/connect/connect_rest_test.py | 25 +++++++-------
 tests/kafkatest/utils/util.py                      | 12 +++++++
 3 files changed, 45 insertions(+), 30 deletions(-)
120baf9781e84defc6ac337aec6efc7877adcff9

 .../kafka/connect/runtime/AbstractHerder.java      | 11 +++--
 .../kafka/connect/runtime/ConnectorConfig.java     | 20 ++++----
 .../kafka/connect/runtime/SinkConnectorConfig.java | 46 ++++++++++++++++++
 .../connect/runtime/SourceConnectorConfig.java     | 27 +++++++++++
 .../runtime/distributed/DistributedHerder.java     | 13 +++--
 .../runtime/standalone/StandaloneHerder.java       | 19 ++++++--
 .../apache/kafka/connect/runtime/WorkerTest.java   |  8 ++--
 .../runtime/distributed/DistributedHerderTest.java | 10 ++--
 .../runtime/standalone/StandaloneHerderTest.java   | 55 +++++++++++++---------
 9 files changed, 155 insertions(+), 54 deletions(-)
d1bb2b9df105169c47f16d057c887acb7f8fe818

 .../kafka/connect/runtime/AbstractHerder.java      | 11 +++--
 .../kafka/connect/runtime/ConnectorConfig.java     | 20 ++++----
 .../kafka/connect/runtime/SinkConnectorConfig.java | 46 ++++++++++++++++++
 .../connect/runtime/SourceConnectorConfig.java     | 27 +++++++++++
 .../runtime/distributed/DistributedHerder.java     | 13 +++--
 .../runtime/standalone/StandaloneHerder.java       | 19 ++++++--
 .../apache/kafka/connect/runtime/WorkerTest.java   |  8 ++--
 .../runtime/distributed/DistributedHerderTest.java | 10 ++--
 .../runtime/standalone/StandaloneHerderTest.java   | 55 +++++++++++++---------
 9 files changed, 155 insertions(+), 54 deletions(-)
9f86c62a845c7e6a6f100dd6f22af12118969785

 .../kafka/clients/consumer/ConsumerConfig.java     |  7 +++--
 .../internals/ConsumerCoordinatorTest.java         | 14 ++++-----
 core/src/main/scala/kafka/admin/TopicCommand.scala | 35 ++++++++++++----------
 3 files changed, 31 insertions(+), 25 deletions(-)
62b9fa22545a8e254b4ffd07ddc5bd3315542548

 .../kafka/clients/consumer/ConsumerConfig.java     |  7 +++--
 .../internals/ConsumerCoordinatorTest.java         | 14 ++++-----
 core/src/main/scala/kafka/admin/TopicCommand.scala | 35 ++++++++++++----------
 3 files changed, 31 insertions(+), 25 deletions(-)
a1afbab3edadeed96825deb512a7961fbce26e1f

 .../kafka/controller/PartitionLeaderSelector.scala |  9 +--
 .../ControlledShutdownLeaderSelectorTest.scala     | 73 ++++++++++++++++++++++
 2 files changed, 76 insertions(+), 6 deletions(-)
51f7a35c929d9aa04d821098a2266902f9178d7c

 .../kafka/controller/PartitionLeaderSelector.scala |  9 +--
 .../ControlledShutdownLeaderSelectorTest.scala     | 73 ++++++++++++++++++++++
 2 files changed, 76 insertions(+), 6 deletions(-)
c8ef1778c91c05061dfce19f6edf0c22d8806fbe

 .../org/apache/kafka/common/record/Compressor.java |   7 +-
 .../common/record/KafkaLZ4BlockInputStream.java    |  68 +++++++---
 .../common/record/KafkaLZ4BlockOutputStream.java   |  89 +++++++------
 .../apache/kafka/common/record/MemoryRecords.java  |  12 +-
 .../apache/kafka/common/record/KafkaLZ4Test.java   | 137 +++++++++++++++++++++
 core/src/main/scala/kafka/log/LogCleaner.scala     |   2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   7 +-
 .../scala/kafka/message/CompressionFactory.scala   |   8 +-
 .../kafka/message/MessageCompressionTest.scala     |  21 ++++
 .../unit/kafka/message/MessageWriterTest.scala     |   6 +-
 docs/upgrade.html                                  |   5 +
 11 files changed, 289 insertions(+), 73 deletions(-)
8fe2552239863f3a01d01708d55edf3c7082ff92

 .../org/apache/kafka/common/record/Compressor.java |   7 +-
 .../common/record/KafkaLZ4BlockInputStream.java    |  68 +++++++---
 .../common/record/KafkaLZ4BlockOutputStream.java   |  89 +++++++------
 .../apache/kafka/common/record/MemoryRecords.java  |  12 +-
 .../apache/kafka/common/record/KafkaLZ4Test.java   | 137 +++++++++++++++++++++
 core/src/main/scala/kafka/log/LogCleaner.scala     |   2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   7 +-
 .../scala/kafka/message/CompressionFactory.scala   |   8 +-
 .../kafka/message/MessageCompressionTest.scala     |  21 ++++
 .../unit/kafka/message/MessageWriterTest.scala     |   6 +-
 docs/upgrade.html                                  |   5 +
 11 files changed, 289 insertions(+), 73 deletions(-)
2277b3c43edc3b756c8262373846e93589998997

 .../main/java/org/apache/kafka/clients/ClientUtils.java | 10 ++++++----
 .../java/org/apache/kafka/clients/ClientUtilsTest.java  | 17 +++++++++++++++--
 2 files changed, 21 insertions(+), 6 deletions(-)
c4bbf342432291220242ad4177fd72a959ddcb94

 .../main/java/org/apache/kafka/clients/ClientUtils.java | 10 ++++++----
 .../java/org/apache/kafka/clients/ClientUtilsTest.java  | 17 +++++++++++++++--
 2 files changed, 21 insertions(+), 6 deletions(-)
b904a427c0e5e5683590528e54da33226c075c0b

 .../producer/internals/RecordAccumulator.java      | 13 ++++++---
 .../producer/internals/RecordAccumulatorTest.java  | 31 ++++++++++++++++++++++
 2 files changed, 40 insertions(+), 4 deletions(-)
717eea8350feb670e8ba3dd3505c708a8a52de71

 .../producer/internals/RecordAccumulator.java      | 13 ++++++---
 .../producer/internals/RecordAccumulatorTest.java  | 31 ++++++++++++++++++++++
 2 files changed, 40 insertions(+), 4 deletions(-)
7ad2d3df8eb0b3c23baff04efc30a0b4c6752b19

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 ++
 1 file changed, 2 insertions(+)
58f9d7cf8a68824a8fc451cf7ff5fcfb696fa863

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 ++
 1 file changed, 2 insertions(+)
19850331272c19de15240403a03ca3812037947b

 core/src/main/scala/kafka/admin/ConsumerGroupCommand.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
aabf825145645828075f341eba1483384df18f26

 .gitignore                                         |   1 +
 tests/README.md                                    |  15 +++
 tests/kafkatest/benchmarks/core/benchmark_test.py  |   9 +-
 tests/kafkatest/directory_layout/__init__.py       |  14 +++
 tests/kafkatest/directory_layout/kafka_path.py     | 137 +++++++++++++++++++++
 .../sanity_checks/test_console_consumer.py         |  18 ++-
 .../kafkatest/sanity_checks/test_kafka_version.py  |   4 +-
 .../sanity_checks/test_performance_services.py     |   6 +-
 .../sanity_checks/test_verifiable_producer.py      |   6 +-
 tests/kafkatest/services/connect.py                |  18 ++-
 tests/kafkatest/services/console_consumer.py       |  19 ++-
 tests/kafkatest/services/kafka/directory.py        |  32 -----
 tests/kafkatest/services/kafka/kafka.py            |  74 ++++++-----
 tests/kafkatest/services/kafka/version.py          |  69 -----------
 tests/kafkatest/services/kafka_log4j_appender.py   |   8 +-
 tests/kafkatest/services/mirror_maker.py           |  13 +-
 tests/kafkatest/services/monitor/jmx.py            |   9 +-
 .../services/performance/consumer_performance.py   |  10 +-
 .../services/performance/end_to_end_latency.py     |  15 ++-
 .../kafkatest/services/performance/performance.py  |   3 +-
 .../services/performance/producer_performance.py   |  21 ++--
 .../services/replica_verification_tool.py          |   8 +-
 tests/kafkatest/services/security/kafka_acls.py    |  10 +-
 tests/kafkatest/services/security/minikdc.py       |  37 +++---
 tests/kafkatest/services/simple_consumer_shell.py  |   8 +-
 tests/kafkatest/services/streams.py                |  13 +-
 tests/kafkatest/services/verifiable_consumer.py    |  18 +--
 tests/kafkatest/services/verifiable_producer.py    |  29 +++--
 tests/kafkatest/services/zookeeper.py              |  25 ++--
 .../tests/client/message_format_change_test.py     |  12 +-
 .../core/compatibility_test_new_broker_test.py     |  13 +-
 .../tests/core/security_rolling_upgrade_test.py    |   3 +-
 tests/kafkatest/tests/core/upgrade_test.py         |   9 +-
 .../tests/core/zookeeper_security_upgrade_test.py  |   4 +-
 tests/kafkatest/version.py                         |  80 ++++++++++++
 tests/setup.cfg                                    |  30 +++++
 tests/setup.py                                     |  29 ++++-
 tests/unit/__init__.py                             |  14 +++
 tests/unit/directory_layout/__init__.py            |  14 +++
 tests/unit/directory_layout/check_project_paths.py |  90 ++++++++++++++
 tests/unit/setup.cfg                               |  23 ++++
 tests/unit/version/__init__.py                     |  15 +++
 tests/unit/version/check_version.py                |  33 +++++
 43 files changed, 712 insertions(+), 306 deletions(-)
54092c12ed276b4bf91741e3c7fd315443f3c0b1

 .gitignore                                         |   1 +
 tests/README.md                                    |  17 +++
 tests/kafkatest/benchmarks/core/benchmark_test.py  |   9 +-
 tests/kafkatest/directory_layout/__init__.py       |  14 +++
 tests/kafkatest/directory_layout/kafka_path.py     | 137 +++++++++++++++++++++
 .../sanity_checks/test_console_consumer.py         |  18 ++-
 .../kafkatest/sanity_checks/test_kafka_version.py  |   4 +-
 .../sanity_checks/test_performance_services.py     |   6 +-
 .../sanity_checks/test_verifiable_producer.py      |   6 +-
 tests/kafkatest/services/connect.py                |  18 ++-
 tests/kafkatest/services/console_consumer.py       |  19 ++-
 tests/kafkatest/services/kafka/directory.py        |  32 -----
 tests/kafkatest/services/kafka/kafka.py            |  74 ++++++-----
 tests/kafkatest/services/kafka/version.py          |  69 -----------
 tests/kafkatest/services/kafka_log4j_appender.py   |   8 +-
 tests/kafkatest/services/mirror_maker.py           |  13 +-
 tests/kafkatest/services/monitor/jmx.py            |   9 +-
 .../services/performance/consumer_performance.py   |  10 +-
 .../services/performance/end_to_end_latency.py     |  15 ++-
 .../kafkatest/services/performance/performance.py  |   3 +-
 .../services/performance/producer_performance.py   |  21 ++--
 .../services/replica_verification_tool.py          |   8 +-
 tests/kafkatest/services/security/kafka_acls.py    |  10 +-
 tests/kafkatest/services/security/minikdc.py       |  37 +++---
 tests/kafkatest/services/simple_consumer_shell.py  |   8 +-
 tests/kafkatest/services/streams.py                |  13 +-
 tests/kafkatest/services/verifiable_consumer.py    |  18 +--
 tests/kafkatest/services/verifiable_producer.py    |  29 +++--
 tests/kafkatest/services/zookeeper.py              |  25 ++--
 .../tests/client/message_format_change_test.py     |  12 +-
 .../core/compatibility_test_new_broker_test.py     |  13 +-
 .../tests/core/security_rolling_upgrade_test.py    |   3 +-
 tests/kafkatest/tests/core/upgrade_test.py         |   9 +-
 .../tests/core/zookeeper_security_upgrade_test.py  |   4 +-
 tests/kafkatest/version.py                         |  80 ++++++++++++
 tests/setup.cfg                                    |  30 +++++
 tests/setup.py                                     |  29 ++++-
 tests/unit/__init__.py                             |  14 +++
 tests/unit/directory_layout/__init__.py            |  14 +++
 tests/unit/directory_layout/check_project_paths.py |  90 ++++++++++++++
 tests/unit/setup.cfg                               |  23 ++++
 tests/unit/version/__init__.py                     |  15 +++
 tests/unit/version/check_version.py                |  33 +++++
 43 files changed, 714 insertions(+), 306 deletions(-)
cda571dfc0a918c7125b09c94c175a5e6c09e798

 .../apache/kafka/streams/KafkaClientSupplier.java  | 47 ++++++++++++++++++
 .../org/apache/kafka/streams/KafkaStreams.java     | 17 ++++++-
 .../internals/DefaultKafkaClientSupplier.java      | 45 +++++++++++++++++
 .../streams/processor/internals/StreamThread.java  | 56 +++++-----------------
 .../internals/StreamPartitionAssignorTest.java     | 56 ++++------------------
 .../processor/internals/StreamThreadTest.java      | 42 ++++++++--------
 .../org/apache/kafka/test/MockClientSupplier.java  | 52 ++++++++++++++++++++
 7 files changed, 201 insertions(+), 114 deletions(-)
fec2d41bc2bed9f4effbd9922ca487bb02e5eeae

 .../apache/kafka/streams/KafkaClientSupplier.java  | 47 ++++++++++++++++++
 .../org/apache/kafka/streams/KafkaStreams.java     | 17 ++++++-
 .../internals/DefaultKafkaClientSupplier.java      | 45 +++++++++++++++++
 .../streams/processor/internals/StreamThread.java  | 56 +++++-----------------
 .../internals/StreamPartitionAssignorTest.java     | 56 ++++------------------
 .../processor/internals/StreamThreadTest.java      | 42 ++++++++--------
 .../org/apache/kafka/test/MockClientSupplier.java  | 52 ++++++++++++++++++++
 7 files changed, 201 insertions(+), 114 deletions(-)
4d0b06e838cfddd7c8c3a1a92287afba6d5ee3e9

 docs/ops.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
78de891ace41547d83901c3c18a9a01a517ccba1

 docs/ops.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
69bc4cac46e4448a155766ad4c4bfcab687e9ee3

 .../kafka/clients/consumer/KafkaConsumer.java      |  69 +++-
 .../consumer/internals/ConsumerCoordinator.java    |   7 +-
 .../consumer/internals/ConsumerNetworkClient.java  |  55 ++-
 .../kafka/clients/consumer/internals/Fetcher.java  |  13 +-
 .../consumer/internals/SubscriptionState.java      |  35 +-
 .../java/org/apache/kafka/clients/MockClient.java  |  55 ++-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 442 ++++++++++++++++++++-
 .../clients/consumer/internals/FetcherTest.java    |  34 +-
 8 files changed, 621 insertions(+), 89 deletions(-)
2ff955044aa875176aaa58a9be4a79c494a3fb27

 .../kafka/clients/consumer/KafkaConsumer.java      |  69 +++-
 .../consumer/internals/ConsumerCoordinator.java    |   7 +-
 .../consumer/internals/ConsumerNetworkClient.java  |  55 ++-
 .../kafka/clients/consumer/internals/Fetcher.java  |  13 +-
 .../consumer/internals/SubscriptionState.java      |  35 +-
 .../java/org/apache/kafka/clients/MockClient.java  |  55 ++-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 442 ++++++++++++++++++++-
 .../clients/consumer/internals/FetcherTest.java    |  34 +-
 8 files changed, 621 insertions(+), 89 deletions(-)
a037d1766383573f0ed2c542eb14356ba0457b5a

 core/src/main/scala/kafka/log/Log.scala            |  6 ++--
 core/src/main/scala/kafka/log/LogSegment.scala     | 40 ++++++++++++----------
 .../main/scala/kafka/server/ReplicaManager.scala   |  8 ++---
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 20 +++++++----
 .../unit/kafka/server/ReplicaManagerTest.scala     | 18 ++++++----
 5 files changed, 50 insertions(+), 42 deletions(-)
4a076a03bee376853713f4b5784b66b18ad5535c

 core/src/main/scala/kafka/log/Log.scala            |  6 ++--
 core/src/main/scala/kafka/log/LogSegment.scala     | 40 ++++++++++++----------
 .../main/scala/kafka/server/ReplicaManager.scala   |  8 ++---
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 20 +++++++----
 .../unit/kafka/server/ReplicaManagerTest.scala     | 18 ++++++----
 5 files changed, 50 insertions(+), 42 deletions(-)
f255cefb7d3932e300ccefaa3fabf806c7f713a0

 .../clients/producer/internals/BufferPool.java     | 26 ++++++--
 .../clients/producer/internals/BufferPoolTest.java | 77 +++++++++++++++++++++-
 2 files changed, 95 insertions(+), 8 deletions(-)
6856c5c214fb0a40b18cfb25db3dadae320c4142

 .../clients/producer/internals/BufferPool.java     | 26 ++++++--
 .../clients/producer/internals/BufferPoolTest.java | 77 +++++++++++++++++++++-
 2 files changed, 95 insertions(+), 8 deletions(-)
a57d5125d4a699c5fdaf05ef055dd7a0e7a6accd

 .../org/apache/kafka/clients/consumer/RangeAssignor.java    | 10 +---------
 .../apache/kafka/clients/consumer/RoundRobinAssignor.java   |  7 +++----
 .../consumer/internals/AbstractPartitionAssignor.java       | 13 ++++++++++---
 .../apache/kafka/clients/consumer/RangeAssignorTest.java    |  2 --
 .../kafka/clients/consumer/RoundRobinAssignorTest.java      |  2 --
 5 files changed, 14 insertions(+), 20 deletions(-)
8429db937e2134d9935d9dccd2ed0febc474fd66

 .../org/apache/kafka/clients/consumer/RangeAssignor.java    | 10 +---------
 .../apache/kafka/clients/consumer/RoundRobinAssignor.java   |  7 +++----
 .../consumer/internals/AbstractPartitionAssignor.java       | 13 ++++++++++---
 .../apache/kafka/clients/consumer/RangeAssignorTest.java    |  2 --
 .../kafka/clients/consumer/RoundRobinAssignorTest.java      |  2 --
 5 files changed, 14 insertions(+), 20 deletions(-)
940468011a6d127e823c7a59709c4381fb31694f

 .../org/apache/kafka/streams/integration/FanoutIntegrationTest.java     | 2 +-
 .../java/org/apache/kafka/streams/integration/JoinIntegrationTest.java  | 2 +-
 .../apache/kafka/streams/integration/MapFunctionIntegrationTest.java    | 2 +-
 .../apache/kafka/streams/integration/PassThroughIntegrationTest.java    | 2 +-
 .../org/apache/kafka/streams/integration/WordCountIntegrationTest.java  | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)
7f4e3ccde820eedd962b4cfd3abaecd8a49b83a8

 .../org/apache/kafka/streams/integration/FanoutIntegrationTest.java     | 2 +-
 .../java/org/apache/kafka/streams/integration/JoinIntegrationTest.java  | 2 +-
 .../apache/kafka/streams/integration/MapFunctionIntegrationTest.java    | 2 +-
 .../apache/kafka/streams/integration/PassThroughIntegrationTest.java    | 2 +-
 .../org/apache/kafka/streams/integration/WordCountIntegrationTest.java  | 2 +-
 5 files changed, 5 insertions(+), 5 deletions(-)
a9df2e7ca2ee93ec723933985c746178293b6388

 .../sanity_checks/test_verifiable_producer.py        |  2 +-
 tests/kafkatest/services/console_consumer.py         | 11 ++++++++---
 tests/kafkatest/services/kafka_log4j_appender.py     |  9 +++------
 .../services/performance/end_to_end_latency.py       |  4 ++--
 tests/kafkatest/services/performance/performance.py  | 11 ++++++++++-
 .../services/performance/producer_performance.py     |  1 +
 .../kafkatest/services/replica_verification_tool.py  |  8 +++++++-
 tests/kafkatest/services/simple_consumer_shell.py    | 12 +++++-------
 tests/kafkatest/services/verifiable_consumer.py      | 20 +++++++++-----------
 tests/kafkatest/services/verifiable_producer.py      | 16 +++++++---------
 tests/setup.py                                       |  2 +-
 .../org/apache/kafka/tools/VerifiableConsumer.java   |  5 -----
 .../org/apache/kafka/tools/VerifiableProducer.java   |  6 +-----
 13 files changed, 55 insertions(+), 52 deletions(-)
b6cd0e2791e0e6a6ef02d069b3001ffb477f7c6c

 .../sanity_checks/test_verifiable_producer.py        |  2 +-
 tests/kafkatest/services/console_consumer.py         | 11 ++++++++---
 tests/kafkatest/services/kafka_log4j_appender.py     |  9 +++------
 .../services/performance/end_to_end_latency.py       |  4 ++--
 tests/kafkatest/services/performance/performance.py  | 11 ++++++++++-
 .../services/performance/producer_performance.py     |  1 +
 .../kafkatest/services/replica_verification_tool.py  |  8 +++++++-
 tests/kafkatest/services/simple_consumer_shell.py    | 12 +++++-------
 tests/kafkatest/services/verifiable_consumer.py      | 20 +++++++++-----------
 tests/kafkatest/services/verifiable_producer.py      | 16 +++++++---------
 tests/setup.py                                       |  2 +-
 .../org/apache/kafka/tools/VerifiableConsumer.java   |  5 -----
 .../org/apache/kafka/tools/VerifiableProducer.java   |  6 +-----
 13 files changed, 55 insertions(+), 52 deletions(-)
1fb0d796bb93afe21a035764dc5e70292a76e061

 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +-
 .../consumer/internals/AbstractCoordinator.java    |  12 +-
 .../consumer/internals/ConsumerCoordinator.java    |   4 +-
 .../java/org/apache/kafka/clients/MockClient.java  |  24 +++-
 .../internals/AbstractCoordinatorTest.java         | 137 +++++++++++++++++++++
 .../internals/ConsumerCoordinatorTest.java         |  94 +++++++-------
 .../runtime/distributed/WorkerGroupMember.java     |   4 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |   8 +-
 8 files changed, 225 insertions(+), 60 deletions(-)
32bf83e5a792c5ee9eb88660da71b73aad5bbc02

 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +-
 .../consumer/internals/AbstractCoordinator.java    |  12 +-
 .../consumer/internals/ConsumerCoordinator.java    |   4 +-
 .../java/org/apache/kafka/clients/MockClient.java  |  24 +++-
 .../internals/AbstractCoordinatorTest.java         | 137 +++++++++++++++++++++
 .../internals/ConsumerCoordinatorTest.java         |  94 +++++++-------
 .../runtime/distributed/WorkerGroupMember.java     |   4 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |   8 +-
 8 files changed, 225 insertions(+), 60 deletions(-)
e6be965eaf919c9ad903eae532f679d24c1be779

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
694303a3da18e73cb08dfe229a07c7b31e0fa10c

 tests/README.md         | 35 +++++++++++++++++------------------
 vagrant/aws/aws-init.sh |  2 +-
 2 files changed, 18 insertions(+), 19 deletions(-)
e9d10108b47018578a53d6863084c41baa3bb579

 .../clients/consumer/CommitFailedException.java    |  1 -
 .../clients/consumer/OffsetCommitCallback.java     | 13 ++++++++-
 .../consumer/RetriableCommitFailedException.java   | 32 ++++++++++++++++++++++
 .../consumer/internals/ConsumerCoordinator.java    |  9 +++++-
 .../internals/ConsumerCoordinatorTest.java         | 12 ++++----
 5 files changed, 59 insertions(+), 8 deletions(-)
ad316509787787afeed6e2a24a62fd22cadd09c7

 .../clients/consumer/CommitFailedException.java    |  1 -
 .../clients/consumer/OffsetCommitCallback.java     | 13 ++++++++-
 .../consumer/RetriableCommitFailedException.java   | 32 ++++++++++++++++++++++
 .../consumer/internals/ConsumerCoordinator.java    |  9 +++++-
 .../internals/ConsumerCoordinatorTest.java         | 12 ++++----
 5 files changed, 59 insertions(+), 8 deletions(-)
91130e4242f8000016a97a0e81a242ac41e5107c

 .../org/apache/kafka/common/protocol/Protocol.java |  6 +-
 .../authenticator/SaslServerAuthenticator.java     | 77 ++++++++++++++--------
 .../authenticator/SaslAuthenticatorTest.java       | 62 +++++++++++++++++
 .../main/scala/kafka/network/RequestChannel.scala  | 13 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  4 +-
 .../unit/kafka/server/ApiVersionsRequestTest.scala |  8 ++-
 .../kafka/server/SaslApiVersionsRequestTest.scala  | 17 ++++-
 7 files changed, 147 insertions(+), 40 deletions(-)
64451af9e08de428064dc232cd6dea0ea0b2a81d

 .../org/apache/kafka/common/protocol/Protocol.java |  4 ++
 .../authenticator/SaslServerAuthenticator.java     | 77 ++++++++++++++--------
 .../authenticator/SaslAuthenticatorTest.java       | 62 +++++++++++++++++
 .../main/scala/kafka/network/RequestChannel.scala  | 13 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  4 +-
 .../unit/kafka/server/ApiVersionsRequestTest.scala |  8 ++-
 .../kafka/server/SaslApiVersionsRequestTest.scala  | 17 ++++-
 7 files changed, 146 insertions(+), 39 deletions(-)
21351b5755a8ab90b79c6090d97389325a25fc4a

 .../apache/kafka/common/serialization/Serde.java   |  24 ++++-
 .../apache/kafka/common/serialization/Serdes.java  | 103 +++++++++------------
 .../org/apache/kafka/streams/StreamsConfig.java    |  10 +-
 .../apache/kafka/streams/StreamsConfigTest.java    |  32 ++++++-
 4 files changed, 99 insertions(+), 70 deletions(-)
c8c6ac3f6d2d590261acb35fabbf7418ae102d4e

 .../apache/kafka/common/serialization/Serde.java   |  24 ++++-
 .../apache/kafka/common/serialization/Serdes.java  | 103 +++++++++------------
 .../org/apache/kafka/streams/StreamsConfig.java    |  10 +-
 .../apache/kafka/streams/StreamsConfigTest.java    |  32 ++++++-
 4 files changed, 99 insertions(+), 70 deletions(-)
1587aeed9a551c7c755666040fe26d066dba6857

 .../main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java  | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
da7095f3689b7a16f2b9050a8b1e5a3d6d400b12

 .../main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java  | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
946d074f0e8403a0f993149012932af70c8ec829

 core/src/main/scala/kafka/server/KafkaApis.scala   |  9 +++++----
 .../scala/unit/kafka/server/LogOffsetTest.scala    | 22 +++++++++++++++++++++-
 2 files changed, 26 insertions(+), 5 deletions(-)
c46cc480214080844ef0ca04d96f1db61b1f2ea3

 core/src/main/scala/kafka/server/KafkaApis.scala   |  9 +++++----
 .../scala/unit/kafka/server/LogOffsetTest.scala    | 22 +++++++++++++++++++++-
 2 files changed, 26 insertions(+), 5 deletions(-)
a0f40770ab766c956c7f6d9a3eff0d089896abee

 .../kafka/clients/consumer/MockConsumer.java       |  6 +----
 .../processor/internals/ProcessorStateManager.java |  6 ++++-
 .../internals/StreamPartitionAssignor.java         | 27 ++++++++++++++--------
 .../internals/ProcessorStateManagerTest.java       |  4 ++--
 4 files changed, 26 insertions(+), 17 deletions(-)
f4bb4a6515dfbd5986ae9b3190bbb58dd8cf4e41

 checkstyle/import-control.xml                      |   1 +
 .../streams/integration/FanoutIntegrationTest.java | 166 +++++++++++++
 .../integration/InternalTopicIntegrationTest.java  |  16 +-
 .../streams/integration/JoinIntegrationTest.java   | 266 +++++++++++++++++++++
 .../integration/MapFunctionIntegrationTest.java    | 127 ++++++++++
 .../integration/PassThroughIntegrationTest.java    | 113 +++++++++
 .../integration/WordCountIntegrationTest.java      | 149 ++++++++++++
 7 files changed, 830 insertions(+), 8 deletions(-)
9b6761ccd6413228efb8849818e8b7a8ffceaaad

 checkstyle/checkstyle.xml                              |  4 +++-
 .../java/org/apache/kafka/streams/kstream/KTable.java  | 18 +++++++++---------
 .../kafka/streams/processor/StreamPartitioner.java     |  4 +++-
 3 files changed, 15 insertions(+), 11 deletions(-)
21e930b4b4ae2c96b990da8e53e92231b2698430

 .../scala/kafka/server/AbstractFetcherThread.scala |  59 ++++++++--
 .../kafka/server/AbstractFetcherThreadTest.scala   | 127 +++++++++++++++++++++
 2 files changed, 176 insertions(+), 10 deletions(-)
7a0821d653c6c99a26ded6046ea24722c8d8ad85

 .../scala/kafka/server/AbstractFetcherThread.scala |  59 ++++++++--
 .../kafka/server/AbstractFetcherThreadTest.scala   | 127 +++++++++++++++++++++
 2 files changed, 176 insertions(+), 10 deletions(-)
768328689a59fa0984c099768136328e529e9fee

 checkstyle/checkstyle.xml                              |  4 +++-
 .../java/org/apache/kafka/streams/kstream/KTable.java  | 18 +++++++++---------
 .../kafka/streams/processor/StreamPartitioner.java     |  4 +++-
 3 files changed, 15 insertions(+), 11 deletions(-)
b410ea37b092740bf3e2a6e04caa3cf681ebc0d3

 core/src/main/scala/kafka/admin/ConfigCommand.scala | 12 +++++++-----
 core/src/main/scala/kafka/admin/TopicCommand.scala  | 13 +++++++++----
 2 files changed, 16 insertions(+), 9 deletions(-)
41a8cb2520066b138ca2d9bbccb1dbdfdf577aa6

 clients/src/main/java/org/apache/kafka/common/config/ConfigDef.java   | 2 ++
 .../src/test/java/org/apache/kafka/common/config/ConfigDefTest.java   | 4 ++--
 2 files changed, 4 insertions(+), 2 deletions(-)
03a1f7d39c553835022987826df4762cfd39a639

 clients/src/main/java/org/apache/kafka/common/config/ConfigDef.java   | 2 ++
 .../src/test/java/org/apache/kafka/common/config/ConfigDefTest.java   | 4 ++--
 2 files changed, 4 insertions(+), 2 deletions(-)
2d93696634bd2a99858b4ba2578b87dae8b86a8a

 .../kafka/connect/runtime/AbstractHerder.java      |  5 -----
 .../resources/ConnectorPluginsResourceTest.java    | 25 +++++++++++++++++++---
 2 files changed, 22 insertions(+), 8 deletions(-)
50aacd660d4c4212ffa4a9dca7d45bcfe50af833

 .../kafka/connect/runtime/AbstractHerder.java      |  5 -----
 .../resources/ConnectorPluginsResourceTest.java    | 25 +++++++++++++++++++---
 2 files changed, 22 insertions(+), 8 deletions(-)
138b37d62b1799df9c63372519568fa302297775

 .../clients/producer/internals/BufferPool.java     | 22 +++++++----
 .../clients/producer/internals/BufferPoolTest.java | 45 +++++++++++++++++-----
 2 files changed, 49 insertions(+), 18 deletions(-)
94e12a2e1fbd2f43821643d67a0d91f03b3f94e5

 .../clients/producer/internals/BufferPool.java     | 22 +++++++----
 .../clients/producer/internals/BufferPoolTest.java | 45 +++++++++++++++++-----
 2 files changed, 49 insertions(+), 18 deletions(-)
4de0ed7d525a03cf41a855c0ef22d8f98224914f

 .../apache/kafka/clients/consumer/internals/ConsumerCoordinator.java    | 2 +-
 .../org/apache/kafka/clients/consumer/internals/PartitionAssignor.java  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
af013788436ae5652b531184770f2620f8914123

 .../apache/kafka/clients/consumer/internals/ConsumerCoordinator.java    | 2 +-
 .../org/apache/kafka/clients/consumer/internals/PartitionAssignor.java  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
b3d2c0dabbcfc8e5d286e181450029adefc9fee8

 checkstyle/import-control.xml                      |   1 +
 .../streams/integration/FanoutIntegrationTest.java | 166 +++++++++++++
 .../integration/InternalTopicIntegrationTest.java  |  16 +-
 .../streams/integration/JoinIntegrationTest.java   | 266 +++++++++++++++++++++
 .../integration/MapFunctionIntegrationTest.java    | 127 ++++++++++
 .../integration/PassThroughIntegrationTest.java    | 113 +++++++++
 .../integration/WordCountIntegrationTest.java      | 149 ++++++++++++
 7 files changed, 830 insertions(+), 8 deletions(-)
96f6aa8c4d28c2d4a228ffca58ef2e25a4446564

 .../src/main/java/org/apache/kafka/common/utils/Utils.java    |  2 +-
 .../test/java/org/apache/kafka/common/utils/UtilsTest.java    |  2 ++
 core/src/main/scala/kafka/cluster/BrokerEndPoint.scala        |  2 +-
 core/src/main/scala/kafka/cluster/EndPoint.scala              |  2 +-
 .../test/scala/unit/kafka/cluster/BrokerEndPointTest.scala    | 11 +++++++++++
 5 files changed, 16 insertions(+), 3 deletions(-)
88e5d5a9a16f4831b8a178355d38d203febe85f9

 .../src/main/java/org/apache/kafka/common/utils/Utils.java    |  2 +-
 .../test/java/org/apache/kafka/common/utils/UtilsTest.java    |  2 ++
 core/src/main/scala/kafka/cluster/BrokerEndPoint.scala        |  2 +-
 core/src/main/scala/kafka/cluster/EndPoint.scala              |  2 +-
 .../test/scala/unit/kafka/cluster/BrokerEndPointTest.scala    | 11 +++++++++++
 5 files changed, 16 insertions(+), 3 deletions(-)
e5363e1104dc6cdcdfb117bede6146984a4fe810

 .../org/apache/kafka/common/metrics/Sensor.java    |  2 +-
 .../main/scala/kafka/server/KafkaHealthcheck.scala | 57 +++++++++++-------
 core/src/main/scala/kafka/server/KafkaServer.scala |  5 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  2 +-
 .../integration/kafka/api/AdminClientTest.scala    |  2 +-
 .../integration/kafka/api/ProducerBounceTest.scala | 16 ++---
 core/src/test/scala/other/kafka/DeleteZKPath.scala | 44 --------------
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  2 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  2 +-
 .../kafka/server/SessionExpireListenerTest.scala   | 68 ++++++++++++++++++++++
 .../unit/kafka/utils/CommandLineUtilsTest.scala    |  2 +-
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala | 27 ++++-----
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala | 13 +++--
 14 files changed, 136 insertions(+), 108 deletions(-)
c7425be5be8d0c2786155fbc697d83f80827d084

 .../org/apache/kafka/common/metrics/Sensor.java    |  2 +-
 .../main/scala/kafka/server/KafkaHealthcheck.scala | 57 +++++++++++-------
 core/src/main/scala/kafka/server/KafkaServer.scala |  5 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  2 +-
 .../integration/kafka/api/AdminClientTest.scala    |  2 +-
 .../integration/kafka/api/ProducerBounceTest.scala | 16 ++---
 core/src/test/scala/other/kafka/DeleteZKPath.scala | 44 --------------
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  2 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  2 +-
 .../kafka/server/SessionExpireListenerTest.scala   | 68 ++++++++++++++++++++++
 .../unit/kafka/utils/CommandLineUtilsTest.scala    |  2 +-
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala | 27 ++++-----
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala | 13 +++--
 14 files changed, 136 insertions(+), 108 deletions(-)
1f528815de8d0e094ee5446794ab7325629ca7ed

 .../kafka/clients/consumer/MockConsumer.java       |  6 +----
 .../processor/internals/ProcessorStateManager.java |  6 ++++-
 .../internals/StreamPartitionAssignor.java         | 27 ++++++++++++++--------
 .../internals/ProcessorStateManagerTest.java       |  4 ++--
 4 files changed, 26 insertions(+), 17 deletions(-)
e6d814a3eb2998a3172404385f1a9010f42d5425

 .../main/java/org/apache/kafka/connect/file/FileStreamSourceTask.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
62253539d87e1ccb353673ed96adc98fb2d854ae

 .../main/java/org/apache/kafka/connect/file/FileStreamSourceTask.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
bf578f987bd303e672354e2f3a97552cc5145237

 vagrant/aws/aws-init.sh | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
2f39fb0d151301018339c8e6dfe61507f3f85b1b

 docs/protocol.html |  15 +++
 docs/security.html | 372 +++++++++++++++++++++++++++++++++++++++--------------
 2 files changed, 293 insertions(+), 94 deletions(-)
abac51dc0bf0d5bdc1d5414787da3191e00adcab

 docs/protocol.html |  15 +++
 docs/security.html | 372 +++++++++++++++++++++++++++++++++++++++--------------
 2 files changed, 293 insertions(+), 94 deletions(-)
3cfe73a2cadc2321602a6777444282180484fa9a

 tests/kafkatest/services/console_consumer.py | 24 +++++++++++++++++++-----
 1 file changed, 19 insertions(+), 5 deletions(-)
5c47b9f80e2130ab4cc76e2645e0ac0215bf8abe

 tests/kafkatest/services/console_consumer.py | 24 +++++++++++++++++++-----
 1 file changed, 19 insertions(+), 5 deletions(-)
51f981b5b0dc1bba919892ddaae09ce5832603a8

 core/src/main/scala/kafka/server/KafkaApis.scala   | 147 ++++++++++++---------
 .../main/scala/kafka/server/MetadataCache.scala    | 139 +++++++++++--------
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 3 files changed, 169 insertions(+), 119 deletions(-)
548638af118b4ef36e7b6a1c5cb172604ca732fa

 bin/kafka-run-class.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1e4dd66b19857f4f0ce3f83fd0a808885b0a88c1

 bin/kafka-run-class.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9eaf529ffb168e44a461be24b666eee00fdaf497

 .../main/java/org/apache/kafka/common/protocol/Protocol.java  |  6 ++----
 .../org/apache/kafka/common/requests/StopReplicaRequest.java  |  4 ++--
 .../org/apache/kafka/common/requests/RequestResponseTest.java | 11 ++++++-----
 3 files changed, 10 insertions(+), 11 deletions(-)
94d1878a9b7aaf57c7520fb5bdcd2f05aeec5853

 .../org/apache/kafka/common/metrics/stats/Min.java |  8 +++---
 .../apache/kafka/common/metrics/MetricsTest.java   | 32 ++++++++++++++++++++++
 2 files changed, 36 insertions(+), 4 deletions(-)
c97ceef8399ea6d1560fd5c3abec8a478120bf21

 gradle.properties           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
f38bba89e4633ae0fb6b81ce64b507bb2a2999cc

 .../java/org/apache/kafka/streams/KeyValue.java    | 16 +++---
 .../org/apache/kafka/streams/KeyValueTest.java     | 65 +++++++++++++++-------
 2 files changed, 52 insertions(+), 29 deletions(-)
60380e31d4bf6688d8d26ec44cf514a3c32731cb

 .../java/org/apache/kafka/streams/KeyValue.java    | 16 +++---
 .../org/apache/kafka/streams/KeyValueTest.java     | 65 +++++++++++++++-------
 2 files changed, 52 insertions(+), 29 deletions(-)
f0d9611866cfdcac120e85d2cd7a82f2f020ed5e
d0dedc6314bfd83d9b2b9a9557e3168e715981da

 .../runtime/distributed/ClusterConfigState.java    |  13 +-
 .../runtime/distributed/DistributedHerder.java     |  15 +--
 .../runtime/standalone/StandaloneHerder.java       |  16 +--
 .../kafka/connect/storage/ConfigBackingStore.java  |   5 +-
 .../connect/storage/KafkaConfigBackingStore.java   |  82 +++++--------
 .../connect/storage/MemoryConfigBackingStore.java  |  18 ++-
 .../storage/KafkaConfigBackingStoreTest.java       | 131 +++++++++++++++++----
 7 files changed, 174 insertions(+), 106 deletions(-)
096b8b84e0dba8cdf0e0f7afae8d118a68e06e6c

 .../main/java/org/apache/kafka/clients/producer/RecordMetadata.java | 6 ++++++
 1 file changed, 6 insertions(+)
3414d56121d8d2f66f8dd613453af71d5b3f0c5f

 .../apache/kafka/streams/kstream/JoinWindows.java  | 18 ++++
 .../kafka/streams/kstream/KGroupedTable.java       | 14 +++-
 .../org/apache/kafka/streams/kstream/KStream.java  | 95 +++++++++++++++++++++-
 .../kafka/streams/kstream/KStreamBuilder.java      | 14 +++-
 .../org/apache/kafka/streams/kstream/KTable.java   | 47 ++++++++++-
 .../apache/kafka/streams/processor/StateStore.java |  4 +-
 .../apache/kafka/streams/state/WindowStore.java    |  2 +
 7 files changed, 189 insertions(+), 5 deletions(-)
69d9a669d7bbfec1e33dd6177c5687ef7f9977df

 .../kafka/common/requests/ApiVersionsResponse.java |  14 ++
 .../authenticator/SaslServerAuthenticator.java     |  10 ++
 .../kafka/common/network/NetworkTestUtils.java     |  14 +-
 .../authenticator/SaslAuthenticatorTest.java       | 159 ++++++++++++++++++++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  12 +-
 .../unit/kafka/server/ApiVersionsRequestTest.scala |  23 +--
 .../scala/unit/kafka/server/ApiVersionsTest.scala  |   6 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  |  24 ++--
 .../kafka/server/SaslApiVersionsRequestTest.scala  |  78 ++++++++++
 9 files changed, 297 insertions(+), 43 deletions(-)
e50327331d7d4e2854297a377f6701d737599672

 .../apache/kafka/connect/runtime/WorkerConfig.java | 10 +++++++-
 .../kafka/connect/runtime/rest/RestServer.java     | 14 +++++++----
 .../kafka/connect/runtime/rest/RestServerTest.java | 28 +++++++++++++++-------
 3 files changed, 39 insertions(+), 13 deletions(-)
e29eac4bbb678aa3d5a29a75f413a7b10cc2f0b1

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala     |  8 ++++++++
 tests/kafkatest/services/console_consumer.py              | 15 +++++++++++----
 tests/kafkatest/services/verifiable_producer.py           |  6 ++++++
 .../java/org/apache/kafka/tools/VerifiableProducer.java   |  8 ++++++++
 4 files changed, 33 insertions(+), 4 deletions(-)
eb50d2f6ca9dee041689db6fe397a83ece05b9e2

 bin/kafka-run-class.sh                       | 57 ++++++++++++++++++++++------
 tests/kafkatest/services/security/minikdc.py |  5 +--
 tests/kafkatest/services/streams.py          | 10 +++--
 3 files changed, 54 insertions(+), 18 deletions(-)
fe6c481b38d6b1b61341e4e1a6237f64accfbfbc

 .../kafka/clients/consumer/KafkaConsumer.java      | 71 +++++++++++++++++-----
 1 file changed, 57 insertions(+), 14 deletions(-)
cea01af125a33b81f973a96501fe41ca9d698197

 .../sanity_checks/test_console_consumer.py         |  5 +-
 tests/kafkatest/services/kafka/kafka.py            | 14 ++--
 .../services/kafka/templates/kafka.properties      |  5 +-
 .../kafkatest/services/security/security_config.py | 27 ++++--
 .../services/security/templates/gssapi_jaas.conf   | 86 --------------------
 .../services/security/templates/jaas.conf          | 95 ++++++++++++++++++++++
 tests/kafkatest/tests/core/replication_test.py     |  7 +-
 7 files changed, 136 insertions(+), 103 deletions(-)
4ab4e4af814fb791fe6e8c2bd3381da8ca80b0b5

 .../examples/pageview/PageViewTypedDemo.java       |  4 +-
 .../examples/pageview/PageViewUntypedDemo.java     |  2 +-
 .../org/apache/kafka/streams/KafkaStreams.java     | 10 ++-
 .../java/org/apache/kafka/streams/KeyValue.java    | 17 +++++
 .../apache/kafka/streams/kstream/Aggregator.java   | 10 ++-
 .../kafka/streams/kstream/ForeachAction.java       | 10 ++-
 .../apache/kafka/streams/kstream/Initializer.java  |  7 +-
 .../apache/kafka/streams/kstream/JoinWindows.java  | 21 +++---
 .../org/apache/kafka/streams/kstream/KStream.java  | 10 +--
 .../kafka/streams/kstream/KStreamBuilder.java      | 15 ++--
 .../org/apache/kafka/streams/kstream/KTable.java   | 19 +++---
 .../kafka/streams/kstream/KeyValueMapper.java      |  9 ++-
 .../apache/kafka/streams/kstream/Predicate.java    |  9 ++-
 .../org/apache/kafka/streams/kstream/Reducer.java  |  9 ++-
 .../apache/kafka/streams/kstream/TimeWindows.java  | 18 +++--
 .../apache/kafka/streams/kstream/Transformer.java  |  8 +--
 .../kafka/streams/kstream/TransformerSupplier.java |  7 +-
 .../kafka/streams/kstream/UnlimitedWindows.java    |  9 ++-
 .../apache/kafka/streams/kstream/ValueJoiner.java  |  9 ++-
 .../apache/kafka/streams/kstream/ValueMapper.java  |  8 ++-
 .../kafka/streams/kstream/ValueTransformer.java    |  8 +--
 .../streams/kstream/ValueTransformerSupplier.java  |  7 +-
 .../org/apache/kafka/streams/kstream/Window.java   | 18 ++++-
 .../org/apache/kafka/streams/kstream/Windowed.java | 30 +++++---
 .../org/apache/kafka/streams/kstream/Windows.java  | 37 ++++------
 .../kstream/internals/KStreamWindowAggregate.java  |  2 +-
 .../kstream/internals/KStreamWindowReduce.java     |  2 +-
 .../kstream/internals/WindowedSerializer.java      |  4 +-
 .../internals/WindowedStreamPartitioner.java       |  6 +-
 .../ConsumerRecordTimestampExtractor.java          |  3 +-
 .../apache/kafka/streams/processor/Processor.java  |  9 +--
 .../kafka/streams/processor/ProcessorSupplier.java |  5 ++
 .../streams/processor/StateStoreSupplier.java      | 10 +++
 .../kafka/streams/processor/StreamPartitioner.java | 20 +++---
 .../org/apache/kafka/streams/processor/TaskId.java |  6 +-
 .../streams/processor/TimestampExtractor.java      |  8 ++-
 .../kafka/streams/processor/TopologyBuilder.java   | 64 +++++++++---------
 .../processor/WallclockTimestampExtractor.java     |  9 ++-
 .../streams/processor/internals/StreamThread.java  |  2 +-
 .../apache/kafka/streams/state/StateSerdes.java    | 79 ++++++++++++++++++++--
 .../apache/kafka/streams/state/WindowStore.java    |  2 +-
 .../kafka/streams/smoketest/SmokeTestClient.java   |  2 +-
 .../kafka/streams/smoketest/SmokeTestUtil.java     |  2 +-
 43 files changed, 383 insertions(+), 163 deletions(-)
68433dcfdc0ae078ee4e7d278c286a9b7c1b3e76

 .../examples/pageview/PageViewTypedDemo.java       |   4 +-
 .../examples/pageview/PageViewUntypedDemo.java     |   4 +-
 .../streams/examples/wordcount/WordCountDemo.java  |   2 +-
 .../kafka/streams/kstream/HoppingWindows.java      |  95 -----
 .../apache/kafka/streams/kstream/JoinWindows.java  |  27 +-
 .../apache/kafka/streams/kstream/TimeWindows.java  | 125 ++++++
 .../kafka/streams/kstream/TumblingWindows.java     |  74 ----
 .../kafka/streams/kstream/UnlimitedWindows.java    |  31 +-
 .../org/apache/kafka/streams/kstream/Window.java   |  14 +-
 .../org/apache/kafka/streams/kstream/Windows.java  |   6 +-
 .../streams/kstream/internals/HoppingWindow.java   |  37 --
 .../streams/kstream/internals/TimeWindow.java      |  33 ++
 .../streams/kstream/internals/TumblingWindow.java  |  38 --
 .../streams/kstream/internals/UnlimitedWindow.java |   8 +-
 .../kafka/streams/kstream/TimeWindowsTest.java     | 123 ++++++
 .../streams/kstream/UnlimitedWindowsTest.java      |  80 ++++
 .../internals/KStreamWindowAggregateTest.java      | 429 +++++++++++----------
 .../internals/WindowedStreamPartitionerTest.java   |   4 +-
 .../streams/kstream/internals/WindowsTest.java     |  70 ----
 .../kafka/streams/smoketest/SmokeTestClient.java   |   4 +-
 20 files changed, 644 insertions(+), 564 deletions(-)
0ada3b1fc215bb8efdf5c7ae27eb52b29e0fbbdc

 .../services/replica_verification_tool.py          | 81 ++++++++++++++++++++
 tests/kafkatest/services/verifiable_producer.py    |  8 +-
 .../tests/tools/replica_verification_test.py       | 88 ++++++++++++++++++++++
 3 files changed, 176 insertions(+), 1 deletion(-)
346df72736d03acb4a6f5681e705ce3e330900a8

 .../main/scala/kafka/controller/KafkaController.scala | 19 ++++++++++++++-----
 1 file changed, 14 insertions(+), 5 deletions(-)
fdded2da6e0f57431fc19fd1705bbb6373c1c863

 core/src/main/scala/kafka/server/KafkaConfig.scala | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
3a496f480d002a4512273477eda9d92731e600c3

 .../kafka/common/network/SaslChannelBuilder.java   |  13 +-
 .../apache/kafka/common/security/JaasUtils.java    |   2 +-
 .../apache/kafka/common/network/CertStores.java    |  46 +++
 .../kafka/common/network/NetworkTestUtils.java     |  80 ++++
 .../apache/kafka/common/network/NioEchoServer.java | 145 ++++++++
 .../common/network/SslTransportLayerTest.java      | 293 +++------------
 .../authenticator/SaslAuthenticatorTest.java       | 408 +++++++++++++++++++++
 .../authenticator/TestDigestLoginModule.java       | 109 ++++++
 .../security/authenticator/TestJaasConfig.java     |  89 +++++
 .../kafka/api/EndToEndAuthorizationTest.scala      |   5 +-
 .../kafka/api/SaslMultiMechanismConsumerTest.scala |   4 +-
 .../kafka/api/SaslPlainPlaintextConsumerTest.scala |   2 +-
 .../SaslPlainSslEndToEndAuthorizationTest.scala    |  28 ++
 .../scala/integration/kafka/api/SaslSetup.scala    |  13 +
 .../integration/kafka/api/SaslTestHarness.scala    |  13 -
 15 files changed, 982 insertions(+), 268 deletions(-)
316389d6adfb1398e30ca2ce5d586ea94d3f3110

 bin/kafka-run-class.sh                             |  6 +-
 checkstyle/import-control.xml                      |  1 +
 .../kafka/connect/runtime/AbstractHerder.java      | 10 ++-
 .../apache/kafka/connect/util/ReflectionsUtil.java | 90 ++++++++++++++++++++++
 .../resources/ConnectorPluginsResourceTest.java    |  3 +-
 5 files changed, 104 insertions(+), 6 deletions(-)
57831a56a581128e164b4372c5e5eb4b55038d4a

 .../unit/kafka/server/ApiVersionsRequestTest.scala | 50 ++++++++++++++++++++++
 .../scala/unit/kafka/server/BaseRequestTest.scala  |  8 ++--
 2 files changed, 55 insertions(+), 3 deletions(-)
669be7fadc808a8436ba28d033b70d24641c75ea

 .../main/java/org/apache/kafka/common/protocol/types/Struct.java  | 2 +-
 .../kafka/common/protocol/types/ProtocolSerializationTest.java    | 8 ++++++++
 2 files changed, 9 insertions(+), 1 deletion(-)
94aee2143ed5290d27cdd4072c6ae9bb70a6ba30

 build.gradle                                       |   2 +
 checkstyle/import-control.xml                      |  11 ++
 .../integration/InternalTopicIntegrationTest.java  | 169 ++++++++++++++++++
 .../utils/EmbeddedSingleNodeKafkaCluster.java      | 128 ++++++++++++++
 .../integration/utils/IntegrationTestUtils.java    | 157 +++++++++++++++++
 .../streams/integration/utils/KafkaEmbedded.java   | 189 +++++++++++++++++++++
 6 files changed, 656 insertions(+)
8407dac6ee409d832c95533e6f1d5578511232ae

 .../common/errors/UnsupportedVersionException.java |  25 +++++
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   5 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   5 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  41 +++++++-
 .../kafka/common/requests/AbstractRequest.java     |   4 +-
 .../kafka/common/requests/ApiVersionsRequest.java  |  55 ++++++++++
 .../kafka/common/requests/ApiVersionsResponse.java | 116 +++++++++++++++++++++
 .../kafka/common/requests/RequestResponseTest.java |  16 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  77 +++++++++-----
 .../scala/unit/kafka/server/ApiVersionsTest.scala  |  51 +++++++++
 10 files changed, 357 insertions(+), 38 deletions(-)
4c76b5fa6a72412efa5936c284800148c2c69c24

 .../org/apache/kafka/streams/kstream/internals/KStreamImpl.java    | 2 +-
 .../apache/kafka/streams/kstream/internals/KStreamImplTest.java    | 7 +++++++
 2 files changed, 8 insertions(+), 1 deletion(-)
2885bc33daaf75477bf39a92d1d1da02c0e03eaa

 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
77fa0b116f0cc8aba37884a1a5d487f8683f7845

 clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
33d745e2dcfa7a9cac90af5594903330ad774cd2

 .../org/apache/kafka/clients/NetworkClient.java    |  25 +--
 .../kafka/clients/consumer/KafkaConsumer.java      |   3 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  17 +--
 .../main/java/org/apache/kafka/common/Node.java    |  32 +++-
 .../org/apache/kafka/common/protocol/Protocol.java |  44 +++++-
 .../kafka/common/protocol/types/ArrayOf.java       |  33 +++-
 .../apache/kafka/common/protocol/types/Struct.java |  34 +++--
 .../apache/kafka/common/protocol/types/Type.java   |  43 +++++-
 .../kafka/common/requests/MetadataRequest.java     |  40 ++++-
 .../kafka/common/requests/MetadataResponse.java    | 101 +++++++++++--
 .../clients/consumer/internals/FetcherTest.java    |  11 +-
 .../protocol/types/ProtocolSerializationTest.java  |  13 +-
 .../kafka/common/requests/RequestResponseTest.java |  21 +--
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |   2 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |   4 +-
 core/src/main/scala/kafka/common/Topic.scala       |   5 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  65 +++++---
 .../main/scala/kafka/server/MetadataCache.scala    |  39 +++--
 .../main/scala/kafka/server/ReplicaManager.scala   |   4 +-
 .../scala/unit/kafka/server/BaseRequestTest.scala  | 106 +++++++++++++
 .../unit/kafka/server/MetadataCacheTest.scala      |  46 +++++-
 .../unit/kafka/server/MetadataRequestTest.scala    | 168 +++++++++++++++++++++
 23 files changed, 732 insertions(+), 128 deletions(-)
5b375d7bf9b26aaeed06bac2dc5de3f8214cbad4

 checkstyle/import-control.xml                      |   7 +
 .../java/org/apache/kafka/clients/ClientUtils.java |   4 +-
 .../org/apache/kafka/clients/NetworkClient.java    |  20 +-
 .../apache/kafka/common/config/SaslConfigs.java    |  15 +-
 .../common/errors/AuthenticationException.java     |  27 ++
 .../common/errors/IllegalSaslStateException.java   |  27 ++
 .../errors/UnsupportedSaslMechanismException.java  |  27 ++
 .../kafka/common/network/ChannelBuilders.java      |  14 +-
 .../kafka/common/network/SaslChannelBuilder.java   |  36 +-
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   3 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   8 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  13 +
 .../kafka/common/requests/AbstractRequest.java     |   2 +
 .../apache/kafka/common/requests/ResponseSend.java |   2 +-
 .../common/requests/SaslHandshakeRequest.java      |  83 +++++
 .../common/requests/SaslHandshakeResponse.java     |  85 +++++
 .../common/security/auth/AuthCallbackHandler.java  |  46 +++
 .../apache/kafka/common/security/auth/Login.java   |  57 +++
 .../security/authenticator/AbstractLogin.java      | 108 ++++++
 .../security/authenticator/DefaultLogin.java       |  32 ++
 .../security/authenticator/LoginManager.java       | 112 ++++++
 .../authenticator/SaslClientAuthenticator.java     | 242 ++++++++-----
 .../authenticator/SaslClientCallbackHandler.java   |  94 +++++
 .../authenticator/SaslServerAuthenticator.java     | 195 ++++++++--
 .../authenticator/SaslServerCallbackHandler.java   |  22 +-
 .../common/security/kerberos/KerberosLogin.java    | 392 +++++++++++++++++++++
 .../kafka/common/security/kerberos/Login.java      | 379 --------------------
 .../common/security/kerberos/LoginManager.java     | 130 -------
 .../common/security/plain/PlainLoginModule.java    |  66 ++++
 .../common/security/plain/PlainSaslServer.java     | 170 +++++++++
 .../security/plain/PlainSaslServerProvider.java    |  38 ++
 .../kafka/common/requests/RequestResponseTest.java |  11 +-
 .../java/org/apache/kafka/test/TestSslUtils.java   |   3 +
 .../src/main/scala/kafka/common/ErrorMapping.scala |   2 +
 .../controller/ControllerChannelManager.scala      |  10 +-
 .../main/scala/kafka/network/SocketServer.scala    |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   8 +
 core/src/main/scala/kafka/server/KafkaConfig.scala |  18 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   9 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  10 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |   9 +-
 .../kafka/api/BaseProducerSendTest.scala           |   4 +-
 .../kafka/api/EndToEndAuthorizationTest.scala      |   4 +-
 .../kafka/api/IntegrationTestHarness.scala         |   8 +-
 .../kafka/api/PlaintextConsumerTest.scala          |   2 +-
 .../kafka/api/SaslMultiMechanismConsumerTest.scala |  86 +++++
 .../kafka/api/SaslPlainPlaintextConsumerTest.scala |  27 ++
 .../scala/integration/kafka/api/SaslSetup.scala    |  36 +-
 .../integration/kafka/api/SaslTestHarness.scala    |  22 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   4 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   2 +
 .../scala/unit/kafka/utils/JaasTestUtils.scala     | 122 +++++--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  40 ++-
 53 files changed, 2171 insertions(+), 724 deletions(-)
cd427c9b905c161a6b135504dc515515de6a6438

 build.gradle |  2 +-
 gradlew      | 46 +++++++++++++++++++++++++---------------------
 gradlew.bat  |  6 +++---
 3 files changed, 29 insertions(+), 25 deletions(-)
5f316a58a1058ec230e8b4bfdfec1ce081589a20

 core/src/main/scala/kafka/api/FetchRequest.scala    | 4 +++-
 core/src/main/scala/kafka/api/ProducerRequest.scala | 5 +++--
 2 files changed, 6 insertions(+), 3 deletions(-)
2790d0cb1fc6ade216f2c1bf2667a0ebb53d85e3

 .../src/main/java/org/apache/kafka/clients/producer/KafkaProducer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
fbac525c08d54a26248eb8f9a5f7d3d053f99bd4

 core/src/main/scala/kafka/server/KafkaHealthcheck.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1a73629bb43bbc781e5a968a61f6079365bc75b7

 .../test/java/org/apache/kafka/test/TestUtils.java |  37 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   9 +-
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  13 +-
 .../kstream/internals/KGroupedTableImplTest.java   |  11 +-
 .../kstream/internals/KStreamBranchTest.java       |  13 +-
 .../kstream/internals/KStreamFilterTest.java       |  15 +-
 .../kstream/internals/KStreamFlatMapTest.java      |  13 +-
 .../internals/KStreamFlatMapValuesTest.java        |  13 +-
 .../kstream/internals/KStreamForeachTest.java      |  13 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  | 651 ++++++++++-----------
 .../internals/KStreamKStreamLeftJoinTest.java      | 341 ++++++-----
 .../internals/KStreamKTableLeftJoinTest.java       | 153 +++--
 .../streams/kstream/internals/KStreamMapTest.java  |  13 +-
 .../kstream/internals/KStreamMapValuesTest.java    |  13 +-
 .../kstream/internals/KStreamSelectKeyTest.java    |  13 +-
 .../kstream/internals/KStreamTransformTest.java    |  13 +-
 .../internals/KStreamTransformValuesTest.java      |  13 +-
 .../internals/KStreamWindowAggregateTest.java      | 455 +++++++-------
 .../kstream/internals/KTableAggregateTest.java     |  92 +--
 .../kstream/internals/KTableFilterTest.java        | 327 ++++++-----
 .../kstream/internals/KTableForeachTest.java       |  13 +-
 .../streams/kstream/internals/KTableImplTest.java  | 451 +++++++-------
 .../kstream/internals/KTableKTableJoinTest.java    | 394 ++++++-------
 .../internals/KTableKTableLeftJoinTest.java        | 397 ++++++-------
 .../internals/KTableKTableOuterJoinTest.java       | 426 +++++++-------
 .../kstream/internals/KTableMapKeysTest.java       |  13 +-
 .../kstream/internals/KTableMapValuesTest.java     | 381 ++++++------
 .../kstream/internals/KTableSourceTest.java        | 172 +++---
 .../internals/KeyValuePrinterProcessorTest.java    |  15 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  28 +-
 .../org/apache/kafka/test/MockKeyValueMapper.java  |   2 +-
 .../org/apache/kafka/test/MockValueJoiner.java     |  33 ++
 32 files changed, 2349 insertions(+), 2197 deletions(-)
f60a3fad38d22654e7560d56730e2dd74b5ae659

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 docs/configuration.html                            | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
9d37b9f4b6ba228ff7f7b99c8a0921a971fc03a6

 .../kafka/streams/state/WindowStoreUtils.java      | 63 ---------------------
 .../streams/state/internals/RocksDBStore.java      |  1 -
 .../state/internals/RocksDBWindowStore.java        |  1 -
 .../streams/state/internals/WindowStoreUtils.java  | 65 ++++++++++++++++++++++
 .../state/internals/RocksDBWindowStoreTest.java    |  1 -
 5 files changed, 65 insertions(+), 66 deletions(-)
088ab3eaadb2389b52aedc049b6f1f0d4b5fb989

 .../kstream/internals/KGroupedTableImpl.java       | 73 +++++++---------------
 1 file changed, 23 insertions(+), 50 deletions(-)
18dd1986bd354e8c7d75982112fad848780a6b33

 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
a02c8aaecfbd13838c2a062bac1455da352028fe

 .../common/serialization/BytesDeserializer.java    |  35 ++++
 .../common/serialization/BytesSerializer.java      |  36 +++++
 .../apache/kafka/common/serialization/Serdes.java  |  39 ++++-
 .../java/org/apache/kafka/common/utils/Bytes.java  | 178 +++++++++++++++++++++
 .../kafka/streams/state/WindowStoreUtils.java      |  10 +-
 .../internals/InMemoryKeyValueStoreSupplier.java   |  13 +-
 .../streams/state/internals/MemoryLRUCache.java    |  13 ++
 .../state/internals/MeteredKeyValueStore.java      |   8 +-
 .../state/internals/RawStoreChangeLogger.java      |  56 -------
 .../streams/state/internals/RocksDBStore.java      |  73 +++++----
 .../state/internals/RocksDBWindowStore.java        |  48 +++---
 .../streams/state/internals/StoreChangeLogger.java |  10 ++
 .../streams/state/KeyValueStoreTestDriver.java     |  15 +-
 .../state/internals/AbstractKeyValueStoreTest.java |   2 -
 .../state/internals/StoreChangeLoggerTest.java     |  41 -----
 15 files changed, 386 insertions(+), 191 deletions(-)
e7d04c2515be158d9a7f0ff0d7571bd41287d91a

 .../clients/producer/internals/RecordAccumulator.java    | 16 ++++++++++------
 .../apache/kafka/clients/producer/internals/Sender.java  |  2 +-
 .../producer/internals/RecordAccumulatorTest.java        | 14 +++++++-------
 3 files changed, 18 insertions(+), 14 deletions(-)
b3847f76b571deac5c7da7287a642c8b354a2a8c

 .../kafka/admin/ReassignPartitionsCommand.scala    |  19 ++--
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   4 +-
 .../admin/ReassignPartitionsClusterTest.scala      | 112 +++++++++++++++++++++
 3 files changed, 126 insertions(+), 9 deletions(-)
996e29cfe8a9e5a45d4b778a84fb20479eeba469

 .../kafka/streams/processor/internals/ProcessorStateManager.java     | 4 ++++
 .../org/apache/kafka/streams/processor/internals/StreamThread.java   | 1 +
 .../kafka/streams/processor/internals/ProcessorStateManagerTest.java | 5 ++++-
 3 files changed, 9 insertions(+), 1 deletion(-)
1b764c5e834c0d03f3c7107a58f21ad3bbb98ac3

 .../kstream/internals/KGroupedTableImplTest.java   | 86 ++++++++++++++++++++++
 1 file changed, 86 insertions(+)
bc5051565171cf65b4ed7dd4d9ef269d66a1021a

 .../connect/runtime/distributed/DistributedHerder.java   | 16 +++-------------
 .../runtime/rest/resources/ConnectorsResource.java       |  9 +++++++++
 .../runtime/rest/resources/ConnectorsResourceTest.java   |  8 ++++++++
 3 files changed, 20 insertions(+), 13 deletions(-)
c7f9bd2a68ea7bb604c4dcf2a2f0b030fc019ca7

 .../kafka/connect/runtime/AbstractHerder.java      | 49 ++++++++++++++++------
 1 file changed, 36 insertions(+), 13 deletions(-)
32740044972ad3bfc9539b5d76128dceddedc2ba

 .../java/org/apache/kafka/common/record/MemoryRecords.java    |  5 ++++-
 .../org/apache/kafka/common/record/MemoryRecordsTest.java     | 11 +++++++++++
 2 files changed, 15 insertions(+), 1 deletion(-)
74e6dc842559d344241c70cb6607a69291e3a20d

 .../kstream/internals/ChangedDeserializer.java     | 10 ++-
 .../kstream/internals/ChangedSerializer.java       | 10 ++-
 .../kstream/internals/KGroupedTableImpl.java       | 76 ++++++++++++----------
 .../streams/processor/internals/SinkNode.java      | 14 ++++
 .../streams/processor/internals/SourceNode.java    | 18 ++++-
 .../kstream/internals/KTableAggregateTest.java     | 39 ++---------
 .../streams/kstream/internals/KTableImplTest.java  | 49 ++++++++++++++
 .../org/apache/kafka/test/KStreamTestDriver.java   | 26 +++++++-
 .../java/org/apache/kafka/test/MockAggregator.java | 43 ++++++++++++
 .../org/apache/kafka/test/MockInitializer.java     | 33 ++++++++++
 .../org/apache/kafka/test/MockKeyValueMapper.java  | 36 ++++++++++
 .../java/org/apache/kafka/test/MockReducer.java    | 43 ++++++++++++
 .../org/apache/kafka/test/NoOpKeyValueMapper.java  | 29 ---------
 13 files changed, 325 insertions(+), 101 deletions(-)
5c547475d86aa336f8b3c4bb69faff39759d5df5

 .../kafka/streams/kstream/KGroupedTable.java       |  82 ++++++++++
 .../org/apache/kafka/streams/kstream/KTable.java   | 109 ++-----------
 .../kstream/internals/KGroupedTableImpl.java       | 172 +++++++++++++++++++++
 .../streams/kstream/internals/KTableImpl.java      | 162 ++-----------------
 .../kstream/internals/KTableAggregateTest.java     |  14 +-
 .../kafka/streams/smoketest/SmokeTestClient.java   |  17 +-
 6 files changed, 291 insertions(+), 265 deletions(-)
9d71489ff0e62fd1897c7a6f54671673db7b37b8

 checkstyle/checkstyle.xml                                        | 7 +++++++
 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 3 ++-
 .../org/apache/kafka/clients/consumer/internals/Fetcher.java     | 3 ++-
 .../java/org/apache/kafka/clients/producer/KafkaProducer.java    | 2 +-
 .../src/main/java/org/apache/kafka/common/config/ConfigDef.java  | 9 +++++----
 .../main/java/org/apache/kafka/common/metrics/stats/Rate.java    | 3 ++-
 .../java/org/apache/kafka/common/protocol/SecurityProtocol.java  | 3 ++-
 .../test/java/org/apache/kafka/test/MockConsumerInterceptor.java | 3 ++-
 .../api/src/main/java/org/apache/kafka/connect/data/Schema.java  | 3 ++-
 core/src/main/scala/kafka/consumer/ConsumerConfig.scala          | 3 ++-
 core/src/main/scala/kafka/log/LogConfig.scala                    | 5 +++--
 core/src/main/scala/kafka/message/CompressionCodec.scala         | 8 +++++---
 core/src/main/scala/kafka/tools/ConsoleConsumer.scala            | 4 ++--
 core/src/main/scala/kafka/tools/ConsoleProducer.scala            | 4 ++--
 core/src/main/scala/kafka/utils/Log4jController.scala            | 3 ++-
 core/src/main/scala/kafka/utils/Os.scala                         | 4 +++-
 .../test/scala/integration/kafka/api/PlaintextConsumerTest.scala | 3 ++-
 .../src/main/java/kafka/examples/KafkaConsumerProducerDemo.java  | 2 +-
 .../apache/kafka/streams/examples/wordcount/WordCountDemo.java   | 3 ++-
 .../kafka/streams/examples/wordcount/WordCountProcessorDemo.java | 3 ++-
 .../streams/kstream/internals/KStreamFlatMapValuesTest.java      | 3 ++-
 .../kafka/streams/kstream/internals/KStreamForeachTest.java      | 3 ++-
 .../kafka/streams/kstream/internals/KTableForeachTest.java       | 3 ++-
 23 files changed, 57 insertions(+), 30 deletions(-)
f213625fc55dd0eb9087ba6482ce67fcb737172d

 .../apache/kafka/connect/runtime/distributed/DistributedHerder.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
8a863ecee7e5dcdaf66a55b91040a7893ffdbf66

 .../java/org/apache/kafka/clients/Metadata.java    | 14 ++++--
 .../consumer/internals/AbstractCoordinator.java    |  4 +-
 .../consumer/internals/ConsumerCoordinator.java    | 49 ++++++++++++++-----
 .../consumer/internals/ConsumerNetworkClient.java  |  2 +-
 .../internals/ConsumerCoordinatorTest.java         | 56 ++++++++++++++++++++++
 .../test/java/org/apache/kafka/test/TestUtils.java | 21 ++++++--
 6 files changed, 125 insertions(+), 21 deletions(-)
c9485b78a6e43747daf1314ae9532839fb7bc810

 .../apache/kafka/common/config/AbstractConfig.java |   3 +-
 .../kafka/connect/cli/ConnectDistributed.java      |  10 +-
 .../kafka/connect/cli/ConnectStandalone.java       |   2 +-
 .../kafka/connect/runtime/AbstractHerder.java      |  52 +-
 .../kafka/connect/runtime/AbstractStatus.java      |   1 +
 .../org/apache/kafka/connect/runtime/Connect.java  |   6 +-
 .../kafka/connect/runtime/ConnectorStatus.java     |  17 +-
 .../org/apache/kafka/connect/runtime/Herder.java   |  15 +
 .../apache/kafka/connect/runtime/TargetState.java  |  36 ++
 .../apache/kafka/connect/runtime/TaskStatus.java   |  12 +
 .../org/apache/kafka/connect/runtime/Worker.java   | 107 ++--
 .../kafka/connect/runtime/WorkerConnector.java     | 206 +++++++
 .../kafka/connect/runtime/WorkerSinkTask.java      |  76 ++-
 .../kafka/connect/runtime/WorkerSourceTask.java    |  19 +-
 .../apache/kafka/connect/runtime/WorkerTask.java   | 128 +++-
 .../runtime/distributed/ClusterConfigState.java    |  46 +-
 .../runtime/distributed/DistributedHerder.java     | 449 +++++++-------
 .../distributed/RebalanceNeededException.java      |  27 +
 .../runtime/distributed/StaleConfigException.java  |  27 -
 .../runtime/distributed/WorkerCoordinator.java     |   6 +-
 .../runtime/distributed/WorkerGroupMember.java     |   4 +-
 .../runtime/rest/resources/ConnectorsResource.java |  18 +-
 .../runtime/standalone/StandaloneHerder.java       | 218 ++++---
 .../kafka/connect/storage/ConfigBackingStore.java  | 126 ++++
 .../connect/storage/KafkaConfigBackingStore.java   | 683 +++++++++++++++++++++
 .../kafka/connect/storage/KafkaConfigStorage.java  | 594 ------------------
 .../connect/storage/MemoryConfigBackingStore.java  | 154 +++++
 .../kafka/connect/storage/StatusBackingStore.java  |   2 +-
 .../kafka/connect/runtime/AbstractHerderTest.java  |  23 +-
 .../kafka/connect/runtime/WorkerConnectorTest.java | 336 ++++++++++
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 115 +++-
 .../runtime/WorkerSinkTaskThreadedTest.java        |  33 +-
 .../connect/runtime/WorkerSourceTaskTest.java      | 134 +++-
 .../kafka/connect/runtime/WorkerTaskTest.java      |  36 +-
 .../apache/kafka/connect/runtime/WorkerTest.java   |  30 +-
 .../runtime/distributed/DistributedHerderTest.java | 143 +++--
 .../runtime/distributed/WorkerCoordinatorTest.java |  12 +-
 .../runtime/standalone/StandaloneHerderTest.java   |  35 +-
 .../storage/KafkaConfigBackingStoreTest.java       | 537 ++++++++++++++++
 .../connect/storage/KafkaConfigStorageTest.java    | 534 ----------------
 40 files changed, 3253 insertions(+), 1759 deletions(-)
280efe7f789d21f0c45657e14830451c1c8fc2b4

 .../unit/kafka/integration/RollingBounceTest.scala | 95 ----------------------
 1 file changed, 95 deletions(-)
0bf61039c858af17260878d4815dbe7fb1645f90

 .../org/apache/kafka/clients/producer/internals/RecordAccumulator.java  | 2 +-
 clients/src/main/java/org/apache/kafka/common/network/LoginType.java    | 2 +-
 clients/src/main/java/org/apache/kafka/common/protocol/Protocol.java    | 2 +-
 .../api/src/main/java/org/apache/kafka/connect/data/ConnectSchema.java  | 2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala                      | 2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala                           | 2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala                        | 2 +-
 core/src/test/scala/unit/kafka/server/ClientQuotaManagerTest.scala      | 2 +-
 docs/streams.html                                                       | 2 +-
 9 files changed, 9 insertions(+), 9 deletions(-)
501fa37222ee7bb6c1883441af05fa883c51d93b

 docs/connect.html | 34 ++++++++++++++++++++++------------
 1 file changed, 22 insertions(+), 12 deletions(-)
f89f5fb907711e4696bee8a8d7bb53c6941ed693

 config/connect-distributed.properties | 2 +-
 config/connect-standalone.properties  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
a5f1158c317e22a79c4186d1acb04fb25ce6e56a

 .../scala/kafka/tools/ConsumerPerformance.scala    | 14 ++--
 .../main/scala/kafka/tools/EndToEndLatency.scala   | 18 +++--
 tests/kafkatest/benchmarks/core/benchmark_test.py  | 56 ++++++++++-----
 .../services/performance/end_to_end_latency.py     | 84 ++++++++++++----------
 .../apache/kafka/tools/ProducerPerformance.java    |  7 +-
 5 files changed, 105 insertions(+), 74 deletions(-)
a81ad2582ee0e533d335fe0dc5c5cc885dbf645d

 core/src/main/scala/kafka/consumer/ConsumerIterator.scala  | 6 +++---
 core/src/main/scala/kafka/message/MessageAndMetadata.scala | 6 +++---
 2 files changed, 6 insertions(+), 6 deletions(-)
03817d5a26722c6e95647f6219abf2802b187c8d

 core/src/test/scala/integration/kafka/api/BaseConsumerTest.scala | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)
89c67727c2793bf56b0b005a7d758beebedb5aed

 .../org/apache/kafka/connect/runtime/Herder.java   |  18 +-
 .../org/apache/kafka/connect/runtime/Worker.java   |   7 +
 .../runtime/distributed/DistributedHerder.java     |  91 ++++++-
 .../runtime/distributed/NotAssignedException.java  |  29 ++
 .../runtime/distributed/NotLeaderException.java    |  21 +-
 .../distributed/RequestTargetException.java        |  47 ++++
 .../runtime/distributed/StaleConfigException.java  |  27 ++
 .../runtime/distributed/WorkerCoordinator.java     |  59 ++++
 .../runtime/distributed/WorkerGroupMember.java     |   9 +
 .../kafka/connect/runtime/rest/RestServer.java     |   9 +-
 .../runtime/rest/resources/ConnectorsResource.java | 134 ++++++---
 .../runtime/standalone/StandaloneHerder.java       |  60 +++-
 .../runtime/distributed/DistributedHerderTest.java | 301 +++++++++++++++++++++
 .../rest/resources/ConnectorsResourceTest.java     | 143 ++++++++--
 .../runtime/standalone/StandaloneHerderTest.java   | 154 +++++++++++
 15 files changed, 1009 insertions(+), 100 deletions(-)
b1691cf49e9de850ac8a2675c487af9fb60bfdaa

 .../org/apache/kafka/streams/kstream/KStream.java  |  9 +++
 .../org/apache/kafka/streams/kstream/KTable.java   |  9 +++
 .../streams/kstream/internals/KStreamImpl.java     | 15 ++++
 .../streams/kstream/internals/KTableImpl.java      |  5 ++
 .../kstream/internals/KStreamSelectKeyTest.java    | 83 ++++++++++++++++++++
 .../kstream/internals/KTableMapKeysTest.java       | 88 ++++++++++++++++++++++
 6 files changed, 209 insertions(+)
5236bf60debbb0c08010315a92dd3fbfa482e871

 .../org/apache/kafka/common/config/ConfigDef.java  | 35 ++++++++++--
 .../apache/kafka/common/config/ConfigDefTest.java  |  3 +-
 .../kafka/connect/runtime/AbstractHerder.java      | 40 ++++++++++----
 .../runtime/rest/entities/ConfigKeyInfo.java       |  6 +--
 .../runtime/rest/entities/ConfigValueInfo.java     | 12 ++---
 .../resources/ConnectorPluginsResourceTest.java    | 63 +++++++++++++++++-----
 6 files changed, 120 insertions(+), 39 deletions(-)
065ddf90195e09689512b55d0718a5ebdb3d42ad

 .../kafka/clients/consumer/KafkaConsumerTest.java  | 13 +++++++---
 .../integration/kafka/api/BaseConsumerTest.scala   | 26 ++++++++++----------
 .../kafka/api/PlaintextConsumerTest.scala          | 28 ++++++++++++----------
 .../apache/kafka/streams/perf/SimpleBenchmark.java |  1 +
 .../kafka/streams/smoketest/SmokeTestDriver.java   |  2 +-
 5 files changed, 40 insertions(+), 30 deletions(-)
4fa456bc6e875c819e41aadadd1e37ba9bdb9cd0

 gradle/dependencies.gradle | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
f4d3d2865894f1a1ade9d92ac27931fd35d16cae

 .../scala/kafka/coordinator/GroupCoordinator.scala |  22 +++-
 .../main/scala/kafka/server/DelayedOperation.scala |  68 +++++++-----
 .../main/scala/kafka/server/ReplicaManager.scala   |   4 +-
 core/src/main/scala/kafka/utils/timer/Timer.scala  |  51 ++++++++-
 .../main/scala/kafka/utils/timer/TimerTask.scala   |   2 +-
 .../scala/kafka/utils/timer/TimerTaskList.scala    |   7 +-
 .../main/scala/kafka/utils/timer/TimingWheel.scala |   2 +-
 .../other/kafka/TestPurgatoryPerformance.scala     |   2 +-
 .../coordinator/GroupCoordinatorResponseTest.scala | 121 +++++++++++++++++++--
 .../unit/kafka/server/DelayedOperationTest.scala   |   2 +-
 .../src/test/scala/unit/kafka/utils/MockTime.scala |  12 ++
 .../scala/unit/kafka/utils/timer/MockTimer.scala   |  57 ++++++++++
 .../unit/kafka/utils/timer/TimerTaskListTest.scala |  12 +-
 .../scala/unit/kafka/utils/timer/TimerTest.scala   |  29 +++--
 14 files changed, 312 insertions(+), 79 deletions(-)
c1694833d5c095e47e5767f38c3e85bbe927a0a7

 tests/kafkatest/benchmarks/core/benchmark_test.py  |  85 ++++++-----
 .../sanity_checks/test_performance_services.py     |  88 ++++++++++++
 tests/kafkatest/services/performance/__init__.py   |   4 +-
 .../services/performance/consumer_performance.py   |  45 ++++--
 .../services/performance/end_to_end_latency.py     |  62 ++++++--
 .../kafkatest/services/performance/performance.py  |  23 +++
 .../services/performance/producer_performance.py   | 159 +++++++++++++++------
 .../services/templates/tools_log4j.properties      |   2 +-
 vagrant/base.sh                                    |   2 +
 9 files changed, 364 insertions(+), 106 deletions(-)
667ff7ef737612773c50908d2b3cc829bb5132c7

 .../processor/internals/InternalTopicManager.java  |  29 +++--
 .../internals/StreamPartitionAssignor.java         | 120 +++++++++++----------
 .../internals/StreamPartitionAssignorTest.java     |   2 +-
 3 files changed, 86 insertions(+), 65 deletions(-)
e79d9af3cfbb8884e00424f84f3c687114497998

 docs/api.html            |  2 +-
 docs/connect.html        | 28 ++++++++++++++--------------
 docs/implementation.html |  4 ++--
 docs/migration.html      |  2 +-
 docs/ops.html            |  6 +++---
 5 files changed, 21 insertions(+), 21 deletions(-)
34a594472133c3bc6a2886cf58ded0065f26d28a

 gradle/dependencies.gradle | 1 -
 1 file changed, 1 deletion(-)
ba9456de2ebf1a34bdf5f6f62a701875822e1923

 .../org/apache/kafka/streams/KafkaStreams.java     |  2 ++
 .../streams/kstream/internals/AbstractStream.java  |  3 ++
 .../kstream/internals/ChangedSerializer.java       |  4 +++
 .../kstream/internals/KStreamAggregate.java        |  3 ++
 .../streams/kstream/internals/KStreamImpl.java     |  3 ++
 .../kstream/internals/KStreamJoinWindow.java       |  3 ++
 .../kstream/internals/KStreamKStreamJoin.java      |  3 ++
 .../streams/kstream/internals/KStreamReduce.java   |  3 ++
 .../streams/kstream/internals/KTableAggregate.java |  3 ++
 .../streams/kstream/internals/KTableImpl.java      |  3 ++
 .../kstream/internals/KTableKTableJoin.java        |  3 ++
 .../kstream/internals/KTableKTableLeftJoin.java    |  3 ++
 .../kstream/internals/KTableKTableOuterJoin.java   |  3 ++
 .../kstream/internals/KTableKTableRightJoin.java   |  3 ++
 .../streams/kstream/internals/KTableReduce.java    |  3 ++
 .../kstream/internals/KTableRepartitionMap.java    |  6 ++++
 .../streams/processor/DefaultPartitionGrouper.java |  3 ++
 .../org/apache/kafka/streams/processor/TaskId.java |  9 ++++++
 .../kafka/streams/processor/TopologyBuilder.java   |  5 ++++
 .../streams/processor/internals/AbstractTask.java  |  6 ++++
 .../processor/internals/InternalTopicManager.java  |  6 ++++
 .../processor/internals/MinTimestampTracker.java   |  3 ++
 .../processor/internals/PartitionGroup.java        |  3 ++
 .../processor/internals/ProcessorContextImpl.java  | 18 ++++++++++++
 .../processor/internals/ProcessorStateManager.java | 14 +++++++++
 .../streams/processor/internals/QuickUnion.java    |  3 ++
 .../streams/processor/internals/SinkNode.java      |  3 ++
 .../processor/internals/StandbyContextImpl.java    | 33 ++++++++++++++++++++++
 .../internals/StreamPartitionAssignor.java         |  4 +++
 .../streams/processor/internals/StreamTask.java    |  7 +++++
 .../streams/processor/internals/StreamThread.java  |  5 ++++
 .../internals/assignment/AssignmentInfo.java       |  7 +++++
 .../internals/assignment/SubscriptionInfo.java     |  6 ++++
 .../apache/kafka/streams/state/StateSerdes.java    |  1 +
 .../org/apache/kafka/streams/state/Stores.java     |  4 +++
 .../streams/state/internals/MemoryLRUCache.java    |  6 ++++
 .../streams/state/internals/OffsetCheckpoint.java  | 23 +++++++++++++++
 .../streams/state/internals/RocksDBStore.java      |  9 ++++++
 .../state/internals/RocksDBWindowStore.java        |  3 ++
 39 files changed, 232 insertions(+)
319c6e7195143c1fa4a1e5b34ad923c2b73f373d

 .../java/org/apache/kafka/streams/kstream/internals/KStreamImpl.java    | 2 ++
 1 file changed, 2 insertions(+)
e97735f035110fe522197f125d8b6c24c157ae78

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
6c13fca51fb8b25e6bfe4b3ab416e774ab9142ac
40fd456649b5df29d030da46865b5e7e0ca6db15

 .../org/apache/kafka/streams/kstream/Transformer.java     |  9 +++++----
 .../apache/kafka/streams/kstream/ValueTransformer.java    |  5 +++--
 .../kafka/streams/kstream/internals/KStreamImpl.java      |  4 +---
 .../kafka/streams/kstream/internals/KStreamTransform.java |  9 +++++++--
 .../streams/kstream/internals/KStreamTransformValues.java | 11 +++++++----
 .../kafka/streams/kstream/internals/KTableImpl.java       |  2 +-
 .../streams/kstream/internals/KStreamTransformTest.java   | 10 +++++++---
 .../kstream/internals/KStreamTransformValuesTest.java     |  8 ++++++--
 .../java/org/apache/kafka/test/KStreamTestDriver.java     | 15 +++++++++++++++
 .../java/org/apache/kafka/test/MockProcessorContext.java  |  6 +++---
 .../java/org/apache/kafka/test/MockProcessorSupplier.java |  3 ++-
 11 files changed, 57 insertions(+), 25 deletions(-)
1ec842a3ea9bbe414a5c59f90569fbc3348bdfb8

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java  | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)
411b04a3c933b5253f34342bf24f63a9473f9ab5

 tests/kafkatest/services/verifiable_producer.py | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
c76b6e6d9bad2278076054f5175a2b053383388f

 .../kafka/streams/processor/internals/PunctuationQueue.java |  2 +-
 .../streams/processor/internals/PunctuationSchedule.java    | 13 +++++++++----
 .../kafka/streams/processor/internals/StreamTaskTest.java   | 10 +++++-----
 3 files changed, 15 insertions(+), 10 deletions(-)
7c27989860e7e063bfec3c679cb6bc8fd52abc84

 .../org/apache/kafka/streams/kstream/KStream.java  |  46 ++++++
 .../org/apache/kafka/streams/kstream/KTable.java   |  43 ++++++
 .../streams/kstream/internals/KStreamImpl.java     |  40 ++++-
 .../streams/kstream/internals/KTableImpl.java      |  38 ++++-
 .../streams/kstream/internals/KeyValuePrinter.java | 124 ++++++++++++++++
 .../internals/KeyValuePrinterProcessorTest.java    | 165 +++++++++++++++++++++
 .../apache/kafka/test/MockProcessorContext.java    |   2 +-
 7 files changed, 454 insertions(+), 4 deletions(-)
8c59565761a42984335294683c3501df8427ce62

 .../streams/kstream/internals/ChangedSerializer.java | 16 +++++++++++++++-
 .../streams/kstream/internals/KStreamJoinWindow.java |  8 ++++++--
 .../kstream/internals/KStreamKStreamJoin.java        |  5 +++++
 .../kstream/internals/KStreamKTableLeftJoin.java     |  6 +++++-
 .../streams/kstream/internals/KStreamTransform.java  | 10 +++++-----
 .../kstream/internals/KStreamWindowAggregate.java    |  5 +++++
 .../kstream/internals/KStreamWindowReduce.java       |  5 +++++
 .../streams/kstream/internals/KTableKTableJoin.java  |  5 +++++
 .../kstream/internals/KTableKTableLeftJoin.java      |  5 +++++
 .../kstream/internals/KTableKTableOuterJoin.java     |  5 +++++
 .../kstream/internals/KTableKTableRightJoin.java     |  5 +++++
 .../kstream/internals/KTableRepartitionMap.java      |  5 +++++
 .../processor/internals/StandbyContextImpl.java      | 20 ++++++++++----------
 13 files changed, 81 insertions(+), 19 deletions(-)
2a8fa287862912491d1e118c52a2d194d8480075

 .../consumer/internals/AbstractCoordinator.java    | 22 +++++++++---
 .../internals/ConsumerCoordinatorTest.java         | 40 ++++++++++++++++++++++
 2 files changed, 57 insertions(+), 5 deletions(-)
cbdd70ec0de4b4d6d04b62580a5a67ea69311c4a

 tests/kafkatest/tests/client/consumer_test.py                      | 6 ++++++
 tools/src/main/java/org/apache/kafka/tools/VerifiableConsumer.java | 7 +++++++
 2 files changed, 13 insertions(+)
4d467c2ec275b5659c2da0ca196409dffaa3caf3

 .../main/scala/kafka/server/ReplicaManager.scala   |   8 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   9 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 118 ++++++++++++++++-----
 3 files changed, 104 insertions(+), 31 deletions(-)
9beafae23a83774fc1d9ea811d449eac34240363

 .../kafka/streams/kstream/ForeachAction.java       | 35 +++++++++
 .../org/apache/kafka/streams/kstream/KStream.java  |  8 ++
 .../org/apache/kafka/streams/kstream/KTable.java   |  8 ++
 .../streams/kstream/internals/KStreamForeach.java  | 44 +++++++++++
 .../streams/kstream/internals/KStreamImpl.java     |  8 ++
 .../streams/kstream/internals/KTableImpl.java      | 15 ++++
 .../kstream/internals/KStreamForeachTest.java      | 85 ++++++++++++++++++++++
 .../kstream/internals/KTableForeachTest.java       | 85 ++++++++++++++++++++++
 8 files changed, 288 insertions(+)
3a58407e2e0aee0bb2c5e343fbe98c7f28fc6f3e

 .../kafka/clients/consumer/ConsumerRecordTest.java |  2 +-
 .../kafka/streams/processor/ProcessorContext.java  | 17 +++--
 .../processor/internals/PartitionGroup.java        | 17 ++---
 .../processor/internals/ProcessorContextImpl.java  | 11 ++-
 .../streams/processor/internals/ProcessorNode.java |  2 +-
 .../processor/internals/PunctuationSchedule.java   |  2 +-
 .../processor/internals/StandbyContextImpl.java    | 18 ++---
 .../streams/processor/internals/StreamTask.java    | 13 ++--
 .../streams/processor/internals/StreamThread.java  |  7 +-
 .../kstream/internals/KStreamKStreamJoinTest.java  | 72 +++++++++----------
 .../internals/KStreamKStreamLeftJoinTest.java      | 36 +++++-----
 .../internals/KStreamKTableLeftJoinTest.java       | 14 ++--
 .../internals/KStreamWindowAggregateTest.java      | 24 +++----
 .../kstream/internals/KTableFilterTest.java        | 36 +++++-----
 .../kstream/internals/KTableKTableJoinTest.java    | 42 +++++------
 .../internals/KTableKTableLeftJoinTest.java        | 42 +++++------
 .../internals/KTableKTableOuterJoinTest.java       | 48 ++++++-------
 .../kstream/internals/KTableMapValuesTest.java     | 16 ++---
 .../kstream/internals/KTableSourceTest.java        | 16 ++---
 .../processor/internals/PartitionGroupTest.java    | 82 +++++++++++++++++++---
 .../processor/internals/StreamTaskTest.java        | 79 ++++++++++++++++++++-
 .../apache/kafka/test/MockProcessorContext.java    |  2 +-
 .../org/apache/kafka/test/MockProcessorNode.java   | 49 +++++++++++++
 .../apache/kafka/test/MockProcessorSupplier.java   | 38 +++++++---
 24 files changed, 458 insertions(+), 227 deletions(-)
8b9b07e5d6aed2552d1cdfba27b0211af39c691f

 tests/kafkatest/services/verifiable_producer.py | 34 +++++++++++++------------
 1 file changed, 18 insertions(+), 16 deletions(-)
9c34df1511a769b272893b75ec1ed90d38cc9576

 .../kafka/clients/consumer/KafkaConsumer.java      |  3 +-
 .../consumer/internals/AbstractCoordinator.java    |  2 +
 .../consumer/internals/ConsumerCoordinator.java    |  3 --
 .../consumer/internals/ConsumerNetworkClient.java  | 58 ++++++++++++--------
 .../consumer/internals/SendFailedException.java    | 27 ----------
 .../GroupCoordinatorNotAvailableException.java     |  1 +
 .../internals/ConsumerCoordinatorTest.java         |  2 +-
 .../internals/ConsumerNetworkClientTest.java       | 63 +++++++++++++++++++++-
 .../clients/consumer/internals/FetcherTest.java    |  2 +-
 .../runtime/distributed/WorkerGroupMember.java     |  3 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |  2 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  | 23 ++++----
 12 files changed, 118 insertions(+), 71 deletions(-)
8dbd688b1617968329087317fa6bde8b8df0392e

 .../kafka/streams/processor/ProcessorContext.java  |  9 ++++
 .../processor/internals/ProcessorContextImpl.java  |  5 ++
 .../processor/internals/StandbyContextImpl.java    |  5 ++
 .../streams/processor/internals/StreamTask.java    | 16 +++++++
 .../processor/internals/ProcessorTopologyTest.java | 56 ++++++++++++++++++++++
 .../org/apache/kafka/test/KStreamTestDriver.java   | 16 +++++++
 .../apache/kafka/test/MockProcessorContext.java    |  6 +++
 7 files changed, 113 insertions(+)
0773bc4ba604bc8b57040583ac4c1cb6832ba188

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 3 +--
 3 files changed, 3 insertions(+), 4 deletions(-)
aa6f0d8d5f084126bbba1fb6b40e392f2b908262

 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)
050bf60a4725b239db76732d0f7d7f1c7c41ab06

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5c5fe7bd795f5aab5248fb718c61c8ca3f2f571a

 .../org/apache/kafka/streams/KafkaStreams.java     |  2 +-
 .../org/apache/kafka/streams/kstream/KStream.java  | 88 ++++++++++++++++++----
 .../org/apache/kafka/streams/kstream/KTable.java   | 88 ++++++++++++++++++----
 .../streams/kstream/internals/KStreamImpl.java     | 39 +++++++---
 .../streams/kstream/internals/KTableImpl.java      | 30 +++++++-
 5 files changed, 206 insertions(+), 41 deletions(-)
35fadbf639650a14f061a97904755d12499fd7fa

 core/src/main/scala/kafka/security/auth/SimpleAclAuthorizer.scala   | 2 +-
 .../scala/unit/kafka/security/auth/SimpleAclAuthorizerTest.scala    | 6 +++++-
 2 files changed, 6 insertions(+), 2 deletions(-)
e733d8c2fbcee19ee77c436e66abb29850a2f7c2

 .../org/apache/kafka/common/network/Selector.java  |   6 +-
 .../main/scala/kafka/network/RequestChannel.scala  |  53 +++---
 .../main/scala/kafka/network/SocketServer.scala    | 185 ++++++++++++---------
 .../unit/kafka/network/SocketServerTest.scala      | 141 +++++++++++++---
 4 files changed, 257 insertions(+), 128 deletions(-)
703014824aeb0690dfb30a98fcd0f11e9d1e68fc

 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   2 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 173 +++++++++++----------
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   2 +-
 .../scala/unit/kafka/log/OffsetIndexTest.scala     |  10 +-
 5 files changed, 98 insertions(+), 91 deletions(-)
d1a5883c8ad69fbd16c3dc03ff05db887580ded5

 bin/kafka-server-stop.sh     | 2 +-
 bin/zookeeper-server-stop.sh | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
c36268f77fbf7f6a47a1e09ec3e38c20173a06c5

 .../java/org/apache/kafka/clients/NetworkClient.java    |  8 ++++++++
 .../src/main/java/org/apache/kafka/common/Cluster.java  | 17 +++++++++++++++--
 2 files changed, 23 insertions(+), 2 deletions(-)
9897813957c1b5cd70a0dd02094f184f73e06979

 tests/kafkatest/services/connect.py                |  6 ++++
 tests/kafkatest/services/mirror_maker.py           |  1 -
 .../kafkatest/services/security/security_config.py | 24 ++++++++------
 .../tests/connect/connect_distributed_test.py      | 36 +++++++++++++++++----
 tests/kafkatest/tests/connect/connect_test.py      | 37 ++++++++++++++++------
 .../templates/connect-distributed.properties       |  7 ++--
 .../templates/connect-standalone.properties        |  4 ++-
 7 files changed, 86 insertions(+), 29 deletions(-)
80ba01e16ba17c48058987ee3a1384f1e23df343

 .../java/org/apache/kafka/streams/processor/internals/SinkNode.java     | 2 +-
 streams/src/test/java/org/apache/kafka/test/KStreamTestDriver.java      | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)
625c516e0e4096c6bccde998d5973525b8be196d

 .../org/apache/kafka/clients/NetworkClient.java    |  2 +-
 .../controller/ControllerChannelManager.scala      |  4 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  9 +--
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  4 +-
 .../kafka/utils/NetworkClientBlockingOps.scala     | 66 ++++++++++++----------
 5 files changed, 40 insertions(+), 45 deletions(-)
eb08e493228e2e34eae361922796dcffb920e78d

 .../kafka/clients/consumer/KafkaConsumer.java      | 41 +++++++++++-----------
 1 file changed, 21 insertions(+), 20 deletions(-)
09f4a7fdc923b03a2f2ea29ecb0659ca450e8149

 .../processor/internals/PartitionGroup.java        |  6 +++-
 .../streams/processor/internals/StreamTask.java    | 12 ++++----
 .../streams/processor/internals/StreamThread.java  | 35 ++++++++--------------
 3 files changed, 24 insertions(+), 29 deletions(-)
c216f8a8e8ff6a3c140b9e0678c4362d4b035982

 docs/ops.html | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
c588a72ad21f313d0c0ced11f083eca18fab84a1

 core/src/test/resources/kafka_jaas.conf            |  29 ----
 .../scala/integration/kafka/api/SaslSetup.scala    |  39 ++----
 .../kafka/security/auth/ZkAuthorizationTest.scala  |  47 +++----
 .../scala/unit/kafka/utils/JaasTestUtils.scala     | 156 +++++++++++++--------
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  66 ++++-----
 .../scala/unit/kafka/zk/ZkFourLetterWords.scala    |  47 +++++++
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  48 ++-----
 7 files changed, 217 insertions(+), 215 deletions(-)
b5de41227f11a495d5dd7e1cf785220365d84534

 core/src/main/scala/kafka/tools/ReplicaVerificationTool.scala | 6 ++++++
 1 file changed, 6 insertions(+)
ae0a5a0dfdb6f5d69322ce0fa4da2c6e5e0daeb6

 .../apache/kafka/clients/producer/internals/ErrorLoggingCallback.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
e8593d1b4529a7b9f3471ac8c1411dba336d6708

 .../main/java/org/apache/kafka/connect/runtime/ConnectorConfig.java | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
9c5af253b170e2570ba2e17b4155520cea474e81

 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
bc47e2306d9558a0f0976b15a554fc2d84ade5fc

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
99d232922734e115f8e3585d91ccfb0ef067385d

 .../org/apache/kafka/streams/KafkaStreams.java     |  2 +-
 .../org/apache/kafka/streams/kstream/KStream.java  | 88 ++++++++++++++++++----
 .../org/apache/kafka/streams/kstream/KTable.java   | 88 ++++++++++++++++++----
 .../streams/kstream/internals/KStreamImpl.java     | 39 +++++++---
 .../streams/kstream/internals/KTableImpl.java      | 30 +++++++-
 5 files changed, 206 insertions(+), 41 deletions(-)
8218a4a153d9138f29486e74cf77c88d1786997a

 core/src/main/scala/kafka/security/auth/SimpleAclAuthorizer.scala   | 2 +-
 .../scala/unit/kafka/security/auth/SimpleAclAuthorizerTest.scala    | 6 +++++-
 2 files changed, 6 insertions(+), 2 deletions(-)
893e79af88016f1d8659e72d48a25d4a825b8867

 .../org/apache/kafka/common/network/Selector.java  |   6 +-
 .../main/scala/kafka/network/RequestChannel.scala  |  53 +++---
 .../main/scala/kafka/network/SocketServer.scala    | 185 ++++++++++++---------
 .../unit/kafka/network/SocketServerTest.scala      | 141 +++++++++++++---
 4 files changed, 257 insertions(+), 128 deletions(-)
aee8ebb46cd9393a0886c42cb88b080d065da397

 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   2 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 173 +++++++++++----------
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   2 +-
 .../scala/unit/kafka/log/OffsetIndexTest.scala     |  10 +-
 5 files changed, 98 insertions(+), 91 deletions(-)
732b111f458454552411ce787c0b9f9fff8db642

 bin/kafka-server-stop.sh     | 2 +-
 bin/zookeeper-server-stop.sh | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
4ff667711ffd477872adbd3e3e39bd94eac6e763

 .../java/org/apache/kafka/clients/NetworkClient.java    |  8 ++++++++
 .../src/main/java/org/apache/kafka/common/Cluster.java  | 17 +++++++++++++++--
 2 files changed, 23 insertions(+), 2 deletions(-)
c3c9289c12342065d6c671098aaace23a328c7ff

 tests/kafkatest/services/connect.py                |  6 ++++
 tests/kafkatest/services/mirror_maker.py           |  1 -
 .../kafkatest/services/security/security_config.py | 24 ++++++++------
 .../tests/connect/connect_distributed_test.py      | 36 +++++++++++++++++----
 tests/kafkatest/tests/connect/connect_test.py      | 37 ++++++++++++++++------
 .../templates/connect-distributed.properties       |  7 ++--
 .../templates/connect-standalone.properties        |  4 ++-
 7 files changed, 86 insertions(+), 29 deletions(-)
31e263e8294e94de3d2c44d2ab3a827ab904e247

 .../java/org/apache/kafka/streams/processor/internals/SinkNode.java     | 2 +-
 streams/src/test/java/org/apache/kafka/test/KStreamTestDriver.java      | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)
e0ac36f05fb5dfecf69f5746b8bd8680ca251f50

 tests/kafkatest/benchmarks/__init__.py             |  14 +
 tests/kafkatest/benchmarks/core/__init__.py        |  15 ++
 tests/kafkatest/benchmarks/core/benchmark_test.py  | 253 ++++++++++++++++++
 tests/kafkatest/tests/benchmark_test.py            | 253 ------------------
 tests/kafkatest/tests/client/__init__.py           |  15 ++
 tests/kafkatest/tests/client/compression_test.py   |  85 ++++++
 .../tests/client/consumer_rolling_upgrade_test.py  |  82 ++++++
 tests/kafkatest/tests/client/consumer_test.py      | 291 +++++++++++++++++++++
 .../tests/client/message_format_change_test.py     |  92 +++++++
 tests/kafkatest/tests/client/quota_test.py         | 170 ++++++++++++
 .../tests/compatibility_test_new_broker_test.py    |  78 ------
 tests/kafkatest/tests/compression_test.py          |  85 ------
 tests/kafkatest/tests/connect/__init__.py          |  15 ++
 .../tests/connect/connect_distributed_test.py      | 210 +++++++++++++++
 tests/kafkatest/tests/connect/connect_rest_test.py | 165 ++++++++++++
 tests/kafkatest/tests/connect/connect_test.py      |  93 +++++++
 .../templates/connect-distributed.properties       |  46 ++++
 .../connect/templates/connect-file-sink.properties |  20 ++
 .../templates/connect-file-source.properties       |  20 ++
 .../templates/connect-standalone.properties        |  32 +++
 tests/kafkatest/tests/connect_distributed_test.py  | 210 ---------------
 tests/kafkatest/tests/connect_rest_test.py         | 165 ------------
 tests/kafkatest/tests/connect_test.py              |  93 -------
 .../kafkatest/tests/consumer_group_command_test.py | 106 --------
 .../tests/consumer_rolling_upgrade_test.py         |  82 ------
 tests/kafkatest/tests/consumer_test.py             | 291 ---------------------
 tests/kafkatest/tests/core/__init__.py             |  15 ++
 .../core/compatibility_test_new_broker_test.py     |  78 ++++++
 .../tests/core/consumer_group_command_test.py      | 106 ++++++++
 .../kafkatest/tests/core/get_offset_shell_test.py  |  91 +++++++
 tests/kafkatest/tests/core/mirror_maker_test.py    | 179 +++++++++++++
 .../tests/core/reassign_partitions_test.py         | 110 ++++++++
 tests/kafkatest/tests/core/replication_test.py     | 152 +++++++++++
 .../tests/core/security_rolling_upgrade_test.py    | 128 +++++++++
 .../tests/core/simple_consumer_shell_test.py       |  75 ++++++
 tests/kafkatest/tests/core/upgrade_test.py         | 105 ++++++++
 .../tests/core/zookeeper_security_upgrade_test.py  | 117 +++++++++
 tests/kafkatest/tests/get_offset_shell_test.py     |  91 -------
 tests/kafkatest/tests/log4j_appender_test.py       |  93 -------
 .../kafkatest/tests/message_format_change_test.py  |  92 -------
 tests/kafkatest/tests/mirror_maker_test.py         | 179 -------------
 tests/kafkatest/tests/quota_test.py                | 170 ------------
 tests/kafkatest/tests/reassign_partitions_test.py  | 110 --------
 tests/kafkatest/tests/replication_test.py          | 152 -----------
 .../tests/security_rolling_upgrade_test.py         | 128 ---------
 .../kafkatest/tests/simple_consumer_shell_test.py  |  75 ------
 tests/kafkatest/tests/streams/__init__.py          |  15 ++
 .../kafkatest/tests/streams/streams_bounce_test.py |  73 ++++++
 .../kafkatest/tests/streams/streams_smoke_test.py  |  75 ++++++
 tests/kafkatest/tests/streams_bounce_test.py       |  73 ------
 tests/kafkatest/tests/streams_smoke_test.py        |  75 ------
 .../tests/templates/connect-distributed.properties |  46 ----
 .../tests/templates/connect-file-sink.properties   |  20 --
 .../tests/templates/connect-file-source.properties |  20 --
 .../tests/templates/connect-standalone.properties  |  32 ---
 tests/kafkatest/tests/tools/__init__.py            |  15 ++
 tests/kafkatest/tests/tools/log4j_appender_test.py |  93 +++++++
 tests/kafkatest/tests/upgrade_test.py              | 105 --------
 .../tests/zookeeper_security_upgrade_test.py       | 117 ---------
 59 files changed, 3045 insertions(+), 2941 deletions(-)
45c585b4f7e3d5e5dd5297b4d121badbd2052922

 tests/kafkatest/benchmarks/__init__.py             |  14 +
 tests/kafkatest/benchmarks/core/__init__.py        |  15 ++
 tests/kafkatest/benchmarks/core/benchmark_test.py  | 253 ++++++++++++++++++
 tests/kafkatest/tests/benchmark_test.py            | 253 ------------------
 tests/kafkatest/tests/client/__init__.py           |  15 ++
 tests/kafkatest/tests/client/compression_test.py   |  85 ++++++
 .../tests/client/consumer_rolling_upgrade_test.py  |  82 ++++++
 tests/kafkatest/tests/client/consumer_test.py      | 291 +++++++++++++++++++++
 .../tests/client/message_format_change_test.py     |  92 +++++++
 tests/kafkatest/tests/client/quota_test.py         | 170 ++++++++++++
 .../tests/compatibility_test_new_broker_test.py    |  78 ------
 tests/kafkatest/tests/compression_test.py          |  85 ------
 tests/kafkatest/tests/connect/__init__.py          |  15 ++
 .../tests/connect/connect_distributed_test.py      | 210 +++++++++++++++
 tests/kafkatest/tests/connect/connect_rest_test.py | 165 ++++++++++++
 tests/kafkatest/tests/connect/connect_test.py      |  93 +++++++
 .../templates/connect-distributed.properties       |  46 ++++
 .../connect/templates/connect-file-sink.properties |  20 ++
 .../templates/connect-file-source.properties       |  20 ++
 .../templates/connect-standalone.properties        |  32 +++
 tests/kafkatest/tests/connect_distributed_test.py  | 210 ---------------
 tests/kafkatest/tests/connect_rest_test.py         | 165 ------------
 tests/kafkatest/tests/connect_test.py              |  93 -------
 .../kafkatest/tests/consumer_group_command_test.py | 106 --------
 .../tests/consumer_rolling_upgrade_test.py         |  82 ------
 tests/kafkatest/tests/consumer_test.py             | 291 ---------------------
 tests/kafkatest/tests/core/__init__.py             |  15 ++
 .../core/compatibility_test_new_broker_test.py     |  78 ++++++
 .../tests/core/consumer_group_command_test.py      | 106 ++++++++
 .../kafkatest/tests/core/get_offset_shell_test.py  |  91 +++++++
 tests/kafkatest/tests/core/mirror_maker_test.py    | 179 +++++++++++++
 .../tests/core/reassign_partitions_test.py         | 110 ++++++++
 tests/kafkatest/tests/core/replication_test.py     | 152 +++++++++++
 .../tests/core/security_rolling_upgrade_test.py    | 128 +++++++++
 .../tests/core/simple_consumer_shell_test.py       |  75 ++++++
 tests/kafkatest/tests/core/upgrade_test.py         | 105 ++++++++
 .../tests/core/zookeeper_security_upgrade_test.py  | 117 +++++++++
 tests/kafkatest/tests/get_offset_shell_test.py     |  91 -------
 tests/kafkatest/tests/log4j_appender_test.py       |  93 -------
 .../kafkatest/tests/message_format_change_test.py  |  92 -------
 tests/kafkatest/tests/mirror_maker_test.py         | 179 -------------
 tests/kafkatest/tests/quota_test.py                | 170 ------------
 tests/kafkatest/tests/reassign_partitions_test.py  | 110 --------
 tests/kafkatest/tests/replication_test.py          | 152 -----------
 .../tests/security_rolling_upgrade_test.py         | 128 ---------
 .../kafkatest/tests/simple_consumer_shell_test.py  |  75 ------
 tests/kafkatest/tests/streams/__init__.py          |  15 ++
 .../kafkatest/tests/streams/streams_bounce_test.py |  73 ++++++
 .../kafkatest/tests/streams/streams_smoke_test.py  |  75 ++++++
 tests/kafkatest/tests/streams_bounce_test.py       |  73 ------
 tests/kafkatest/tests/streams_smoke_test.py        |  75 ------
 .../tests/templates/connect-distributed.properties |  46 ----
 .../tests/templates/connect-file-sink.properties   |  20 --
 .../tests/templates/connect-file-source.properties |  20 --
 .../tests/templates/connect-standalone.properties  |  32 ---
 tests/kafkatest/tests/tools/__init__.py            |  15 ++
 tests/kafkatest/tests/tools/log4j_appender_test.py |  93 +++++++
 tests/kafkatest/tests/upgrade_test.py              | 105 --------
 .../tests/zookeeper_security_upgrade_test.py       | 117 ---------
 59 files changed, 3045 insertions(+), 2941 deletions(-)
99ab50ddb2bc52d3278955046617bd918db2463c

 .../apache/kafka/connect/runtime/SourceTaskOffsetCommitter.java  | 9 +++------
 .../src/main/java/org/apache/kafka/connect/runtime/Worker.java   | 2 +-
 2 files changed, 4 insertions(+), 7 deletions(-)
83cf38545be4614bd1f6b1759ada851fb38d63b0

 .../apache/kafka/connect/runtime/SourceTaskOffsetCommitter.java  | 9 +++------
 .../src/main/java/org/apache/kafka/connect/runtime/Worker.java   | 2 +-
 2 files changed, 4 insertions(+), 7 deletions(-)
6d2d9f6702861f0c575b0b58e233c80907ada700

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3a20ba305517ace78ea5f54554bd3b333f0b7d3d

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b94a7812beeb840926871df84838f35ca7b76ffe

 .../org/apache/kafka/clients/NetworkClient.java    |  2 +-
 .../controller/ControllerChannelManager.scala      |  4 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  9 +--
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  4 +-
 .../kafka/utils/NetworkClientBlockingOps.scala     | 66 ++++++++++++----------
 5 files changed, 40 insertions(+), 45 deletions(-)
ef3f053155c73af053a36a2e50047c5a49cd30bf

 .../kafka/clients/consumer/KafkaConsumer.java      | 41 +++++++++++-----------
 1 file changed, 21 insertions(+), 20 deletions(-)
ed60ecffae0d34c90984ee8ec3c147012b3ecb26

 .../consumer/internals/ConsumerCoordinator.java    |  54 ++++-----
 .../internals/ConsumerCoordinatorTest.java         | 122 +++++++++++++++++++--
 2 files changed, 134 insertions(+), 42 deletions(-)
dd5480a47eb0f45214c179b7f14ffaf493164222

 .../consumer/internals/ConsumerCoordinator.java    |  54 ++++-----
 .../internals/ConsumerCoordinatorTest.java         | 122 +++++++++++++++++++--
 2 files changed, 134 insertions(+), 42 deletions(-)
bd5325dd8be7c5cf920acee2aa33b3c288bd551a

 .../processor/internals/PartitionGroup.java        |  6 +++-
 .../streams/processor/internals/StreamTask.java    | 12 ++++----
 .../streams/processor/internals/StreamThread.java  | 35 ++++++++--------------
 3 files changed, 24 insertions(+), 29 deletions(-)
75ec67eda833e3da2b5925d11ab043d1ef4be9ba

 docs/ops.html | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
89fd97f8c934b99b1ad994e36435e0686ef7b85a

 core/src/test/resources/kafka_jaas.conf            |  29 ----
 .../scala/integration/kafka/api/SaslSetup.scala    |  39 ++----
 .../kafka/security/auth/ZkAuthorizationTest.scala  |  47 +++----
 .../scala/unit/kafka/utils/JaasTestUtils.scala     | 156 +++++++++++++--------
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  66 ++++-----
 .../scala/unit/kafka/zk/ZkFourLetterWords.scala    |  47 +++++++
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  48 ++-----
 7 files changed, 217 insertions(+), 215 deletions(-)
a4d6f1dce5b1d3f45505d732ad3dc9bcb92bfd98

 core/src/main/scala/kafka/tools/ReplicaVerificationTool.scala | 6 ++++++
 1 file changed, 6 insertions(+)
077cabbbc3ed7a570ad8fa281b42ae3e4005566b

 .../src/main/java/org/apache/kafka/common/protocol/Protocol.java    | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
e32aeec97b472dfa7c5e089407b778225d65cdf7

 .../src/main/java/org/apache/kafka/common/protocol/Protocol.java    | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
b865413cd8b71f905ad4ee695f193dcf91ee0595

 .../src/main/java/org/apache/kafka/common/protocol/Protocol.java    | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
fd07af3fda837a79c5c754575edb7ad25c36666d

 .../org/apache/kafka/streams/kstream/internals/KStreamAggregate.java | 5 +++++
 .../org/apache/kafka/streams/kstream/internals/KStreamReduce.java    | 5 +++++
 .../org/apache/kafka/streams/kstream/internals/KTableAggregate.java  | 5 +++++
 .../org/apache/kafka/streams/kstream/internals/KTableReduce.java     | 5 +++++
 4 files changed, 20 insertions(+)
ae939467e8aec38f47e2474e74e7ab7ea29c2840

 .../org/apache/kafka/streams/kstream/internals/KStreamAggregate.java | 5 +++++
 .../org/apache/kafka/streams/kstream/internals/KStreamReduce.java    | 5 +++++
 .../org/apache/kafka/streams/kstream/internals/KTableAggregate.java  | 5 +++++
 .../org/apache/kafka/streams/kstream/internals/KTableReduce.java     | 5 +++++
 4 files changed, 20 insertions(+)
6badd89ad3ef86111d99df3d345b7fff06b294c9

 core/src/test/scala/unit/kafka/utils/TestUtils.scala    | 1 +
 core/src/test/scala/unit/kafka/zk/ZKEphemeralTest.scala | 4 +++-
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala      | 8 ++++++++
 3 files changed, 12 insertions(+), 1 deletion(-)
77142f6baeb35e6de9608a7372113f72ea330936

 core/src/test/scala/unit/kafka/utils/TestUtils.scala    | 1 +
 core/src/test/scala/unit/kafka/zk/ZKEphemeralTest.scala | 4 +++-
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala      | 8 ++++++++
 3 files changed, 12 insertions(+), 1 deletion(-)
36beebc755bc19a48e43d7dd99e9b5eed9b7c419

 README.md                                     |  3 ++
 build.gradle                                  | 59 +++++++++++++++++++++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala | 11 ++---
 gradle/dependencies.gradle                    |  3 ++
 4 files changed, 71 insertions(+), 5 deletions(-)
623ab1e7c6497c000bc9c9978637f20542a3191c

 README.md                                     |  3 ++
 build.gradle                                  | 59 +++++++++++++++++++++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala | 11 ++---
 gradle/dependencies.gradle                    |  3 ++
 4 files changed, 71 insertions(+), 5 deletions(-)
be822510c63d720dedf286c95588fc0c25a6a49c

 tests/kafkatest/services/simple_consumer_shell.py  | 69 ++++++++++++++++++++
 .../kafkatest/tests/simple_consumer_shell_test.py  | 75 ++++++++++++++++++++++
 2 files changed, 144 insertions(+)
9f6a6f97134a1d4969c91c4b4e9037b376e03440

 tests/kafkatest/services/simple_consumer_shell.py  | 69 ++++++++++++++++++++
 .../kafkatest/tests/simple_consumer_shell_test.py  | 75 ++++++++++++++++++++++
 2 files changed, 144 insertions(+)
ef676c15c54840d4b8a8ecb54a879b86b2547ea1

 build.gradle                                       |  15 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |   2 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  15 +-
 core/src/test/resources/minikdc-krb5.conf          |  25 ++
 core/src/test/resources/minikdc.ldiff              |  47 +++
 .../scala/integration/kafka/api/SaslSetup.scala    |  10 +-
 .../scala/kafka/security/minikdc/MiniKdc.scala     | 433 +++++++++++++++++++++
 .../kafka/integration/KafkaServerTestHarness.scala |  12 +-
 gradle/dependencies.gradle                         |  12 +-
 tests/kafkatest/services/security/minikdc.py       |  12 +-
 10 files changed, 557 insertions(+), 26 deletions(-)
78d91dcd8805d850038df52718380a6f956abad7

 build.gradle                                       |  15 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |   2 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  15 +-
 core/src/test/resources/minikdc-krb5.conf          |  25 ++
 core/src/test/resources/minikdc.ldiff              |  47 +++
 .../scala/integration/kafka/api/SaslSetup.scala    |  10 +-
 .../scala/kafka/security/minikdc/MiniKdc.scala     | 433 +++++++++++++++++++++
 .../kafka/integration/KafkaServerTestHarness.scala |  12 +-
 gradle/dependencies.gradle                         |  12 +-
 tests/kafkatest/services/security/minikdc.py       |  12 +-
 10 files changed, 557 insertions(+), 26 deletions(-)
9ef243310d6d16a5d508286f8a1c5b5f70d87680

 .../streams/processor/internals/StreamTask.java    |   4 +-
 .../apache/kafka/streams/perf/SimpleBenchmark.java | 413 +++++++++++++++++++++
 2 files changed, 415 insertions(+), 2 deletions(-)
2788f2dc73dd62c35c87842d02d23a0ed6a62e97

 .../streams/processor/internals/StreamTask.java    |   4 +-
 .../apache/kafka/streams/perf/SimpleBenchmark.java | 413 +++++++++++++++++++++
 2 files changed, 415 insertions(+), 2 deletions(-)
4726adba534cf8d91c24a179d66e135804e216a2

 tests/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
aaafd23df800d41e4b16fd399015991b2e426dc5

 tests/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b642284dfef0b77ccd6b0e34ccf40ab19877f008

 docs/upgrade.html | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
27583953528138ff3503fb8f300c97971718e48a

 docs/upgrade.html | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
6878df3cc85ac6efc99ae9f723e7664aa919f5d9

 .../streams/state/internals/RocksDBStore.java      | 27 +++++++++++++---------
 1 file changed, 16 insertions(+), 11 deletions(-)
5089f547d5d64a0235e1b4adc327a0cb05eb4ca8

 .../streams/state/internals/RocksDBStore.java      | 27 +++++++++++++---------
 1 file changed, 16 insertions(+), 11 deletions(-)
afe82512ba5ec3c22ce0e99acfea9ce4d5b2bb2e

 .../java/org/apache/kafka/common/utils/Utils.java  | 18 ++++-----------
 core/src/main/scala/kafka/log/Log.scala            |  3 ++-
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |  7 +++---
 core/src/main/scala/kafka/utils/CoreUtils.scala    | 27 +---------------------
 .../kafka/api/ProducerCompressionTest.scala        |  2 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |  5 ++--
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  7 ++++--
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  2 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 12 ++++++----
 .../kafka/integration/KafkaServerTestHarness.scala |  2 +-
 .../unit/kafka/integration/RollingBounceTest.scala |  2 +-
 .../integration/UncleanLeaderElectionTest.scala    |  2 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |  9 ++++----
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  5 ++--
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  5 ++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  6 ++---
 .../scala/unit/kafka/producer/ProducerTest.scala   |  4 ++--
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |  4 ++--
 .../server/HighwatermarkPersistenceTest.scala      |  7 +++---
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  3 ++-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  3 ++-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  9 ++++----
 .../kafka/server/ServerGenerateBrokerIdTest.scala  | 18 +++++++--------
 .../unit/kafka/server/ServerShutdownTest.scala     |  6 ++---
 .../unit/kafka/server/ServerStartupTest.scala      |  6 ++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 ++++----
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  9 ++++----
 29 files changed, 86 insertions(+), 111 deletions(-)
43d5078e981bbb25fd81cdc8ba4c339cd2d3f3d2

 .../java/org/apache/kafka/common/utils/Utils.java  | 18 ++++-----------
 core/src/main/scala/kafka/log/Log.scala            |  3 ++-
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |  7 +++---
 core/src/main/scala/kafka/utils/CoreUtils.scala    | 27 +---------------------
 .../kafka/api/ProducerCompressionTest.scala        |  2 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |  5 ++--
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  7 ++++--
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  2 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 12 ++++++----
 .../kafka/integration/KafkaServerTestHarness.scala |  2 +-
 .../unit/kafka/integration/RollingBounceTest.scala |  2 +-
 .../integration/UncleanLeaderElectionTest.scala    |  2 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |  9 ++++----
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  5 ++--
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  5 ++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  6 ++---
 .../scala/unit/kafka/producer/ProducerTest.scala   |  4 ++--
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |  4 ++--
 .../server/HighwatermarkPersistenceTest.scala      |  7 +++---
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  3 ++-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  3 ++-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  9 ++++----
 .../kafka/server/ServerGenerateBrokerIdTest.scala  | 18 +++++++--------
 .../unit/kafka/server/ServerShutdownTest.scala     |  6 ++---
 .../unit/kafka/server/ServerStartupTest.scala      |  6 ++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 ++++----
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  9 ++++----
 29 files changed, 86 insertions(+), 111 deletions(-)
4a52cebc8ab9d43168be0d935ddbc750b1ae60de

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
f37b550502f6e3429cb3582db7e1c93614e84c58

 .../kafka/clients/producer/internals/RecordAccumulator.java    | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
4c0660bf3da9879cb405a0f85cf1524511e091e8

 .../kafka/clients/producer/internals/RecordAccumulator.java    | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
b45fe77791560a2171e0bbd7df09f648a01b016f

 .../producer/internals/RecordAccumulator.java      | 35 ++++++-----
 .../clients/producer/internals/RecordBatch.java    | 19 ++++--
 .../producer/internals/RecordAccumulatorTest.java  | 67 +++++++++++++++++++---
 3 files changed, 94 insertions(+), 27 deletions(-)
1fbe445dde71df0023a978c5e54dd229d3d23e1b

 .../producer/internals/RecordAccumulator.java      | 35 ++++++-----
 .../clients/producer/internals/RecordBatch.java    | 19 ++++--
 .../producer/internals/RecordAccumulatorTest.java  | 67 +++++++++++++++++++---
 3 files changed, 94 insertions(+), 27 deletions(-)
206757eeb18589952291ce1a5578c66de3669f4c

 .../kafka/connect/runtime/AbstractHerder.java      | 32 ++++++++++++-
 .../runtime/rest/entities/ConnectorPluginInfo.java | 54 ++++++++++++++++++++++
 .../rest/resources/ConnectorPluginsResource.java   | 10 ++++
 .../kafka/connect/runtime/AbstractHerderTest.java  |  1 -
 .../resources/ConnectorPluginsResourceTest.java    | 22 ++++++++-
 5 files changed, 116 insertions(+), 3 deletions(-)
78fa20eb58a948abd9ad4e44acfed606400a47f3

 .../kafka/connect/runtime/AbstractHerder.java      | 32 ++++++++++++-
 .../runtime/rest/entities/ConnectorPluginInfo.java | 54 ++++++++++++++++++++++
 .../rest/resources/ConnectorPluginsResource.java   | 10 ++++
 .../kafka/connect/runtime/AbstractHerderTest.java  |  1 -
 .../resources/ConnectorPluginsResourceTest.java    | 22 ++++++++-
 5 files changed, 116 insertions(+), 3 deletions(-)
496bd3fd41c0272b7ef77652b85cbaae748e100e

 build.gradle                                       | 123 ++++----
 docs/configuration.html                            |   5 +
 docs/documentation.html                            |  15 +
 docs/quickstart.html                               | 109 +++++++
 docs/streams.html                                  | 341 +++++++++++++++++++++
 .../examples/pageview/PageViewTypedDemo.java       |   3 +-
 .../examples/pageview/PageViewUntypedDemo.java     |   3 +-
 .../kafka/streams/examples/pipe/PipeDemo.java      |   3 +-
 .../streams/examples/wordcount/WordCountDemo.java  |   3 +-
 .../examples/wordcount/WordCountProcessorDemo.java |   3 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |  12 +-
 11 files changed, 546 insertions(+), 74 deletions(-)
23b50093f4100ce7fbff325cdc92ee6cf3c54102

 build.gradle                                       | 123 ++++----
 docs/configuration.html                            |   5 +
 docs/documentation.html                            |  15 +
 docs/quickstart.html                               | 109 +++++++
 docs/streams.html                                  | 341 +++++++++++++++++++++
 .../examples/pageview/PageViewTypedDemo.java       |   3 +-
 .../examples/pageview/PageViewUntypedDemo.java     |   3 +-
 .../kafka/streams/examples/pipe/PipeDemo.java      |   3 +-
 .../streams/examples/wordcount/WordCountDemo.java  |   3 +-
 .../examples/wordcount/WordCountProcessorDemo.java |   3 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |  12 +-
 11 files changed, 546 insertions(+), 74 deletions(-)
1b1b949b7fbd10fe4b08e97769ab024fad8459fb

 .../src/main/java/org/apache/kafka/streams/kstream/KStream.java   | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/KTable.java    | 2 +-
 .../org/apache/kafka/streams/kstream/internals/KStreamFilter.java | 8 ++++----
 .../org/apache/kafka/streams/kstream/internals/KStreamImpl.java   | 2 +-
 .../org/apache/kafka/streams/kstream/internals/KTableFilter.java  | 8 ++++----
 .../org/apache/kafka/streams/kstream/internals/KTableImpl.java    | 2 +-
 .../apache/kafka/streams/kstream/internals/KStreamFilterTest.java | 4 ++--
 .../apache/kafka/streams/kstream/internals/KStreamImplTest.java   | 2 +-
 .../apache/kafka/streams/kstream/internals/KTableFilterTest.java  | 4 ++--
 9 files changed, 17 insertions(+), 17 deletions(-)
c1d8c38345e0a1e04ced143ed07e63fe02ceb8b0

 .../src/main/java/org/apache/kafka/streams/kstream/KStream.java   | 2 +-
 .../src/main/java/org/apache/kafka/streams/kstream/KTable.java    | 2 +-
 .../org/apache/kafka/streams/kstream/internals/KStreamFilter.java | 8 ++++----
 .../org/apache/kafka/streams/kstream/internals/KStreamImpl.java   | 2 +-
 .../org/apache/kafka/streams/kstream/internals/KTableFilter.java  | 8 ++++----
 .../org/apache/kafka/streams/kstream/internals/KTableImpl.java    | 2 +-
 .../apache/kafka/streams/kstream/internals/KStreamFilterTest.java | 4 ++--
 .../apache/kafka/streams/kstream/internals/KStreamImplTest.java   | 2 +-
 .../apache/kafka/streams/kstream/internals/KTableFilterTest.java  | 4 ++--
 9 files changed, 17 insertions(+), 17 deletions(-)
3f930cd84c1a889f0df2bc5057e073e683860171

 .../java/org/apache/kafka/clients/consumer/ConsumerConfig.java    | 2 +-
 docs/upgrade.html                                                 | 8 +++++++-
 2 files changed, 8 insertions(+), 2 deletions(-)
d691faf98cb573c4e92748d95d5c8afc492db806

 .../java/org/apache/kafka/clients/consumer/ConsumerConfig.java    | 2 +-
 docs/upgrade.html                                                 | 8 +++++++-
 2 files changed, 8 insertions(+), 2 deletions(-)
4e5653d77359214452b94a65c9db29eaa57a3c31

 .../main/scala/kafka/tools/KafkaMigrationTool.java | 487 ---------------------
 docs/upgrade.html                                  |   1 +
 2 files changed, 1 insertion(+), 487 deletions(-)
d3a66a65365579e9320347663969b30c1148e497

 .../main/scala/kafka/tools/KafkaMigrationTool.java | 487 ---------------------
 docs/upgrade.html                                  |   1 +
 2 files changed, 1 insertion(+), 487 deletions(-)
2dc17230f90be60c6c08061600fdf79c8e5f5b52

 .../apache/kafka/clients/producer/internals/ErrorLoggingCallback.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
419e268d6fe9695e31e9be299c99573522a81dd0

 .../main/java/org/apache/kafka/connect/runtime/ConnectorConfig.java | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
4e557f8ef60d46a8870704655c9a35092f74d125

 .../kafka/clients/consumer/ConsumerRecord.java     | 29 +++++++++++++
 .../kafka/clients/consumer/internals/Fetcher.java  |  4 +-
 .../kafka/clients/consumer/ConsumerRecordTest.java | 48 ++++++++++++++++++++++
 3 files changed, 79 insertions(+), 2 deletions(-)
cb78223bf90aca4f75699f36c1a82db7661a62f3

 .../kafka/clients/consumer/ConsumerRecord.java     | 29 +++++++++++++
 .../kafka/clients/consumer/internals/Fetcher.java  |  4 +-
 .../kafka/clients/consumer/ConsumerRecordTest.java | 48 ++++++++++++++++++++++
 3 files changed, 79 insertions(+), 2 deletions(-)
0cc997ae76010cf85b55d057dea9996fa1931e5b

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
8525d8279b7798db90f752c329aa3b5936cb5f7f

 bin/streams-smoke-test.sh           | 23 -----------------------
 tests/kafkatest/services/streams.py |  3 ++-
 2 files changed, 2 insertions(+), 24 deletions(-)
de062443381df84ee0d65acc20e44ffca2b2552b

 bin/streams-smoke-test.sh           | 23 -----------------------
 tests/kafkatest/services/streams.py |  3 ++-
 2 files changed, 2 insertions(+), 24 deletions(-)
b31a2f06c80c2c2cacf34d75998d401bddcca374

 .../org/apache/kafka/streams/state/internals/RocksDBWindowStore.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
80d78f81470f109dc6d221f755b039c7332bb93b

 .../org/apache/kafka/streams/state/internals/RocksDBWindowStore.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
63e9d246b7978152e12aa4ea8b1ba6bcc40f4498

 .../main/java/org/apache/kafka/common/Cluster.java | 40 ++++------------------
 .../internals/StreamPartitionAssignor.java         | 12 +++++--
 2 files changed, 17 insertions(+), 35 deletions(-)
d4d5920ed40736d21f056188efa8a86c93e22506

 .../main/java/org/apache/kafka/common/Cluster.java | 40 ++++------------------
 .../internals/StreamPartitionAssignor.java         | 12 +++++--
 2 files changed, 17 insertions(+), 35 deletions(-)
f5e1ca625332572923b42a9ae8d660f2452ae92f

 docs/api.html        | 8 ++++----
 docs/quickstart.html | 6 +++---
 2 files changed, 7 insertions(+), 7 deletions(-)
d57847641037823a7306f53251b063869f7affb6

 docs/api.html        | 8 ++++----
 docs/quickstart.html | 6 +++---
 2 files changed, 7 insertions(+), 7 deletions(-)
2835e73000a44c9586d085275b62eeeb2ce1fcec

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 24 ++++++++++++++++-------
 1 file changed, 17 insertions(+), 7 deletions(-)
20c313526a0518a51142d3abc5ee2a4d2ef3cb34

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 24 ++++++++++++++++-------
 1 file changed, 17 insertions(+), 7 deletions(-)
e5a1f704d7ed59f9a6a423bbc36510d13a5df1de

 core/src/main/scala/kafka/log/FileMessageSet.scala | 28 +++++++++++++---------
 .../scala/unit/kafka/log/FileMessageSetTest.scala  | 17 +++++++++++--
 2 files changed, 32 insertions(+), 13 deletions(-)
7af67ce22aa02121d6b82dc54dad42358282e524

 core/src/main/scala/kafka/log/FileMessageSet.scala | 28 +++++++++++++---------
 .../scala/unit/kafka/log/FileMessageSetTest.scala  | 17 +++++++++++--
 2 files changed, 32 insertions(+), 13 deletions(-)
aead28a54e55ca0541d696abced523b453bb50f7

 .../org/apache/kafka/common/BrokerEndPoint.java    | 88 ----------------------
 .../kafka/common/requests/LeaderAndIsrRequest.java | 14 ++--
 .../common/requests/UpdateMetadataRequest.java     |  8 +-
 .../kafka/common/requests/RequestResponseTest.java | 13 ++--
 core/src/main/scala/kafka/cluster/EndPoint.scala   |  3 +-
 .../controller/ControllerChannelManager.scala      | 12 +--
 .../kafka/api/AuthorizerIntegrationTest.scala      |  8 +-
 .../unit/kafka/server/LeaderElectionTest.scala     | 17 ++---
 .../unit/kafka/server/ReplicaManagerTest.scala     |  6 +-
 9 files changed, 38 insertions(+), 131 deletions(-)
255b5e13863a95cfc327236856db2df188f04d49

 .../org/apache/kafka/common/BrokerEndPoint.java    | 88 ----------------------
 .../kafka/common/requests/LeaderAndIsrRequest.java | 14 ++--
 .../common/requests/UpdateMetadataRequest.java     |  8 +-
 .../kafka/common/requests/RequestResponseTest.java | 13 ++--
 core/src/main/scala/kafka/cluster/EndPoint.scala   |  3 +-
 .../controller/ControllerChannelManager.scala      | 12 +--
 .../kafka/api/AuthorizerIntegrationTest.scala      |  8 +-
 .../unit/kafka/server/LeaderElectionTest.scala     | 17 ++---
 .../unit/kafka/server/ReplicaManagerTest.scala     |  6 +-
 9 files changed, 38 insertions(+), 131 deletions(-)
d1e74890caaf3b76b0d9a888742a2cf1c6e6e883

 .../main/scala/kafka/server/MetadataCache.scala    | 26 ++++++++++------------
 1 file changed, 12 insertions(+), 14 deletions(-)
adca4d7df3155ac29ae510c237adf06c9521d221

 .../main/scala/kafka/server/MetadataCache.scala    | 26 ++++++++++------------
 1 file changed, 12 insertions(+), 14 deletions(-)
d9cbe566371ed1f519fa983c14fc48d088f66b6a

 clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
983e9486ef139f8c9797679732d09feb3f7bfb87

 clients/src/main/java/org/apache/kafka/clients/CommonClientConfigs.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a81e5d05e6fea7fb74dfb19b67729b6dd4ca2423

 clients/src/main/java/org/apache/kafka/clients/consumer/Consumer.java    | 1 -
 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java   | 1 -
 2 files changed, 2 deletions(-)
d6b450ced57bb5ab8a7164358e6a360f97a7b5cc

 clients/src/main/java/org/apache/kafka/clients/consumer/Consumer.java    | 1 -
 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java   | 1 -
 2 files changed, 2 deletions(-)
05984de69ee8eb06f214a2e42abd789a4fbc8cef

 core/src/main/scala/kafka/common/Topic.scala          | 2 +-
 core/src/test/scala/unit/kafka/common/TopicTest.scala | 3 ++-
 docs/ops.html                                         | 2 ++
 3 files changed, 5 insertions(+), 2 deletions(-)
ad3dfc6ab25c3f80d2425e24e72ae732b850dc60

 core/src/main/scala/kafka/common/Topic.scala          | 2 +-
 core/src/test/scala/unit/kafka/common/TopicTest.scala | 3 ++-
 docs/ops.html                                         | 2 ++
 3 files changed, 5 insertions(+), 2 deletions(-)
687d2494ff27b05f21ea29e645a0b1b000334db6

 .../apache/kafka/clients/consumer/ConsumerConfig.java    | 16 ++++++++++++----
 .../java/org/apache/kafka/common/protocol/Errors.java    |  3 ++-
 core/src/main/scala/kafka/server/KafkaConfig.scala       |  4 ++--
 3 files changed, 16 insertions(+), 7 deletions(-)
ca77d67058726fc9df9bdd7cc0217ee62ccc5106

 .../apache/kafka/clients/consumer/ConsumerConfig.java    | 16 ++++++++++++----
 .../java/org/apache/kafka/common/protocol/Errors.java    |  3 ++-
 core/src/main/scala/kafka/server/KafkaConfig.scala       |  4 ++--
 3 files changed, 16 insertions(+), 7 deletions(-)
e2d7f9e445a2cbb5e1e0ed8437af849b731677bf

 .../kafka/common/protocol/types/ArrayOf.java       |  2 +
 .../apache/kafka/common/protocol/types/Type.java   | 22 ++++-
 .../protocol/types/ProtocolSerializationTest.java  | 93 +++++++++++++++++++++-
 3 files changed, 112 insertions(+), 5 deletions(-)
73c79000edddd929cd0af25f4a29fcc682a1c9c0

 .../kafka/common/protocol/types/ArrayOf.java       |  2 +
 .../apache/kafka/common/protocol/types/Type.java   | 22 ++++-
 .../protocol/types/ProtocolSerializationTest.java  | 93 +++++++++++++++++++++-
 3 files changed, 112 insertions(+), 5 deletions(-)
66ac5157d914aacf9b544fe7de91020f445cef3c

 config/server.properties                           | 30 ++++++++++------------
 core/src/main/scala/kafka/server/KafkaConfig.scala | 20 ++++++++++-----
 2 files changed, 28 insertions(+), 22 deletions(-)
73470b028cd659c1c405e6b6ba52bf483113b90b

 config/server.properties                           | 30 ++++++++++------------
 core/src/main/scala/kafka/server/KafkaConfig.scala | 20 ++++++++++-----
 2 files changed, 28 insertions(+), 22 deletions(-)
c0f870f8509253564c73ca76cd9fabb7df4ce6ad

 .../main/java/org/apache/kafka/clients/consumer/Consumer.java |  5 ++---
 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 11 +++++------
 2 files changed, 7 insertions(+), 9 deletions(-)
99cfb99aa161007f2ceae33945d11b968d932175

 .../main/java/org/apache/kafka/clients/consumer/Consumer.java |  5 ++---
 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 11 +++++------
 2 files changed, 7 insertions(+), 9 deletions(-)
808f85f03d8f69047914eb21438d1458e23c4325

 .../kafka/clients/consumer/KafkaConsumer.java      |  2 +-
 .../consumer/internals/ConsumerCoordinator.java    |  4 ++++
 .../consumer/internals/ConsumerNetworkClient.java  |  5 +++--
 .../internals/ConsumerCoordinatorTest.java         |  8 --------
 .../integration/kafka/api/BaseConsumerTest.scala   | 24 ++++++++++++++--------
 .../kafka/api/PlaintextConsumerTest.scala          | 15 ++++++++++++++
 6 files changed, 39 insertions(+), 19 deletions(-)
8d8e3aaa6172d314230a8d61e6892e9c09dc45b6

 .../kafka/clients/consumer/KafkaConsumer.java      |  2 +-
 .../consumer/internals/ConsumerCoordinator.java    |  4 ++++
 .../consumer/internals/ConsumerNetworkClient.java  |  5 +++--
 .../internals/ConsumerCoordinatorTest.java         |  8 --------
 .../integration/kafka/api/BaseConsumerTest.scala   | 24 ++++++++++++++--------
 .../kafka/api/PlaintextConsumerTest.scala          | 15 ++++++++++++++
 6 files changed, 39 insertions(+), 19 deletions(-)
3cfd20b7b9d609c1055f6c23de86b6133e5cac75

 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
4f0417931a71a974241e685031f2a5f1680e9b51

 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
3710b12e6e6a6d8dddb7402087ee550cd14909db

 docs/documentation.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
69df734470f1db9ba1732cb4bedaa1541d721103

 docs/documentation.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
4f8b3aed8dc6a77293c526253123d999a23af149

 .../apache/kafka/streams/kstream/Aggregator.java   |   6 +-
 .../apache/kafka/streams/kstream/Initializer.java  |   4 +-
 .../apache/kafka/streams/kstream/JoinWindows.java  |  15 +-
 .../org/apache/kafka/streams/kstream/KStream.java  | 270 +++++++++++----------
 .../kafka/streams/kstream/KStreamBuilder.java      |  44 ++--
 .../org/apache/kafka/streams/kstream/KTable.java   | 165 +++++++------
 .../kafka/streams/kstream/KeyValueMapper.java      |   6 +-
 .../apache/kafka/streams/kstream/Predicate.java    |   4 +-
 .../org/apache/kafka/streams/kstream/Reducer.java  |   2 +-
 .../apache/kafka/streams/kstream/Transformer.java  |   6 +-
 .../apache/kafka/streams/kstream/ValueJoiner.java  |   6 +-
 .../apache/kafka/streams/kstream/ValueMapper.java  |   4 +-
 .../kafka/streams/kstream/ValueTransformer.java    |   4 +-
 .../org/apache/kafka/streams/kstream/Windowed.java |   5 +-
 .../org/apache/kafka/streams/kstream/Windows.java  |  33 ++-
 .../streams/processor/DefaultPartitionGrouper.java |   8 +-
 .../kafka/streams/processor/ProcessorContext.java  |   2 +
 .../apache/kafka/streams/state/KeyValueStore.java  |   2 +
 .../apache/kafka/streams/state/WindowStore.java    |   2 +
 19 files changed, 303 insertions(+), 285 deletions(-)
b6c29e3810bd59f39fa93c429817396cf8c324b7

 .../apache/kafka/streams/kstream/Aggregator.java   |   6 +-
 .../apache/kafka/streams/kstream/Initializer.java  |   4 +-
 .../apache/kafka/streams/kstream/JoinWindows.java  |  15 +-
 .../org/apache/kafka/streams/kstream/KStream.java  | 270 +++++++++++----------
 .../kafka/streams/kstream/KStreamBuilder.java      |  44 ++--
 .../org/apache/kafka/streams/kstream/KTable.java   | 165 +++++++------
 .../kafka/streams/kstream/KeyValueMapper.java      |   6 +-
 .../apache/kafka/streams/kstream/Predicate.java    |   4 +-
 .../org/apache/kafka/streams/kstream/Reducer.java  |   2 +-
 .../apache/kafka/streams/kstream/Transformer.java  |   6 +-
 .../apache/kafka/streams/kstream/ValueJoiner.java  |   6 +-
 .../apache/kafka/streams/kstream/ValueMapper.java  |   4 +-
 .../kafka/streams/kstream/ValueTransformer.java    |   4 +-
 .../org/apache/kafka/streams/kstream/Windowed.java |   5 +-
 .../org/apache/kafka/streams/kstream/Windows.java  |  33 ++-
 .../streams/processor/DefaultPartitionGrouper.java |   8 +-
 .../kafka/streams/processor/ProcessorContext.java  |   2 +
 .../apache/kafka/streams/state/KeyValueStore.java  |   2 +
 .../apache/kafka/streams/state/WindowStore.java    |   2 +
 19 files changed, 303 insertions(+), 285 deletions(-)
702d560c555bf7121eca02010adedd4986e36b87

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1b5879653e0d956c79556301d1d11987baf6f2d7

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4f048c4f194a90ded5f0df35e4e23379272d5bc6

 .../main/java/org/apache/kafka/common/requests/FetchRequest.java  | 8 +++++---
 .../org/apache/kafka/common/requests/RequestResponseTest.java     | 3 ++-
 2 files changed, 7 insertions(+), 4 deletions(-)
95eabc8c8b383af84466d4c2cfafd0920e5a52ee

 .../main/java/org/apache/kafka/common/network/Selector.java    | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
c188a68e2b487191f1f3004e22b68c21e26c3f2e

 Vagrantfile                               |   4 +-
 tests/README.md                           |   9 +-
 vagrant/README.md                         |  17 ++-
 vagrant/aws/aws-example-Vagrantfile.local |   1 +
 vagrant/vagrant-up.sh                     | 237 ++++++++++++++++++++++++++++++
 5 files changed, 258 insertions(+), 10 deletions(-)
bfac36ad0e378b5f39e3889e40a75c5c1fc48fa7

 .../kafka/security/auth/SimpleAclAuthorizer.scala  | 219 ++++++++++++++-------
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  39 ++--
 .../security/auth/SimpleAclAuthorizerTest.scala    |  86 +++++++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  60 +++++-
 4 files changed, 318 insertions(+), 86 deletions(-)
eb823281a52f3b27c3a889e7412bc07b3024e688

 build.gradle                                       |   1 +
 .../apache/kafka/connect/runtime/WorkerConfig.java |  14 +-
 .../kafka/connect/runtime/rest/RestServer.java     |  12 ++
 .../kafka/connect/runtime/rest/RestServerTest.java | 150 +++++++++++++++++++++
 gradle/dependencies.gradle                         |   1 +
 5 files changed, 177 insertions(+), 1 deletion(-)
655367971875a8d6a079ff7d186c05a6b76a9c53

 core/src/main/scala/kafka/api/FetchRequest.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
b6c6291e1f42b2ca1fbcdaf662a2a868c8881921

 .../apache/kafka/common/network/KafkaChannel.java  |   4 +-
 .../common/network/PlaintextTransportLayer.java    |   8 +-
 .../org/apache/kafka/common/network/Selector.java  | 161 +++++++++++----------
 .../kafka/common/network/SslTransportLayer.java    |   8 +-
 .../kafka/common/network/TransportLayer.java       |   2 +-
 5 files changed, 101 insertions(+), 82 deletions(-)
4332175c11dda5deb491f27a6ecf66661676ca47

 .../apache/kafka/clients/consumer/Consumer.java    | 35 ++++-----
 .../kafka/clients/consumer/KafkaConsumer.java      | 85 +++++++++++-----------
 .../kafka/clients/consumer/MockConsumer.java       | 16 ++--
 .../consumer/internals/SubscriptionState.java      |  7 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 29 ++++----
 .../kafka/connect/runtime/WorkerSinkTask.java      |  9 ++-
 .../connect/runtime/WorkerSinkTaskContext.java     |  5 +-
 .../apache/kafka/connect/util/KafkaBasedLog.java   |  6 +-
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 14 ++--
 .../runtime/WorkerSinkTaskThreadedTest.java        |  8 +-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |  2 +-
 .../scala/kafka/tools/ConsumerPerformance.scala    |  3 +-
 .../main/scala/kafka/tools/EndToEndLatency.scala   |  5 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  6 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  4 +-
 .../kafka/api/PlaintextConsumerTest.scala          | 17 +++--
 .../processor/internals/ProcessorStateManager.java |  6 +-
 .../streams/processor/internals/StreamTask.java    |  6 +-
 .../streams/processor/internals/StreamThread.java  |  8 +-
 .../internals/ProcessorStateManagerTest.java       | 14 ++--
 .../processor/internals/StandbyTaskTest.java       |  5 +-
 .../kafka/streams/smoketest/SmokeTestDriver.java   |  2 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |  5 +-
 23 files changed, 156 insertions(+), 141 deletions(-)
07360cb0d24b18f6f7c8a35d437c7cb2b0142506

 core/src/main/scala/kafka/tools/GetOffsetShell.scala | 1 +
 1 file changed, 1 insertion(+)
d9bf55171ba41962edc05cdf106f540cf94a2c3e

 .../kafka/clients/consumer/OffsetAndMetadata.java   |  3 ---
 .../org/apache/kafka/common/protocol/Protocol.java  |  8 ++++----
 .../kafka/common/requests/OffsetCommitResponse.java |  5 +++++
 .../kafka/common/requests/RequestResponseTest.java  | 21 +++++++++++++++++----
 core/src/main/scala/kafka/server/KafkaApis.scala    |  3 ++-
 .../kafka/api/PlaintextConsumerTest.scala           |  6 +++++-
 6 files changed, 33 insertions(+), 13 deletions(-)
5d0cd7667f7e584f05ab4e76ed139fbafa81e042

 .../examples/pageview/PageViewTypedDemo.java       |  15 +-
 .../examples/pageview/PageViewUntypedDemo.java     |   2 +-
 .../streams/examples/wordcount/WordCountDemo.java  |   9 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |  49 ++++--
 .../org/apache/kafka/streams/kstream/KStream.java  | 165 +++++++++++++++++----
 .../org/apache/kafka/streams/kstream/KTable.java   |  76 ++++++++--
 .../streams/kstream/internals/KStreamImpl.java     |  83 +++++++++--
 .../streams/kstream/internals/KTableImpl.java      |  52 +++++--
 .../kstream/internals/KTableStoreSupplier.java     |  11 +-
 .../ConsumerRecordTimestampExtractor.java          |  39 +++++
 .../processor/WallclockTimestampExtractor.java     |  35 +++++
 .../internals/WallclockTimestampExtractor.java     |  28 ----
 .../apache/kafka/streams/state/StateSerdes.java    |  22 +--
 .../org/apache/kafka/streams/state/Stores.java     |  18 +--
 .../kafka/streams/state/WindowStoreUtils.java      |  15 +-
 .../internals/InMemoryKeyValueLoggedStore.java     |  26 +++-
 .../internals/InMemoryKeyValueStoreSupplier.java   |  47 +++---
 .../internals/InMemoryLRUCacheStoreSupplier.java   |  16 +-
 .../streams/state/internals/MemoryLRUCache.java    |  25 +---
 .../internals/RocksDBKeyValueStoreSupplier.java    |  16 +-
 .../streams/state/internals/RocksDBStore.java      |  27 ++--
 .../state/internals/RocksDBWindowStore.java        |  24 ++-
 .../internals/RocksDBWindowStoreSupplier.java      |  16 +-
 .../streams/kstream/internals/KTableImplTest.java  |   4 +-
 .../kstream/internals/KTableMapValuesTest.java     |   2 +-
 .../kafka/streams/smoketest/SmokeTestClient.java   |  18 +--
 .../state/internals/RocksDBWindowStoreTest.java    |  28 ++--
 27 files changed, 610 insertions(+), 258 deletions(-)
0d8cbbcb208ccaf1cb84df0440331d4cef064391

 .../tests/compatibility_test_new_broker.py         | 78 ------------------
 .../tests/compatibility_test_new_broker_test.py    | 78 ++++++++++++++++++
 tests/kafkatest/tests/consumer_rolling_upgrade.py  | 82 -------------------
 .../tests/consumer_rolling_upgrade_test.py         | 82 +++++++++++++++++++
 tests/kafkatest/tests/message_format_change.py     | 92 ----------------------
 .../kafkatest/tests/message_format_change_test.py  | 92 ++++++++++++++++++++++
 6 files changed, 252 insertions(+), 252 deletions(-)
e89a9ce1a4383af32435c7f4ee04361b1b65797d

 core/src/main/scala/kafka/client/ClientUtils.scala |  1 +
 .../scala/kafka/javaapi/producer/Producer.scala    |  2 +
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |  1 +
 .../main/scala/kafka/producer/BaseProducer.scala   |  6 ++
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  3 +-
 .../kafka/producer/ByteArrayPartitioner.scala      |  2 +
 .../scala/kafka/producer/DefaultPartitioner.scala  |  2 +
 .../main/scala/kafka/producer/KeyedMessage.scala   |  2 +
 .../main/scala/kafka/producer/Partitioner.scala    |  2 +
 core/src/main/scala/kafka/producer/Producer.scala  |  3 +-
 .../kafka/producer/ProducerClosedException.scala   |  1 +
 .../main/scala/kafka/producer/ProducerConfig.scala |  4 +
 .../main/scala/kafka/producer/ProducerPool.scala   |  3 +-
 .../kafka/producer/ProducerRequestStats.scala      |  3 +
 .../main/scala/kafka/producer/ProducerStats.scala  |  2 +
 .../scala/kafka/producer/ProducerTopicStats.scala  |  4 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |  4 +
 .../scala/kafka/producer/SyncProducerConfig.scala  |  6 ++
 .../kafka/producer/async/AsyncProducerConfig.scala |  2 +
 .../kafka/producer/async/DefaultEventHandler.scala |  1 +
 .../scala/kafka/producer/async/EventHandler.scala  |  1 +
 .../async/IllegalQueueStateException.scala         |  1 +
 .../producer/async/MissingConfigException.scala    |  1 +
 .../kafka/producer/async/ProducerSendThread.scala  |  1 +
 .../main/scala/kafka/tools/KafkaMigrationTool.java |  2 +-
 .../kafka/api/BaseProducerSendTest.scala           | 22 +----
 .../kafka/api/PlaintextProducerSendTest.scala      | 24 +++++-
 .../kafka/api/ProducerFailureHandlingTest.scala    |  9 +-
 .../scala/kafka/tools/ConsoleProducerTest.scala    |  3 +-
 .../test/scala/unit/kafka/common/ConfigTest.scala  |  1 +
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  1 +
 .../kafka/integration/AutoOffsetResetTest.scala    |  1 +
 .../scala/unit/kafka/integration/FetcherTest.scala |  4 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  1 +
 .../integration/ProducerConsumerTestHarness.scala  |  1 +
 .../integration/UncleanLeaderElectionTest.scala    | 23 +++--
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  2 +-
 .../scala/unit/kafka/metrics/MetricsTest.scala     |  6 +-
 .../unit/kafka/network/SocketServerTest.scala      | 14 ++-
 .../unit/kafka/producer/AsyncProducerTest.scala    | 21 +++--
 .../scala/unit/kafka/producer/ProducerTest.scala   |  1 +
 .../unit/kafka/producer/SyncProducerTest.scala     | 34 +++++---
 .../unit/kafka/server/BaseReplicaFetchTest.scala   | 22 ++---
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 25 +++---
 .../unit/kafka/server/ServerShutdownTest.scala     | 36 ++++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 99 +++++++++++++---------
 46 files changed, 263 insertions(+), 147 deletions(-)
dea0719e99211684775780f5da8b93835d7a5dac

 .../common/serialization/DoubleDeserializer.java   |  46 +++++
 .../common/serialization/DoubleSerializer.java     |  46 +++++
 .../apache/kafka/common/serialization/Serde.java   |  26 +++
 .../apache/kafka/common/serialization/Serdes.java  | 193 +++++++++++++++++++++
 .../common/serialization/SerializationTest.java    | 115 +++++++++---
 .../examples/pageview/PageViewTypedDemo.java       |  39 +++--
 .../examples/pageview/PageViewUntypedDemo.java     |  20 +--
 .../kafka/streams/examples/pipe/PipeDemo.java      |   9 +-
 .../streams/examples/wordcount/WordCountDemo.java  |  20 +--
 .../examples/wordcount/WordCountProcessorDemo.java |   9 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |  75 +++-----
 .../org/apache/kafka/streams/kstream/KStream.java  | 133 +++++---------
 .../kafka/streams/kstream/KStreamBuilder.java      |  38 ++--
 .../org/apache/kafka/streams/kstream/KTable.java   |  51 ++----
 .../streams/kstream/internals/KStreamImpl.java     | 134 ++++++--------
 .../streams/kstream/internals/KTableImpl.java      |  94 ++++------
 .../kstream/internals/KTableStoreSupplier.java     |  13 +-
 .../kafka/streams/processor/ProcessorContext.java  |  25 +--
 .../kafka/streams/processor/TopologyBuilder.java   |  24 +--
 .../processor/internals/ProcessorContextImpl.java  |  35 ++--
 .../streams/processor/internals/SinkNode.java      |   4 +-
 .../streams/processor/internals/SourceNode.java    |   4 +-
 .../processor/internals/StandbyContextImpl.java    |  33 +---
 .../streams/processor/internals/StreamThread.java  |   2 -
 .../org/apache/kafka/streams/state/Serdes.java     | 136 ---------------
 .../apache/kafka/streams/state/StateSerdes.java    | 108 ++++++++++++
 .../org/apache/kafka/streams/state/Stores.java     | 109 +++++++-----
 .../kafka/streams/state/WindowStoreUtils.java      |   6 +-
 .../internals/InMemoryKeyValueLoggedStore.java     |   6 +-
 .../internals/InMemoryKeyValueStoreSupplier.java   |  10 +-
 .../internals/InMemoryLRUCacheStoreSupplier.java   |   6 +-
 .../streams/state/internals/MemoryLRUCache.java    |   6 +-
 .../internals/RocksDBKeyValueStoreSupplier.java    |   6 +-
 .../streams/state/internals/RocksDBStore.java      |  14 +-
 .../state/internals/RocksDBWindowStore.java        |  12 +-
 .../internals/RocksDBWindowStoreSupplier.java      |   6 +-
 .../streams/state/internals/StoreChangeLogger.java |  10 +-
 .../apache/kafka/streams/StreamsConfigTest.java    |  10 --
 .../kstream/internals/KStreamBranchTest.java       |   8 +-
 .../kstream/internals/KStreamFilterTest.java       |  10 +-
 .../kstream/internals/KStreamFlatMapTest.java      |   8 +-
 .../internals/KStreamFlatMapValuesTest.java        |   8 +-
 .../streams/kstream/internals/KStreamImplTest.java |  24 +--
 .../kstream/internals/KStreamKStreamJoinTest.java  |  33 ++--
 .../internals/KStreamKStreamLeftJoinTest.java      |  26 ++-
 .../internals/KStreamKTableLeftJoinTest.java       |  20 +--
 .../streams/kstream/internals/KStreamMapTest.java  |  11 +-
 .../kstream/internals/KStreamMapValuesTest.java    |  10 +-
 .../kstream/internals/KStreamTransformTest.java    |   9 +-
 .../internals/KStreamTransformValuesTest.java      |   8 +-
 .../internals/KStreamWindowAggregateTest.java      |  33 ++--
 .../kstream/internals/KTableAggregateTest.java     |  22 +--
 .../kstream/internals/KTableFilterTest.java        |  28 ++-
 .../streams/kstream/internals/KTableImplTest.java  |  37 ++--
 .../kstream/internals/KTableKTableJoinTest.java    |  24 ++-
 .../internals/KTableKTableLeftJoinTest.java        |  30 ++--
 .../internals/KTableKTableOuterJoinTest.java       |  24 ++-
 .../kstream/internals/KTableMapValuesTest.java     |  31 ++--
 .../kstream/internals/KTableSourceTest.java        |  26 ++-
 .../internals/WindowedStreamPartitionerTest.java   |  10 +-
 .../processor/internals/ProcessorTopologyTest.java |   7 +-
 .../processor/internals/StandbyTaskTest.java       |   7 +-
 .../internals/StreamPartitionAssignorTest.java     |   7 +-
 .../processor/internals/StreamTaskTest.java        |   7 +-
 .../processor/internals/StreamThreadTest.java      |   7 +-
 .../kafka/streams/smoketest/SmokeTestClient.java   |  69 +++-----
 .../kafka/streams/smoketest/SmokeTestDriver.java   |  22 +--
 .../kafka/streams/smoketest/SmokeTestUtil.java     |  81 +--------
 .../streams/state/KeyValueStoreTestDriver.java     |  72 ++------
 .../state/internals/InMemoryKeyValueStoreTest.java |   8 +-
 .../state/internals/InMemoryLRUCacheStoreTest.java |   8 +-
 .../state/internals/RocksDBKeyValueStoreTest.java  |   8 +-
 .../state/internals/RocksDBWindowStoreTest.java    |  49 +++---
 .../state/internals/StoreChangeLoggerTest.java     |   6 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  13 +-
 .../apache/kafka/test/MockProcessorContext.java    |  55 ++----
 76 files changed, 1184 insertions(+), 1315 deletions(-)
f57dabbe56b3db40c06a1946d4cecd0a144b6ac4

 tests/kafkatest/services/kafka/kafka.py        | 13 +++-
 tests/kafkatest/services/kafka/version.py      |  4 ++
 tests/kafkatest/tests/message_format_change.py | 92 ++++++++++++++++++++++++++
 3 files changed, 107 insertions(+), 2 deletions(-)
579d473ce9c5ef1a442af734e362dd545e5ab988

 core/src/main/scala/kafka/log/LogCleaner.scala        |  7 +++++++
 core/src/main/scala/kafka/log/LogCleanerManager.scala | 12 ++++++++++++
 core/src/main/scala/kafka/log/LogManager.scala        |  8 ++++++--
 3 files changed, 25 insertions(+), 2 deletions(-)
61281f5c53ebe130defa881f32084c581cf16d43

 build.gradle | 11 +++++++++++
 1 file changed, 11 insertions(+)
3f28d77449bd3280f53edab81657e6c2a37f3c3e

 .../src/main/scala/kafka/admin/ConfigCommand.scala |  2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |  2 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |  6 +++---
 core/src/main/scala/kafka/server/KafkaConfig.scala | 24 +++++++++++-----------
 4 files changed, 17 insertions(+), 17 deletions(-)
8ef804dc194bb562b6dbe48855e81965cacd1114

 .../main/scala/kafka/server/MetadataCache.scala    |  2 +-
 .../unit/kafka/server/MetadataCacheTest.scala      | 28 ++++++++++++++++++++++
 2 files changed, 29 insertions(+), 1 deletion(-)
c07d017227f319250e5c373f8a6f504874ecfbf2

 build.gradle                                       |   1 +
 .../apache/kafka/common/config/AbstractConfig.java |  26 +-
 .../org/apache/kafka/common/config/Config.java     |  28 +
 .../org/apache/kafka/common/config/ConfigDef.java  | 652 +++++++++++++++++++--
 .../apache/kafka/common/config/ConfigValue.java    | 113 ++++
 .../apache/kafka/common/config/ConfigDefTest.java  | 202 ++++++-
 .../apache/kafka/connect/connector/Connector.java  |  21 +
 .../connector/ConnectorReconfigurationTest.java    |   9 +-
 .../connect/file/FileStreamSinkConnector.java      |  11 +
 .../connect/file/FileStreamSourceConnector.java    |  12 +
 .../kafka/connect/runtime/AbstractHerder.java      | 109 +++-
 .../kafka/connect/runtime/ConnectorConfig.java     |  18 +-
 .../org/apache/kafka/connect/runtime/Herder.java   |   7 +
 .../org/apache/kafka/connect/runtime/Worker.java   |   5 +
 .../runtime/distributed/DistributedHerder.java     |   6 +-
 .../kafka/connect/runtime/rest/RestServer.java     |   8 +-
 .../connect/runtime/rest/entities/ConfigInfo.java  |  66 +++
 .../connect/runtime/rest/entities/ConfigInfos.java | 102 ++++
 .../runtime/rest/entities/ConfigKeyInfo.java       | 171 ++++++
 .../runtime/rest/entities/ConfigValueInfo.java     | 106 ++++
 .../runtime/rest/entities/ConnectorInfo.java       |   5 +-
 .../rest/resources/ConnectorPluginsResource.java   |  49 ++
 .../runtime/rest/resources/ConnectorsResource.java |  16 +-
 .../runtime/standalone/StandaloneHerder.java       |   4 +-
 .../connect/tools/VerifiableSinkConnector.java     |   6 +
 .../connect/tools/VerifiableSourceConnector.java   |   6 +
 .../kafka/connect/runtime/AbstractHerderTest.java  |  10 +-
 .../apache/kafka/connect/runtime/WorkerTest.java   |  12 +-
 .../resources/ConnectorPluginsResourceTest.java    | 165 ++++++
 .../rest/resources/ConnectorsResourceTest.java     |   4 +-
 30 files changed, 1836 insertions(+), 114 deletions(-)
a1eb12d7c6ad9422b9cf24b670d1b4c11227b03e

 tests/kafkatest/services/kafka/config_property.py  |  2 +-
 .../tests/compatibility_test_new_broker.py         | 78 ++++++++++++++++++++++
 2 files changed, 79 insertions(+), 1 deletion(-)
30e78fa00650b258f3ab5ef6c9bdf5ca137289c0

 .../kafka/clients/consumer/ConsumerConfig.java     | 11 +++++++
 .../kafka/clients/consumer/KafkaConsumer.java      |  3 +-
 .../consumer/internals/ConsumerCoordinator.java    |  9 ++++--
 .../kafka/common/internals/TopicConstants.java     | 33 +++++++++++++++++++
 .../internals/ConsumerCoordinatorTest.java         | 37 ++++++++++++++++++----
 core/src/main/scala/kafka/admin/TopicCommand.scala |  7 ++--
 core/src/main/scala/kafka/common/Topic.scala       |  2 --
 .../main/scala/kafka/consumer/TopicFilter.scala    |  5 +--
 .../scala/kafka/coordinator/GroupCoordinator.scala |  3 --
 .../kafka/coordinator/GroupMetadataManager.scala   | 30 ++++++++----------
 core/src/main/scala/kafka/server/KafkaApis.scala   | 11 ++++---
 .../main/scala/kafka/server/ReplicaManager.scala   |  5 ++-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  5 ++-
 .../integration/kafka/api/BaseConsumerTest.scala   |  7 ++--
 .../kafka/api/IntegrationTestHarness.scala         |  4 +--
 .../kafka/api/ProducerFailureHandlingTest.scala    |  4 +--
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |  9 +++---
 .../unit/kafka/consumer/TopicFilterTest.scala      |  9 +++---
 .../coordinator/GroupCoordinatorResponseTest.scala | 14 ++++----
 19 files changed, 135 insertions(+), 73 deletions(-)
dce06766da245ca95951c9c7e82d6a113db7cb13

 .../kafka/clients/consumer/ConsumerRecords.java    |  2 +-
 .../clients/consumer/ConsumerRecordsTest.java      | 58 ++++++++++++++++++++++
 2 files changed, 59 insertions(+), 1 deletion(-)
958e10c87ce293c3bf59bb9840eaaae915eff25e

 .../examples/pageview/JsonTimestampExtractor.java  |   8 +-
 .../examples/pageview/PageViewTypedDemo.java       | 180 ++++++++++++++++++++
 .../examples/pageview/PageViewTypedJob.java        | 184 ---------------------
 .../examples/pageview/PageViewUntypedDemo.java     | 136 +++++++++++++++
 .../examples/pageview/PageViewUntypedJob.java      | 140 ----------------
 .../kafka/streams/examples/pipe/PipeDemo.java      |  65 ++++++++
 .../kafka/streams/examples/pipe/PipeJob.java       |  65 --------
 .../streams/examples/wordcount/WordCountDemo.java  |  96 +++++++++++
 .../streams/examples/wordcount/WordCountJob.java   |  96 -----------
 .../examples/wordcount/WordCountProcessorDemo.java | 137 +++++++++++++++
 .../examples/wordcount/WordCountProcessorJob.java  | 137 ---------------
 .../org/apache/kafka/streams/KafkaStreams.java     |  12 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |  14 +-
 .../kafka/streams/processor/PartitionGrouper.java  |   8 +-
 .../kafka/streams/processor/ProcessorContext.java  |   6 +-
 .../kafka/streams/processor/TopologyBuilder.java   |  42 ++---
 .../streams/processor/internals/AbstractTask.java  |  16 +-
 .../processor/internals/ProcessorContextImpl.java  |   9 +-
 .../processor/internals/ProcessorStateManager.java |  14 +-
 .../processor/internals/StandbyContextImpl.java    |  14 +-
 .../streams/processor/internals/StandbyTask.java   |  12 +-
 .../internals/StreamPartitionAssignor.java         |   4 +-
 .../streams/processor/internals/StreamTask.java    |   6 +-
 .../streams/processor/internals/StreamThread.java  |  28 ++--
 .../streams/state/internals/StoreChangeLogger.java |   2 +-
 .../apache/kafka/streams/StreamsConfigTest.java    |   7 +-
 .../internals/ProcessorStateManagerTest.java       |  28 ++--
 .../processor/internals/ProcessorTopologyTest.java |   2 +-
 .../processor/internals/StandbyTaskTest.java       |  20 +--
 .../internals/StreamPartitionAssignorTest.java     |   2 +-
 .../processor/internals/StreamTaskTest.java        |   6 +-
 .../processor/internals/StreamThreadTest.java      |  34 ++--
 .../kafka/streams/smoketest/SmokeTestClient.java   |   2 +-
 .../apache/kafka/test/MockProcessorContext.java    |   4 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   6 +-
 35 files changed, 762 insertions(+), 780 deletions(-)
9a836d0154efe6ea1effc688567186cb56265bf4

 .../kafka/clients/producer/KafkaProducer.java      | 36 +++++++++-----
 .../clients/producer/ProducerInterceptor.java      |  7 ++-
 .../kafka/clients/producer/RecordMetadata.java     |  5 ++
 .../producer/internals/ProducerInterceptors.java   | 35 ++++++++++++-
 .../internals/ProducerInterceptorsTest.java        | 58 ++++++++++++++++++++++
 .../apache/kafka/test/MockProducerInterceptor.java |  9 +++-
 .../kafka/api/PlaintextConsumerTest.scala          |  5 +-
 7 files changed, 138 insertions(+), 17 deletions(-)
858047a12ba3a7d426178c63226dd2c7509f20dd

 .../main/scala/kafka/server/MetadataCache.scala    |  7 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  2 +-
 .../unit/kafka/server/MetadataCacheTest.scala      | 90 ++++++++++++++++------
 3 files changed, 72 insertions(+), 27 deletions(-)
cd8bd606cbf63f37eaee448ffbbab01ce3e0e7db

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b0f811804fb818792dfc55298bd11eacd19dec5c

 tests/kafkatest/tests/compatibility_test.py | 102 ----------------------------
 1 file changed, 102 deletions(-)
6834b91e349f2ed4b8ff5c97eb3b0c390bc27648

 .../connect/runtime/WorkerSourceTaskTest.java      | 25 +++++++---------------
 1 file changed, 8 insertions(+), 17 deletions(-)
6eacc0de303e4d29e083b89c1f53615c1dfa291e

 .../org/apache/kafka/connect/source/SourceTask.java     | 16 ++++++++++++++++
 .../apache/kafka/connect/runtime/WorkerSourceTask.java  |  9 +++++++++
 .../kafka/connect/runtime/WorkerSourceTaskTest.java     | 17 +++++++++++++++++
 3 files changed, 42 insertions(+)
fd6efbe0b7f18beb506f112350b30b7209a2f5cc

 .../java/org/apache/kafka/streams/examples/wordcount/WordCountJob.java   | 1 -
 1 file changed, 1 deletion(-)
90c623d10f1c081e41f151eb28524f0fb57609c7

 core/src/test/scala/unit/kafka/log/LogTest.scala | 55 +++++++++++++++---------
 1 file changed, 34 insertions(+), 21 deletions(-)
355076cd262dd071287a1c8586ae0f9635e218e3

 .../streams/examples/pageview/PageViewTypedJob.java |  3 +--
 .../examples/pageview/PageViewUntypedJob.java       |  3 +--
 .../streams/examples/wordcount/WordCountJob.java    |  3 +--
 .../org/apache/kafka/streams/kstream/KStream.java   |  9 ++-------
 .../org/apache/kafka/streams/kstream/KTable.java    |  2 --
 .../streams/kstream/internals/KStreamImpl.java      | 21 ++++++++++-----------
 .../kafka/streams/kstream/internals/KTableImpl.java |  9 +++++----
 .../kafka/streams/smoketest/SmokeTestClient.java    |  8 ++------
 8 files changed, 22 insertions(+), 36 deletions(-)
951e30adc6d4a0ed37dcc3fde0050ca5faff146d

 .../org/apache/kafka/common/protocol/Protocol.java |  22 +-
 .../apache/kafka/common/protocol/types/Struct.java |  13 +-
 .../common/requests/UpdateMetadataRequest.java     |  47 +++--
 .../kafka/common/requests/RequestResponseTest.java |  43 ++--
 core/src/main/scala/kafka/admin/AdminUtils.scala   | 235 +++++++++++++++++----
 .../main/scala/kafka/admin/BrokerMetadata.scala    |  23 ++
 .../src/main/scala/kafka/admin/RackAwareMode.scala |  42 ++++
 .../kafka/admin/ReassignPartitionsCommand.scala    |  37 ++--
 core/src/main/scala/kafka/admin/TopicCommand.scala |   5 +-
 core/src/main/scala/kafka/cluster/Broker.scala     | 112 +++++-----
 .../controller/ControllerChannelManager.scala      |  39 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  10 +
 .../main/scala/kafka/server/KafkaHealthcheck.scala |  13 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../main/scala/kafka/server/MetadataCache.scala    |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  74 ++++---
 .../kafka/api/RackAwareAutoTopicCreationTest.scala |  65 ++++++
 .../unit/kafka/admin/AdminRackAwareTest.scala      | 196 +++++++++++++++++
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  47 ++++-
 .../scala/unit/kafka/admin/RackAwareTest.scala     |  82 +++++++
 .../admin/ReassignPartitionsCommandTest.scala      |  51 +++++
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |  32 ++-
 .../unit/kafka/cluster/BrokerEndPointTest.scala    |  14 --
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  33 +--
 docs/upgrade.html                                  |   5 +
 27 files changed, 1000 insertions(+), 250 deletions(-)
deb2b004cb983baa9e2fbff47b39a6f9a243623d

 .../java/org/apache/kafka/clients/producer/internals/RecordBatch.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
241c3ebb2803f1e09306fb06f20a66e7a60ca3c8

 build.gradle                                           | 18 ++++++++++++++++++
 .../apache/kafka/clients/consumer/ConsumerRecords.java |  2 ++
 .../consumer/internals/ConsumerCoordinator.java        |  4 ++--
 .../clients/consumer/internals/RequestFuture.java      |  6 +++---
 .../apache/kafka/clients/producer/KafkaProducer.java   |  2 +-
 .../kafka/common/network/SaslChannelBuilder.java       |  1 +
 .../kafka/common/security/kerberos/LoginManager.java   |  2 +-
 .../apache/kafka/common/security/ssl/SslFactory.java   |  3 ++-
 .../main/java/org/apache/kafka/common/utils/Utils.java |  2 ++
 .../kafka/common/requests/RequestResponseTest.java     |  1 +
 .../java/org/apache/kafka/connect/data/Struct.java     |  2 ++
 .../org/apache/kafka/connect/json/JsonConverter.java   |  2 +-
 .../java/org/apache/kafka/connect/runtime/Worker.java  |  1 +
 .../kafka/connect/storage/KafkaConfigStorage.java      |  1 +
 .../kafka/connect/storage/KafkaStatusBackingStore.java |  2 ++
 .../kafka/connect/storage/OffsetStorageReaderImpl.java |  1 +
 .../org/apache/kafka/connect/storage/OffsetUtils.java  |  1 +
 .../connect/runtime/WorkerSinkTaskThreadedTest.java    |  1 +
 .../kafka/connect/runtime/WorkerSourceTaskTest.java    |  1 +
 .../runtime/rest/resources/ConnectorsResourceTest.java |  1 +
 .../runtime/standalone/StandaloneHerderTest.java       |  1 +
 .../kafka/connect/storage/KafkaConfigStorageTest.java  |  1 +
 .../connect/storage/KafkaOffsetBackingStoreTest.java   |  1 +
 .../connect/storage/KafkaStatusBackingStoreTest.java   |  1 +
 .../connect/util/ByteArrayProducerRecordEquals.java    |  1 +
 .../test/scala/integration/kafka/api/QuotasTest.scala  |  1 -
 core/src/test/scala/kafka/tools/TestLogCleaning.scala  |  4 ++--
 .../common/ZkNodeChangeNotificationListenerTest.scala  |  8 ++++----
 28 files changed, 56 insertions(+), 16 deletions(-)
ffbe624e6f4906c55080508fab19ac60dc93761e

 core/src/main/scala/kafka/log/LogConfig.scala      | 12 ++++----
 .../main/scala/kafka/server/ConfigHandler.scala    |  4 +--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 33 ++++++++++++----------
 core/src/main/scala/kafka/server/KafkaServer.scala |  6 ++--
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  4 +--
 .../scala/unit/kafka/server/LogOffsetTest.scala    | 24 ++++++++--------
 docs/upgrade.html                                  |  4 +--
 tests/kafkatest/services/kafka/config_property.py  |  2 +-
 tests/kafkatest/tests/upgrade_test.py              |  6 ++--
 9 files changed, 48 insertions(+), 47 deletions(-)
cf40acc2b17cf6d32cee712dad6c88a851ae0715

 .../streams/processor/internals/ProcessorStateManager.java   | 12 ------------
 .../kafka/streams/processor/internals/PunctuationQueue.java  |  2 +-
 .../kafka/streams/processor/internals/RecordCollector.java   |  4 ++--
 3 files changed, 3 insertions(+), 15 deletions(-)
c1a56c6839e77f3de5266315a92b236a379ec857

 .../kafka/streams/processor/TopologyBuilder.java   | 76 +++++++++++++++-------
 .../internals/StreamPartitionAssignor.java         |  6 +-
 .../streams/processor/internals/StreamThread.java  |  6 +-
 .../streams/kstream/internals/KStreamImplTest.java |  2 +-
 .../streams/processor/TopologyBuilderTest.java     | 28 ++++----
 .../processor/internals/ProcessorTopologyTest.java |  2 +-
 .../internals/StreamPartitionAssignorTest.java     |  6 +-
 .../processor/internals/StreamThreadTest.java      |  6 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  4 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |  2 +-
 tests/kafkatest/tests/streams_bounce_test.py       |  1 -
 tests/kafkatest/tests/streams_smoke_test.py        |  1 -
 12 files changed, 84 insertions(+), 56 deletions(-)
ac7b2e95d342972e3499d203bc23e1675e90c591

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c9311d5f4ec3b135cb6c0f87008da946863daaa2

 core/src/main/scala/kafka/log/Log.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a162f6bf66d0d21505c8d11942f84be446616491

 tests/kafkatest/services/kafka/kafka.py        | 20 +++++-
 tests/kafkatest/tests/get_offset_shell_test.py | 91 ++++++++++++++++++++++++++
 2 files changed, 110 insertions(+), 1 deletion(-)
02d4da5f64989b41358cdfd94d95b94fb4e20198

 .../main/scala/kafka/server/ReplicaManager.scala   |   8 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 109 ++++++++++++++++++---
 2 files changed, 100 insertions(+), 17 deletions(-)
764d8ca9eb0aba6099ba289a10f437e72b53ffec

 .../org/apache/kafka/clients/NetworkClient.java    |  12 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |   7 +-
 .../main/java/org/apache/kafka/common/Node.java    |  13 +-
 .../kafka/common/requests/MetadataRequest.java     |  20 +-
 .../kafka/common/requests/MetadataResponse.java    | 272 +++++++++++++--------
 .../clients/consumer/internals/FetcherTest.java    |  43 ++--
 .../producer/internals/DefaultPartitionerTest.java |  14 +-
 .../kafka/common/requests/RequestResponseTest.java |  22 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  |   5 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  38 +--
 core/src/main/scala/kafka/api/TopicMetadata.scala  |   1 -
 .../scala/kafka/api/TopicMetadataRequest.scala     |  16 --
 core/src/main/scala/kafka/cluster/Broker.scala     |  16 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   | 165 +++++++------
 .../main/scala/kafka/server/MetadataCache.scala    | 209 +++++++++-------
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   2 +-
 .../api/RequestResponseSerializationTest.scala     |  13 +-
 .../kafka/integration/BaseTopicMetadataTest.scala  |  20 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |   2 +-
 .../unit/kafka/server/MetadataCacheTest.scala      | 199 +++++++++++++++
 22 files changed, 699 insertions(+), 393 deletions(-)
287cce251f7d5471946d550031147aaab4e7ca26

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9c4c5ae1cd15aa0afe3156e572362fbb40130573

 .../processor/internals/InternalTopicManager.java  | 13 +++--
 .../internals/StreamPartitionAssignor.java         |  6 +-
 .../internals/StreamPartitionAssignorTest.java     | 66 ++++++++++++++++++++++
 3 files changed, 80 insertions(+), 5 deletions(-)
04ef9c35479f5cf92df3b74a7379ce77dc809243

 vagrant/aws/aws-example-Vagrantfile.local | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e403b3c4bf8ca308fe180b093da20700f4db73c5

 .../consumer/internals/AbstractCoordinator.java    | 120 ++++++++++-----------
 .../consumer/internals/ConsumerCoordinator.java    |  81 +++++++-------
 .../kafka/clients/consumer/internals/Fetcher.java  |   6 +-
 .../main/java/org/apache/kafka/common/Node.java    |   2 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  10 ++
 5 files changed, 115 insertions(+), 104 deletions(-)
6eb061fa85de1b5346eb2652622c9c60f7f3baf1

 tests/kafkatest/services/kafka/kafka.py              | 2 +-
 tests/kafkatest/tests/consumer_group_command_test.py | 3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)
38d4d597bafad5d5c9218cf246cbbbec5824299d

 docs/protocol.html | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)
1a451b4812ae2502bb6bc105e77eb00175a76ec5

 docs/protocol.html | 21 ++++++++++++++++++++-
 1 file changed, 20 insertions(+), 1 deletion(-)
83f714bae11f9bca0f1cedb8a68e73a1dd637ade

 config/test-log4j.properties | 66 --------------------------------------------
 1 file changed, 66 deletions(-)
fcb86d58f302172b652b674052b3800bdf86d476

 .gitignore                                         |   6 +-
 build.gradle                                       |  47 ++++--
 .../org/apache/kafka/common/protocol/ApiKeys.java  |  26 ++++
 .../org/apache/kafka/common/protocol/Errors.java   |  35 ++++-
 .../org/apache/kafka/common/protocol/Protocol.java | 166 +++++++++++++++++++++
 .../apache/kafka/common/protocol/types/Field.java  |   4 +
 docs/configuration.html                            |   8 +-
 docs/protocol.html                                 | 163 ++++++++++++++++++++
 8 files changed, 437 insertions(+), 18 deletions(-)
df41bc544aea91fd1e2d5258ebf1b99347700731

 build.gradle | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
f0a4125d3edf4ff28399584e7800addc026f5d08

 .gitignore                                         |   5 +-
 build.gradle                                       |  45 +++++-
 .../org/apache/kafka/common/protocol/ApiKeys.java  |  26 ++++
 .../org/apache/kafka/common/protocol/Errors.java   |  34 +++++
 .../org/apache/kafka/common/protocol/Protocol.java | 166 +++++++++++++++++++++
 .../apache/kafka/common/protocol/types/Field.java  |   4 +
 docs/configuration.html                            |   8 +-
 docs/protocol.html                                 | 163 ++++++++++++++++++++
 8 files changed, 435 insertions(+), 16 deletions(-)
ee9995583ad74277464d3e9cb669a7c96c07f70b

 README.md                  | 4 ++--
 gradle/dependencies.gradle | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)
818080312364940e4a6e964c22ec54e133b8ec02

 .../main/java/org/apache/kafka/common/Cluster.java |  4 +--
 .../java/org/apache/kafka/common/ClusterTest.java  | 42 ++++++++++++++++++++++
 .../main/scala/kafka/network/SocketServer.scala    |  4 +--
 3 files changed, 46 insertions(+), 4 deletions(-)
59d19cf3e9dce777e5c7bb333c0836adf9da80e1

 gradlew.bat | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
324b0c85f603005dceee69033b8fbffc7ef95281

 .../apache/kafka/common/security/JaasUtils.java    | 31 ++++++++--------------
 .../kafka/common/security/kerberos/Login.java      |  5 ++--
 .../kafka/security/auth/ZkAuthorizationTest.scala  |  5 +++-
 3 files changed, 18 insertions(+), 23 deletions(-)
689309135b3d75c2c6e7b215aca2e8d42b435877

 .../kafka/clients/producer/ProducerConfig.java     | 62 +++++++++++++---------
 1 file changed, 37 insertions(+), 25 deletions(-)
090d7220e2c0c4c8a39c388043c6032386ea024f

 .../main/java/org/apache/kafka/common/config/ConfigDef.java |  4 ++--
 .../java/org/apache/kafka/common/config/ConfigDefTest.java  | 13 +++++++++++++
 2 files changed, 15 insertions(+), 2 deletions(-)
39f1c3ff83879e3d00ea4567db15181c746deba2

 tests/kafkatest/tests/streams_bounce_test.py | 4 +++-
 tests/kafkatest/tests/streams_smoke_test.py  | 4 +++-
 2 files changed, 6 insertions(+), 2 deletions(-)
c4282371d954d7ae6decd32252d85f0d2a254e8c

 .../kafka/coordinator/GroupMetadataManager.scala   | 24 +++++++++++++---------
 1 file changed, 14 insertions(+), 10 deletions(-)
5afa1660103df8aecbf7558e761418944fb5905a

 .../kafka/clients/producer/KafkaProducer.java      |  1 +
 .../producer/internals/RecordAccumulator.java      | 84 ++++++++++++++--------
 .../kafka/clients/producer/internals/Sender.java   | 17 ++++-
 .../producer/internals/RecordAccumulatorTest.java  | 37 ++++++++--
 .../clients/producer/internals/SenderTest.java     | 51 +++++++++++++
 .../test/java/org/apache/kafka/test/TestUtils.java |  2 +-
 6 files changed, 156 insertions(+), 36 deletions(-)
f6e35dec9bf330c3531fd95c6566070d4ddf0457

 .../sanity_checks/test_verifiable_producer.py      |  8 ++-
 tests/kafkatest/services/console_consumer.py       |  6 +-
 tests/kafkatest/services/kafka/config_property.py  |  2 +
 tests/kafkatest/services/kafka/version.py          |  4 ++
 tests/kafkatest/tests/reassign_partitions_test.py  |  2 +-
 tests/kafkatest/tests/upgrade_test.py              | 70 +++++++++++++++-------
 vagrant/base.sh                                    |  1 +
 7 files changed, 65 insertions(+), 28 deletions(-)
8d0c298c8c3283a7f8cffc4f68b3af87b0588e07

 .../scala/kafka/coordinator/GroupCoordinator.scala |  18 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |  33 +--
 .../main/scala/kafka/network/RequestChannel.scala  |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 276 +++++++++++----------
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  14 +-
 .../coordinator/GroupCoordinatorResponseTest.scala |  12 +-
 6 files changed, 181 insertions(+), 176 deletions(-)
2fed0c62db0dac5a43c2bd29555f09010bfc74ec

 .../scala/kafka/admin/ConsumerGroupCommand.scala   |  5 ++--
 docs/ops.html                                      | 29 ++++++++++++++++++++++
 2 files changed, 31 insertions(+), 3 deletions(-)
33fcaad26ed2b48dcc3a41c1c71d95eeb3779168

 .../test/scala/unit/kafka/admin/AdminTest.scala    |  2 +-
 .../scala/unit/kafka/admin/ConfigCommandTest.scala |  2 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  4 +--
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |  2 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 34 +++++++++++-----------
 5 files changed, 22 insertions(+), 22 deletions(-)
94c234341907b705ec34dd2b390899435286e242

 .../org/apache/kafka/common/protocol/ApiKeys.java  | 19 +++++++-----
 .../kafka/common/requests/AbstractRequest.java     |  6 ++--
 .../apache/kafka/common/protocol/ApiKeysTest.java  | 34 ++++++++++++++++++++++
 .../main/scala/kafka/network/RequestChannel.scala  | 11 ++++---
 .../main/scala/kafka/network/SocketServer.scala    |  2 +-
 5 files changed, 57 insertions(+), 15 deletions(-)
5761a9ec7285cae9167fcb10f0e800e2a048511a

 .../java/org/apache/kafka/streams/processor/TopologyBuilder.java  | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)
25bde48e6a43b0a2c1c9430eb560b43e160ae3ea

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
33f33075468f53bf6d4d1bd79fdb64443ca30dfa

 .../kafka/clients/consumer/internals/Fetcher.java  | 29 ++++++++++++++++++++--
 1 file changed, 27 insertions(+), 2 deletions(-)
b7d6fae59ed782833981675efa0304ce2b12a59e

 .../runtime/distributed/DistributedHerder.java     | 32 +++++++++++++---------
 .../runtime/distributed/WorkerGroupMember.java     |  4 +++
 .../runtime/distributed/DistributedHerderTest.java |  2 ++
 3 files changed, 25 insertions(+), 13 deletions(-)
6d65edebae5a834fe58d4a29b74267eb34bec065

 build.gradle | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
f7887bd6f9db578a5a3ee04606bb4f3a74528eb8

 bin/kafka-server-stop.sh     | 10 +++++++++-
 bin/zookeeper-server-stop.sh | 10 +++++++++-
 2 files changed, 18 insertions(+), 2 deletions(-)
d63bdc28cad57bb1cb38598c4ec5c0ef27113a8c

 core/src/main/scala/kafka/admin/AclCommand.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
5d893654489647e8be65c4d54864ab63b7285faa

 .../scala/kafka/server/ClientQuotaManager.scala    | 11 +++--
 .../unit/kafka/server/ClientQuotaManagerTest.scala | 52 +++++++++++++++++++---
 2 files changed, 54 insertions(+), 9 deletions(-)
f25fe02d994a663b6a5a0d01ea290785d63e1e52

 README.md                  |  3 +++
 build.gradle               | 20 ++++++++++++++++++++
 gradle/dependencies.gradle |  6 +++---
 3 files changed, 26 insertions(+), 3 deletions(-)
7079f57f70dfb5e731baf0a19bbf16e7364c15bb

 .../main/java/org/apache/kafka/connect/runtime/WorkerTask.java |  6 +++---
 .../org/apache/kafka/connect/runtime/WorkerSourceTaskTest.java | 10 +++++-----
 2 files changed, 8 insertions(+), 8 deletions(-)
c8b6c18f68b9efbbd5e349885d301c47baabcd98

 build.gradle | 2 ++
 1 file changed, 2 insertions(+)
ae1fd085873c5119609df5120c02763c5ae48142

 docs/quickstart.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
291f430d9c13227cc30a11939cc550057c583b20

 docs/api.html            | 4 ++--
 docs/connect.html        | 6 +++---
 docs/implementation.html | 2 +-
 3 files changed, 6 insertions(+), 6 deletions(-)
0d49a542691ff5983e72e4c42ec1d356c6ce9268

 LICENSE | 128 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 NOTICE  |   5 ++-
 2 files changed, 132 insertions(+), 1 deletion(-)
1d19ac9fea5b3344a0cdd00ee8c58ab8a22a5579

 .../internals/StreamPartitionAssignor.java         | 35 +++++++++++-----------
 1 file changed, 17 insertions(+), 18 deletions(-)
079c88178dff4b3a4c9de55629e7d15b60e5f562

 .../kafka/connect/cli/ConnectDistributed.java      |  4 +--
 .../org/apache/kafka/connect/runtime/Worker.java   |  2 +-
 .../runtime/distributed/DistributedConfig.java     | 32 ++++++++++++++++++++-
 .../runtime/distributed/DistributedHerder.java     |  2 +-
 .../runtime/standalone/StandaloneConfig.java       | 12 +++++++-
 .../connect/storage/FileOffsetBackingStore.java    | 10 +++----
 .../kafka/connect/storage/KafkaConfigStorage.java  | 16 +++++------
 .../connect/storage/KafkaOffsetBackingStore.java   | 18 ++++++------
 .../connect/storage/KafkaStatusBackingStore.java   | 18 ++++++------
 .../connect/storage/MemoryOffsetBackingStore.java  |  3 +-
 .../connect/storage/MemoryStatusBackingStore.java  |  3 +-
 .../kafka/connect/storage/OffsetBackingStore.java  | 10 +++++--
 .../kafka/connect/storage/StatusBackingStore.java  | 10 +++++--
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |  1 +
 .../runtime/WorkerSinkTaskThreadedTest.java        |  1 +
 .../connect/runtime/WorkerSourceTaskTest.java      |  1 +
 .../apache/kafka/connect/runtime/WorkerTest.java   |  3 +-
 .../runtime/distributed/DistributedHerderTest.java |  8 ++++--
 .../storage/FileOffsetBackingStoreTest.java        | 19 +++++++++----
 .../connect/storage/KafkaConfigStorageTest.java    | 22 +++++++++++----
 .../storage/KafkaOffsetBackingStoreTest.java       | 33 +++++++++++-----------
 21 files changed, 153 insertions(+), 75 deletions(-)
10394aa80153db27e7672a949c91b436724b0ead

 .../internals/StreamPartitionAssignor.java         | 30 ++++++++++++----------
 1 file changed, 16 insertions(+), 14 deletions(-)
b9eda22d71aa9896cac90798c7e888a04f14549d

 .../src/main/java/org/apache/kafka/streams/kstream/Windowed.java   | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
00a58f8e1e0c82c2948a8fdfacf812ec4865b339

 .../kafka/connect/storage/KafkaConfigStorage.java    | 20 ++++++++++++++++----
 1 file changed, 16 insertions(+), 4 deletions(-)
9cd65c46a71cb07276f23838aa55747efc32674c

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 12 ++++--------
 1 file changed, 4 insertions(+), 8 deletions(-)
fe1fd703e85a2acfd7209b38d15c428fcd77dc67

 .../main/java/org/apache/kafka/common/record/ByteBufferInputStream.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
cfc324333fa13e06ec7ac5ef3a09d8a6b6b54485

 .../org/apache/kafka/connect/runtime/WorkerTask.java  |  3 +++
 .../kafka/connect/runtime/WorkerSourceTaskTest.java   | 19 ++++++++++---------
 2 files changed, 13 insertions(+), 9 deletions(-)
f676cfeb83195f032e3ad8908288a7e04011c830

 .../main/java/org/apache/kafka/streams/KafkaStreams.java | 16 ++++++++--------
 .../java/org/apache/kafka/streams/StreamsConfig.java     |  4 ++++
 .../java/org/apache/kafka/streams/StreamsMetrics.java    |  2 +-
 .../java/org/apache/kafka/streams/kstream/KStream.java   |  8 +++-----
 .../java/org/apache/kafka/streams/kstream/KTable.java    |  8 +++-----
 .../org/apache/kafka/streams/kstream/Transformer.java    |  7 +++++++
 .../kafka/streams/kstream/TransformerSupplier.java       |  3 +++
 .../apache/kafka/streams/kstream/UnlimitedWindows.java   |  3 +++
 .../apache/kafka/streams/kstream/ValueTransformer.java   |  6 ++++++
 .../kafka/streams/kstream/ValueTransformerSupplier.java  |  3 +++
 .../java/org/apache/kafka/streams/kstream/Windowed.java  |  9 +++++++++
 .../kafka/streams/processor/DefaultPartitionGrouper.java |  2 +-
 .../apache/kafka/streams/processor/PartitionGrouper.java |  7 +++++++
 .../kafka/streams/processor/ProcessorSupplier.java       | 10 ++++++++++
 .../kafka/streams/processor/TimestampExtractor.java      |  3 ++-
 .../org/apache/kafka/streams/state/KeyValueIterator.java |  2 +-
 .../org/apache/kafka/streams/state/KeyValueStore.java    | 14 +++++++-------
 .../main/java/org/apache/kafka/streams/state/Serdes.java |  6 ++++++
 .../main/java/org/apache/kafka/streams/state/Stores.java |  2 +-
 .../apache/kafka/streams/state/WindowStoreIterator.java  |  5 +++++
 .../org/apache/kafka/streams/state/WindowStoreUtils.java |  2 +-
 21 files changed, 91 insertions(+), 31 deletions(-)
2a58ba9fd893979f89aec251579b10f5cda41d10

 .../main/java/org/apache/kafka/common/Cluster.java |  36 +++++++
 .../kafka/streams/processor/TopologyBuilder.java   |  29 ++++--
 .../internals/StreamPartitionAssignor.java         | 113 ++++++++++++++++++++-
 .../streams/processor/internals/StreamThread.java  |  30 ------
 .../streams/processor/TopologyBuilderTest.java     |  12 +--
 5 files changed, 169 insertions(+), 51 deletions(-)
002b377dad9c956cd0ae0597981f29698883b6d5

 .../clients/consumer/ConsumerInterceptor.java      |  5 ++-
 .../kafka/clients/consumer/ConsumerRecord.java     | 37 ++++++++++++++++++++-
 .../kafka/clients/consumer/internals/Fetcher.java  | 14 +++++---
 .../kafka/clients/producer/MockProducer.java       |  6 ++--
 .../kafka/clients/producer/RecordMetadata.java     | 38 ++++++++++++++++++++--
 .../producer/internals/FutureRecordMetadata.java   | 24 ++++++++++++--
 .../clients/producer/internals/RecordBatch.java    | 12 +++++--
 .../org/apache/kafka/common/record/Compressor.java | 16 ++++++---
 .../apache/kafka/common/record/MemoryRecords.java  |  6 ++--
 .../kafka/clients/consumer/MockConsumerTest.java   |  4 +--
 .../internals/ConsumerInterceptorsTest.java        |  8 +++--
 .../kafka/clients/producer/RecordSendTest.java     |  9 +++--
 .../internals/ProducerInterceptorsTest.java        |  2 +-
 .../apache/kafka/test/MockConsumerInterceptor.java |  6 ++--
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |  2 +-
 .../runtime/WorkerSinkTaskThreadedTest.java        |  4 +--
 .../connect/runtime/WorkerSourceTaskTest.java      |  3 +-
 .../connect/storage/KafkaConfigStorageTest.java    | 24 +++++++-------
 .../storage/KafkaOffsetBackingStoreTest.java       | 16 ++++-----
 .../storage/KafkaStatusBackingStoreTest.java       |  2 +-
 .../kafka/connect/util/KafkaBasedLogTest.java      | 16 ++++-----
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  4 +--
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  4 ++-
 .../integration/kafka/api/BaseConsumerTest.scala   |  3 ++
 .../kafka/api/BaseProducerSendTest.scala           |  7 ++++
 .../streams/processor/internals/RecordQueue.java   |  7 ++--
 .../processor/internals/PartitionGroupTest.java    | 12 +++----
 .../internals/ProcessorStateManagerTest.java       |  6 ++--
 .../processor/internals/RecordQueueTest.java       | 18 +++++-----
 .../processor/internals/StandbyTaskTest.java       | 18 +++++-----
 .../processor/internals/StreamTaskTest.java        | 30 ++++++++---------
 .../kafka/test/ProcessorTopologyTestDriver.java    |  2 +-
 32 files changed, 251 insertions(+), 114 deletions(-)
23f239b06195c461a118962d45b6b02c3d89885c

 tests/bootstrap-test-env.sh | 1 +
 1 file changed, 1 insertion(+)
edeb11bc561c0721855b34a4506dc7f1c76445c6

 bin/kafka-run-class.sh                             |   5 +
 build.gradle                                       |   3 +-
 checkstyle/import-control.xml                      |   5 +
 .../examples/pageview/JsonPOJODeserializer.java    |  61 -------
 .../examples/pageview/JsonPOJOSerializer.java      |  60 -------
 .../examples/pageview/JsonTimestampExtractor.java  |  46 -----
 .../examples/pageview/PageViewTypedJob.java        | 186 ---------------------
 .../examples/pageview/PageViewUnTypedJob.java      | 142 ----------------
 .../kafka/streams/examples/pipe/PipeJob.java       |  66 --------
 .../streams/examples/wordcount/WordCountJob.java   |  99 -----------
 .../examples/wordcount/WordCountProcessorJob.java  | 138 ---------------
 .../examples/pageview/JsonPOJODeserializer.java    |  61 +++++++
 .../examples/pageview/JsonPOJOSerializer.java      |  60 +++++++
 .../examples/pageview/JsonTimestampExtractor.java  |  46 +++++
 .../examples/pageview/PageViewTypedJob.java        | 185 ++++++++++++++++++++
 .../examples/pageview/PageViewUntypedJob.java      | 141 ++++++++++++++++
 .../kafka/streams/examples/pipe/PipeJob.java       |  65 +++++++
 .../streams/examples/wordcount/WordCountJob.java   |  98 +++++++++++
 .../examples/wordcount/WordCountProcessorJob.java  | 137 +++++++++++++++
 19 files changed, 805 insertions(+), 799 deletions(-)
79662cc7cb139c33888148139f44fb4b1ac0fe56

 .../java/org/apache/kafka/streams/kstream/internals/KStreamImpl.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
695fdc69db6e080419bb05d624e91fa88d5c0a02

 .../main/scala/kafka/common/MessageFormatter.scala | 39 ++++++++++++++
 .../main/scala/kafka/common/MessageReader.scala    | 39 ++++++++++++++
 .../kafka/coordinator/GroupMetadataManager.scala   | 60 ++++++++++++----------
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 45 ++++++++--------
 .../main/scala/kafka/tools/ConsoleProducer.scala   | 40 ++++++---------
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 31 ++++++-----
 .../unit/kafka/tools/ConsoleConsumerTest.scala     |  3 +-
 docs/upgrade.html                                  | 11 ++--
 8 files changed, 176 insertions(+), 92 deletions(-)
74eff8a830ff6508ab98761a9e77d19d4e49a73e

 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 39 ++++++++++------------
 1 file changed, 17 insertions(+), 22 deletions(-)
5da935ef78ecf4a671bddc632cfd36ef65bd6f6d

 .../apache/kafka/clients/consumer/ConsumerConfig.java |  2 +-
 .../streams/examples/pageview/PageViewTypedJob.java   |  2 +-
 .../streams/examples/pageview/PageViewUnTypedJob.java |  2 +-
 .../apache/kafka/streams/examples/pipe/PipeJob.java   |  2 +-
 .../streams/examples/wordcount/WordCountJob.java      |  2 +-
 .../examples/wordcount/WordCountProcessorJob.java     |  2 +-
 .../java/org/apache/kafka/streams/StreamsConfig.java  | 19 ++++++++++---------
 .../streams/processor/internals/StreamThread.java     |  7 -------
 8 files changed, 16 insertions(+), 22 deletions(-)
845c6eae1f6c6bcf117f5baa53bb19b4611c0528

 .../kafka/clients/producer/internals/Sender.java   |   1 +
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  23 +-
 .../examples/pageview/JsonPOJODeserializer.java    |   5 -
 .../examples/pageview/JsonTimestampExtractor.java  |  46 ++++
 .../examples/pageview/PageViewTypedJob.java        |  88 +++++-
 .../examples/pageview/PageViewUnTypedJob.java      |  87 ++++--
 .../kafka/streams/examples/pipe/PipeJob.java       |  18 +-
 .../streams/examples/wordcount/WordCountJob.java   |  48 ++--
 .../examples/wordcount/WordCountProcessorJob.java  |  23 +-
 .../org/apache/kafka/streams/kstream/KStream.java  |  39 +++
 .../internals/KStreamAggProcessorSupplier.java     |  28 ++
 .../kstream/internals/KStreamAggWindow.java        |  51 ----
 .../kstream/internals/KStreamAggregate.java        | 119 +++------
 .../streams/kstream/internals/KStreamImpl.java     | 100 +++++--
 .../streams/kstream/internals/KStreamReduce.java   | 124 +++------
 .../kstream/internals/KStreamWindowAggregate.java  | 171 ++++++++++++
 .../kstream/internals/KStreamWindowReduce.java     | 165 ++++++++++++
 .../streams/kstream/internals/KTableImpl.java      |  10 +-
 .../kstream/internals/KTableProcessorSupplier.java |   1 -
 .../kafka/streams/processor/TopologyBuilder.java   |  26 ++
 .../streams/processor/internals/RecordQueue.java   |   8 +
 .../internals/StreamPartitionAssignor.java         |   2 +-
 .../streams/processor/internals/StreamThread.java  |   1 -
 .../kstream/internals/KStreamAggregateTest.java    | 294 ---------------------
 .../internals/KStreamWindowAggregateTest.java      | 294 +++++++++++++++++++++
 .../kstream/internals/KTableAggregateTest.java     |   1 +
 .../processor/internals/PartitionGroupTest.java    |   4 +-
 .../processor/internals/RecordQueueTest.java       |   4 +-
 .../processor/internals/StreamTaskTest.java        |  19 +-
 29 files changed, 1168 insertions(+), 632 deletions(-)
a7312971a06e3576720ac6d38978eb0a2a25f544

 build.gradle | 1 +
 1 file changed, 1 insertion(+)
d501cc62ddcbbddcb114a40527d3e4f71f501286

 .../apache/kafka/streams/state/KeyValueStore.java  | 11 +++++++
 .../internals/InMemoryKeyValueLoggedStore.java     | 10 ++++++
 .../internals/InMemoryKeyValueStoreSupplier.java   |  9 ++++++
 .../streams/state/internals/MemoryLRUCache.java    |  9 ++++++
 .../state/internals/MeteredKeyValueStore.java      | 12 +++++++
 .../streams/state/internals/RocksDBStore.java      |  9 ++++++
 .../state/internals/AbstractKeyValueStoreTest.java | 37 ++++++++++++++++++++++
 7 files changed, 97 insertions(+)
92c35230f463e570de17239d8e76c7be5350c7d8

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)
d4e60b9f59e04e82125b404f173c4fccc949d906

 .../kafka/streams/processor/internals/StreamThread.java   | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)
4e0ae79d5c9aec04c014aca55cd4823f89b933c8

 tests/kafkatest/services/console_consumer.py       | 10 ---
 tests/kafkatest/services/verifiable_producer.py    | 56 +++++++++++---
 tests/kafkatest/tests/compatibility_test.py        |  3 +-
 tests/kafkatest/tests/compression_test.py          | 85 ++++++++++++++++++++++
 tests/kafkatest/tests/mirror_maker_test.py         |  3 +-
 tests/kafkatest/tests/reassign_partitions_test.py  |  3 +-
 tests/kafkatest/tests/replication_test.py          |  3 +-
 .../tests/security_rolling_upgrade_test.py         |  3 +-
 tests/kafkatest/tests/upgrade_test.py              |  3 +-
 .../tests/zookeeper_security_upgrade_test.py       |  5 +-
 tests/kafkatest/utils/__init__.py                  |  2 +-
 tests/kafkatest/utils/util.py                      | 31 ++++++++
 .../org/apache/kafka/tools/VerifiableProducer.java | 29 +++++++-
 13 files changed, 204 insertions(+), 32 deletions(-)
4542b027c1ac361cc8770383b66abac2129a05e7

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 21 ++++++++++++++++-----
 docs/ops.html                                     |  2 +-
 2 files changed, 17 insertions(+), 6 deletions(-)
d51dd5fc7475ad29bea8616f77e1183a8fa9e000

 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)
62945280a7fcfd69840a115fec16698bd8254323

 core/src/main/scala/kafka/message/ByteBufferMessageSet.scala | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)
af1699bccbb725633f0b9deb666054a573da7667

 core/src/main/scala/kafka/server/ClientQuotaManager.scala | 3 +++
 1 file changed, 3 insertions(+)
b3b533171caebdfaf9e7c0adc9e62ef0f7ab0ed3

 .../src/main/java/org/apache/kafka/connect/runtime/Worker.java | 10 ++++++----
 .../apache/kafka/connect/storage/KafkaStatusBackingStore.java  |  2 +-
 2 files changed, 7 insertions(+), 5 deletions(-)
5db2c99e15a4467489b495144815ac8334c2c5d4

 .../apache/kafka/clients/consumer/Consumer.java    |  5 +++
 .../kafka/clients/consumer/KafkaConsumer.java      | 15 +++++++++
 .../consumer/internals/SubscriptionState.java      | 12 +++++++
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 39 +++++++++++++++++-----
 4 files changed, 62 insertions(+), 9 deletions(-)
13b8fb295c3becc27e7954af623fe90b3062409e

 .../org/apache/kafka/streams/StreamsConfig.java    |   2 -
 .../processor/internals/InternalTopicManager.java  |   8 +-
 .../processor/internals/ProcessorStateManager.java |  13 ++-
 .../internals/StreamPartitionAssignor.java         |   9 +-
 .../streams/processor/internals/StreamThread.java  |   4 +-
 .../kafka/streams/smoketest/SmokeTestClient.java   |  17 ++++
 .../kafka/streams/smoketest/SmokeTestDriver.java   | 111 ++++++++++++++++++---
 .../kafka/streams/smoketest/SmokeTestUtil.java     |  41 ++++++++
 .../kafka/streams/smoketest/StreamsSmokeTest.java  |   3 -
 tests/kafkatest/tests/streams_bounce_test.py       |   5 +-
 tests/kafkatest/tests/streams_smoke_test.py        |   3 +-
 11 files changed, 182 insertions(+), 34 deletions(-)
fa05752ccd9ee4996f252aa5ed71f10f28e80a52

 .../processor/internals/ProcessorStateManager.java | 23 +++++++++++++++++++++-
 1 file changed, 22 insertions(+), 1 deletion(-)
01aeea7c7bca34f1edce40116b7721335938b13b

 .../org/apache/kafka/common/record/Record.java     |   2 +-
 .../apache/kafka/common/record/TimestampType.java  |  32 ++-
 .../java/org/apache/kafka/common/utils/Utils.java  |   2 +-
 core/src/main/scala/kafka/api/ApiVersion.scala     |  14 +-
 core/src/main/scala/kafka/common/LongRef.scala     |  61 ++++++
 .../controller/ControllerChannelManager.scala      |   2 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |   8 +-
 .../javaapi/message/ByteBufferMessageSet.scala     |   5 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |  25 +--
 core/src/main/scala/kafka/log/Log.scala            |  65 +++---
 core/src/main/scala/kafka/log/LogCleaner.scala     |  62 +++---
 core/src/main/scala/kafka/log/LogConfig.scala      |  20 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  10 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala | 239 ++++++++++-----------
 core/src/main/scala/kafka/message/Message.scala    |  53 +++--
 core/src/main/scala/kafka/message/MessageSet.scala |  20 +-
 .../main/scala/kafka/message/MessageWriter.scala   |   2 +-
 .../main/scala/kafka/server/ConfigHandler.scala    |  35 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  71 +++---
 core/src/main/scala/kafka/server/KafkaConfig.scala |  34 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |  12 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  29 ++-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |   2 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  18 +-
 .../kafka/api/PlaintextConsumerTest.scala          |   2 +-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |   8 +-
 .../coordinator/GroupCoordinatorResponseTest.scala |   2 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  13 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |   4 +-
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  22 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   1 -
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |   9 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  34 +--
 .../kafka/message/ByteBufferMessageSetTest.scala   | 136 ++++++------
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   2 +-
 docs/upgrade.html                                  |  44 ++--
 37 files changed, 575 insertions(+), 529 deletions(-)
1bfaddae9c7d8b40801a28c4806f61e647107c93

 .../main/java/org/apache/kafka/connect/runtime/WorkerSourceTask.java | 5 ++++-
 .../java/org/apache/kafka/connect/storage/OffsetStorageWriter.java   | 1 +
 2 files changed, 5 insertions(+), 1 deletion(-)
f98cb3aa248b72ddacb2ce2ca6af5248365de366

 gradle.properties | 2 ++
 1 file changed, 2 insertions(+)
b084c485e25bfe77154e805219b24714d59c396c

 gradle.properties           | 2 +-
 kafka-merge-pr.py           | 2 +-
 tests/kafkatest/__init__.py | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
f7d019ed408fa988129be9af3689bfa4878bc627

 config/connect-distributed.properties              |   3 +-
 .../kafka/connect/connector/ConnectorContext.java  |   7 +
 .../kafka/connect/file/FileStreamSinkTask.java     |   2 +-
 .../kafka/connect/cli/ConnectDistributed.java      |  28 +-
 .../kafka/connect/cli/ConnectStandalone.java       |  13 +-
 .../kafka/connect/runtime/AbstractHerder.java      | 156 +++++++
 .../kafka/connect/runtime/AbstractStatus.java      | 100 +++++
 .../kafka/connect/runtime/ConnectorStatus.java     |  58 +++
 .../org/apache/kafka/connect/runtime/Herder.java   |  16 +-
 .../connect/runtime/HerderConnectorContext.java    |  11 +-
 .../apache/kafka/connect/runtime/TaskStatus.java   |  53 +++
 .../org/apache/kafka/connect/runtime/Worker.java   | 210 ++++++----
 .../kafka/connect/runtime/WorkerSinkTask.java      |   4 +-
 .../kafka/connect/runtime/WorkerSourceTask.java    |  18 +-
 .../apache/kafka/connect/runtime/WorkerTask.java   |  47 ++-
 .../runtime/distributed/DistributedHerder.java     | 107 +++--
 .../runtime/distributed/WorkerCoordinator.java     |   2 +-
 .../runtime/distributed/WorkerGroupMember.java     |   9 +-
 .../distributed/WorkerRebalanceListener.java       |   2 +-
 .../kafka/connect/runtime/rest/RestServer.java     |   9 +-
 .../runtime/rest/entities/ConnectorStateInfo.java  | 108 +++++
 .../runtime/rest/resources/ConnectorsResource.java |  21 +-
 .../runtime/standalone/StandaloneHerder.java       |  51 ++-
 .../kafka/connect/storage/KafkaConfigStorage.java  |  15 +-
 .../connect/storage/KafkaOffsetBackingStore.java   |  13 +-
 .../connect/storage/KafkaStatusBackingStore.java   | 461 +++++++++++++++++++++
 .../connect/storage/MemoryStatusBackingStore.java  | 105 +++++
 .../kafka/connect/storage/StatusBackingStore.java  | 100 +++++
 .../apache/kafka/connect/util/KafkaBasedLog.java   |  24 +-
 .../java/org/apache/kafka/connect/util/Table.java  |  65 +++
 .../kafka/connect/runtime/AbstractHerderTest.java  | 116 ++++++
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |   4 +-
 .../runtime/WorkerSinkTaskThreadedTest.java        |   6 +-
 .../connect/runtime/WorkerSourceTaskTest.java      |  54 ++-
 .../kafka/connect/runtime/WorkerTaskTest.java      |  88 +++-
 .../apache/kafka/connect/runtime/WorkerTest.java   | 161 +++----
 .../runtime/distributed/DistributedHerderTest.java | 121 +++++-
 .../runtime/distributed/WorkerCoordinatorTest.java |   2 +-
 .../runtime/standalone/StandaloneHerderTest.java   |  42 +-
 .../storage/KafkaStatusBackingStoreTest.java       | 373 +++++++++++++++++
 .../storage/MemoryStatusBackingStoreTest.java      |  66 +++
 .../org/apache/kafka/connect/util/TableTest.java   |  48 +++
 tests/kafkatest/services/connect.py                |   4 +-
 tests/kafkatest/tests/connect_distributed_test.py  |   1 +
 tests/kafkatest/tests/connect_rest_test.py         |   4 +-
 .../tests/templates/connect-distributed.properties |   1 +
 46 files changed, 2611 insertions(+), 298 deletions(-)
aeb9c2adcfe5fb99490fb15163ebcfd1d75d34c1

 bin/kafka-run-class.sh          | 22 ++++++++++++++++++++++
 bin/windows/kafka-run-class.bat | 23 +++++++++++++++++++++++
 2 files changed, 45 insertions(+)
73ecd7a1797a023039fea365a08dbdba4171d10b

 .../kafka/clients/consumer/ConsumerConfig.java     |  10 ++
 .../kafka/clients/consumer/KafkaConsumer.java      |   5 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 129 +++++++++++++++------
 .../clients/consumer/internals/FetcherTest.java    |  90 +++++++++++---
 .../integration/kafka/api/BaseConsumerTest.scala   |  13 ++-
 .../kafka/api/PlaintextConsumerTest.scala          |  15 +++
 6 files changed, 205 insertions(+), 57 deletions(-)
c00a036e068ea5b33363992abc0499affa7ca2d7

 .../org/apache/kafka/streams/KeyValueTest.java     | 50 ++++++++++++++++++++++
 1 file changed, 50 insertions(+)
0ce9163989cb9898df7e74245cbc2ee37d729670

 .../java/org/apache/kafka/streams/KeyValue.java    | 22 +++++++++++++++
 .../org/apache/kafka/streams/kstream/KTable.java   | 18 ++++++------
 .../streams/kstream/internals/KTableImpl.java      | 33 +++++++++++++---------
 .../org/apache/kafka/streams/processor/TaskId.java |  3 ++
 .../apache/kafka/streams/StreamsConfigTest.java    |  2 --
 5 files changed, 54 insertions(+), 24 deletions(-)
14b688e00ddb54a5c8451411d269721484be875f

 .../serialization/ByteBufferDeserializer.java      | 34 ++++++++++++++++
 .../common/serialization/ByteBufferSerializer.java | 46 ++++++++++++++++++++++
 .../common/serialization/SerializationTest.java    | 23 +++++++++++
 3 files changed, 103 insertions(+)
f7fe9ccb466f85c417a545eb8acc4d61047c9f09

 streams/src/main/java/org/apache/kafka/streams/StreamsConfig.java | 1 -
 1 file changed, 1 deletion(-)
878b78acb68d0fa62eb3c8f21d572664ca2bcdd0

 .../org/apache/kafka/streams/StreamsConfig.java    |  10 +
 .../processor/internals/InternalTopicManager.java  | 228 +++++++++++++++++++++
 .../internals/StreamPartitionAssignor.java         | 178 +---------------
 3 files changed, 242 insertions(+), 174 deletions(-)
525f4c81db8f0dfd600b98f68cbb46e78bd76349

 .../scala/kafka/controller/PartitionStateMachine.scala | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
3358e1682f034a82afd670be95505b2f620c78c6

 bin/kafka-run-class.sh                             |   5 +
 bin/streams-smoke-test.sh                          |  23 +
 build.gradle                                       |   4 +
 .../kafka/streams/smoketest/SmokeTestClient.java   | 241 ++++++++++
 .../kafka/streams/smoketest/SmokeTestDriver.java   | 495 +++++++++++++++++++++
 .../kafka/streams/smoketest/SmokeTestUtil.java     | 184 ++++++++
 .../kafka/streams/smoketest/StreamsSmokeTest.java  |  75 ++++
 .../streams/smoketest/TestTimestampExtractor.java  |  37 ++
 tests/kafkatest/services/streams.py                | 135 ++++++
 tests/kafkatest/tests/streams_bounce_test.py       |  71 +++
 tests/kafkatest/tests/streams_smoke_test.py        |  73 +++
 11 files changed, 1343 insertions(+)
68af16ac15e5675daebb710ed8f15f780dc43abd

 .../org/apache/kafka/streams/processor/internals/StreamThread.java   | 5 +++++
 1 file changed, 5 insertions(+)
982ab09a790c6dbc2e1a5c52311103fd14ab5233

 .../kafka/streams/processor/internals/AbstractTask.java      | 11 +++++++++++
 .../kafka/streams/processor/internals/StandbyTask.java       | 12 ------------
 .../kafka/streams/processor/internals/StreamThreadTest.java  |  5 +++++
 3 files changed, 16 insertions(+), 12 deletions(-)
04585d99c6843a4253bae8ee958e360dd734d10e

 core/src/main/scala/kafka/utils/CommandLineUtils.scala |  2 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala        |  4 ----
 core/src/main/scala/kafka/utils/IteratorTemplate.scala |  2 --
 core/src/main/scala/kafka/utils/ReplicationUtils.scala |  1 -
 core/src/main/scala/kafka/utils/ZkUtils.scala          | 14 ++------------
 5 files changed, 3 insertions(+), 20 deletions(-)
d142f8294af67fea20d77dcc5272770af153c0d9

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)
ff7b0f5b467bdf553584fb253b00f460dfbe8943

 .../processor/internals/ProcessorStateManager.java | 70 +++++++++++-----------
 .../streams/processor/internals/StreamTask.java    |  4 +-
 .../streams/processor/internals/StreamThread.java  | 60 ++++++++++---------
 3 files changed, 71 insertions(+), 63 deletions(-)
46e4d40135d840a6d09e1f309e5c19ce7237b23a

 gradle/dependencies.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e3ab96b2f0b429e0fe5991a185cd980b0d490e25

 .../kafka/examples/KafkaConsumerProducerDemo.java  |  4 ++--
 .../main/java/kafka/examples/KafkaProperties.java  | 23 +++++++++++-----------
 .../src/main/java/kafka/examples/Producer.java     | 16 +++++++--------
 .../java/kafka/examples/SimpleConsumerDemo.java    |  2 +-
 4 files changed, 21 insertions(+), 24 deletions(-)
d2527af99a9bb1007f7fe63a0cd7d27a55182857

 .../kafka/clients/ClusterConnectionStates.java     |  9 -------
 .../apache/kafka/clients/NetworkClientTest.java    | 29 ++++++++++++++++++++++
 2 files changed, 29 insertions(+), 9 deletions(-)
49fd0ceb09daf1d981d5a631342a8e3478db68ab

 .../src/main/java/org/apache/kafka/common/utils/AppInfoParser.java   | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
6ebb2363ba775c518e08e3c21c15f721e5f10841

 vagrant/README.md | 4 ++++
 1 file changed, 4 insertions(+)
f91d993a543be2bdb8eb076df36ecd1ba1a2680f

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c991f9f745182f3ef0d16347c20618f28fad37f3

 docs/security.html | 1 +
 1 file changed, 1 insertion(+)
5caa800e217c6b83f62ee3e6b5f02f56e331b309

 docs/security.html | 1 +
 1 file changed, 1 insertion(+)
45c8195fa14c766b200c720f316836dbb84e9d8b

 checkstyle/import-control.xml                      |   1 +
 .../kafka/clients/consumer/ConsumerRecord.java     |  32 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |   5 +-
 .../kafka/clients/producer/KafkaProducer.java      |  11 +-
 .../kafka/clients/producer/MockProducer.java       |   5 +-
 .../kafka/clients/producer/ProducerRecord.java     |  61 ++-
 .../kafka/clients/producer/RecordMetadata.java     |  20 +-
 .../producer/internals/FutureRecordMetadata.java   |  10 +-
 .../producer/internals/RecordAccumulator.java      |  16 +-
 .../clients/producer/internals/RecordBatch.java    |  18 +-
 .../kafka/clients/producer/internals/Sender.java   |  15 +-
 .../common/errors/InvalidTimestampException.java   |  34 ++
 .../org/apache/kafka/common/protocol/Errors.java   |   5 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  52 ++-
 .../org/apache/kafka/common/record/Compressor.java |  22 +-
 .../apache/kafka/common/record/MemoryRecords.java  | 115 ++++--
 .../org/apache/kafka/common/record/Record.java     | 146 +++++--
 .../apache/kafka/common/record/TimestampType.java  |  62 +++
 .../kafka/common/requests/ProduceRequest.java      |   6 +-
 .../kafka/common/requests/ProduceResponse.java     |  40 +-
 .../java/org/apache/kafka/common/utils/Crc32.java  |  11 +
 .../kafka/clients/consumer/MockConsumerTest.java   |   5 +-
 .../internals/ConsumerInterceptorsTest.java        |   8 +-
 .../clients/consumer/internals/FetcherTest.java    |  17 +-
 .../kafka/clients/producer/ProducerRecordTest.java |   2 +-
 .../kafka/clients/producer/RecordSendTest.java     |   7 +-
 .../internals/ProducerInterceptorsTest.java        |   2 +-
 .../producer/internals/RecordAccumulatorTest.java  |  30 +-
 .../clients/producer/internals/SenderTest.java     |  11 +-
 .../kafka/common/record/MemoryRecordsTest.java     |   8 +-
 .../org/apache/kafka/common/record/RecordTest.java |  16 +-
 .../kafka/common/requests/RequestResponseTest.java |  14 +-
 .../apache/kafka/test/MockConsumerInterceptor.java |   4 +-
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |   3 +-
 .../runtime/WorkerSinkTaskThreadedTest.java        |   5 +-
 .../connect/runtime/WorkerSourceTaskTest.java      |   2 +-
 .../connect/storage/KafkaConfigStorageTest.java    |  25 +-
 .../storage/KafkaOffsetBackingStoreTest.java       |  17 +-
 .../kafka/connect/util/KafkaBasedLogTest.java      |  17 +-
 .../src/main/scala/kafka/admin/ConfigCommand.scala |  18 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |  27 +-
 core/src/main/scala/kafka/api/ApiVersion.scala     |  42 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   3 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   4 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |  14 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   1 +
 .../main/scala/kafka/consumer/BaseConsumer.scala   |  26 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |   9 +-
 .../controller/ControllerChannelManager.scala      |   4 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |  36 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |  44 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |  63 ++-
 core/src/main/scala/kafka/log/Log.scala            |  33 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  53 ++-
 core/src/main/scala/kafka/log/LogConfig.scala      |  39 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala | 447 ++++++++++++++++++---
 core/src/main/scala/kafka/message/Message.scala    | 259 +++++++++---
 .../scala/kafka/message/MessageAndMetadata.scala   |  11 +-
 core/src/main/scala/kafka/message/MessageSet.scala |  25 +-
 .../main/scala/kafka/message/MessageWriter.scala   |  27 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  23 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   2 +-
 .../main/scala/kafka/server/ConfigHandler.scala    |  14 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  46 ++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  25 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  11 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   7 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  21 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  33 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  16 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   4 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |   3 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  42 +-
 .../kafka/api/BaseProducerSendTest.scala           | 180 +++++++--
 .../kafka/api/PlaintextConsumerTest.scala          | 113 ++++--
 .../kafka/api/ProducerCompressionTest.scala        |   5 +-
 .../api/RequestResponseSerializationTest.scala     |   1 +
 .../coordinator/GroupCoordinatorResponseTest.scala |  13 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  13 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |  68 ++++
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   2 +-
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |   3 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   1 +
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  18 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   | 260 +++++++++++-
 .../kafka/message/MessageCompressionTest.scala     |  10 +-
 .../scala/unit/kafka/message/MessageTest.scala     |  79 +++-
 .../unit/kafka/message/MessageWriterTest.scala     |   9 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  15 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  31 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  77 ++--
 .../unit/kafka/server/EdgeCaseRequestTest.scala    |   2 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  16 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  19 +-
 .../unit/kafka/tools/ConsoleConsumerTest.scala     |   4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   7 +-
 docs/upgrade.html                                  |  52 +++
 .../streams/processor/internals/RecordQueue.java   |   4 +-
 .../processor/internals/PartitionGroupTest.java    |  13 +-
 .../internals/ProcessorStateManagerTest.java       |   8 +-
 .../processor/internals/RecordQueueTest.java       |  19 +-
 .../processor/internals/StandbyTaskTest.java       |  19 +-
 .../processor/internals/StreamTaskTest.java        |  31 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   3 +-
 106 files changed, 2688 insertions(+), 723 deletions(-)
eee95228fabe1643baa016a2d49fb0a9fe2c66bd

 .../java/org/apache/kafka/streams/StreamsConfig.java    | 17 ++++++++++++++---
 1 file changed, 14 insertions(+), 3 deletions(-)
8c90b1a98acb1222a0e907153bf52a85af0fe443

 .../apache/kafka/connect/runtime/WorkerSourceTask.java    | 15 +++++++++++++++
 .../kafka/connect/runtime/WorkerSourceTaskTest.java       |  2 ++
 2 files changed, 17 insertions(+)
3382b6db7b2b9c17a4ccfd9ebe840741bcf44670

 .../org/apache/kafka/common/BrokerEndPoint.java    | 88 ++++++++++++++++++++++
 .../kafka/common/requests/LeaderAndIsrRequest.java | 31 +++-----
 .../common/requests/UpdateMetadataRequest.java     | 18 +----
 .../kafka/common/requests/RequestResponseTest.java | 13 ++--
 .../controller/ControllerChannelManager.scala      |  6 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  4 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  4 +-
 7 files changed, 115 insertions(+), 49 deletions(-)
2faf9f60c81023b4c061c4b8067c8b23cf73516e

 .../common/ZkNodeChangeNotificationListener.scala  | 19 ++++-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  | 18 ----
 .../scala/kafka/server/DynamicConfigManager.scala  | 95 ++++------------------
 .../kafka/server/DynamicConfigChangeTest.scala     | 10 +--
 4 files changed, 40 insertions(+), 102 deletions(-)
5df56145a51c78e8808046254ad4771d60957ac5

 .../scala/kafka/api/UpdateMetadataRequest.scala    | 147 ---------------------
 .../scala/kafka/api/UpdateMetadataResponse.scala   |  42 ------
 .../main/scala/kafka/network/RequestChannel.scala  |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |  19 ++-
 .../main/scala/kafka/server/MetadataCache.scala    |  34 +++--
 .../main/scala/kafka/server/ReplicaManager.scala   |   9 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  87 ++++++------
 .../api/RequestResponseSerializationTest.scala     |  23 +---
 .../kafka/integration/BaseTopicMetadataTest.scala  |  20 +--
 9 files changed, 95 insertions(+), 287 deletions(-)
3ee1878d80aa6e3198731159d4479ac393489378

 bin/windows/kafka-run-class.bat        | 17 +++++++++++++----
 bin/windows/kafka-server-start.bat     |  8 ++++++--
 bin/windows/zookeeper-server-start.bat |  8 ++++++--
 3 files changed, 25 insertions(+), 8 deletions(-)
bb643f83a95e9ebb3a9f8331fe9998c8722c07d4

 .../org/apache/kafka/common/protocol/Protocol.java |   6 +-
 .../apache/kafka/common/protocol/types/Type.java   |  56 +++++++
 .../protocol/types/ProtocolSerializationTest.java  |  15 +-
 .../kafka/common/requests/RequestResponseTest.java |  12 ++
 core/src/main/scala/kafka/api/FetchRequest.scala   |   4 +-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |   8 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |   6 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |   8 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   6 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   4 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |   4 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   2 +-
 .../scala/kafka/api/UpdateMetadataRequest.scala    |   6 +-
 .../kafka/network/InvalidRequestException.scala    |  10 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   7 +-
 .../unit/kafka/server/EdgeCaseRequestTest.scala    | 171 +++++++++++++++++++++
 16 files changed, 290 insertions(+), 35 deletions(-)
f355918ec7edd6cfa1c0d74902a21d32d3065997

 build.gradle               |  6 +++---
 gradle/dependencies.gradle | 12 ++++++------
 2 files changed, 9 insertions(+), 9 deletions(-)
d7fc7cf6154592b7fea494a092e42ad9d45b98a0

 .../org/apache/kafka/common/protocol/Protocol.java |   6 +-
 .../apache/kafka/common/protocol/types/Type.java   |  56 +++++++
 .../protocol/types/ProtocolSerializationTest.java  |  15 +-
 .../kafka/common/requests/RequestResponseTest.java |  12 ++
 .../kafka/network/InvalidRequestException.scala    |  10 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   7 +-
 .../unit/kafka/server/EdgeCaseRequestTest.scala    | 171 +++++++++++++++++++++
 7 files changed, 266 insertions(+), 11 deletions(-)
85599bc3e861c77cd91c55273debe396da85deeb

 .../apache/kafka/clients/producer/internals/RecordAccumulator.java   | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
f141e647a4a3daf618b48073058320ecaa3671d0

 .../streams/processor/internals/StreamThread.java  | 32 ++++++++++++++++------
 1 file changed, 23 insertions(+), 9 deletions(-)
23c69d62a0cabf06c4db8b338f0ca824dc6d81a7

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
330274ed1c8efd2b1aa9907860429d9d20f72c3c

 .../src/main/java/org/apache/kafka/streams/processor/StateStore.java | 2 +-
 .../org/apache/kafka/streams/processor/internals/AbstractTask.java   | 2 +-
 .../kafka/streams/state/internals/InMemoryKeyValueLoggedStore.java   | 5 +++--
 .../kafka/streams/state/internals/InMemoryKeyValueStoreSupplier.java | 4 ++--
 .../org/apache/kafka/streams/state/internals/MemoryLRUCache.java     | 5 +++--
 .../apache/kafka/streams/state/internals/MeteredKeyValueStore.java   | 5 +++--
 .../org/apache/kafka/streams/state/internals/MeteredWindowStore.java | 5 +++--
 .../java/org/apache/kafka/streams/state/internals/RocksDBStore.java  | 5 +++--
 .../org/apache/kafka/streams/state/internals/RocksDBWindowStore.java | 5 +++--
 .../kafka/streams/state/internals/InMemoryKeyValueStoreTest.java     | 2 +-
 .../kafka/streams/state/internals/InMemoryLRUCacheStoreTest.java     | 2 +-
 .../kafka/streams/state/internals/RocksDBKeyValueStoreTest.java      | 2 +-
 .../apache/kafka/streams/state/internals/RocksDBWindowStoreTest.java | 2 +-
 streams/src/test/java/org/apache/kafka/test/KStreamTestDriver.java   | 2 +-
 .../src/test/java/org/apache/kafka/test/MockStateStoreSupplier.java  | 4 ++--
 15 files changed, 29 insertions(+), 23 deletions(-)
67a7ea9d6744645dd4e08b6a78dd69704a4982b3

 .../src/main/java/org/apache/kafka/streams/KafkaStreams.java  | 11 +++++++++++
 1 file changed, 11 insertions(+)
5092e7f8347d17d1b6e509424cbebf2406d8d4ba

 .../org/apache/kafka/connect/runtime/Connect.java  | 38 ++++++++++++----------
 1 file changed, 21 insertions(+), 17 deletions(-)
c1f8f689af43f5ce5a95dad86537db4615449694

 .../streams/processor/internals/StreamThread.java  | 43 ++++++++++++++--------
 1 file changed, 28 insertions(+), 15 deletions(-)
f232f53a7731d98cbc3feefbf9a4e58340a4758a

 docs/quickstart.html | 2 +-
 docs/security.html   | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)
1faab034b10a15beac2b90f8f2fe1c65a6b40765

 docs/quickstart.html | 2 +-
 docs/security.html   | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)
d5b43b19bb06e9cdc606312c8bcf87ed267daf44

 .../kafka/clients/consumer/ConsumerConfig.java     |  10 ++
 .../clients/consumer/ConsumerInterceptor.java      |  72 +++++++++
 .../kafka/clients/consumer/KafkaConsumer.java      |  15 +-
 .../consumer/internals/ConsumerCoordinator.java    |  12 +-
 .../consumer/internals/ConsumerInterceptors.java   |  99 ++++++++++++
 .../kafka/clients/producer/KafkaProducer.java      |  54 +++++++
 .../kafka/clients/producer/ProducerConfig.java     |  11 ++
 .../clients/producer/ProducerInterceptor.java      |  88 +++++++++++
 .../producer/internals/ProducerInterceptors.java   | 106 +++++++++++++
 .../apache/kafka/common/config/AbstractConfig.java |  10 ++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  24 +++
 .../internals/ConsumerCoordinatorTest.java         |   3 +-
 .../internals/ConsumerInterceptorsTest.java        | 174 +++++++++++++++++++++
 .../kafka/clients/producer/KafkaProducerTest.java  |  25 +++
 .../internals/ProducerInterceptorsTest.java        | 147 +++++++++++++++++
 .../apache/kafka/test/MockConsumerInterceptor.java |  80 ++++++++++
 .../apache/kafka/test/MockProducerInterceptor.java |  85 ++++++++++
 .../integration/kafka/api/BaseConsumerTest.scala   |  29 ++--
 .../kafka/api/PlaintextConsumerTest.scala          | 157 ++++++++++++++++++-
 19 files changed, 1182 insertions(+), 19 deletions(-)
9aa549dd696b989f0ead1f3d04cfb9293d8008b4

 core/src/main/scala/kafka/admin/AclCommand.scala            | 12 +++++++-----
 core/src/main/scala/kafka/utils/CommandLineUtils.scala      |  7 +++++--
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala   |  7 +++++++
 .../test/scala/unit/kafka/utils/CommandLineUtilsTest.scala  | 13 ++++++++++---
 4 files changed, 29 insertions(+), 10 deletions(-)
fe3b7492b73bf21ecb1a49e730dd30efd1e66693

 core/src/main/scala/kafka/admin/AclCommand.scala            | 12 +++++++-----
 core/src/main/scala/kafka/utils/CommandLineUtils.scala      |  7 +++++--
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala   |  7 +++++++
 .../test/scala/unit/kafka/utils/CommandLineUtilsTest.scala  | 13 ++++++++++---
 4 files changed, 29 insertions(+), 10 deletions(-)
728e14e25a414b2ffb525845bb382317d833dd8d

 core/src/main/scala/kafka/cluster/Partition.scala  |  2 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala | 29 +++++++++++++---------
 .../scala/kafka/server/LogOffsetMetadata.scala     | 19 +++-----------
 3 files changed, 21 insertions(+), 29 deletions(-)
6d0dca7345d9e3c0b8924496a4632954ca1268e5

 core/src/main/scala/kafka/cluster/Partition.scala  |  2 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala | 29 +++++++++++++---------
 .../scala/kafka/server/LogOffsetMetadata.scala     | 19 +++-----------
 3 files changed, 21 insertions(+), 29 deletions(-)
b5e6b8671a5b6d97d5026261ae8d62b54f068e53

 .../state/internals/RocksDBWindowStore.java        |  21 ++-
 .../state/internals/RocksDBWindowStoreTest.java    | 166 +++++++++++++++++++++
 2 files changed, 182 insertions(+), 5 deletions(-)
99ed1e37ce6eb0768514362db3e377fb40958f49

 tests/kafkatest/tests/produce_consume_validate.py | 4 ++--
 tests/kafkatest/tests/replication_test.py         | 6 +++---
 tests/kafkatest/tests/upgrade_test.py             | 2 +-
 3 files changed, 6 insertions(+), 6 deletions(-)
09ba85641c4034c87d2e81f91c54178b88251af9

 docs/ops.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
4fd60c6120dc4330deb7317360c835b04bc6cb9a

 docs/ops.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
cd15321e0d250253abb990af53e1f5624cf46b42

 .../org/apache/kafka/common/protocol/Errors.java   | 13 +++++++--
 .../apache/kafka/common/protocol/ErrorsTest.java   | 17 ++++++++++++
 .../scala/unit/kafka/message/MessageTest.scala     | 32 ++++++++++++++--------
 3 files changed, 48 insertions(+), 14 deletions(-)
6352a30f46f2da11a8dc3e58912d0a2db8284c35

 .../java/org/apache/kafka/streams/processor/internals/StreamThread.java  | 1 +
 1 file changed, 1 insertion(+)
9f5a1f87667c23db557a712d51c45541372f3c5d

 .../integration/kafka/api/AuthorizerIntegrationTest.scala     |  2 ++
 .../scala/integration/kafka/api/BaseProducerSendTest.scala    | 11 +++++++++--
 2 files changed, 11 insertions(+), 2 deletions(-)
dcdd3ea769cf6259900e4d04a1199ae07206ed65

 core/src/main/scala/kafka/admin/AclCommand.scala | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
9cac38c0216879776b9eab728235e35118e9026e

 core/src/main/scala/kafka/admin/AclCommand.scala | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
552f65aa3911b80b1121463ce292679711fae66a

 .../kafka/clients/consumer/KafkaConsumer.java      | 31 ++++++++++++++++++++--
 1 file changed, 29 insertions(+), 2 deletions(-)
0eaede4dc95846e2b8f7452f41c58c0122e7a563

 .../kafka/clients/consumer/KafkaConsumer.java      | 31 ++++++++++++++++++++--
 1 file changed, 29 insertions(+), 2 deletions(-)
feda3f68e98b5269431db9f2a5f131c03a16f651

 .../streams/state/internals/RocksDBStore.java      |  8 ++-
 .../state/internals/RocksDBWindowStore.java        | 79 ++++++++++++++++------
 .../state/internals/RocksDBWindowStoreTest.java    | 21 +++---
 3 files changed, 75 insertions(+), 33 deletions(-)
f7ad3d1b1fe24f3d33caf5f168d1292d4ae0b979

 .../processor/internals/RecordCollector.java       |   4 +-
 .../processor/internals/RecordCollectorTest.java   | 121 +++++++++++++++++++++
 2 files changed, 123 insertions(+), 2 deletions(-)
d2fc6f36cc0b98d4d0acaa62ce3f2283c4e60581

 .../java/org/apache/kafka/streams/state/internals/RocksDBStore.java  | 2 +-
 .../org/apache/kafka/streams/state/internals/RocksDBWindowStore.java | 5 +++--
 2 files changed, 4 insertions(+), 3 deletions(-)
4ee68b43c180d1f68648c0fb388a66b1ed0023e5

 .../streams/processor/internals/StreamThread.java   | 21 +++++++++++++++++----
 .../kafka/streams/state/internals/RocksDBStore.java | 12 ++++++------
 .../streams/state/internals/StoreChangeLogger.java  |  3 +++
 3 files changed, 26 insertions(+), 10 deletions(-)
1a539c74c115cbfeaebefee2298e846b4821132c

 core/src/main/scala/kafka/server/KafkaServer.scala | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)
656b5f6a8133552580b58ede0f3de74550d5e9b9

 tests/kafkatest/__init__.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8abbf95e9ae6664643d248f6e383a1eccf654879

 docs/configuration.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
f292820920a3f1b1fc52c5eba0e23b024af9156f

 docs/configuration.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
26efdede6c31904935c66de3bd979fa4edab624d

 .../test/scala/unit/kafka/server/ServerStartupTest.scala | 16 +++++++++++++++-
 1 file changed, 15 insertions(+), 1 deletion(-)
fa05ee727960257ec4b9aa92e1b46348a5450cf4

 .../main/java/org/apache/kafka/clients/producer/RecordMetadata.java  | 5 +++++
 .../apache/kafka/streams/processor/internals/RecordCollector.java    | 2 +-
 2 files changed, 6 insertions(+), 1 deletion(-)
40df94af5ca7df99cf384b52ea0090ba63048682

 build.gradle | 28 ++++++++++++++--------------
 1 file changed, 14 insertions(+), 14 deletions(-)
8f23db4c6ab24ae6d0c7ecabe42cd6f2d4edb089

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
d6e36df8737aa2b898b4fd0a81c2d94f3c349b68

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
64d51295929fb894e5d981c3086e646646fb97c9

 .../scala/kafka/server/LogOffsetMetadata.scala     | 22 ++++++++++++++++------
 1 file changed, 16 insertions(+), 6 deletions(-)
216c75bbc567a633447b1cbf2bb8c6ba34e2464f

 .../scala/kafka/server/LogOffsetMetadata.scala     | 22 ++++++++++++++++------
 1 file changed, 16 insertions(+), 6 deletions(-)
dc662776cde8e980a3f978041adaf961edf0fe7d

 .../apache/kafka/connect/runtime/WorkerTask.java   |  3 +
 .../kafka/connect/runtime/WorkerTaskTest.java      | 92 ++++++++++++++++++++++
 2 files changed, 95 insertions(+)
c3f575d5f248cd60daada7037838d0c7c5be1277

 .../kafka/clients/consumer/internals/Fetcher.java  |  7 ++--
 .../clients/consumer/internals/FetcherTest.java    | 10 +++++-
 .../integration/kafka/api/BaseConsumerTest.scala   | 31 +++++++++++------
 .../kafka/api/PlaintextConsumerTest.scala          | 39 +++++++++++++++++++---
 4 files changed, 69 insertions(+), 18 deletions(-)
db8d6f02c092c42f2402b7e2587c1b28d330bf83

 .../kafka/clients/consumer/internals/Fetcher.java  |  7 ++--
 .../clients/consumer/internals/FetcherTest.java    | 10 +++++-
 .../integration/kafka/api/BaseConsumerTest.scala   | 31 +++++++++++------
 .../kafka/api/PlaintextConsumerTest.scala          | 39 +++++++++++++++++++---
 4 files changed, 69 insertions(+), 18 deletions(-)
7802a90ed98ea5b9a2b2dcf2e04db1a50e34a2f8

 .../apache/kafka/streams/processor/ProcessorContext.java  | 15 ++++++++++++++-
 .../kafka/streams/processor/internals/AbstractTask.java   |  6 ++++++
 .../streams/processor/internals/ProcessorContextImpl.java | 12 +++++++++---
 .../streams/processor/internals/StandbyContextImpl.java   | 15 ++++++++++++---
 .../kafka/streams/processor/internals/StandbyTask.java    |  2 +-
 .../state/internals/InMemoryKeyValueLoggedStore.java      | 10 +++++-----
 .../streams/state/internals/RawStoreChangeLogger.java     |  8 ++++----
 .../kafka/streams/state/internals/StoreChangeLogger.java  | 13 +++++++------
 .../kafka/streams/state/KeyValueStoreTestDriver.java      |  2 +-
 .../java/org/apache/kafka/test/MockProcessorContext.java  |  7 ++++++-
 10 files changed, 65 insertions(+), 25 deletions(-)
c6ecc780988316de14fc4d27aa3ae8d5d253171c

 .../apache/kafka/connect/runtime/distributed/DistributedHerder.java | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
9b47f9a7f631ad4c84ab305126e71d74968cc967

 .../apache/kafka/connect/runtime/distributed/DistributedHerder.java | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
0a7b20e2863b2519e63d85bc83610e63c58c6d46

 .../internals/StreamPartitionAssignor.java         | 47 +++++++++++++++++++---
 1 file changed, 42 insertions(+), 5 deletions(-)
90ce9b30019632aad39fb6dcdd6e045f26697336

 Vagrantfile                 | 18 ------------------
 tests/bootstrap-test-env.sh | 10 +---------
 vagrant/README.md           |  3 +--
 3 files changed, 2 insertions(+), 29 deletions(-)
287e45ab40ad744405ee2008b51caa7922f1b7b2

 Vagrantfile                 | 18 ------------------
 tests/bootstrap-test-env.sh | 10 +---------
 vagrant/README.md           |  3 +--
 3 files changed, 2 insertions(+), 29 deletions(-)
f8598f96df3500cdea15a913d78de201469244b0

 .../java/org/apache/kafka/connect/runtime/WorkerSourceTaskTest.java  | 5 +++++
 1 file changed, 5 insertions(+)
77683c3cb0eab8c85eb13d0e1397cf9ee32586b6

 .../kafka/streams/processor/internals/ProcessorContextImpl.java      | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
c1eec0d4212e8ed6912bee6ffc2ee440cacf99ac

 .../src/main/java/org/apache/kafka/common/security/kerberos/Login.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
99956f56c9f994b4f55315559c07310b3d599d9b

 .../src/main/java/org/apache/kafka/common/security/kerberos/Login.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ca5e7f6f0cf1fa9514d9ec35f88ee1304b481a88

 tests/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d3ff902d6023eff257653a5dfb31f4e482204c44

 .../java/org/apache/kafka/streams/processor/TopologyBuilder.java    | 2 ++
 .../kafka/streams/processor/internals/ProcessorStateManager.java    | 6 +++---
 .../kafka/streams/processor/internals/StreamPartitionAssignor.java  | 6 +++---
 .../apache/kafka/streams/processor/internals/StandbyTaskTest.java   | 4 ++--
 .../java/org/apache/kafka/test/ProcessorTopologyTestDriver.java     | 2 +-
 5 files changed, 11 insertions(+), 9 deletions(-)
29ebb42fdf8af4b5983f3b22f13697e0c73e0d5a

 core/src/main/scala/kafka/server/KafkaConfig.scala |  7 ++++++
 .../unit/kafka/network/SocketServerTest.scala      |  4 ++--
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 28 ++++++++++++++++++++++
 3 files changed, 37 insertions(+), 2 deletions(-)
5b5869383832512d78e20183c855f83d30a5ab37

 core/src/main/scala/kafka/server/KafkaConfig.scala |  7 ++++++
 .../unit/kafka/network/SocketServerTest.scala      |  4 ++--
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 28 ++++++++++++++++++++++
 3 files changed, 37 insertions(+), 2 deletions(-)
79eacf6c95506d5d6819add5a1256681b13170b1

 .../org/apache/kafka/streams/KafkaStreams.java     | 35 +++++++++++++++-------
 .../java/org/apache/kafka/streams/KeyValue.java    |  8 +++++
 .../org/apache/kafka/streams/StreamsMetrics.java   |  3 ++
 .../streams/errors/ProcessorStateException.java    |  3 ++
 .../streams/errors/TaskAssignmentException.java    |  2 +-
 .../streams/errors/TaskIdFormatException.java      |  3 ++
 .../streams/errors/TopologyBuilderException.java   |  3 ++
 .../apache/kafka/streams/kstream/Aggregator.java   |  7 +++++
 .../kafka/streams/kstream/HoppingWindows.java      |  3 ++
 .../apache/kafka/streams/kstream/Initializer.java  |  5 ++++
 .../apache/kafka/streams/kstream/JoinWindows.java  |  2 +-
 .../org/apache/kafka/streams/kstream/KStream.java  |  2 +-
 .../kafka/streams/kstream/KStreamBuilder.java      | 11 ++++++-
 .../org/apache/kafka/streams/kstream/KTable.java   |  1 +
 .../kafka/streams/kstream/KeyValueMapper.java      |  7 +++++
 .../apache/kafka/streams/kstream/Predicate.java    |  7 ++---
 .../org/apache/kafka/streams/kstream/Reducer.java  |  5 ++++
 .../kafka/streams/kstream/TumblingWindows.java     |  4 ++-
 .../apache/kafka/streams/kstream/ValueJoiner.java  |  7 +++++
 .../apache/kafka/streams/kstream/ValueMapper.java  |  6 ++++
 .../streams/kstream/ValueTransformerSupplier.java  |  1 -
 .../org/apache/kafka/streams/kstream/Window.java   |  3 ++
 .../org/apache/kafka/streams/kstream/Windows.java  |  5 ++++
 .../streams/processor/DefaultPartitionGrouper.java | 12 ++++++--
 .../apache/kafka/streams/processor/Processor.java  |  2 +-
 .../kafka/streams/processor/ProcessorContext.java  |  3 ++
 .../streams/processor/StateStoreSupplier.java      |  3 ++
 .../org/apache/kafka/streams/processor/TaskId.java |  3 ++
 .../kafka/streams/state/KeyValueIterator.java      |  6 ++++
 .../apache/kafka/streams/state/WindowStore.java    | 17 +++++++++++
 30 files changed, 155 insertions(+), 24 deletions(-)
1d80f563bcd043cd464003782802906b60a0ade8

 .../org/apache/kafka/connect/sink/SinkTask.java    |  64 ++++-
 .../org/apache/kafka/connect/runtime/Worker.java   |  22 +-
 .../kafka/connect/runtime/WorkerSinkTask.java      | 257 ++++++++++++---------
 .../connect/runtime/WorkerSinkTaskThread.java      | 112 ---------
 .../kafka/connect/runtime/WorkerSourceTask.java    | 152 +++++-------
 .../apache/kafka/connect/runtime/WorkerTask.java   |  81 ++++++-
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  |  66 +++---
 .../runtime/WorkerSinkTaskThreadedTest.java        | 196 +++++++++-------
 .../connect/runtime/WorkerSourceTaskTest.java      |  15 +-
 .../apache/kafka/connect/runtime/WorkerTest.java   |   6 +-
 10 files changed, 512 insertions(+), 459 deletions(-)
e8343e67e1ca74c4c0ebd994b9811b9fed7aa386

 clients/src/test/java/org/apache/kafka/test/TestUtils.java    | 11 +++++++++++
 core/src/test/scala/unit/kafka/utils/TestUtils.scala          |  6 +-----
 .../kafka/streams/state/internals/OffsetCheckpointTest.java   |  7 +++----
 3 files changed, 15 insertions(+), 9 deletions(-)
fd10f6dff11c74ab4b12229305ab78fb694d5ea9

 tests/setup.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
95174337c2f6cda90e213e5c3a73fc89854f42a7

 .../examples/pageview/PageViewTypedJob.java        |  3 +-
 .../examples/pageview/PageViewUnTypedJob.java      |  4 +--
 .../streams/examples/wordcount/WordCountJob.java   |  4 +--
 .../apache/kafka/streams/kstream/Aggregator.java   | 16 +---------
 .../org/apache/kafka/streams/kstream/Count.java    | 36 ----------------------
 .../apache/kafka/streams/kstream/Initializer.java  | 23 ++++++++++++++
 .../org/apache/kafka/streams/kstream/KStream.java  | 24 +++++++++++----
 .../org/apache/kafka/streams/kstream/KTable.java   | 26 ++++++++++++++--
 .../apache/kafka/streams/kstream/SumAsLong.java    | 36 ----------------------
 .../kstream/internals/KStreamAggregate.java        | 13 +++++---
 .../streams/kstream/internals/KStreamImpl.java     | 27 ++++++++++++++--
 .../streams/kstream/internals/KTableAggregate.java | 17 ++++++----
 .../streams/kstream/internals/KTableImpl.java      | 36 ++++++++++++++++++++--
 .../kstream/internals/KStreamAggregateTest.java    | 23 +++++++-------
 .../kstream/internals/KTableAggregateTest.java     | 23 +++++++++-----
 15 files changed, 175 insertions(+), 136 deletions(-)
8189f9d58002ec0092737741bf6c74eebab4dc73

 .../kafka/streams/processor/AbstractProcessor.java | 10 +++---
 .../streams/processor/DefaultPartitionGrouper.java |  6 ++++
 .../kafka/streams/processor/PartitionGrouper.java  |  8 +++--
 .../kafka/streams/processor/ProcessorContext.java  | 41 ++++++++++++++++++++++
 .../streams/processor/TimestampExtractor.java      |  2 +-
 5 files changed, 58 insertions(+), 9 deletions(-)
86a9036a7b03c8ae07d014c25a5eedc315544139

 .../org/apache/kafka/streams/state/internals/RocksDBStore.java   | 9 +++++++--
 .../apache/kafka/streams/state/internals/RocksDBWindowStore.java | 2 +-
 2 files changed, 8 insertions(+), 3 deletions(-)
d0e86479501763549f19e2f616d385b947434413

 docs/upgrade.html | 1 -
 1 file changed, 1 deletion(-)
08ecb5bb0eab2161bda3811c277258aaa07c29e7

 .../src/main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java | 2 +-
 docs/upgrade.html                                                       | 2 ++
 2 files changed, 3 insertions(+), 1 deletion(-)
c97a75d985e42a9d1b1be0352240c45e0b0d2978

 .../src/main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java | 2 +-
 docs/upgrade.html                                                       | 1 +
 2 files changed, 2 insertions(+), 1 deletion(-)
8a2b7763ad16fa3869160f74de1ad2665e0a7e2b

 .../org/apache/kafka/clients/NetworkClient.java    | 48 +---------------------
 1 file changed, 1 insertion(+), 47 deletions(-)
c4f32c53ede93027aa08b1cc6c9f18ec71a702a0

 .../org/apache/kafka/clients/NetworkClient.java    | 48 +---------------------
 1 file changed, 1 insertion(+), 47 deletions(-)
4adfd7960c4bef187454d1ff5186f3be690abbf5

 .../processor/internals/ProcessorStateManager.java |  3 ---
 .../streams/processor/internals/StreamThread.java  | 22 +++++++++++++---------
 2 files changed, 13 insertions(+), 12 deletions(-)
57da044a991ebf8913d44dfcfa6a27729f54a4d5

 .../examples/pageview/PageViewTypedJob.java        |   6 +-
 .../examples/pageview/PageViewUnTypedJob.java      |   6 +-
 .../kafka/streams/examples/pipe/PipeJob.java       |   4 +-
 .../streams/examples/wordcount/WordCountJob.java   |   4 +-
 .../org/apache/kafka/streams/StreamsConfig.java    |   1 +
 .../streams/kstream/internals/KStreamImpl.java     |  76 +++----
 .../streams/kstream/internals/KTableImpl.java      |   4 +-
 .../kstream/internals/KTableStoreSupplier.java     |   2 +-
 .../org/apache/kafka/streams/state/Stores.java     |  36 +++-
 .../apache/kafka/streams/state/WindowStore.java    |   7 -
 .../kafka/streams/state/WindowStoreUtil.java       |  55 -----
 .../kafka/streams/state/WindowStoreUtils.java      |  54 +++++
 .../internals/InMemoryKeyValueLoggedStore.java     | 132 ++++++++++++
 .../internals/InMemoryKeyValueStoreSupplier.java   |  28 ++-
 .../internals/InMemoryLRUCacheStoreSupplier.java   | 151 +-------------
 .../streams/state/internals/MemoryLRUCache.java    | 151 ++++++++++++++
 .../state/internals/MemoryNavigableLRUCache.java   | 103 ++++++++++
 .../state/internals/MeteredKeyValueStore.java      |  79 +-------
 .../state/internals/MeteredWindowStore.java        |  68 +------
 .../streams/state/internals/OffsetCheckpoint.java  |   8 +-
 .../state/internals/RawStoreChangeLogger.java      |  56 ++++++
 .../internals/RocksDBKeyValueStoreSupplier.java    |   5 +-
 .../streams/state/internals/RocksDBStore.java      | 221 +++++++++++++++++++--
 .../state/internals/RocksDBWindowStore.java        |  80 ++++++--
 .../internals/RocksDBWindowStoreSupplier.java      |   4 +-
 .../streams/state/internals/StoreChangeLogger.java |  47 ++++-
 .../processor/internals/ProcessorTopologyTest.java |   4 +-
 .../streams/state/KeyValueStoreTestDriver.java     |  54 +++--
 .../apache/kafka/streams/state/StateTestUtils.java |  79 ++++++++
 .../org/apache/kafka/streams/state/StateUtils.java |  79 --------
 .../state/internals/AbstractKeyValueStoreTest.java |   2 +-
 .../state/internals/InMemoryLRUCacheStoreTest.java | 197 +++++++-----------
 .../state/internals/OffsetCheckpointTest.java      |  61 ++++++
 .../state/internals/RocksDBKeyValueStoreTest.java  |   4 +-
 .../state/internals/RocksDBWindowStoreTest.java    |   8 +-
 .../state/internals/StoreChangeLoggerTest.java     | 146 ++++++++++++++
 .../apache/kafka/test/MockProcessorContext.java    |  11 +
 .../apache/kafka/test/MockStateStoreSupplier.java  |  10 +-
 38 files changed, 1358 insertions(+), 685 deletions(-)
66ecf3f08d7ce19c45fc16bf679df46cab349a8a

 core/src/main/scala/kafka/server/OffsetCheckpoint.scala | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)
181df80dc3ac04b544501f3640f8727842e272b4

 .../streams/kstream/internals/WindowSupport.java   | 159 ---------------------
 1 file changed, 159 deletions(-)
d1ff6c75f261e4ca2e0c87e4c719fb8279765654

 docs/upgrade.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
eaa1433a2f2a9e9d528f5a2620edb63304067f62

 docs/upgrade.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
220d498497a2d5a3d99af1d3a46c631417d22858

 .../java/org/apache/kafka/common/network/SaslChannelBuilder.java    | 2 +-
 .../common/security/authenticator/SaslServerAuthenticator.java      | 6 ++++--
 2 files changed, 5 insertions(+), 3 deletions(-)
b433b4a2470896d90d9dc596bb932030869d5d67

 .../java/org/apache/kafka/common/network/SaslChannelBuilder.java    | 2 +-
 .../common/security/authenticator/SaslServerAuthenticator.java      | 6 ++++--
 2 files changed, 5 insertions(+), 3 deletions(-)
f3b38cb6fa1e45214b06005e5806d0927ef4c327

 core/src/test/scala/integration/kafka/api/AdminClientTest.scala       | 1 -
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala             | 1 -
 core/src/test/scala/unit/kafka/security/auth/AclTest.scala            | 1 -
 core/src/test/scala/unit/kafka/security/auth/OperationTest.scala      | 1 -
 core/src/test/scala/unit/kafka/security/auth/PermissionTypeTest.scala | 1 -
 core/src/test/scala/unit/kafka/security/auth/ResourceTypeTest.scala   | 1 -
 core/src/test/scala/unit/kafka/tools/ConsoleConsumerTest.scala        | 1 -
 7 files changed, 7 deletions(-)
afda7c4dc7246bb6e1589f2d9a21f825aa9325dc

 core/src/test/scala/integration/kafka/api/AdminClientTest.scala       | 1 -
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala             | 1 -
 core/src/test/scala/unit/kafka/security/auth/AclTest.scala            | 1 -
 core/src/test/scala/unit/kafka/security/auth/OperationTest.scala      | 1 -
 core/src/test/scala/unit/kafka/security/auth/PermissionTypeTest.scala | 1 -
 core/src/test/scala/unit/kafka/security/auth/ResourceTypeTest.scala   | 1 -
 core/src/test/scala/unit/kafka/tools/ConsoleConsumerTest.scala        | 1 -
 7 files changed, 7 deletions(-)
111927c398a36eb11d253178e766e76d897f529f

 .../kafka/clients/consumer/OffsetAndMetadata.java  |   4 +-
 .../org/apache/kafka/common/TopicPartition.java    |   4 +-
 ...erializeCompatibilityOffsetAndMetadataTest.java |  61 +++++++++++++++++++++
 .../SerializeCompatibilityTopicPartitionTest.java  |  61 +++++++++++++++++++++
 .../org/apache/kafka/common/utils/Serializer.java  |  49 +++++++++++++++++
 .../serializedData/offsetAndMetadataSerializedfile | Bin 0 -> 144 bytes
 .../serializedData/topicPartitionSerializedfile    | Bin 0 -> 125 bytes
 7 files changed, 177 insertions(+), 2 deletions(-)
598851f19cbf444c1f2530ec27543dd606b6fbc9

 .../org/apache/kafka/streams/state/Serdes.java     | 33 ++++++++--------------
 .../state/internals/MeteredKeyValueStore.java      |  1 -
 .../streams/state/internals/RocksDBStore.java      |  2 --
 3 files changed, 11 insertions(+), 25 deletions(-)
56c7842cb834297f3d86290e903bbe89a093c8cc

 core/src/test/scala/integration/kafka/api/AdminClientTest.scala       | 2 +-
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala             | 2 +-
 core/src/test/scala/unit/kafka/security/auth/AclTest.scala            | 2 +-
 core/src/test/scala/unit/kafka/security/auth/OperationTest.scala      | 2 +-
 core/src/test/scala/unit/kafka/security/auth/PermissionTypeTest.scala | 2 +-
 core/src/test/scala/unit/kafka/security/auth/ResourceTypeTest.scala   | 2 +-
 core/src/test/scala/unit/kafka/tools/ConsoleConsumerTest.scala        | 2 +-
 7 files changed, 7 insertions(+), 7 deletions(-)
a58b459bddd5b1dcab224b53cda0196e947a5b09

 core/src/test/scala/integration/kafka/api/AdminClientTest.scala       | 2 +-
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala             | 2 +-
 core/src/test/scala/unit/kafka/security/auth/AclTest.scala            | 2 +-
 core/src/test/scala/unit/kafka/security/auth/OperationTest.scala      | 2 +-
 core/src/test/scala/unit/kafka/security/auth/PermissionTypeTest.scala | 2 +-
 core/src/test/scala/unit/kafka/security/auth/ResourceTypeTest.scala   | 2 +-
 core/src/test/scala/unit/kafka/tools/ConsoleConsumerTest.scala        | 2 +-
 7 files changed, 7 insertions(+), 7 deletions(-)
e1d32bdffd0979596058788ffa3b1130cc7d93b8

 .../kafka/clients/consumer/OffsetAndMetadata.java  |   4 +-
 .../org/apache/kafka/common/TopicPartition.java    |   4 +-
 ...erializeCompatibilityOffsetAndMetadataTest.java |  61 +++++++++++++++++++++
 .../SerializeCompatibilityTopicPartitionTest.java  |  61 +++++++++++++++++++++
 .../org/apache/kafka/common/utils/Serializer.java  |  49 +++++++++++++++++
 .../serializedData/offsetAndMetadataSerializedfile | Bin 0 -> 144 bytes
 .../serializedData/topicPartitionSerializedfile    | Bin 0 -> 125 bytes
 7 files changed, 177 insertions(+), 2 deletions(-)
b08bd167965ae7307687fdb6115136a6ce14b3fa

 .../main/scala/kafka/javaapi/consumer/ZookeeperConsumerConnector.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
20afdcdd2ec129e94cbf335555c3d78f19a2d58e

 .../main/scala/kafka/javaapi/consumer/ZookeeperConsumerConnector.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
1a12d1333da79484b15e8825dcf0961a838579a6

 .../scala/kafka/server/ReplicaFetcherThread.scala    | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)
3cfa6da6f1141c7dc70459aa0a73c75340a65cef

 .../scala/kafka/server/ReplicaFetcherThread.scala    | 20 ++++++++++----------
 1 file changed, 10 insertions(+), 10 deletions(-)
8f302c83c3be0f5264a07dae73287dec81a0198d

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 5 -----
 docs/upgrade.html                                 | 1 +
 2 files changed, 1 insertion(+), 5 deletions(-)
3dcd5dbe89a17a2605f05d69f6df4b91a0ec24d9

 .../org/apache/kafka/common/network/SaslChannelBuilder.java |  5 +++--
 .../org/apache/kafka/common/security/ssl/SslFactory.java    | 13 +++++++++++--
 2 files changed, 14 insertions(+), 4 deletions(-)
91491986c0a4c9c4cde2ab33be822852b76759e6

 .../kafka/common/network/SaslChannelBuilder.java   |  5 ++--
 .../kafka/common/security/ssl/SslFactory.java      | 13 +++++++++--
 .../java/org/apache/kafka/test/TestSslUtils.java   |  6 ++---
 .../kafka/api/EndToEndAuthorizationTest.scala      | 27 ++++++++++------------
 .../api/SaslSslEndToEndAuthorizationTest.scala     |  7 ++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 6 files changed, 37 insertions(+), 23 deletions(-)
9e5b77ce9e49ff4cc02c63ccaed0ce4a806183a5

 docs/security.html | 77 +++++++++++++++++++++++++++++++++++++++++++++++++++---
 1 file changed, 74 insertions(+), 3 deletions(-)
962aec1a78cac18608556ac99ab583cdc944ac3f

 docs/security.html | 77 +++++++++++++++++++++++++++++++++++++++++++++++++++---
 1 file changed, 74 insertions(+), 3 deletions(-)
d5ba34a79b3585c9e5868d69346462405019fb80

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8e8b9cadea0715882997bd5d1641a065f3997077

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d4055ca5cf9f88b71fdf2fcd856c7e2135665427

 .../scala/kafka/server/ReplicaFetcherThread.scala  | 27 ++++++++++++++++++----
 1 file changed, 23 insertions(+), 4 deletions(-)
87eccb9a3bea56e5d7d5696aaddef1421f038903

 .../scala/kafka/server/ReplicaFetcherThread.scala  | 27 ++++++++++++++++++----
 1 file changed, 23 insertions(+), 4 deletions(-)
6a02b0cfc85245964049104658c05bde15f7b1a5

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
af0df0961fbc890309137424fe6b16f7c3e0a303

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5f93df8b3ee8ba15140dbf56e22a7ff291c4fac7

 bin/kafka-acls.sh                                |  2 +-
 bin/kafka-configs.sh                             |  2 +-
 bin/kafka-console-consumer.sh                    |  2 +-
 bin/kafka-console-producer.sh                    |  2 +-
 bin/kafka-consumer-groups.sh                     |  2 +-
 bin/kafka-consumer-offset-checker.sh             |  2 +-
 bin/kafka-consumer-perf-test.sh                  |  2 +-
 bin/kafka-mirror-maker.sh                        |  2 +-
 bin/kafka-preferred-replica-election.sh          |  2 +-
 bin/kafka-producer-perf-test.sh                  |  2 +-
 bin/kafka-reassign-partitions.sh                 |  2 +-
 bin/kafka-replay-log-producer.sh                 |  2 +-
 bin/kafka-replica-verification.sh                |  2 +-
 bin/kafka-server-start.sh                        |  2 +-
 bin/kafka-simple-consumer-shell.sh               |  2 +-
 bin/kafka-topics.sh                              |  2 +-
 bin/kafka-verifiable-consumer.sh                 |  2 +-
 bin/kafka-verifiable-producer.sh                 |  2 +-
 bin/zookeeper-security-migration.sh              |  2 +-
 bin/zookeeper-server-start.sh                    |  3 +-
 core/src/main/scala/kafka/admin/AclCommand.scala | 42 ++++++++++++------------
 21 files changed, 41 insertions(+), 42 deletions(-)
a21c77356017b2b950d0e569573cbf948c999b5f

 core/src/test/scala/unit/kafka/integration/BaseTopicMetadataTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9ce595d130c39ce83030e81765702697920dfcfa

 core/src/test/scala/unit/kafka/integration/BaseTopicMetadataTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
04a6491f4970c74e23a8d1483097f8de87982911

 Vagrantfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f4432874319bbd25e63f8adea135e05ba148b039

 docs/security.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a40a2a260a8ddde8651dd8278bf70da7c67b2c1d

 docs/security.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
523562c109b29cc5a5e56313f16f1b1ff6c5dd9c

 bin/kafka-acls.sh                                  |  2 +-
 bin/kafka-configs.sh                               |  2 +-
 bin/kafka-console-consumer.sh                      |  2 +-
 bin/kafka-console-producer.sh                      |  2 +-
 bin/kafka-consumer-groups.sh                       |  2 +-
 bin/kafka-consumer-offset-checker.sh               |  2 +-
 bin/kafka-consumer-perf-test.sh                    |  2 +-
 bin/kafka-mirror-maker.sh                          |  2 +-
 bin/kafka-preferred-replica-election.sh            |  2 +-
 bin/kafka-producer-perf-test.sh                    |  2 +-
 bin/kafka-reassign-partitions.sh                   |  2 +-
 bin/kafka-replay-log-producer.sh                   |  2 +-
 bin/kafka-replica-verification.sh                  |  2 +-
 bin/kafka-server-start.sh                          |  2 +-
 bin/kafka-simple-consumer-shell.sh                 |  2 +-
 bin/kafka-topics.sh                                |  2 +-
 bin/kafka-verifiable-consumer.sh                   |  2 +-
 bin/kafka-verifiable-producer.sh                   |  2 +-
 bin/zookeeper-security-migration.sh                |  2 +-
 bin/zookeeper-server-start.sh                      |  3 +-
 .../apache/kafka/common/network/EchoServer.java    | 27 +++++++-------
 .../apache/kafka/common/network/SelectorTest.java  |  7 ++--
 .../kafka/common/network/SslSelectorTest.java      | 10 +++---
 .../common/network/SslTransportLayerTest.java      |  3 +-
 .../kafka/common/security/ssl/SslFactoryTest.java  |  2 --
 .../java/org/apache/kafka/test/TestSslUtils.java   | 42 ++++------------------
 core/src/main/scala/kafka/admin/AclCommand.scala   | 42 +++++++++++-----------
 .../kafka/api/SslEndToEndAuthorizationTest.scala   |  4 +--
 28 files changed, 75 insertions(+), 103 deletions(-)
22de0a8ab5d0e84fa40016754f9a8eff8193aa89

 .../kstream/internals/KStreamAggregate.java        |   4 +-
 .../kstream/internals/KStreamAggregateTest.java    | 155 +++++++++++++++++++++
 2 files changed, 157 insertions(+), 2 deletions(-)
9ffa907d704b424ad05c18d834cfefdc1c7ad22a

 .../kstream/internals/FilteredIterator.java        | 63 ---------------
 .../kstream/internals/FilteredIteratorTest.java    | 94 ----------------------
 2 files changed, 157 deletions(-)
e9a72ceab6e0ceaf4d2125756f07154cd15a7178

 .../src/main/java/org/apache/kafka/clients/ClientUtils.java    |  2 +-
 .../org/apache/kafka/common/protocol/SecurityProtocol.java     |  5 +++++
 .../test/java/org/apache/kafka/common/network/EchoServer.java  |  2 +-
 core/src/main/scala/kafka/cluster/EndPoint.scala               |  4 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala             |  2 +-
 core/src/test/scala/unit/kafka/server/KafkaConfigTest.scala    | 10 ++++++++++
 6 files changed, 20 insertions(+), 5 deletions(-)
1388ed9ba21a4f451f4208e0a6179bb18b14008d

 README.md | 2 ++
 1 file changed, 2 insertions(+)
b84fef2ae092e57724e144a6299bade4113c80a8

 .../apache/kafka/clients/consumer/KafkaConsumer.java   | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
82c219149027e8d96840af98d32fb1b877ab4ec2

 .../apache/kafka/clients/consumer/KafkaConsumer.java   | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
5ae97196ae149e58f6cfa3c5b6d968cbd7cb6787

 .../streams/errors/ProcessorStateException.java    |  35 ++++++
 .../kafka/streams/errors/StreamsException.java     |  40 +++++++
 .../streams/errors/TaskAssignmentException.java    |  37 ++++++
 .../streams/errors/TaskIdFormatException.java      |  27 +++++
 .../streams/errors/TopologyBuilderException.java   |  27 +++++
 .../streams/kstream/internals/AbstractStream.java  |   4 +-
 .../kstream/internals/KStreamJoinWindow.java       |  14 +--
 .../kstream/internals/KTableRepartitionMap.java    |   3 +-
 .../streams/processor/DefaultPartitionGrouper.java |   4 +-
 .../org/apache/kafka/streams/processor/TaskId.java |   9 +-
 .../kafka/streams/processor/TopologyBuilder.java   |  78 ++++++-------
 .../kafka/streams/processor/TopologyException.java |  38 -------
 .../streams/processor/internals/AbstractTask.java  |   6 +-
 .../processor/internals/PartitionGroup.java        |   3 +-
 .../processor/internals/ProcessorContextImpl.java  |  16 +--
 .../processor/internals/ProcessorStateManager.java |   4 +-
 .../processor/internals/StandbyContextImpl.java    |   3 +-
 .../internals/StreamPartitionAssignor.java         |   9 +-
 .../streams/processor/internals/StreamThread.java  | 125 +++++++++++----------
 .../internals/assignment/AssignmentInfo.java       |  12 +-
 .../internals/assignment/SubscriptionInfo.java     |   1 +
 .../assignment/TaskAssignmentException.java        |  32 ------
 .../internals/assignment/TaskAssignor.java         |   1 +
 .../streams/state/internals/RocksDBStore.java      |  12 +-
 .../kafka/streams/kstream/KStreamBuilderTest.java  |   4 +-
 .../streams/processor/TopologyBuilderTest.java     |  25 +++--
 .../org/apache/kafka/streams/state/StateUtils.java |   2 +-
 27 files changed, 333 insertions(+), 238 deletions(-)
942074b77b1b1162acdd1bf7a3ee299bd0113886

 .../org/apache/kafka/streams/kstream/Windowed.java    | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)
920326a010b5a560c33a76fccc067b0991845b2d

 core/src/main/scala/kafka/cluster/Broker.scala     | 27 +++++++++++--------
 .../unit/kafka/cluster/BrokerEndPointTest.scala    | 30 +++++++++++++++++-----
 2 files changed, 40 insertions(+), 17 deletions(-)
30d3cc6314bf896ea37d01c5a1d6b21d69a7053f

 core/src/main/scala/kafka/cluster/Broker.scala     | 27 +++++++++++--------
 .../unit/kafka/cluster/BrokerEndPointTest.scala    | 30 +++++++++++++++++-----
 2 files changed, 40 insertions(+), 17 deletions(-)
9f21837e9925cf768c95a29423f9481b50dbe21d

 .../src/main/scala/kafka/controller/ReplicaStateMachine.scala | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)
fa6b90f97cb366a02eae8057124ec22db1f7e9cd

 docs/design.html | 1 -
 1 file changed, 1 deletion(-)
1e61327b92e25bbade1d41e2d21049b950e476f4

 .../kafka/clients/consumer/ConsumerConfig.java     |  4 +-
 .../kafka/clients/consumer/ConsumerConfigTest.java | 92 ++++++++++++++++++++++
 2 files changed, 94 insertions(+), 2 deletions(-)
5e8a084834ad35506ee74e1da15a3964642a512e

 .../kafka/clients/consumer/ConsumerConfig.java     |  4 +-
 .../kafka/clients/consumer/ConsumerConfigTest.java | 92 ++++++++++++++++++++++
 2 files changed, 94 insertions(+), 2 deletions(-)
c8b60b6344e659b805ea04fc976abcae2bf9fcf8

 Vagrantfile | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d00cf520fb0b36c7c705250b1773db2f242d5f44

 docs/implementation.html | 14 ++++-----
 docs/introduction.html   |  2 +-
 docs/ops.html            | 78 +++++++++++++++++++++++++-----------------------
 docs/security.html       |  4 +--
 4 files changed, 50 insertions(+), 48 deletions(-)
4f39b5bc5b2104fb39ab5b0c087fe84a71205a74

 tests/kafkatest/services/kafka/kafka.py            |  50 ++++++++++
 .../kafkatest/tests/consumer_group_command_test.py | 105 +++++++++++++++++++++
 2 files changed, 155 insertions(+)
bc9237701b06768c119e954ddb4cd2e61c24e305

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 16 ++++++++++++----
 1 file changed, 12 insertions(+), 4 deletions(-)
c197113a9c04e2f6c2d1a72161c0d40d5804490e

 build.gradle                                       |  25 ++++
 settings.gradle                                    |   2 +-
 .../examples/pageview/JsonPOJODeserializer.java    |  66 +++++++++++
 .../examples/pageview/JsonPOJOSerializer.java      |  60 ++++++++++
 .../examples/pageview/PageViewTypedJob.java        | 127 +++++++++++++++++++++
 .../examples/pageview/PageViewUnTypedJob.java      | 107 +++++++++++++++++
 .../kafka/streams/examples/pipe/PipeJob.java       |  50 ++++++++
 .../streams/examples/wordcount/WordCountJob.java   | 103 +++++++++++++++++
 .../examples/wordcount/WordCountProcessorJob.java  | 121 ++++++++++++++++++++
 .../org/apache/kafka/streams/StreamsConfig.java    |   6 +-
 .../apache/kafka/streams/examples/KStreamJob.java  |  84 --------------
 .../kafka/streams/examples/ProcessorJob.java       | 115 -------------------
 .../examples/WallclockTimestampExtractor.java      |  28 -----
 .../org/apache/kafka/streams/kstream/Count.java    |   6 +-
 .../streams/kstream/KeyValueToDoubleMapper.java    |  23 ----
 .../kafka/streams/kstream/KeyValueToIntMapper.java |  23 ----
 .../streams/kstream/KeyValueToLongMapper.java      |  23 ----
 .../kafka/streams/kstream/TumblingWindows.java     |   8 +-
 .../kafka/streams/kstream/UnlimitedWindows.java    |  10 +-
 .../streams/kstream/internals/KStreamImpl.java     |   8 +-
 .../internals/WindowedStreamPartitioner.java       |  52 +++++++++
 .../internals/WindowedStreamsPartitioner.java      |  52 ---------
 .../kafka/streams/processor/StreamPartitioner.java |  59 ++++++++++
 .../streams/processor/StreamsPartitioner.java      |  59 ----------
 .../kafka/streams/processor/TopologyBuilder.java   |  26 ++---
 .../streams/processor/internals/AbstractTask.java  |   3 +-
 .../processor/internals/RecordCollector.java       |   4 +-
 .../streams/processor/internals/SinkNode.java      |   6 +-
 .../streams/processor/internals/StreamThread.java  |  20 +++-
 .../internals/WallclockTimestampExtractor.java     |  28 +++++
 .../apache/kafka/streams/StreamsConfigTest.java    |   2 +-
 .../internals/WindowedStreamPartitionerTest.java   |  84 ++++++++++++++
 .../internals/WindowedStreamsPartitionerTest.java  |  84 --------------
 .../processor/internals/ProcessorTopologyTest.java |   6 +-
 .../processor/internals/StandbyTaskTest.java       |   6 +-
 .../processor/internals/StreamThreadTest.java      |  32 +++---
 .../streams/state/KeyValueStoreTestDriver.java     |   4 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |   4 +-
 38 files changed, 972 insertions(+), 554 deletions(-)
a19729fe61b23178c6f91135cb81901f76f982f0

 .../apache/kafka/common/protocol/ProtoUtils.java   |  2 +-
 .../kafka/common/protocol/ProtoUtilsTest.java      | 26 ++++++++++++++++++++++
 2 files changed, 27 insertions(+), 1 deletion(-)
21c6cfe50dbe818a392c28f48ce8891f7f99aaf6

 .../org/apache/kafka/streams/KafkaStreaming.java   | 167 -------
 .../org/apache/kafka/streams/KafkaStreams.java     | 171 +++++++
 .../java/org/apache/kafka/streams/KeyValue.java    |  37 ++
 .../org/apache/kafka/streams/StreamingConfig.java  | 314 -------------
 .../org/apache/kafka/streams/StreamingMetrics.java |  27 --
 .../org/apache/kafka/streams/StreamsConfig.java    | 303 ++++++++++++
 .../org/apache/kafka/streams/StreamsMetrics.java   |  27 ++
 .../apache/kafka/streams/examples/KStreamJob.java  |  24 +-
 .../kafka/streams/examples/ProcessorJob.java       |  34 +-
 .../org/apache/kafka/streams/kstream/KStream.java  |   1 +
 .../org/apache/kafka/streams/kstream/KTable.java   |   1 +
 .../org/apache/kafka/streams/kstream/KeyValue.java |  34 --
 .../kstream/internals/KStreamAggregate.java        |   2 +-
 .../streams/kstream/internals/KStreamFlatMap.java  |   2 +-
 .../streams/kstream/internals/KStreamImpl.java     |  10 +-
 .../kstream/internals/KStreamKStreamJoin.java      |   2 +-
 .../streams/kstream/internals/KStreamMap.java      |   2 +-
 .../streams/kstream/internals/KStreamReduce.java   |   2 +-
 .../kstream/internals/KStreamTransform.java        |   2 +-
 .../streams/kstream/internals/KTableImpl.java      |   2 +-
 .../kstream/internals/KTableRepartitionMap.java    |   2 +-
 .../internals/WindowedStreamPartitioner.java       |  52 ---
 .../internals/WindowedStreamsPartitioner.java      |  52 +++
 .../kafka/streams/processor/ProcessorContext.java  |   6 +-
 .../kafka/streams/processor/StreamPartitioner.java |  59 ---
 .../streams/processor/StreamsPartitioner.java      |  59 +++
 .../kafka/streams/processor/TopologyBuilder.java   |  76 +--
 .../streams/processor/internals/AbstractTask.java  |   6 +-
 .../internals/KafkaStreamingPartitionAssignor.java | 483 -------------------
 .../processor/internals/ProcessorContextImpl.java  |  12 +-
 .../processor/internals/RecordCollector.java       |   4 +-
 .../streams/processor/internals/SinkNode.java      |   6 +-
 .../processor/internals/StandbyContextImpl.java    |  12 +-
 .../streams/processor/internals/StandbyTask.java   |  12 +-
 .../internals/StreamPartitionAssignor.java         | 483 +++++++++++++++++++
 .../streams/processor/internals/StreamTask.java    |  16 +-
 .../streams/processor/internals/StreamThread.java  |  48 +-
 .../java/org/apache/kafka/streams/state/Entry.java |  42 --
 .../kafka/streams/state/KeyValueIterator.java      |   4 +-
 .../apache/kafka/streams/state/KeyValueStore.java  |   3 +-
 .../kafka/streams/state/WindowStoreIterator.java   |   2 +-
 .../internals/InMemoryKeyValueStoreSupplier.java   |  12 +-
 .../internals/InMemoryLRUCacheStoreSupplier.java   |  12 +-
 .../state/internals/MeteredKeyValueStore.java      |  14 +-
 .../state/internals/MeteredWindowStore.java        |   6 +-
 .../streams/state/internals/RocksDBStore.java      |  16 +-
 .../state/internals/RocksDBWindowStore.java        |   9 +-
 .../apache/kafka/streams/StreamingConfigTest.java  |  75 ---
 .../apache/kafka/streams/StreamsConfigTest.java    |  76 +++
 .../kstream/internals/KStreamFlatMapTest.java      |   2 +-
 .../internals/KStreamKTableLeftJoinTest.java       |   2 +-
 .../streams/kstream/internals/KStreamMapTest.java  |   2 +-
 .../kstream/internals/KStreamTransformTest.java    |   2 +-
 .../kstream/internals/KTableKTableJoinTest.java    |   2 +-
 .../internals/KTableKTableLeftJoinTest.java        |   2 +-
 .../internals/KTableKTableOuterJoinTest.java       |   2 +-
 .../internals/WindowedStreamPartitionerTest.java   |  84 ----
 .../internals/WindowedStreamsPartitionerTest.java  |  84 ++++
 .../KafkaStreamingPartitionAssignorTest.java       | 508 --------------------
 .../processor/internals/ProcessorTopologyTest.java |  27 +-
 .../processor/internals/StandbyTaskTest.java       |  31 +-
 .../internals/StreamPartitionAssignorTest.java     | 509 +++++++++++++++++++++
 .../processor/internals/StreamTaskTest.java        |  27 +-
 .../processor/internals/StreamThreadTest.java      |  37 +-
 .../streams/state/KeyValueStoreTestDriver.java     |  45 +-
 .../state/internals/AbstractKeyValueStoreTest.java |  22 +-
 .../state/internals/RocksDBWindowStoreTest.java    |  38 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |   4 +-
 .../apache/kafka/test/MockProcessorContext.java    |  14 +-
 .../org/apache/kafka/test/NoOpKeyValueMapper.java  |   2 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |  32 +-
 71 files changed, 2133 insertions(+), 2168 deletions(-)
f0249f595400fdc172c01dcad230781bf0325d1d

 bin/kafka-run-class.sh          | 10 ----------
 bin/windows/kafka-run-class.bat | 10 ----------
 2 files changed, 20 deletions(-)
91ba074e4a9a012559ce8626c55db199c830cb0d

 bin/kafka-run-class.sh          | 10 ----------
 bin/windows/kafka-run-class.bat | 10 ----------
 2 files changed, 20 deletions(-)
7b2263946b944249e84c8923c2c14aa661a83639

 Vagrantfile | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)
4922a51edd91d862d9be92b1a652d2a83d936b2c

 core/src/main/scala/kafka/admin/AdminUtils.scala | 18 +++++++++++++-----
 1 file changed, 13 insertions(+), 5 deletions(-)
7e2d0096a8afebb550b0444277512219c857fc96

 docs/upgrade.html | 1 +
 1 file changed, 1 insertion(+)
f2d4ed5bc4c2bc2bf7241ad6b6a9d3c0ce026269

 docs/upgrade.html | 1 +
 1 file changed, 1 insertion(+)
9577dc2358f4324de04219c7160a10c230a130b9

 tests/kafkatest/services/console_consumer.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
79cda0472b8e3af915c45daca9cce82d7c964182

 .../kafka/common/requests/ProduceRequest.java      |  8 ++-
 .../kafka/common/requests/ProduceResponse.java     |  2 +-
 .../apache/kafka/common/requests/RequestSend.java  |  2 +-
 .../kafka/common/requests/RequestResponseTest.java |  2 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 53 +++++++-------
 .../main/scala/kafka/network/RequestChannel.scala  | 19 ++---
 .../scala/kafka/server/DelayedOperationKey.scala   |  3 +
 .../main/scala/kafka/server/DelayedProduce.scala   | 30 ++++----
 core/src/main/scala/kafka/server/KafkaApis.scala   | 83 ++++++++++++----------
 .../main/scala/kafka/server/ReplicaManager.scala   | 61 ++++++++--------
 .../coordinator/GroupCoordinatorResponseTest.scala | 20 +++---
 .../unit/kafka/network/SocketServerTest.scala      | 74 +++++++++++--------
 .../unit/kafka/server/ReplicaManagerTest.scala     | 21 ++++--
 13 files changed, 208 insertions(+), 170 deletions(-)
959cf09e8653f4b8255f49c6f4c258ed1a5ec38e

 .../apache/kafka/streams/examples/KTableJob.java   | 111 ----
 .../apache/kafka/streams/kstream/Aggregator.java   |   7 +-
 .../kafka/streams/kstream/AggregatorSupplier.java  |  23 -
 .../org/apache/kafka/streams/kstream/Count.java    |  36 ++
 .../org/apache/kafka/streams/kstream/KStream.java  |  38 +-
 .../org/apache/kafka/streams/kstream/KTable.java   |  59 +-
 .../org/apache/kafka/streams/kstream/Reducer.java  |  23 +
 .../apache/kafka/streams/kstream/SumAsLong.java    |  36 ++
 .../streams/kstream/internals/CountSupplier.java   |  52 --
 .../kstream/internals/KStreamAggregate.java        |   4 +-
 .../streams/kstream/internals/KStreamImpl.java     | 122 ++--
 .../streams/kstream/internals/KStreamReduce.java   | 167 +++++
 .../streams/kstream/internals/KTableAggregate.java |   4 +-
 .../streams/kstream/internals/KTableImpl.java      | 128 ++--
 .../streams/kstream/internals/KTableReduce.java    | 120 ++++
 .../kstream/internals/KTableStoreSupplier.java     |   4 +-
 .../streams/kstream/internals/LongSumSupplier.java |  52 --
 .../streams/kstream/internals/TopKSupplier.java    | 106 ----
 .../processor/internals/ProcessorStateManager.java |   2 +-
 .../state/InMemoryKeyValueStoreSupplier.java       | 155 -----
 .../state/InMemoryLRUCacheStoreSupplier.java       | 195 ------
 .../kafka/streams/state/MeteredKeyValueStore.java  | 250 --------
 .../kafka/streams/state/MeteredWindowStore.java    | 206 -------
 .../kafka/streams/state/OffsetCheckpoint.java      | 162 -----
 .../state/RocksDBKeyValueStoreSupplier.java        |  52 --
 .../apache/kafka/streams/state/RocksDBStore.java   | 265 --------
 .../kafka/streams/state/RocksDBWindowStore.java    | 289 ---------
 .../streams/state/RocksDBWindowStoreSupplier.java  |  58 --
 .../kafka/streams/state/StoreChangeLogger.java     |  91 ---
 .../org/apache/kafka/streams/state/Stores.java     |   3 +
 .../internals/InMemoryKeyValueStoreSupplier.java   | 159 +++++
 .../internals/InMemoryLRUCacheStoreSupplier.java   | 199 ++++++
 .../state/internals/MeteredKeyValueStore.java      | 254 ++++++++
 .../state/internals/MeteredWindowStore.java        | 209 +++++++
 .../streams/state/internals/OffsetCheckpoint.java  | 162 +++++
 .../internals/RocksDBKeyValueStoreSupplier.java    |  53 ++
 .../streams/state/internals/RocksDBStore.java      | 269 ++++++++
 .../state/internals/RocksDBWindowStore.java        | 295 +++++++++
 .../internals/RocksDBWindowStoreSupplier.java      |  59 ++
 .../streams/state/internals/StoreChangeLogger.java |  92 +++
 .../kstream/internals/KStreamAggregateTest.java    |  36 +-
 .../kstream/internals/KTableAggregateTest.java     |  36 +-
 .../internals/ProcessorStateManagerTest.java       |   2 +-
 .../processor/internals/StandbyTaskTest.java       |   2 +-
 .../streams/state/AbstractKeyValueStoreTest.java   | 191 ------
 .../streams/state/InMemoryKeyValueStoreTest.java   |  48 --
 .../streams/state/InMemoryLRUCacheStoreTest.java   | 156 -----
 .../streams/state/KeyValueStoreTestDriver.java     |   4 +-
 .../streams/state/RocksDBKeyValueStoreTest.java    |  50 --
 .../streams/state/RocksDBWindowStoreTest.java      | 671 --------------------
 .../state/internals/AbstractKeyValueStoreTest.java | 195 ++++++
 .../state/internals/InMemoryKeyValueStoreTest.java |  50 ++
 .../state/internals/InMemoryLRUCacheStoreTest.java | 159 +++++
 .../state/internals/RocksDBKeyValueStoreTest.java  |  52 ++
 .../state/internals/RocksDBWindowStoreTest.java    | 676 +++++++++++++++++++++
 55 files changed, 3468 insertions(+), 3431 deletions(-)
9059bbfff917b4bebbb06f8c8a01cce3d8230830

 .../java/org/apache/kafka/clients/producer/internals/Sender.java | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)
e4ef8e6640a266da1d9135282ae41d18f44f8025

 .../java/org/apache/kafka/clients/producer/internals/Sender.java | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)
6b85158173275f06a700296ec31535130a9a45c7

 .../kafka/clients/producer/internals/RecordAccumulator.java   | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)
23b8740d82e4c009fcfb4827f7cd673210bde3b4

 .../kafka/clients/producer/internals/RecordAccumulator.java   | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)
a1efe633207312d63897ad27953a324d1874fa6b

 clients/src/main/java/org/apache/kafka/common/PartitionInfo.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c2b73258454778731a8a27bca2836d25eaf04d06

 clients/src/main/java/org/apache/kafka/common/record/MemoryRecords.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0a7f2bf335e426b12f717ec7f6d51779d56fe59b

 clients/src/main/java/org/apache/kafka/common/record/MemoryRecords.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b1d325b3c09cd95d69a66fac4a3760f57d3062c9

 core/src/main/scala/kafka/server/KafkaServer.scala | 25 +++++++++-----
 .../kafka/server/ServerGenerateBrokerIdTest.scala  | 38 ++++++++++++++++++++++
 2 files changed, 55 insertions(+), 8 deletions(-)
ebd5f33605c8891e606a9a4b793691aa62d7963c

 core/src/main/scala/kafka/server/KafkaConfig.scala       | 11 ++++++++++-
 core/src/main/scala/kafka/server/KafkaServer.scala       |  6 +++---
 .../test/scala/unit/kafka/server/KafkaConfigTest.scala   |  4 +++-
 .../unit/kafka/server/ServerGenerateBrokerIdTest.scala   | 16 ++++++++++++++++
 docs/upgrade.html                                        |  8 +++++++-
 5 files changed, 39 insertions(+), 6 deletions(-)
5c337d759892ae6d46d6901a24e9b97cebd2a4da

 core/src/main/scala/kafka/server/KafkaConfig.scala       | 11 ++++++++++-
 core/src/main/scala/kafka/server/KafkaServer.scala       |  6 +++---
 .../test/scala/unit/kafka/server/KafkaConfigTest.scala   |  4 +++-
 .../unit/kafka/server/ServerGenerateBrokerIdTest.scala   | 16 ++++++++++++++++
 docs/upgrade.html                                        |  8 +++++++-
 5 files changed, 39 insertions(+), 6 deletions(-)
c06542edeadb99fc5adddcea422d411e3ac96171

 bin/zookeeper-server-start.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f75e3350259c6df11719ee0a55f5780c136f3d26

 .../org/apache/kafka/streams/kstream/KStream.java  | 37 -------------
 .../streams/kstream/internals/KStreamImpl.java     | 63 ++++++++++------------
 2 files changed, 27 insertions(+), 73 deletions(-)
a62eb5993f5517a64dd1020b0a9bbd1012f7ee67

 .../kafka/streams/kstream/HoppingWindows.java      |  23 +-
 .../apache/kafka/streams/kstream/JoinWindows.java  |  33 +--
 .../org/apache/kafka/streams/kstream/KStream.java  |  18 +-
 .../org/apache/kafka/streams/kstream/KTable.java   |  18 +-
 .../kafka/streams/kstream/SlidingWindows.java      |  67 ------
 .../kafka/streams/kstream/TumblingWindows.java     |  68 ++++++
 .../kafka/streams/kstream/UnlimitedWindows.java    |   8 +-
 .../org/apache/kafka/streams/kstream/Window.java   |  19 ++
 .../org/apache/kafka/streams/kstream/Windowed.java |   5 +
 .../org/apache/kafka/streams/kstream/Windows.java  |  27 ++-
 .../kstream/internals/KStreamAggWindow.java        |  51 +++++
 .../kstream/internals/KStreamAggregate.java        | 171 +++++++++++++++
 .../streams/kstream/internals/KStreamFlatMap.java  |  14 +-
 .../kstream/internals/KStreamFlatMapValues.java    |  16 +-
 .../streams/kstream/internals/KStreamImpl.java     |  49 +++--
 .../kstream/internals/KStreamJoinWindow.java       |  11 +-
 .../kstream/internals/KStreamKStreamJoin.java      |  15 +-
 .../kstream/internals/KStreamKTableLeftJoin.java   |   6 +-
 .../streams/kstream/internals/KStreamMap.java      |  14 +-
 .../kstream/internals/KStreamMapValues.java        |  14 +-
 .../kstream/internals/KStreamTransform.java        |   8 +-
 .../internals/KTableKTableAbstractJoin.java        |   6 +-
 .../kstream/internals/KTableKTableJoin.java        |  20 +-
 .../kstream/internals/KTableKTableLeftJoin.java    |  18 +-
 .../kstream/internals/KTableKTableOuterJoin.java   |  20 +-
 .../kstream/internals/KTableKTableRightJoin.java   |  18 +-
 .../streams/kstream/internals/KTableMapValues.java |  38 ++--
 .../kstream/internals/KTableRepartitionMap.java    |  38 ++--
 .../streams/kstream/internals/SlidingWindow.java   |  38 ----
 .../streams/kstream/internals/TumblingWindow.java  |  38 ++++
 .../kafka/streams/state/MeteredWindowStore.java    |  18 +-
 .../apache/kafka/streams/state/RocksDBStore.java   |   1 +
 .../kafka/streams/state/RocksDBWindowStore.java    |  44 ++--
 .../streams/state/RocksDBWindowStoreSupplier.java  |  10 +-
 .../apache/kafka/streams/state/WindowStore.java    |   6 +-
 .../kafka/streams/state/WindowStoreIterator.java   |   4 +-
 .../kstream/internals/KStreamAggregateTest.java    | 154 +++++++++++++
 .../kstream/internals/KStreamKStreamJoinTest.java  |   6 +-
 .../kstream/internals/KTableAggregateTest.java     |  18 +-
 .../streams/kstream/internals/WindowsTest.java     |  70 ++++++
 .../streams/state/RocksDBWindowStoreTest.java      | 239 ++++++++++-----------
 41 files changed, 1000 insertions(+), 459 deletions(-)
cc3570d1a28354acd082c41a15d9c9efde540b16

 .../errors/InconsistentGroupProtocolException.java | 25 +++++++++
 .../errors/InvalidCommitOffsetSizeException.java   | 25 +++++++++
 .../common/errors/InvalidGroupIdException.java     | 25 +++++++++
 .../errors/InvalidSessionTimeoutException.java     | 25 +++++++++
 .../org/apache/kafka/common/protocol/Errors.java   | 12 +++--
 .../apache/kafka/common/protocol/ErrorsTest.java   | 63 ++++++++++++++++++++++
 6 files changed, 171 insertions(+), 4 deletions(-)
a9395e746111f43bb972a38c6c8f823407100278

 clients/src/main/java/org/apache/kafka/common/config/SaslConfigs.java | 3 ++-
 docs/security.html                                                    | 3 +++
 2 files changed, 5 insertions(+), 1 deletion(-)
401ae7707cf3990240544eb4575acc46a9c85017

 clients/src/main/java/org/apache/kafka/common/config/SaslConfigs.java | 3 ++-
 docs/security.html                                                    | 3 +++
 2 files changed, 5 insertions(+), 1 deletion(-)
cdfcf2e18c8e60b38a43d60e34cb7e773bd070c2

 docs/configuration.html | 5 -----
 1 file changed, 5 deletions(-)
5979480c3af6be00cf7b135aeabf11bf8141f936

 docs/configuration.html | 5 -----
 1 file changed, 5 deletions(-)
7ec6fc889bff7f1de1b04c09077eb7f3d50f8000

 .../consumer/internals/ConsumerProtocol.java       |  4 +-
 .../apache/kafka/common/protocol/types/Struct.java |  2 +
 .../apache/kafka/common/protocol/types/Type.java   | 67 ++++++++++++++++++++++
 .../consumer/internals/ConsumerProtocolTest.java   | 18 ++++++
 .../protocol/types/ProtocolSerializationTest.java  | 25 ++++++--
 5 files changed, 110 insertions(+), 6 deletions(-)
747dc930ff710ec890b5f054b4ec4bf7bbb7c960

 .../consumer/internals/ConsumerProtocol.java       |  4 +-
 .../apache/kafka/common/protocol/types/Struct.java |  2 +
 .../apache/kafka/common/protocol/types/Type.java   | 67 ++++++++++++++++++++++
 .../consumer/internals/ConsumerProtocolTest.java   | 18 ++++++
 .../protocol/types/ProtocolSerializationTest.java  | 25 ++++++--
 5 files changed, 110 insertions(+), 6 deletions(-)
0c32bc99265c4645fad2e3244dc2c697bfd9a229

 core/src/main/scala/kafka/log/FileMessageSet.scala   | 10 +++++-----
 core/src/main/scala/kafka/log/LogSegment.scala       | 20 +++++++++++++-------
 core/src/main/scala/kafka/log/OffsetIndex.scala      | 11 ++++++-----
 .../kafka/server/BrokerMetadataCheckpoint.scala      | 10 ++--------
 .../main/scala/kafka/server/OffsetCheckpoint.scala   |  4 ++--
 core/src/test/scala/unit/kafka/log/CleanerTest.scala |  7 ++++---
 .../apache/kafka/streams/state/OffsetCheckpoint.java | 16 +++-------------
 7 files changed, 35 insertions(+), 43 deletions(-)
60a5a523b6f7e5151d8cdc835845cfc4d2e72b52

 core/src/main/scala/kafka/controller/ReplicaStateMachine.scala | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
562e2a5dcb34b3ac29a0e573ea5d30d5c7c8e6d7

 .../main/java/org/apache/kafka/common/record/Compressor.java   | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)
a071e3554bf626182557dfaca491afebe9c17020

 .../main/java/org/apache/kafka/common/record/Compressor.java   | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)
6dc974312590f089c9e0ac27e8eb9b848caf32b5

 .../org/apache/kafka/connect/sink/SinkTask.java    |  7 +-
 .../kafka/connect/runtime/WorkerSinkTask.java      | 44 ++++++++--
 .../connect/runtime/WorkerSinkTaskThread.java      | 34 ++++----
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 94 ++++++++++++++++++++++
 4 files changed, 151 insertions(+), 28 deletions(-)
37be6d98da842512367ab0b31d8f0244afafda92

 .../streams/kstream/internals/KStreamImpl.java     | 10 ++-
 .../kstream/internals/WindowedSerializer.java      |  6 +-
 .../internals/WindowedStreamPartitioner.java       | 52 ++++++++++++++
 .../internals/WindowedStreamPartitionerTest.java   | 84 ++++++++++++++++++++++
 4 files changed, 150 insertions(+), 2 deletions(-)
a3d3d5379df71e7a2c653d06ebf1b30923dde738

 .../streams/kstream/internals/KTableImpl.java      |  5 ++-
 .../kafka/streams/processor/TopologyBuilder.java   | 44 +++++++++++++++++-----
 .../internals/KafkaStreamingPartitionAssignor.java | 35 ++++++++++++-----
 .../streams/processor/TopologyBuilderTest.java     | 13 ++++---
 4 files changed, 71 insertions(+), 26 deletions(-)
4f22705c7d0c8e8cab68883e76f554439341e34a

 .../org/apache/kafka/streams/kstream/KTable.java   |  58 +---
 .../kstream/internals/ChangedDeserializer.java     |  59 ++++
 .../kstream/internals/ChangedSerializer.java       |  57 ++++
 .../streams/kstream/internals/CountSupplier.java   |  52 ++++
 .../internals/DefaultWindowedDeserializer.java     |  59 ----
 .../internals/DefaultWindowedSerializer.java       |  57 ----
 .../streams/kstream/internals/KStreamImpl.java     |  58 ++--
 .../streams/kstream/internals/KTableAggregate.java | 118 ++++++++
 .../streams/kstream/internals/KTableImpl.java      | 215 ++++++++------
 .../streams/kstream/internals/KTableMapValues.java |   8 +-
 .../kstream/internals/KTableRepartitionMap.java    | 110 ++++++++
 .../streams/kstream/internals/LongSumSupplier.java |  52 ++++
 .../kstream/internals/WindowedDeserializer.java    |  59 ++++
 .../kstream/internals/WindowedSerializer.java      |  57 ++++
 .../kstream/internals/KTableAggregateTest.java     | 122 ++++++++
 .../kstream/internals/KTableMapValuesImplTest.java | 308 ---------------------
 .../kstream/internals/KTableMapValuesTest.java     | 308 +++++++++++++++++++++
 .../org/apache/kafka/test/NoOpKeyValueMapper.java  |  29 ++
 18 files changed, 1195 insertions(+), 591 deletions(-)
70011747c85337817497bc005ac9ea191d8688e3

 docs/configuration.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d61543e3219c5d820d1b38ccd063501da0966ba6

 docs/ops.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
836cb1963330a9e342379899e0fe52b72347736e

 .../java/org/apache/kafka/common/utils/Utils.java  | 23 ++++++
 .../main/scala/kafka/server/OffsetCheckpoint.scala | 82 ++++++++++++----------
 .../main/scala/kafka/server/ReplicaManager.scala   |  6 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 18 ++---
 4 files changed, 78 insertions(+), 51 deletions(-)
72eebad43d5aaf4bbd29532eedc2a793fc3ee9d5

 .../scala/kafka/admin/ZkSecurityMigrator.scala     | 26 +++++++++++++---
 .../kafka/security/auth/ZkAuthorizationTest.scala  | 36 ++++++++++++++--------
 2 files changed, 46 insertions(+), 16 deletions(-)
3e5afbfa0dd4ddfca65fae1f3b2a268ae1ed2025

 tests/kafkatest/services/kafka_log4j_appender.py   | 12 ++++++--
 tests/kafkatest/tests/log4j_appender_test.py       | 17 +++++++---
 .../kafka/tools/VerifiableLog4jAppender.java       | 36 ++++++++++++++++++++--
 3 files changed, 56 insertions(+), 9 deletions(-)
2adeb214b1e366e36deef045f8049406f7b3773d

 .../kafka/log4jappender/KafkaLog4jAppender.java    | 42 ++++++++++++++++++++--
 1 file changed, 40 insertions(+), 2 deletions(-)
c9114488b3c266fe60cf96426bfa143b4b8109c0

 .../java/org/apache/kafka/common/metrics/MetricConfig.java    | 11 -----------
 1 file changed, 11 deletions(-)
e789a35d3bce916f25705915b5e86353462a1454

 .../scala/kafka/controller/ReplicaStateMachine.scala     | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)
f009c30947c49fec4f41efcc31b9d5d72b6f7f37

 build.gradle               | 163 ++++++++++++++++++++++-----------------------
 gradle/dependencies.gradle |  93 ++++++++++++++++++++++++++
 scala.gradle               |  41 ------------
 settings.gradle            |   1 -
 4 files changed, 171 insertions(+), 127 deletions(-)
9c998dd8cd4a489512b6ed34a05afce88a0b1ba2

 .../src/main/java/org/apache/kafka/common/protocol/Errors.java    | 7 +++++++
 core/src/main/scala/kafka/api/OffsetResponse.scala                | 2 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala                 | 4 ++--
 core/src/main/scala/kafka/coordinator/GroupMetadataManager.scala  | 6 +++---
 .../src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala                  | 8 ++++----
 6 files changed, 18 insertions(+), 11 deletions(-)
3a0fc125f4337a670ea52009afb1a254179ac07b

 core/src/main/scala/kafka/admin/TopicCommand.scala | 45 ++++++++++------
 .../scala/unit/kafka/admin/TopicCommandTest.scala  | 60 ++++++++++++++++++++++
 2 files changed, 89 insertions(+), 16 deletions(-)
7059158c48ec05288c0b45ccac05d62b38f1bf76

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java   | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
3e1290c6928a6001263acfd7181bd768b231afc0

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
c355f0c3528c3f59fc97fab489cb6c5df43d96e4

 docs/security.html | 63 +++++++++++++++++++++++++++---------------------------
 1 file changed, 32 insertions(+), 31 deletions(-)
36f5c46a5cf510001a4990db6199beb37f215007

 docs/security.html | 63 +++++++++++++++++++++++++++---------------------------
 1 file changed, 32 insertions(+), 31 deletions(-)
8d674857996667bce52a804feb6108a6903eb39b

 README.md    | 16 +++++++++++-----
 build.gradle | 20 ++++++++++++--------
 2 files changed, 23 insertions(+), 13 deletions(-)
58def1cba022987b83e9bc72588aaee0c1965f77

 .../java/org/apache/kafka/connect/runtime/Worker.java   | 17 +++++++++++------
 1 file changed, 11 insertions(+), 6 deletions(-)
ccdf552749135b2c40f5a0afb4aa121115165ed2

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 docs/upgrade.html                                  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
49778b18446d691321026415aeaac1b265057ece

 tests/kafkatest/services/kafka/kafka.py            |  5 +-
 .../services/kafka/templates/kafka.properties      |  4 ++
 tests/kafkatest/services/security/kafka_acls.py    | 75 ++++++++++++++++++++++
 tests/kafkatest/tests/produce_consume_validate.py  |  2 +-
 .../tests/security_rolling_upgrade_test.py         | 14 ++--
 .../tests/zookeeper_security_upgrade_test.py       | 29 ++++++---
 6 files changed, 115 insertions(+), 14 deletions(-)
40d731b8712950122915795acca43886851a73b6

 .../apache/kafka/streams/examples/KStreamJob.java  |   2 +-
 .../apache/kafka/streams/examples/KTableJob.java   | 111 +++++++++++++++++++++
 .../apache/kafka/streams/kstream/Aggregator.java   |  42 ++++++++
 .../kafka/streams/kstream/AggregatorSupplier.java  |  23 +++++
 .../kafka/streams/kstream/HoppingWindows.java      |  79 +++++++++++++++
 .../kafka/streams/kstream/JoinWindowSpec.java      |  91 -----------------
 .../apache/kafka/streams/kstream/JoinWindows.java  | 110 ++++++++++++++++++++
 .../org/apache/kafka/streams/kstream/KStream.java  |  89 +++++++++++++++--
 .../kafka/streams/kstream/KStreamBuilder.java      |   6 +-
 .../kafka/streams/kstream/KStreamWindowed.java     |  38 -------
 .../org/apache/kafka/streams/kstream/KTable.java   |  90 ++++++++++++++++-
 .../streams/kstream/KeyValueToDoubleMapper.java    |  23 +++++
 .../kafka/streams/kstream/KeyValueToIntMapper.java |  23 +++++
 .../streams/kstream/KeyValueToLongMapper.java      |  23 +++++
 .../kafka/streams/kstream/SlidingWindows.java      |  67 +++++++++++++
 .../kafka/streams/kstream/TransformerSupplier.java |   1 -
 .../kafka/streams/kstream/UnlimitedWindows.java    |  63 ++++++++++++
 .../org/apache/kafka/streams/kstream/Window.java   |  51 ++++++++++
 .../org/apache/kafka/streams/kstream/Windowed.java |  38 +++++++
 .../org/apache/kafka/streams/kstream/Windows.java  |  80 +++++++++++++++
 .../internals/DefaultWindowedDeserializer.java     |  59 +++++++++++
 .../internals/DefaultWindowedSerializer.java       |  57 +++++++++++
 .../streams/kstream/internals/HoppingWindow.java   |  37 +++++++
 .../streams/kstream/internals/KStreamImpl.java     | 111 ++++++++++++++++-----
 .../streams/kstream/internals/KTableImpl.java      |  69 +++++++++++++
 .../streams/kstream/internals/SlidingWindow.java   |  38 +++++++
 .../streams/kstream/internals/TopKSupplier.java    | 106 ++++++++++++++++++++
 .../streams/kstream/internals/UnlimitedWindow.java |  37 +++++++
 .../kafka/streams/kstream/KStreamBuilderTest.java  |   6 +-
 .../kstream/internals/KStreamBranchTest.java       |   2 +-
 .../kstream/internals/KStreamFilterTest.java       |   4 +-
 .../kstream/internals/KStreamFlatMapTest.java      |   2 +-
 .../internals/KStreamFlatMapValuesTest.java        |   2 +-
 .../streams/kstream/internals/KStreamImplTest.java |  33 +++++-
 .../kstream/internals/KStreamKStreamJoinTest.java  |  20 ++--
 .../internals/KStreamKStreamLeftJoinTest.java      |  14 +--
 .../internals/KStreamKTableLeftJoinTest.java       |   4 +-
 .../streams/kstream/internals/KStreamMapTest.java  |   2 +-
 .../kstream/internals/KStreamMapValuesTest.java    |   2 +-
 .../kstream/internals/KStreamTransformTest.java    |   2 +-
 .../internals/KStreamTransformValuesTest.java      |   2 +-
 41 files changed, 1456 insertions(+), 203 deletions(-)
4836e525c851640e0da9d8d11321621a2c70e8f0

 .../kafka/streams/processor/StreamPartitioner.java | 59 +++++++++++++++++
 .../kafka/streams/processor/TopologyBuilder.java   | 73 +++++++++++++++++++++-
 .../processor/internals/RecordCollector.java       | 17 ++++-
 .../streams/processor/internals/SinkNode.java      |  7 ++-
 .../processor/internals/ProcessorTopologyTest.java | 45 ++++++++-----
 .../streams/state/KeyValueStoreTestDriver.java     |  6 ++
 .../org/apache/kafka/test/KStreamTestDriver.java   | 11 ++++
 .../kafka/test/ProcessorTopologyTestDriver.java    |  7 ++-
 8 files changed, 203 insertions(+), 22 deletions(-)
2861665d15a5e47cc75130b8a4633a976664d232

 config/server.properties                             | 16 ++++++----------
 core/src/main/scala/kafka/server/KafkaConfig.scala   |  6 +++---
 core/src/test/scala/unit/kafka/utils/TestUtils.scala |  3 ++-
 docs/upgrade.html                                    |  1 +
 4 files changed, 12 insertions(+), 14 deletions(-)
ee1770e00e841ba68dc25f03a8d3f2ac647b0eb3

 config/server.properties                             | 16 ++++++----------
 core/src/main/scala/kafka/server/KafkaConfig.scala   |  6 +++---
 core/src/test/scala/unit/kafka/utils/TestUtils.scala |  5 +++--
 docs/upgrade.html                                    |  1 +
 4 files changed, 13 insertions(+), 15 deletions(-)
a9ff3f2eced76a0aa13804439101c2897916e250

 .../common/errors/AuthorizationException.java      |   4 +
 .../errors/ClusterAuthorizationException.java      |  26 ++++
 .../common/errors/CorruptRecordException.java      |   6 +-
 .../common/errors/InvalidFetchSizeException.java   |  27 ++++
 .../common/errors/InvalidOffsetException.java      |  37 +++++
 .../common/errors/LeaderNotAvailableException.java |   8 +-
 .../common/errors/OffsetMetadataTooLarge.java      |   4 +-
 .../common/errors/OffsetOutOfRangeException.java   |  36 +++++
 .../errors/ReplicaNotAvailableException.java       |  36 +++++
 .../org/apache/kafka/common/protocol/Errors.java   |  24 +--
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  22 +--
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |   6 +-
 .../kafka/api/ControlledShutdownRequest.scala      |   6 +-
 .../kafka/api/ControlledShutdownResponse.scala     |   5 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   6 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |   7 +-
 .../scala/kafka/api/GroupCoordinatorRequest.scala  |   7 +-
 .../scala/kafka/api/GroupCoordinatorResponse.scala |  10 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |  10 +-
 .../scala/kafka/api/OffsetCommitResponse.scala     |   9 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |  10 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |  10 +-
 core/src/main/scala/kafka/api/OffsetResponse.scala |   7 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   6 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |   6 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  |  39 ++---
 .../scala/kafka/api/TopicMetadataRequest.scala     |   5 +-
 .../scala/kafka/api/UpdateMetadataRequest.scala    |  10 +-
 .../scala/kafka/api/UpdateMetadataResponse.scala   |  10 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |  11 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  11 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   2 +-
 .../kafka/common/OffsetMetadataAndError.scala      |   2 +-
 core/src/main/scala/kafka/common/Topic.scala       |  11 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  23 +--
 .../scala/kafka/controller/KafkaController.scala   |   1 +
 .../kafka/coordinator/GroupMetadataManager.scala   |  44 +++---
 core/src/main/scala/kafka/log/FileMessageSet.scala |  73 +++++-----
 core/src/main/scala/kafka/log/Log.scala            | 161 +++++++++++----------
 core/src/main/scala/kafka/log/LogSegment.scala     |  69 ++++-----
 .../kafka/message/InvalidMessageException.scala    |  11 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  17 ++-
 .../kafka/producer/async/DefaultEventHandler.scala |   8 +-
 .../scala/kafka/security/auth/ResourceType.scala   |   9 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   5 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |   3 +-
 .../main/scala/kafka/server/DelayedProduce.scala   |  12 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  66 +++++----
 core/src/main/scala/kafka/server/KafkaServer.scala |  12 +-
 .../main/scala/kafka/server/MetadataCache.scala    |   8 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  37 ++---
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |  12 +-
 .../kafka/tools/ReplicaVerificationTool.scala      |   7 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |   2 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |  21 +--
 .../test/scala/other/kafka/TestOffsetManager.scala |   9 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   3 +-
 .../api/RequestResponseSerializationTest.scala     |  18 +--
 .../test/scala/unit/kafka/common/TopicTest.scala   |   2 +-
 .../kafka/integration/BaseTopicMetadataTest.scala  |  27 ++--
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  19 +--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  22 +--
 .../unit/kafka/producer/AsyncProducerTest.scala    |  11 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |   5 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  22 +--
 .../unit/kafka/server/LeaderElectionTest.scala     |  13 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   9 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  51 +++----
 68 files changed, 727 insertions(+), 521 deletions(-)
991cafe4d4d1875ce40c31fbb54ba3930a826e62

 build.gradle | 275 ++++++++---------------------------------------------------
 1 file changed, 37 insertions(+), 238 deletions(-)
00114dae7a0ecb361aa5b843d5c7a95381294bd2

 .../main/scala/kafka/api/StopReplicaRequest.scala  | 126 ---------------------
 .../main/scala/kafka/api/StopReplicaResponse.scala |  75 ------------
 .../main/scala/kafka/network/RequestChannel.scala  |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |  29 +++--
 .../main/scala/kafka/server/ReplicaManager.scala   |  21 ++--
 .../api/RequestResponseSerializationTest.scala     |  16 +--
 6 files changed, 31 insertions(+), 237 deletions(-)
d9cabfde6cd94fa62ed698d14321e7f1494933c0

 bin/zookeeper-server-stop.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
85039ab43664577524bf99453cf2b972d3724f60

 .../common/network/SslTransportLayerTest.java      | 24 ++++++++++++----------
 .../java/org/apache/kafka/test/TestSslUtils.java   |  9 ++++++--
 2 files changed, 20 insertions(+), 13 deletions(-)
5aad4999d1a1d35d61365ff57a9b79a6af3e70d2

 .../kafka/streams/kstream/JoinWindowSpec.java      |  91 ++++
 .../org/apache/kafka/streams/kstream/KStream.java  |  97 +++-
 .../streams/kstream/SlidingWindowSupplier.java     | 266 -----------
 .../org/apache/kafka/streams/kstream/Window.java   |  36 --
 .../kafka/streams/kstream/WindowSupplier.java      |  25 -
 .../streams/kstream/internals/KStreamImpl.java     | 147 +++++-
 .../streams/kstream/internals/KStreamJoin.java     |  84 ----
 .../kstream/internals/KStreamJoinWindow.java       |  58 +++
 .../kstream/internals/KStreamKStreamJoin.java      |  73 +++
 .../streams/kstream/internals/KStreamWindow.java   |  68 ---
 .../kstream/internals/KStreamWindowedImpl.java     |  67 ---
 .../streams/state/RocksDBWindowStoreSupplier.java  |   2 +-
 .../streams/kstream/internals/KStreamImplTest.java |  68 +--
 .../streams/kstream/internals/KStreamJoinTest.java | 195 --------
 .../kstream/internals/KStreamKStreamJoinTest.java  | 505 +++++++++++++++++++++
 .../internals/KStreamKStreamLeftJoinTest.java      | 289 ++++++++++++
 .../kstream/internals/KStreamWindowedTest.java     |  91 ----
 .../org/apache/kafka/test/UnlimitedWindowDef.java  | 104 -----
 18 files changed, 1266 insertions(+), 1000 deletions(-)
4ea3803317c8f997a70a3472bd4576213f2ee979

 core/src/main/scala/kafka/controller/ReplicaStateMachine.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a788c65f02ae493abc27fe63c6d181e6a9b8edfe

 core/src/main/scala/kafka/controller/ReplicaStateMachine.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
25fa39d5ef751ce5a79ff25f70203724d4272504

 build.gradle | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
b098f677aec998600f42529b0755b8fd39e777ff

 core/src/main/scala/kafka/tools/EndToEndLatency.scala     | 2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala         | 4 ++--
 core/src/main/scala/kafka/tools/ProducerPerformance.scala | 4 +---
 3 files changed, 4 insertions(+), 6 deletions(-)
870cd3607f639a54b646d31110660e2f6fcc9898

 .../common/ZkNodeChangeNotificationListener.scala  | 36 +++++++++++++++-------
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  7 +++--
 2 files changed, 29 insertions(+), 14 deletions(-)
c44c898ec835bb16950137f831cbc18c6b8b82f5

 .../common/ZkNodeChangeNotificationListener.scala  | 36 +++++++++++++++-------
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  7 +++--
 2 files changed, 29 insertions(+), 14 deletions(-)
2a9869e91362ad8e28d54382592dde14583dcba8

 core/src/main/scala/kafka/server/KafkaApis.scala | 31 +++++++++++-------------
 1 file changed, 14 insertions(+), 17 deletions(-)
5db147c1d453c9dabcc277bd95435f17201b9c1c

 core/src/main/scala/kafka/server/KafkaApis.scala | 31 +++++++++++-------------
 1 file changed, 14 insertions(+), 17 deletions(-)
23d607dc2174f8d2202d438fa65e03e951591fcd

 .../kafka/clients/producer/ProducerConfig.java     |  4 +--
 config/producer.properties                         | 40 +++++++++-------------
 .../main/scala/kafka/producer/BaseProducer.scala   |  3 +-
 3 files changed, 19 insertions(+), 28 deletions(-)
b0b3e5aebf381faf81bd9454ef7b448e2ad922c7

 .../streams/state/KeyValueStoreChangeLogger.java   |  87 ---
 .../kafka/streams/state/MeteredKeyValueStore.java  |  18 +-
 .../kafka/streams/state/MeteredWindowStore.java    | 200 ++++++
 .../apache/kafka/streams/state/RocksDBStore.java   |  22 +-
 .../kafka/streams/state/RocksDBWindowStore.java    | 283 +++++++++
 .../streams/state/RocksDBWindowStoreSupplier.java  |  60 ++
 .../kafka/streams/state/StoreChangeLogger.java     |  91 +++
 .../apache/kafka/streams/state/WindowStore.java    |  36 ++
 .../kafka/streams/state/WindowStoreIterator.java   |  26 +
 .../kafka/streams/state/WindowStoreUtil.java       |  55 ++
 .../streams/state/KeyValueStoreTestDriver.java     |  22 +-
 .../streams/state/RocksDBWindowStoreTest.java      | 672 +++++++++++++++++++++
 .../org/apache/kafka/streams/state/StateUtils.java |  28 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |   2 +-
 .../apache/kafka/test/MockProcessorContext.java    |  46 +-
 15 files changed, 1498 insertions(+), 150 deletions(-)
5b5f002fceee7c1b16298b0eaf176ca49d98c025

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 ++
 1 file changed, 2 insertions(+)
4a236945ec85c823e19f9e25db38875533bb98c0

 .../java/org/apache/kafka/clients/ClientUtils.java |  3 +-
 .../apache/kafka/clients/CommonClientConfigs.java  | 16 +++++++-
 .../apache/kafka/common/config/SaslConfigs.java    |  5 +--
 .../org/apache/kafka/common/config/SslConfigs.java | 13 +++---
 .../apache/kafka/common/network/KafkaChannel.java  | 18 +++------
 .../kafka/common/protocol/SecurityProtocol.java    | 47 +++++++++++++++++-----
 .../kafka/common/network/SslSelectorTest.java      |  2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  6 ++-
 8 files changed, 69 insertions(+), 41 deletions(-)
57df460f8d7b225509dd8c061a5b6efa65c8ac9c

 .../java/org/apache/kafka/clients/ClientUtils.java |  3 +-
 .../apache/kafka/clients/CommonClientConfigs.java  | 16 +++++++-
 .../apache/kafka/common/config/SaslConfigs.java    |  5 +--
 .../org/apache/kafka/common/config/SslConfigs.java | 13 +++---
 .../apache/kafka/common/network/KafkaChannel.java  | 18 +++------
 .../kafka/common/protocol/SecurityProtocol.java    | 47 +++++++++++++++++-----
 .../kafka/common/network/SslSelectorTest.java      |  2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  6 ++-
 8 files changed, 69 insertions(+), 41 deletions(-)
b93f48f7494e1db4d564b6c28772712ee7681620

 build.gradle                                       |   2 +
 checkstyle/import-control.xml                      |   2 +
 config/connect-file-sink.properties                |   2 +-
 config/connect-file-source.properties              |   2 +-
 .../kafka/connect/runtime/ConnectorConfig.java     |   6 +-
 .../org/apache/kafka/connect/runtime/Worker.java   |  64 ++++++++++--
 .../runtime/distributed/DistributedHerder.java     |   4 +-
 .../apache/kafka/connect/runtime/WorkerTest.java   | 115 ++++++++++++++++++++-
 .../runtime/distributed/DistributedHerderTest.java |   2 +
 .../tests/templates/connect-file-sink.properties   |   2 +-
 .../tests/templates/connect-file-source.properties |   2 +-
 11 files changed, 181 insertions(+), 22 deletions(-)
71868da5c527473890d583eebb0c7c1e1849cd20

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
80030022da29a30e70171083de2d4f9cd470eb2a

 core/src/main/scala/kafka/admin/AclCommand.scala   |  6 ++-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  | 15 +++++---
 core/src/main/scala/kafka/server/KafkaConfig.scala | 45 +++++++---------------
 .../scala/unit/kafka/admin/AclCommandTest.scala    |  2 +-
 4 files changed, 28 insertions(+), 40 deletions(-)
f9642e2a9878faff81366dbc885a206727bd7c7b

 core/src/main/scala/kafka/admin/AclCommand.scala   |  6 ++-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  | 15 +++++---
 core/src/main/scala/kafka/server/KafkaConfig.scala | 45 +++++++---------------
 .../scala/unit/kafka/admin/AclCommandTest.scala    |  2 +-
 4 files changed, 28 insertions(+), 40 deletions(-)
e32ef73a5aee780aad57e41a881a01fe9e557cc0

 .../main/java/org/apache/kafka/connect/json/JsonConverter.java |  2 +-
 .../java/org/apache/kafka/connect/json/JsonConverterTest.java  | 10 ++++++----
 2 files changed, 7 insertions(+), 5 deletions(-)
2679524604b611046e9826b2a1fba461d42f06f4

 .../main/java/org/apache/kafka/connect/json/JsonConverter.java |  2 +-
 .../java/org/apache/kafka/connect/json/JsonConverterTest.java  | 10 ++++++----
 2 files changed, 7 insertions(+), 5 deletions(-)
b905d489188768ba1c55226857db9713b9272918

 .../kafka/api/EndToEndAuthorizationTest.scala      | 40 ++++++++++++++++------
 .../kafka/api/IntegrationTestHarness.scala         |  3 +-
 2 files changed, 31 insertions(+), 12 deletions(-)
e11946b097ed617b6de78909dbd9f6e44765c1fd

 docs/design.html         | 30 +++++++++++++++---------------
 docs/implementation.html |  2 +-
 2 files changed, 16 insertions(+), 16 deletions(-)
9f33bfe19cd7841b03ff60c84148fe309555b58a

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d9ddc109fd360d5deb2894ad73cb9e12e2f8edbf

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 docs/configuration.html                            | 4 ++--
 docs/design.html                                   | 6 +++---
 3 files changed, 6 insertions(+), 6 deletions(-)
b0a4a57c56cf5691aaf0e11a3ddf4c6d067994f7

 docs/ops.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ca7c76b2632bceaddacb5e6167e84904fd6f58f9

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
767de4b5d1767110c097a754d697a3a762b0aaea

 clients/src/main/java/org/apache/kafka/common/utils/Utils.java     | 2 +-
 clients/src/test/java/org/apache/kafka/common/utils/UtilsTest.java | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)
ea73356905ff4663d0d085c46b348fa4e9b9568d

 clients/src/main/java/org/apache/kafka/common/utils/Utils.java     | 2 +-
 clients/src/test/java/org/apache/kafka/common/utils/UtilsTest.java | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)
83d4c359bab40ce7418cd5f7219a23a9fcfba921

 core/src/main/scala/kafka/coordinator/GroupMetadataManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
07ee17fd05900101ad2ebc7210f94b05e230bf83

 .reviewboardrc          |   3 -
 build.gradle            |   3 +-
 dev-utils/test-patch.py | 466 ------------------------------------------------
 kafka-patch-review.py   | 213 ----------------------
 4 files changed, 1 insertion(+), 684 deletions(-)
0f11b2b8251a3905a93cfe84abefd24791ae3658

 build.gradle | 2 --
 1 file changed, 2 deletions(-)
ba6f141dd78b3dfeafb2088f8acb6dcf65468b19

 core/src/main/scala/kafka/server/KafkaApis.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
bde49e3711a45721a0d1df9acf3ce2e5a8f990e9

 .../java/org/apache/kafka/connect/file/FileStreamSinkTaskTest.java   | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
976fa192d45243d2da3eb7e1d6fa1ce0fdda1fd2

 tests/kafkatest/services/verifiable_consumer.py   |  12 +-
 tests/kafkatest/tests/consumer_rolling_upgrade.py |  32 +---
 tests/kafkatest/tests/consumer_test.py            | 218 ++++++++++------------
 tests/kafkatest/tests/verifiable_consumer_test.py |  83 ++++++++
 4 files changed, 194 insertions(+), 151 deletions(-)
00ba8e0002d9f4c32f7149bcf853fb78a157c088

 docs/design.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
a6889a2bf94cb326247b5076f474337fbadfadf4

 docs/design.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
64b746bd8b4dae17d7dd804f0e7161f304e2d8ee

 build.gradle                                       |  15 +-
 checkstyle/import-control-core.xml                 |  69 ++
 .../kafka/javaapi/consumer/ConsumerConnector.java  | 112 +--
 .../main/scala/kafka/tools/KafkaMigrationTool.java | 797 +++++++++++----------
 .../src/main/java/kafka/examples/Consumer.java     |  74 +-
 .../kafka/examples/KafkaConsumerProducerDemo.java  |  22 +-
 .../main/java/kafka/examples/KafkaProperties.java  |  31 +-
 .../src/main/java/kafka/examples/Producer.java     | 138 ++--
 .../java/kafka/examples/SimpleConsumerDemo.java    | 110 +--
 9 files changed, 720 insertions(+), 648 deletions(-)
a0d21407cbdd3b7cb73f52c986aa2f60804618e7

 checkstyle/checkstyle.xml                          |  1 +
 .../kafka/clients/producer/KafkaProducer.java      |  6 +++++-
 .../kafka/clients/producer/MockProducer.java       |  6 +++++-
 .../main/java/org/apache/kafka/common/Cluster.java |  8 +++++++-
 .../apache/kafka/common/config/AbstractConfig.java |  8 +++++++-
 .../org/apache/kafka/common/network/Selector.java  | 16 +++++++++++++--
 .../org/apache/kafka/common/protocol/Errors.java   | 24 +++++++++++++++++++++-
 .../requests/ControlledShutdownResponse.java       |  5 ++++-
 .../kafka/common/requests/LeaderAndIsrRequest.java |  7 ++++++-
 .../kafka/common/requests/StopReplicaRequest.java  |  7 ++++++-
 .../kafka/common/requests/StopReplicaResponse.java |  5 ++++-
 .../common/requests/UpdateMetadataRequest.java     |  8 +++++++-
 .../kafka/common/security/ssl/SslFactory.java      |  9 ++++++--
 .../org/apache/kafka/clients/MetadataTest.java     |  7 ++++++-
 .../clients/producer/internals/BufferPoolTest.java |  4 +++-
 .../apache/kafka/common/network/SelectorTest.java  |  1 -
 .../kafka/common/record/MemoryRecordsTest.java     |  6 +++++-
 .../kafka/common/security/ssl/SslFactoryTest.java  |  6 +++---
 .../kafka/common/utils/AbstractIteratorTest.java   |  6 +++++-
 .../org/apache/kafka/common/utils/UtilsTest.java   |  2 +-
 .../java/org/apache/kafka/test/TestSslUtils.java   | 11 +++++++++-
 .../apache/kafka/connect/data/ConnectSchema.java   |  6 +++++-
 .../kafka/connect/file/FileStreamSourceTask.java   | 14 ++++++++++---
 .../apache/kafka/connect/json/JsonConverter.java   | 11 +++++++++-
 .../org/apache/kafka/connect/runtime/Worker.java   |  6 +++++-
 .../connect/storage/FileOffsetBackingStore.java    |  9 +++++++-
 .../kafka/connect/storage/OffsetStorageWriter.java |  4 +++-
 .../connect/runtime/WorkerSourceTaskTest.java      | 12 +++++++++--
 .../connect/storage/OffsetStorageWriterTest.java   |  7 ++++++-
 .../apache/kafka/tools/ProducerPerformance.java    |  8 ++++++--
 30 files changed, 193 insertions(+), 37 deletions(-)
40acb999ffaefc0ba5ca7a6588e357e2dbef2732

 .../main/java/org/apache/kafka/clients/NetworkClient.java    | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)
fa4ffb8767da18b2b84ef3d3cbeb2d4c5b804dbe

 .../main/java/org/apache/kafka/clients/NetworkClient.java    | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)
4f2d172a3eaa285fe929218e8826b6450177e9d6

 core/src/test/scala/unit/kafka/metrics/MetricsTest.scala | 3 +++
 1 file changed, 3 insertions(+)
e32131ed6fcfaea7e56295ea0b6ddbf8c804460f

 core/src/test/scala/unit/kafka/metrics/MetricsTest.scala | 3 +++
 1 file changed, 3 insertions(+)
9765354c857bec8ab7625854f2fb68e0fad6c339

 .../scala/unit/kafka/log/LogCleanerIntegrationTest.scala    | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)
d2632d011f7bda3cbd0cbcc8f2a3bd1e985d5b1b

 .../scala/unit/kafka/log/LogCleanerIntegrationTest.scala    | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)
d5698fa3108ec46a686fe4a67320e126c79f08cb

 core/src/test/scala/unit/kafka/producer/ProducerTest.scala |  1 +
 core/src/test/scala/unit/kafka/utils/TestUtils.scala       | 10 ++++++++++
 2 files changed, 11 insertions(+)
3615e4773dd20327dead494cd0ba6a26edada92d

 core/src/test/scala/unit/kafka/producer/ProducerTest.scala |  1 +
 core/src/test/scala/unit/kafka/utils/TestUtils.scala       | 10 ++++++++++
 2 files changed, 11 insertions(+)
8c754c45af57a3249232268c6093cb4f50e1d45f

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 2 +-
 .../apache/kafka/clients/consumer/internals/ConsumerProtocol.java | 8 ++++----
 .../main/java/org/apache/kafka/common/protocol/ProtoUtils.java    | 6 +++---
 .../main/java/org/apache/kafka/common/protocol/types/Schema.java  | 8 ++++++--
 .../apache/kafka/common/requests/ControlledShutdownRequest.java   | 2 +-
 .../apache/kafka/common/requests/ControlledShutdownResponse.java  | 2 +-
 .../org/apache/kafka/common/requests/DescribeGroupsRequest.java   | 2 +-
 .../org/apache/kafka/common/requests/DescribeGroupsResponse.java  | 2 +-
 .../main/java/org/apache/kafka/common/requests/FetchRequest.java  | 2 +-
 .../main/java/org/apache/kafka/common/requests/FetchResponse.java | 4 ++--
 .../org/apache/kafka/common/requests/GroupCoordinatorRequest.java | 2 +-
 .../apache/kafka/common/requests/GroupCoordinatorResponse.java    | 4 ++--
 .../java/org/apache/kafka/common/requests/HeartbeatRequest.java   | 4 ++--
 .../java/org/apache/kafka/common/requests/HeartbeatResponse.java  | 4 ++--
 .../java/org/apache/kafka/common/requests/JoinGroupRequest.java   | 2 +-
 .../java/org/apache/kafka/common/requests/JoinGroupResponse.java  | 4 ++--
 .../org/apache/kafka/common/requests/LeaderAndIsrRequest.java     | 2 +-
 .../org/apache/kafka/common/requests/LeaderAndIsrResponse.java    | 2 +-
 .../java/org/apache/kafka/common/requests/LeaveGroupRequest.java  | 2 +-
 .../java/org/apache/kafka/common/requests/LeaveGroupResponse.java | 4 ++--
 .../java/org/apache/kafka/common/requests/ListGroupsRequest.java  | 2 +-
 .../java/org/apache/kafka/common/requests/ListGroupsResponse.java | 2 +-
 .../java/org/apache/kafka/common/requests/ListOffsetRequest.java  | 2 +-
 .../java/org/apache/kafka/common/requests/ListOffsetResponse.java | 2 +-
 .../java/org/apache/kafka/common/requests/MetadataRequest.java    | 2 +-
 .../java/org/apache/kafka/common/requests/MetadataResponse.java   | 4 ++--
 .../org/apache/kafka/common/requests/OffsetCommitRequest.java     | 4 ++--
 .../org/apache/kafka/common/requests/OffsetCommitResponse.java    | 2 +-
 .../java/org/apache/kafka/common/requests/OffsetFetchRequest.java | 2 +-
 .../org/apache/kafka/common/requests/OffsetFetchResponse.java     | 2 +-
 .../java/org/apache/kafka/common/requests/ProduceRequest.java     | 2 +-
 .../java/org/apache/kafka/common/requests/ProduceResponse.java    | 2 +-
 .../main/java/org/apache/kafka/common/requests/RequestHeader.java | 2 +-
 .../java/org/apache/kafka/common/requests/ResponseHeader.java     | 2 +-
 .../java/org/apache/kafka/common/requests/StopReplicaRequest.java | 2 +-
 .../org/apache/kafka/common/requests/StopReplicaResponse.java     | 2 +-
 .../java/org/apache/kafka/common/requests/SyncGroupResponse.java  | 2 +-
 .../org/apache/kafka/common/requests/UpdateMetadataRequest.java   | 2 +-
 .../org/apache/kafka/common/requests/UpdateMetadataResponse.java  | 2 +-
 .../apache/kafka/connect/runtime/distributed/ConnectProtocol.java | 8 ++++----
 core/src/main/scala/kafka/coordinator/GroupMetadataManager.scala  | 6 +++---
 41 files changed, 64 insertions(+), 60 deletions(-)
9220df9f8b58870a2282d3e4ceb2e003667d854b

 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 14 +++-
 tests/kafkatest/services/console_consumer.py       |  5 ++
 tests/kafkatest/services/kafka/kafka.py            | 33 ++++++++-
 tests/kafkatest/tests/produce_consume_validate.py  | 80 ++++++++++++++--------
 .../tests/security_rolling_upgrade_test.py         | 37 +++++-----
 5 files changed, 119 insertions(+), 50 deletions(-)
a2a417caf9fa4f177e099fed7d2a9b8d1942a9d6

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java     | 8 ++++----
 .../java/org/apache/kafka/clients/producer/ProducerConfig.java    | 2 +-
 docs/design.html                                                  | 2 +-
 3 files changed, 6 insertions(+), 6 deletions(-)
587a2f4efd7994d4d3af82ed91304f939514294a

 .../kafka/streams/kstream/KStreamBuilder.java      |   4 +-
 .../kafka/streams/kstream/internals/Change.java    |  34 ++++
 .../streams/kstream/internals/KTableFilter.java    |  23 ++-
 .../streams/kstream/internals/KTableImpl.java      |  92 ++++++----
 .../internals/KTableKTableAbstractJoin.java        |  49 ++++++
 .../kstream/internals/KTableKTableJoin.java        |  38 ++--
 .../kstream/internals/KTableKTableJoinMerger.java  |  56 ++++++
 .../kstream/internals/KTableKTableLeftJoin.java    |  36 ++--
 .../kstream/internals/KTableKTableOuterJoin.java   |  34 ++--
 .../kstream/internals/KTableKTableRightJoin.java   |  33 ++--
 .../streams/kstream/internals/KTableMapValues.java |  23 ++-
 .../streams/kstream/internals/KTableMerge.java     |  92 ----------
 .../kstream/internals/KTableProcessorSupplier.java |   4 +-
 .../streams/kstream/internals/KTableSource.java    |  15 +-
 .../kstream/internals/KTableFilterTest.java        | 157 ++++++++++++++++-
 .../kstream/internals/KTableKTableJoinTest.java    | 180 +++++++++++++++++++
 .../internals/KTableKTableLeftJoinTest.java        | 180 +++++++++++++++++++
 .../internals/KTableKTableOuterJoinTest.java       | 196 +++++++++++++++++++++
 .../kstream/internals/KTableMapValuesImplTest.java | 110 ++++++++++++
 .../kstream/internals/KTableSourceTest.java        |  89 ++++++++++
 .../apache/kafka/test/MockProcessorSupplier.java   |   4 +-
 21 files changed, 1222 insertions(+), 227 deletions(-)
841d2d1a26af94ec95c480dbf2453f9c7d28c2f7

 .../streams/processor/internals/StreamThread.java  | 63 +++++++++++++---------
 1 file changed, 38 insertions(+), 25 deletions(-)
6533933371d82c7c8cbaa32edca9b85b3932e1bb

 docs/upgrade.html | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
4ad165c0783bc49e5750292cd0e8d277e3186846

 docs/upgrade.html | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
5df783f18e9a6a6e17960e3ef4b0a66f4d10d65c

 .../main/scala/kafka/server/ReplicaFetcherThread.scala    | 15 +++++++++------
 1 file changed, 9 insertions(+), 6 deletions(-)
fdac34e6ab2a7760c170f53556fec7dca8ee9b22

 .../org/apache/kafka/connect/runtime/HerderConnectorContext.java   | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
3432e85f664c5e3d8300171c314ea52b2f4b88fd

 core/src/main/scala/kafka/api/LeaderAndIsr.scala   |  93 ++++++++++
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala | 206 ---------------------
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |  75 --------
 core/src/main/scala/kafka/cluster/Partition.scala  |  34 ++--
 .../main/scala/kafka/network/RequestChannel.scala  |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |  24 ++-
 .../main/scala/kafka/server/ReplicaManager.scala   |  69 +++----
 .../api/RequestResponseSerializationTest.scala     |  26 +--
 8 files changed, 162 insertions(+), 366 deletions(-)
3f3358b6d4374662f5ca57c6e93e009b58a6b2a2

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 4 ++--
 .../kafka/clients/consumer/internals/ConsumerNetworkClient.java     | 2 +-
 clients/src/main/java/org/apache/kafka/common/cache/Cache.java      | 2 +-
 .../apache/kafka/common/errors/GroupLoadInProgressException.java    | 2 +-
 clients/src/main/java/org/apache/kafka/common/metrics/Stat.java     | 2 +-
 .../java/org/apache/kafka/common/metrics/stats/SampledStat.java     | 4 ++--
 clients/src/main/java/org/apache/kafka/common/network/Selector.java | 4 ++--
 .../main/java/org/apache/kafka/common/network/TransportLayer.java   | 2 +-
 clients/src/main/java/org/apache/kafka/common/utils/Utils.java      | 2 +-
 .../java/org/apache/kafka/common/network/SslTransportLayerTest.java | 2 +-
 clients/src/test/java/org/apache/kafka/test/TestSslUtils.java       | 2 +-
 .../main/java/org/apache/kafka/connect/runtime/WorkerSinkTask.java  | 2 +-
 .../kafka/connect/runtime/distributed/ClusterConfigState.java       | 2 +-
 .../apache/kafka/connect/runtime/distributed/DistributedHerder.java | 2 +-
 .../java/org/apache/kafka/connect/runtime/WorkerSinkTaskTest.java   | 2 +-
 core/src/main/scala/kafka/common/MessageStreamsExistException.scala | 2 +-
 core/src/main/scala/kafka/log/OffsetMap.scala                       | 2 +-
 core/src/main/scala/kafka/message/MessageLengthException.scala      | 2 +-
 core/src/main/scala/kafka/tools/ZooKeeperMainWrapper.scala          | 2 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala                     | 4 ++--
 core/src/main/scala/kafka/utils/ZkUtils.scala                       | 4 ++--
 .../test/scala/integration/kafka/api/PlaintextConsumerTest.scala    | 6 +++---
 core/src/test/scala/unit/kafka/log/LogSegmentTest.scala             | 2 +-
 .../src/test/scala/unit/kafka/message/BaseMessageSetTestCases.scala | 2 +-
 core/src/test/scala/unit/kafka/utils/TestUtils.scala                | 6 +++---
 25 files changed, 34 insertions(+), 34 deletions(-)
9545cc88348b78f66c1c7a891449caa35f322a74

 README.md | 33 ++++++++++++++++++++-------------
 1 file changed, 20 insertions(+), 13 deletions(-)
52a3e7b2781729fdb9f1f0767e65424f6479bb57

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 docs/upgrade.html                                  | 6 ++++--
 2 files changed, 5 insertions(+), 3 deletions(-)
9a0e16397e81323a3c93053ee473dfcdf3bcceb3

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 docs/upgrade.html                                  | 6 ++++--
 2 files changed, 5 insertions(+), 3 deletions(-)
901fe2eec272043236e149513b7cbce1b21f592d

 .../kafka/api/ProducerFailureHandlingTest.scala    | 24 +++++++++++-----------
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 2 files changed, 13 insertions(+), 13 deletions(-)
20b09694ada7d8393b0628cefa78e3b5c2b3ac21

 core/src/main/scala/kafka/utils/Pool.scala | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
f3fc9e108eb1e5d47144cc7f2eaa8beb4f88be6b

 core/src/main/scala/kafka/utils/Pool.scala | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
b352d7fbfc07cc14368c01005966924cc3a8d6fe

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
974e5aa2421890c6080de39762d6a36bcaaf1287

 .../kafka/clients/consumer/KafkaConsumer.java      |  4 +-
 .../kafka/clients/consumer/MockConsumer.java       |  6 +--
 .../kafka/clients/consumer/internals/Fetcher.java  | 51 ++++++++++------------
 .../consumer/internals/SubscriptionState.java      | 40 +++++------------
 .../clients/consumer/internals/FetcherTest.java    | 27 ++++--------
 .../consumer/internals/SubscriptionStateTest.java  | 29 +++---------
 6 files changed, 54 insertions(+), 103 deletions(-)
e08b922aad485a96fceb51d5c27877729156ddab

 .../kafka/clients/consumer/KafkaConsumer.java      |  4 +-
 .../kafka/clients/consumer/MockConsumer.java       |  6 +--
 .../kafka/clients/consumer/internals/Fetcher.java  | 51 ++++++++++------------
 .../consumer/internals/SubscriptionState.java      | 40 +++++------------
 .../clients/consumer/internals/FetcherTest.java    | 27 ++++--------
 .../consumer/internals/SubscriptionStateTest.java  | 29 +++---------
 6 files changed, 54 insertions(+), 103 deletions(-)
3fed57909c16f807715f305152a5034aeb1a5532

 .../src/test/scala/integration/kafka/api/ProducerBounceTest.scala | 6 +++---
 .../scala/integration/kafka/api/ProducerFailureHandlingTest.scala | 8 ++++----
 core/src/test/scala/unit/kafka/utils/TestUtils.scala              | 5 ++---
 3 files changed, 9 insertions(+), 10 deletions(-)
8071f105f63e356d0cc20150cbbe0dc8f3f6b1b0

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
fd8af25d0ae354e962850c9d6b5991056613aa2d

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
01f3e59ef91b348a5fab805bc6915591dd490a16

 .../kafka/common/requests/ListOffsetRequest.java   |  9 ++-
 .../main/scala/kafka/network/RequestChannel.scala  |  1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   | 66 +++++++++++++---------
 .../scala/unit/kafka/server/LogOffsetTest.scala    | 11 ++--
 4 files changed, 51 insertions(+), 36 deletions(-)
1dcafadefc09aece9037bc930aa0de7617f655b2

 .../streams/kstream/internals/KTableImplTest.java  | 87 ++++++++++++++++++++++
 .../org/apache/kafka/test/KStreamTestDriver.java   |  6 ++
 .../apache/kafka/test/MockProcessorContext.java    |  4 +
 3 files changed, 97 insertions(+)
98a093d6c97b322e2175ebdcd987dac7efe6bb1b

 core/src/test/scala/integration/kafka/api/SaslSetup.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
18d7abd899c5bdbbcde3be448f24458ed4f9a851

 tests/kafkatest/services/kafka/kafka.py            |  12 +-
 .../services/kafka/templates/log4j.properties      | 152 ++++++++++++++-------
 tests/kafkatest/services/verifiable_producer.py    |   1 -
 tests/kafkatest/tests/produce_consume_validate.py  |  16 ++-
 4 files changed, 118 insertions(+), 63 deletions(-)
a5f1537f8762f4787b2af106c5d93c156f906074

 tests/kafkatest/services/kafka/kafka.py           |  29 ++++++
 tests/kafkatest/tests/reassign_partitions_test.py | 109 ++++++++++++++++++++++
 2 files changed, 138 insertions(+)
a29f80dc74fcdfea4f92ed3c7d18e4978f809307

 tests/kafkatest/__init__.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ba09aef5355cad265941feefa60748261f55df03

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
882fe01284ef7d61e19e4a527fb7c18471a8c074

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
416210ec55fa0ca3dbda2b875feeb2db6ac38cc7

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java   |  3 +++
 .../apache/kafka/clients/consumer/KafkaConsumerTest.java   | 14 ++++++++++++++
 2 files changed, 17 insertions(+)
9d23b512ccb95940782f51c93bd6cdbed3e938db

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java   |  3 +++
 .../apache/kafka/clients/consumer/KafkaConsumerTest.java   | 14 ++++++++++++++
 2 files changed, 17 insertions(+)
7684f6dd88eaa5dfadb09709ab89f8c7e4d466a9

 clients/src/main/java/org/apache/kafka/clients/Metadata.java | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
ed8748b7d17448a215ebbf68749d311aae30d7f7

 clients/src/main/java/org/apache/kafka/clients/Metadata.java | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
3b350cdff795ec08dc77e60f127f2790149d8d52

 .../streams/kstream/internals/KTableImpl.java      |  28 ++-
 .../kstream/internals/KTableKTableJoin.java        |   9 +-
 .../kstream/internals/KTableKTableOuterJoin.java   | 112 ++++++++++++
 .../kstream/internals/KTableKTableRightJoin.java   | 113 ++++++++++++
 .../internals/KStreamKTableLeftJoinTest.java       | 171 +++++++++++++++++++
 .../kstream/internals/KTableKTableJoinTest.java    | 180 ++++++++++++++++++++
 .../internals/KTableKTableLeftJoinTest.java        | 189 +++++++++++++++++++++
 .../internals/KTableKTableOuterJoinTest.java       | 189 +++++++++++++++++++++
 .../org/apache/kafka/test/KStreamTestDriver.java   |   4 +
 .../apache/kafka/test/MockProcessorSupplier.java   |  13 ++
 10 files changed, 996 insertions(+), 12 deletions(-)
ec466d358dcd5ff9e035a6d5de82ada12d187ae0

 .../streams/processor/internals/StreamThread.java  | 16 +++++++++-------
 .../kafka/streams/state/MeteredKeyValueStore.java  | 22 +++++++++++-----------
 2 files changed, 20 insertions(+), 18 deletions(-)
a5fa661227b0b0b7da86b10b48e94bfb87d0b71d

 .../kafka/common/security/kerberos/LoginManager.java       |  2 +-
 .../src/test/java/org/apache/kafka/clients/MockClient.java | 14 +++++++-------
 .../kafka/clients/producer/internals/SenderTest.java       |  8 +++++++-
 .../java/org/apache/kafka/common/network/SelectorTest.java |  2 +-
 .../java/org/apache/kafka/connect/data/SchemaBuilder.java  |  2 +-
 5 files changed, 17 insertions(+), 11 deletions(-)
6e5bd2497af2b6bb67a47e4f3defa50da3cad4c7

 .../kafka/common/security/kerberos/LoginManager.java       |  2 +-
 .../src/test/java/org/apache/kafka/clients/MockClient.java | 14 +++++++-------
 .../kafka/clients/producer/internals/SenderTest.java       |  8 +++++++-
 .../java/org/apache/kafka/common/network/SelectorTest.java |  2 +-
 .../java/org/apache/kafka/connect/data/SchemaBuilder.java  |  2 +-
 5 files changed, 17 insertions(+), 11 deletions(-)
f7fc2853868caa3b8a044b6d5d52ce26ae2a3677

 docs/design.html       | 2 +-
 docs/introduction.html | 2 +-
 docs/ops.html          | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
83c1e33aa7ab2a69998847cb7869fdf0425bafdf

 .../kafka/common/requests/ControlledShutdownResponse.java   |  1 +
 .../apache/kafka/common/requests/RequestResponseTest.java   | 13 ++++++++++++-
 2 files changed, 13 insertions(+), 1 deletion(-)
7bb7e415a371909757a6099a911587047d4c4b69

 .../kafka/common/requests/ControlledShutdownResponse.java   |  1 +
 .../apache/kafka/common/requests/RequestResponseTest.java   | 13 ++++++++++++-
 2 files changed, 13 insertions(+), 1 deletion(-)
98ea82a8913b4d34e67a6c7e5fb6f149be6bec64

 clients/src/main/java/org/apache/kafka/common/MetricName.java | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
3fa0e12920061788fae87a1293ebcf5e863815ae

 core/src/main/scala/kafka/controller/KafkaController.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
f90670621c8fab3a60ee62ec428fcd0452178f1c

 clients/src/main/java/org/apache/kafka/common/metrics/Metrics.java     | 2 +-
 clients/src/test/java/org/apache/kafka/common/metrics/MetricsTest.java | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)
977ebbe9bafb6c1a6e1be69620f745712118fe80

 clients/src/main/java/org/apache/kafka/common/metrics/Metrics.java     | 2 +-
 clients/src/test/java/org/apache/kafka/common/metrics/MetricsTest.java | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)
991aad23baa2f55d405d374b0a01785acdc63974

 .../org/apache/kafka/streams/kstream/KStream.java  |  10 ++
 .../kafka/streams/kstream/KStreamBuilder.java      |   2 +-
 .../org/apache/kafka/streams/kstream/KTable.java   |  33 +++++
 .../streams/kstream/internals/AbstractStream.java  |  64 +++++++++
 .../streams/kstream/internals/KStreamImpl.java     |  35 +++--
 .../streams/kstream/internals/KStreamJoin.java     |   9 --
 .../kstream/internals/KStreamKTableLeftJoin.java   |  62 +++++++++
 .../kstream/internals/KStreamWindowedImpl.java     |   2 +-
 .../KTableDerivedValueGetterSupplier.java          |  28 ----
 .../streams/kstream/internals/KTableFilter.java    |  15 ++-
 .../streams/kstream/internals/KTableImpl.java      | 147 ++++++++++++++-------
 .../kstream/internals/KTableKTableJoin.java        | 115 ++++++++++++++++
 .../kstream/internals/KTableKTableLeftJoin.java    | 112 ++++++++++++++++
 .../streams/kstream/internals/KTableMapValues.java |  14 +-
 .../streams/kstream/internals/KTableMerge.java     |  92 +++++++++++++
 .../kstream/internals/KTableProcessorSupplier.java |   4 +-
 .../streams/kstream/internals/KTableSource.java    |   6 +-
 17 files changed, 634 insertions(+), 116 deletions(-)
78192b8becfe48b5fb63f750dde8eb2d12e65007

 .../kafka/coordinator/GroupMetadataManager.scala   |   6 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 123 ++++++++++++++++++---
 2 files changed, 111 insertions(+), 18 deletions(-)
454d7d09014c0e6be3064a120c80261998341fed

 .../kafka/coordinator/GroupMetadataManager.scala   |   6 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 123 ++++++++++++++++++---
 2 files changed, 111 insertions(+), 18 deletions(-)
ef92a8ae7479560b26edecfa8db79934065f13cf

 .../kafka/clients/consumer/KafkaConsumer.java      |  14 +--
 .../consumer/internals/AbstractCoordinator.java    |  51 +++-----
 .../consumer/internals/ConsumerCoordinator.java    |  28 ++---
 .../kafka/clients/consumer/internals/Fetcher.java  |  61 ++++-----
 .../kafka/clients/producer/KafkaProducer.java      |  15 ++-
 .../clients/producer/internals/BufferPool.java     |  11 +-
 .../producer/internals/RecordAccumulator.java      |  18 ++-
 .../kafka/clients/producer/internals/Sender.java   |  47 ++++---
 .../java/org/apache/kafka/common/MetricName.java   |  34 ++++-
 .../apache/kafka/common/metrics/MetricConfig.java  |  13 ++
 .../org/apache/kafka/common/metrics/Metrics.java   |  95 ++++++++++++++
 .../org/apache/kafka/common/network/Selector.java  |  50 ++++----
 .../internals/ConsumerCoordinatorTest.java         |   4 -
 .../clients/consumer/internals/FetcherTest.java    |   7 +-
 .../clients/producer/internals/BufferPoolTest.java |  13 +-
 .../producer/internals/RecordAccumulatorTest.java  |  22 ++--
 .../clients/producer/internals/SenderTest.java     |  38 +++---
 .../kafka/common/metrics/JmxReporterTest.java      |   9 +-
 .../apache/kafka/common/metrics/MetricsTest.java   | 140 +++++++++++----------
 .../apache/kafka/common/network/SelectorTest.java  |   2 +-
 .../kafka/common/network/SslSelectorTest.java      |   5 +-
 .../common/network/SslTransportLayerTest.java      |   7 +-
 .../java/org/apache/kafka/test/MetricsBench.java   |  11 +-
 .../runtime/distributed/WorkerCoordinator.java     |  23 ++--
 .../runtime/distributed/WorkerGroupMember.java     |  12 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |   3 -
 core/src/main/scala/kafka/admin/AdminClient.scala  |   1 -
 .../consumer/ZookeeperConsumerConnector.scala      |   9 ++
 .../main/scala/kafka/network/SocketServer.scala    |   4 +-
 .../scala/kafka/server/ClientQuotaManager.scala    |   6 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   9 ++
 core/src/main/scala/kafka/tools/JmxTool.scala      |   3 -
 .../scala/integration/kafka/api/QuotasTest.scala   |  32 ++---
 .../unit/kafka/server/ClientQuotaManagerTest.scala |   2 +-
 .../streams/processor/internals/StreamThread.java  |  34 ++---
 35 files changed, 458 insertions(+), 375 deletions(-)
ee6b5e044c5a4b8ec996b05da76a21c191a95149

 .../kafka/connect/util/KafkaBasedLogTest.java      | 29 +++++++++++++++-------
 1 file changed, 20 insertions(+), 9 deletions(-)
b5f5be69ea99f3b434b187129e7319607009a8f3

 core/src/main/scala/kafka/producer/async/ProducerSendThread.scala | 2 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala                   | 7 ++-----
 2 files changed, 3 insertions(+), 6 deletions(-)
d09188aa36f7dad262bef8480e7785f496dc321b

 core/src/test/scala/unit/kafka/server/DynamicConfigChangeTest.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
e1c4aefc36fad009326b9611606c41f43d500108

 docs/api.html    | 2 +-
 docs/design.html | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)
1f98b0315c92cf8c89f07241485fa6db8b496fdc

 docs/api.html    | 2 +-
 docs/design.html | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)
5bc90d4542ca9d6cea3eac1e0a7e1bfa1fed15e7

 .../kafka/api/ControlledShutdownRequest.scala      |   3 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   6 +-
 .../scala/kafka/api/GroupCoordinatorRequest.scala  |   5 +-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |   9 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |   7 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |   9 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   7 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   5 +-
 core/src/main/scala/kafka/api/RequestKeys.scala    |  73 ------------
 .../main/scala/kafka/api/StopReplicaRequest.scala  |   5 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   3 +-
 .../scala/kafka/api/UpdateMetadataRequest.scala    |   8 +-
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |   3 +-
 .../main/scala/kafka/network/RequestChannel.scala  |  40 +++++--
 .../main/scala/kafka/producer/SyncProducer.scala   |   5 +-
 .../main/scala/kafka/server/ConfigHandler.scala    |   8 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  51 +++++----
 .../kafka/api/AuthorizerIntegrationTest.scala      | 122 ++++++++++-----------
 .../scala/integration/kafka/api/QuotasTest.scala   |  13 ++-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   6 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |   6 +-
 21 files changed, 175 insertions(+), 219 deletions(-)
268392f5e99dc3eab9d89e921bafde782a1d10a6

 .../streams/processor/internals/AbstractTask.java  |   2 +-
 .../processor/internals/ProcessorStateManager.java |  36 +++++--
 .../internals/ProcessorStateManagerTest.java       |  34 +++++--
 .../processor/internals/StandbyTaskTest.java       | 112 ++++++++++++++++++++-
 .../apache/kafka/test/MockStateStoreSupplier.java  |  20 +++-
 5 files changed, 184 insertions(+), 20 deletions(-)
168b759e6c7ae72e60459ef6499d0330e617f84c

 .../main/scala/kafka/utils/DoublyLinkedList.scala  | 126 ---------------------
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  56 +--------
 2 files changed, 3 insertions(+), 179 deletions(-)
b390b15cdbf89f7ffce16dad2a20ee9330f82731

 .../main/scala/kafka/utils/DoublyLinkedList.scala  | 126 ---------------------
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  56 +--------
 2 files changed, 3 insertions(+), 179 deletions(-)
d05fa0a03bc9bcfcff8d73cbf1b22832ebdb75a2

 bin/kafka-run-class.sh                             |   2 +-
 build.gradle                                       |   2 +
 checkstyle/import-control.xml                      |   8 +
 .../org/apache/kafka/streams/KafkaStreaming.java   |  40 +--
 .../org/apache/kafka/streams/StreamingConfig.java  |  48 +++-
 .../apache/kafka/streams/examples/KStreamJob.java  |   2 +-
 .../kafka/streams/examples/ProcessorJob.java       |   8 +-
 .../streams/kstream/SlidingWindowSupplier.java     |   2 +-
 .../streams/kstream/internals/KTableImpl.java      |   3 +-
 .../streams/processor/DefaultPartitionGrouper.java |   7 +-
 .../kafka/streams/processor/PartitionGrouper.java  |  31 +--
 .../kafka/streams/processor/ProcessorContext.java  |   2 +-
 .../kafka/streams/processor/TopologyBuilder.java   | 139 ++++++++---
 .../streams/processor/internals/AbstractTask.java  |   3 +-
 .../internals/KafkaStreamingPartitionAssignor.java | 270 +++++++++++++++++++--
 .../processor/internals/ProcessorContextImpl.java  |   4 +-
 .../processor/internals/ProcessorStateManager.java |  63 +++--
 .../processor/internals/StandbyContextImpl.java    |   4 +-
 .../streams/processor/internals/StandbyTask.java   |   8 +-
 .../streams/processor/internals/StreamTask.java    |   8 +-
 .../streams/processor/internals/StreamThread.java  |  43 ++--
 .../internals/assignment/SubscriptionInfo.java     |  32 +--
 .../kafka/streams/state/MeteredKeyValueStore.java  |   2 +-
 .../apache/kafka/streams/state/RocksDBStore.java   |   1 -
 .../apache/kafka/streams/StreamingConfigTest.java  |  21 +-
 .../processor/DefaultPartitionGrouperTest.java     |  32 ++-
 .../streams/processor/TopologyBuilderTest.java     |  31 ++-
 .../KafkaStreamingPartitionAssignorTest.java       | 201 ++++++++++++---
 .../internals/ProcessorStateManagerTest.java       | 152 +++++++-----
 .../processor/internals/StandbyTaskTest.java       |  46 ++--
 .../processor/internals/StreamTaskTest.java        |   4 +-
 .../processor/internals/StreamThreadTest.java      |  15 +-
 .../internals/assignment/SubscriptionInfoTest.java |   5 +-
 .../streams/state/KeyValueStoreTestDriver.java     |   2 +-
 .../apache/kafka/test/MockProcessorContext.java    |   2 +-
 .../apache/kafka/test/MockStateStoreSupplier.java  |   2 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   8 +-
 .../org/apache/kafka/test/UnlimitedWindowDef.java  |   2 +-
 38 files changed, 899 insertions(+), 356 deletions(-)
8b65ec9caca82f98e715a0acb2ebabee3ae4fef1

 .../kafka/clients/producer/KafkaProducer.java      | 34 +++++-----------------
 .../kafka/clients/producer/ProducerConfig.java     |  6 ++--
 2 files changed, 9 insertions(+), 31 deletions(-)
23f36c5903e9b65c2b322a9405149de671de7a23

 .../kafka/clients/producer/KafkaProducer.java      | 34 +++++-----------------
 .../kafka/clients/producer/ProducerConfig.java     |  6 ++--
 2 files changed, 9 insertions(+), 31 deletions(-)
8687c099c4ef082a8f35a050d3b319c7721921c2

 .../consumer/internals/AbstractCoordinator.java    | 14 ++---
 .../consumer/internals/ConsumerCoordinator.java    | 32 ++++++-----
 .../kafka/common/requests/JoinGroupRequest.java    | 14 ++---
 .../internals/ConsumerCoordinatorTest.java         | 62 ++++++++++++++++------
 .../kafka/common/requests/RequestResponseTest.java |  4 +-
 .../runtime/distributed/WorkerCoordinator.java     | 10 ++--
 .../runtime/distributed/WorkerGroupMember.java     |  2 -
 .../runtime/distributed/WorkerCoordinatorTest.java | 10 ++--
 .../kafka/api/AuthorizerIntegrationTest.scala      |  2 +-
 9 files changed, 88 insertions(+), 62 deletions(-)
39c3512eceedebcb6e50f8c6c4ef66601ff7dbc4

 .../org/apache/kafka/streams/kstream/KStream.java  |  22 +-
 .../kafka/streams/kstream/KStreamBuilder.java      |  41 ++++
 .../org/apache/kafka/streams/kstream/KTable.java   | 108 +++++++++
 .../streams/kstream/internals/KStreamImpl.java     |   2 +-
 .../KTableDerivedValueGetterSupplier.java          |  28 +++
 .../streams/kstream/internals/KTableFilter.java    |  87 +++++++
 .../streams/kstream/internals/KTableImpl.java      | 188 +++++++++++++++
 .../streams/kstream/internals/KTableMapValues.java |  85 +++++++
 .../kstream/internals/KTableProcessorSupplier.java |  26 ++
 .../streams/kstream/internals/KTableSource.java    |  78 ++++++
 .../internals/KTableSourceValueGetterSupplier.java |  50 ++++
 .../kstream/internals/KTableStoreSupplier.java     |  58 +++++
 .../kstream/internals/KTableValueGetter.java       |  28 +++
 .../internals/KTableValueGetterSupplier.java       |  24 ++
 .../kafka/streams/processor/PartitionGrouper.java  |   2 +-
 .../org/apache/kafka/streams/processor/TaskId.java |  12 +
 .../streams/processor/internals/AbstractTask.java  |  14 +-
 .../internals/KafkaStreamingPartitionAssignor.java |  20 +-
 .../processor/internals/ProcessorStateManager.java |  49 +++-
 .../streams/processor/internals/StandbyTask.java   |  25 +-
 .../streams/processor/internals/StreamTask.java    |  18 +-
 .../streams/processor/internals/StreamThread.java  |  78 ++++--
 .../internals/assignment/AssignmentInfo.java       | 129 ++++++----
 .../streams/state/KeyValueStoreChangeLogger.java   |  87 +++++++
 .../kafka/streams/state/MeteredKeyValueStore.java  |  95 +++-----
 .../state/RocksDBKeyValueStoreSupplier.java        | 252 +-------------------
 .../apache/kafka/streams/state/RocksDBStore.java   | 265 +++++++++++++++++++++
 .../org/apache/kafka/streams/state/Serdes.java     |   3 +-
 .../kstream/internals/KTableFilterTest.java        | 137 +++++++++++
 .../streams/kstream/internals/KTableImplTest.java  | 220 +++++++++++++++++
 .../kstream/internals/KTableMapValuesImplTest.java | 198 +++++++++++++++
 .../kstream/internals/KTableSourceTest.java        | 117 +++++++++
 .../KafkaStreamingPartitionAssignorTest.java       | 151 ++++++------
 .../processor/internals/StandbyTaskTest.java       |  11 +-
 .../processor/internals/StreamTaskTest.java        |   4 +-
 .../processor/internals/StreamThreadTest.java      |  12 +-
 .../internals/assignment/AssginmentInfoTest.java   |  11 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |  43 +++-
 .../apache/kafka/test/MockProcessorContext.java    |  14 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   4 +-
 40 files changed, 2268 insertions(+), 528 deletions(-)
cd54fc8816964f5a56469075c75c567e777b9656

 .../consumer/internals/AbstractCoordinator.java    | 14 +---
 .../consumer/internals/ConsumerCoordinator.java    | 32 +++++---
 .../kafka/common/requests/JoinGroupRequest.java    | 14 ++--
 .../internals/ConsumerCoordinatorTest.java         | 62 ++++++++++----
 .../kafka/common/requests/RequestResponseTest.java |  4 +-
 .../runtime/distributed/WorkerCoordinator.java     | 10 +--
 .../runtime/distributed/WorkerGroupMember.java     |  2 -
 .../runtime/distributed/WorkerCoordinatorTest.java | 10 ++-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  2 +-
 tests/kafkatest/services/verifiable_consumer.py    |  7 +-
 tests/kafkatest/tests/consumer_rolling_upgrade.py  | 94 ++++++++++++++++++++++
 .../org/apache/kafka/tools/VerifiableConsumer.java | 11 +++
 12 files changed, 198 insertions(+), 64 deletions(-)
80df43500141d6bf710b19f342c8ab172587c128

 tests/kafkatest/services/kafka/kafka.py            |  25 +++--
 .../services/kafka/templates/kafka.properties      |   6 ++
 .../services/kafka/templates/log4j.properties      |   2 +-
 .../kafkatest/services/security/security_config.py |   5 +-
 .../services/security/templates/gssapi_jaas.conf   |  35 +++++++
 tests/kafkatest/services/zookeeper.py              |  35 ++++++-
 .../tests/zookeeper_security_upgrade_test.py       | 103 +++++++++++++++++++++
 7 files changed, 199 insertions(+), 12 deletions(-)
7b46a99d682e7d79e4114931a85e6daca2bcc954

 .../apache/kafka/clients/consumer/KafkaConsumer.java  | 11 +++++------
 .../consumer/internals/ConsumerNetworkClient.java     | 19 +++++++++++++++----
 2 files changed, 20 insertions(+), 10 deletions(-)
13e483adeee8d968397a21bde3bb159516f26ff0

 .../apache/kafka/clients/consumer/KafkaConsumer.java  | 11 +++++------
 .../consumer/internals/ConsumerNetworkClient.java     | 19 +++++++++++++++----
 2 files changed, 20 insertions(+), 10 deletions(-)
5b5f6bbe68a82ce5eae946e0a1a199e9713a6ff7

 tests/kafkatest/services/kafka/kafka.py   | 36 ++++++++++--------
 tests/kafkatest/services/zookeeper.py     | 22 ++++++++++-
 tests/kafkatest/tests/replication_test.py | 62 ++++++++++++++++++++-----------
 3 files changed, 81 insertions(+), 39 deletions(-)
2b4c5dc290ec6d89206f31856204b713e21c7d2b

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b09663eeec2153e2556983b8ef21551e69ee6afc

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a5382a333ebb51a10c1a1cab46d66f10abff128a

 .../org/apache/kafka/streams/StreamingConfig.java  |  2 +-
 .../apache/kafka/streams/StreamingConfigTest.java  | 70 ++++++++++++++++++++++
 2 files changed, 71 insertions(+), 1 deletion(-)
ee8a7ce9a4789e4538cf9d337b2fc0d80204da06

 tests/kafkatest/services/security/minikdc.py | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
20e958861e8fc0aef19a77c00c1fa0a2cd6312ad

 .../kafka/clients/consumer/KafkaConsumer.java      |   6 +
 .../consumer/internals/AbstractCoordinator.java    |  35 +--
 .../consumer/internals/ConsumerCoordinator.java    |   5 +-
 .../consumer/internals/ConsumerNetworkClient.java  |  23 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 267 ++++++++++++---------
 .../kafka/common/errors/DisconnectException.java   |   1 +
 .../kafka/common/requests/MetadataResponse.java    |  37 ++-
 .../clients/consumer/internals/FetcherTest.java    |  67 +++++-
 .../org/apache/kafka/common/utils/MockTime.java    |   8 +
 core/src/main/scala/kafka/admin/AdminClient.scala  |   6 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  14 ++
 .../kafka/api/PlaintextConsumerTest.scala          |  16 +-
 12 files changed, 313 insertions(+), 172 deletions(-)
9fb1e25738f89b75a36ef69f730b0e138ccd55b1

 .../kafka/clients/consumer/KafkaConsumer.java      |   6 +
 .../consumer/internals/AbstractCoordinator.java    |  35 +--
 .../consumer/internals/ConsumerCoordinator.java    |   5 +-
 .../consumer/internals/ConsumerNetworkClient.java  |  23 +-
 .../kafka/clients/consumer/internals/Fetcher.java  | 267 ++++++++++++---------
 .../kafka/common/errors/DisconnectException.java   |   1 +
 .../kafka/common/requests/MetadataResponse.java    |  37 ++-
 .../clients/consumer/internals/FetcherTest.java    |  67 +++++-
 .../org/apache/kafka/common/utils/MockTime.java    |   8 +
 core/src/main/scala/kafka/admin/AdminClient.scala  |   6 +-
 .../kafka/api/AuthorizerIntegrationTest.scala      |  14 ++
 .../kafka/api/PlaintextConsumerTest.scala          |  16 +-
 12 files changed, 313 insertions(+), 172 deletions(-)
8c3c9548b636cdf760d2537afe115942d13bc003

 tests/kafkatest/services/security/minikdc.py | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
cff03f8b68604ce8c8c743801b075b655af23011

 tests/kafkatest/tests/compatibility_test.py            | 2 +-
 tests/kafkatest/tests/quota_test.py                    | 2 +-
 tests/kafkatest/tests/replication_test.py              | 9 +++++----
 tests/kafkatest/tests/security_rolling_upgrade_test.py | 2 +-
 tests/kafkatest/tests/upgrade_test.py                  | 2 +-
 5 files changed, 9 insertions(+), 8 deletions(-)
69269e76a43adf85a478240280c6ab3c7eef4d8e

 build.gradle                                       |  2 +-
 .../common/record/KafkaLZ4BlockInputStream.java    | 12 +++----
 .../common/record/KafkaLZ4BlockOutputStream.java   | 18 +++++------
 .../kafka/message/MessageCompressionTest.scala     | 37 +++++++++++++++++-----
 4 files changed, 45 insertions(+), 24 deletions(-)
0a52ddfd039721521f60fd23399469d975f3f9ea

 build.gradle              | 16 ++++++++++++----
 checkstyle/checkstyle.xml |  8 ++++----
 2 files changed, 16 insertions(+), 8 deletions(-)
bb2bcc7eb109caffc1a0a8fa790216f5e44f9104

 core/src/main/scala/kafka/log/Log.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4649c347b6a59f8fbd4fcaf2363eb172a7da1d4c

 core/src/main/scala/kafka/log/Log.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0264127ba829adae0f1f1e7f610d2356fbcf17f3

 tests/kafkatest/services/templates/mirror_maker_consumer.properties | 2 +-
 tests/kafkatest/services/templates/mirror_maker_producer.properties | 4 ++--
 tests/kafkatest/services/verifiable_consumer.py                     | 3 +--
 3 files changed, 4 insertions(+), 5 deletions(-)
59c7f6c71ab70525331c3bd1e31b060af08d6744

 docs/ops.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
fb6ea6b179b6e4b8a7b23063b17828b42361cd75

 docs/ops.html | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
a412d8a23859928a35a371d21cb1cb585672796f

 docs/ops.html | 17 ++++++++++-------
 1 file changed, 10 insertions(+), 7 deletions(-)
ca24692d168383e4e70c748f791e8382168f506b

 core/src/main/scala/kafka/coordinator/GroupMetadataManager.scala | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
eafc349a1f26a20086b320916c2c819e05bc77ea

 core/src/main/scala/kafka/coordinator/GroupMetadataManager.scala | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
6b4cc2ea2b141b25852e2110ac4a400905154b92

 tests/kafkatest/services/console_consumer.py       |   2 +-
 tests/kafkatest/services/kafka/kafka.py            |  57 +++++++++-
 .../services/kafka/templates/kafka.properties      |  16 +--
 tests/kafkatest/services/kafka_log4j_appender.py   |   2 +-
 .../services/performance/consumer_performance.py   |   2 +-
 .../services/performance/end_to_end_latency.py     |   2 +-
 .../services/performance/producer_performance.py   |   2 +-
 tests/kafkatest/services/verifiable_consumer.py    |   5 +-
 tests/kafkatest/services/verifiable_producer.py    |   2 +-
 tests/kafkatest/tests/produce_consume_validate.py  |   8 +-
 .../tests/security_rolling_upgrade_test.py         | 124 +++++++++++++++++++++
 11 files changed, 197 insertions(+), 25 deletions(-)
a35334908df58b7aaa01efd5ce8434f5e6804cb1

 docs/ops.html | 17 ++++++++++-------
 1 file changed, 10 insertions(+), 7 deletions(-)
94dc1f939af05216b765c1c7592946568dc4d7ea

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ea971397c8c1b8deedc48c4165aded42118eee43

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0cd6e9464d50e8e54ceeb8cc26f6035b5f3bc00b

 tests/kafkatest/services/verifiable_consumer.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
78e7f87db8be3b1eae59752e8c9ceb0b8c064a96

 tests/kafkatest/services/verifiable_consumer.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
cbddb0709df712e9496aa783e801969168c1cbec

 build.gradle                                       |  8 ++++----
 .../apache/kafka/connect/data/ConnectSchema.java   |  2 +-
 .../apache/kafka/connect/data/SchemaBuilder.java   | 24 +++++++++++-----------
 .../apache/kafka/connect/source/SourceTask.java    |  2 +-
 .../apache/kafka/connect/storage/Converter.java    |  2 +-
 5 files changed, 19 insertions(+), 19 deletions(-)
75c7abd82628b7aae026a662ad0395d1f9c8536b

 build.gradle                                       |  8 ++++----
 .../apache/kafka/connect/data/ConnectSchema.java   |  2 +-
 .../apache/kafka/connect/data/SchemaBuilder.java   | 24 +++++++++++-----------
 .../apache/kafka/connect/source/SourceTask.java    |  2 +-
 .../apache/kafka/connect/storage/Converter.java    |  2 +-
 5 files changed, 19 insertions(+), 19 deletions(-)
4a8acdf9d7135a50b751a0bea9e205ea4a071e5c

 .../kafka/api/EndToEndAuthorizationTest.scala      | 273 +++++++++++++++++++++
 .../kafka/api/IntegrationTestHarness.scala         |  19 +-
 .../kafka/api/SaslPlaintextConsumerTest.scala      |   1 +
 .../scala/integration/kafka/api/SaslSetup.scala    |  87 +++++++
 .../kafka/api/SaslSslConsumerTest.scala            |   4 +
 .../api/SaslSslEndToEndAuthorizationTest.scala     |  25 ++
 .../integration/kafka/api/SaslTestHarness.scala    |  59 +----
 .../kafka/api/SslEndToEndAuthorizationTest.scala   |  29 +++
 .../kafka/integration/KafkaServerTestHarness.scala |  20 +-
 .../SaslPlaintextTopicMetadataTest.scala           |   1 +
 .../integration/SaslSslTopicMetadataTest.scala     |   1 +
 .../server/SaslPlaintextReplicaFetchTest.scala     |   1 +
 .../kafka/server/SaslSslReplicaFetchTest.scala     |   1 +
 .../scala/unit/kafka/utils/JaasTestUtils.scala     |  65 ++++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  59 +++--
 15 files changed, 554 insertions(+), 91 deletions(-)
e934a107f8e79a1169c02fb326014fcf91e9ceb5

 .../src/main/java/org/apache/kafka/clients/producer/KafkaProducer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1dd558aeceffdd98da83f8240cdc3bf8bc182c93

 .../src/main/java/org/apache/kafka/clients/producer/KafkaProducer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
60c44801c9e3a2e730d96bb4c9065d41fdd1c1c0

 core/src/main/scala/kafka/server/ReplicaManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
09b43beb1d0aabb2776da2a5790752992ef617f7

 core/src/main/scala/kafka/server/ReplicaManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7d37086e5e3225b003fc353b86a130a56c1a469b

 .../org/apache/kafka/common/record/Compressor.java | 87 +++++++++++++++++-----
 1 file changed, 69 insertions(+), 18 deletions(-)
4a0e011be3d038763d6326bb0092524f809c3f4d

 .../org/apache/kafka/common/record/Compressor.java | 87 +++++++++++++++++-----
 1 file changed, 69 insertions(+), 18 deletions(-)
4f3bdca5bfd0b795a850ab45ef049dc94ddd8bd8

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
c18a1bd64e7f8416e8256b968fe1b9e2da553b00

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
abf6b2ebb3e6e34ef9c4623b4c28dacce461c0c0

 core/src/main/scala/kafka/server/KafkaConfig.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
d07bb1814010ca4d822e44330d1e8ea4b2839c80

 .../org/apache/kafka/streams/kstream/KStream.java  | 33 +++++++++-------------
 .../kafka/streams/kstream/KStreamBuilder.java      |  8 ++----
 .../streams/kstream/internals/KStreamImpl.java     | 21 ++++++--------
 .../streams/kstream/internals/KStreamImplTest.java |  2 +-
 4 files changed, 25 insertions(+), 39 deletions(-)
33b4d3c4cc1f449f91a74bd589b1c90c60ddc71b

 .../org/apache/kafka/common/protocol/types/ArrayOf.java |  2 ++
 .../protocol/types/ProtocolSerializationTest.java       | 17 +++++++++++++++++
 2 files changed, 19 insertions(+)
5e8958a856a5b4ccbdcb610473cab4c2eeddbac5

 .../kafka/streams/examples/ProcessorJob.java       |  2 +-
 .../kafka/streams/state/MeteredKeyValueStore.java  |  1 +
 .../state/RocksDBKeyValueStoreSupplier.java        |  2 +
 .../org/apache/kafka/streams/state/Serdes.java     | 61 +++++++---------------
 .../org/apache/kafka/streams/state/Stores.java     |  5 +-
 .../processor/internals/ProcessorTopologyTest.java |  2 +-
 .../streams/state/AbstractKeyValueStoreTest.java   | 12 ++---
 .../streams/state/InMemoryKeyValueStoreTest.java   |  6 +--
 .../streams/state/InMemoryLRUCacheStoreTest.java   |  7 +--
 .../streams/state/KeyValueStoreTestDriver.java     |  9 ----
 .../streams/state/RocksDBKeyValueStoreTest.java    |  6 +--
 11 files changed, 40 insertions(+), 73 deletions(-)
69a1cced49d7d0c805adeb1dfd327f8bb5c7ce9a

 tests/kafkatest/services/kafka/kafka.py         |  8 +++----
 tests/kafkatest/services/mirror_maker.py        | 10 ++++++++
 tests/kafkatest/services/verifiable_producer.py |  6 ++---
 tests/kafkatest/tests/mirror_maker_test.py      | 31 +++++++++++++++++++------
 4 files changed, 41 insertions(+), 14 deletions(-)
34a6be2ccd95d50e7659a57c943436e579521471

 kafka-merge-pr.py | 17 +++++++++++++++--
 1 file changed, 15 insertions(+), 2 deletions(-)
e14ae66e721f98ca7c18d35ea022e6de733f4c03

 .../streams/kstream/internals/KStreamImpl.java     | 32 +++++++++++-----------
 1 file changed, 16 insertions(+), 16 deletions(-)
d96542f8e0c3241f097c9ceaed6fd1cf892123ab

 .../src/test/scala/other/kafka/StressTestLog.scala |  2 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     | 10 +++------
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  5 +++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  6 +++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 24 +++++++++++++++-------
 5 files changed, 27 insertions(+), 20 deletions(-)
8ed271b82abd4641b594aff262512bd9eb588263

 .../src/test/scala/other/kafka/StressTestLog.scala |  2 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     | 10 +++------
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  5 +++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  6 +++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 24 +++++++++++++++-------
 5 files changed, 27 insertions(+), 20 deletions(-)
617a91a236a44431aeca9345ae954f7067da48f3

 .../org/apache/kafka/streams/processor/internals/AbstractTask.java | 7 ++++++-
 .../org/apache/kafka/streams/processor/internals/StreamTask.java   | 5 +++++
 2 files changed, 11 insertions(+), 1 deletion(-)
c89b6f6a5e8dca191c8fcf3042d7d7f868b64f80

 .../apache/kafka/clients/consumer/KafkaConsumer.java   | 18 +++++++++++++-----
 .../consumer/internals/AbstractCoordinator.java        |  1 +
 .../consumer/internals/ConsumerCoordinator.java        |  1 +
 .../consumer/internals/ConsumerNetworkClient.java      | 17 ++++++++++-------
 .../kafka/clients/consumer/internals/Fetcher.java      |  2 ++
 5 files changed, 27 insertions(+), 12 deletions(-)
87b894d682a5f10b2e1d32dd028ddb258f2f1bbf

 .../org/apache/kafka/common/protocol/types/ArrayOf.java |  2 ++
 .../protocol/types/ProtocolSerializationTest.java       | 17 +++++++++++++++++
 2 files changed, 19 insertions(+)
3022c1938d6cce22450be45d3a28728159f4dfbc

 README.md    |  7 ++++---
 build.gradle | 35 +++++++++++++++++++++--------------
 scala.gradle | 19 +++++++++++++++++--
 3 files changed, 42 insertions(+), 19 deletions(-)
d1053915f64aec7ea717bbeac9570b1f75e9a2b0

 tests/kafkatest/tests/connect_distributed_test.py  | 43 ++++++++++++++--------
 .../tests/templates/connect-distributed.properties |  7 +++-
 2 files changed, 34 insertions(+), 16 deletions(-)
89e916d59382491be1911d6dddd47df800797949

 docs/api.html           | 17 +++++++++++++----
 docs/configuration.html | 13 +++++++++----
 docs/documentation.html | 16 +++++++++++-----
 3 files changed, 33 insertions(+), 13 deletions(-)
395bf46ddac8c5fe1d6fd0d1636b94dcddadd678

 docs/api.html           | 17 +++++++++++++----
 docs/configuration.html | 13 +++++++++----
 docs/documentation.html | 16 +++++++++++-----
 3 files changed, 33 insertions(+), 13 deletions(-)
701ac0022e3bc0530f4411c3a4b0c66783f9bdce

 core/src/main/scala/kafka/coordinator/GroupMetadataManager.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
394eda510dfc1af5c614fa88ee96c7cf2c098fd0

 core/src/main/scala/kafka/coordinator/GroupMetadataManager.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
10b3e6a5e08074c4df391a1346bb87e2ca4f041e

 docs/documentation.html | 1 +
 1 file changed, 1 insertion(+)
5a9b12eb5d62cfb04db93a105e10ddfcae793e2b

 docs/documentation.html | 1 +
 1 file changed, 1 insertion(+)
c213952fa180c56908ef70c01a784d24202beb55

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
e32df4722ca476ab373cca45a824f712cf4943ef

 tests/kafkatest/services/security/minikdc.py | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
f81dd4a4fbb5c1c78dc5fc38a13d2adaf7eff2e7

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
84c8d2bb86dc2794a3d6a86ae28b3cb51cea5c4b

 .../kafka/streams/processor/TopologyBuilder.java   |  2 ++
 .../streams/processor/TopologyBuilderTest.java     | 42 +++++++++++++++++++---
 2 files changed, 39 insertions(+), 5 deletions(-)
3e0333d692762b99eb51d0e2948fe240eef7a6af

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
fc7243c2af4b2b4affcdf14d80826986fe6d4ce8

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
6a1993b8e08da1a4e8b5b7fbb55d777b70b1f6f5

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1742937cb895ad80bb3e8890d3c116e8cd0008e3

 tests/kafkatest/services/verifiable_consumer.py | 249 +++++++++++++++++-------
 tests/kafkatest/tests/consumer_test.py          | 224 ++++++++++++++++++---
 2 files changed, 370 insertions(+), 103 deletions(-)
b16817a54c592eefc5a462132f45c5b4f786d5f1

 tests/kafkatest/services/verifiable_consumer.py | 249 +++++++++++++++++-------
 tests/kafkatest/tests/consumer_test.py          | 224 ++++++++++++++++++---
 2 files changed, 370 insertions(+), 103 deletions(-)
836dd705d16d1d6e01288529dff1b232b62d9f52

 .../test/scala/unit/kafka/utils/TestUtils.scala    | 27 +++++++++++-----------
 1 file changed, 14 insertions(+), 13 deletions(-)
0d68eb73f3af8d0e8e32a1e61d8a569c615c3c8c

 .../test/scala/unit/kafka/utils/TestUtils.scala    | 27 +++++++++++-----------
 1 file changed, 14 insertions(+), 13 deletions(-)
a7726ee651ac3b23fd5a4925b9a324c3462ea127

 docs/security.html | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
6aeaa1eb5ceeb7603e9d5339a96f0fa268f12fa0

 docs/security.html | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
cd7455c64ba4199d76c35019d3be78bb6df0b25f

 docs/implementation.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b609645dc4813de7ca5c6366e940831f6e7c1177

 docs/implementation.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9b0ddc555fcb0e65962d0a7fb3dbaba43fae3fb8

 tests/kafkatest/tests/benchmark_test.py | 1 +
 1 file changed, 1 insertion(+)
81c89e91f9dc5d6d5086d5b6dcd1eae2941718c2

 core/src/main/scala/kafka/admin/AclCommand.scala   | 70 ++++++++++++----------
 .../scala/kafka/security/auth/Authorizer.scala     |  6 ++
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  6 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 10 ++--
 .../scala/unit/kafka/admin/AclCommandTest.scala    | 21 ++++---
 .../security/auth/SimpleAclAuthorizerTest.scala    |  7 ++-
 6 files changed, 73 insertions(+), 47 deletions(-)
b1d17e7ef0e901234d95d7825f6862d2aaead76f

 core/src/main/scala/kafka/admin/AclCommand.scala   | 70 ++++++++++++----------
 .../scala/kafka/security/auth/Authorizer.scala     |  6 ++
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  6 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 10 ++--
 .../scala/unit/kafka/admin/AclCommandTest.scala    | 21 ++++---
 .../security/auth/SimpleAclAuthorizerTest.scala    |  7 ++-
 6 files changed, 73 insertions(+), 47 deletions(-)
2f51ab23aa6597187ff98c04b287ae3ab4666860

 .../org/apache/kafka/connect/runtime/WorkerSourceTask.java | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)
7b3d1bf6a398f5b1f454a7719d04f5ee9e630f96

 .../org/apache/kafka/connect/runtime/WorkerSourceTask.java | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)
2b3f6d204a75d1a9ca84b05a6b6a3388f2f16a81

 .../main/scala/kafka/network/RequestChannel.scala  |  5 +--
 .../main/scala/kafka/network/SocketServer.scala    |  7 ++--
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  4 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 12 +++----
 .../security/auth/SimpleAclAuthorizerTest.scala    | 41 +++++++++++-----------
 5 files changed, 36 insertions(+), 33 deletions(-)
d0614f97bc1c45734631770c46ab6a79fc8c8547

 .../main/scala/kafka/network/RequestChannel.scala  |  5 +--
 .../main/scala/kafka/network/SocketServer.scala    |  7 ++--
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  4 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 12 +++----
 .../security/auth/SimpleAclAuthorizerTest.scala    | 41 +++++++++++-----------
 5 files changed, 36 insertions(+), 33 deletions(-)
07e214130fe7dc74cf2a5628232b8c3c3ef000bc

 .../consumer/internals/AbstractCoordinator.java    | 10 ++-
 .../consumer/internals/ConsumerCoordinator.java    | 91 +++++++++++++++++-----
 2 files changed, 79 insertions(+), 22 deletions(-)
8ee9846e019c7758719d7e706f9e26958faedfc6

 vagrant/aws/aws-example-Vagrantfile.local | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b206a807f3c781d8d8126d7c3b97724632486fd0

 tests/kafkatest/services/performance/templates/tools_log4j.properties | 3 +--
 tests/kafkatest/services/templates/connect_log4j.properties           | 1 -
 tests/kafkatest/services/templates/tools_log4j.properties             | 1 -
 3 files changed, 1 insertion(+), 4 deletions(-)
4e22abaa85414ab4679f22fdc25f531bc701f4c6

 tests/kafkatest/services/security/minikdc.py           | 18 +++++++++++++++++-
 .../services/security/templates/minikdc.properties     |  2 +-
 2 files changed, 18 insertions(+), 2 deletions(-)
26f7979318ada5ec1e0e4e40dee5ee1ca10facd1

 docs/api.html      |   2 +-
 docs/security.html | 247 ++++++++++++++++++++++++++++-------------------------
 2 files changed, 132 insertions(+), 117 deletions(-)
c7c7f4cfa7e1c385d5f5706161572d657b495b7a

 docs/api.html      |   2 +-
 docs/security.html | 247 ++++++++++++++++++++++++++++-------------------------
 2 files changed, 132 insertions(+), 117 deletions(-)
fa4244745fc363410fd5bc21e0b045f8124a8f9c

 .../consumer/internals/AbstractCoordinator.java    | 10 ++-
 .../consumer/internals/ConsumerCoordinator.java    | 91 +++++++++++++++++-----
 2 files changed, 79 insertions(+), 22 deletions(-)
f154956a76790220a9ecb84d88644076c6885683

 tests/kafkatest/services/console_consumer.py |   7 +-
 tests/kafkatest/tests/compatibility_test.py  | 101 +++++++++++++++++++++++++++
 tests/kafkatest/tests/upgrade_test.py        |   3 -
 3 files changed, 105 insertions(+), 6 deletions(-)
2e91806db45b3854bd2fadb69cee4ecae9fd43ac

 tests/kafkatest/services/kafka/kafka.py            | 29 ++++++++------
 .../services/kafka/templates/log4j.properties      | 46 +++++++++++-----------
 tests/kafkatest/services/verifiable_producer.py    |  1 -
 3 files changed, 40 insertions(+), 36 deletions(-)
537aeae33403e96d1736f049415ec42ea2f7f8d1

 .../kafka/connect/runtime/WorkerSourceTask.java    | 112 +++++++++++++------
 .../connect/runtime/WorkerSourceTaskTest.java      | 124 +++++++++++++++++----
 2 files changed, 176 insertions(+), 60 deletions(-)
0f00ec97ae328d04c29cb1cb3eabad3f17e31582

 .../kafka/connect/runtime/WorkerSourceTask.java    | 112 +++++++++++++------
 .../connect/runtime/WorkerSourceTaskTest.java      | 124 +++++++++++++++++----
 2 files changed, 176 insertions(+), 60 deletions(-)
d6e900a185c840b7373b35bf065e1d8cc6e4183a

 build.gradle |  2 +-
 gradlew      | 10 +++-------
 2 files changed, 4 insertions(+), 8 deletions(-)
8f6ffe1c28d43bebf1cef7198c1e154a2adc92c3

 README.md                       |  2 +-
 bin/kafka-run-class.sh          |  2 +-
 bin/windows/kafka-run-class.bat |  2 +-
 build.gradle                    | 33 ++++++++++++++++-----------------
 gradle.properties               |  6 +++---
 scala.gradle                    |  4 ++--
 6 files changed, 24 insertions(+), 25 deletions(-)
17c6f33126823c4f54ea22ed2284267271b58e21

 core/src/main/scala/kafka/admin/AclCommand.scala |  2 +-
 docs/security.html                               | 14 +++++++-------
 2 files changed, 8 insertions(+), 8 deletions(-)
fe855f98263cb7b8095288c22c96763e1de727e7

 core/src/main/scala/kafka/admin/AclCommand.scala |  2 +-
 docs/security.html                               | 14 +++++++-------
 2 files changed, 8 insertions(+), 8 deletions(-)
a2bc9501d0926ff9693ca230af79f088ebc4fca2

 .../scala/kafka/coordinator/GroupCoordinator.scala |  72 +++++--
 .../kafka/coordinator/GroupMetadataManager.scala   | 221 +++++++++++----------
 .../scala/kafka/server/DelayedOperationKey.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  27 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  18 +-
 core/src/main/scala/kafka/utils/Pool.scala         |   4 +-
 .../coordinator/GroupCoordinatorResponseTest.scala |   2 +-
 8 files changed, 200 insertions(+), 150 deletions(-)
dbdec927b9badcdbe4a4b4b6ccebf5044ca32747

 .../scala/kafka/coordinator/GroupCoordinator.scala |  72 +++++--
 .../kafka/coordinator/GroupMetadataManager.scala   | 221 +++++++++++----------
 .../scala/kafka/server/DelayedOperationKey.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  27 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  18 +-
 core/src/main/scala/kafka/utils/Pool.scala         |   4 +-
 .../coordinator/GroupCoordinatorResponseTest.scala |   2 +-
 8 files changed, 200 insertions(+), 150 deletions(-)
9f2f9fb8fa65547cf898992b96a55d90856cb60c

 .../main/scala/kafka/tools/ConsoleProducer.scala   | 24 ++++++++++++++--------
 1 file changed, 16 insertions(+), 8 deletions(-)
06d2c78164aca4b20d1d76f2ddef563b115f2b81

 .../main/scala/kafka/tools/ConsoleProducer.scala   | 24 ++++++++++++++--------
 1 file changed, 16 insertions(+), 8 deletions(-)
45d6fb717d3607f0e1a05a429f4feb38f7b50e40

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 12 ++++++++++++
 1 file changed, 12 insertions(+)
36b1c1dae292b9a43f56c385de13b89dfd03cad8

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 12 ++++++++++++
 1 file changed, 12 insertions(+)
fda91fcc97c2c10ae090d1c82fe36c02c9e35e9a

 core/src/main/scala/kafka/admin/AclCommand.scala   | 26 +++++++++-------------
 .../scala/unit/kafka/admin/AclCommandTest.scala    | 16 ++++++-------
 docs/security.html                                 | 20 ++++++++---------
 3 files changed, 28 insertions(+), 34 deletions(-)
dacd21ec4e9028593faedeb7d2a4484394367612

 core/src/main/scala/kafka/admin/AclCommand.scala   | 26 +++++++++-------------
 .../scala/unit/kafka/admin/AclCommandTest.scala    | 16 ++++++-------
 docs/security.html                                 | 20 ++++++++---------
 3 files changed, 28 insertions(+), 34 deletions(-)
015862348002cc6d1148dda0555fe88c27998982

 .../main/java/org/apache/kafka/streams/StreamingConfig.java | 13 +++++++++++--
 .../kafka/streams/processor/internals/StreamThread.java     |  2 +-
 2 files changed, 12 insertions(+), 3 deletions(-)
1a36af80b79a634a652e594d8240924ac32376ae

 .../kafka/streams/kstream/KStreamBuilder.java      | 10 ++++++++
 .../streams/kstream/internals/KStreamImpl.java     | 29 ++++++++++++++++++++--
 .../kstream/internals/KStreamWindowedImpl.java     |  2 +-
 .../kafka/streams/kstream/KStreamBuilderTest.java  | 29 ++++++++++++++++++++++
 4 files changed, 67 insertions(+), 3 deletions(-)
723c6f2de2876a4d332f125446ca350cff63f602

 core/src/main/scala/kafka/admin/AdminClient.scala  |  3 ++
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 36 ++++++++++------------
 2 files changed, 19 insertions(+), 20 deletions(-)
ffc0965d38c364272078d771fc5ed5f8784e4012

 core/src/main/scala/kafka/admin/AdminClient.scala  |  3 ++
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 36 ++++++++++------------
 2 files changed, 19 insertions(+), 20 deletions(-)
15407302621a2d827bddbe8085759f6f74ff786d

 checkstyle/import-control.xml                         |  1 +
 .../org/apache/kafka/common/config/SslConfigs.java    |  7 ++++---
 .../apache/kafka/common/network/ChannelBuilders.java  | 19 +++++++++++++++++++
 .../kafka/common/network/PlaintextChannelBuilder.java |  5 +----
 .../kafka/common/network/SaslChannelBuilder.java      | 10 ++--------
 .../kafka/common/network/SslChannelBuilder.java       |  5 +----
 .../kafka/common/security/auth/PrincipalBuilder.java  |  2 ++
 .../kafka/clients/producer/KafkaProducerTest.java     |  4 +---
 .../org/apache/kafka/common/network/SelectorTest.java |  4 +---
 .../apache/kafka/common/network/SslSelectorTest.java  |  1 -
 .../kafka/common/network/SslTransportLayerTest.java   |  5 +++--
 11 files changed, 35 insertions(+), 28 deletions(-)
52d5e88393630ce6f817bd003c7c787e36e31277

 checkstyle/import-control.xml                         |  1 +
 .../org/apache/kafka/common/config/SslConfigs.java    |  7 ++++---
 .../apache/kafka/common/network/ChannelBuilders.java  | 19 +++++++++++++++++++
 .../kafka/common/network/PlaintextChannelBuilder.java |  5 +----
 .../kafka/common/network/SaslChannelBuilder.java      | 10 ++--------
 .../kafka/common/network/SslChannelBuilder.java       |  5 +----
 .../kafka/common/security/auth/PrincipalBuilder.java  |  2 ++
 .../kafka/clients/producer/KafkaProducerTest.java     |  4 +---
 .../org/apache/kafka/common/network/SelectorTest.java |  4 +---
 .../apache/kafka/common/network/SslSelectorTest.java  |  1 -
 .../kafka/common/network/SslTransportLayerTest.java   |  5 +++--
 11 files changed, 35 insertions(+), 28 deletions(-)
cae36f5c32e8e20ba36207015e8118b4ffb1ae24

 .../runtime/distributed/DistributedConfig.java     | 32 ++++++----------------
 1 file changed, 8 insertions(+), 24 deletions(-)
f1169f1da8728db842aca23dcb6fde740a400699

 .../runtime/distributed/DistributedConfig.java     | 32 ++++++----------------
 1 file changed, 8 insertions(+), 24 deletions(-)
1a7f37bcafae47a7f38e96c62d39c38d5479a776

 docs/security.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
ae315264dbc8a9efc5b5fbb1967a8a5df76dddb3

 docs/security.html | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
21ea9cbc0de08c303a9d12b2d36e2f7ee38ff113

 core/src/main/scala/kafka/cluster/Partition.scala  | 39 ++++++++++++----------
 .../main/scala/kafka/server/ReplicaManager.scala   | 29 +++++++++++-----
 2 files changed, 42 insertions(+), 26 deletions(-)
6df9e7ff2c6cfb3c7ca16f94928d0e86f3d087e2

 core/src/main/scala/kafka/cluster/Partition.scala  | 39 ++++++++++++----------
 .../main/scala/kafka/server/ReplicaManager.scala   | 29 +++++++++++-----
 2 files changed, 42 insertions(+), 26 deletions(-)
99d9ddc8e0e82c2e0ea579c85462f5d701319c81

 docs/api.html            |  8 ++--
 docs/configuration.html  | 14 +++----
 docs/connect.html        | 34 ++++++++---------
 docs/design.html         | 72 ++++++++++++++++++------------------
 docs/documentation.html  | 16 ++++----
 docs/ecosystem.html      |  6 +--
 docs/implementation.html | 55 ++++++++++++++-------------
 docs/introduction.html   | 20 +++++-----
 docs/migration.html      |  8 ++--
 docs/ops.html            | 96 ++++++++++++++++++++++++------------------------
 docs/quickstart.html     | 34 ++++++++---------
 docs/security.html       | 40 ++++++++++----------
 docs/upgrade.html        | 12 +++---
 docs/uses.html           | 20 +++++-----
 14 files changed, 217 insertions(+), 218 deletions(-)
6cbd97597ccf456a4f01f19553da5a03e12c9366

 docs/api.html            |  8 ++--
 docs/configuration.html  | 14 +++----
 docs/connect.html        | 34 ++++++++---------
 docs/design.html         | 72 ++++++++++++++++++------------------
 docs/documentation.html  | 16 ++++----
 docs/ecosystem.html      |  6 +--
 docs/implementation.html | 55 ++++++++++++++-------------
 docs/introduction.html   | 20 +++++-----
 docs/migration.html      |  8 ++--
 docs/ops.html            | 96 ++++++++++++++++++++++++------------------------
 docs/quickstart.html     | 34 ++++++++---------
 docs/security.html       | 40 ++++++++++----------
 docs/upgrade.html        | 12 +++---
 docs/uses.html           | 20 +++++-----
 14 files changed, 217 insertions(+), 218 deletions(-)
6483ae68507d3c864c9087116c6deb194620db18

 core/src/main/scala/kafka/admin/AdminClient.scala  |  16 +-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 542 ++++++++++++---------
 2 files changed, 310 insertions(+), 248 deletions(-)
5fc4546de7f238a8ee9c6f0b4fe276f0da47707c

 core/src/main/scala/kafka/admin/AdminClient.scala  |  16 +-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 542 ++++++++++++---------
 2 files changed, 310 insertions(+), 248 deletions(-)
4a3d244a2cb95654d18368de6e5b67661d4f4f10

 .../kafka/streams/processor/internals/StreamThread.java      | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)
45e7f71309f9a3e30d25a6ddd3171c67e3e79286

 .../org/apache/kafka/streams/StreamingConfig.java  |  10 ++
 .../streams/processor/internals/AbstractTask.java  |  93 ++++++++++
 .../internals/KafkaStreamingPartitionAssignor.java |   6 +-
 .../processor/internals/ProcessorStateManager.java | 103 ++++++++---
 .../processor/internals/StandbyContextImpl.java    | 164 ++++++++++++++++++
 .../streams/processor/internals/StandbyTask.java   |  88 ++++++++++
 .../streams/processor/internals/StreamTask.java    |  56 +-----
 .../streams/processor/internals/StreamThread.java  | 143 +++++++++++-----
 .../KafkaStreamingPartitionAssignorTest.java       | 174 ++++++++++++++-----
 .../internals/ProcessorStateManagerTest.java       |  93 ++++++++--
 .../processor/internals/StandbyTaskTest.java       | 190 +++++++++++++++++++++
 .../processor/internals/StreamThreadTest.java      |  12 +-
 12 files changed, 951 insertions(+), 181 deletions(-)
2261763bca19bb1ba578775e5cce98c2450311d9

 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
356544caba6448c6ba3bcdb38bea787e1fbc277b

 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e96b7239f3e918e9fc37a8d86433d41e56542137

 docs/documentation.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
f6d369b70d329af1cc882998aa517926aa9458ab

 docs/documentation.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
62e213523162ac9e80114b4e6f30bdf367f00ac1

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
599a31c245618651c7973d040de793376f43bd95

 docs/security.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
3c33858fb47697764a206e760f1051cb31f05129

 core/src/main/scala/kafka/admin/AclCommand.scala                      | 4 +---
 core/src/main/scala/kafka/security/auth/SimpleAclAuthorizer.scala     | 2 +-
 .../test/scala/unit/kafka/security/auth/SimpleAclAuthorizerTest.scala | 2 +-
 3 files changed, 3 insertions(+), 5 deletions(-)
8e6bae21c64699245cf24dbaac3942f32a2a241b

 core/src/main/scala/kafka/admin/AclCommand.scala                      | 4 +---
 core/src/main/scala/kafka/security/auth/SimpleAclAuthorizer.scala     | 2 +-
 .../test/scala/unit/kafka/security/auth/SimpleAclAuthorizerTest.scala | 2 +-
 3 files changed, 3 insertions(+), 5 deletions(-)
5d87eac856273ec505e96ed8d7f7a17fba474471

 docs/documentation.html | 2 +-
 docs/security.html      | 2 +-
 docs/upgrade.html       | 4 ++--
 3 files changed, 4 insertions(+), 4 deletions(-)
8857d279f7fab4acdcf8009c7b5f99614fceb061

 docs/documentation.html | 2 +-
 docs/security.html      | 2 +-
 docs/upgrade.html       | 4 ++--
 3 files changed, 4 insertions(+), 4 deletions(-)
5b39dcafc97600725937a8b0220a9f02dde6043b

 .../scala/kafka/coordinator/GroupMetadata.scala    |  4 ++
 .../kafka/coordinator/GroupMetadataManager.scala   | 54 ++++++++++++++++++----
 .../scala/kafka/coordinator/MemberMetadata.scala   |  3 ++
 3 files changed, 52 insertions(+), 9 deletions(-)
43ef0150bdc4ca349af61bf4c75dfb8fd8d14691

 .../scala/kafka/coordinator/GroupMetadata.scala    |  4 ++
 .../kafka/coordinator/GroupMetadataManager.scala   | 54 ++++++++++++++++++----
 .../scala/kafka/coordinator/MemberMetadata.scala   |  3 ++
 3 files changed, 52 insertions(+), 9 deletions(-)
a30a798120e67bf4b1481d0ad2227ebdd1d22ea5

 core/src/main/scala/kafka/admin/AdminClient.scala        | 16 +++++++++-------
 .../main/scala/kafka/admin/ConsumerGroupCommand.scala    | 16 ++++++++--------
 2 files changed, 17 insertions(+), 15 deletions(-)
a26dbcdf3ac57515cbc9a1c39d8c27e90f74188a

 core/src/main/scala/kafka/admin/AdminClient.scala        | 16 +++++++++-------
 .../main/scala/kafka/admin/ConsumerGroupCommand.scala    | 16 ++++++++--------
 2 files changed, 17 insertions(+), 15 deletions(-)
cc51733f47c9a0cdbfded52df4f194a256a43af2

 core/src/main/scala/kafka/cluster/Partition.scala  | 61 ++++++++++++++++------
 .../scala/kafka/coordinator/GroupCoordinator.scala | 25 ++++++---
 .../kafka/coordinator/GroupMetadataManager.scala   | 46 ++++++++--------
 3 files changed, 87 insertions(+), 45 deletions(-)
002ec9c796acf8570754522a4eb1b0c3ee9aab13

 core/src/main/scala/kafka/cluster/Partition.scala  | 61 ++++++++++++++++------
 .../scala/kafka/coordinator/GroupCoordinator.scala | 25 ++++++---
 .../kafka/coordinator/GroupMetadataManager.scala   | 46 ++++++++--------
 3 files changed, 87 insertions(+), 45 deletions(-)
002b6b088c61a2e935ef6500c6fe95992c89591b

 core/src/main/scala/kafka/tools/ConsoleProducer.scala | 14 ++++++--------
 1 file changed, 6 insertions(+), 8 deletions(-)
4efe4ac6d785c708ec623a6dca24ae34d4b29097

 core/src/main/scala/kafka/tools/ConsoleProducer.scala | 14 ++++++--------
 1 file changed, 6 insertions(+), 8 deletions(-)
397306cdfe22ea65ee39afae9ecdf11efd486dfa

 docs/api.html           |  2 +-
 docs/documentation.html |  2 +-
 docs/security.html      | 12 +++++++-----
 3 files changed, 9 insertions(+), 7 deletions(-)
26aae840081b398772261a3c34da7e3bdd8c5341

 docs/api.html           |  2 +-
 docs/documentation.html |  2 +-
 docs/security.html      | 12 +++++++-----
 3 files changed, 9 insertions(+), 7 deletions(-)
3e133c4eed95590fb63e1d57e3a1793dff6ecac2

 .../src/main/scala/kafka/common/StreamEndException.scala | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
4511aeebc3e37a3d9e2ebeabbd6bbfd16d681719

 .../src/main/scala/kafka/common/StreamEndException.scala | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
da97330915f5c9f73dc55288cc271818044e163f

 kafka-merge-pr.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
cb0de177cdc03b63ad1927aba1be292ef5637b68

 .../kafka/common/network/SslTransportLayer.java    | 27 ++++++++++++----------
 1 file changed, 15 insertions(+), 12 deletions(-)
528c78fd30b77e8c60e8b3645e7d44404fd4e013

 .../kafka/common/network/SslTransportLayer.java    | 27 ++++++++++++----------
 1 file changed, 15 insertions(+), 12 deletions(-)
b06ef94e22f34783e917f42d1659fd33891fabf2

 core/src/main/scala/kafka/common/StreamEndException.scala | 7 +++++++
 core/src/main/scala/kafka/consumer/BaseConsumer.scala     | 5 ++++-
 core/src/main/scala/kafka/tools/ConsoleConsumer.scala     | 8 ++++++--
 3 files changed, 17 insertions(+), 3 deletions(-)
4170847f1227b73a20645af1b5b2d88375e37426

 core/src/main/scala/kafka/common/StreamEndException.scala | 7 +++++++
 core/src/main/scala/kafka/consumer/BaseConsumer.scala     | 5 ++++-
 core/src/main/scala/kafka/tools/ConsoleConsumer.scala     | 8 ++++++--
 3 files changed, 17 insertions(+), 3 deletions(-)
969d0cb0ae316ba0dfdb34ed096bfd56fe86ad92

 tests/kafkatest/services/connect.py | 23 +++++++++++++++--------
 1 file changed, 15 insertions(+), 8 deletions(-)
e8f92d620360431548cca54d6545d1f44db12d2b

 tests/kafkatest/tests/mirror_maker_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2802bd081c9cfd91b8d7aa104c145ef0514ada49

 tests/kafkatest/tests/mirror_maker_test.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c4e069ae5647d10ec6186d7713b224e262bcee16

 tests/kafkatest/services/connect.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2991c9865d87a715717dbc1bae431a4d39631d9e

 tests/kafkatest/services/connect.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
431ffa21b0327da922f423ed77043dfb028601e2

 core/src/test/scala/integration/kafka/api/AdminClientTest.scala | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)
28d71ce5e06a17248f944147e850f3e5e029bdee

 core/src/test/scala/integration/kafka/api/AdminClientTest.scala | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)
d04a918a239b6d894f71975b6e1e6dcc390424a3

 tests/kafkatest/services/connect.py | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
1408c670ea576a430287182e9aaa26793917129a

 build.gradle                                       | 101 +++-------------
 checkstyle/import-control.xml                      |   1 +
 .../connect/tools/VerifiableSinkConnector.java     |  64 +++++++++++
 .../kafka/connect/tools/VerifiableSinkTask.java    | 109 ++++++++++++++++++
 .../connect/tools/VerifiableSourceConnector.java   |  64 +++++++++++
 .../kafka/connect/tools/VerifiableSourceTask.java  | 128 +++++++++++++++++++++
 .../connect/tools/VerifiableSinkConnector.java     |  64 -----------
 .../kafka/connect/tools/VerifiableSinkTask.java    | 109 ------------------
 .../connect/tools/VerifiableSourceConnector.java   |  64 -----------
 .../kafka/connect/tools/VerifiableSourceTask.java  | 128 ---------------------
 settings.gradle                                    |   2 +-
 .../apache/kafka/tools/ThroughputThrottler.java    |   2 +-
 12 files changed, 387 insertions(+), 449 deletions(-)
c5965820a1fe81c010770106b6ca03b315272f9b

 .../apache/kafka/common/config/AbstractConfig.java |  5 ++
 .../org/apache/kafka/common/config/ConfigDef.java  | 10 +++-
 .../org/apache/kafka/common/config/SslConfigs.java |  6 +-
 .../apache/kafka/common/config/types/Password.java | 68 ++++++++++++++++++++++
 .../kafka/common/security/ssl/SslFactory.java      | 23 ++++----
 .../apache/kafka/common/config/ConfigDefTest.java  | 26 ++++++++-
 .../common/network/SslTransportLayerTest.java      |  3 +-
 .../java/org/apache/kafka/test/TestSslUtils.java   | 31 +++++-----
 core/src/main/scala/kafka/server/KafkaConfig.scala | 12 ++--
 .../test/scala/unit/kafka/KafkaConfigTest.scala    | 17 ++++++
 10 files changed, 163 insertions(+), 38 deletions(-)
ab5ac264a71d7f895b21b4acfd93d9581dabd7c1

 .../apache/kafka/common/config/AbstractConfig.java |  5 ++
 .../org/apache/kafka/common/config/ConfigDef.java  | 10 +++-
 .../org/apache/kafka/common/config/SslConfigs.java |  6 +-
 .../apache/kafka/common/config/types/Password.java | 68 ++++++++++++++++++++++
 .../kafka/common/security/ssl/SslFactory.java      | 23 ++++----
 .../apache/kafka/common/config/ConfigDefTest.java  | 26 ++++++++-
 .../common/network/SslTransportLayerTest.java      |  3 +-
 .../java/org/apache/kafka/test/TestSslUtils.java   | 31 +++++-----
 core/src/main/scala/kafka/server/KafkaConfig.scala | 12 ++--
 .../test/scala/unit/kafka/KafkaConfigTest.scala    | 17 ++++++
 10 files changed, 163 insertions(+), 38 deletions(-)
370ce2b4b73b60ca52a4fbce246f3fd87b8dbf85

 .../streams/processor/internals/KafkaStreamingPartitionAssignorTest.java | 1 +
 1 file changed, 1 insertion(+)
98124930f39ca85fce79e79eaf4ad6687ba14143

 core/src/main/scala/kafka/admin/AdminClient.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
d9a455243e2350a18b5c734f0a6edaeb74ac6698

 core/src/main/scala/kafka/admin/AdminClient.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
3ded811928aab33a6ff0bcafe2e275b7d2c011c9

 docs/quickstart.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
2cf6218849a3634badaf70809923a31934182794

 docs/quickstart.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
c7b9ccb8798c2f6744d10ab1a2eb2fa0243f3f49

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d60e2ea581289a02efcef3b692bbb043fbdf3199

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
33809f5ebc9478528d6b5d150435d3169c5a64a4

 core/src/main/scala/kafka/network/SocketServer.scala | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
b5401f291a16977992c50f0a66d9f02aea07bbe7

 core/src/main/scala/kafka/network/SocketServer.scala | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
8c370093d1ee3b9ba97f85970ec30fbb26ff48ef

 .../org/apache/kafka/common/network/Selector.java    | 20 +++++++-------------
 1 file changed, 7 insertions(+), 13 deletions(-)
3fd168d9522d1ad25f5582fbe838cea15bdb525f

 .../org/apache/kafka/common/network/Selector.java    | 20 +++++++-------------
 1 file changed, 7 insertions(+), 13 deletions(-)
555fab913dc83a4a5174c53e1812be07b2b229ab

 tests/kafkatest/services/zookeeper.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
df88d3be75396b48a762149af2f4bbcd60fe69b9

 tests/kafkatest/services/zookeeper.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
39ea9d3b70341d58dfc9c9fa837229046d483868

 .../producer/internals/RecordAccumulator.java       | 21 +++++++++------------
 1 file changed, 9 insertions(+), 12 deletions(-)
1cd22ed33f1e1f63d8cb63f68309e5d8f43be1e1

 .../producer/internals/RecordAccumulator.java       | 21 +++++++++------------
 1 file changed, 9 insertions(+), 12 deletions(-)
124f73b1747a574982e9ca491712e6758ddbacea

 .../org/apache/kafka/streams/KafkaStreaming.java   |   5 +-
 .../org/apache/kafka/streams/StreamingConfig.java  |   8 +-
 .../kafka/streams/processor/PartitionGrouper.java  |   4 +
 .../org/apache/kafka/streams/processor/TaskId.java |  23 +-
 .../internals/KafkaStreamingPartitionAssignor.java | 187 +++++++++----
 .../streams/processor/internals/StreamThread.java  |  59 ++++-
 .../internals/assignment/AssignmentInfo.java       | 125 +++++++++
 .../internals/assignment/ClientState.java          |  72 +++++
 .../internals/assignment/SubscriptionInfo.java     | 128 +++++++++
 .../assignment/TaskAssignmentException.java        |  32 +++
 .../internals/assignment/TaskAssignor.java         | 195 ++++++++++++++
 .../KafkaStreamingPartitionAssignorTest.java       | 283 ++++++++++++++++++++
 .../processor/internals/StreamThreadTest.java      |  33 ++-
 .../internals/assignment/AssginmentInfoTest.java   |  45 ++++
 .../internals/assignment/SubscriptionInfoTest.java |  46 ++++
 .../internals/assignment/TaskAssignorTest.java     | 289 +++++++++++++++++++++
 16 files changed, 1464 insertions(+), 70 deletions(-)
c6b8de4e6806d8f9f4af57e15f2a7f4170265c42

 build.gradle                                       |  45 +++----
 .../kafka/common/utils/ThroughputThrottler.java    | 141 ---------------------
 .../kafka/connect/tools/VerifiableSourceTask.java  |   2 +-
 settings.gradle                                    |   2 +-
 .../apache/kafka/tools/ProducerPerformance.java    |   1 -
 .../apache/kafka/tools/ThroughputThrottler.java    | 141 +++++++++++++++++++++
 .../org/apache/kafka/tools/VerifiableProducer.java |   1 -
 7 files changed, 166 insertions(+), 167 deletions(-)
1828b8e52dd83a757580964d03b0148f19ef11fe

 .../org/apache/kafka/common/config/ConfigDef.java  |  12 +-
 docs/api.html                                      |   8 +-
 docs/documentation.html                            |   6 +
 docs/ops.html                                      |   6 +-
 docs/quickstart.html                               |   6 +-
 docs/security.html                                 | 133 ++++++++++++++++++++-
 docs/upgrade.html                                  |   3 +-
 7 files changed, 156 insertions(+), 18 deletions(-)
a8ccdc6154a1e10982cb80df82e8661903eb9ae5

 .../org/apache/kafka/common/config/ConfigDef.java  |  12 +-
 docs/api.html                                      |   8 +-
 docs/documentation.html                            |   6 +
 docs/ops.html                                      |   6 +-
 docs/quickstart.html                               |   6 +-
 docs/security.html                                 | 133 ++++++++++++++++++++-
 docs/upgrade.html                                  |   3 +-
 7 files changed, 156 insertions(+), 18 deletions(-)
0ea17e959a3912d6a7620a8de7e347a8fb038bbf

 .../consumer/internals/ConsumerCoordinator.java    |  2 ++
 .../kafka/clients/consumer/internals/Fetcher.java  |  6 +++-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 37 ++++++++++++++++++----
 tests/kafkatest/tests/mirror_maker_test.py         |  3 --
 4 files changed, 38 insertions(+), 10 deletions(-)
e0098b4567541d1c0cefc6f57ce38f67a9133b5e

 .../consumer/internals/ConsumerCoordinator.java    |  2 ++
 .../kafka/clients/consumer/internals/Fetcher.java  |  6 +++-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 37 ++++++++++++++++++----
 tests/kafkatest/tests/mirror_maker_test.py         |  3 --
 4 files changed, 38 insertions(+), 10 deletions(-)
57ada44d8e7cda3b2fdcde556ae4408db06d927d

 .../main/java/org/apache/kafka/common/network/SslTransportLayer.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ea702c384fcfb5a46c5d1354498e418c5801ed30

 .../main/java/org/apache/kafka/common/network/SslTransportLayer.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
04827e6e999c1b5e89e7dc8b1573ad263e66cd56

 .../src/main/java/org/apache/kafka/connect/tools/VerifiableSinkTask.java | 1 -
 1 file changed, 1 deletion(-)
9d9bb708bf59c93672306cd731b89d7df114bba7

 .../apache/kafka/clients/consumer/KafkaConsumer.java   | 18 +++++++++++++-----
 .../consumer/internals/AbstractCoordinator.java        |  1 +
 .../consumer/internals/ConsumerCoordinator.java        |  1 +
 .../consumer/internals/ConsumerNetworkClient.java      | 17 ++++++++++-------
 .../kafka/clients/consumer/internals/Fetcher.java      |  2 ++
 5 files changed, 27 insertions(+), 12 deletions(-)
8db55618d5d5d5de97feab2bf8da4dc45387a76a

 bin/kafka-run-class.sh                             |   2 +-
 build.gradle                                       |  65 ++++++++-
 checkstyle/import-control.xml                      |   4 +
 .../kafka/common/utils/ThroughputThrottler.java    | 141 +++++++++++++++++++
 .../apache/kafka/connect/source/SourceRecord.java  |   5 +
 .../kafka/connect/runtime/WorkerSinkTask.java      |   7 +
 .../connect/runtime/WorkerSinkTaskThread.java      |   6 +-
 .../kafka/connect/runtime/WorkerSourceTask.java    |   4 +-
 .../kafka/connect/runtime/rest/RestServer.java     |   4 +
 .../runtime/rest/resources/ConnectorsResource.java |   8 +-
 .../apache/kafka/connect/util/KafkaBasedLog.java   |   6 +
 .../connect/tools/VerifiableSinkConnector.java     |  64 +++++++++
 .../kafka/connect/tools/VerifiableSinkTask.java    | 110 +++++++++++++++
 .../connect/tools/VerifiableSourceConnector.java   |  64 +++++++++
 .../kafka/connect/tools/VerifiableSourceTask.java  | 128 +++++++++++++++++
 settings.gradle                                    |   2 +-
 tests/kafkatest/services/connect.py                | 154 +++++++++++++++++----
 tests/kafkatest/services/console_consumer.py       |   9 +-
 tests/kafkatest/services/kafka/kafka.py            |   7 +-
 .../services/kafka/templates/log4j.properties      |  87 ++++++++++++
 .../services/templates/connect_log4j.properties    |  30 ++++
 tests/kafkatest/tests/connect_distributed_test.py  | 133 +++++++++++++++---
 .../apache/kafka/tools/ProducerPerformance.java    |   1 +
 .../apache/kafka/tools/ThroughputThrottler.java    | 117 ----------------
 .../org/apache/kafka/tools/VerifiableProducer.java |   1 +
 25 files changed, 984 insertions(+), 175 deletions(-)
75db96e429de34373b92d8f4f5df508071b05127

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
64a1bfeb9b1b90c94cc62ee2587f9745c850ada3

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
501ac028273815f015cf97c8b48b4c34286cc1fb

 core/src/main/scala/kafka/admin/AclCommand.scala   | 62 ++++++++++++----------
 .../scala/unit/kafka/admin/AclCommandTest.scala    | 14 ++---
 2 files changed, 40 insertions(+), 36 deletions(-)
60c06734b345bbf292773e5b9206282ff3995968

 core/src/main/scala/kafka/admin/AclCommand.scala   | 62 ++++++++++++----------
 .../scala/unit/kafka/admin/AclCommandTest.scala    | 14 ++---
 2 files changed, 40 insertions(+), 36 deletions(-)
7508ec219022c02aedb401bb01e5fa183b0db5c1

 .../scala/kafka/coordinator/GroupMetadataManager.scala    | 15 ++++++---------
 1 file changed, 6 insertions(+), 9 deletions(-)
c455e608c1f2c7be6ff0a721f49c1fe3ede0165f

 .../scala/kafka/coordinator/GroupMetadataManager.scala    | 15 ++++++---------
 1 file changed, 6 insertions(+), 9 deletions(-)
c411ec808df33b9343e46ef7f812f1bd4b53d88d

 tests/README.md | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
1d884d1f60aec9ec7ea334761bead4c60b13c7a9

 tests/README.md | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
dd8a870e4df11cad009498ebfb9b6eac78f1652f

 .../main/java/org/apache/kafka/common/config/AbstractConfig.java  | 8 --------
 .../src/main/java/org/apache/kafka/connect/runtime/Worker.java    | 2 +-
 .../java/org/apache/kafka/connect/runtime/WorkerSinkTask.java     | 5 ++++-
 3 files changed, 5 insertions(+), 10 deletions(-)
403d89edeaa7808f71c0e7318411c925895210f2

 .../main/java/org/apache/kafka/common/config/AbstractConfig.java  | 8 --------
 .../src/main/java/org/apache/kafka/connect/runtime/Worker.java    | 2 +-
 .../java/org/apache/kafka/connect/runtime/WorkerSinkTask.java     | 5 ++++-
 3 files changed, 5 insertions(+), 10 deletions(-)
69f2ad8e22e7183946e076a8cda122aa0964fd9c

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java    |  2 +-
 .../clients/consumer/internals/AbstractCoordinator.java     | 13 +++++--------
 .../clients/consumer/internals/ConsumerCoordinatorTest.java |  4 ++--
 3 files changed, 8 insertions(+), 11 deletions(-)
ae5a5d7c08bb634576a414f6f2864c5b8a7e58a3

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java    |  2 +-
 .../clients/consumer/internals/AbstractCoordinator.java     | 13 +++++--------
 .../clients/consumer/internals/ConsumerCoordinatorTest.java |  4 ++--
 3 files changed, 8 insertions(+), 11 deletions(-)
528d555fc39b93a52e1781bdba00db96d8554350

 build.gradle | 36 +++++++++++++++++++-----------------
 1 file changed, 19 insertions(+), 17 deletions(-)
fe11488a7787732b6cc2ba306f745ea1f318208c

 build.gradle | 36 +++++++++++++++++++-----------------
 1 file changed, 19 insertions(+), 17 deletions(-)
a621677bee2f3855cedb2b1b20301199e62260bb

 .../java/org/apache/kafka/connect/runtime/WorkerSinkTask.java  | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)
590a4616a1030b3175ba5a548b5f1e1b49c323c2

 .../java/org/apache/kafka/connect/runtime/WorkerSinkTask.java  | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)
bce664b42a0c414dc19e2c07406cf6f14890cbd1

 bin/kafka-verifiable-consumer.sh                   |  20 +
 checkstyle/import-control.xml                      |   1 +
 .../kafka/clients/consumer/ConsumerRecords.java    |  24 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |   1 -
 .../scala/kafka/coordinator/GroupCoordinator.scala |   1 +
 tests/kafkatest/services/kafka/__init__.py         |   1 +
 tests/kafkatest/services/kafka/util.py             |  18 +
 tests/kafkatest/services/verifiable_consumer.py    | 222 ++++++++
 tests/kafkatest/services/verifiable_producer.py    |  15 +-
 tests/kafkatest/tests/consumer_test.py             | 157 ++++++
 .../org/apache/kafka/tools/VerifiableConsumer.java | 611 +++++++++++++++++++++
 11 files changed, 1059 insertions(+), 12 deletions(-)
e46959b624d2b1341fdc8b74a1571f78862fc140

 bin/kafka-verifiable-consumer.sh                   |  20 +
 checkstyle/import-control.xml                      |   1 +
 .../kafka/clients/consumer/ConsumerRecords.java    |  24 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |   1 -
 .../scala/kafka/coordinator/GroupCoordinator.scala |   1 +
 tests/kafkatest/services/kafka/__init__.py         |   1 +
 tests/kafkatest/services/kafka/util.py             |  18 +
 tests/kafkatest/services/verifiable_consumer.py    | 222 ++++++++
 tests/kafkatest/services/verifiable_producer.py    |  15 +-
 tests/kafkatest/tests/consumer_test.py             | 157 ++++++
 .../org/apache/kafka/tools/VerifiableConsumer.java | 611 +++++++++++++++++++++
 11 files changed, 1059 insertions(+), 12 deletions(-)
98b625780c1f524c1f4fa55e099c88eb8a036fca

 .../consumer/internals/AbstractCoordinator.java    |   1 +
 .../consumer/internals/ConsumerCoordinator.java    |   8 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  47 +++-
 .../kafka/api/PlaintextConsumerTest.scala          | 253 ++++++++++++++++++---
 4 files changed, 267 insertions(+), 42 deletions(-)
c9264b4c8904bf330b70cd84b433a7a141ec9d0e

 .../consumer/internals/AbstractCoordinator.java    |   1 +
 .../consumer/internals/ConsumerCoordinator.java    |   8 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  47 +++-
 .../kafka/api/PlaintextConsumerTest.scala          | 253 ++++++++++++++++++---
 4 files changed, 267 insertions(+), 42 deletions(-)
c6b93fa50de97c2fe79d5db98823a811c6743f69

 vagrant/broker.sh |  7 ++++---
 vagrant/zk.sh     | 13 +++++++------
 2 files changed, 11 insertions(+), 9 deletions(-)
2b97b6cc059d1d8f33d9ef943c758682015e776b

 .gitignore                                         |   4 +
 build.gradle                                       |   8 +-
 config/connect-console-sink.properties             |   2 +-
 config/connect-console-source.properties           |   2 +-
 config/connect-file-sink.properties                |   2 +-
 config/connect-file-source.properties              |   2 +-
 .../runtime/distributed/DistributedConfig.java     |   3 +
 docs/configuration.html                            |   5 +-
 docs/connect.html                                  | 328 +++++++++++++++++++++
 docs/documentation.html                            |  21 +-
 docs/quickstart.html                               |  62 ++++
 11 files changed, 431 insertions(+), 8 deletions(-)
2b382d6f92ed1d6f414529ce8d41089110ed560a

 bin/kafka-run-class.sh                             |   5 -
 build.gradle                                       |  59 +--
 checkstyle/import-control.xml                      |  14 -
 settings.gradle                                    |   2 +-
 .../org/apache/kafka/streams/KafkaStreaming.java   | 156 ------
 .../org/apache/kafka/streams/StreamingConfig.java  | 269 ----------
 .../org/apache/kafka/streams/StreamingMetrics.java |  27 -
 .../apache/kafka/streams/examples/KStreamJob.java  |  84 ---
 .../kafka/streams/examples/ProcessorJob.java       | 115 ----
 .../examples/WallclockTimestampExtractor.java      |  28 -
 .../org/apache/kafka/streams/kstream/KStream.java  | 180 -------
 .../kafka/streams/kstream/KStreamBuilder.java      |  74 ---
 .../kafka/streams/kstream/KStreamWindowed.java     |  38 --
 .../org/apache/kafka/streams/kstream/KeyValue.java |  34 --
 .../kafka/streams/kstream/KeyValueMapper.java      |  23 -
 .../apache/kafka/streams/kstream/Predicate.java    |  30 --
 .../streams/kstream/SlidingWindowSupplier.java     | 266 ----------
 .../apache/kafka/streams/kstream/Transformer.java  |  57 --
 .../kafka/streams/kstream/TransformerSupplier.java |  24 -
 .../apache/kafka/streams/kstream/ValueJoiner.java  |  23 -
 .../apache/kafka/streams/kstream/ValueMapper.java  |  23 -
 .../kafka/streams/kstream/ValueTransformer.java    |  56 --
 .../streams/kstream/ValueTransformerSupplier.java  |  24 -
 .../org/apache/kafka/streams/kstream/Window.java   |  36 --
 .../kafka/streams/kstream/WindowSupplier.java      |  25 -
 .../kstream/internals/FilteredIterator.java        |  63 ---
 .../streams/kstream/internals/KStreamBranch.java   |  52 --
 .../streams/kstream/internals/KStreamFilter.java   |  48 --
 .../streams/kstream/internals/KStreamFlatMap.java  |  47 --
 .../kstream/internals/KStreamFlatMapValues.java    |  47 --
 .../streams/kstream/internals/KStreamImpl.java     | 227 --------
 .../streams/kstream/internals/KStreamJoin.java     |  93 ----
 .../streams/kstream/internals/KStreamMap.java      |  46 --
 .../kstream/internals/KStreamMapValues.java        |  45 --
 .../kstream/internals/KStreamPassThrough.java      |  37 --
 .../kstream/internals/KStreamTransform.java        |  71 ---
 .../kstream/internals/KStreamTransformValues.java  |  69 ---
 .../streams/kstream/internals/KStreamWindow.java   |  68 ---
 .../kstream/internals/KStreamWindowedImpl.java     |  67 ---
 .../streams/kstream/internals/WindowSupport.java   | 159 ------
 .../kafka/streams/processor/AbstractProcessor.java |  71 ---
 .../streams/processor/DefaultPartitionGrouper.java |  73 ---
 .../kafka/streams/processor/PartitionGrouper.java  |  53 --
 .../apache/kafka/streams/processor/Processor.java  |  59 ---
 .../kafka/streams/processor/ProcessorContext.java  | 101 ----
 .../kafka/streams/processor/ProcessorSupplier.java |  23 -
 .../streams/processor/StateRestoreCallback.java    |  27 -
 .../apache/kafka/streams/processor/StateStore.java |  57 --
 .../streams/processor/StateStoreSupplier.java      |  25 -
 .../org/apache/kafka/streams/processor/TaskId.java |  66 ---
 .../streams/processor/TimestampExtractor.java      |  34 --
 .../kafka/streams/processor/TopologyBuilder.java   | 498 -----------------
 .../kafka/streams/processor/TopologyException.java |  38 --
 .../internals/KafkaStreamingPartitionAssignor.java | 135 -----
 .../processor/internals/MinTimestampTracker.java   |  67 ---
 .../processor/internals/PartitionGroup.java        | 170 ------
 .../processor/internals/ProcessorContextImpl.java  | 192 -------
 .../streams/processor/internals/ProcessorNode.java |  74 ---
 .../processor/internals/ProcessorStateManager.java | 231 --------
 .../processor/internals/ProcessorTopology.java     |  62 ---
 .../processor/internals/PunctuationQueue.java      |  56 --
 .../processor/internals/PunctuationSchedule.java   |  41 --
 .../streams/processor/internals/Punctuator.java    |  24 -
 .../streams/processor/internals/QuickUnion.java    |  67 ---
 .../processor/internals/RecordCollector.java       |  91 ----
 .../streams/processor/internals/RecordQueue.java   | 140 -----
 .../streams/processor/internals/SinkNode.java      |  64 ---
 .../streams/processor/internals/SourceNode.java    |  64 ---
 .../kafka/streams/processor/internals/Stamped.java |  38 --
 .../streams/processor/internals/StampedRecord.java |  52 --
 .../streams/processor/internals/StreamTask.java    | 378 -------------
 .../streams/processor/internals/StreamThread.java  | 586 ---------------------
 .../processor/internals/TimestampTracker.java      |  58 --
 .../java/org/apache/kafka/streams/state/Entry.java |  42 --
 .../state/InMemoryKeyValueStoreSupplier.java       | 155 ------
 .../state/InMemoryLRUCacheStoreSupplier.java       | 195 -------
 .../kafka/streams/state/KeyValueIterator.java      |  29 -
 .../apache/kafka/streams/state/KeyValueStore.java  |  86 ---
 .../kafka/streams/state/MeteredKeyValueStore.java  | 278 ----------
 .../kafka/streams/state/OffsetCheckpoint.java      | 172 ------
 .../state/RocksDBKeyValueStoreSupplier.java        | 298 -----------
 .../org/apache/kafka/streams/state/Serdes.java     | 161 ------
 .../org/apache/kafka/streams/state/Stores.java     | 278 ----------
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  51 --
 .../kstream/internals/FilteredIteratorTest.java    |  94 ----
 .../kstream/internals/KStreamBranchTest.java       |  90 ----
 .../kstream/internals/KStreamFilterTest.java       |  85 ---
 .../kstream/internals/KStreamFlatMapTest.java      |  80 ---
 .../internals/KStreamFlatMapValuesTest.java        |  77 ---
 .../streams/kstream/internals/KStreamImplTest.java | 137 -----
 .../streams/kstream/internals/KStreamJoinTest.java | 195 -------
 .../streams/kstream/internals/KStreamMapTest.java  |  73 ---
 .../kstream/internals/KStreamMapValuesTest.java    |  71 ---
 .../kstream/internals/KStreamTransformTest.java    |  93 ----
 .../internals/KStreamTransformValuesTest.java      |  92 ----
 .../kstream/internals/KStreamWindowedTest.java     |  91 ----
 .../processor/DefaultPartitionGrouperTest.java     |  84 ---
 .../streams/processor/TopologyBuilderTest.java     | 254 ---------
 .../internals/MinTimestampTrackerTest.java         |  93 ----
 .../processor/internals/PartitionGroupTest.java    | 102 ----
 .../internals/ProcessorStateManagerTest.java       | 407 --------------
 .../processor/internals/ProcessorTopologyTest.java | 311 -----------
 .../processor/internals/PunctuationQueueTest.java  |  85 ---
 .../processor/internals/QuickUnionTest.java        |  97 ----
 .../processor/internals/RecordQueueTest.java       | 116 ----
 .../processor/internals/StreamTaskTest.java        | 211 --------
 .../processor/internals/StreamThreadTest.java      | 464 ----------------
 .../streams/state/AbstractKeyValueStoreTest.java   | 193 -------
 .../streams/state/InMemoryKeyValueStoreTest.java   |  50 --
 .../streams/state/InMemoryLRUCacheStoreTest.java   | 155 ------
 .../streams/state/KeyValueStoreTestDriver.java     | 464 ----------------
 .../streams/state/RocksDBKeyValueStoreTest.java    |  52 --
 .../org/apache/kafka/streams/state/StateUtils.java |  77 ---
 .../org/apache/kafka/test/KStreamTestDriver.java   |  95 ----
 .../apache/kafka/test/MockProcessorContext.java    | 173 ------
 .../apache/kafka/test/MockProcessorSupplier.java   |  59 ---
 .../java/org/apache/kafka/test/MockSourceNode.java |  46 --
 .../apache/kafka/test/MockStateStoreSupplier.java  |  97 ----
 .../apache/kafka/test/MockTimestampExtractor.java  |  30 --
 .../kafka/test/ProcessorTopologyTestDriver.java    | 338 ------------
 .../org/apache/kafka/test/UnlimitedWindowDef.java  | 104 ----
 121 files changed, 2 insertions(+), 13604 deletions(-)
83eaf3284fe8535bd06743a367a469d3d01946b1

 .gitignore                                         |   1 +
 build.gradle                                       |   8 +-
 config/connect-console-sink.properties             |   2 +-
 config/connect-console-source.properties           |   2 +-
 config/connect-file-sink.properties                |   2 +-
 config/connect-file-source.properties              |   2 +-
 .../runtime/distributed/DistributedConfig.java     |   3 +
 docs/configuration.html                            |   5 +-
 docs/connect.html                                  | 328 +++++++++++++++++++++
 docs/documentation.html                            |  21 +-
 docs/quickstart.html                               |  62 ++++
 11 files changed, 428 insertions(+), 8 deletions(-)
c258868879dc5bc0fe7929d48626c44b85d3f100

 build.gradle | 8 ++++++++
 1 file changed, 8 insertions(+)
79bdc17ab4b0157ceb5257e6c4ff646a3fa55f6d

 build.gradle | 8 ++++++++
 1 file changed, 8 insertions(+)
e2794a79c8d2e8ae9cf30bfe10bbed34951a004b

 .gitignore | 4 ++++
 1 file changed, 4 insertions(+)
a8b263c5fbf6edd11fe15d7a05c6efb9d9a63aee

 core/src/main/scala/kafka/admin/AdminClient.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3ebb4ee1b0803b755eaefc3286fe107868b7b085

 core/src/main/scala/kafka/admin/AdminClient.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2e20898db8e34c15a8dc1146cc4a88d17da3f2a5

 docs/configuration.html | 158 +++++-------------------------------------------
 docs/documentation.html |   7 +--
 2 files changed, 19 insertions(+), 146 deletions(-)
a87b978223a827c34db1341b2da3e17e571c4464

 docs/configuration.html | 158 +++++-------------------------------------------
 docs/documentation.html |   7 +--
 2 files changed, 19 insertions(+), 146 deletions(-)
0977c03ec31c009a7bb9ae1bb678afe060aa0347

 .../consumer/ConsumerRebalanceListener.java        | 37 ++++++++++++----------
 1 file changed, 20 insertions(+), 17 deletions(-)
359be3a682951fd469d690df8d9e7a5a89a9d03b

 .../consumer/ConsumerRebalanceListener.java        | 37 ++++++++++++----------
 1 file changed, 20 insertions(+), 17 deletions(-)
e176fcc7fb146bf9be2d8d8f2a4f5e02f4753731

 README.md                                          |   2 +-
 build.gradle                                       |  51 +--
 contrib/LICENSE                                    |   1 -
 contrib/NOTICE                                     |   1 -
 contrib/hadoop-consumer/README                     |  66 ---
 contrib/hadoop-consumer/copy-jars.sh               |  69 ----
 contrib/hadoop-consumer/hadoop-setup.sh            |  20 -
 contrib/hadoop-consumer/run-class.sh               |  65 ---
 .../src/main/java/kafka/etl/KafkaETLContext.java   | 270 ------------
 .../main/java/kafka/etl/KafkaETLInputFormat.java   |  78 ----
 .../src/main/java/kafka/etl/KafkaETLJob.java       | 172 --------
 .../src/main/java/kafka/etl/KafkaETLKey.java       | 104 -----
 .../main/java/kafka/etl/KafkaETLRecordReader.java  | 180 --------
 .../src/main/java/kafka/etl/KafkaETLRequest.java   | 129 ------
 .../src/main/java/kafka/etl/KafkaETLUtils.java     | 205 ---------
 .../src/main/java/kafka/etl/Props.java             | 458 ---------------------
 .../java/kafka/etl/UndefinedPropertyException.java |  28 --
 .../main/java/kafka/etl/impl/DataGenerator.java    | 134 ------
 .../java/kafka/etl/impl/SimpleKafkaETLJob.java     | 104 -----
 .../java/kafka/etl/impl/SimpleKafkaETLMapper.java  |  91 ----
 contrib/hadoop-consumer/test/test.properties       |  42 --
 contrib/hadoop-producer/README.md                  |  94 -----
 .../java/kafka/bridge/examples/TextPublisher.java  |  66 ---
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     | 144 -------
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |  88 ----
 .../java/kafka/bridge/pig/AvroKafkaStorage.java    | 115 ------
 docs/api.html                                      |  20 +-
 docs/documentation.html                            |   2 +-
 docs/implementation.html                           |  88 ++--
 settings.gradle                                    |   4 +-
 30 files changed, 54 insertions(+), 2837 deletions(-)
69af573b35f04657e31f60e636aba19ffa0b2c84

 README.md                                          |   2 +-
 build.gradle                                       |  51 +--
 contrib/LICENSE                                    |   1 -
 contrib/NOTICE                                     |   1 -
 contrib/hadoop-consumer/README                     |  66 ---
 contrib/hadoop-consumer/copy-jars.sh               |  69 ----
 contrib/hadoop-consumer/hadoop-setup.sh            |  20 -
 contrib/hadoop-consumer/run-class.sh               |  65 ---
 .../src/main/java/kafka/etl/KafkaETLContext.java   | 270 ------------
 .../main/java/kafka/etl/KafkaETLInputFormat.java   |  78 ----
 .../src/main/java/kafka/etl/KafkaETLJob.java       | 172 --------
 .../src/main/java/kafka/etl/KafkaETLKey.java       | 104 -----
 .../main/java/kafka/etl/KafkaETLRecordReader.java  | 180 --------
 .../src/main/java/kafka/etl/KafkaETLRequest.java   | 129 ------
 .../src/main/java/kafka/etl/KafkaETLUtils.java     | 205 ---------
 .../src/main/java/kafka/etl/Props.java             | 458 ---------------------
 .../java/kafka/etl/UndefinedPropertyException.java |  28 --
 .../main/java/kafka/etl/impl/DataGenerator.java    | 134 ------
 .../java/kafka/etl/impl/SimpleKafkaETLJob.java     | 104 -----
 .../java/kafka/etl/impl/SimpleKafkaETLMapper.java  |  91 ----
 contrib/hadoop-consumer/test/test.properties       |  42 --
 contrib/hadoop-producer/README.md                  |  94 -----
 .../java/kafka/bridge/examples/TextPublisher.java  |  66 ---
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     | 144 -------
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |  88 ----
 .../java/kafka/bridge/pig/AvroKafkaStorage.java    | 115 ------
 docs/api.html                                      |  20 +-
 docs/documentation.html                            |   2 +-
 docs/implementation.html                           |  88 ++--
 settings.gradle                                    |   4 +-
 30 files changed, 54 insertions(+), 2837 deletions(-)
f22ea2970a81e84effd633a3fe0daf6815816e82

 tests/kafkatest/sanity_checks/test_mirror_maker.py |  90 -----------
 tests/kafkatest/services/kafka/config.py           |   2 +-
 tests/kafkatest/services/kafka/kafka.py            |   2 +-
 tests/kafkatest/services/mirror_maker.py           |  30 +++-
 .../templates/mirror_maker_consumer.properties     |  29 ++++
 .../templates/mirror_maker_producer.properties     |  21 +++
 .../services/templates/tools_log4j.properties      |   4 +-
 tests/kafkatest/services/verifiable_producer.py    |   4 -
 tests/kafkatest/services/zookeeper.py              |   3 +
 tests/kafkatest/tests/mirror_maker_test.py         | 164 +++++++++++++++++++++
 tests/kafkatest/tests/produce_consume_validate.py  |  15 +-
 11 files changed, 252 insertions(+), 112 deletions(-)
7073fa7efea4acd6615f9dad4f649f6094be6332

 tests/kafkatest/sanity_checks/test_mirror_maker.py |  90 -----------
 tests/kafkatest/services/kafka/config.py           |   2 +-
 tests/kafkatest/services/kafka/kafka.py            |   2 +-
 tests/kafkatest/services/mirror_maker.py           |  30 +++-
 .../templates/mirror_maker_consumer.properties     |  29 ++++
 .../templates/mirror_maker_producer.properties     |  21 +++
 .../services/templates/tools_log4j.properties      |   4 +-
 tests/kafkatest/services/verifiable_producer.py    |   4 -
 tests/kafkatest/services/zookeeper.py              |   3 +
 tests/kafkatest/tests/mirror_maker_test.py         | 164 +++++++++++++++++++++
 tests/kafkatest/tests/produce_consume_validate.py  |  15 +-
 11 files changed, 252 insertions(+), 112 deletions(-)
0d2fdfa81566c6645dbc818fbd3722ddda90b87c

 .../org/apache/kafka/connect/util/KafkaBasedLogTest.java  | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)
75f2b8c8b42459a3ab2962f75f0e05fbbb9e8333

 .../org/apache/kafka/connect/util/KafkaBasedLogTest.java  | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)
4069011ee4dc0f3500190bb93a3b79180cd34eda

 .../main/java/org/apache/kafka/connect/runtime/Worker.java   |  9 +++++++++
 .../org/apache/kafka/connect/runtime/WorkerSourceTask.java   | 12 ++++++++++--
 2 files changed, 19 insertions(+), 2 deletions(-)
13ba57dcfc45e60de281cc55125e7446322308ba

 .../main/java/org/apache/kafka/connect/runtime/Worker.java   |  9 +++++++++
 .../org/apache/kafka/connect/runtime/WorkerSourceTask.java   | 12 ++++++++++--
 2 files changed, 19 insertions(+), 2 deletions(-)
e627558a5e62d185c88650af845d7b74e9c290f8

 .../connect/errors/AlreadyExistsException.java     | 35 ++++++++++++++++++++++
 .../kafka/connect/errors/NotFoundException.java    | 35 ++++++++++++++++++++++
 .../kafka/connect/errors/RetriableException.java   | 35 ++++++++++++++++++++++
 .../connect/errors/AlreadyExistsException.java     | 35 ----------------------
 .../kafka/connect/errors/NotFoundException.java    | 35 ----------------------
 .../kafka/connect/errors/RetriableException.java   | 35 ----------------------
 6 files changed, 105 insertions(+), 105 deletions(-)
bc76e6704e8f14d59bb5d4fcf9bdf544c9e463bf

 .../connect/errors/AlreadyExistsException.java     | 35 ++++++++++++++++++++++
 .../kafka/connect/errors/NotFoundException.java    | 35 ++++++++++++++++++++++
 .../kafka/connect/errors/RetriableException.java   | 35 ++++++++++++++++++++++
 .../connect/errors/AlreadyExistsException.java     | 35 ----------------------
 .../kafka/connect/errors/NotFoundException.java    | 35 ----------------------
 .../kafka/connect/errors/RetriableException.java   | 35 ----------------------
 6 files changed, 105 insertions(+), 105 deletions(-)
3aa3e85d942b514cbe842a6b3c3fe214c0ecf401

 .../scala/kafka/coordinator/GroupMetadataManager.scala     | 14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)
2b04004de878823fe631af1f3f85108c0b38caec

 .../scala/kafka/coordinator/GroupMetadataManager.scala     | 14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)
7471394c5485a2114d35c6345d95e161a0ee6586

 .../src/main/java/org/apache/kafka/connect/json/JsonConverter.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
e9fc7b8c84908ae642339a2522a79f8bb5155728

 .../src/main/java/org/apache/kafka/connect/json/JsonConverter.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
fdefef9536acf8569607a980a25237ef4794f645

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a24f9a23a6d8759538e91072e8d96d158d03bb63

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
02fbdaa4475fd12a0fdccaa103bf27cbc1bfd077

 .../org/apache/kafka/common/network/SslTransportLayer.java  | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)
efbebc6e843850b7ed9a1d015413c99f114a7d92

 .../org/apache/kafka/common/network/SslTransportLayer.java  | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)
417e283d643d8865aa3e79dffa373c8cc853d78f

 bin/connect-distributed.sh                         |  23 +
 bin/connect-standalone.sh                          |  23 +
 bin/copycat-distributed.sh                         |  23 -
 bin/copycat-standalone.sh                          |  23 -
 bin/kafka-run-class.sh                             |   6 +-
 build.gradle                                       |  48 +-
 checkstyle/import-control.xml                      |  30 +-
 .../consumer/internals/AbstractCoordinator.java    |   2 +-
 config/connect-console-sink.properties             |  19 +
 config/connect-console-source.properties           |  19 +
 config/connect-distributed.properties              |  42 +
 config/connect-file-sink.properties                |  20 +
 config/connect-file-source.properties              |  20 +
 config/connect-log4j.properties                    |  23 +
 config/connect-standalone.properties               |  37 +
 config/copycat-console-sink.properties             |  19 -
 config/copycat-console-source.properties           |  19 -
 config/copycat-distributed.properties              |  42 -
 config/copycat-file-sink.properties                |  20 -
 config/copycat-file-source.properties              |  20 -
 config/copycat-log4j.properties                    |  23 -
 config/copycat-standalone.properties               |  37 -
 .../kafka/connect/connector/ConnectRecord.java     | 122 +++
 .../apache/kafka/connect/connector/Connector.java  | 124 +++
 .../kafka/connect/connector/ConnectorContext.java  |  33 +
 .../org/apache/kafka/connect/connector/Task.java   |  56 ++
 .../apache/kafka/connect/data/ConnectSchema.java   | 323 ++++++++
 .../java/org/apache/kafka/connect/data/Date.java   |  76 ++
 .../org/apache/kafka/connect/data/Decimal.java     |  87 ++
 .../java/org/apache/kafka/connect/data/Field.java  |  77 ++
 .../java/org/apache/kafka/connect/data/Schema.java | 163 ++++
 .../apache/kafka/connect/data/SchemaAndValue.java  |  62 ++
 .../apache/kafka/connect/data/SchemaBuilder.java   | 412 +++++++++
 .../apache/kafka/connect/data/SchemaProjector.java | 197 +++++
 .../java/org/apache/kafka/connect/data/Struct.java | 265 ++++++
 .../java/org/apache/kafka/connect/data/Time.java   |  77 ++
 .../org/apache/kafka/connect/data/Timestamp.java   |  64 ++
 .../kafka/connect/errors/ConnectException.java     |  40 +
 .../apache/kafka/connect/errors/DataException.java |  35 +
 .../errors/IllegalWorkerStateException.java        |  35 +
 .../connect/errors/SchemaBuilderException.java     |  32 +
 .../connect/errors/SchemaProjectorException.java   |  29 +
 .../apache/kafka/connect/sink/SinkConnector.java   |  40 +
 .../org/apache/kafka/connect/sink/SinkRecord.java  |  72 ++
 .../org/apache/kafka/connect/sink/SinkTask.java    | 107 +++
 .../apache/kafka/connect/sink/SinkTaskContext.java |  82 ++
 .../kafka/connect/source/SourceConnector.java      |  29 +
 .../apache/kafka/connect/source/SourceRecord.java  | 109 +++
 .../apache/kafka/connect/source/SourceTask.java    |  82 ++
 .../kafka/connect/source/SourceTaskContext.java    |  32 +
 .../apache/kafka/connect/storage/Converter.java    |  57 ++
 .../kafka/connect/storage/OffsetStorageReader.java |  65 ++
 .../kafka/connect/storage/StringConverter.java     |  81 ++
 .../apache/kafka/connect/util/ConnectorUtils.java  |  66 ++
 .../connector/ConnectorReconfigurationTest.java    |  82 ++
 .../kafka/connect/data/ConnectSchemaTest.java      | 303 +++++++
 .../org/apache/kafka/connect/data/DateTest.java    |  78 ++
 .../org/apache/kafka/connect/data/DecimalTest.java |  63 ++
 .../org/apache/kafka/connect/data/FieldTest.java   |  40 +
 .../kafka/connect/data/SchemaBuilderTest.java      | 305 +++++++
 .../kafka/connect/data/SchemaProjectorTest.java    | 495 +++++++++++
 .../org/apache/kafka/connect/data/StructTest.java  | 222 +++++
 .../org/apache/kafka/connect/data/TimeTest.java    |  80 ++
 .../apache/kafka/connect/data/TimestampTest.java   |  75 ++
 .../kafka/connect/storage/StringConverterTest.java |  83 ++
 .../kafka/connect/util/ConnectorUtilsTest.java     |  67 ++
 .../connect/file/FileStreamSinkConnector.java      |  69 ++
 .../kafka/connect/file/FileStreamSinkTask.java     |  94 +++
 .../connect/file/FileStreamSourceConnector.java    |  77 ++
 .../kafka/connect/file/FileStreamSourceTask.java   | 216 +++++
 .../connect/file/FileStreamSinkConnectorTest.java  |  86 ++
 .../kafka/connect/file/FileStreamSinkTaskTest.java |  69 ++
 .../file/FileStreamSourceConnectorTest.java        | 105 +++
 .../connect/file/FileStreamSourceTaskTest.java     | 150 ++++
 .../apache/kafka/connect/json/JsonConverter.java   | 735 ++++++++++++++++
 .../kafka/connect/json/JsonDeserializer.java       |  62 ++
 .../org/apache/kafka/connect/json/JsonSchema.java  |  82 ++
 .../apache/kafka/connect/json/JsonSerializer.java  |  60 ++
 .../kafka/connect/json/JsonConverterTest.java      | 644 +++++++++++++++
 .../kafka/connect/cli/ConnectDistributed.java      |  67 ++
 .../kafka/connect/cli/ConnectStandalone.java       |  98 +++
 .../connect/errors/AlreadyExistsException.java     |  35 +
 .../kafka/connect/errors/NotFoundException.java    |  35 +
 .../kafka/connect/errors/RetriableException.java   |  35 +
 .../org/apache/kafka/connect/runtime/Connect.java  |  99 +++
 .../kafka/connect/runtime/ConnectorConfig.java     |  73 ++
 .../org/apache/kafka/connect/runtime/Herder.java   | 148 ++++
 .../connect/runtime/HerderConnectorContext.java    |  42 +
 .../connect/runtime/SourceTaskOffsetCommitter.java | 139 ++++
 .../apache/kafka/connect/runtime/TaskConfig.java   |  54 ++
 .../org/apache/kafka/connect/runtime/Worker.java   | 331 ++++++++
 .../apache/kafka/connect/runtime/WorkerConfig.java | 138 ++++
 .../kafka/connect/runtime/WorkerSinkTask.java      | 370 +++++++++
 .../connect/runtime/WorkerSinkTaskContext.java     | 111 +++
 .../connect/runtime/WorkerSinkTaskThread.java      | 116 +++
 .../kafka/connect/runtime/WorkerSourceTask.java    | 339 ++++++++
 .../connect/runtime/WorkerSourceTaskContext.java   |  35 +
 .../apache/kafka/connect/runtime/WorkerTask.java   |  54 ++
 .../runtime/distributed/ClusterConfigState.java    | 145 ++++
 .../runtime/distributed/ConnectProtocol.java       | 269 ++++++
 .../runtime/distributed/DistributedConfig.java     | 187 +++++
 .../runtime/distributed/DistributedHerder.java     | 920 +++++++++++++++++++++
 .../runtime/distributed/NotLeaderException.java    |  47 ++
 .../runtime/distributed/WorkerCoordinator.java     | 294 +++++++
 .../runtime/distributed/WorkerGroupMember.java     | 185 +++++
 .../distributed/WorkerRebalanceListener.java       |  38 +
 .../kafka/connect/runtime/rest/RestServer.java     | 258 ++++++
 .../runtime/rest/entities/ConnectorInfo.java       |  81 ++
 .../rest/entities/CreateConnectorRequest.java      |  59 ++
 .../runtime/rest/entities/ErrorMessage.java        |  63 ++
 .../connect/runtime/rest/entities/ServerInfo.java  |  41 +
 .../connect/runtime/rest/entities/TaskInfo.java    |  58 ++
 .../rest/errors/ConnectExceptionMapper.java        |  60 ++
 .../runtime/rest/errors/ConnectRestException.java  |  70 ++
 .../runtime/rest/resources/ConnectorsResource.java | 201 +++++
 .../runtime/rest/resources/RootResource.java       |  36 +
 .../runtime/standalone/StandaloneConfig.java       |  35 +
 .../runtime/standalone/StandaloneHerder.java       | 272 ++++++
 .../connect/storage/FileOffsetBackingStore.java    | 102 +++
 .../kafka/connect/storage/KafkaConfigStorage.java  | 578 +++++++++++++
 .../connect/storage/KafkaOffsetBackingStore.java   | 213 +++++
 .../connect/storage/MemoryOffsetBackingStore.java  | 105 +++
 .../kafka/connect/storage/OffsetBackingStore.java  |  72 ++
 .../connect/storage/OffsetStorageReaderImpl.java   | 110 +++
 .../kafka/connect/storage/OffsetStorageWriter.java | 207 +++++
 .../apache/kafka/connect/storage/OffsetUtils.java  |  54 ++
 .../org/apache/kafka/connect/util/Callback.java    |  31 +
 .../apache/kafka/connect/util/ConnectorTaskId.java |  85 ++
 .../connect/util/ConvertingFutureCallback.java     |  85 ++
 .../apache/kafka/connect/util/FutureCallback.java  |  34 +
 .../apache/kafka/connect/util/KafkaBasedLog.java   | 331 ++++++++
 .../kafka/connect/util/ShutdownableThread.java     | 145 ++++
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 208 +++++
 .../runtime/WorkerSinkTaskThreadedTest.java        | 563 +++++++++++++
 .../connect/runtime/WorkerSourceTaskTest.java      | 308 +++++++
 .../apache/kafka/connect/runtime/WorkerTest.java   | 397 +++++++++
 .../runtime/distributed/DistributedHerderTest.java | 573 +++++++++++++
 .../runtime/distributed/WorkerCoordinatorTest.java | 443 ++++++++++
 .../rest/resources/ConnectorsResourceTest.java     | 364 ++++++++
 .../runtime/standalone/StandaloneHerderTest.java   | 337 ++++++++
 .../storage/FileOffsetBackingStoreTest.java        | 117 +++
 .../connect/storage/KafkaConfigStorageTest.java    | 522 ++++++++++++
 .../storage/KafkaOffsetBackingStoreTest.java       | 357 ++++++++
 .../connect/storage/OffsetStorageWriterTest.java   | 272 ++++++
 .../util/ByteArrayProducerRecordEquals.java        |  53 ++
 .../kafka/connect/util/KafkaBasedLogTest.java      | 437 ++++++++++
 .../org/apache/kafka/connect/util/MockTime.java    |  49 ++
 .../kafka/connect/util/ShutdownableThreadTest.java |  72 ++
 .../util/TestBackgroundThreadExceptionHandler.java |  37 +
 .../org/apache/kafka/connect/util/TestFuture.java  | 161 ++++
 .../apache/kafka/connect/util/ThreadedTest.java    |  43 +
 .../runtime/src/test/resources/log4j.properties    |  23 +
 .../apache/kafka/copycat/connector/Connector.java  | 124 ---
 .../kafka/copycat/connector/ConnectorContext.java  |  33 -
 .../kafka/copycat/connector/CopycatRecord.java     | 122 ---
 .../org/apache/kafka/copycat/connector/Task.java   |  56 --
 .../apache/kafka/copycat/data/CopycatSchema.java   | 323 --------
 .../java/org/apache/kafka/copycat/data/Date.java   |  76 --
 .../org/apache/kafka/copycat/data/Decimal.java     |  87 --
 .../java/org/apache/kafka/copycat/data/Field.java  |  77 --
 .../java/org/apache/kafka/copycat/data/Schema.java | 163 ----
 .../apache/kafka/copycat/data/SchemaAndValue.java  |  62 --
 .../apache/kafka/copycat/data/SchemaBuilder.java   | 412 ---------
 .../apache/kafka/copycat/data/SchemaProjector.java | 197 -----
 .../java/org/apache/kafka/copycat/data/Struct.java | 265 ------
 .../java/org/apache/kafka/copycat/data/Time.java   |  77 --
 .../org/apache/kafka/copycat/data/Timestamp.java   |  64 --
 .../kafka/copycat/errors/CopycatException.java     |  40 -
 .../apache/kafka/copycat/errors/DataException.java |  35 -
 .../errors/IllegalWorkerStateException.java        |  35 -
 .../copycat/errors/SchemaBuilderException.java     |  32 -
 .../copycat/errors/SchemaProjectorException.java   |  29 -
 .../apache/kafka/copycat/sink/SinkConnector.java   |  40 -
 .../org/apache/kafka/copycat/sink/SinkRecord.java  |  72 --
 .../org/apache/kafka/copycat/sink/SinkTask.java    | 107 ---
 .../apache/kafka/copycat/sink/SinkTaskContext.java |  82 --
 .../kafka/copycat/source/SourceConnector.java      |  29 -
 .../apache/kafka/copycat/source/SourceRecord.java  | 109 ---
 .../apache/kafka/copycat/source/SourceTask.java    |  82 --
 .../kafka/copycat/source/SourceTaskContext.java    |  32 -
 .../apache/kafka/copycat/storage/Converter.java    |  57 --
 .../kafka/copycat/storage/OffsetStorageReader.java |  65 --
 .../kafka/copycat/storage/StringConverter.java     |  81 --
 .../apache/kafka/copycat/util/ConnectorUtils.java  |  66 --
 .../connector/ConnectorReconfigurationTest.java    |  82 --
 .../kafka/copycat/data/CopycatSchemaTest.java      | 303 -------
 .../org/apache/kafka/copycat/data/DateTest.java    |  78 --
 .../org/apache/kafka/copycat/data/DecimalTest.java |  63 --
 .../org/apache/kafka/copycat/data/FieldTest.java   |  40 -
 .../kafka/copycat/data/SchemaBuilderTest.java      | 305 -------
 .../kafka/copycat/data/SchemaProjectorTest.java    | 495 -----------
 .../org/apache/kafka/copycat/data/StructTest.java  | 222 -----
 .../org/apache/kafka/copycat/data/TimeTest.java    |  80 --
 .../apache/kafka/copycat/data/TimestampTest.java   |  75 --
 .../kafka/copycat/storage/StringConverterTest.java |  83 --
 .../kafka/copycat/util/ConnectorUtilsTest.java     |  67 --
 .../copycat/file/FileStreamSinkConnector.java      |  69 --
 .../kafka/copycat/file/FileStreamSinkTask.java     |  94 ---
 .../copycat/file/FileStreamSourceConnector.java    |  77 --
 .../kafka/copycat/file/FileStreamSourceTask.java   | 216 -----
 .../copycat/file/FileStreamSinkConnectorTest.java  |  86 --
 .../kafka/copycat/file/FileStreamSinkTaskTest.java |  69 --
 .../file/FileStreamSourceConnectorTest.java        | 105 ---
 .../copycat/file/FileStreamSourceTaskTest.java     | 150 ----
 .../apache/kafka/copycat/json/JsonConverter.java   | 735 ----------------
 .../kafka/copycat/json/JsonDeserializer.java       |  62 --
 .../org/apache/kafka/copycat/json/JsonSchema.java  |  82 --
 .../apache/kafka/copycat/json/JsonSerializer.java  |  60 --
 .../kafka/copycat/json/JsonConverterTest.java      | 644 ---------------
 .../kafka/copycat/cli/CopycatDistributed.java      |  67 --
 .../kafka/copycat/cli/CopycatStandalone.java       |  98 ---
 .../copycat/errors/AlreadyExistsException.java     |  35 -
 .../kafka/copycat/errors/NotFoundException.java    |  35 -
 .../kafka/copycat/errors/RetriableException.java   |  35 -
 .../kafka/copycat/runtime/ConnectorConfig.java     |  74 --
 .../org/apache/kafka/copycat/runtime/Copycat.java  |  99 ---
 .../org/apache/kafka/copycat/runtime/Herder.java   | 148 ----
 .../copycat/runtime/HerderConnectorContext.java    |  42 -
 .../copycat/runtime/SourceTaskOffsetCommitter.java | 139 ----
 .../apache/kafka/copycat/runtime/TaskConfig.java   |  54 --
 .../org/apache/kafka/copycat/runtime/Worker.java   | 331 --------
 .../apache/kafka/copycat/runtime/WorkerConfig.java | 138 ----
 .../kafka/copycat/runtime/WorkerSinkTask.java      | 370 ---------
 .../copycat/runtime/WorkerSinkTaskContext.java     | 111 ---
 .../copycat/runtime/WorkerSinkTaskThread.java      | 116 ---
 .../kafka/copycat/runtime/WorkerSourceTask.java    | 339 --------
 .../copycat/runtime/WorkerSourceTaskContext.java   |  35 -
 .../apache/kafka/copycat/runtime/WorkerTask.java   |  54 --
 .../runtime/distributed/ClusterConfigState.java    | 145 ----
 .../runtime/distributed/CopycatProtocol.java       | 269 ------
 .../runtime/distributed/DistributedConfig.java     | 187 -----
 .../runtime/distributed/DistributedHerder.java     | 920 ---------------------
 .../runtime/distributed/NotLeaderException.java    |  47 --
 .../runtime/distributed/WorkerCoordinator.java     | 293 -------
 .../runtime/distributed/WorkerGroupMember.java     | 185 -----
 .../distributed/WorkerRebalanceListener.java       |  38 -
 .../kafka/copycat/runtime/rest/RestServer.java     | 258 ------
 .../runtime/rest/entities/ConnectorInfo.java       |  81 --
 .../rest/entities/CreateConnectorRequest.java      |  59 --
 .../runtime/rest/entities/ErrorMessage.java        |  63 --
 .../copycat/runtime/rest/entities/ServerInfo.java  |  41 -
 .../copycat/runtime/rest/entities/TaskInfo.java    |  58 --
 .../rest/errors/CopycatExceptionMapper.java        |  60 --
 .../runtime/rest/errors/CopycatRestException.java  |  70 --
 .../runtime/rest/resources/ConnectorsResource.java | 201 -----
 .../runtime/rest/resources/RootResource.java       |  36 -
 .../runtime/standalone/StandaloneConfig.java       |  35 -
 .../runtime/standalone/StandaloneHerder.java       | 272 ------
 .../copycat/storage/FileOffsetBackingStore.java    | 102 ---
 .../kafka/copycat/storage/KafkaConfigStorage.java  | 578 -------------
 .../copycat/storage/KafkaOffsetBackingStore.java   | 213 -----
 .../copycat/storage/MemoryOffsetBackingStore.java  | 105 ---
 .../kafka/copycat/storage/OffsetBackingStore.java  |  72 --
 .../copycat/storage/OffsetStorageReaderImpl.java   | 110 ---
 .../kafka/copycat/storage/OffsetStorageWriter.java | 207 -----
 .../apache/kafka/copycat/storage/OffsetUtils.java  |  54 --
 .../org/apache/kafka/copycat/util/Callback.java    |  31 -
 .../apache/kafka/copycat/util/ConnectorTaskId.java |  85 --
 .../copycat/util/ConvertingFutureCallback.java     |  85 --
 .../apache/kafka/copycat/util/FutureCallback.java  |  34 -
 .../apache/kafka/copycat/util/KafkaBasedLog.java   | 331 --------
 .../kafka/copycat/util/ShutdownableThread.java     | 145 ----
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  | 208 -----
 .../runtime/WorkerSinkTaskThreadedTest.java        | 563 -------------
 .../copycat/runtime/WorkerSourceTaskTest.java      | 308 -------
 .../apache/kafka/copycat/runtime/WorkerTest.java   | 397 ---------
 .../runtime/distributed/DistributedHerderTest.java | 573 -------------
 .../runtime/distributed/WorkerCoordinatorTest.java | 443 ----------
 .../rest/resources/ConnectorsResourceTest.java     | 364 --------
 .../runtime/standalone/StandaloneHerderTest.java   | 337 --------
 .../storage/FileOffsetBackingStoreTest.java        | 117 ---
 .../copycat/storage/KafkaConfigStorageTest.java    | 522 ------------
 .../storage/KafkaOffsetBackingStoreTest.java       | 357 --------
 .../copycat/storage/OffsetStorageWriterTest.java   | 272 ------
 .../util/ByteArrayProducerRecordEquals.java        |  53 --
 .../kafka/copycat/util/KafkaBasedLogTest.java      | 437 ----------
 .../org/apache/kafka/copycat/util/MockTime.java    |  49 --
 .../kafka/copycat/util/ShutdownableThreadTest.java |  72 --
 .../util/TestBackgroundThreadExceptionHandler.java |  37 -
 .../org/apache/kafka/copycat/util/TestFuture.java  | 161 ----
 .../apache/kafka/copycat/util/ThreadedTest.java    |  43 -
 .../runtime/src/test/resources/log4j.properties    |  23 -
 .../coordinator/GroupCoordinatorResponseTest.scala |   2 +-
 docs/security.html                                 |   2 +-
 settings.gradle                                    |   2 +-
 tests/kafkatest/services/connect.py                | 191 +++++
 tests/kafkatest/services/copycat.py                | 191 -----
 tests/kafkatest/tests/connect_distributed_test.py  |  97 +++
 tests/kafkatest/tests/connect_rest_test.py         | 163 ++++
 tests/kafkatest/tests/connect_test.py              |  93 +++
 tests/kafkatest/tests/copycat_distributed_test.py  |  97 ---
 tests/kafkatest/tests/copycat_rest_test.py         | 163 ----
 tests/kafkatest/tests/copycat_test.py              |  93 ---
 .../tests/templates/connect-distributed.properties |  40 +
 .../tests/templates/connect-file-sink.properties   |  20 +
 .../tests/templates/connect-file-source.properties |  20 +
 .../tests/templates/connect-standalone.properties  |  32 +
 .../tests/templates/copycat-distributed.properties |  40 -
 .../tests/templates/copycat-file-sink.properties   |  20 -
 .../tests/templates/copycat-file-source.properties |  20 -
 .../tests/templates/copycat-standalone.properties  |  32 -
 301 files changed, 21527 insertions(+), 21527 deletions(-)
f2031d40639ef34c1591c22971394ef41c87652c

 bin/connect-distributed.sh                         |  23 +
 bin/connect-standalone.sh                          |  23 +
 bin/copycat-distributed.sh                         |  23 -
 bin/copycat-standalone.sh                          |  23 -
 bin/kafka-run-class.sh                             |   6 +-
 build.gradle                                       |  48 +-
 checkstyle/import-control.xml                      |  30 +-
 .../consumer/internals/AbstractCoordinator.java    |   2 +-
 config/connect-console-sink.properties             |  19 +
 config/connect-console-source.properties           |  19 +
 config/connect-distributed.properties              |  42 +
 config/connect-file-sink.properties                |  20 +
 config/connect-file-source.properties              |  20 +
 config/connect-log4j.properties                    |  23 +
 config/connect-standalone.properties               |  37 +
 config/copycat-console-sink.properties             |  19 -
 config/copycat-console-source.properties           |  19 -
 config/copycat-distributed.properties              |  42 -
 config/copycat-file-sink.properties                |  20 -
 config/copycat-file-source.properties              |  20 -
 config/copycat-log4j.properties                    |  23 -
 config/copycat-standalone.properties               |  37 -
 .../kafka/connect/connector/ConnectRecord.java     | 122 +++
 .../apache/kafka/connect/connector/Connector.java  | 124 +++
 .../kafka/connect/connector/ConnectorContext.java  |  33 +
 .../org/apache/kafka/connect/connector/Task.java   |  56 ++
 .../apache/kafka/connect/data/ConnectSchema.java   | 323 ++++++++
 .../java/org/apache/kafka/connect/data/Date.java   |  76 ++
 .../org/apache/kafka/connect/data/Decimal.java     |  87 ++
 .../java/org/apache/kafka/connect/data/Field.java  |  77 ++
 .../java/org/apache/kafka/connect/data/Schema.java | 163 ++++
 .../apache/kafka/connect/data/SchemaAndValue.java  |  62 ++
 .../apache/kafka/connect/data/SchemaBuilder.java   | 412 +++++++++
 .../apache/kafka/connect/data/SchemaProjector.java | 197 +++++
 .../java/org/apache/kafka/connect/data/Struct.java | 265 ++++++
 .../java/org/apache/kafka/connect/data/Time.java   |  77 ++
 .../org/apache/kafka/connect/data/Timestamp.java   |  64 ++
 .../kafka/connect/errors/ConnectException.java     |  40 +
 .../apache/kafka/connect/errors/DataException.java |  35 +
 .../errors/IllegalWorkerStateException.java        |  35 +
 .../connect/errors/SchemaBuilderException.java     |  32 +
 .../connect/errors/SchemaProjectorException.java   |  29 +
 .../apache/kafka/connect/sink/SinkConnector.java   |  40 +
 .../org/apache/kafka/connect/sink/SinkRecord.java  |  72 ++
 .../org/apache/kafka/connect/sink/SinkTask.java    | 107 +++
 .../apache/kafka/connect/sink/SinkTaskContext.java |  82 ++
 .../kafka/connect/source/SourceConnector.java      |  29 +
 .../apache/kafka/connect/source/SourceRecord.java  | 109 +++
 .../apache/kafka/connect/source/SourceTask.java    |  82 ++
 .../kafka/connect/source/SourceTaskContext.java    |  32 +
 .../apache/kafka/connect/storage/Converter.java    |  57 ++
 .../kafka/connect/storage/OffsetStorageReader.java |  65 ++
 .../kafka/connect/storage/StringConverter.java     |  81 ++
 .../apache/kafka/connect/util/ConnectorUtils.java  |  66 ++
 .../connector/ConnectorReconfigurationTest.java    |  82 ++
 .../kafka/connect/data/ConnectSchemaTest.java      | 303 +++++++
 .../org/apache/kafka/connect/data/DateTest.java    |  78 ++
 .../org/apache/kafka/connect/data/DecimalTest.java |  63 ++
 .../org/apache/kafka/connect/data/FieldTest.java   |  40 +
 .../kafka/connect/data/SchemaBuilderTest.java      | 305 +++++++
 .../kafka/connect/data/SchemaProjectorTest.java    | 495 +++++++++++
 .../org/apache/kafka/connect/data/StructTest.java  | 222 +++++
 .../org/apache/kafka/connect/data/TimeTest.java    |  80 ++
 .../apache/kafka/connect/data/TimestampTest.java   |  75 ++
 .../kafka/connect/storage/StringConverterTest.java |  83 ++
 .../kafka/connect/util/ConnectorUtilsTest.java     |  67 ++
 .../connect/file/FileStreamSinkConnector.java      |  69 ++
 .../kafka/connect/file/FileStreamSinkTask.java     |  94 +++
 .../connect/file/FileStreamSourceConnector.java    |  77 ++
 .../kafka/connect/file/FileStreamSourceTask.java   | 216 +++++
 .../connect/file/FileStreamSinkConnectorTest.java  |  86 ++
 .../kafka/connect/file/FileStreamSinkTaskTest.java |  69 ++
 .../file/FileStreamSourceConnectorTest.java        | 105 +++
 .../connect/file/FileStreamSourceTaskTest.java     | 150 ++++
 .../apache/kafka/connect/json/JsonConverter.java   | 735 ++++++++++++++++
 .../kafka/connect/json/JsonDeserializer.java       |  62 ++
 .../org/apache/kafka/connect/json/JsonSchema.java  |  82 ++
 .../apache/kafka/connect/json/JsonSerializer.java  |  60 ++
 .../kafka/connect/json/JsonConverterTest.java      | 644 +++++++++++++++
 .../kafka/connect/cli/ConnectDistributed.java      |  67 ++
 .../kafka/connect/cli/ConnectStandalone.java       |  98 +++
 .../connect/errors/AlreadyExistsException.java     |  35 +
 .../kafka/connect/errors/NotFoundException.java    |  35 +
 .../kafka/connect/errors/RetriableException.java   |  35 +
 .../org/apache/kafka/connect/runtime/Connect.java  |  99 +++
 .../kafka/connect/runtime/ConnectorConfig.java     |  73 ++
 .../org/apache/kafka/connect/runtime/Herder.java   | 148 ++++
 .../connect/runtime/HerderConnectorContext.java    |  42 +
 .../connect/runtime/SourceTaskOffsetCommitter.java | 139 ++++
 .../apache/kafka/connect/runtime/TaskConfig.java   |  54 ++
 .../org/apache/kafka/connect/runtime/Worker.java   | 331 ++++++++
 .../apache/kafka/connect/runtime/WorkerConfig.java | 138 ++++
 .../kafka/connect/runtime/WorkerSinkTask.java      | 370 +++++++++
 .../connect/runtime/WorkerSinkTaskContext.java     | 111 +++
 .../connect/runtime/WorkerSinkTaskThread.java      | 116 +++
 .../kafka/connect/runtime/WorkerSourceTask.java    | 339 ++++++++
 .../connect/runtime/WorkerSourceTaskContext.java   |  35 +
 .../apache/kafka/connect/runtime/WorkerTask.java   |  54 ++
 .../runtime/distributed/ClusterConfigState.java    | 145 ++++
 .../runtime/distributed/ConnectProtocol.java       | 269 ++++++
 .../runtime/distributed/DistributedConfig.java     | 187 +++++
 .../runtime/distributed/DistributedHerder.java     | 920 +++++++++++++++++++++
 .../runtime/distributed/NotLeaderException.java    |  47 ++
 .../runtime/distributed/WorkerCoordinator.java     | 294 +++++++
 .../runtime/distributed/WorkerGroupMember.java     | 185 +++++
 .../distributed/WorkerRebalanceListener.java       |  38 +
 .../kafka/connect/runtime/rest/RestServer.java     | 258 ++++++
 .../runtime/rest/entities/ConnectorInfo.java       |  81 ++
 .../rest/entities/CreateConnectorRequest.java      |  59 ++
 .../runtime/rest/entities/ErrorMessage.java        |  63 ++
 .../connect/runtime/rest/entities/ServerInfo.java  |  41 +
 .../connect/runtime/rest/entities/TaskInfo.java    |  58 ++
 .../rest/errors/ConnectExceptionMapper.java        |  60 ++
 .../runtime/rest/errors/ConnectRestException.java  |  70 ++
 .../runtime/rest/resources/ConnectorsResource.java | 201 +++++
 .../runtime/rest/resources/RootResource.java       |  36 +
 .../runtime/standalone/StandaloneConfig.java       |  35 +
 .../runtime/standalone/StandaloneHerder.java       | 272 ++++++
 .../connect/storage/FileOffsetBackingStore.java    | 102 +++
 .../kafka/connect/storage/KafkaConfigStorage.java  | 578 +++++++++++++
 .../connect/storage/KafkaOffsetBackingStore.java   | 213 +++++
 .../connect/storage/MemoryOffsetBackingStore.java  | 105 +++
 .../kafka/connect/storage/OffsetBackingStore.java  |  72 ++
 .../connect/storage/OffsetStorageReaderImpl.java   | 110 +++
 .../kafka/connect/storage/OffsetStorageWriter.java | 207 +++++
 .../apache/kafka/connect/storage/OffsetUtils.java  |  54 ++
 .../org/apache/kafka/connect/util/Callback.java    |  31 +
 .../apache/kafka/connect/util/ConnectorTaskId.java |  85 ++
 .../connect/util/ConvertingFutureCallback.java     |  85 ++
 .../apache/kafka/connect/util/FutureCallback.java  |  34 +
 .../apache/kafka/connect/util/KafkaBasedLog.java   | 331 ++++++++
 .../kafka/connect/util/ShutdownableThread.java     | 145 ++++
 .../kafka/connect/runtime/WorkerSinkTaskTest.java  | 208 +++++
 .../runtime/WorkerSinkTaskThreadedTest.java        | 563 +++++++++++++
 .../connect/runtime/WorkerSourceTaskTest.java      | 308 +++++++
 .../apache/kafka/connect/runtime/WorkerTest.java   | 397 +++++++++
 .../runtime/distributed/DistributedHerderTest.java | 573 +++++++++++++
 .../runtime/distributed/WorkerCoordinatorTest.java | 443 ++++++++++
 .../rest/resources/ConnectorsResourceTest.java     | 364 ++++++++
 .../runtime/standalone/StandaloneHerderTest.java   | 337 ++++++++
 .../storage/FileOffsetBackingStoreTest.java        | 117 +++
 .../connect/storage/KafkaConfigStorageTest.java    | 522 ++++++++++++
 .../storage/KafkaOffsetBackingStoreTest.java       | 357 ++++++++
 .../connect/storage/OffsetStorageWriterTest.java   | 272 ++++++
 .../util/ByteArrayProducerRecordEquals.java        |  53 ++
 .../kafka/connect/util/KafkaBasedLogTest.java      | 437 ++++++++++
 .../org/apache/kafka/connect/util/MockTime.java    |  49 ++
 .../kafka/connect/util/ShutdownableThreadTest.java |  72 ++
 .../util/TestBackgroundThreadExceptionHandler.java |  37 +
 .../org/apache/kafka/connect/util/TestFuture.java  | 161 ++++
 .../apache/kafka/connect/util/ThreadedTest.java    |  43 +
 .../runtime/src/test/resources/log4j.properties    |  23 +
 .../apache/kafka/copycat/connector/Connector.java  | 124 ---
 .../kafka/copycat/connector/ConnectorContext.java  |  33 -
 .../kafka/copycat/connector/CopycatRecord.java     | 122 ---
 .../org/apache/kafka/copycat/connector/Task.java   |  56 --
 .../apache/kafka/copycat/data/CopycatSchema.java   | 323 --------
 .../java/org/apache/kafka/copycat/data/Date.java   |  76 --
 .../org/apache/kafka/copycat/data/Decimal.java     |  87 --
 .../java/org/apache/kafka/copycat/data/Field.java  |  77 --
 .../java/org/apache/kafka/copycat/data/Schema.java | 163 ----
 .../apache/kafka/copycat/data/SchemaAndValue.java  |  62 --
 .../apache/kafka/copycat/data/SchemaBuilder.java   | 412 ---------
 .../apache/kafka/copycat/data/SchemaProjector.java | 197 -----
 .../java/org/apache/kafka/copycat/data/Struct.java | 265 ------
 .../java/org/apache/kafka/copycat/data/Time.java   |  77 --
 .../org/apache/kafka/copycat/data/Timestamp.java   |  64 --
 .../kafka/copycat/errors/CopycatException.java     |  40 -
 .../apache/kafka/copycat/errors/DataException.java |  35 -
 .../errors/IllegalWorkerStateException.java        |  35 -
 .../copycat/errors/SchemaBuilderException.java     |  32 -
 .../copycat/errors/SchemaProjectorException.java   |  29 -
 .../apache/kafka/copycat/sink/SinkConnector.java   |  40 -
 .../org/apache/kafka/copycat/sink/SinkRecord.java  |  72 --
 .../org/apache/kafka/copycat/sink/SinkTask.java    | 107 ---
 .../apache/kafka/copycat/sink/SinkTaskContext.java |  82 --
 .../kafka/copycat/source/SourceConnector.java      |  29 -
 .../apache/kafka/copycat/source/SourceRecord.java  | 109 ---
 .../apache/kafka/copycat/source/SourceTask.java    |  82 --
 .../kafka/copycat/source/SourceTaskContext.java    |  32 -
 .../apache/kafka/copycat/storage/Converter.java    |  57 --
 .../kafka/copycat/storage/OffsetStorageReader.java |  65 --
 .../kafka/copycat/storage/StringConverter.java     |  81 --
 .../apache/kafka/copycat/util/ConnectorUtils.java  |  66 --
 .../connector/ConnectorReconfigurationTest.java    |  82 --
 .../kafka/copycat/data/CopycatSchemaTest.java      | 303 -------
 .../org/apache/kafka/copycat/data/DateTest.java    |  78 --
 .../org/apache/kafka/copycat/data/DecimalTest.java |  63 --
 .../org/apache/kafka/copycat/data/FieldTest.java   |  40 -
 .../kafka/copycat/data/SchemaBuilderTest.java      | 305 -------
 .../kafka/copycat/data/SchemaProjectorTest.java    | 495 -----------
 .../org/apache/kafka/copycat/data/StructTest.java  | 222 -----
 .../org/apache/kafka/copycat/data/TimeTest.java    |  80 --
 .../apache/kafka/copycat/data/TimestampTest.java   |  75 --
 .../kafka/copycat/storage/StringConverterTest.java |  83 --
 .../kafka/copycat/util/ConnectorUtilsTest.java     |  67 --
 .../copycat/file/FileStreamSinkConnector.java      |  69 --
 .../kafka/copycat/file/FileStreamSinkTask.java     |  94 ---
 .../copycat/file/FileStreamSourceConnector.java    |  77 --
 .../kafka/copycat/file/FileStreamSourceTask.java   | 216 -----
 .../copycat/file/FileStreamSinkConnectorTest.java  |  86 --
 .../kafka/copycat/file/FileStreamSinkTaskTest.java |  69 --
 .../file/FileStreamSourceConnectorTest.java        | 105 ---
 .../copycat/file/FileStreamSourceTaskTest.java     | 150 ----
 .../apache/kafka/copycat/json/JsonConverter.java   | 735 ----------------
 .../kafka/copycat/json/JsonDeserializer.java       |  62 --
 .../org/apache/kafka/copycat/json/JsonSchema.java  |  82 --
 .../apache/kafka/copycat/json/JsonSerializer.java  |  60 --
 .../kafka/copycat/json/JsonConverterTest.java      | 644 ---------------
 .../kafka/copycat/cli/CopycatDistributed.java      |  67 --
 .../kafka/copycat/cli/CopycatStandalone.java       |  98 ---
 .../copycat/errors/AlreadyExistsException.java     |  35 -
 .../kafka/copycat/errors/NotFoundException.java    |  35 -
 .../kafka/copycat/errors/RetriableException.java   |  35 -
 .../kafka/copycat/runtime/ConnectorConfig.java     |  74 --
 .../org/apache/kafka/copycat/runtime/Copycat.java  |  99 ---
 .../org/apache/kafka/copycat/runtime/Herder.java   | 148 ----
 .../copycat/runtime/HerderConnectorContext.java    |  42 -
 .../copycat/runtime/SourceTaskOffsetCommitter.java | 139 ----
 .../apache/kafka/copycat/runtime/TaskConfig.java   |  54 --
 .../org/apache/kafka/copycat/runtime/Worker.java   | 331 --------
 .../apache/kafka/copycat/runtime/WorkerConfig.java | 138 ----
 .../kafka/copycat/runtime/WorkerSinkTask.java      | 370 ---------
 .../copycat/runtime/WorkerSinkTaskContext.java     | 111 ---
 .../copycat/runtime/WorkerSinkTaskThread.java      | 116 ---
 .../kafka/copycat/runtime/WorkerSourceTask.java    | 339 --------
 .../copycat/runtime/WorkerSourceTaskContext.java   |  35 -
 .../apache/kafka/copycat/runtime/WorkerTask.java   |  54 --
 .../runtime/distributed/ClusterConfigState.java    | 145 ----
 .../runtime/distributed/CopycatProtocol.java       | 269 ------
 .../runtime/distributed/DistributedConfig.java     | 187 -----
 .../runtime/distributed/DistributedHerder.java     | 920 ---------------------
 .../runtime/distributed/NotLeaderException.java    |  47 --
 .../runtime/distributed/WorkerCoordinator.java     | 293 -------
 .../runtime/distributed/WorkerGroupMember.java     | 185 -----
 .../distributed/WorkerRebalanceListener.java       |  38 -
 .../kafka/copycat/runtime/rest/RestServer.java     | 258 ------
 .../runtime/rest/entities/ConnectorInfo.java       |  81 --
 .../rest/entities/CreateConnectorRequest.java      |  59 --
 .../runtime/rest/entities/ErrorMessage.java        |  63 --
 .../copycat/runtime/rest/entities/ServerInfo.java  |  41 -
 .../copycat/runtime/rest/entities/TaskInfo.java    |  58 --
 .../rest/errors/CopycatExceptionMapper.java        |  60 --
 .../runtime/rest/errors/CopycatRestException.java  |  70 --
 .../runtime/rest/resources/ConnectorsResource.java | 201 -----
 .../runtime/rest/resources/RootResource.java       |  36 -
 .../runtime/standalone/StandaloneConfig.java       |  35 -
 .../runtime/standalone/StandaloneHerder.java       | 272 ------
 .../copycat/storage/FileOffsetBackingStore.java    | 102 ---
 .../kafka/copycat/storage/KafkaConfigStorage.java  | 578 -------------
 .../copycat/storage/KafkaOffsetBackingStore.java   | 213 -----
 .../copycat/storage/MemoryOffsetBackingStore.java  | 105 ---
 .../kafka/copycat/storage/OffsetBackingStore.java  |  72 --
 .../copycat/storage/OffsetStorageReaderImpl.java   | 110 ---
 .../kafka/copycat/storage/OffsetStorageWriter.java | 207 -----
 .../apache/kafka/copycat/storage/OffsetUtils.java  |  54 --
 .../org/apache/kafka/copycat/util/Callback.java    |  31 -
 .../apache/kafka/copycat/util/ConnectorTaskId.java |  85 --
 .../copycat/util/ConvertingFutureCallback.java     |  85 --
 .../apache/kafka/copycat/util/FutureCallback.java  |  34 -
 .../apache/kafka/copycat/util/KafkaBasedLog.java   | 331 --------
 .../kafka/copycat/util/ShutdownableThread.java     | 145 ----
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  | 208 -----
 .../runtime/WorkerSinkTaskThreadedTest.java        | 563 -------------
 .../copycat/runtime/WorkerSourceTaskTest.java      | 308 -------
 .../apache/kafka/copycat/runtime/WorkerTest.java   | 397 ---------
 .../runtime/distributed/DistributedHerderTest.java | 573 -------------
 .../runtime/distributed/WorkerCoordinatorTest.java | 443 ----------
 .../rest/resources/ConnectorsResourceTest.java     | 364 --------
 .../runtime/standalone/StandaloneHerderTest.java   | 337 --------
 .../storage/FileOffsetBackingStoreTest.java        | 117 ---
 .../copycat/storage/KafkaConfigStorageTest.java    | 522 ------------
 .../storage/KafkaOffsetBackingStoreTest.java       | 357 --------
 .../copycat/storage/OffsetStorageWriterTest.java   | 272 ------
 .../util/ByteArrayProducerRecordEquals.java        |  53 --
 .../kafka/copycat/util/KafkaBasedLogTest.java      | 437 ----------
 .../org/apache/kafka/copycat/util/MockTime.java    |  49 --
 .../kafka/copycat/util/ShutdownableThreadTest.java |  72 --
 .../util/TestBackgroundThreadExceptionHandler.java |  37 -
 .../org/apache/kafka/copycat/util/TestFuture.java  | 161 ----
 .../apache/kafka/copycat/util/ThreadedTest.java    |  43 -
 .../runtime/src/test/resources/log4j.properties    |  23 -
 .../coordinator/GroupCoordinatorResponseTest.scala |   2 +-
 docs/security.html                                 |   2 +-
 settings.gradle                                    |   2 +-
 tests/kafkatest/services/connect.py                | 191 +++++
 tests/kafkatest/services/copycat.py                | 191 -----
 tests/kafkatest/tests/connect_distributed_test.py  |  97 +++
 tests/kafkatest/tests/connect_rest_test.py         | 163 ++++
 tests/kafkatest/tests/connect_test.py              |  93 +++
 tests/kafkatest/tests/copycat_distributed_test.py  |  97 ---
 tests/kafkatest/tests/copycat_rest_test.py         | 163 ----
 tests/kafkatest/tests/copycat_test.py              |  93 ---
 .../tests/templates/connect-distributed.properties |  40 +
 .../tests/templates/connect-file-sink.properties   |  20 +
 .../tests/templates/connect-file-source.properties |  20 +
 .../tests/templates/connect-standalone.properties  |  32 +
 .../tests/templates/copycat-distributed.properties |  40 -
 .../tests/templates/copycat-file-sink.properties   |  20 -
 .../tests/templates/copycat-file-source.properties |  20 -
 .../tests/templates/copycat-standalone.properties  |  32 -
 301 files changed, 21527 insertions(+), 21527 deletions(-)
48013222fd426685d2907a760290d2e7c7d25aea

 vagrant/broker.sh |  7 ++++---
 vagrant/zk.sh     | 13 +++++++------
 2 files changed, 11 insertions(+), 9 deletions(-)
1fd79f57b4a73308c59b797974086ca09af19b98

 .../org/apache/kafka/copycat/sink/SinkTask.java    |   5 +
 .../kafka/copycat/errors/RetriableException.java   |  35 ++
 .../kafka/copycat/runtime/WorkerSinkTask.java      | 116 ++++-
 .../copycat/runtime/WorkerSinkTaskContext.java     |  11 +
 .../kafka/copycat/runtime/WorkerSourceTask.java    |   7 +
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  | 496 ++----------------
 .../runtime/WorkerSinkTaskThreadedTest.java        | 563 +++++++++++++++++++++
 7 files changed, 763 insertions(+), 470 deletions(-)
f4b87deefecf4902992a84d4a3fe3b99a94ff72b

 .../org/apache/kafka/copycat/sink/SinkTask.java    |   5 +
 .../kafka/copycat/errors/RetriableException.java   |  35 ++
 .../kafka/copycat/runtime/WorkerSinkTask.java      | 116 ++++-
 .../copycat/runtime/WorkerSinkTaskContext.java     |  11 +
 .../kafka/copycat/runtime/WorkerSourceTask.java    |   7 +
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  | 496 ++----------------
 .../runtime/WorkerSinkTaskThreadedTest.java        | 563 +++++++++++++++++++++
 7 files changed, 763 insertions(+), 470 deletions(-)
32cd3e35f1ea8251a51860cc48a44fb2fbfd7c0e

 .../src/main/scala/kafka/coordinator/GroupCoordinator.scala | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)
83fb734603376d1c9ef1d88bcb5f160da5522e45

 .../src/main/scala/kafka/coordinator/GroupCoordinator.scala | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)
27d44afe664bff45d62f72335fdbb56671561512

 .../clients/consumer/CommitFailedException.java    | 35 +++++++++
 .../clients/consumer/InvalidOffsetException.java   | 34 +++++++++
 .../kafka/clients/consumer/KafkaConsumer.java      | 65 ++++++++++-------
 .../kafka/clients/consumer/MockConsumer.java       |  2 +-
 .../consumer/NoOffsetForPartitionException.java    | 25 +++++--
 .../consumer/OffsetOutOfRangeException.java        | 42 +++++++++++
 .../consumer/internals/AbstractCoordinator.java    |  1 +
 .../consumer/internals/ConsumerCoordinator.java    | 84 +++++++++++++---------
 .../consumer/internals/ConsumerNetworkClient.java  | 16 ++++-
 .../kafka/clients/consumer/internals/Fetcher.java  | 37 ++++++----
 .../common/errors/OffsetOutOfRangeException.java   | 50 -------------
 .../org/apache/kafka/common/protocol/Errors.java   |  2 +-
 .../internals/ConsumerCoordinatorTest.java         | 33 ++++++++-
 .../clients/consumer/internals/FetcherTest.java    |  2 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |  2 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |  3 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  2 +-
 .../kafka/api/PlaintextConsumerTest.scala          |  4 +-
 18 files changed, 300 insertions(+), 139 deletions(-)
34d9976656893abcec3d24c54b367eeb091c101d

 core/src/main/scala/kafka/consumer/BaseConsumer.scala | 15 ++++++++++++---
 core/src/main/scala/kafka/tools/ConsoleConsumer.scala |  9 ++++++---
 2 files changed, 18 insertions(+), 6 deletions(-)
23cc9c77b27889bb7d71d7ea74b80ab96c4529ae

 .../clients/consumer/CommitFailedException.java    | 35 +++++++++
 .../clients/consumer/InvalidOffsetException.java   | 34 +++++++++
 .../kafka/clients/consumer/KafkaConsumer.java      | 65 ++++++++++-------
 .../kafka/clients/consumer/MockConsumer.java       |  2 +-
 .../consumer/NoOffsetForPartitionException.java    | 25 +++++--
 .../consumer/OffsetOutOfRangeException.java        | 42 +++++++++++
 .../consumer/internals/AbstractCoordinator.java    |  1 +
 .../consumer/internals/ConsumerCoordinator.java    | 84 +++++++++++++---------
 .../consumer/internals/ConsumerNetworkClient.java  | 16 ++++-
 .../kafka/clients/consumer/internals/Fetcher.java  | 37 ++++++----
 .../common/errors/OffsetOutOfRangeException.java   | 50 -------------
 .../org/apache/kafka/common/protocol/Errors.java   |  2 +-
 .../internals/ConsumerCoordinatorTest.java         | 33 ++++++++-
 .../clients/consumer/internals/FetcherTest.java    |  2 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala |  2 +-
 .../kafka/coordinator/GroupMetadataManager.scala   |  3 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  2 +-
 .../kafka/api/PlaintextConsumerTest.scala          |  4 +-
 18 files changed, 300 insertions(+), 139 deletions(-)
7710b367fd26a0c41565f35200748c23616b4477

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b4e1bdf48b215e1acb3f81c964eb2c180d6dfa54

 build.gradle            |  22 ++-
 docs/configuration.html | 500 ++----------------------------------------------
 docs/documentation.html |   9 +-
 3 files changed, 41 insertions(+), 490 deletions(-)
30bf985348dcc5b9dc2fba4ad38009342fa18442

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
15524d0970868d2dd9bc16b9d5de4519fc469e11

 core/src/main/scala/kafka/tools/ConsoleProducer.scala    | 10 +++++-----
 .../src/main/scala/kafka/tools/ProducerPerformance.scala |  3 +++
 .../src/test/scala/kafka/tools/ConsoleProducerTest.scala |  5 ++---
 docs/api.html                                            | 16 +++++++++++++++-
 docs/upgrade.html                                        |  2 ++
 5 files changed, 27 insertions(+), 9 deletions(-)
d297b3af265a5be5a83ee11a990060231ea4cc25

 .../org/apache/kafka/copycat/connector/Connector.java    |  7 +++++++
 .../java/org/apache/kafka/copycat/connector/Task.java    |  7 +++++++
 .../copycat/connector/ConnectorReconfigurationTest.java  |  5 +++++
 .../kafka/copycat/file/FileStreamSinkConnector.java      |  6 ++++++
 .../apache/kafka/copycat/file/FileStreamSinkTask.java    |  5 +++++
 .../kafka/copycat/file/FileStreamSourceConnector.java    |  6 ++++++
 .../apache/kafka/copycat/file/FileStreamSourceTask.java  |  5 +++++
 .../java/org/apache/kafka/copycat/runtime/Worker.java    |  5 ++++-
 .../org/apache/kafka/copycat/runtime/WorkerTest.java     | 16 +++++++++++++++-
 9 files changed, 60 insertions(+), 2 deletions(-)
130a561ad511db5a592e5a4217d6fa5dee704d33

 core/src/main/scala/kafka/tools/EndToEndLatency.scala | 1 -
 1 file changed, 1 deletion(-)
09ff68673843109eedc5caae4bf46e62d1868aab

 docs/design.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a9e4ce79fe81d3fc8c9841ac9a14db53d3102854

 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 23 +++++++++++++++-------
 1 file changed, 16 insertions(+), 7 deletions(-)
a423316d388c386aa905b3d195487370f8703787

 core/src/main/scala/kafka/admin/AdminClient.scala  | 38 +++++-----------------
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 14 ++++----
 .../integration/kafka/api/AdminClientTest.scala    |  7 ++--
 3 files changed, 19 insertions(+), 40 deletions(-)
c006c5916ef7a8048ed55db64db27c7b64a3af59

 .../apache/kafka/common/config/AbstractConfig.java | 19 +++++++-
 .../apache/kafka/copycat/connector/Connector.java  | 12 ++---
 .../org/apache/kafka/copycat/connector/Task.java   |  4 +-
 .../org/apache/kafka/copycat/sink/SinkTask.java    |  3 +-
 .../apache/kafka/copycat/source/SourceTask.java    |  4 +-
 .../connector/ConnectorReconfigurationTest.java    | 11 ++---
 .../copycat/file/FileStreamSinkConnector.java      | 15 ++++---
 .../kafka/copycat/file/FileStreamSinkTask.java     |  5 +--
 .../copycat/file/FileStreamSourceConnector.java    | 19 ++++----
 .../kafka/copycat/file/FileStreamSourceTask.java   |  6 +--
 .../copycat/file/FileStreamSinkConnectorTest.java  | 17 ++++----
 .../file/FileStreamSourceConnectorTest.java        | 27 ++++++------
 .../copycat/file/FileStreamSourceTaskTest.java     | 12 ++---
 .../kafka/copycat/cli/CopycatDistributed.java      |  8 ++--
 .../kafka/copycat/cli/CopycatStandalone.java       | 14 +++---
 .../org/apache/kafka/copycat/runtime/Worker.java   | 21 +++------
 .../apache/kafka/copycat/runtime/WorkerConfig.java |  4 +-
 .../kafka/copycat/runtime/WorkerSinkTask.java      | 21 +++++----
 .../kafka/copycat/runtime/WorkerSourceTask.java    |  8 ++--
 .../apache/kafka/copycat/runtime/WorkerTask.java   |  4 +-
 .../runtime/distributed/DistributedConfig.java     |  4 +-
 .../runtime/standalone/StandaloneConfig.java       |  4 +-
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  | 17 ++++----
 .../copycat/runtime/WorkerSourceTaskTest.java      | 16 +++----
 .../apache/kafka/copycat/runtime/WorkerTest.java   | 51 +++++++++++-----------
 .../runtime/distributed/DistributedHerderTest.java |  3 +-
 26 files changed, 167 insertions(+), 162 deletions(-)
a76660ac811eb6e2cdf36a110ed4afb5bf3a617a

 .../org/apache/kafka/copycat/sink/SinkTask.java    | 16 +++++++
 .../apache/kafka/copycat/source/SourceTask.java    | 20 +++++++++
 .../kafka/copycat/runtime/WorkerSinkTask.java      | 52 +++++++++++++++-------
 .../copycat/runtime/WorkerSinkTaskThread.java      |  5 +++
 .../kafka/copycat/runtime/WorkerSourceTask.java    | 47 ++++++++++++++-----
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  | 26 +++++++----
 .../copycat/runtime/WorkerSourceTaskTest.java      | 29 ++++++++++++
 7 files changed, 161 insertions(+), 34 deletions(-)
b1eaa46a512295abb4b4eb8b98402fc60a2c911a

 .../clients/consumer/internals/SubscriptionState.java    |  1 +
 .../consumer/internals/SubscriptionStateTest.java        | 16 ++++++++++++++++
 2 files changed, 17 insertions(+)
c3c0c04e62253f2a9f78b383bbf0d1a04d9b3b25

 core/src/main/scala/kafka/admin/AdminClient.scala  |  35 ++++-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 173 ++++++++++++++++-----
 .../integration/kafka/api/AdminClientTest.scala    |   2 +-
 3 files changed, 164 insertions(+), 46 deletions(-)
33e879a389aeaff3576064b10a0f5dea5ad391ed

 .../org/apache/kafka/common/config/ConfigDef.java  | 87 +++++++---------------
 .../apache/kafka/common/config/SaslConfigs.java    |  2 +-
 .../org/apache/kafka/common/config/SslConfigs.java | 16 ++--
 .../apache/kafka/common/config/ConfigDefTest.java  | 17 +++--
 .../apache/kafka/copycat/runtime/WorkerConfig.java |  6 +-
 .../runtime/distributed/DistributedConfig.java     | 18 ++---
 core/src/main/scala/kafka/server/KafkaConfig.scala | 54 +++++++-------
 7 files changed, 84 insertions(+), 116 deletions(-)
76bcccd61f61d33a4a4d4db02043a2f0063d0d38

 .../kafka/clients/consumer/KafkaConsumer.java      | 130 +++++++++++++--------
 1 file changed, 81 insertions(+), 49 deletions(-)
cbdd8218c16b56d952267c162dc1dfc93191571e

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
0273c4379f12d7c3daedc89b0838485270e16bf4

 core/src/main/scala/kafka/server/ReplicaFetcherManager.scala | 2 +-
 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala  | 8 +++++---
 2 files changed, 6 insertions(+), 4 deletions(-)
bf2563e2f73881491ea94e83013e0ff319a25016

 core/src/main/scala/kafka/cluster/BrokerEndPoint.scala          | 2 +-
 core/src/test/scala/unit/kafka/cluster/BrokerEndPointTest.scala | 5 +++++
 2 files changed, 6 insertions(+), 1 deletion(-)
490bbc91183d1468a164d80f826317f137026684

 core/src/main/scala/kafka/coordinator/GroupCoordinator.scala  |  6 +++---
 .../test/scala/integration/kafka/api/AdminClientTest.scala    | 11 +++++++++++
 2 files changed, 14 insertions(+), 3 deletions(-)
7eee11451e1f0d17efa27775becfb370a9894d56

 .../consumer/internals/AbstractCoordinator.java    | 28 ++++++++---
 .../internals/ConsumerCoordinatorTest.java         | 55 +++++++++++++++++++++-
 2 files changed, 76 insertions(+), 7 deletions(-)
a4551773ca8cb3c1b75cea873715f30053d88f47

 .../kafka/copycat/runtime/WorkerSinkTask.java      |  74 +++++++-----
 .../copycat/runtime/WorkerSinkTaskThread.java      |   4 +-
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  | 131 +++++++++++++++------
 3 files changed, 140 insertions(+), 69 deletions(-)
d23785ff2df136090e3c80a3a6df5cb85443924b

 core/src/main/scala/kafka/server/KafkaApis.scala      |  2 +-
 core/src/main/scala/kafka/server/ReplicaManager.scala | 14 +++++++-------
 2 files changed, 8 insertions(+), 8 deletions(-)
b30d68a4e31cb49c2e664bb2e3263e056a27db40

 .../runtime/distributed/DistributedHerder.java     | 264 ++++++++++++++-------
 .../runtime/distributed/DistributedHerderTest.java |   5 +-
 2 files changed, 187 insertions(+), 82 deletions(-)
7d6515fb8f6141f5c34fe8434e97ea6ebd65941f

 .../apache/kafka/copycat/sink/SinkTaskContext.java | 28 +++++------------
 .../kafka/copycat/source/SourceTaskContext.java    | 12 ++------
 .../copycat/file/FileStreamSourceTaskTest.java     |  5 +++-
 .../kafka/copycat/runtime/WorkerSinkTask.java      | 20 +++++--------
 .../copycat/runtime/WorkerSinkTaskContext.java     | 29 ++++++++++++++++--
 .../kafka/copycat/runtime/WorkerSourceTask.java    |  3 +-
 .../copycat/runtime/WorkerSourceTaskContext.java   | 35 ++++++++++++++++++++++
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  |  7 +++--
 8 files changed, 87 insertions(+), 52 deletions(-)
4a9e7607b9e563195556873b6ec9b74561cedfbb

 .../copycat/runtime/SourceTaskOffsetCommitter.java | 67 +++++++++++++++++-----
 1 file changed, 52 insertions(+), 15 deletions(-)
68f42210a1c8ce64846ffdc2cdbecc6fa5b87739

 .../clients/consumer/internals/FetcherTest.java    | 29 ++++++++++++++++++++++
 1 file changed, 29 insertions(+)
ef5d168cc8f10ad4f0efe9df4cbe849a4b35496e

 .../apache/kafka/clients/consumer/Consumer.java    | 12 ++--
 .../kafka/clients/consumer/KafkaConsumer.java      | 18 +++--
 .../kafka/clients/consumer/MockConsumer.java       |  2 +-
 .../consumer/internals/AbstractCoordinator.java    | 76 ++++++++++++++++++----
 .../consumer/internals/ConsumerCoordinator.java    | 28 ++++----
 .../consumer/internals/ConsumerNetworkClient.java  | 15 +++--
 .../org/apache/kafka/common/protocol/Protocol.java | 10 +--
 .../kafka/common/requests/LeaveGroupRequest.java   | 16 ++---
 .../internals/ConsumerCoordinatorTest.java         | 66 ++++++++++++++++++-
 .../runtime/distributed/WorkerCoordinator.java     |  9 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  2 +-
 11 files changed, 190 insertions(+), 64 deletions(-)
8de62253adb4c6b90badbf92881c0402068cd65c

 .../main/scala/kafka/coordinator/GroupMetadataManager.scala  | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)
70a784b64ab61bcd517619fed44419d59d467b27

 .../org/apache/kafka/copycat/runtime/WorkerSourceTask.java     | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
c39e79bb5af5b4e56bec358f8ec3758e6822dbcf

 .../java/org/apache/kafka/clients/Metadata.java    |   6 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |  28 +-
 .../consumer/internals/AbstractCoordinator.java    |  39 +-
 .../consumer/internals/ConsumerCoordinator.java    |  29 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  29 +-
 .../kafka/clients/producer/KafkaProducer.java      |  30 +-
 .../kafka/clients/producer/internals/Sender.java   |   3 +
 .../main/java/org/apache/kafka/common/Cluster.java |  32 +-
 .../common/errors/AuthorizationException.java      |   2 +
 .../common/errors/GroupAuthorizationException.java |  27 ++
 .../common/errors/TopicAuthorizationException.java |  33 ++
 .../org/apache/kafka/common/protocol/Errors.java   |  12 +-
 .../common/requests/GroupCoordinatorResponse.java  |   9 +
 .../kafka/common/requests/HeartbeatResponse.java   |   4 +-
 .../kafka/common/requests/JoinGroupResponse.java   |   3 +-
 .../kafka/common/requests/LeaveGroupResponse.java  |   1 +
 .../kafka/common/requests/MetadataRequest.java     |  16 +-
 .../kafka/common/requests/MetadataResponse.java    |  18 +-
 .../common/requests/OffsetCommitResponse.java      |   6 +-
 .../kafka/common/requests/OffsetFetchResponse.java |   4 +-
 .../kafka/common/requests/SyncGroupResponse.java   |   4 +-
 .../org/apache/kafka/clients/MetadataTest.java     |  12 +-
 .../internals/ConsumerCoordinatorTest.java         |  20 +-
 .../clients/consumer/internals/FetcherTest.java    |  18 +
 .../kafka/clients/producer/MockProducerTest.java   |   3 +-
 .../producer/internals/DefaultPartitionerTest.java |   3 +-
 .../producer/internals/RecordAccumulatorTest.java  |   4 +-
 .../kafka/common/requests/RequestResponseTest.java |   3 +-
 .../test/java/org/apache/kafka/test/TestUtils.java |   3 +-
 .../runtime/distributed/WorkerCoordinator.java     |   1 -
 .../kafka/common/AuthorizationException.scala      |  13 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |  11 +-
 .../scala/kafka/security/auth/ResourceType.scala   |   7 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  54 ++-
 .../kafka/api/AuthorizerIntegrationTest.scala      | 508 +++++++++++++++------
 .../processor/DefaultPartitionGrouperTest.java     |   3 +-
 .../processor/internals/StreamThreadTest.java      |   2 +-
 37 files changed, 716 insertions(+), 284 deletions(-)
c30ee50d82131ead8bc64223ae5970555b0c78cf

 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
aa73554c19b15a1589a77a4fae85c2d66a649acf

 .../integration/kafka/api/BaseConsumerTest.scala   |  54 +++++++++-
 .../kafka/api/PlaintextConsumerTest.scala          | 117 ++++++++++++++++++++-
 2 files changed, 169 insertions(+), 2 deletions(-)
421de0a3f93f8d21f7ca0f1287a4305c00edaa08

 .../kafka/streams/processor/TopologyBuilder.java   | 111 +++++++++++++--------
 .../streams/processor/internals/StreamThread.java  |   4 +-
 .../streams/kstream/internals/KStreamImplTest.java |   2 +-
 .../streams/processor/TopologyBuilderTest.java     |  58 +++++++----
 .../processor/internals/ProcessorTopologyTest.java |   2 +-
 .../processor/internals/StreamTaskTest.java        |  66 ++++++------
 .../processor/internals/StreamThreadTest.java      |   9 +-
 .../org/apache/kafka/test/KStreamTestDriver.java   |   2 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    |   2 +-
 9 files changed, 155 insertions(+), 101 deletions(-)
7ded64bc2edf8645d7fd113633a56791bf1e8e4a

 bin/windows/kafka-run-class.bat       | 266 +++++++++++++++++-----------------
 bin/windows/kafka-server-stop.bat     |  36 ++---
 bin/windows/zookeeper-server-stop.bat |  34 ++---
 3 files changed, 168 insertions(+), 168 deletions(-)
70a7d5786cc3f04b5f3d964eb1fd1d826e9b9e0f

 .../scala/kafka/controller/KafkaController.scala   |  6 ++++--
 .../main/scala/kafka/server/ReplicaManager.scala   | 24 +++++++++++++++++-----
 .../kafka/integration/BaseTopicMetadataTest.scala  |  2 +-
 3 files changed, 24 insertions(+), 8 deletions(-)
98db5ea94fcf7600137b5072453705c2a62e1f54

 build.gradle                                       |   9 +-
 .../sanity_checks/test_console_consumer.py         |   8 +-
 tests/kafkatest/services/console_consumer.py       |  16 +-
 tests/kafkatest/services/kafka/kafka.py            |  27 +--
 .../services/kafka/templates/kafka.properties      |  14 +-
 tests/kafkatest/services/kafka_log4j_appender.py   |   2 +-
 .../services/performance/consumer_performance.py   |   8 +-
 .../services/performance/end_to_end_latency.py     |  25 +--
 .../services/performance/producer_performance.py   |  12 +-
 tests/kafkatest/services/security/__init__.py      |  15 ++
 tests/kafkatest/services/security/minikdc.py       |  79 +++++++++
 .../kafkatest/services/security/security_config.py | 187 +++++++++++++++++++++
 .../services/security/templates/gssapi_jaas.conf   |  51 ++++++
 .../services/security/templates/minikdc.properties |  17 ++
 tests/kafkatest/services/verifiable_producer.py    |   8 +-
 tests/kafkatest/tests/benchmark_test.py            |  56 +++---
 tests/kafkatest/tests/log4j_appender_test.py       |   6 +-
 tests/kafkatest/tests/quota_test.py                |  10 +-
 tests/kafkatest/tests/replication_test.py          |  12 +-
 tests/kafkatest/utils/security_config.py           | 133 ---------------
 20 files changed, 462 insertions(+), 233 deletions(-)
596c203af1f33360c04f4be7c466310d11343f78

 .../kafka/clients/consumer/ConsumerConfig.java     |  34 +--
 .../consumer/internals/AbstractCoordinator.java    |  20 +-
 .../consumer/internals/ConsumerCoordinator.java    |   2 +-
 .../consumer/internals/ConsumerProtocol.java       |   2 +
 .../kafka/clients/producer/ProducerConfig.java     |  70 +++---
 .../org/apache/kafka/common/config/ConfigDef.java  |  17 ++
 .../apache/kafka/common/config/SaslConfigs.java    |   8 +
 .../org/apache/kafka/common/config/SslConfigs.java |  17 ++
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   6 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   3 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  82 +++++--
 .../apache/kafka/common/protocol/types/Struct.java |   8 +
 .../kafka/common/requests/AbstractRequest.java     |   8 +-
 .../common/requests/DescribeGroupsRequest.java     |  68 ++++++
 .../common/requests/DescribeGroupsResponse.java    | 224 +++++++++++++++++++
 .../common/requests/GroupCoordinatorRequest.java   |  65 ++++++
 .../common/requests/GroupCoordinatorResponse.java  |  70 ++++++
 .../common/requests/GroupMetadataRequest.java      |  65 ------
 .../common/requests/GroupMetadataResponse.java     |  70 ------
 .../kafka/common/requests/ListGroupsRequest.java   |  57 +++++
 .../kafka/common/requests/ListGroupsResponse.java  | 107 +++++++++
 .../internals/ConsumerCoordinatorTest.java         |   4 +-
 .../kafka/common/requests/RequestResponseTest.java |  45 +++-
 .../runtime/distributed/WorkerCoordinatorTest.java |   4 +-
 core/src/main/scala/kafka/admin/AdminClient.scala  | 242 +++++++++++++++++++++
 .../scala/kafka/api/GroupCoordinatorRequest.scala  |  80 +++++++
 .../scala/kafka/api/GroupCoordinatorResponse.scala |  58 +++++
 .../scala/kafka/api/GroupMetadataRequest.scala     |  80 -------
 .../scala/kafka/api/GroupMetadataResponse.scala    |  58 -----
 core/src/main/scala/kafka/api/RequestKeys.scala    |  10 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |   4 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   1 +
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   4 +-
 .../scala/kafka/coordinator/GroupCoordinator.scala | 104 +++++++--
 .../scala/kafka/coordinator/GroupMetadata.scala    |  36 ++-
 .../kafka/coordinator/GroupMetadataManager.scala   |  38 ++--
 .../scala/kafka/coordinator/MemberMetadata.scala   |  24 +-
 .../kafka/javaapi/GroupCoordinatorResponse.scala   |  47 ++++
 .../kafka/javaapi/GroupMetadataResponse.scala      |  47 ----
 .../main/scala/kafka/network/RequestChannel.scala  |   3 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  90 ++++++--
 .../integration/kafka/api/AdminClientTest.scala    | 114 ++++++++++
 .../kafka/api/AuthorizerIntegrationTest.scala      |   8 +-
 .../test/scala/other/kafka/TestOffsetManager.scala |   4 +-
 .../api/RequestResponseSerializationTest.scala     |  10 +-
 .../coordinator/GroupCoordinatorResponseTest.scala | 144 ++++++++++--
 .../unit/kafka/coordinator/GroupMetadataTest.scala |  23 +-
 .../kafka/coordinator/MemberMetadataTest.scala     |  31 +--
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   4 +-
 49 files changed, 1765 insertions(+), 555 deletions(-)
f413143eddd713dc5f03d53fdeb10e4e7f3738b1

 docs/security.html | 145 +++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 145 insertions(+)
5aa5f19d38eda33f32e170e14bcd4fd0d2835fc0

 .../org/apache/kafka/copycat/sink/SinkTask.java    | 22 +++++++
 .../apache/kafka/copycat/sink/SinkTaskContext.java | 38 ++++++++---
 .../kafka/copycat/runtime/WorkerSinkTask.java      | 73 +++++++++++---------
 .../copycat/runtime/WorkerSinkTaskContext.java     | 77 ++++++++++++++++++++++
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  | 59 +++++++++++++++--
 5 files changed, 223 insertions(+), 46 deletions(-)
edddc41b37d06f8e819976b20b2e8ac711033e95

 build.gradle | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
840e95897fdb5118aa1308ec1a3be27369b9d71e

 docs/security.html | 43 +++++++++++++++++++++++++++++++++++++++++--
 1 file changed, 41 insertions(+), 2 deletions(-)
694e03c35582212749db5efaabd98b9f723609d5

 bin/kafka-run-class.sh | 20 +++++++++++---------
 1 file changed, 11 insertions(+), 9 deletions(-)
7c33475274cb6e65a8e8d907e7fef6e56bc8c8e6

 .../consumer/internals/AbstractCoordinator.java    |   6 +-
 .../consumer/internals/ConsumerCoordinator.java    |   9 +-
 .../errors/GroupLoadInProgressException.java       |  40 +
 .../errors/OffsetLoadInProgressException.java      |  40 -
 .../org/apache/kafka/common/protocol/Errors.java   |   4 +-
 .../kafka/common/requests/JoinGroupResponse.java   |   1 +
 .../kafka/common/requests/LeaveGroupResponse.java  |   1 +
 .../common/requests/OffsetCommitResponse.java      |   1 +
 .../kafka/common/requests/OffsetFetchResponse.java |   2 +-
 .../internals/ConsumerCoordinatorTest.java         |   2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |   2 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   2 +-
 .../kafka/common/OffsetMetadataAndError.scala      |   2 +-
 core/src/main/scala/kafka/common/Topic.scala       |   2 +-
 .../kafka/coordinator/CoordinatorMetadata.scala    |  81 --
 .../scala/kafka/coordinator/GroupCoordinator.scala | 139 ++-
 .../scala/kafka/coordinator/GroupMetadata.scala    |   6 +-
 .../kafka/coordinator/GroupMetadataManager.scala   | 952 +++++++++++++++++++++
 .../scala/kafka/coordinator/MemberMetadata.scala   |   7 +-
 .../scala/kafka/coordinator/OffsetConfig.scala     |  61 ++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  12 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  19 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../main/scala/kafka/server/OffsetManager.scala    | 627 --------------
 .../kafka/api/AuthorizerIntegrationTest.scala      |   2 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |   2 +-
 .../kafka/api/IntegrationTestHarness.scala         |   2 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |   8 +-
 .../unit/kafka/consumer/TopicFilterTest.scala      |   9 +-
 .../coordinator/CoordinatorMetadataTest.scala      |  71 --
 .../coordinator/GroupCoordinatorResponseTest.scala | 515 +++++------
 .../unit/kafka/coordinator/GroupMetadataTest.scala |  12 -
 32 files changed, 1390 insertions(+), 1251 deletions(-)
e466ccd711ae00c5bb046c18aacf353b1a460dcd

 .../kafka/streams/kstream/KStreamBuilder.java      | 11 ++++--
 .../streams/kstream/internals/KStreamImpl.java     | 41 ++++++++++------------
 .../kstream/internals/KStreamWindowedImpl.java     | 10 +++---
 .../kafka/streams/kstream/KStreamBuilderTest.java  | 19 +++++++++-
 4 files changed, 51 insertions(+), 30 deletions(-)
1f5d05fe718b7db7ee07c727b7a736fab09322d6

 vagrant/base.sh | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
758272267c811bf559336ea45571bc420a62a478

 .../org/apache/kafka/streams/StreamingConfig.java  |  18 ++
 .../kafka/streams/examples/ProcessorJob.java       |   5 +-
 .../org/apache/kafka/streams/kstream/KStream.java  |   9 +-
 .../streams/kstream/internals/KStreamImpl.java     |   9 +-
 .../apache/kafka/streams/processor/StateStore.java |   5 +
 .../streams/processor/StateStoreSupplier.java      |  25 ++
 .../kafka/streams/processor/TopologyBuilder.java   | 109 ++++++--
 .../processor/internals/ProcessorContextImpl.java  |  30 ++-
 .../streams/processor/internals/ProcessorNode.java |   8 +-
 .../processor/internals/ProcessorTopology.java     |  11 +-
 .../streams/processor/internals/StreamTask.java    |   8 +
 .../kafka/streams/state/InMemoryKeyValueStore.java | 135 ----------
 .../state/InMemoryKeyValueStoreSupplier.java       | 155 +++++++++++
 .../kafka/streams/state/InMemoryLRUCacheStore.java | 180 -------------
 .../state/InMemoryLRUCacheStoreSupplier.java       | 195 ++++++++++++++
 .../kafka/streams/state/MeteredKeyValueStore.java  |  68 ++---
 .../kafka/streams/state/RocksDBKeyValueStore.java  | 284 --------------------
 .../state/RocksDBKeyValueStoreSupplier.java        | 298 +++++++++++++++++++++
 .../org/apache/kafka/streams/state/Serdes.java     |  45 ++--
 .../org/apache/kafka/streams/state/Stores.java     |  66 ++---
 .../streams/processor/TopologyBuilderTest.java     |  79 ++++++
 .../internals/ProcessorStateManagerTest.java       |  56 +---
 .../processor/internals/ProcessorTopologyTest.java |  13 +-
 .../processor/internals/PunctuationQueueTest.java  |   2 +-
 .../processor/internals/StreamTaskTest.java        |  18 +-
 .../streams/state/AbstractKeyValueStoreTest.java   |  16 +-
 .../streams/state/InMemoryKeyValueStoreTest.java   |  22 +-
 .../streams/state/InMemoryLRUCacheStoreTest.java   |  15 +-
 .../streams/state/KeyValueStoreTestDriver.java     |  22 ++
 .../streams/state/RocksDBKeyValueStoreTest.java    |  24 +-
 .../apache/kafka/test/MockStateStoreSupplier.java  |  97 +++++++
 .../kafka/test/ProcessorTopologyTestDriver.java    |   3 +-
 32 files changed, 1224 insertions(+), 806 deletions(-)
6383593fed5215f31e050d5a459b161249ed8366

 NOTICE | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
34775bd3ed7b8eb4ca3532d30a9d8e6bf7c0b738

 docs/documentation.html |  11 +++++
 docs/security.html      | 117 ++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 128 insertions(+)
9d8dd9f104aef3a9db9005d85bc55a15f851d258

 .../java/org/apache/kafka/common/security/JaasUtils.java | 13 +++----------
 core/src/main/scala/kafka/admin/ConfigCommand.scala      |  2 +-
 .../main/scala/kafka/admin/ConsumerGroupCommand.scala    |  2 +-
 .../admin/PreferredReplicaLeaderElectionCommand.scala    |  2 +-
 .../scala/kafka/admin/ReassignPartitionsCommand.scala    |  2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala       |  2 +-
 core/src/main/scala/kafka/admin/ZkSecurityMigrator.scala | 14 ++++----------
 .../kafka/consumer/ZookeeperConsumerConnector.scala      |  2 +-
 .../scala/kafka/security/auth/SimpleAclAuthorizer.scala  |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala       |  2 +-
 .../main/scala/kafka/server/ZookeeperLeaderElector.scala |  2 +-
 .../main/scala/kafka/tools/ConsumerOffsetChecker.scala   |  2 +-
 core/src/main/scala/kafka/tools/ExportZkOffsets.scala    |  2 +-
 core/src/main/scala/kafka/tools/ImportZkOffsets.scala    |  2 +-
 core/src/main/scala/kafka/tools/UpdateOffsetsInZK.scala  |  2 +-
 .../main/scala/kafka/tools/VerifyConsumerRebalance.scala |  2 +-
 .../unit/kafka/security/auth/ZkAuthorizationTest.scala   | 16 ++++++++++------
 core/src/test/scala/unit/kafka/zk/ZKEphemeralTest.scala  | 14 ++++++++------
 .../test/scala/unit/kafka/zk/ZooKeeperTestHarness.scala  |  3 ++-
 19 files changed, 41 insertions(+), 47 deletions(-)
b944356990d97401721a5752f8dcdd1ac5b8d4d4

 core/src/main/scala/kafka/log/Log.scala            |  1 -
 core/src/main/scala/kafka/log/LogCleaner.scala     | 11 +++++++----
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 23 +++++++++++++++++-----
 3 files changed, 25 insertions(+), 10 deletions(-)
eec222e9828b36064827f206b398655aa2d4cd29

 tests/kafkatest/services/kafka_log4j_appender.py   | 16 +++--
 tests/kafkatest/tests/log4j_appender_test.py       | 54 +++++++++++-----
 .../kafka/tools/VerifiableLog4jAppender.java       | 74 +++++++++++++++++++++-
 3 files changed, 124 insertions(+), 20 deletions(-)
637f9a31660bebd0a3b94d930792e0b19405acd0

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1cc44830b90688f1a2034243b8ee03b97101f75c

 bin/kafka-producer-perf-test.sh                    |   2 +-
 bin/windows/kafka-producer-perf-test.bat           |   2 +-
 build.gradle                                       |   5 +-
 .../services/performance/producer_performance.py   |   2 +-
 .../apache/kafka/tools/ProducerPerformance.java    | 152 +++++++++++++++------
 5 files changed, 117 insertions(+), 46 deletions(-)
d50499a0e08586d61445df6e287762333dc22d0a

 Vagrantfile                                        |    2 +-
 build.gradle                                       |    3 +-
 system_test/README.txt                             |   83 -
 system_test/__init__.py                            |    1 -
 system_test/broker_failure/README                  |   72 -
 system_test/broker_failure/bin/kafka-run-class.sh  |   67 -
 system_test/broker_failure/bin/run-test.sh         |  815 -------
 system_test/broker_failure/config/log4j.properties |   86 -
 .../config/mirror_producer.properties              |   27 -
 .../config/mirror_producer1.properties             |   28 -
 .../config/mirror_producer2.properties             |   28 -
 .../config/mirror_producer3.properties             |   28 -
 .../config/server_source1.properties               |   76 -
 .../config/server_source2.properties               |   76 -
 .../config/server_source3.properties               |   76 -
 .../config/server_source4.properties               |   76 -
 .../config/server_target1.properties               |   79 -
 .../config/server_target2.properties               |   79 -
 .../config/server_target3.properties               |   79 -
 .../config/whitelisttest.consumer.properties       |   29 -
 .../config/zookeeper_source.properties             |   18 -
 .../config/zookeeper_target.properties             |   18 -
 system_test/cluster_config.json                    |   58 -
 system_test/common/util.sh                         |  182 --
 system_test/logging.conf                           |   56 -
 system_test/metrics.json                           |  174 --
 system_test/mirror_maker_testsuite/__init__.py     |    1 -
 .../mirror_maker_testsuite/cluster_config.json     |  136 --
 .../config/console_consumer.properties             |    0
 .../config/consumer.properties                     |    0
 .../mirror_maker_testsuite/config/log4j.properties |    0
 .../config/mirror_consumer.properties              |   12 -
 .../config/mirror_producer.properties              |   12 -
 .../config/producer.properties                     |    0
 .../config/producer_performance.properties         |    0
 .../config/server.properties                       |  139 --
 .../config/zookeeper.properties                    |   23 -
 .../mirror_maker_testsuite/mirror_maker_test.py    |  324 ---
 .../testcase_15001/testcase_15001_properties.json  |  158 --
 .../testcase_15002/testcase_15002_properties.json  |  158 --
 .../testcase_15003/cluster_config.json             |  135 --
 .../testcase_15003/testcase_15003_properties.json  |  156 --
 .../testcase_15004/cluster_config.json             |  135 --
 .../testcase_15004/testcase_15004_properties.json  |  156 --
 .../testcase_15005/cluster_config.json             |  153 --
 .../testcase_15005/testcase_15005_properties.json  |  178 --
 .../testcase_15006/cluster_config.json             |  153 --
 .../testcase_15006/testcase_15006_properties.json  |  178 --
 .../testcase_5001/testcase_5001_properties.json    |  160 --
 .../testcase_5002/testcase_5002_properties.json    |  160 --
 .../testcase_5003/cluster_config.json              |  135 --
 .../testcase_5003/testcase_5003_properties.json    |  159 --
 .../testcase_5004/cluster_config.json              |  135 --
 .../testcase_5004/testcase_5004_properties.json    |  159 --
 .../testcase_5005/cluster_config.json              |  153 --
 .../testcase_5005/testcase_5005_properties.json    |  182 --
 .../testcase_5006/cluster_config.json              |  153 --
 .../testcase_5006/testcase_5006_properties.json    |  182 --
 .../cluster_config.json                            |  103 -
 .../config/console_consumer.properties             |    2 -
 .../config/producer_performance.properties         |    0
 .../config/server.properties                       |  143 --
 .../config/zookeeper.properties                    |   23 -
 .../offset_management_test.py                      |  299 ---
 .../testcase_7001/testcase_7001_properties.json    |   95 -
 .../testcase_7002/config/kafka_server_1.properties |  147 --
 .../testcase_7002/config/kafka_server_2.properties |  147 --
 .../testcase_7002/config/kafka_server_3.properties |  147 --
 .../testcase_7002/config/kafka_server_4.properties |  147 --
 .../testcase_7002/config/zookeeper_0.properties    |   24 -
 .../testcase_7002/testcase_7002_properties.json    |  127 -
 system_test/producer_perf/README                   |    9 -
 system_test/producer_perf/bin/expected.out         |   32 -
 .../producer_perf/bin/run-compression-test.sh      |   61 -
 system_test/producer_perf/bin/run-test.sh          |   61 -
 system_test/producer_perf/config/server.properties |   78 -
 .../producer_perf/config/zookeeper.properties      |   18 -
 system_test/replication_testsuite/__init__.py      |    1 -
 .../config/console_consumer.properties             |    0
 .../config/consumer.properties                     |    0
 .../replication_testsuite/config/log4j.properties  |    0
 .../config/producer.properties                     |    0
 .../config/producer_performance.properties         |    0
 .../replication_testsuite/config/server.properties |  139 --
 .../config/zookeeper.properties                    |   20 -
 .../replication_testsuite/replica_basic_test.py    |  461 ----
 .../testcase_0001/testcase_0001_properties.json    |   85 -
 .../testcase_0002/testcase_0002_properties.json    |   85 -
 .../testcase_0003/testcase_0003_properties.json    |   85 -
 .../testcase_0004/testcase_0004_properties.json    |   85 -
 .../testcase_0005/testcase_0005_properties.json    |   85 -
 .../testcase_0006/testcase_0006_properties.json    |   85 -
 .../testcase_0007/testcase_0007_properties.json    |   85 -
 .../testcase_0008/testcase_0008_properties.json    |   85 -
 .../testcase_0009/testcase_0009_properties.json    |   85 -
 .../testcase_0010/testcase_0010_properties.json    |   85 -
 .../testcase_0011/testcase_0011_properties.json    |   86 -
 .../testcase_0021/cluster_config.json              |   76 -
 .../testcase_0021/testcase_0021_properties.json    |  105 -
 .../testcase_0022/cluster_config.json              |   76 -
 .../testcase_0022/testcase_0022_properties.json    |  105 -
 .../testcase_0023/cluster_config.json              |   76 -
 .../testcase_0023/testcase_0023_properties.json    |  105 -
 .../testcase_0024/testcase_0024_properties.json    |   87 -
 .../testcase_0101/testcase_0101_properties.json    |   87 -
 .../testcase_0102/testcase_0102_properties.json    |   87 -
 .../testcase_0103/testcase_0103_properties.json    |   87 -
 .../testcase_0104/testcase_0104_properties.json    |   87 -
 .../testcase_0105/testcase_0105_properties.json    |   87 -
 .../testcase_0106/testcase_0106_properties.json    |   87 -
 .../testcase_0107/testcase_0107_properties.json    |   87 -
 .../testcase_0108/testcase_0108_properties.json    |   87 -
 .../testcase_0109/testcase_0109_properties.json    |   87 -
 .../testcase_0110/testcase_0110_properties.json    |   87 -
 .../testcase_0111/testcase_0111_properties.json    |   89 -
 .../testcase_0112/testcase_0112_properties.json    |   89 -
 .../testcase_0113/testcase_0113_properties.json    |   89 -
 .../testcase_0114/testcase_0114_properties.json    |   89 -
 .../testcase_0115/testcase_0115_properties.json    |   89 -
 .../testcase_0116/testcase_0116_properties.json    |   89 -
 .../testcase_0117/testcase_0117_properties.json    |   89 -
 .../testcase_0118/testcase_0118_properties.json    |   89 -
 .../testcase_0119/testcase_0119_properties.json    |   89 -
 .../testcase_0121/cluster_config.json              |   76 -
 .../testcase_0121/testcase_0121_properties.json    |  109 -
 .../testcase_0122/cluster_config.json              |   76 -
 .../testcase_0122/testcase_0122_properties.json    |  109 -
 .../testcase_0123/cluster_config.json              |   76 -
 .../testcase_0123/testcase_0123_properties.json    |  109 -
 .../testcase_0124/cluster_config.json              |   76 -
 .../testcase_0124/testcase_0124_properties.json    |  113 -
 .../testcase_0125/cluster_config.json              |   76 -
 .../testcase_0125/testcase_0125_properties.json    |  113 -
 .../testcase_0126/cluster_config.json              |   76 -
 .../testcase_0126/testcase_0126_properties.json    |  113 -
 .../testcase_0127/cluster_config.json              |   76 -
 .../testcase_0127/testcase_0127_properties.json    |  113 -
 .../testcase_0128/testcase_0128_properties.json    |   90 -
 .../testcase_0131/cluster_config.json              |   76 -
 .../testcase_0131/testcase_0131_properties.json    |  112 -
 .../testcase_0132/cluster_config.json              |   76 -
 .../testcase_0132/testcase_0132_properties.json    |  109 -
 .../testcase_0133/cluster_config.json              |   76 -
 .../testcase_0133/testcase_0133_properties.json    |  109 -
 .../testcase_0134/testcase_0134_properties.json    |   93 -
 .../testcase_0151/testcase_0151_properties.json    |   90 -
 .../testcase_0152/testcase_0152_properties.json    |   90 -
 .../testcase_0153/testcase_0153_properties.json    |   90 -
 .../testcase_0154/testcase_0154_properties.json    |   90 -
 .../testcase_0155/testcase_0155_properties.json    |   90 -
 .../testcase_0156/testcase_0156_properties.json    |   90 -
 .../testcase_0157/testcase_0157_properties.json    |   90 -
 .../testcase_0158/testcase_0158_properties.json    |   90 -
 .../testcase_0159/testcase_0159_properties.json    |   92 -
 .../testcase_0201/testcase_0201_properties.json    |   89 -
 .../testcase_0202/testcase_0202_properties.json    |   89 -
 .../testcase_0203/testcase_0203_properties.json    |   89 -
 .../testcase_0204/testcase_0204_properties.json    |   89 -
 .../testcase_0205/testcase_0205_properties.json    |   89 -
 .../testcase_0206/testcase_0206_properties.json    |   89 -
 .../testcase_0207/testcase_0207_properties.json    |   89 -
 .../testcase_0208/testcase_0208_properties.json    |   89 -
 .../testcase_0209/testcase_0209_properties.json    |   91 -
 .../testcase_0251/testcase_0251_properties.json    |   89 -
 .../testcase_0252/testcase_0252_properties.json    |   89 -
 .../testcase_0253/testcase_0253_properties.json    |   89 -
 .../testcase_0254/testcase_0254_properties.json    |   89 -
 .../testcase_0255/testcase_0255_properties.json    |   89 -
 .../testcase_0256/testcase_0256_properties.json    |   89 -
 .../testcase_0257/testcase_0257_properties.json    |   89 -
 .../testcase_0258/testcase_0258_properties.json    |   89 -
 .../testcase_0259/testcase_0259_properties.json    |   91 -
 .../testcase_0301/testcase_0301_properties.json    |   87 -
 .../testcase_0302/testcase_0302_properties.json    |   87 -
 .../testcase_0303/testcase_0303_properties.json    |   87 -
 .../testcase_0304/testcase_0304_properties.json    |   87 -
 .../testcase_0305/testcase_0305_properties.json    |   87 -
 .../testcase_0306/testcase_0306_properties.json    |   87 -
 .../testcase_0307/testcase_0307_properties.json    |   87 -
 .../testcase_0308/testcase_0308_properties.json    |   87 -
 .../testcase_0309/testcase_0309_properties.json    |   89 -
 .../testcase_1/cluster_config.json                 |   58 -
 .../testcase_1/testcase_1_properties.json          |   81 -
 .../testcase_10101/testcase_10101_properties.json  |   86 -
 .../testcase_10102/testcase_10102_properties.json  |   86 -
 .../testcase_10103/testcase_10103_properties.json  |   86 -
 .../testcase_10104/testcase_10104_properties.json  |   86 -
 .../testcase_10105/testcase_10105_properties.json  |   86 -
 .../testcase_10106/testcase_10106_properties.json  |   86 -
 .../testcase_10107/testcase_10107_properties.json  |   86 -
 .../testcase_10108/testcase_10108_properties.json  |   86 -
 .../testcase_10109/testcase_10109_properties.json  |   86 -
 .../testcase_10110/testcase_10110_properties.json  |   86 -
 .../testcase_10131/cluster_config.json             |   76 -
 .../testcase_10131/testcase_10131_properties.json  |  110 -
 .../testcase_10132/cluster_config.json             |   76 -
 .../testcase_10132/testcase_10132_properties.json  |  107 -
 .../testcase_10133/cluster_config.json             |   76 -
 .../testcase_10133/testcase_10133_properties.json  |  107 -
 .../testcase_10134/testcase_10134_properties.json  |   92 -
 .../testcase_4001/cluster_config.json              |   76 -
 .../testcase_4001/testcase_4001_properties.json    |  113 -
 .../testcase_4002/cluster_config.json              |   76 -
 .../testcase_4002/testcase_4002_properties.json    |  113 -
 .../testcase_4003/cluster_config.json              |   76 -
 .../testcase_4003/testcase_4003_properties.json    |  113 -
 .../testcase_4004/cluster_config.json              |   76 -
 .../testcase_4004/testcase_4004_properties.json    |  113 -
 .../testcase_4005/cluster_config.json              |   76 -
 .../testcase_4005/testcase_4005_properties.json    |  113 -
 .../testcase_4006/cluster_config.json              |   76 -
 .../testcase_4006/testcase_4006_properties.json    |  113 -
 .../testcase_4007/cluster_config.json              |   76 -
 .../testcase_4007/testcase_4007_properties.json    |  113 -
 .../testcase_4008/cluster_config.json              |   76 -
 .../testcase_4008/testcase_4008_properties.json    |  113 -
 .../testcase_4011/cluster_config.json              |   76 -
 .../testcase_4011/testcase_4011_properties.json    |  113 -
 .../testcase_4012/cluster_config.json              |   76 -
 .../testcase_4012/testcase_4012_properties.json    |  113 -
 .../testcase_4013/cluster_config.json              |   76 -
 .../testcase_4013/testcase_4013_properties.json    |  113 -
 .../testcase_4014/cluster_config.json              |   76 -
 .../testcase_4014/testcase_4014_properties.json    |  113 -
 .../testcase_4015/cluster_config.json              |   76 -
 .../testcase_4015/testcase_4015_properties.json    |  113 -
 .../testcase_4016/cluster_config.json              |   76 -
 .../testcase_4016/testcase_4016_properties.json    |  113 -
 .../testcase_4017/cluster_config.json              |   76 -
 .../testcase_4017/testcase_4017_properties.json    |  113 -
 .../testcase_4018/cluster_config.json              |   76 -
 .../testcase_4018/testcase_4018_properties.json    |  113 -
 .../testcase_9051/cluster_config.json              |   58 -
 .../testcase_9051/testcase_9051_properties.json    |   86 -
 system_test/run_all.sh                             |    7 -
 system_test/run_all_replica.sh                     |    7 -
 system_test/run_sanity.sh                          |    7 -
 system_test/system_test_env.py                     |  138 --
 system_test/system_test_runner.py                  |  331 ---
 system_test/testcase_to_run_all.json               |  139 --
 system_test/testcase_to_run_all_replica.json       |  123 -
 system_test/testcase_to_run_sanity.json            |    5 -
 system_test/testcase_to_skip.json                  |    3 -
 system_test/utils/__init__.py                      |    1 -
 system_test/utils/kafka_system_test_utils.py       | 2512 --------------------
 system_test/utils/metrics.py                       |  298 ---
 system_test/utils/pyh.py                           |  161 --
 system_test/utils/replication_utils.py             |   70 -
 system_test/utils/setup_utils.py                   |   47 -
 system_test/utils/system_test_utils.py             |  638 -----
 system_test/utils/testcase_env.py                  |  173 --
 251 files changed, 2 insertions(+), 26346 deletions(-)
c001b2040cb7bf3a24aa77ec8de1312d4f780620

 build.gradle                                       |  84 ++++-
 checkstyle/import-control.xml                      |  10 +
 .../kafka/copycat/cli/CopycatDistributed.java      |  35 +-
 .../kafka/copycat/cli/CopycatStandalone.java       |  21 +-
 .../org/apache/kafka/copycat/cli/WorkerConfig.java | 118 -------
 .../copycat/errors/AlreadyExistsException.java     |  35 ++
 .../kafka/copycat/errors/NotFoundException.java    |  35 ++
 .../org/apache/kafka/copycat/runtime/Copycat.java  |   7 +-
 .../org/apache/kafka/copycat/runtime/Herder.java   |  92 +++++-
 .../copycat/runtime/SourceTaskOffsetCommitter.java |   1 -
 .../org/apache/kafka/copycat/runtime/Worker.java   |  15 +-
 .../apache/kafka/copycat/runtime/WorkerConfig.java | 138 ++++++++
 .../kafka/copycat/runtime/WorkerSinkTask.java      |   1 -
 .../copycat/runtime/WorkerSinkTaskThread.java      |   1 -
 .../kafka/copycat/runtime/WorkerSourceTask.java    |   1 -
 .../runtime/distributed/ClusterConfigState.java    |  11 +-
 .../runtime/distributed/CopycatProtocol.java       |  43 ++-
 .../runtime/distributed/DistributedConfig.java     | 187 +++++++++++
 .../runtime/distributed/DistributedHerder.java     | 351 +++++++++++++++-----
 .../distributed/DistributedHerderConfig.java       | 191 -----------
 .../runtime/distributed/NotLeaderException.java    |  19 +-
 .../runtime/distributed/WorkerCoordinator.java     |  23 +-
 .../runtime/distributed/WorkerGroupMember.java     |   9 +-
 .../kafka/copycat/runtime/rest/RestServer.java     | 258 +++++++++++++++
 .../runtime/rest/entities/ConnectorInfo.java       |  81 +++++
 .../rest/entities/CreateConnectorRequest.java      |  59 ++++
 .../runtime/rest/entities/ErrorMessage.java        |  63 ++++
 .../copycat/runtime/rest/entities/ServerInfo.java  |  41 +++
 .../copycat/runtime/rest/entities/TaskInfo.java    |  58 ++++
 .../rest/errors/CopycatExceptionMapper.java        |  60 ++++
 .../runtime/rest/errors/CopycatRestException.java  |  70 ++++
 .../runtime/rest/resources/ConnectorsResource.java | 201 ++++++++++++
 .../runtime/rest/resources/RootResource.java       |  36 ++
 .../runtime/standalone/StandaloneConfig.java       |  35 ++
 .../runtime/standalone/StandaloneHerder.java       | 199 ++++++++---
 .../apache/kafka/copycat/util/ConnectorTaskId.java |  10 +-
 .../copycat/util/ConvertingFutureCallback.java     |   3 +-
 .../apache/kafka/copycat/util/FutureCallback.java  |   4 +
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  |   4 +-
 .../copycat/runtime/WorkerSourceTaskTest.java      |   4 +-
 .../apache/kafka/copycat/runtime/WorkerTest.java   |  10 +-
 .../runtime/distributed/DistributedHerderTest.java | 236 +++++++++++--
 .../runtime/distributed/WorkerCoordinatorTest.java |  21 +-
 .../rest/resources/ConnectorsResourceTest.java     | 364 +++++++++++++++++++++
 .../runtime/standalone/StandaloneHerderTest.java   | 228 ++++++++++---
 .../copycat/storage/KafkaConfigStorageTest.java    |  11 +-
 tests/kafkatest/services/copycat.py                |  81 ++++-
 tests/kafkatest/tests/copycat_distributed_test.py  |   8 +-
 tests/kafkatest/tests/copycat_rest_test.py         | 163 +++++++++
 tests/kafkatest/tests/copycat_test.py              |   4 +-
 .../tests/templates/copycat-distributed.properties |   2 +
 tests/setup.py                                     |   2 +-
 vagrant/system-test-Vagrantfile.local              |   4 +
 53 files changed, 3086 insertions(+), 662 deletions(-)
efdc2ad2e7ec62c6d4d72c8d672a2995be5032a0

 .../kafka/api/PlaintextConsumerTest.scala          | 54 ++++++++++++++++++++++
 1 file changed, 54 insertions(+)
d9ae33d4c0473ef53a9ea560536467333136c0a0

 .../kafka/common/network/SaslChannelBuilder.java   |  13 ++-
 .../authenticator/SaslClientAuthenticator.java     |   7 +-
 .../authenticator/SaslServerAuthenticator.java     |  12 +--
 .../authenticator/SaslServerCallbackHandler.java   |  12 +--
 .../common/security/kerberos/BadFormatString.java  |  30 ++++++
 .../common/security/kerberos/KerberosName.java     |  55 +++++------
 .../security/kerberos/KerberosNameParser.java      | 105 ---------------------
 .../common/security/kerberos/KerberosRule.java     |   8 +-
 .../security/kerberos/KerberosShortNamer.java      | 101 ++++++++++++++++++++
 .../common/security/kerberos/KerberosNameTest.java |  14 +--
 10 files changed, 188 insertions(+), 169 deletions(-)
622730905d7826694d6ae503ad61927dfa255d14

 tests/MANIFEST.in | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
13803ae91cc2d25ef42b71f3737e6c2ee7eb8809

 .../src/main/scala/kafka/admin/ConfigCommand.scala |  5 ++--
 docs/design.html                                   | 25 ++++++++++++++++
 docs/ops.html                                      | 35 ++++++++++++++++++++++
 3 files changed, 63 insertions(+), 2 deletions(-)
e0ca8fdd7cf3fcc51a5a1152eacdf585434052d8

 vagrant/base.sh | 5 +++++
 1 file changed, 5 insertions(+)
0da65476175e398378381041232af718321a5829

 core/src/main/scala/kafka/network/RequestChannel.scala | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
42bcc4339f41bed320edde8bf141d0702798c021

 core/src/test/resources/zk-digest-jaas.conf        | 23 -------------
 .../kafka/security/auth/ZkAuthorizationTest.scala  |  6 ++--
 .../scala/unit/kafka/utils/JaasTestUtils.scala     | 40 ++++++++++++++++++++++
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  6 ++--
 4 files changed, 44 insertions(+), 31 deletions(-)
217eb90444ef6a6aacf95997666768ee849e6769

 .../java/org/apache/kafka/common/metrics/Metrics.java  |  8 ++++----
 core/src/main/scala/kafka/network/RequestChannel.scala | 18 +++++++++++++++---
 core/src/main/scala/kafka/server/KafkaApis.scala       |  8 ++++++++
 3 files changed, 27 insertions(+), 7 deletions(-)
1b5687b9e4cd10e0f91fb921d3569fdd44be163d

 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +
 .../kafka/clients/consumer/internals/Fetcher.java  |  26 +-
 .../common/errors/AuthorizationException.java      |  19 +
 .../kafka/common/network/SaslChannelBuilder.java   |   3 +-
 .../kafka/common/network/SslChannelBuilder.java    |   3 +-
 .../kafka/common/requests/SyncGroupResponse.java   |   4 +
 .../kafka/common/security/kerberos/Login.java      |   3 +-
 .../kafka/api/ControlledShutdownRequest.scala      |   4 +-
 .../scala/kafka/api/UpdateMetadataRequest.scala    |   2 +-
 .../kafka/common/AuthorizationException.scala      |   1 +
 .../scala/kafka/security/auth/Authorizer.scala     |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |  62 ++--
 .../kafka/api/AuthorizerIntegrationTest.scala      | 388 +++++++++++++++++++++
 13 files changed, 477 insertions(+), 41 deletions(-)
47c888078d257c45c3685c514d0d4556ac46f947

 core/src/test/resources/zk-digest-jaas.conf | 12 ++++++++++++
 1 file changed, 12 insertions(+)
bd3fe839ce0e4a7276d19e8e873783aa0cd76707

 build.gradle    | 2 ++
 tests/README.md | 2 +-
 2 files changed, 3 insertions(+), 1 deletion(-)
443cd9ab0db5223b7c85ac8333f2fc1a0e554870

 .../apache/kafka/clients/consumer/KafkaConsumer.java  |  8 ++++----
 .../consumer/internals/AbstractCoordinator.java       |  3 ++-
 .../java/org/apache/kafka/common/protocol/Errors.java |  2 ++
 .../consumer/internals/ConsumerCoordinatorTest.java   | 19 +++++++++++++++++++
 .../scala/kafka/coordinator/GroupCoordinator.scala    |  6 ++++++
 .../coordinator/GroupCoordinatorResponseTest.scala    | 13 +++++++++++++
 6 files changed, 46 insertions(+), 5 deletions(-)
983b1f9e17a0f392cfb7785f572c767540a12e2b

 .../apache/kafka/common/security/JaasUtils.java    |   3 +-
 .../scala/kafka/admin/ZkSecurityMigrator.scala     |  14 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  17 +-
 core/src/test/resources/zk-digest-jaas.conf        |  11 +
 .../kafka/security/auth/ZkAuthorizationTest.scala  | 317 +++++++++++++++++++++
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |   2 +
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  75 +++--
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  59 +++-
 8 files changed, 460 insertions(+), 38 deletions(-)
8838fa8010c146af6aab014a41bc7e68318b4eb0

 .../apache/kafka/copycat/runtime/distributed/DistributedHerder.java   | 4 ++++
 .../kafka/copycat/runtime/distributed/DistributedHerderTest.java      | 2 ++
 2 files changed, 6 insertions(+)
9855bb9c655ebad0ed5586175452056466189b8a

 .../kafka/clients/consumer/ConsumerConfig.java     |   2 -
 .../kafka/clients/producer/ProducerConfig.java     |   2 -
 .../apache/kafka/common/config/SaslConfigs.java    |  24 +-
 .../kafka/common/network/SaslChannelBuilder.java   |   2 +-
 .../authenticator/SaslClientAuthenticator.java     |  21 +-
 .../authenticator/SaslServerAuthenticator.java     |  10 +-
 .../common/security/kerberos/KerberosName.java     |   8 +-
 .../security/kerberos/KerberosNameParser.java      |  12 +-
 .../kafka/common/security/kerberos/Login.java      |  16 +-
 .../common/security/kerberos/LoginManager.java     |  12 +
 .../distributed/DistributedHerderConfig.java       |   3 +-
 .../controller/ControllerChannelManager.scala      |  21 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  10 +-
 .../integration/kafka/api/BaseConsumerTest.scala   | 357 ++-------------------
 .../kafka/api/BaseProducerSendTest.scala           | 151 ++++-----
 .../kafka/api/IntegrationTestHarness.scala         |  10 +-
 .../kafka/api/PlaintextConsumerTest.scala          | 302 ++++++++++++++++-
 .../scala/integration/kafka/api/QuotasTest.scala   |   3 +-
 .../integration/kafka/api/SaslTestHarness.scala    |  44 ++-
 .../kafka/integration/KafkaServerTestHarness.scala |   2 -
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  31 +-
 22 files changed, 531 insertions(+), 514 deletions(-)
b6fe164dd6f9483469c0b0661c24467e33e91cd9

 .../producer/internals/RecordAccumulator.java      |  2 +-
 .../kafka/clients/producer/internals/Sender.java   |  2 +-
 .../org/apache/kafka/common/record/Compressor.java |  4 +
 .../apache/kafka/common/record/MemoryRecords.java  | 98 ++++++++++++----------
 .../org/apache/kafka/common/record/Records.java    | 13 +--
 .../clients/consumer/internals/FetcherTest.java    |  3 +-
 .../producer/internals/RecordAccumulatorTest.java  |  5 +-
 .../kafka/common/record/MemoryRecordsTest.java     |  2 -
 8 files changed, 66 insertions(+), 63 deletions(-)
80223baa3b7125fd656ed85b450498a21924ca71

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
7a36d36478635ae16b64c6410b88c92b45d5f129

 core/src/main/scala/kafka/server/ReplicaManager.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
1ac2640f8095262f423c770060b737f81652e211

 .../clients/consumer/ConsumerWakeupException.java  | 20 -----------------
 .../kafka/clients/consumer/KafkaConsumer.java      | 26 +++++++++++-----------
 .../kafka/clients/consumer/MockConsumer.java       |  3 ++-
 .../consumer/internals/AbstractCoordinator.java    | 26 +++++++++++++---------
 .../consumer/internals/ConsumerCoordinator.java    | 10 ++++++---
 .../consumer/internals/ConsumerNetworkClient.java  | 10 ++++-----
 .../kafka/common/errors/WakeupException.java       | 26 ++++++++++++++++++++++
 .../internals/ConsumerNetworkClientTest.java       |  4 ++--
 .../kafka/copycat/runtime/WorkerSinkTask.java      |  3 ++-
 .../runtime/distributed/DistributedHerder.java     |  6 ++---
 .../runtime/distributed/WorkerGroupMember.java     |  2 +-
 .../apache/kafka/copycat/util/KafkaBasedLog.java   | 10 ++++-----
 12 files changed, 81 insertions(+), 65 deletions(-)
13c3e049fbf22522c90c2a0b4b4f680b974d9bea

 .../java/org/apache/kafka/streams/kstream/internals/KStreamImpl.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0b05d3b939c5ed37a4253e7c3614d824e76ed664

 .../org/apache/kafka/clients/NetworkClient.java    | 37 ++++--------
 .../consumer/internals/AbstractCoordinator.java    | 14 ++++-
 .../consumer/internals/ConsumerNetworkClient.java  | 70 +++++++++++++++-------
 .../java/org/apache/kafka/clients/MockClient.java  | 15 ++---
 4 files changed, 83 insertions(+), 53 deletions(-)
e6b343302f3208f7f6e0099fe2a7132ef9eaaafb

 tests/kafkatest/__init__.py                        |  10 +
 .../sanity_checks/test_console_consumer.py         |  43 ++-
 .../kafkatest/sanity_checks/test_kafka_version.py  |  55 ++++
 .../sanity_checks/test_verifiable_producer.py      |  70 +++++
 tests/kafkatest/services/console_consumer.py       | 109 +++++---
 tests/kafkatest/services/copycat.py                |   9 +-
 tests/kafkatest/services/kafka.py                  | 253 -----------------
 tests/kafkatest/services/kafka/__init__.py         |  16 ++
 tests/kafkatest/services/kafka/config.py           |  53 ++++
 tests/kafkatest/services/kafka/config_property.py  | 177 ++++++++++++
 tests/kafkatest/services/kafka/directory.py        |  32 +++
 tests/kafkatest/services/kafka/kafka.py            | 303 +++++++++++++++++++++
 .../services/kafka/templates/kafka.properties      |  65 +++++
 tests/kafkatest/services/kafka/version.py          |  61 +++++
 tests/kafkatest/services/kafka_log4j_appender.py   |  13 +-
 tests/kafkatest/services/mirror_maker.py           |   5 +-
 tests/kafkatest/services/monitor/__init__.py       |  14 +
 tests/kafkatest/services/monitor/jmx.py            |  90 ++++++
 .../services/performance/consumer_performance.py   |   8 +-
 .../services/performance/end_to_end_latency.py     |   8 +-
 tests/kafkatest/services/performance/jmx_mixin.py  |  81 ------
 .../services/performance/producer_performance.py   |  44 +--
 .../kafkatest/services/templates/kafka.properties  |  74 -----
 tests/kafkatest/services/verifiable_producer.py    |  88 +++++-
 tests/kafkatest/services/zookeeper.py              |   8 +-
 tests/kafkatest/tests/produce_consume_validate.py  | 106 +++++++
 tests/kafkatest/tests/quota_test.py                |  20 +-
 tests/kafkatest/tests/replication_test.py          | 207 ++++++--------
 tests/kafkatest/tests/upgrade_test.py              |  81 ++++++
 tests/kafkatest/utils/__init__.py                  |   4 +-
 tests/kafkatest/utils/util.py                      |  42 +++
 tests/setup.py                                     |  10 +-
 .../org/apache/kafka/tools/VerifiableProducer.java |  30 +-
 vagrant/base.sh                                    |  26 +-
 34 files changed, 1561 insertions(+), 654 deletions(-)
af42c37899e8fc66590e7f3c4893f8224441f6a8

 .../streams/processor/internals/StreamThread.java  | 25 ++++++++++++++--------
 1 file changed, 16 insertions(+), 9 deletions(-)
38a1b605533632f61f4c23b69933eb496098311b

 .../java/org/apache/kafka/streams/processor/internals/StreamTask.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c6c4f50703ff250b737080aaf239969473af99f0

 .../consumer/internals/AbstractCoordinator.java    |  9 ++++-
 .../errors/RebalanceInProgressException.java       | 37 +++++++++++++++++
 .../org/apache/kafka/common/protocol/Errors.java   |  2 +-
 .../internals/ConsumerCoordinatorTest.java         | 47 ++++++++++++++++++++++
 4 files changed, 92 insertions(+), 3 deletions(-)
8bc59a3b8f29854b8c7178609b99d7c9491886dc

 .../org/apache/kafka/log4jappender/KafkaLog4jAppender.java   | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
d21cb66e7d21ed3d20fc1e13b9a856f764bb4237

 .../kafka/log4jappender/KafkaLog4jAppender.java    | 88 ++++++++++++++++++++--
 1 file changed, 82 insertions(+), 6 deletions(-)
2fd645ac2fec7cf089cb8175ee47823b67a07226

 .../main/scala/kafka/consumer/BaseConsumer.scala   |  12 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 554 ++++++++++++++-------
 2 files changed, 373 insertions(+), 193 deletions(-)
2e4aed7070f0283e2c1e0e563fdb3324482463a5

 bin/kafka-verifiable-producer.sh                   |   2 +-
 checkstyle/import-control.xml                      |  14 +-
 tests/kafkatest/services/kafka_log4j_appender.py   |   2 +-
 .../services/performance/producer_performance.py   |   2 +-
 .../kafka/clients/tools/ProducerPerformance.java   | 201 -------------
 .../kafka/clients/tools/ThroughputThrottler.java   | 118 --------
 .../clients/tools/VerifiableLog4jAppender.java     | 162 -----------
 .../kafka/clients/tools/VerifiableProducer.java    | 324 ---------------------
 .../apache/kafka/tools/ProducerPerformance.java    | 201 +++++++++++++
 .../apache/kafka/tools/ThroughputThrottler.java    | 117 ++++++++
 .../kafka/tools/VerifiableLog4jAppender.java       | 162 +++++++++++
 .../org/apache/kafka/tools/VerifiableProducer.java | 324 +++++++++++++++++++++
 12 files changed, 814 insertions(+), 815 deletions(-)
fc4ef479109fbae12470e44f8c12fe9e5f41e179

 docs/configuration.html |  6 +++---
 docs/documentation.html | 10 +++++-----
 docs/upgrade.html       | 28 +++++++++++++++++++++++-----
 3 files changed, 31 insertions(+), 13 deletions(-)
e6f9b9e473f0396743cdfc5236bfd551316fc6f7

 .../streams/kstream/SlidingWindowSupplier.java     |  2 +-
 .../streams/processor/DefaultPartitionGrouper.java | 46 ++++-----------
 .../kafka/streams/processor/PartitionGrouper.java  | 10 ++--
 .../kafka/streams/processor/ProcessorContext.java  |  2 +-
 .../org/apache/kafka/streams/processor/TaskId.java | 66 ++++++++++++++++++++++
 .../kafka/streams/processor/TopologyBuilder.java   | 63 +++++++++++++++------
 .../internals/KafkaStreamingPartitionAssignor.java | 26 +++++----
 .../processor/internals/ProcessorContextImpl.java  |  8 +--
 .../streams/processor/internals/StreamTask.java    | 11 ++--
 .../streams/processor/internals/StreamThread.java  | 19 ++++---
 .../kafka/streams/state/MeteredKeyValueStore.java  |  2 +-
 .../kafka/streams/state/RocksDBKeyValueStore.java  |  2 +-
 .../processor/DefaultPartitionGrouperTest.java     | 37 +++++++-----
 .../streams/processor/TopologyBuilderTest.java     | 19 ++++++-
 .../processor/internals/StreamTaskTest.java        |  5 +-
 .../processor/internals/StreamThreadTest.java      | 25 ++++----
 .../streams/state/KeyValueStoreTestDriver.java     |  5 +-
 .../apache/kafka/test/MockProcessorContext.java    |  5 +-
 .../kafka/test/ProcessorTopologyTestDriver.java    | 43 +++++++-------
 19 files changed, 247 insertions(+), 149 deletions(-)
b251bebbcc3074f0491fce988f1d46ccdc97f1fa

 .../consumer/internals/AbstractCoordinator.java    | 110 +++++++++++----------
 .../consumer/internals/ConsumerCoordinator.java    |  16 +--
 .../kafka/clients/consumer/internals/Fetcher.java  |   3 +-
 .../runtime/distributed/WorkerCoordinator.java     |   6 +-
 .../runtime/distributed/WorkerCoordinatorTest.java |   8 +-
 5 files changed, 73 insertions(+), 70 deletions(-)
71399ffe4c52e2539a5794a17852c8c5b3d5fe72

 .../java/org/apache/kafka/common/utils/Utils.java  |  35 +++++-
 .../org/apache/kafka/streams/StreamingConfig.java  |  40 +++++--
 .../kafka/streams/kstream/KStreamBuilder.java      |  10 +-
 .../streams/kstream/SlidingWindowSupplier.java     |   4 +-
 .../streams/kstream/internals/KStreamImpl.java     |  28 +++--
 .../streams/kstream/internals/KStreamJoin.java     |   4 -
 .../kstream/internals/KStreamWindowedImpl.java     |  19 ++-
 .../streams/processor/DefaultPartitionGrouper.java |  97 +++++++++++++++
 .../kafka/streams/processor/PartitionGrouper.java  |  55 +++++++++
 .../kafka/streams/processor/ProcessorContext.java  |   9 +-
 .../kafka/streams/processor/TopologyBuilder.java   |  85 ++++++++++++-
 .../internals/KafkaStreamingPartitionAssignor.java | 133 +++++++++++++++++++++
 .../processor/internals/ProcessorContextImpl.java  |  35 ------
 .../processor/internals/ProcessorStateManager.java |  14 +--
 .../streams/processor/internals/QuickUnion.java    |  67 +++++++++++
 .../streams/processor/internals/StreamTask.java    |   2 +-
 .../streams/processor/internals/StreamThread.java  |  84 +++++++++----
 .../kafka/streams/state/MeteredKeyValueStore.java  |   4 +-
 .../kafka/streams/state/RocksDBKeyValueStore.java  |   6 +-
 .../streams/kstream/internals/KStreamJoinTest.java |  33 ++++-
 .../processor/DefaultPartitionGrouperTest.java     |  76 ++++++++++++
 .../streams/processor/TopologyBuilderTest.java     |  41 ++++++-
 .../processor/internals/QuickUnionTest.java        |  97 +++++++++++++++
 .../processor/internals/StreamThreadTest.java      | 110 +++++++++++++----
 .../streams/state/KeyValueStoreTestDriver.java     |  54 ++++-----
 .../apache/kafka/test/MockProcessorContext.java    |   9 +-
 26 files changed, 980 insertions(+), 171 deletions(-)
939c4244e7353e0000939837b14ec7c7550aeb21

 docs/images/mirror-maker.png | Bin 17054 -> 6579 bytes
 docs/ops.html                |   2 +-
 2 files changed, 1 insertion(+), 1 deletion(-)
16f194b20ad9795188f1d7781e7cbca1cd2a6a2d

 .../kafka/clients/consumer/ConsumerConfig.java     |  32 +-
 .../kafka/clients/producer/ProducerConfig.java     |  32 +-
 .../org/apache/kafka/common/config/SSLConfigs.java |  99 ---
 .../org/apache/kafka/common/config/SslConfigs.java |  99 +++
 .../kafka/common/network/ChannelBuilders.java      |   2 +-
 .../common/network/PlaintextChannelBuilder.java    |   5 +-
 .../kafka/common/network/SSLChannelBuilder.java    |  75 ---
 .../kafka/common/network/SSLTransportLayer.java    | 734 ---------------------
 .../kafka/common/network/SaslChannelBuilder.java   |  14 +-
 .../kafka/common/network/SslChannelBuilder.java    |  75 +++
 .../kafka/common/network/SslTransportLayer.java    | 733 ++++++++++++++++++++
 .../kafka/common/network/TransportLayer.java       |   3 +-
 .../kafka/common/security/ssl/SSLFactory.java      | 198 ------
 .../kafka/common/security/ssl/SslFactory.java      | 198 ++++++
 .../kafka/clients/producer/KafkaProducerTest.java  |   4 +-
 .../apache/kafka/common/network/EchoServer.java    |   6 +-
 .../kafka/common/network/SSLSelectorTest.java      | 170 -----
 .../common/network/SSLTransportLayerTest.java      | 652 ------------------
 .../apache/kafka/common/network/SelectorTest.java  |   4 +-
 .../kafka/common/network/SslSelectorTest.java      | 170 +++++
 .../common/network/SslTransportLayerTest.java      | 651 ++++++++++++++++++
 .../kafka/common/security/ssl/SSLFactoryTest.java  |  61 --
 .../kafka/common/security/ssl/SslFactoryTest.java  |  61 ++
 .../java/org/apache/kafka/test/TestSSLUtils.java   | 243 -------
 .../java/org/apache/kafka/test/TestSslUtils.java   | 242 +++++++
 .../distributed/DistributedHerderConfig.java       |  32 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |   2 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |   6 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala | 146 ++--
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   2 +-
 .../unit/kafka/network/SocketServerTest.scala      |   2 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  30 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   8 +-
 33 files changed, 2392 insertions(+), 2399 deletions(-)
6f2f1f9843f537b9bda3aa3951a867fdee661761

 .../apache/kafka/copycat/storage/OffsetUtils.java  |  5 ++
 .../copycat/storage/OffsetStorageWriterTest.java   | 71 ++++++++++++++++------
 2 files changed, 59 insertions(+), 17 deletions(-)
2e61773590c0ba86cb8813e6ba17bf6ee33f4461

 build.gradle                                       |   1 +
 checkstyle/import-control.xml                      |   1 +
 .../kafka/clients/consumer/RoundRobinAssignor.java |  35 +-
 .../consumer/internals/AbstractCoordinator.java    |   8 +-
 .../kafka/common/utils/CircularIterator.java       |  54 ++
 config/copycat-distributed.properties              |   2 +
 .../kafka/copycat/file/FileStreamSinkTask.java     |  12 +-
 .../kafka/copycat/file/FileStreamSourceTask.java   |  17 +-
 .../kafka/copycat/cli/CopycatDistributed.java      |   7 +-
 .../kafka/copycat/runtime/ConnectorConfig.java     |   2 +-
 .../apache/kafka/copycat/runtime/TaskConfig.java   |  54 ++
 .../org/apache/kafka/copycat/runtime/Worker.java   | 145 +++-
 .../runtime/distributed/ClusterConfigState.java    |  40 +-
 .../runtime/distributed/CopycatProtocol.java       | 246 +++++++
 .../runtime/distributed/DistributedHerder.java     | 733 +++++++++++++++------
 .../distributed/DistributedHerderConfig.java       | 192 ++++++
 .../runtime/distributed/NotLeaderException.java    |  38 ++
 .../runtime/distributed/WorkerCoordinator.java     | 288 ++++++++
 .../runtime/distributed/WorkerGroupMember.java     | 184 ++++++
 .../distributed/WorkerRebalanceListener.java       |  38 ++
 .../runtime/standalone/StandaloneHerder.java       | 168 ++---
 .../kafka/copycat/storage/KafkaConfigStorage.java  |  64 +-
 .../copycat/storage/KafkaOffsetBackingStore.java   |   2 +
 .../apache/kafka/copycat/util/ConnectorTaskId.java |  10 +-
 .../apache/kafka/copycat/runtime/WorkerTest.java   | 199 +++++-
 .../runtime/distributed/DistributedHerderTest.java | 436 +++++++-----
 .../runtime/distributed/WorkerCoordinatorTest.java | 436 ++++++++++++
 .../runtime/standalone/StandaloneHerderTest.java   |  45 +-
 .../copycat/storage/KafkaConfigStorageTest.java    |  49 +-
 .../org/apache/kafka/copycat/util/TestFuture.java  |  10 +-
 tests/kafkatest/services/copycat.py                |  67 +-
 tests/kafkatest/tests/copycat_distributed_test.py  |  67 +-
 tests/kafkatest/tests/copycat_test.py              |   5 +-
 .../tests/templates/copycat-distributed.properties |   7 +-
 34 files changed, 2966 insertions(+), 696 deletions(-)
21443f214fc6f1f51037e27f8ece155cf1eb288c

 bin/zookeeper-security-migration.sh                |  17 ++
 .../apache/kafka/common/security/JaasUtils.java    |   5 +
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   2 +-
 .../scala/kafka/admin/ZkSecurityMigrator.scala     | 237 +++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaConfig.scala |   5 +
 core/src/main/scala/kafka/server/KafkaServer.scala |   9 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  15 +-
 core/src/test/scala/other/kafka/DeleteZKPath.scala |   1 -
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   1 +
 9 files changed, 285 insertions(+), 7 deletions(-)
701c46b3a32da78008ae48298778fca8b5a16bce

 core/src/main/scala/kafka/Kafka.scala                       | 12 +++++-------
 core/src/main/scala/kafka/server/KafkaServerStartable.scala | 11 ++++++++++-
 2 files changed, 15 insertions(+), 8 deletions(-)
aa56dfb9e7cea19faa545a13d42d499a6958cbef

 .../kafka/clients/consumer/KafkaConsumer.java      | 20 ++++--
 .../kafka/clients/consumer/MockConsumer.java       |  4 +-
 .../consumer/internals/ConsumerCoordinator.java    |  2 +-
 .../consumer/internals/SubscriptionState.java      | 38 ++++++----
 .../kafka/clients/consumer/KafkaConsumerTest.java  | 32 +++++++++
 .../internals/ConsumerCoordinatorTest.java         | 18 ++---
 .../clients/consumer/internals/FetcherTest.java    | 36 +++++-----
 .../consumer/internals/SubscriptionStateTest.java  | 81 +++++++++++-----------
 .../kafka/clients/producer/KafkaProducerTest.java  |  1 -
 9 files changed, 142 insertions(+), 90 deletions(-)
bf292a6fa5b52844edfe256e8f1dd42da432d0c9

 .../integration/kafka/api/SslConsumerTest.scala    | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)
2e25f899a118e7d4d5eb89118e447a87ad02f71c

 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
65922b5388561e3ab830fd1f367faa289d205e2a

 .../apache/kafka/common/config/AbstractConfig.java | 30 ++++++++++++---
 .../org/apache/kafka/common/config/SSLConfigs.java | 13 ++++---
 .../apache/kafka/common/network/Authenticator.java |  7 ++--
 .../kafka/common/security/ssl/SSLFactory.java      | 25 ++++++------
 .../controller/ControllerChannelManager.scala      |  2 +-
 .../main/scala/kafka/network/SocketServer.scala    |  5 +--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 44 ++++------------------
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  2 +-
 .../unit/kafka/security/auth/OperationTest.scala   |  2 +-
 .../kafka/security/auth/PermissionTypeTest.scala   |  2 +-
 .../kafka/security/auth/ResourceTypeTest.scala     |  2 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  1 +
 13 files changed, 63 insertions(+), 74 deletions(-)
d9b1dc70817de9366513b0cbed0b6e0702d473fa

 .../org/apache/kafka/common/metrics/Quota.java     |   4 +-
 .../org/apache/kafka/common/metrics/stats/Avg.java |   2 +-
 .../apache/kafka/common/metrics/MetricsTest.java   |  10 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  17 ++--
 .../scala/kafka/server/ClientQuotaManager.scala    |  73 ++++++++------
 .../main/scala/kafka/server/ConfigHandler.scala    |  30 ++++--
 .../scala/kafka/server/DynamicConfigManager.scala  |   6 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   5 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  12 ---
 core/src/main/scala/kafka/server/KafkaServer.scala |  10 +-
 .../scala/integration/kafka/api/QuotasTest.scala   |  41 +++++---
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  36 ++++++-
 .../unit/kafka/server/ClientQuotaManagerTest.scala | 109 ++++++++-------------
 .../kafka/server/DynamicConfigChangeTest.scala     |  26 +++--
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   2 -
 15 files changed, 216 insertions(+), 167 deletions(-)
361686d4a999298b6e5b63cacda72168172eb936

 .../kafka/common/network/SSLTransportLayer.java    |  23 +++--
 .../kafka/common/network/SSLSelectorTest.java      | 110 +++++++++++++++------
 .../common/network/SSLTransportLayerTest.java      |   2 +-
 .../apache/kafka/common/network/SelectorTest.java  |   2 +-
 4 files changed, 99 insertions(+), 38 deletions(-)
30056538130ae1e2be35398b0ddd2ea04105bafd

 core/src/main/scala/kafka/utils/KafkaScheduler.scala | 20 +++++++++++---------
 1 file changed, 11 insertions(+), 9 deletions(-)
86eb74d9236c586af5889fe79f4b9e066c9c2af3

 .../kafka/clients/consumer/ConsumerConfig.java     |   9 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |  47 +-
 .../kafka/clients/consumer/RangeAssignor.java      |  97 +++
 .../kafka/clients/consumer/RoundRobinAssignor.java | 114 +++
 .../consumer/internals/AbstractCoordinator.java    | 638 +++++++++++++++
 .../internals/AbstractPartitionAssignor.java       |  90 ++
 .../consumer/internals/ConsumerCoordinator.java    | 595 ++++++++++++++
 .../consumer/internals/ConsumerNetworkClient.java  |   9 +
 .../consumer/internals/ConsumerProtocol.java       | 162 ++++
 .../clients/consumer/internals/Coordinator.java    | 848 -------------------
 .../kafka/clients/consumer/internals/Fetcher.java  |  31 +-
 .../consumer/internals/PartitionAssignor.java      | 117 +++
 .../clients/consumer/internals/RequestFuture.java  |  16 +-
 .../consumer/internals/SubscriptionState.java      |  44 +-
 .../main/java/org/apache/kafka/common/Cluster.java |  10 +
 .../ConsumerCoordinatorNotAvailableException.java  |  40 -
 .../GroupCoordinatorNotAvailableException.java     |  40 +
 .../errors/NotCoordinatorForConsumerException.java |  40 -
 .../errors/NotCoordinatorForGroupException.java    |  40 +
 .../common/errors/UnknownConsumerIdException.java  |  33 -
 .../common/errors/UnknownMemberIdException.java    |  33 +
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   5 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  22 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  97 ++-
 .../kafka/common/requests/AbstractRequest.java     |   6 +-
 .../common/requests/ConsumerMetadataRequest.java   |  65 --
 .../common/requests/ConsumerMetadataResponse.java  |  70 --
 .../common/requests/GroupMetadataRequest.java      |  65 ++
 .../common/requests/GroupMetadataResponse.java     |  70 ++
 .../kafka/common/requests/HeartbeatRequest.java    |  16 +-
 .../kafka/common/requests/HeartbeatResponse.java   |   6 +-
 .../kafka/common/requests/JoinGroupRequest.java    |  96 ++-
 .../kafka/common/requests/JoinGroupResponse.java   | 110 ++-
 .../kafka/common/requests/OffsetCommitRequest.java |  34 +-
 .../common/requests/OffsetCommitResponse.java      |   6 +-
 .../kafka/common/requests/OffsetFetchResponse.java |   4 +-
 .../kafka/common/requests/SyncGroupRequest.java    | 118 +++
 .../kafka/common/requests/SyncGroupResponse.java   |  71 ++
 .../java/org/apache/kafka/common/utils/Utils.java  |  28 +
 .../org/apache/kafka/clients/MetadataTest.java     |   1 -
 .../kafka/clients/consumer/RangeAssignorTest.java  | 217 +++++
 .../clients/consumer/RoundRobinAssignorTest.java   | 209 +++++
 .../internals/ConsumerCoordinatorTest.java         | 749 +++++++++++++++++
 .../internals/ConsumerNetworkClientTest.java       |   2 +-
 .../consumer/internals/ConsumerProtocolTest.java   | 118 +++
 .../consumer/internals/CoordinatorTest.java        | 635 ---------------
 .../clients/consumer/internals/FetcherTest.java    |   4 +-
 .../consumer/internals/MockPartitionAssignor.java  |  49 ++
 .../kafka/common/requests/RequestResponseTest.java |  16 +-
 .../kafka/copycat/util/KafkaBasedLogTest.java      |   2 +-
 core/src/main/scala/kafka/admin/AclCommand.scala   |  22 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |   7 +-
 .../scala/kafka/api/ConsumerMetadataRequest.scala  |  80 --
 .../scala/kafka/api/ConsumerMetadataResponse.scala |  58 --
 .../scala/kafka/api/GroupMetadataRequest.scala     |  80 ++
 .../scala/kafka/api/GroupMetadataResponse.scala    |  58 ++
 .../main/scala/kafka/api/OffsetCommitRequest.scala |  16 +-
 core/src/main/scala/kafka/api/RequestKeys.scala    |   5 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |   4 +-
 .../kafka/common/OffsetMetadataAndError.scala      |   5 +-
 core/src/main/scala/kafka/common/Topic.scala       |   4 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   4 +-
 .../kafka/coordinator/ConsumerCoordinator.scala    | 535 ------------
 .../kafka/coordinator/ConsumerGroupMetadata.scala  | 133 ---
 .../scala/kafka/coordinator/ConsumerMetadata.scala |  50 --
 .../kafka/coordinator/CoordinatorMetadata.scala    | 160 +---
 .../scala/kafka/coordinator/DelayedHeartbeat.scala |  12 +-
 .../main/scala/kafka/coordinator/DelayedJoin.scala |  40 +
 .../scala/kafka/coordinator/DelayedRebalance.scala |  40 -
 .../scala/kafka/coordinator/GroupCoordinator.scala | 632 ++++++++++++++
 .../scala/kafka/coordinator/GroupMetadata.scala    | 209 +++++
 .../scala/kafka/coordinator/MemberMetadata.scala   |  99 +++
 .../kafka/coordinator/PartitionAssignor.scala      | 125 ---
 .../kafka/javaapi/ConsumerMetadataResponse.scala   |  47 --
 .../kafka/javaapi/GroupMetadataResponse.scala      |  47 ++
 .../scala/kafka/security/auth/ResourceType.scala   |   6 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 144 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  16 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   6 +-
 .../main/scala/kafka/server/OffsetManager.scala    |  16 +-
 .../integration/kafka/api/BaseConsumerTest.scala   |  25 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  10 +-
 .../kafka/api/IntegrationTestHarness.scala         |  12 +-
 .../scala/integration/kafka/api/QuotasTest.scala   |   1 -
 .../integration/kafka/api/SslConsumerTest.scala    |  22 -
 .../test/scala/other/kafka/TestOffsetManager.scala |   4 +-
 .../scala/unit/kafka/admin/AclCommandTest.scala    |   8 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |   8 +-
 .../api/RequestResponseSerializationTest.scala     |  10 +-
 .../unit/kafka/consumer/TopicFilterTest.scala      |  10 +-
 .../ConsumerCoordinatorResponseTest.scala          | 447 ----------
 .../coordinator/ConsumerGroupMetadataTest.scala    | 172 ----
 .../coordinator/CoordinatorMetadataTest.scala      | 160 +---
 .../coordinator/GroupCoordinatorResponseTest.scala | 907 +++++++++++++++++++++
 .../unit/kafka/coordinator/GroupMetadataTest.scala | 249 ++++++
 .../kafka/coordinator/MemberMetadataTest.scala     |  90 ++
 .../kafka/coordinator/PartitionAssignorTest.scala  | 305 -------
 .../security/auth/SimpleAclAuthorizerTest.scala    |   4 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   4 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   6 +-
 101 files changed, 6634 insertions(+), 4428 deletions(-)
6e747d42974bd6b445a3ffed50281a1e8d55c3a1

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1d4a0b8811d82a6465015a71194a712679d63efe

 .../kafka/clients/consumer/MockConsumer.java       |  58 ++++----
 .../kafka/copycat/util/KafkaBasedLogTest.java      | 164 +++++++++------------
 2 files changed, 97 insertions(+), 125 deletions(-)
0785feeb0fae2a4f75a59147197c5138109b1b39

 .../kafka/clients/ClusterConnectionStates.java     |  4 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 88 ++++++++++++++++++----
 .../kafka/clients/consumer/KafkaConsumer.java      |  2 +-
 .../consumer/internals/ConsumerNetworkClient.java  | 13 ++--
 .../kafka/clients/producer/KafkaProducer.java      |  2 +-
 .../apache/kafka/clients/NetworkClientTest.java    | 33 +++++++-
 .../java/org/apache/kafka/test/MockSelector.java   |  6 ++
 .../controller/ControllerChannelManager.scala      |  3 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  3 +-
 10 files changed, 129 insertions(+), 28 deletions(-)
44f6c4b946511ce4663d41bf40f2960d2faee198

 .../src/main/scala/kafka/admin/ConfigCommand.scala | 16 ++++++-
 core/src/main/scala/kafka/admin/TopicCommand.scala | 56 +++++++++++++++++++++-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  9 ++++
 3 files changed, 78 insertions(+), 3 deletions(-)
403158b54b18cabf93eb15d4c4dd8ab66604bf9f

 build.gradle                                       |   5 +-
 checkstyle/import-control.xml                      |   6 +-
 .../java/org/apache/kafka/clients/ClientUtils.java |   9 +-
 .../kafka/clients/consumer/ConsumerConfig.java     |   8 +
 .../kafka/clients/producer/ProducerConfig.java     |   8 +
 .../apache/kafka/common/config/SaslConfigs.java    |  54 ++
 .../apache/kafka/common/network/Authenticator.java |  11 +-
 .../kafka/common/network/ChannelBuilder.java       |   2 +
 .../kafka/common/network/ChannelBuilders.java      |  25 +-
 .../kafka/common/network/DefaultAuthenticator.java |   5 +-
 .../apache/kafka/common/network/KafkaChannel.java  |   4 +-
 .../org/apache/kafka/common/network/LoginType.java |  39 ++
 .../java/org/apache/kafka/common/network/Mode.java |  19 +
 .../common/network/PlaintextChannelBuilder.java    |   6 +-
 .../common/network/PlaintextTransportLayer.java    |   5 +-
 .../kafka/common/network/SSLChannelBuilder.java    |  20 +-
 .../kafka/common/network/SSLTransportLayer.java    |   9 +-
 .../kafka/common/network/SaslChannelBuilder.java   | 113 ++++
 .../org/apache/kafka/common/network/Selector.java  |   1 +
 .../kafka/common/network/TransportLayer.java       |   3 +-
 .../kafka/common/protocol/SecurityProtocol.java    |   4 +
 .../apache/kafka/common/security/JaasUtils.java    |  60 ++-
 .../common/security/auth/PrincipalBuilder.java     |  19 +-
 .../authenticator/SaslClientAuthenticator.java     | 259 +++++++++
 .../authenticator/SaslServerAuthenticator.java     | 203 +++++++
 .../authenticator/SaslServerCallbackHandler.java   |  81 +++
 .../common/security/kerberos/KerberosName.java     | 114 ++++
 .../security/kerberos/KerberosNameParser.java      | 103 ++++
 .../common/security/kerberos/KerberosRule.java     | 189 +++++++
 .../kafka/common/security/kerberos/Login.java      | 389 ++++++++++++++
 .../common/security/kerberos/LoginManager.java     | 118 ++++
 .../common/security/kerberos/NoMatchingRule.java   |  27 +
 .../kafka/common/security/ssl/SSLFactory.java      |   4 +-
 .../java/org/apache/kafka/common/utils/Shell.java  | 304 +++++++++++
 .../java/org/apache/kafka/common/utils/Time.java   |   6 +-
 .../apache/kafka/common/network/EchoServer.java    |   2 +-
 .../kafka/common/network/SSLSelectorTest.java      |   7 +-
 .../common/network/SSLTransportLayerTest.java      |  14 +-
 .../common/security/kerberos/KerberosNameTest.java |  59 ++
 .../kafka/common/security/ssl/SSLFactoryTest.java  |   9 +-
 .../org/apache/kafka/common/utils/MockTime.java    |   4 +-
 .../java/org/apache/kafka/test/TestSSLUtils.java   |  10 +-
 .../controller/ControllerChannelManager.scala      |   5 +-
 .../main/scala/kafka/network/SocketServer.scala    |   5 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  83 ++-
 core/src/main/scala/kafka/server/KafkaServer.scala |  11 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 core/src/test/resources/kafka_jaas.conf            |  29 +
 .../integration/kafka/api/BaseConsumerTest.scala   | 596 +++++++++++++++++++++
 .../kafka/api/BaseProducerSendTest.scala           | 383 +++++++++++++
 .../scala/integration/kafka/api/ConsumerTest.scala | 594 --------------------
 .../kafka/api/IntegrationTestHarness.scala         |   9 +-
 .../kafka/api/PlaintextConsumerTest.scala          |  15 +
 .../kafka/api/PlaintextProducerSendTest.scala      |  54 ++
 .../integration/kafka/api/ProducerSendTest.scala   | 416 --------------
 .../integration/kafka/api/SSLConsumerTest.scala    | 231 --------
 .../kafka/api/SSLProducerSendTest.scala            | 240 ---------
 .../kafka/api/SaslPlaintextConsumerTest.scala      |  19 +
 .../kafka/api/SaslSslConsumerTest.scala            |  22 +
 .../integration/kafka/api/SaslTestHarness.scala    |  63 +++
 .../integration/kafka/api/SslConsumerTest.scala    |  22 +
 .../kafka/api/SslProducerSendTest.scala            |  27 +
 .../kafka/integration/BaseTopicMetadataTest.scala  |  12 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   7 +-
 .../integration/PlaintextTopicMetadataTest.scala   |   3 +
 .../SaslPlaintextTopicMetadataTest.scala           |  26 +
 .../integration/SaslSslTopicMetadataTest.scala     |  28 +
 .../kafka/integration/SslTopicMetadataTest.scala   |   5 +-
 .../unit/kafka/network/SocketServerTest.scala      |   3 +-
 .../unit/kafka/server/BaseReplicaFetchTest.scala   |  10 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   8 +
 .../kafka/server/PlaintextReplicaFetchTest.scala   |   3 +
 .../server/SaslPlaintextReplicaFetchTest.scala     |  26 +
 .../kafka/server/SaslSslReplicaFetchTest.scala     |  28 +
 .../unit/kafka/server/SslReplicaFetchTest.scala    |   5 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 134 +++--
 76 files changed, 3809 insertions(+), 1654 deletions(-)
8f32617e6506a5f67d4f922f4088507994ba91ef

 .../java/org/apache/kafka/clients/consumer/internals/Fetcher.java     | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
14c128a162a7540f22e78a2e4bab6f20662b49ce

 tests/kafkatest/services/performance/consumer_performance.py | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
343db8a7f4d22a593f0aecc79d55869350803889

 core/src/main/scala/kafka/log/LogCleaner.scala      | 21 +++++++++++++++++----
 .../scala/unit/kafka/admin/DeleteTopicTest.scala    |  2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala  | 17 ++++++++++++-----
 .../test/scala/unit/kafka/utils/MockScheduler.scala |  1 +
 4 files changed, 31 insertions(+), 10 deletions(-)
6745435251feab3085056cd2f8c9c400da849048

 .../kafka/clients/consumer/ConsumerConfig.java     |  4 ++--
 .../kafka/clients/producer/ProducerConfig.java     |  4 ++--
 .../org/apache/kafka/common/config/SSLConfigs.java |  6 ------
 .../kafka/common/security/ssl/SSLFactory.java      | 25 +++++++---------------
 core/src/main/scala/kafka/server/KafkaConfig.scala | 15 +++++--------
 5 files changed, 17 insertions(+), 37 deletions(-)
964114a8aa28024f0e34693bb78da618f36574d3

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
241b9ab58dcbde0ca2545fcbaea864d778f4f93d

 README.md | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)
ce306ba4ebc77464bf8ff4d656e1f1f44979182e

 checkstyle/import-control.xml                      |   1 +
 .../apache/kafka/common/security/JaasUtils.java    |  64 ++++
 core/src/main/scala/kafka/admin/AdminUtils.scala   | 129 +++----
 .../src/main/scala/kafka/admin/ConfigCommand.scala |  26 +-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |  74 ++--
 .../PreferredReplicaLeaderElectionCommand.scala    |  27 +-
 .../kafka/admin/ReassignPartitionsCommand.scala    |  67 ++--
 core/src/main/scala/kafka/admin/TopicCommand.scala |  65 ++--
 core/src/main/scala/kafka/client/ClientUtils.scala |  12 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |   6 +-
 .../common/ZkNodeChangeNotificationListener.scala  |  14 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |   6 +-
 .../scala/kafka/consumer/PartitionAssignor.scala   |  10 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |  14 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  58 +--
 .../consumer/ZookeeperTopicEventWatcher.scala      |  20 +-
 .../scala/kafka/controller/KafkaController.scala   |  89 +++--
 .../kafka/controller/PartitionLeaderSelector.scala |   2 +-
 .../kafka/controller/PartitionStateMachine.scala   |  39 +-
 .../kafka/controller/ReplicaStateMachine.scala     |  12 +-
 .../kafka/controller/TopicDeletionManager.scala    |  12 +-
 .../kafka/coordinator/ConsumerCoordinator.scala    |  16 +-
 .../kafka/coordinator/CoordinatorMetadata.scala    |  10 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |  42 ++-
 .../scala/kafka/server/DynamicConfigManager.scala  |  16 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  10 +-
 .../main/scala/kafka/server/KafkaHealthcheck.scala |   7 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  58 +--
 .../main/scala/kafka/server/OffsetManager.scala    |   4 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   4 +-
 .../kafka/server/ZookeeperLeaderElector.scala      |  12 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |  40 ++-
 .../main/scala/kafka/tools/ExportZkOffsets.scala   |  24 +-
 .../main/scala/kafka/tools/ImportZkOffsets.scala   |   9 +-
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala |  19 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |  25 +-
 .../main/scala/kafka/utils/ReplicationUtils.scala  |  25 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 399 ++++++++++++---------
 .../integration/kafka/api/ConsumerBounceTest.scala |   2 +-
 .../scala/integration/kafka/api/ConsumerTest.scala |  26 +-
 .../kafka/api/IntegrationTestHarness.scala         |   2 +-
 .../integration/kafka/api/ProducerBounceTest.scala |   4 +-
 .../kafka/api/ProducerCompressionTest.scala        |   2 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |  14 +-
 .../integration/kafka/api/ProducerSendTest.scala   |  14 +-
 .../scala/integration/kafka/api/QuotasTest.scala   |   2 +-
 .../integration/kafka/api/SSLConsumerTest.scala    |   6 +-
 .../kafka/api/SSLProducerSendTest.scala            |   6 +-
 core/src/test/scala/other/kafka/DeleteZKPath.scala |   4 +-
 .../test/scala/other/kafka/TestOffsetManager.scala |  24 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  34 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 107 +++---
 .../unit/kafka/admin/DeleteConsumerGroupTest.scala |  48 +--
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  85 ++---
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |  36 +-
 .../ZkNodeChangeNotificationListenerTest.scala     |   6 +-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |   2 +-
 .../kafka/consumer/PartitionAssignorTest.scala     |  23 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  38 +-
 .../kafka/controller/ControllerFailoverTest.scala  |   2 +-
 .../coordinator/CoordinatorMetadataTest.scala      |  52 +--
 .../kafka/integration/AutoOffsetResetTest.scala    |   2 +-
 .../kafka/integration/BaseTopicMetadataTest.scala  |  14 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |   4 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   8 +-
 .../unit/kafka/integration/RollingBounceTest.scala |  10 +-
 .../integration/UncleanLeaderElectionTest.scala    |  22 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   2 +-
 .../scala/unit/kafka/metrics/MetricsTest.scala     |   8 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  18 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  18 +-
 .../security/auth/SimpleAclAuthorizerTest.scala    |   6 +-
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |   2 +-
 .../unit/kafka/server/BaseReplicaFetchTest.scala   |   2 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |  10 +-
 .../server/HighwatermarkPersistenceTest.scala      |  18 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  18 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   8 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  14 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  16 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  11 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 +-
 .../unit/kafka/server/ServerStartupTest.scala      |   6 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   6 +-
 .../unit/kafka/utils/ReplicationUtilsTest.scala    |  16 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  57 +--
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  26 +-
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala |  48 +--
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  10 +-
 91 files changed, 1283 insertions(+), 1109 deletions(-)
78a2e2f8f39b24774e5edc8cf0c1093889db2fdf

 docs/design.html                      |   4 ++--
 docs/images/consumer-groups.png       | Bin 0 -> 26820 bytes
 docs/images/kafka_log.png             | Bin 0 -> 134321 bytes
 docs/images/kafka_multidc.png         | Bin 0 -> 33959 bytes
 docs/images/kafka_multidc_complex.png | Bin 0 -> 38559 bytes
 docs/images/log_anatomy.png           | Bin 0 -> 19579 bytes
 docs/images/log_cleaner_anatomy.png   | Bin 0 -> 18638 bytes
 docs/images/log_compaction.png        | Bin 0 -> 41414 bytes
 docs/images/mirror-maker.png          | Bin 0 -> 17054 bytes
 docs/images/producer_consumer.png     | Bin 0 -> 8691 bytes
 docs/images/tracking_high_level.png   | Bin 0 -> 82759 bytes
 docs/implementation.html              |   2 +-
 docs/introduction.html                |   6 +++---
 docs/ops.html                         |   2 +-
 14 files changed, 7 insertions(+), 7 deletions(-)
636e14a99191eeededfb933aacfe2459c7c7bb6f

 .../org/apache/kafka/common/protocol/ApiKeys.java  |  3 +-
 .../org/apache/kafka/common/protocol/Protocol.java | 13 ++++
 .../kafka/common/requests/AbstractRequest.java     |  2 +
 .../kafka/common/requests/LeaveGroupRequest.java   | 71 ++++++++++++++++++++++
 .../kafka/common/requests/LeaveGroupResponse.java  | 53 ++++++++++++++++
 .../kafka/common/requests/RequestResponseTest.java | 11 ++++
 core/src/main/scala/kafka/api/RequestKeys.scala    |  1 +
 .../kafka/coordinator/ConsumerCoordinator.scala    | 46 ++++++++++++--
 .../scala/kafka/coordinator/ConsumerMetadata.scala |  1 +
 core/src/main/scala/kafka/server/KafkaApis.scala   | 22 ++++++-
 .../ConsumerCoordinatorResponseTest.scala          | 69 +++++++++++++++++++++
 11 files changed, 286 insertions(+), 6 deletions(-)
e2e5c891428e5f1288b6f4674983d924f8bdb779

 .../kafka/clients/consumer/internals/Fetcher.java  | 32 +++++++++++++++++++++-
 .../common/errors/RecordTooLargeException.java     | 13 +++++++++
 .../clients/consumer/internals/FetcherTest.java    | 21 ++++++++++++++
 .../scala/integration/kafka/api/ConsumerTest.scala |  3 +-
 4 files changed, 66 insertions(+), 3 deletions(-)
ef65d0a360ed65180ddd84d17679f24671c66e14

 .../apache/kafka/copycat/data/SchemaProjector.java | 197 ++++++++
 .../copycat/errors/SchemaProjectorException.java   |  29 ++
 .../kafka/copycat/data/SchemaProjectorTest.java    | 495 +++++++++++++++++++++
 3 files changed, 721 insertions(+)
c553249b4e6d7d385821061f9742f15f90e94def

 .../kafka/streams/state/InMemoryLRUCacheStore.java | 180 +++++++++++++++++++++
 .../kafka/streams/state/MeteredKeyValueStore.java  |  44 +++--
 .../org/apache/kafka/streams/state/Stores.java     |  25 ++-
 .../streams/state/InMemoryLRUCacheStoreTest.java   | 148 +++++++++++++++++
 4 files changed, 386 insertions(+), 11 deletions(-)
aa66b42daca0791840da3c77d47c96cf98f19ef2

 .../org/apache/kafka/common/metrics/Metrics.java   | 51 ++++++++++++++++------
 .../apache/kafka/common/metrics/MetricsTest.java   |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 3 files changed, 39 insertions(+), 16 deletions(-)
7efa12705d91e21eec527ab49033b01ca5e3e3ce

 .../org/apache/kafka/clients/producer/KafkaProducer.java     | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
5338f8432f74054671e9da59ba6f97abb81a03f2

 .../src/main/java/kafka/examples/Consumer.java     | 72 +++++++++++-----------
 1 file changed, 36 insertions(+), 36 deletions(-)
50a076d1e9929d82107b3086f664a234a1c7b9f6

 .../processor/internals/StreamTaskTest.java        | 216 +++++++++++----------
 1 file changed, 118 insertions(+), 98 deletions(-)
a4dbf9010754183965772066a9cd2c5c4a49d44a

 .../apache/kafka/common/config/AbstractConfig.java | 11 ++++------
 .../org/apache/kafka/common/config/ConfigDef.java  |  2 +-
 .../java/org/apache/kafka/common/utils/Utils.java  | 24 +++++++++++++++++++++-
 .../kafka/common/config/AbstractConfigTest.java    |  3 ++-
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  2 +-
 5 files changed, 31 insertions(+), 11 deletions(-)
c50d39ea82e282d08163ebe7f0e398de2dc8c128

 .../processor/internals/PartitionGroup.java        |  5 +++++
 .../streams/processor/internals/StreamTask.java    | 17 ++++++++++++++-
 .../streams/processor/internals/StreamThread.java  | 25 +++++++++++++---------
 3 files changed, 36 insertions(+), 11 deletions(-)
28e59a1df7da9bbfc133180ee332a68e4540ee3e

 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java    | 9 +++++++++
 1 file changed, 9 insertions(+)
362613347371e9d74184e900ab80ba230940a5c8

 core/src/main/scala/kafka/admin/TopicCommand.scala | 60 ++++++++++++++++------
 1 file changed, 44 insertions(+), 16 deletions(-)
5013a41a514973e9612012413832e063ab062aef

 .../src/main/scala/kafka/admin/ConfigCommand.scala | 22 +++++++++++-----------
 .../scala/unit/kafka/admin/ConfigCommandTest.scala | 10 +++++-----
 2 files changed, 16 insertions(+), 16 deletions(-)
6e571225d51f5d71ffcfc4d22d108e89ae2f46ec

 .../kafka/streams/examples/ProcessorJob.java       |  12 +-
 .../streams/kstream/SlidingWindowSupplier.java     |   3 +-
 .../processor/internals/ProcessorContextImpl.java  |   3 +-
 .../processor/internals/RecordCollector.java       |  11 +
 .../streams/processor/internals/SinkNode.java      |   2 +-
 .../kafka/streams/state/InMemoryKeyValueStore.java |  21 +-
 .../kafka/streams/state/MeteredKeyValueStore.java  |  20 +-
 .../kafka/streams/state/RocksDBKeyValueStore.java  |  94 +++--
 .../org/apache/kafka/streams/state/Serdes.java     | 164 ++++++++
 .../org/apache/kafka/streams/state/Stores.java     | 257 ++++++++++++
 .../processor/internals/ProcessorTopologyTest.java |  56 +--
 .../streams/state/AbstractKeyValueStoreTest.java   | 191 +++++++++
 .../streams/state/InMemoryKeyValueStoreTest.java   |  38 ++
 .../streams/state/KeyValueStoreTestDriver.java     | 441 +++++++++++++++++++++
 .../streams/state/RocksDBKeyValueStoreTest.java    |  38 ++
 .../org/apache/kafka/streams/state/StateUtils.java |  77 ++++
 .../apache/kafka/test/MockProcessorContext.java    |  54 ++-
 17 files changed, 1359 insertions(+), 123 deletions(-)
f13d1155960a1ea907b09754877ee74586efd041

 core/src/main/scala/kafka/consumer/BaseConsumer.scala    |  9 ++++++---
 core/src/main/scala/kafka/tools/ConsoleConsumer.scala    | 16 ++++++++++++----
 tests/kafkatest/services/console_consumer.py             |  2 ++
 .../services/templates/console_consumer.properties       |  4 ----
 4 files changed, 20 insertions(+), 11 deletions(-)
27c099b043704d16a22c33e0602f0ae7295cab25

 .../clients/consumer/internals/Coordinator.java    | 14 +++++++++-
 .../scala/integration/kafka/api/ConsumerTest.scala | 30 ++++++++++++++++++++++
 2 files changed, 43 insertions(+), 1 deletion(-)
d8c5750799b9c5c4485514b6b02560679af8255d

 .../kafka/clients/consumer/internals/Fetcher.java  | 24 ++++++++++++++++------
 1 file changed, 18 insertions(+), 6 deletions(-)
b1ce9494e3a964613d3d9534471df79593514c77

 .../org/apache/kafka/streams/processor/internals/StreamTask.java  | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
123d27e4d005a384611671133fbecde7e390d24f

 tests/kafkatest/services/console_consumer.py       |  35 ++--
 tests/kafkatest/services/kafka.py                  |  23 ++-
 tests/kafkatest/services/performance/jmx_mixin.py  |  81 ++++++++++
 .../services/performance/producer_performance.py   |  24 ++-
 .../services/templates/console_consumer.properties |   7 +
 .../kafkatest/services/templates/kafka.properties  |  16 ++
 tests/kafkatest/tests/quota_test.py                | 180 +++++++++++++++++++++
 7 files changed, 340 insertions(+), 26 deletions(-)
36d4469326fe20c3f0657315321e6ad515530a3e

 .../java/org/apache/kafka/common/utils/Utils.java  |  13 +
 config/copycat-distributed.properties              |  13 +-
 config/copycat-standalone.properties               |  12 +-
 .../kafka/copycat/cli/CopycatDistributed.java      |   8 +-
 .../kafka/copycat/cli/CopycatStandalone.java       |   2 +-
 .../org/apache/kafka/copycat/cli/WorkerConfig.java |  20 +-
 .../kafka/copycat/runtime/ConnectorConfig.java     |   7 +-
 .../org/apache/kafka/copycat/runtime/Herder.java   |  19 +-
 .../copycat/runtime/HerderConnectorContext.java    |  42 ++
 .../org/apache/kafka/copycat/runtime/Worker.java   |  23 +-
 .../runtime/distributed/ClusterConfigState.java    | 122 +++++
 .../runtime/distributed/DistributedHerder.java     | 320 ++++++++++++
 .../standalone/StandaloneConnectorContext.java     |  42 --
 .../runtime/standalone/StandaloneHerder.java       |  34 +-
 .../kafka/copycat/storage/KafkaConfigStorage.java  | 546 +++++++++++++++++++++
 .../copycat/storage/KafkaOffsetBackingStore.java   | 258 ++--------
 .../copycat/storage/OffsetStorageReaderImpl.java   |   2 +-
 .../apache/kafka/copycat/storage/OffsetUtils.java  |   3 +
 .../apache/kafka/copycat/util/KafkaBasedLog.java   | 331 +++++++++++++
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  |   8 +-
 .../copycat/runtime/WorkerSourceTaskTest.java      |   8 +-
 .../apache/kafka/copycat/runtime/WorkerTest.java   |   8 +-
 .../runtime/distributed/DistributedHerderTest.java | 289 +++++++++++
 .../runtime/standalone/StandaloneHerderTest.java   |  62 +--
 .../copycat/storage/KafkaConfigStorageTest.java    | 508 +++++++++++++++++++
 .../storage/KafkaOffsetBackingStoreTest.java       | 399 ++++++---------
 .../kafka/copycat/util/KafkaBasedLogTest.java      | 463 +++++++++++++++++
 .../org/apache/kafka/copycat/util/TestFuture.java  |  80 ++-
 tests/kafkatest/services/copycat.py                |   3 +-
 tests/kafkatest/tests/copycat_distributed_test.py  |  14 +-
 .../tests/templates/copycat-distributed.properties |   9 +-
 .../tests/templates/copycat-standalone.properties  |   8 +-
 32 files changed, 3043 insertions(+), 633 deletions(-)
e2ec02e1d1580e73c06f1acbf3a53a1b8ee52930

 .../org/apache/kafka/common/config/SSLConfigs.java   |  4 ++--
 .../apache/kafka/common/security/ssl/SSLFactory.java | 20 ++++++++++----------
 core/src/main/scala/kafka/server/KafkaConfig.scala   | 20 +++++++++-----------
 .../scala/unit/kafka/server/KafkaConfigTest.scala    |  3 ++-
 4 files changed, 23 insertions(+), 24 deletions(-)
373332b0f98ade1a7d98e79c11cb5ea33dbe0985
f76013b0b3b1ae884b955202bb384d2a21b6cf48
518f78be0b96b92c03b985fbb61901c5cded7127
d7340503a14e3f31d96e3582e36c0255cd008e03

 README.md    | 6 ++++++
 build.gradle | 4 +++-
 2 files changed, 9 insertions(+), 1 deletion(-)
dd514b2bb8c476642952bf923de8d4c81bbeca7d

 .../scala/kafka/tools/ConsumerPerformance.scala    |  10 +-
 .../sanity_checks/test_console_consumer.py         |  14 ++-
 tests/kafkatest/services/console_consumer.py       |  37 ++++--
 tests/kafkatest/services/kafka.py                  |  20 +++-
 .../services/performance/consumer_performance.py   |  10 +-
 .../services/performance/end_to_end_latency.py     |  14 ++-
 .../services/performance/producer_performance.py   |  13 +-
 .../kafkatest/services/templates/kafka.properties  |  17 +++
 tests/kafkatest/services/verifiable_producer.py    |  19 ++-
 tests/kafkatest/tests/benchmark_test.py            |  83 +++++++++----
 tests/kafkatest/tests/replication_test.py          |  45 ++++---
 tests/kafkatest/utils/security_config.py           | 133 +++++++++++++++++++++
 .../kafka/clients/tools/VerifiableProducer.java    |  16 +++
 13 files changed, 363 insertions(+), 68 deletions(-)
7915396ee891759200cb3d89bbcf3b84bf20ed6a

 build.gradle | 8 ++++++++
 1 file changed, 8 insertions(+)
9fde92f9f1f1e40ceb6b3d5ff9676ba590385825

 .../apache/kafka/common/metrics/KafkaMetric.java   |  4 +++
 .../apache/kafka/common/metrics/stats/Rate.java    | 32 +++++++++++++++++++---
 .../apache/kafka/common/metrics/MetricsTest.java   | 28 +++++++++++++++++++
 .../scala/kafka/server/ClientQuotaManager.scala    | 23 ++++++++++++----
 .../scala/integration/kafka/api/QuotasTest.scala   |  4 +--
 .../unit/kafka/server/ClientQuotaManagerTest.scala | 11 +++++---
 6 files changed, 86 insertions(+), 16 deletions(-)
fe4818e0944a9146059b02fde3fea4cc15676bf6

 config/tools-log4j.properties | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
bd98a99c1e28f17bccafc317c819c1a82bfc6244

 core/src/main/scala/kafka/network/SocketServer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
1265d7cb7f56b5f5aad940250dc705a9a060a6f0

 .../apache/kafka/common/network/KafkaChannel.java  |  20 +-
 .../apache/kafka/common/network/Selectable.java    |   2 +-
 .../org/apache/kafka/common/network/Selector.java  |  41 +--
 .../common/network/SSLTransportLayerTest.java      |   8 +-
 .../main/scala/kafka/cluster/BrokerEndPoint.scala  |  24 +-
 .../main/scala/kafka/network/SocketServer.scala    | 283 +++++++++++----------
 .../unit/kafka/network/SocketServerTest.scala      |  59 +++--
 7 files changed, 256 insertions(+), 181 deletions(-)
c67ca65889721e3af7527ab26df49a9fb4db87ef

 .../org/apache/kafka/streams/kstream/KStream.java  | 21 ++++-
 .../apache/kafka/streams/kstream/Transformer.java  | 57 +++++++++++++
 .../kafka/streams/kstream/TransformerSupplier.java | 24 ++++++
 .../kafka/streams/kstream/ValueTransformer.java    | 56 +++++++++++++
 .../streams/kstream/ValueTransformerSupplier.java  | 24 ++++++
 .../streams/kstream/internals/KStreamImpl.java     | 30 ++++++-
 .../kstream/internals/KStreamTransform.java        | 71 +++++++++++++++++
 .../kstream/internals/KStreamTransformValues.java  | 69 ++++++++++++++++
 .../streams/processor/internals/StreamThread.java  | 10 ++-
 .../streams/kstream/internals/KStreamImplTest.java |  5 +-
 .../kstream/internals/KStreamTransformTest.java    | 93 ++++++++++++++++++++++
 .../internals/KStreamTransformValuesTest.java      | 92 +++++++++++++++++++++
 12 files changed, 539 insertions(+), 13 deletions(-)
96209b1e7a5ea9da0296a3319e3731b3802e3652

 copycat/api/src/main/java/org/apache/kafka/copycat/data/Time.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7233858bea1c548153ed00b7edffd55299db7cf2

 .../apache/kafka/streams/examples/KStreamJob.java  |   6 +-
 .../kafka/streams/examples/ProcessorJob.java       |   8 +-
 .../org/apache/kafka/streams/kstream/KStream.java  |  52 ++--
 .../apache/kafka/streams/kstream/Predicate.java    |   8 +-
 .../kafka/streams/kstream/SlidingWindowDef.java    | 265 ---------------------
 .../streams/kstream/SlidingWindowSupplier.java     | 265 +++++++++++++++++++++
 .../apache/kafka/streams/kstream/WindowDef.java    |  25 --
 .../kafka/streams/kstream/WindowSupplier.java      |  25 ++
 .../streams/kstream/internals/KStreamBranch.java   |  10 +-
 .../streams/kstream/internals/KStreamFilter.java   |   8 +-
 .../streams/kstream/internals/KStreamFlatMap.java  |   6 +-
 .../kstream/internals/KStreamFlatMapValues.java    |   6 +-
 .../streams/kstream/internals/KStreamImpl.java     |  20 +-
 .../streams/kstream/internals/KStreamJoin.java     |   7 +-
 .../streams/kstream/internals/KStreamMap.java      |   6 +-
 .../kstream/internals/KStreamMapValues.java        |   8 +-
 .../kstream/internals/KStreamPassThrough.java      |   8 +-
 .../streams/kstream/internals/KStreamWindow.java   |  20 +-
 .../kstream/internals/KStreamWindowedImpl.java     |  12 +-
 .../kafka/streams/processor/ProcessorDef.java      |  23 --
 .../kafka/streams/processor/ProcessorSupplier.java |  23 ++
 .../kafka/streams/processor/TopologyBuilder.java   |  19 +-
 .../kstream/internals/KStreamBranchTest.java       |  14 +-
 .../kstream/internals/KStreamFilterTest.java       |  12 +-
 .../kstream/internals/KStreamFlatMapTest.java      |   6 +-
 .../internals/KStreamFlatMapValuesTest.java        |   6 +-
 .../streams/kstream/internals/KStreamImplTest.java |  16 +-
 .../streams/kstream/internals/KStreamJoinTest.java |   6 +-
 .../streams/kstream/internals/KStreamMapTest.java  |   6 +-
 .../kstream/internals/KStreamMapValuesTest.java    |   4 +-
 .../kstream/internals/KStreamWindowedTest.java     |   8 +-
 .../streams/processor/TopologyBuilderTest.java     |  10 +-
 .../processor/internals/ProcessorTopologyTest.java |  14 +-
 .../org/apache/kafka/test/MockProcessorDef.java    |  58 -----
 .../apache/kafka/test/MockProcessorSupplier.java   |  59 +++++
 .../org/apache/kafka/test/UnlimitedWindowDef.java  |   6 +-
 36 files changed, 533 insertions(+), 522 deletions(-)
49822ff836e0fcd2a30bdf994d7b881a9de95cdf

 .../apache/kafka/copycat/data/CopycatSchema.java   | 19 ++++-
 .../java/org/apache/kafka/copycat/data/Time.java   | 77 +++++++++++++++++++++
 .../kafka/copycat/data/CopycatSchemaTest.java      | 29 ++++++++
 .../org/apache/kafka/copycat/data/TimeTest.java    | 80 ++++++++++++++++++++++
 .../apache/kafka/copycat/json/JsonConverter.java   | 18 +++++
 .../kafka/copycat/json/JsonConverterTest.java      | 31 +++++++++
 6 files changed, 253 insertions(+), 1 deletion(-)
6a06e22ef81aae3335ca59c94cb0fc33e9f4ceff

 .../kafka/clients/consumer/KafkaConsumer.java      |  1 +
 .../clients/consumer/internals/Coordinator.java    | 10 +++-
 .../consumer/internals/CoordinatorTest.java        | 34 +++++++++++++
 .../kafka/coordinator/ConsumerCoordinator.scala    | 11 +++--
 .../ConsumerCoordinatorResponseTest.scala          | 56 ++++++++++++++++++++--
 5 files changed, 104 insertions(+), 8 deletions(-)
5a921a3239e8b6c6f0fd6a65093c491ac3e539fd

 streams/src/main/java/org/apache/kafka/streams/kstream/KStream.java   | 2 +-
 .../org/apache/kafka/streams/kstream/internals/KStreamBranch.java     | 4 ++--
 .../org/apache/kafka/streams/kstream/internals/KStreamFilter.java     | 4 ++--
 .../org/apache/kafka/streams/kstream/internals/KStreamFlatMap.java    | 4 ++--
 .../apache/kafka/streams/kstream/internals/KStreamFlatMapValues.java  | 4 ++--
 .../java/org/apache/kafka/streams/kstream/internals/KStreamImpl.java  | 2 +-
 .../java/org/apache/kafka/streams/kstream/internals/KStreamJoin.java  | 4 ++--
 .../java/org/apache/kafka/streams/kstream/internals/KStreamMap.java   | 4 ++--
 .../org/apache/kafka/streams/kstream/internals/KStreamMapValues.java  | 4 ++--
 .../apache/kafka/streams/kstream/internals/KStreamPassThrough.java    | 4 ++--
 .../org/apache/kafka/streams/kstream/internals/KStreamWindow.java     | 4 ++--
 .../main/java/org/apache/kafka/streams/processor/ProcessorDef.java    | 4 ++--
 12 files changed, 22 insertions(+), 22 deletions(-)
f1110c3fbb166f94204b6bb18bc4e1a9100d3c4e

 core/src/main/scala/kafka/log/Log.scala        | 39 ++++++++++++++++++++------
 core/src/main/scala/kafka/log/LogSegment.scala |  9 +++---
 2 files changed, 35 insertions(+), 13 deletions(-)
693d4ca1a6fbb883fef5a2e7228ad56dd2f95fc8

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java   | 5 +++++
 1 file changed, 5 insertions(+)
2254f2bfaf5a6a2332ec390471ff3a7c34b8b890

 core/src/main/scala/kafka/security/auth/SimpleAclAuthorizer.scala  | 3 ---
 core/src/test/scala/unit/kafka/admin/AclCommandTest.scala          | 6 +++---
 .../scala/unit/kafka/security/auth/SimpleAclAuthorizerTest.scala   | 7 +++----
 core/src/test/scala/unit/kafka/utils/TestUtils.scala               | 6 ++++++
 4 files changed, 12 insertions(+), 10 deletions(-)
118912e76e5c867a8727f90d40bb969e0e6b65c5

 .../org/apache/kafka/common/metrics/Metrics.java   |  63 ++++++++-
 .../org/apache/kafka/common/metrics/Sensor.java    |  20 ++-
 .../consumer/internals/CoordinatorTest.java        |   6 +
 .../clients/consumer/internals/FetcherTest.java    |  10 +-
 .../clients/producer/internals/BufferPoolTest.java |   6 +
 .../producer/internals/RecordAccumulatorTest.java  |   6 +
 .../clients/producer/internals/SenderTest.java     |  77 ++++++-----
 .../kafka/common/metrics/JmxReporterTest.java      |  18 ++-
 .../apache/kafka/common/metrics/MetricsTest.java   |  64 ++++++++-
 .../kafka/common/network/SSLSelectorTest.java      |   6 +-
 .../apache/kafka/common/network/SelectorTest.java  |   5 +-
 .../java/org/apache/kafka/test/MetricsBench.java   |  38 +++---
 .../scala/kafka/server/ClientQuotaManager.scala    |  13 +-
 .../kafka/controller/ControllerFailoverTest.scala  |   8 +-
 .../unit/kafka/network/SocketServerTest.scala      |  80 ++++++-----
 .../server/HighwatermarkPersistenceTest.scala      | 149 +++++++++++----------
 .../unit/kafka/server/ISRExpirationTest.scala      |   1 +
 .../unit/kafka/server/LeaderElectionTest.scala     |  38 +++---
 .../unit/kafka/server/ReplicaManagerTest.scala     |  56 ++++----
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   1 +
 20 files changed, 450 insertions(+), 215 deletions(-)
2047a9afe1ef9cf81e6347fe27f0051c8758d226

 .../kafka/common/network/SSLChannelBuilder.java    |  15 +-
 .../kafka/common/network/SSLTransportLayer.java    |  89 +--
 .../kafka/common/network/SSLSelectorTest.java      | 166 +-----
 .../common/network/SSLTransportLayerTest.java      | 654 +++++++++++++++++++++
 .../apache/kafka/common/network/SelectorTest.java  |  30 +-
 5 files changed, 751 insertions(+), 203 deletions(-)
02e103b75aa6161c27358e83ab2828515c876701

 .../apache/kafka/copycat/data/CopycatSchema.java   |  31 +++++-
 .../java/org/apache/kafka/copycat/data/Date.java   |  76 ++++++++++++++
 .../org/apache/kafka/copycat/data/Decimal.java     |  87 ++++++++++++++++
 .../java/org/apache/kafka/copycat/data/Schema.java |   7 ++
 .../apache/kafka/copycat/data/SchemaBuilder.java   |  44 ++++++++-
 .../org/apache/kafka/copycat/data/Timestamp.java   |  64 ++++++++++++
 .../kafka/copycat/data/CopycatSchemaTest.java      |  38 +++----
 .../org/apache/kafka/copycat/data/DateTest.java    |  78 +++++++++++++++
 .../org/apache/kafka/copycat/data/DecimalTest.java |  63 ++++++++++++
 .../kafka/copycat/data/SchemaBuilderTest.java      |  40 +++++---
 .../apache/kafka/copycat/data/TimestampTest.java   |  75 ++++++++++++++
 .../apache/kafka/copycat/json/JsonConverter.java   | 103 ++++++++++++++++++-
 .../org/apache/kafka/copycat/json/JsonSchema.java  |   1 +
 .../kafka/copycat/json/JsonConverterTest.java      | 110 +++++++++++++++++++--
 14 files changed, 772 insertions(+), 45 deletions(-)
174a43cd09d3a2a2785daf0cfa5ada1646d8bfcc

 .../java/org/apache/kafka/common/cache/Cache.java  | 53 ++++++++++++
 .../org/apache/kafka/common/cache/LRUCache.java    | 57 +++++++++++++
 .../kafka/common/cache/SynchronizedCache.java      | 51 ++++++++++++
 .../apache/kafka/common/cache/LRUCacheTest.java    | 93 ++++++++++++++++++++++
 .../apache/kafka/copycat/json/JsonConverter.java   | 41 ++++++++--
 .../kafka/copycat/json/JsonConverterTest.java      | 47 +++++++++++
 6 files changed, 336 insertions(+), 6 deletions(-)
23f9afb70bc5cdbf66550a1e69161e2fe06a909a

 .../errors/IllegalWorkerStateException.java        |  35 ++++++
 .../apache/kafka/copycat/sink/SinkTaskContext.java |  19 ++++
 .../kafka/copycat/runtime/SinkTaskContextImpl.java |  24 -----
 .../kafka/copycat/runtime/WorkerSinkTask.java      |  35 +++++-
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  | 118 ++++++++++++++++++++-
 5 files changed, 201 insertions(+), 30 deletions(-)
a0ca8f6422e031c58e3a832852ba105e0f2efbad

 tests/kafkatest/sanity_checks/test_mirror_maker.py | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
b46cb3b2975afd8a3e82a0265c57760d8b9910da

 clients/src/main/java/org/apache/kafka/clients/Metadata.java     | 6 +++++-
 clients/src/test/java/org/apache/kafka/clients/MetadataTest.java | 3 +++
 2 files changed, 8 insertions(+), 1 deletion(-)
726e23ef491637e03b0ba90c21992a639dcd158d

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java   | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
f236bc20ff5995aa367089afcd0a6738aaaae754

 .../kafka/streams/processor/internals/ProcessorStateManagerTest.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
b88ba9a6bdde4d0828c513cde3251667ae13e655

 .../java/org/apache/kafka/clients/KafkaClient.java | 21 ++----------
 .../org/apache/kafka/clients/NetworkClient.java    | 38 +++-------------------
 .../org/apache/kafka/common/network/Selector.java  | 13 +++++---
 .../java/org/apache/kafka/clients/MockClient.java  | 13 --------
 4 files changed, 16 insertions(+), 69 deletions(-)
f9faf334b0f62aec04214236dd10e9ba36fb9567

 core/src/main/scala/kafka/tools/ConsoleProducer.scala | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)
4016011457296e5f5d7d84bc12181eeea14b0a16

 build.gradle             |  10 +-
 docs/api.html            | 154 ++++++++
 docs/configuration.html  | 928 +++++++++++++++++++++++++++++++++++++++++++++++
 docs/design.html         | 355 ++++++++++++++++++
 docs/documentation.html  | 133 +++++++
 docs/ecosystem.html      |  20 +
 docs/implementation.html | 387 ++++++++++++++++++++
 docs/introduction.html   |  99 +++++
 docs/migration.html      |  34 ++
 docs/ops.html            | 876 ++++++++++++++++++++++++++++++++++++++++++++
 docs/quickstart.html     | 189 ++++++++++
 docs/upgrade.html        |  44 +++
 docs/uses.html           |  56 +++
 13 files changed, 3284 insertions(+), 1 deletion(-)
37f7d75e3d55c600902cd15c3cb219ddd221d23c

 .../java/org/apache/kafka/common/MetricName.java   |  5 +-
 .../apache/kafka/common/metrics/MetricsTest.java   |  3 +-
 .../org/apache/kafka/streams/KafkaStreaming.java   | 35 +++++++-
 .../org/apache/kafka/streams/StreamingConfig.java  | 46 ++++++++---
 .../org/apache/kafka/streams/StreamingMetrics.java | 27 +++++++
 .../kafka/streams/kstream/SlidingWindowDef.java    | 10 +--
 .../kafka/streams/processor/ProcessorContext.java  |  8 +-
 .../kafka/streams/processor/RestoreFunc.java       | 27 -------
 .../streams/processor/StateRestoreCallback.java    | 27 +++++++
 .../processor/internals/ProcessorContextImpl.java  | 14 ++--
 .../processor/internals/ProcessorStateManager.java | 13 ++-
 .../streams/processor/internals/StreamTask.java    |  8 +-
 .../streams/processor/internals/StreamThread.java  | 94 +++++++++++++++++-----
 .../kafka/streams/state/InMemoryKeyValueStore.java |  7 +-
 .../kafka/streams/state/MeteredKeyValueStore.java  | 73 +++++------------
 .../kafka/streams/state/RocksDBKeyValueStore.java  |  6 +-
 .../internals/ProcessorStateManagerTest.java       | 18 ++---
 .../processor/internals/StreamTaskTest.java        |  4 +-
 .../processor/internals/StreamThreadTest.java      |  9 ++-
 .../apache/kafka/test/MockProcessorContext.java    | 10 +--
 .../kafka/test/ProcessorTopologyTestDriver.java    | 21 ++++-
 21 files changed, 295 insertions(+), 170 deletions(-)
b56e02b656e47fa7a0b402d3870735fba2bbe699

 .gitignore | 2 ++
 1 file changed, 2 insertions(+)
a3bd99811c6ed7b30611ff0592e4ce7bc8537260

 .../org/apache/kafka/clients/consumer/CommitType.java   | 17 -----------------
 core/src/main/scala/kafka/tools/EndToEndLatency.scala   |  2 +-
 .../scala/integration/kafka/api/SSLConsumerTest.scala   |  5 -----
 3 files changed, 1 insertion(+), 23 deletions(-)
4f8ad1561c761dd3ced22a5b8e2a6fa5e77283f2

 tests/bootstrap-test-env.sh | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
7cfdf19b54ab60b9644dcbecccb9130d6621da57

 .../common/network/PlaintextTransportLayer.java    | 10 ++++++--
 .../kafka/common/network/SSLTransportLayer.java    | 29 ++++++++++++++--------
 .../kafka/common/network/TransportLayer.java       | 18 ++++++++++++++
 core/src/main/scala/kafka/log/FileMessageSet.scala |  8 +++++-
 4 files changed, 51 insertions(+), 14 deletions(-)
5764e54de147af81aac85acc00687c23e9646a5c

 bin/kafka-acls.sh                                  |  17 +
 bin/windows/kafka-acls.bat                         |  17 +
 core/src/main/scala/kafka/admin/AclCommand.scala   | 350 +++++++++++++++++++++
 core/src/main/scala/kafka/common/BaseEnum.scala    |  26 ++
 .../scala/kafka/security/auth/Authorizer.scala     |   5 +
 .../main/scala/kafka/security/auth/Operation.scala |   4 +-
 .../scala/kafka/security/auth/PermissionType.scala |   6 +-
 .../main/scala/kafka/security/auth/Resource.scala  |   1 +
 .../scala/kafka/security/auth/ResourceType.scala   |   8 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  |   6 +-
 .../main/scala/kafka/utils/CommandLineUtils.scala  |   6 +-
 .../scala/unit/kafka/admin/AclCommandTest.scala    | 134 ++++++++
 .../security/auth/SimpleAclAuthorizerTest.scala    |  43 ++-
 13 files changed, 604 insertions(+), 19 deletions(-)
d03b871dd0c395d372e6a7d1ff027105380f588b

 .../org/apache/kafka/clients/ClientRequest.java    | 32 ++++++++++++----------
 .../org/apache/kafka/clients/ClientResponse.java   | 16 +++++------
 .../org/apache/kafka/clients/InFlightRequests.java |  9 +++---
 .../org/apache/kafka/clients/NetworkClient.java    |  3 +-
 .../java/org/apache/kafka/clients/MockClient.java  |  2 +-
 5 files changed, 32 insertions(+), 30 deletions(-)
5e769ccd5bf81f82c90069d4b0e79182a1cfe3c0

 .../kafka/clients/consumer/KafkaConsumer.java      | 29 ++--------
 .../clients/consumer/internals/Coordinator.java    | 50 ++++++++++++++++-
 .../consumer/internals/CoordinatorTest.java        |  6 ++-
 .../integration/kafka/api/ConsumerBounceTest.scala | 33 +++++++++---
 .../scala/integration/kafka/api/ConsumerTest.scala | 62 ++++++++++++++++++++++
 5 files changed, 145 insertions(+), 35 deletions(-)
6b1a92c89fce443902b7ef85e1f4b7eaa9bd33c3

 .../scala/unit/kafka/security/auth/SimpleAclAuthorizerTest.scala     | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
f5596a851d8e8aa29686b6f9ae18cfa5183dd29c

 .../src/test/java/org/apache/kafka/common/metrics/MetricsTest.java  | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)
73720113b97ccfcd796a844f87438546ed2e09e4

 .../main/java/org/apache/kafka/common/metrics/Quota.java |  2 +-
 .../org/apache/kafka/common/metrics/MetricsTest.java     | 16 ++++++++++++++++
 2 files changed, 17 insertions(+), 1 deletion(-)
2c4e63a899c6cf832fba4be35773218a9ba5239f

 .../org/apache/kafka/clients/ClientRequest.java    |  8 +++
 .../apache/kafka/clients/CommonClientConfigs.java  |  6 ++
 .../org/apache/kafka/clients/InFlightRequests.java | 26 ++++++-
 .../java/org/apache/kafka/clients/KafkaClient.java |  3 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 73 ++++++++++++++-----
 .../kafka/clients/consumer/ConsumerConfig.java     | 10 +++
 .../kafka/clients/consumer/KafkaConsumer.java      |  6 +-
 .../consumer/internals/ConsumerNetworkClient.java  |  2 +-
 .../kafka/clients/producer/KafkaProducer.java      | 83 +++++++++++++++++++---
 .../kafka/clients/producer/ProducerConfig.java     | 39 +++++++++-
 .../clients/producer/internals/BufferPool.java     | 20 ++----
 .../producer/internals/RecordAccumulator.java      | 57 ++++++++++++---
 .../clients/producer/internals/RecordBatch.java    | 38 +++++++++-
 .../kafka/clients/producer/internals/Sender.java   | 20 ++++--
 .../apache/kafka/common/network/Selectable.java    |  5 --
 .../org/apache/kafka/common/network/Selector.java  | 11 ---
 .../java/org/apache/kafka/clients/MockClient.java  |  3 +-
 .../apache/kafka/clients/NetworkClientTest.java    | 48 +++++++------
 .../clients/producer/internals/BufferPoolTest.java | 57 ++++++++-------
 .../producer/internals/RecordAccumulatorTest.java  | 67 +++++++++++------
 .../clients/producer/internals/SenderTest.java     | 21 +++---
 .../kafka/common/network/SSLSelectorTest.java      | 19 -----
 .../apache/kafka/common/network/SelectorTest.java  | 17 -----
 .../java/org/apache/kafka/test/MockSelector.java   |  6 +-
 .../controller/ControllerChannelManager.scala      |  3 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  7 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  3 +-
 .../scala/kafka/tools/ProducerPerformance.scala    |  2 -
 .../kafka/utils/NetworkClientBlockingOps.scala     |  2 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    | 46 +-----------
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  1 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  1 -
 33 files changed, 460 insertions(+), 253 deletions(-)
4e7db39556ba916c17f7dfeb32ff8ebefe468a33

 checkstyle/checkstyle.xml     |  18 +--
 checkstyle/import-control.xml | 330 +++++++++++++++++++++---------------------
 2 files changed, 174 insertions(+), 174 deletions(-)
41afdbe680c73621c309280a307e1f60b330905e

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)
c7bc5366dd874bf956873ba0f60c2c2820052fb3

 bin/kafka-run-class.sh          | 2 +-
 bin/windows/kafka-run-class.bat | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
f540f4a9193fd8437708f3bfe7856bc41d35d727

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)
c20e3bf8d81330407cbbb5445a9f294d3df7a821

 checkstyle/import-control.xml                                           | 1 +
 .../java/org/apache/kafka/clients/tools/VerifiableLog4jAppender.java    | 2 +-
 .../main/java/org/apache/kafka/clients/tools/VerifiableProducer.java    | 2 +-
 3 files changed, 3 insertions(+), 2 deletions(-)
e90562fb19996db901771ad9757d12b0a2f50f9e

 .../main/java/org/apache/kafka/copycat/file/FileStreamSourceTask.java    | 1 +
 1 file changed, 1 insertion(+)
b62f8ea43b6d5307f7274fbe8b7984dd5ee22239

 .../sanity_checks/test_console_consumer.py         |  20 +--
 tests/kafkatest/services/kafka_log4j_appender.py   |  61 ++++++++
 tests/kafkatest/tests/log4j_appender_test.py       |  62 ++++++++
 tests/kafkatest/utils/__init__.py                  |  15 ++
 tests/kafkatest/utils/remote_account.py            |  32 ++++
 .../clients/tools/VerifiableLog4jAppender.java     | 162 +++++++++++++++++++++
 .../kafka/clients/tools/VerifiableProducer.java    |   3 +-
 7 files changed, 335 insertions(+), 20 deletions(-)
263c10ab7c8e8fde9d3566bf59dccaa454ee2605

 bin/kafka-run-class.sh                             |   5 +
 build.gradle                                       |  76 +++-
 checkstyle/checkstyle.xml                          |   8 +-
 checkstyle/import-control.xml                      |  16 +-
 .../kafka/clients/consumer/ConsumerConfig.java     |   4 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +
 .../kafka/clients/consumer/MockConsumer.java       |  18 +-
 .../kafka/clients/producer/KafkaProducer.java      |   2 +
 .../kafka/clients/producer/ProducerConfig.java     |   4 +-
 .../apache/kafka/common/config/AbstractConfig.java |   4 +
 .../common/serialization/LongDeserializer.java     |  44 ++
 .../kafka/common/serialization/LongSerializer.java |  42 ++
 .../java/org/apache/kafka/common/utils/Utils.java  |  41 ++
 settings.gradle                                    |   4 +-
 .../org/apache/kafka/streams/KafkaStreaming.java   | 125 ++++++
 .../org/apache/kafka/streams/StreamingConfig.java  | 201 +++++++++
 .../apache/kafka/streams/examples/KStreamJob.java  |  84 ++++
 .../kafka/streams/examples/ProcessorJob.java       | 112 +++++
 .../examples/WallclockTimestampExtractor.java      |  28 ++
 .../org/apache/kafka/streams/kstream/KStream.java  | 156 +++++++
 .../kafka/streams/kstream/KStreamBuilder.java      |  65 +++
 .../kafka/streams/kstream/KStreamWindowed.java     |  38 ++
 .../org/apache/kafka/streams/kstream/KeyValue.java |  34 ++
 .../kafka/streams/kstream/KeyValueMapper.java      |  23 +
 .../apache/kafka/streams/kstream/Predicate.java    |  24 ++
 .../kafka/streams/kstream/SlidingWindowDef.java    | 265 ++++++++++++
 .../apache/kafka/streams/kstream/ValueJoiner.java  |  23 +
 .../apache/kafka/streams/kstream/ValueMapper.java  |  23 +
 .../org/apache/kafka/streams/kstream/Window.java   |  36 ++
 .../apache/kafka/streams/kstream/WindowDef.java    |  25 ++
 .../kstream/internals/FilteredIterator.java        |  63 +++
 .../streams/kstream/internals/KStreamBranch.java   |  52 +++
 .../streams/kstream/internals/KStreamFilter.java   |  48 +++
 .../streams/kstream/internals/KStreamFlatMap.java  |  47 ++
 .../kstream/internals/KStreamFlatMapValues.java    |  47 ++
 .../streams/kstream/internals/KStreamImpl.java     | 201 +++++++++
 .../streams/kstream/internals/KStreamJoin.java     |  96 +++++
 .../streams/kstream/internals/KStreamMap.java      |  46 ++
 .../kstream/internals/KStreamMapValues.java        |  45 ++
 .../kstream/internals/KStreamPassThrough.java      |  37 ++
 .../streams/kstream/internals/KStreamWindow.java   |  68 +++
 .../kstream/internals/KStreamWindowedImpl.java     |  54 +++
 .../streams/kstream/internals/WindowSupport.java   | 159 +++++++
 .../kafka/streams/processor/AbstractProcessor.java |  71 +++
 .../apache/kafka/streams/processor/Processor.java  |  59 +++
 .../kafka/streams/processor/ProcessorContext.java  | 106 +++++
 .../kafka/streams/processor/ProcessorDef.java      |  23 +
 .../kafka/streams/processor/RestoreFunc.java       |  27 ++
 .../apache/kafka/streams/processor/StateStore.java |  52 +++
 .../streams/processor/TimestampExtractor.java      |  34 ++
 .../kafka/streams/processor/TopologyBuilder.java   | 293 +++++++++++++
 .../kafka/streams/processor/TopologyException.java |  38 ++
 .../processor/internals/MinTimestampTracker.java   |  67 +++
 .../processor/internals/PartitionGroup.java        | 165 +++++++
 .../processor/internals/ProcessorContextImpl.java  | 214 +++++++++
 .../streams/processor/internals/ProcessorNode.java |  70 +++
 .../processor/internals/ProcessorStateManager.java | 232 ++++++++++
 .../processor/internals/ProcessorTopology.java     |  53 +++
 .../processor/internals/PunctuationQueue.java      |  56 +++
 .../processor/internals/PunctuationSchedule.java   |  41 ++
 .../streams/processor/internals/Punctuator.java    |  24 ++
 .../processor/internals/RecordCollector.java       |  80 ++++
 .../streams/processor/internals/RecordQueue.java   | 140 ++++++
 .../streams/processor/internals/SinkNode.java      |  64 +++
 .../streams/processor/internals/SourceNode.java    |  64 +++
 .../kafka/streams/processor/internals/Stamped.java |  38 ++
 .../streams/processor/internals/StampedRecord.java |  52 +++
 .../streams/processor/internals/StreamTask.java    | 352 +++++++++++++++
 .../streams/processor/internals/StreamThread.java  | 477 +++++++++++++++++++++
 .../processor/internals/TimestampTracker.java      |  58 +++
 .../java/org/apache/kafka/streams/state/Entry.java |  42 ++
 .../kafka/streams/state/InMemoryKeyValueStore.java | 145 +++++++
 .../kafka/streams/state/KeyValueIterator.java      |  29 ++
 .../apache/kafka/streams/state/KeyValueStore.java  |  86 ++++
 .../kafka/streams/state/MeteredKeyValueStore.java  | 273 ++++++++++++
 .../kafka/streams/state/OffsetCheckpoint.java      | 172 ++++++++
 .../kafka/streams/state/RocksDBKeyValueStore.java  | 276 ++++++++++++
 .../kafka/streams/kstream/KStreamBuilderTest.java  |  34 ++
 .../kstream/internals/FilteredIteratorTest.java    |  94 ++++
 .../kstream/internals/KStreamBranchTest.java       |  90 ++++
 .../kstream/internals/KStreamFilterTest.java       |  85 ++++
 .../kstream/internals/KStreamFlatMapTest.java      |  80 ++++
 .../internals/KStreamFlatMapValuesTest.java        |  77 ++++
 .../streams/kstream/internals/KStreamImplTest.java | 138 ++++++
 .../streams/kstream/internals/KStreamJoinTest.java | 164 +++++++
 .../streams/kstream/internals/KStreamMapTest.java  |  73 ++++
 .../kstream/internals/KStreamMapValuesTest.java    |  71 +++
 .../kstream/internals/KStreamWindowedTest.java     |  91 ++++
 .../streams/processor/TopologyBuilderTest.java     |  99 +++++
 .../internals/MinTimestampTrackerTest.java         |  93 ++++
 .../processor/internals/PartitionGroupTest.java    | 102 +++++
 .../internals/ProcessorStateManagerTest.java       | 449 +++++++++++++++++++
 .../processor/internals/ProcessorTopologyTest.java | 326 ++++++++++++++
 .../processor/internals/PunctuationQueueTest.java  |  85 ++++
 .../processor/internals/RecordQueueTest.java       | 116 +++++
 .../processor/internals/StreamTaskTest.java        | 186 ++++++++
 .../processor/internals/StreamThreadTest.java      | 389 +++++++++++++++++
 .../org/apache/kafka/test/KStreamTestDriver.java   |  95 ++++
 .../apache/kafka/test/MockProcessorContext.java    | 143 ++++++
 .../org/apache/kafka/test/MockProcessorDef.java    |  58 +++
 .../java/org/apache/kafka/test/MockSourceNode.java |  46 ++
 .../apache/kafka/test/MockTimestampExtractor.java  |  30 ++
 .../kafka/test/ProcessorTopologyTestDriver.java    | 317 ++++++++++++++
 .../org/apache/kafka/test/UnlimitedWindowDef.java  | 104 +++++
 104 files changed, 10083 insertions(+), 20 deletions(-)
ad120d5789306209ab8d110fcbd86d453d01641b

 core/src/main/scala/kafka/server/KafkaApis.scala | 32 +++++++++++++-----------
 1 file changed, 17 insertions(+), 15 deletions(-)
10d5deac0c00a0f651be1857fbdde6c74d7e9dac

 .../java/org/apache/kafka/clients/consumer/internals/Coordinator.java    | 1 -
 1 file changed, 1 deletion(-)
a07fbd0f19962037ec386b1814dc6c95749c91a3

 .../apache/kafka/clients/consumer/internals/Coordinator.java  | 11 ++++++++---
 .../kafka/common/errors/IllegalGenerationException.java       |  2 +-
 .../kafka/common/errors/UnknownConsumerIdException.java       |  2 +-
 3 files changed, 10 insertions(+), 5 deletions(-)
7e453df3179efed92d5bbe4ce9ee1d90a07cd503

 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 11 +++--------
 core/src/test/scala/integration/kafka/api/ConsumerTest.scala  |  5 ++---
 .../test/scala/integration/kafka/api/SSLConsumerTest.scala    |  6 ++----
 3 files changed, 7 insertions(+), 15 deletions(-)
fe798641a2ba5e60940fa91f5f01a14bcf98cf3e

 core/src/main/scala/kafka/server/KafkaApis.scala | 38 ++++++++++++------------
 1 file changed, 19 insertions(+), 19 deletions(-)
18d370124b51a97eb0522c220eb0ca619e315c6a

 .../main/java/org/apache/kafka/log4jappender/KafkaLog4jAppender.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
48b4d6938dfb9dc72c941e979ff0d0c4d921f743

 bin/copycat-distributed.sh                         |  23 ++
 checkstyle/import-control.xml                      |  12 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   5 +-
 .../kafka/clients/consumer/MockConsumer.java       | 191 +++++++--
 .../consumer/internals/SubscriptionState.java      |   5 +-
 .../kafka/clients/consumer/MockConsumerTest.java   |  12 +-
 config/copycat-distributed.properties              |  39 ++
 .../kafka/copycat/cli/CopycatDistributed.java      |  87 ++++
 .../kafka/copycat/cli/CopycatStandalone.java       |   6 +-
 .../org/apache/kafka/copycat/runtime/Worker.java   |  14 +-
 .../copycat/storage/FileOffsetBackingStore.java    |  29 +-
 .../copycat/storage/KafkaOffsetBackingStore.java   | 393 ++++++++++++++++++
 .../copycat/storage/MemoryOffsetBackingStore.java  |  18 +-
 .../kafka/copycat/storage/OffsetBackingStore.java  |  10 +-
 .../copycat/storage/OffsetStorageReaderImpl.java   |   4 +-
 .../kafka/copycat/storage/OffsetStorageWriter.java |   5 +-
 .../copycat/util/ConvertingFutureCallback.java     |  84 ++++
 .../apache/kafka/copycat/util/FutureCallback.java  |  52 +--
 .../apache/kafka/copycat/runtime/WorkerTest.java   |  36 +-
 .../storage/FileOffsetBackingStoreTest.java        |   8 +-
 .../storage/KafkaOffsetBackingStoreTest.java       | 458 +++++++++++++++++++++
 .../copycat/storage/OffsetStorageWriterTest.java   |   8 +-
 .../util/ByteArrayProducerRecordEquals.java        |  53 +++
 .../org/apache/kafka/copycat/util/TestFuture.java  |  81 ++++
 .../runtime/src/test/resources/log4j.properties    |  23 ++
 tests/kafkatest/services/copycat.py                | 110 +++--
 tests/kafkatest/tests/copycat_distributed_test.py  |  84 ++++
 tests/kafkatest/tests/copycat_test.py              |   2 +-
 .../tests/templates/copycat-distributed.properties |  32 ++
 29 files changed, 1685 insertions(+), 199 deletions(-)
bcf374da9e0d9ec8d13ecdaf4a1a15691549442b

 .../kafka/clients/consumer/KafkaConsumer.java      |  4 ++
 .../kafka/clients/consumer/internals/Fetcher.java  |  9 +--
 .../clients/consumer/internals/FetcherTest.java    | 69 +++++++++++++++++-----
 3 files changed, 63 insertions(+), 19 deletions(-)
ac757eb19ec50b79ab2b5336fa4d7411cd99456d

 core/src/main/scala/kafka/api/ApiVersion.scala                    | 8 ++++----
 .../main/scala/kafka/controller/ControllerChannelManager.scala    | 4 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala                | 2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala                | 6 +++---
 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala       | 4 ++--
 gradle.properties                                                 | 2 +-
 tests/setup.py                                                    | 2 +-
 7 files changed, 14 insertions(+), 14 deletions(-)
8943b08c9fbd31f7c50d5e06934a5fc225d56460

 kafka-merge-pr.py | 34 +++++++++++++++++-----------------
 1 file changed, 17 insertions(+), 17 deletions(-)
1daf6ac510602ee27210f069bbe7415d4610fbea

 .../consumer/ZookeeperConsumerConnector.scala      |  15 +-
 .../scala/kafka/controller/KafkaController.scala   |   7 +-
 .../main/scala/kafka/server/KafkaHealthcheck.scala |  12 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  17 +-
 .../kafka/server/ZookeeperLeaderElector.scala      |  11 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 232 ++++++++++++++++-----
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   6 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |   4 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   6 +-
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  98 +++++++++
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |   7 +-
 12 files changed, 326 insertions(+), 91 deletions(-)
54dd6e3ad7038ce4a32108b44153ec81caff2c68

 core/src/main/scala/kafka/api/ApiUtils.scala      |  9 +++-
 core/src/main/scala/kafka/api/FetchResponse.scala | 56 ++++++++++++++---------
 2 files changed, 43 insertions(+), 22 deletions(-)
b9ceac3ace353526da9c5d0f5b486265c871793a

 .../kafka/clients/consumer/KafkaConsumer.java      |  6 +++
 .../kafka/clients/consumer/internals/Fetcher.java  | 47 ++++++++++++++++++++--
 .../consumer/internals/SubscriptionState.java      |  4 ++
 .../common/errors/OffsetOutOfRangeException.java   | 12 ++++++
 4 files changed, 65 insertions(+), 4 deletions(-)
d1dd1e902685178a990861f9948fe07f820cf4ef

 checkstyle/import-control.xml                      |  2 +
 .../apache/kafka/clients/consumer/Consumer.java    |  6 +-
 .../kafka/clients/consumer/KafkaConsumer.java      | 20 +++---
 .../kafka/clients/consumer/MockConsumer.java       |  8 +--
 .../kafka/clients/consumer/OffsetAndMetadata.java  | 80 ++++++++++++++++++++++
 .../clients/consumer/OffsetCommitCallback.java     |  4 +-
 .../clients/consumer/internals/Coordinator.java    | 78 ++++++++++-----------
 .../kafka/clients/consumer/internals/Fetcher.java  |  6 +-
 .../clients/consumer/internals/RequestFuture.java  |  4 ++
 .../consumer/internals/SubscriptionState.java      | 17 ++---
 .../kafka/common/requests/OffsetCommitRequest.java | 12 ++--
 .../kafka/clients/consumer/MockConsumerTest.java   |  2 +-
 .../consumer/internals/CoordinatorTest.java        | 66 +++++++++++++-----
 .../clients/consumer/internals/FetcherTest.java    |  3 +-
 .../consumer/internals/SubscriptionStateTest.java  | 18 +++--
 .../org/apache/kafka/copycat/sink/SinkTask.java    |  3 +-
 .../kafka/copycat/file/FileStreamSinkTask.java     |  3 +-
 .../kafka/copycat/file/FileStreamSinkTaskTest.java |  9 +--
 .../kafka/copycat/runtime/WorkerSinkTask.java      |  6 +-
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  |  4 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |  4 +-
 .../scala/integration/kafka/api/ConsumerTest.scala | 40 ++++++++---
 .../integration/kafka/api/SSLConsumerTest.scala    |  4 +-
 23 files changed, 276 insertions(+), 123 deletions(-)
2837fa5a34420ea1ede90901ded6e9f3c94a3e7b

 .../org/apache/kafka/clients/consumer/internals/Coordinator.java    | 4 ++++
 clients/src/main/java/org/apache/kafka/common/protocol/Errors.java  | 4 +++-
 core/src/main/scala/kafka/coordinator/ConsumerCoordinator.scala     | 4 +++-
 .../unit/kafka/coordinator/ConsumerCoordinatorResponseTest.scala    | 6 +++---
 4 files changed, 13 insertions(+), 5 deletions(-)
4833d8a8c34b2fb86a5cf605ea5483d0b9eadc4f

 .../controller/ControllerChannelManager.scala      | 14 ++++++++++----
 .../scala/kafka/controller/KafkaController.scala   |  4 ++--
 core/src/main/scala/kafka/server/KafkaServer.scala |  4 ++--
 .../scala/kafka/server/ReplicaFetcherManager.scala | 10 ++++++++--
 .../main/scala/kafka/server/ReplicaManager.scala   |  5 +++--
 .../unit/kafka/server/ReplicaManagerTest.scala     |  4 ++--
 .../kafka/server/ServerGenerateBrokerIdTest.scala  | 22 +++++++++++-----------
 .../unit/kafka/server/ServerShutdownTest.scala     | 12 ++++--------
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  4 ++--
 9 files changed, 44 insertions(+), 35 deletions(-)
0990b6ba6a28276f79a1a8bfaf48455c6eddfa1f

 .../kafka/common/requests/LeaderAndIsrRequest.java |   2 +-
 config/log4j.properties                            |  11 +
 .../common/ZkNodeChangeNotificationListener.scala  | 129 ++++++++++
 .../main/scala/kafka/network/RequestChannel.scala  |   2 +-
 .../main/scala/kafka/network/SocketServer.scala    |   3 +-
 .../scala/kafka/security/auth/Authorizer.scala     |   4 +-
 .../kafka/security/auth/SimpleAclAuthorizer.scala  | 284 +++++++++++++++++++++
 .../ZkNodeChangeNotificationListenerTest.scala     |  61 +++++
 .../security/auth/SimpleAclAuthorizerTest.scala    | 233 +++++++++++++++++
 9 files changed, 724 insertions(+), 5 deletions(-)
6ec88f7f8a18be7aff12fb0c73fc8abd00ef62d2

 .../consumer/ConsumerRebalanceListener.java        | 32 +++++++------
 .../kafka/clients/consumer/KafkaConsumer.java      | 17 ++++---
 .../kafka/clients/consumer/MockConsumer.java       |  4 +-
 .../clients/consumer/internals/Coordinator.java    |  7 +--
 .../internals/NoOpConsumerRebalanceListener.java   |  9 ++--
 .../consumer/internals/SubscriptionState.java      | 53 ++--------------------
 .../kafka/clients/consumer/MockConsumerTest.java   | 18 +-------
 .../consumer/internals/CoordinatorTest.java        |  7 +--
 .../clients/consumer/internals/FetcherTest.java    |  3 +-
 .../consumer/internals/SubscriptionStateTest.java  | 37 ++++++++-------
 .../scala/kafka/tools/ConsumerPerformance.scala    |  4 +-
 .../scala/integration/kafka/api/ConsumerTest.scala |  4 +-
 12 files changed, 71 insertions(+), 124 deletions(-)
e18f6860c2b297cc2ce06f9f3cb37987af3bdbae

 .../kafka/clients/consumer/KafkaConsumer.java      | 33 +++++++++++-----------
 1 file changed, 17 insertions(+), 16 deletions(-)
9ae98685ec7882598aee80d11af41d7c0828e1b9

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 6 ++++++
 core/src/main/scala/kafka/controller/KafkaController.scala          | 3 +++
 2 files changed, 9 insertions(+)
9dbeb71ab258955e04b46991c1baf880b07633f4

 .../org/apache/kafka/clients/ClientRequest.java    |  8 ---
 .../apache/kafka/clients/CommonClientConfigs.java  |  6 --
 .../org/apache/kafka/clients/InFlightRequests.java | 26 +------
 .../java/org/apache/kafka/clients/KafkaClient.java |  3 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 73 +++++--------------
 .../kafka/clients/consumer/ConsumerConfig.java     | 10 ---
 .../kafka/clients/consumer/KafkaConsumer.java      |  3 +-
 .../consumer/internals/ConsumerNetworkClient.java  |  2 +-
 .../kafka/clients/producer/KafkaProducer.java      | 83 +++-------------------
 .../kafka/clients/producer/ProducerConfig.java     | 39 +---------
 .../clients/producer/internals/BufferPool.java     | 20 ++++--
 .../producer/internals/RecordAccumulator.java      | 57 +++------------
 .../clients/producer/internals/RecordBatch.java    | 38 +---------
 .../kafka/clients/producer/internals/Sender.java   | 20 ++----
 .../apache/kafka/common/network/Selectable.java    |  5 ++
 .../org/apache/kafka/common/network/Selector.java  | 11 +++
 .../java/org/apache/kafka/clients/MockClient.java  |  3 +-
 .../apache/kafka/clients/NetworkClientTest.java    | 48 ++++++-------
 .../clients/producer/internals/BufferPoolTest.java | 57 +++++++--------
 .../producer/internals/RecordAccumulatorTest.java  | 67 ++++++-----------
 .../clients/producer/internals/SenderTest.java     | 21 +++---
 .../kafka/common/network/SSLSelectorTest.java      | 19 +++++
 .../apache/kafka/common/network/SelectorTest.java  | 17 +++++
 .../java/org/apache/kafka/test/MockSelector.java   |  6 +-
 .../controller/ControllerChannelManager.scala      |  3 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  5 --
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  3 +-
 .../scala/kafka/tools/ProducerPerformance.scala    |  2 +
 .../kafka/utils/NetworkClientBlockingOps.scala     |  2 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    | 46 +++++++++++-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  1 -
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  1 +
 33 files changed, 251 insertions(+), 457 deletions(-)
da39931afad8008bc2b385a75a462777be051435

 .../org/apache/kafka/clients/ClientRequest.java    |  8 +++
 .../apache/kafka/clients/CommonClientConfigs.java  |  6 ++
 .../org/apache/kafka/clients/InFlightRequests.java | 26 ++++++-
 .../java/org/apache/kafka/clients/KafkaClient.java |  3 +-
 .../org/apache/kafka/clients/NetworkClient.java    | 73 ++++++++++++++-----
 .../kafka/clients/consumer/ConsumerConfig.java     | 10 +++
 .../kafka/clients/consumer/KafkaConsumer.java      |  3 +-
 .../consumer/internals/ConsumerNetworkClient.java  |  2 +-
 .../kafka/clients/producer/KafkaProducer.java      | 83 +++++++++++++++++++---
 .../kafka/clients/producer/ProducerConfig.java     | 39 +++++++++-
 .../clients/producer/internals/BufferPool.java     | 20 ++----
 .../producer/internals/RecordAccumulator.java      | 57 ++++++++++++---
 .../clients/producer/internals/RecordBatch.java    | 38 +++++++++-
 .../kafka/clients/producer/internals/Sender.java   | 20 ++++--
 .../apache/kafka/common/network/Selectable.java    |  5 --
 .../org/apache/kafka/common/network/Selector.java  | 11 ---
 .../java/org/apache/kafka/clients/MockClient.java  |  3 +-
 .../apache/kafka/clients/NetworkClientTest.java    | 48 +++++++------
 .../clients/producer/internals/BufferPoolTest.java | 57 ++++++++-------
 .../producer/internals/RecordAccumulatorTest.java  | 67 +++++++++++------
 .../clients/producer/internals/SenderTest.java     | 21 +++---
 .../kafka/common/network/SSLSelectorTest.java      | 19 -----
 .../apache/kafka/common/network/SelectorTest.java  | 17 -----
 .../java/org/apache/kafka/test/MockSelector.java   |  6 +-
 .../controller/ControllerChannelManager.scala      |  3 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  5 ++
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  3 +-
 .../scala/kafka/tools/ProducerPerformance.scala    |  2 -
 .../kafka/utils/NetworkClientBlockingOps.scala     |  2 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    | 46 +-----------
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  1 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  1 -
 33 files changed, 457 insertions(+), 251 deletions(-)
b658e25207174578c26ea94a75e5b0ea10f06ba5

 clients/src/main/java/org/apache/kafka/common/network/Selector.java | 2 --
 1 file changed, 2 deletions(-)
7199c87c32b94daec612bc022607bb86103bd8b2

 tests/README.md                       | 44 ++++------------
 tests/bootstrap-test-env.sh           | 94 +++++++++++++++++++++++++++++++++++
 vagrant/package-base-box.sh           | 75 ++++++++++++++++++++++++++++
 vagrant/system-test-Vagrantfile.local |  1 +
 4 files changed, 181 insertions(+), 33 deletions(-)
d88b5bdfde0b6d020e687f6d59ad88d577910ae9

 clients/src/main/java/org/apache/kafka/common/network/Selector.java | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
b7d4043d8da1d296519faf321e9f0f7188d7d67a

 core/src/main/scala/kafka/tools/EndToEndLatency.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
65bf3afe86ef883136fcd6bc857724b25e750bd7

 .../org/apache/kafka/clients/NetworkClient.java    |   3 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |   6 +-
 .../apache/kafka/common/metrics/JmxReporter.java   |  26 ++
 .../org/apache/kafka/common/metrics/Metrics.java   |  65 ++++-
 .../kafka/common/metrics/MetricsReporter.java      |   6 +
 .../org/apache/kafka/common/network/Selector.java  |  43 ++-
 .../kafka/common/requests/ListOffsetRequest.java   |   3 +
 .../clients/consumer/internals/FetcherTest.java    |  10 +-
 .../kafka/common/metrics/FakeMetricsReporter.java  |   5 +-
 .../apache/kafka/common/metrics/MetricsTest.java   |  67 ++++-
 .../org/apache/kafka/test/MockMetricsReporter.java |   5 +-
 .../kafka/consumer/ConsumerFetcherThread.scala     |  90 +++++--
 .../controller/ControllerChannelManager.scala      |   6 +-
 .../scala/kafka/controller/KafkaController.scala   |  20 --
 .../scala/kafka/server/AbstractFetcherThread.scala | 212 +++++++--------
 core/src/main/scala/kafka/server/KafkaServer.scala |   3 +-
 .../scala/kafka/server/ReplicaFetcherManager.scala |   9 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 171 ++++++++++--
 .../main/scala/kafka/server/ReplicaManager.scala   |   8 +-
 .../kafka/integration/BaseTopicMetadataTest.scala  | 295 +++++++++++++++++++++
 .../integration/PlaintextTopicMetadataTest.scala   |  23 ++
 .../kafka/integration/SslTopicMetadataTest.scala   |  24 ++
 .../unit/kafka/integration/TopicMetadataTest.scala | 291 --------------------
 .../unit/kafka/server/BaseReplicaFetchTest.scala   |  84 ++++++
 .../server/HighwatermarkPersistenceTest.scala      |   8 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   8 +-
 .../kafka/server/PlaintextReplicaFetchTest.scala   |  22 ++
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  79 ------
 .../unit/kafka/server/ReplicaManagerTest.scala     |  14 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   7 +-
 .../unit/kafka/server/SslReplicaFetchTest.scala    |  24 ++
 31 files changed, 1054 insertions(+), 583 deletions(-)
6c1957d004f9b1a7d115543327cade274edc9cfd

 core/src/main/scala/kafka/tools/JmxTool.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
845514d62329be8382e6d02b8041fc858718d534

 .../apache/kafka/clients/consumer/Consumer.java    |  21 +++--
 .../clients/consumer/ConsumerCommitCallback.java   |  33 -------
 .../kafka/clients/consumer/KafkaConsumer.java      | 104 +++++++++++----------
 .../kafka/clients/consumer/MockConsumer.java       |  19 ++--
 .../clients/consumer/OffsetCommitCallback.java     |  33 +++++++
 .../clients/consumer/internals/Coordinator.java    |  67 ++++++-------
 .../kafka/clients/consumer/MockConsumerTest.java   |   2 +-
 .../consumer/internals/CoordinatorTest.java        |  77 ++++++++-------
 .../kafka/copycat/runtime/WorkerSinkTask.java      |  21 +++--
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  |   7 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |   4 +-
 .../scala/integration/kafka/api/ConsumerTest.scala |  14 +--
 .../integration/kafka/api/SSLConsumerTest.scala    |   4 +-
 13 files changed, 212 insertions(+), 194 deletions(-)
fd123965802f900fa474a8d5b1539e62d28bff73

 .../java/org/apache/kafka/clients/Metadata.java    | 70 ++++++++++++++--
 .../org/apache/kafka/clients/NetworkClient.java    |  3 +-
 .../apache/kafka/clients/consumer/Consumer.java    | 11 +++
 .../kafka/clients/consumer/KafkaConsumer.java      | 61 +++++++++++++-
 .../kafka/clients/consumer/MockConsumer.java       | 21 +++++
 .../kafka/clients/consumer/internals/Fetcher.java  | 19 +++--
 .../consumer/internals/SubscriptionState.java      | 47 +++++++++--
 .../org/apache/kafka/clients/MetadataTest.java     | 88 +++++++++++++++++++-
 .../consumer/internals/SubscriptionStateTest.java  | 69 ++++++++++++++++
 .../scala/integration/kafka/api/ConsumerTest.scala | 93 +++++++++++++++++++++-
 10 files changed, 458 insertions(+), 24 deletions(-)
b8b1bca44095df0481fc6bb0d7ea5c06686b9337

 .../kafka/clients/consumer/KafkaConsumer.java      |   2 +-
 .../scala/kafka/tools/ConsumerPerformance.scala    |  44 +++-
 tests/kafkatest/services/performance.py            | 163 -------------
 tests/kafkatest/services/performance/__init__.py   |  19 ++
 .../services/performance/consumer_performance.py   | 147 ++++++++++++
 .../services/performance/end_to_end_latency.py     |  59 +++++
 .../kafkatest/services/performance/performance.py  |  29 +++
 .../services/performance/producer_performance.py   |  76 ++++++
 .../performance/templates/tools_log4j.properties   |  26 +++
 .../services/templates/tools_log4j.properties      |   2 +-
 tests/kafkatest/tests/benchmark_test.py            | 259 ++++++++-------------
 .../kafka/clients/tools/ProducerPerformance.java   |   6 +-
 12 files changed, 494 insertions(+), 338 deletions(-)
f8902981c65ac93426c0edc65d10381d7c285ea1

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
92629756616849d62dde3d09c7ddd9bcf5f7326c

 .../main/scala/kafka/tools/EndToEndLatency.scala   | 137 +++++++++++++++------
 tests/kafkatest/services/performance.py            |   4 +-
 2 files changed, 98 insertions(+), 43 deletions(-)
f25731265ef63e5440a188b3e5553c31fb9a397b

 .../java/org/apache/kafka/clients/NetworkClient.java  |  1 +
 .../org/apache/kafka/clients/NetworkClientTest.java   | 19 +++++++++++++++++++
 2 files changed, 20 insertions(+)
4ffbfefccbbbc513e708bdacbf2ff32772b5c85f

 core/src/main/scala/kafka/network/RequestChannel.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
24da542727225c7920ad974582fdca222a38ccc2

 core/src/main/scala/kafka/network/RequestChannel.scala | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
f090e119efe7529557d90ac5957d0708d04af3ae

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9223155e9c3f55107197758afc5238fe4cebeaa9

 core/src/main/scala/kafka/server/ZookeeperLeaderElector.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
6f398d63a4b9a23e8a3dfa436b5522e505dd5b47

 core/src/main/scala/kafka/server/ZookeeperLeaderElector.scala | 4 ++++
 1 file changed, 4 insertions(+)
689d170ac32ed15af9098faa03a97609af14bf05

 .../common/network/PlaintextTransportLayer.java    |   1 -
 .../org/apache/kafka/common/protocol/Errors.java   |   3 +-
 .../kafka/common/security/auth/KafkaPrincipal.java |  69 +++++---
 .../common/security/auth/KafkaPrincipalTest.java   |  42 +++++
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   2 +-
 .../kafka/common/AuthorizationException.scala      |  24 +++
 .../src/main/scala/kafka/common/ErrorMapping.scala |  14 +-
 core/src/main/scala/kafka/security/auth/Acl.scala  | 111 ++++++++++++
 .../scala/kafka/security/auth/Authorizer.scala     |  81 +++++++++
 .../main/scala/kafka/security/auth/Operation.scala |  42 +++++
 .../scala/kafka/security/auth/PermissionType.scala |  46 +++++
 .../main/scala/kafka/security/auth/Resource.scala  |  44 +++++
 .../scala/kafka/security/auth/ResourceType.scala   |  51 ++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   | 188 +++++++++++++++++----
 core/src/main/scala/kafka/server/KafkaConfig.scala |  13 ++
 core/src/main/scala/kafka/server/KafkaServer.scala |  12 +-
 .../scala/unit/kafka/security/auth/AclTest.scala   |  44 +++++
 .../unit/kafka/security/auth/OperationTest.scala   |  39 +++++
 .../kafka/security/auth/PermissionTypeTest.scala   |  39 +++++
 .../kafka/security/auth/ResourceTypeTest.scala     |  39 +++++
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   2 +
 21 files changed, 842 insertions(+), 64 deletions(-)
fbfdc195d40e43f54aa7809cd2a8bbaa314b4a5b

 .../main/java/org/apache/kafka/common/record/MemoryRecords.java   | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
30f1a44e657adf3fffea6832acacafe925c2c72d

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d02ca36ca1cccdb6962191b97f54ce96b9d75abc

 .../java/org/apache/kafka/clients/ClientUtils.java |  23 +-
 .../kafka/clients/ClusterConnectionStates.java     |  13 +-
 .../java/org/apache/kafka/clients/KafkaClient.java |  18 +-
 .../kafka/clients/ManualMetadataUpdater.java       |  76 +++++
 .../org/apache/kafka/clients/MetadataUpdater.java  |  72 +++++
 .../org/apache/kafka/clients/NetworkClient.java    | 318 +++++++++++++-------
 .../common/errors/BrokerNotAvailableException.java |  32 ++
 .../common/errors/ControllerMovedException.java    |  32 ++
 .../kafka/common/network/ChannelBuilders.java      |  52 ++++
 .../kafka/common/network/NetworkReceive.java       |  10 -
 .../apache/kafka/common/network/Selectable.java    |  20 +-
 .../org/apache/kafka/common/network/Selector.java  |   8 +-
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   4 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   6 +-
 .../apache/kafka/common/protocol/ProtoUtils.java   |   6 +
 .../org/apache/kafka/common/protocol/Protocol.java | 111 ++++++-
 .../kafka/common/requests/AbstractRequest.java     |   6 +
 .../common/requests/ControlledShutdownRequest.java |  69 +++++
 .../requests/ControlledShutdownResponse.java       |  91 ++++++
 .../kafka/common/requests/LeaderAndIsrRequest.java | 212 +++++++++++++
 .../common/requests/LeaderAndIsrResponse.java      | 105 +++++++
 .../common/requests/UpdateMetadataRequest.java     | 291 ++++++++++++++++++
 .../common/requests/UpdateMetadataResponse.java    |  59 ++++
 .../java/org/apache/kafka/clients/MockClient.java  |  10 +
 .../apache/kafka/clients/NetworkClientTest.java    |  23 +-
 .../kafka/common/requests/RequestResponseTest.java | 119 +++++++-
 .../java/org/apache/kafka/test/MockSelector.java   |   4 +
 .../kafka/api/ControlledShutdownRequest.scala      |  19 +-
 .../controller/ControllerChannelManager.scala      | 327 +++++++++++++--------
 .../scala/kafka/controller/KafkaController.scala   |  46 ++-
 .../kafka/controller/PartitionStateMachine.scala   |   4 +-
 .../kafka/controller/ReplicaStateMachine.scala     |   2 +-
 .../kafka/controller/TopicDeletionManager.scala    |  20 +-
 .../main/scala/kafka/network/BlockingChannel.scala |  10 +-
 .../main/scala/kafka/network/SocketServer.scala    |  13 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 184 ++++++++++--
 .../kafka/utils/NetworkClientBlockingOps.scala     | 142 +++++++++
 .../kafka/controller/ControllerFailoverTest.scala  |  18 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  38 ++-
 39 files changed, 2229 insertions(+), 384 deletions(-)
d0adf6abec7a61004d9fe35fc9999a40a953ea7b

 tests/README.md | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
17f85fcdef162c6d772db389350d3f334cbaa545

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ff189fa05ccdacac100f3d15d167dcbe561f57a6

 .../clients/consumer/ConsumerRebalanceListener.java  |  2 +-
 .../apache/kafka/clients/consumer/KafkaConsumer.java | 20 ++++++++++----------
 .../org/apache/kafka/common/config/ConfigDef.java    |  6 +++---
 .../kafka/common/errors/CorruptRecordException.java  |  4 ++--
 .../org/apache/kafka/copycat/data/CopycatSchema.java |  4 ++--
 .../kafka/controller/PartitionStateMachine.scala     |  2 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala      |  2 +-
 .../main/scala/kafka/server/ClientQuotaManager.scala |  2 +-
 8 files changed, 21 insertions(+), 21 deletions(-)
e582447adb4708731aff74aa294e7ce2b30b0a41

 .../main/scala/kafka/consumer/FetchRequestAndResponseStats.scala | 1 +
 core/src/main/scala/kafka/consumer/SimpleConsumer.scala          | 3 +++
 core/src/main/scala/kafka/metrics/KafkaMetricsGroup.scala        | 4 +++-
 core/src/main/scala/kafka/producer/ProducerRequestStats.scala    | 1 +
 core/src/main/scala/kafka/producer/SyncProducer.scala            | 9 +++++++--
 core/src/main/scala/kafka/server/KafkaServer.scala               | 2 +-
 6 files changed, 16 insertions(+), 4 deletions(-)
13c432f7952de27e9bf8cb4adb33a91ae3a4b738

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java  | 15 +++------------
 1 file changed, 3 insertions(+), 12 deletions(-)
8354959969c3fe2094b66c44c1c54c3949605e13

 core/src/main/scala/kafka/tools/ProducerPerformance.scala | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)
3803e5cb37cb602ff9eab5562ff8db3a2dd79b45

 .../apache/kafka/common/config/AbstractConfig.java |  15 ++
 .../kafka/common/config/AbstractConfigTest.java    |  13 +
 config/copycat-standalone.properties               |  17 +-
 .../apache/kafka/copycat/data/CopycatSchema.java   |  92 +++++--
 .../java/org/apache/kafka/copycat/data/Schema.java |   1 -
 .../apache/kafka/copycat/data/SchemaBuilder.java   |   3 +-
 .../apache/kafka/copycat/source/SourceRecord.java  |  41 +--
 .../apache/kafka/copycat/storage/Converter.java    |  23 +-
 .../kafka/copycat/storage/OffsetStorageReader.java |  13 +-
 .../kafka/copycat/storage/StringConverter.java     |  81 ++++++
 .../kafka/copycat/storage/StringConverterTest.java |  83 ++++++
 .../kafka/copycat/file/FileStreamSourceTask.java   |  33 ++-
 .../copycat/file/FileStreamSourceTaskTest.java     |  23 +-
 .../apache/kafka/copycat/json/JsonConverter.java   | 281 +++++++++++++++------
 .../kafka/copycat/json/JsonDeserializer.java       |  31 +--
 .../apache/kafka/copycat/json/JsonSerializer.java  |  15 --
 .../kafka/copycat/json/JsonConverterTest.java      | 243 ++++++++++++++----
 .../org/apache/kafka/copycat/cli/WorkerConfig.java |  35 +--
 .../org/apache/kafka/copycat/runtime/Worker.java   |  72 ++----
 .../kafka/copycat/runtime/WorkerSinkTask.java      |  30 +--
 .../kafka/copycat/runtime/WorkerSourceTask.java    |  39 ++-
 .../copycat/storage/OffsetStorageReaderImpl.java   |  39 ++-
 .../kafka/copycat/storage/OffsetStorageWriter.java |  37 ++-
 .../apache/kafka/copycat/storage/OffsetUtils.java  |  46 ++++
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  |  26 +-
 .../copycat/runtime/WorkerSourceTaskTest.java      |  60 ++---
 .../apache/kafka/copycat/runtime/WorkerTest.java   |  18 +-
 .../copycat/storage/OffsetStorageWriterTest.java   |  42 +--
 tests/kafkatest/tests/copycat_test.py              |  33 ++-
 .../tests/templates/copycat-file-sink.properties   |   2 +-
 .../tests/templates/copycat-file-source.properties |   2 +-
 .../tests/templates/copycat-standalone.properties  |  19 +-
 32 files changed, 991 insertions(+), 517 deletions(-)
9c936b186d390f59f1d4ad8cc2995f800036a3d6

 tests/MANIFEST.in                            | 16 ++++++++++++++++
 tests/kafkatest/services/console_consumer.py |  1 -
 tests/setup.py                               |  5 +++--
 3 files changed, 19 insertions(+), 3 deletions(-)
8956004a51a67c028f8acc73e82f4d1a3e4116c7

 core/src/main/scala/kafka/server/KafkaServerStartable.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
2fa8c748537a86a8b81b43ab7df060b6e61f5085

 .../kafka/copycat/file/FileStreamSinkTask.java     |  6 +-
 .../kafka/copycat/file/FileStreamSourceTask.java   | 33 +++++---
 .../copycat/file/FileStreamSourceTaskTest.java     |  9 +-
 .../kafka/copycat/runtime/WorkerSinkTask.java      |  1 +
 .../sanity_checks/test_console_consumer.py         |  4 -
 tests/kafkatest/services/copycat.py                | 95 ++++++++++++++++++++++
 tests/kafkatest/services/kafka.py                  |  8 +-
 tests/kafkatest/tests/copycat_test.py              | 69 ++++++++++++++++
 tests/kafkatest/tests/replication_test.py          |  3 -
 .../tests/templates/copycat-file-sink.properties   | 20 +++++
 .../tests/templates/copycat-file-source.properties | 20 +++++
 .../tests/templates/copycat-standalone.properties  | 25 ++++++
 tests/setup.py                                     |  2 +-
 13 files changed, 264 insertions(+), 31 deletions(-)
492bfdfa873db649049382b9785cefef2d6d1eca

 bin/kafka-run-class.sh                             |    2 +-
 build.gradle                                       |   49 +-
 .../apache/kafka/common/config/AbstractConfig.java |    8 +
 .../apache/kafka/common/protocol/types/Struct.java |   10 +-
 .../apache/kafka/copycat/connector/Connector.java  |    4 +-
 .../kafka/copycat/connector/CopycatRecord.java     |   37 +-
 .../apache/kafka/copycat/data/CopycatSchema.java   |  235 ++
 .../java/org/apache/kafka/copycat/data/Field.java  |   77 +
 .../java/org/apache/kafka/copycat/data/Schema.java |  157 ++
 .../apache/kafka/copycat/data/SchemaAndValue.java  |   62 +
 .../apache/kafka/copycat/data/SchemaBuilder.java   |  371 +++
 .../java/org/apache/kafka/copycat/data/Struct.java |  265 +++
 .../apache/kafka/copycat/errors/DataException.java |   35 +
 .../copycat/errors/SchemaBuilderException.java     |   32 +
 .../org/apache/kafka/copycat/sink/SinkRecord.java  |    7 +-
 .../apache/kafka/copycat/sink/SinkTaskContext.java |    4 +-
 .../apache/kafka/copycat/source/SourceRecord.java  |   45 +-
 .../kafka/copycat/source/SourceTaskContext.java    |    2 +-
 .../apache/kafka/copycat/storage/Converter.java    |   13 +-
 .../kafka/copycat/storage/OffsetStorageReader.java |    7 +-
 .../connector/ConnectorReconfigurationTest.java    |    4 +-
 .../kafka/copycat/data/CopycatSchemaTest.java      |  272 +++
 .../org/apache/kafka/copycat/data/FieldTest.java   |   40 +
 .../kafka/copycat/data/SchemaBuilderTest.java      |  287 +++
 .../org/apache/kafka/copycat/data/StructTest.java  |  222 ++
 .../kafka/copycat/data/DataRuntimeException.java   |   36 -
 .../kafka/copycat/data/DataTypeException.java      |   33 -
 .../kafka/copycat/data/ObjectProperties.java       |   85 -
 .../java/org/apache/kafka/copycat/data/Schema.java | 1054 ---------
 .../apache/kafka/copycat/data/SchemaBuilder.java   | 2415 --------------------
 .../kafka/copycat/data/SchemaParseException.java   |   32 -
 .../copycat/file/FileStreamSinkConnector.java      |    4 +-
 .../kafka/copycat/file/FileStreamSinkTask.java     |    2 +-
 .../copycat/file/FileStreamSourceConnector.java    |    4 +-
 .../kafka/copycat/file/FileStreamSourceTask.java   |   43 +-
 .../copycat/file/FileStreamSinkConnectorTest.java  |    6 +-
 .../kafka/copycat/file/FileStreamSinkTaskTest.java |    7 +-
 .../file/FileStreamSourceConnectorTest.java        |    8 +-
 .../copycat/file/FileStreamSourceTaskTest.java     |   31 +-
 .../apache/kafka/copycat/json/JsonConverter.java   |  451 +++-
 .../org/apache/kafka/copycat/json/JsonSchema.java  |   79 +-
 .../apache/kafka/copycat/json/JsonSerializer.java  |    3 +
 .../kafka/copycat/json/JsonConverterTest.java      |  200 +-
 .../org/apache/kafka/copycat/cli/WorkerConfig.java |   10 -
 .../kafka/copycat/runtime/ConnectorConfig.java     |   14 -
 .../org/apache/kafka/copycat/runtime/Worker.java   |    6 +-
 .../kafka/copycat/runtime/WorkerSinkTask.java      |   15 +-
 .../copycat/runtime/WorkerSinkTaskThread.java      |   12 +-
 .../kafka/copycat/runtime/WorkerSourceTask.java    |   14 +-
 .../runtime/standalone/StandaloneHerder.java       |    6 +-
 .../copycat/storage/OffsetStorageReaderImpl.java   |   19 +-
 .../kafka/copycat/storage/OffsetStorageWriter.java |   13 +-
 .../apache/kafka/copycat/util/ConnectorTaskId.java |    4 +-
 .../apache/kafka/copycat/util/FutureCallback.java  |    6 +-
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  |   26 +-
 .../copycat/runtime/WorkerSourceTaskTest.java      |   16 +-
 .../runtime/standalone/StandaloneHerderTest.java   |    4 +-
 .../copycat/storage/OffsetStorageWriterTest.java   |   19 +-
 settings.gradle                                    |    2 +-
 59 files changed, 2844 insertions(+), 4082 deletions(-)
8c88d198a0bcd0292a6b7ec3b08ae138e41fcc6e

 .../main/scala/kafka/consumer/BaseConsumer.scala   | 15 ++++--
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 54 +++++++++++++++++-----
 .../unit/kafka/tools/ConsoleConsumerTest.scala     | 22 ++++++++-
 3 files changed, 75 insertions(+), 16 deletions(-)
35eaef7bb4ebcf6b209312db774564451b052ca9

 .../java/org/apache/kafka/clients/Metadata.java    |  19 ++-
 .../apache/kafka/clients/consumer/Consumer.java    |  20 +--
 .../kafka/clients/consumer/ConsumerConfig.java     |  12 --
 .../consumer/ConsumerRebalanceCallback.java        |  95 -----------
 .../consumer/ConsumerRebalanceListener.java        |  97 ++++++++++++
 .../kafka/clients/consumer/KafkaConsumer.java      | 175 ++++++++++-----------
 .../kafka/clients/consumer/MockConsumer.java       |  27 ++--
 .../clients/consumer/internals/Coordinator.java    |  30 ++--
 .../internals/NoOpConsumerRebalanceCallback.java   |  30 ----
 .../internals/NoOpConsumerRebalanceListener.java   |  30 ++++
 .../consumer/internals/SubscriptionState.java      | 158 ++++++++++++-------
 .../kafka/clients/consumer/KafkaConsumerTest.java  |   2 +-
 .../kafka/clients/consumer/MockConsumerTest.java   |  25 ++-
 .../consumer/internals/CoordinatorTest.java        |  47 +++---
 .../clients/consumer/internals/FetcherTest.java    |  29 ++--
 .../consumer/internals/SubscriptionStateTest.java  |  30 ++--
 .../kafka/copycat/runtime/WorkerSinkTask.java      |   6 +-
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  |   2 +-
 .../main/scala/kafka/consumer/BaseConsumer.scala   |   3 +-
 .../scala/kafka/tools/ConsumerPerformance.scala    |   2 +-
 .../integration/kafka/api/ConsumerBounceTest.scala |   4 +-
 .../scala/integration/kafka/api/ConsumerTest.scala |  83 +++++-----
 .../scala/integration/kafka/api/QuotasTest.scala   |   2 +-
 .../integration/kafka/api/SSLConsumerTest.scala    |  31 ++--
 .../kafka/consumer/PartitionAssignorTest.scala     |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  10 +-
 26 files changed, 498 insertions(+), 473 deletions(-)
03f850f671ba3035eb150fa243dca0a2aed28302

 .../org/apache/kafka/common/protocol/Protocol.java |  36 +++++--
 .../kafka/common/requests/AbstractRequest.java     |   4 +-
 .../kafka/common/requests/StopReplicaRequest.java  | 120 +++++++++++++++++++++
 .../kafka/common/requests/StopReplicaResponse.java | 101 +++++++++++++++++
 .../kafka/common/requests/RequestResponseTest.java |  18 +++-
 5 files changed, 269 insertions(+), 10 deletions(-)
8b538d62bd7ddcefd177bfed01b10b39fc971bb1

 .../kafka/common/network/PlaintextTransportLayer.java |  2 +-
 .../kafka/common/network/SSLTransportLayer.java       |  4 +++-
 .../org/apache/kafka/common/network/Selector.java     |  7 +++++--
 .../kafka/common/security/auth/KafkaPrincipal.java    |  1 +
 .../src/main/scala/kafka/network/RequestChannel.scala | 16 ++++++++++------
 core/src/main/scala/kafka/network/SocketServer.scala  |  5 ++++-
 core/src/main/scala/kafka/server/KafkaApis.scala      |  3 ++-
 .../scala/unit/kafka/network/SocketServerTest.scala   | 19 ++++++++++---------
 8 files changed, 36 insertions(+), 21 deletions(-)
436b7ddc386eb688ba0f12836710f5e4bcaa06c8

 .../kafka/clients/consumer/internals/Fetcher.java  | 13 ++++
 .../kafka/clients/producer/internals/Sender.java   | 14 ++++
 .../org/apache/kafka/common/protocol/Protocol.java | 38 ++++++++--
 .../apache/kafka/common/requests/FetchRequest.java |  2 +-
 .../kafka/common/requests/FetchResponse.java       | 78 ++++++++++++++-----
 .../kafka/common/requests/ProduceRequest.java      |  4 +-
 .../kafka/common/requests/ProduceResponse.java     | 68 ++++++++++++-----
 .../clients/consumer/internals/FetcherTest.java    | 87 ++++++++++++++--------
 .../clients/producer/internals/SenderTest.java     | 35 +++++++--
 .../kafka/common/requests/RequestResponseTest.java | 37 ++++++++-
 core/src/main/scala/kafka/api/FetchRequest.scala   |  9 ++-
 core/src/main/scala/kafka/api/FetchResponse.scala  | 69 +++++++++++------
 .../src/main/scala/kafka/api/ProducerRequest.scala |  2 +-
 .../main/scala/kafka/api/ProducerResponse.scala    | 16 +++-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  2 +-
 .../scala/kafka/server/AbstractFetcherThread.scala | 16 +++-
 .../scala/kafka/server/ClientQuotaManager.scala    | 23 +++---
 core/src/main/scala/kafka/server/KafkaApis.scala   | 43 ++++++-----
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 -
 .../scala/kafka/server/ThrottledResponse.scala     |  8 +-
 .../api/RequestResponseSerializationTest.scala     | 40 +++++++++-
 .../unit/kafka/server/ClientQuotaManagerTest.scala |  2 +-
 .../server/ThrottledResponseExpirationTest.scala   |  8 +-
 24 files changed, 463 insertions(+), 157 deletions(-)
5d453ba6d4654efc93e6b2d2f069139afa571b94

 .../main/scala/kafka/network/SocketServer.scala    | 60 +++++++++++++---------
 1 file changed, 36 insertions(+), 24 deletions(-)
1d2ae89c5a1dc5d18b8188bf737a8e1d195be325

 .../sanity_checks/test_console_consumer.py         |  12 +-
 tests/kafkatest/sanity_checks/test_mirror_maker.py |  90 +++++++++++
 tests/kafkatest/services/console_consumer.py       |  17 ++-
 tests/kafkatest/services/kafka.py                  |   1 +
 tests/kafkatest/services/mirror_maker.py           | 165 +++++++++++++++++++++
 .../services/templates/console_consumer.properties |   4 +-
 .../templates/console_consumer_log4j.properties    |  26 ----
 .../services/templates/consumer.properties         |  23 +++
 .../kafkatest/services/templates/kafka.properties  |  80 ----------
 .../services/templates/producer.properties         |  28 ++++
 .../services/templates/tools_log4j.properties      |  26 ++++
 tests/kafkatest/services/verifiable_producer.py    |   4 +
 tests/kafkatest/services/zookeeper.py              |  16 ++
 tests/kafkatest/tests/replication_test.py          |   8 +-
 tests/setup.py                                     |   2 +-
 15 files changed, 379 insertions(+), 123 deletions(-)
6acd37720df402a665094ba1153ae200ad5d6705

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3285a9c890c1800b15c85a80e676cf4365cbe785

 build.gradle      | 2 +-
 gradle.properties | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
9a6b57334953ef86603454e5b0d1287ee4281d03

 build.gradle                                       | 44 ++++++++++
 .../kafka/clients/consumer/KafkaConsumer.java      | 10 ++-
 .../kafka/clients/producer/KafkaProducer.java      | 10 ++-
 .../apache/kafka/common/utils/AppInfoParser.java   | 97 ++++++++++++++++++++++
 core/src/main/scala/kafka/common/AppInfo.scala     | 44 ++++------
 core/src/main/scala/kafka/server/KafkaServer.scala |  4 +-
 .../scala/kafka/server/KafkaServerStartable.scala  |  1 -
 7 files changed, 174 insertions(+), 36 deletions(-)
767a8a7628bd936ee3da1f03c27639657cd0dd5e

 .../main/scala/kafka/consumer/BaseConsumer.scala   |  72 +++++
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 335 ++++++++++++---------
 .../unit/kafka/tools/ConsoleConsumerTest.scala     |  87 ++++++
 3 files changed, 350 insertions(+), 144 deletions(-)
e4fc456ab06a228c4228cbae58d391de1b768f9e

 Vagrantfile       | 6 +++---
 vagrant/README.md | 4 ++--
 2 files changed, 5 insertions(+), 5 deletions(-)
0b04f9f34b37dd43c68c572dfae6bb75144f066c

 core/src/main/scala/kafka/admin/ConfigCommand.scala          | 4 ++--
 core/src/main/scala/kafka/server/DynamicConfigManager.scala  | 6 +++---
 core/src/test/scala/unit/kafka/admin/ConfigCommandTest.scala | 8 ++++----
 3 files changed, 9 insertions(+), 9 deletions(-)
47b7a686e9636a68226efeca221073f76d887f36

 .../kafka/controller/ControllerFailoverTest.scala     | 19 ++++---------------
 .../unit/kafka/server/ClientQuotaManagerTest.scala    |  8 +++-----
 .../server/ThrottledResponseExpirationTest.scala      |  7 +++----
 3 files changed, 10 insertions(+), 24 deletions(-)
9e2c683f550b7ae58008d0bcb62238b7a2d89a65

 build.gradle                                       |   6 +-
 checkstyle/import-control.xml                      |  52 +-
 .../java/org/apache/kafka/clients/ClientUtils.java |  37 +-
 .../apache/kafka/clients/CommonClientConfigs.java  |  18 +-
 .../org/apache/kafka/clients/NetworkClient.java    |  41 +-
 .../kafka/clients/consumer/ConsumerConfig.java     |  26 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |  92 +--
 .../kafka/clients/producer/KafkaProducer.java      |   7 +-
 .../kafka/clients/producer/ProducerConfig.java     |  18 +
 .../apache/kafka/common/config/AbstractConfig.java |  10 +-
 .../org/apache/kafka/common/config/SSLConfigs.java | 102 +++
 .../apache/kafka/common/network/Authenticator.java |  62 ++
 .../kafka/common/network/ByteBufferSend.java       |  13 +-
 .../kafka/common/network/ChannelBuilder.java       |  44 ++
 .../kafka/common/network/DefaultAuthenticator.java |  63 ++
 .../apache/kafka/common/network/KafkaChannel.java  | 166 +++++
 .../kafka/common/network/NetworkReceive.java       |   5 +-
 .../common/network/PlaintextChannelBuilder.java    |  58 ++
 .../common/network/PlaintextTransportLayer.java    | 217 +++++++
 .../kafka/common/network/SSLChannelBuilder.java    |  68 ++
 .../kafka/common/network/SSLTransportLayer.java    | 690 +++++++++++++++++++++
 .../apache/kafka/common/network/Selectable.java    |  12 +-
 .../org/apache/kafka/common/network/Selector.java  | 316 +++++-----
 .../java/org/apache/kafka/common/network/Send.java |   6 +-
 .../kafka/common/network/TransportLayer.java       |  86 +++
 .../kafka/common/protocol/SecurityProtocol.java    |   2 +
 .../security/auth/DefaultPrincipalBuilder.java     |  43 ++
 .../kafka/common/security/auth/KafkaPrincipal.java |  58 ++
 .../common/security/auth/PrincipalBuilder.java     |  51 ++
 .../kafka/common/security/ssl/SSLFactory.java      | 210 +++++++
 .../java/org/apache/kafka/common/utils/Utils.java  |  53 +-
 .../org/apache/kafka/clients/ClientUtilsTest.java  |   2 +-
 .../kafka/clients/producer/KafkaProducerTest.java  |  19 +-
 .../apache/kafka/common/network/EchoServer.java    | 119 ++++
 .../kafka/common/network/SSLSelectorTest.java      | 276 +++++++++
 .../apache/kafka/common/network/SelectorTest.java  | 110 ++--
 .../kafka/common/security/ssl/SSLFactoryTest.java  |  60 ++
 .../org/apache/kafka/common/utils/UtilsTest.java   |   4 +-
 .../java/org/apache/kafka/test/MockSelector.java   |   8 +-
 .../java/org/apache/kafka/test/TestSSLUtils.java   | 243 ++++++++
 core/src/main/scala/kafka/api/FetchResponse.scala  |  24 +-
 .../main/scala/kafka/network/SocketServer.scala    | 175 +++---
 core/src/main/scala/kafka/server/KafkaConfig.scala | 218 +++++--
 core/src/main/scala/kafka/server/KafkaServer.scala | 110 ++--
 .../integration/kafka/api/ProducerSendTest.scala   |   4 +-
 .../integration/kafka/api/SSLConsumerTest.scala    | 251 ++++++++
 .../kafka/api/SSLProducerSendTest.scala            | 240 +++++++
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |   2 +-
 .../integration/UncleanLeaderElectionTest.scala    |   6 +-
 .../unit/kafka/network/SocketServerTest.scala      |  86 ++-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  42 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  89 ++-
 52 files changed, 4121 insertions(+), 599 deletions(-)
503bd36647695e8cc91893ffb80346dd03eb0bc5

 core/src/main/scala/kafka/log/LogConfig.scala      |  5 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  8 +--
 core/src/main/scala/kafka/server/KafkaServer.scala | 65 +++++++++++-----------
 .../test/scala/unit/kafka/log/LogConfigTest.scala  | 19 +++++++
 4 files changed, 58 insertions(+), 39 deletions(-)
786867c2e18f79fa17be120f78a253bb9822a861

 build.gradle | 4 ++++
 1 file changed, 4 insertions(+)
63b89658bcb5fc2d95e10d28987337c3d971163f

 .../scala/integration/kafka/api/ConsumerBounceTest.scala |  4 +++-
 .../test/scala/integration/kafka/api/ConsumerTest.scala  | 16 +++++++++++++++-
 .../test/scala/unit/kafka/admin/AddPartitionsTest.scala  |  7 ++++++-
 .../unit/kafka/consumer/PartitionAssignorTest.scala      |  3 +++
 .../kafka/consumer/ZookeeperConsumerConnectorTest.scala  |  9 +++++++--
 .../unit/kafka/controller/ControllerFailoverTest.scala   |  3 +++
 .../test/scala/unit/kafka/integration/FetcherTest.scala  |  3 ++-
 .../scala/unit/kafka/integration/MinIsrConfigTest.scala  |  2 ++
 .../scala/unit/kafka/integration/PrimitiveApiTest.scala  |  9 +++++++++
 .../scala/unit/kafka/integration/RollingBounceTest.scala |  3 ++-
 .../scala/unit/kafka/integration/TopicMetadataTest.scala | 12 ++++++++++--
 .../kafka/integration/UncleanLeaderElectionTest.scala    |  7 ++++++-
 .../consumer/ZookeeperConsumerConnectorTest.scala        |  2 ++
 .../scala/unit/kafka/server/AdvertiseBrokerTest.scala    |  5 +++--
 .../unit/kafka/server/HighwatermarkPersistenceTest.scala |  2 ++
 .../test/scala/unit/kafka/server/ISRExpirationTest.scala |  5 ++++-
 .../scala/unit/kafka/server/LeaderElectionTest.scala     |  4 +++-
 .../test/scala/unit/kafka/server/LogRecoveryTest.scala   |  6 +++++-
 .../test/scala/unit/kafka/server/ReplicaFetchTest.scala  |  3 ++-
 .../scala/unit/kafka/server/ServerShutdownTest.scala     |  1 +
 .../test/scala/unit/kafka/server/ServerStartupTest.scala |  3 +++
 .../test/scala/unit/kafka/server/SimpleFetchTest.scala   |  3 ++-
 core/src/test/scala/unit/kafka/zk/ZKEphemeralTest.scala  |  3 ++-
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala       |  9 +++++++++
 24 files changed, 106 insertions(+), 18 deletions(-)
bbb7d97adefe5826f2e02a8e55423ea215c9f749

 build.gradle                                       |   1 +
 .../org/apache/kafka/common/metrics/Quota.java     |  18 ++
 .../common/metrics/QuotaViolationException.java    |   1 -
 .../org/apache/kafka/common/metrics/Sensor.java    |  11 +-
 .../apache/kafka/common/metrics/stats/Rate.java    |  23 +-
 .../apache/kafka/common/metrics/MetricsTest.java   |  32 ++-
 .../scala/kafka/server/ClientQuotaManager.scala    | 250 +++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  88 ++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  56 ++++-
 core/src/main/scala/kafka/server/KafkaServer.scala |  24 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   4 +-
 .../scala/kafka/server/ThrottledResponse.scala     |  46 ++++
 .../scala/kafka/utils/ShutdownableThread.scala     |   3 +
 .../scala/integration/kafka/api/QuotasTest.scala   | 194 ++++++++++++++++
 .../unit/kafka/server/ClientQuotaManagerTest.scala | 159 +++++++++++++
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   6 +
 .../server/ThrottledResponseExpirationTest.scala   |  90 ++++++++
 17 files changed, 945 insertions(+), 61 deletions(-)
f6acfb08917946f15cb8de2fee786019124af212

 bin/copycat-standalone.sh                          |   23 +
 bin/kafka-run-class.sh                             |    8 +
 build.gradle                                       |  269 ++-
 checkstyle/import-control.xml                      |   57 +
 .../java/org/apache/kafka/common/utils/Utils.java  |   15 +-
 config/copycat-console-sink.properties             |   19 +
 config/copycat-console-source.properties           |   19 +
 config/copycat-file-sink.properties                |   20 +
 config/copycat-file-source.properties              |   20 +
 config/copycat-log4j.properties                    |   23 +
 config/copycat-standalone.properties               |   28 +
 .../apache/kafka/copycat/connector/Connector.java  |  117 +
 .../kafka/copycat/connector/ConnectorContext.java  |   33 +
 .../kafka/copycat/connector/CopycatRecord.java     |  103 +
 .../org/apache/kafka/copycat/connector/Task.java   |   49 +
 .../kafka/copycat/errors/CopycatException.java     |   40 +
 .../apache/kafka/copycat/sink/SinkConnector.java   |   40 +
 .../org/apache/kafka/copycat/sink/SinkRecord.java  |   71 +
 .../org/apache/kafka/copycat/sink/SinkTask.java    |   64 +
 .../apache/kafka/copycat/sink/SinkTaskContext.java |   59 +
 .../kafka/copycat/source/SourceConnector.java      |   29 +
 .../apache/kafka/copycat/source/SourceRecord.java  |  103 +
 .../apache/kafka/copycat/source/SourceTask.java    |   62 +
 .../kafka/copycat/source/SourceTaskContext.java    |   40 +
 .../apache/kafka/copycat/storage/Converter.java    |   45 +
 .../kafka/copycat/storage/OffsetStorageReader.java |   59 +
 .../apache/kafka/copycat/util/ConnectorUtils.java  |   66 +
 .../connector/ConnectorReconfigurationTest.java    |   76 +
 .../kafka/copycat/util/ConnectorUtilsTest.java     |   67 +
 .../kafka/copycat/data/DataRuntimeException.java   |   36 +
 .../kafka/copycat/data/DataTypeException.java      |   33 +
 .../kafka/copycat/data/ObjectProperties.java       |   85 +
 .../java/org/apache/kafka/copycat/data/Schema.java | 1054 +++++++++
 .../apache/kafka/copycat/data/SchemaBuilder.java   | 2415 ++++++++++++++++++++
 .../kafka/copycat/data/SchemaParseException.java   |   32 +
 .../copycat/file/FileStreamSinkConnector.java      |   62 +
 .../kafka/copycat/file/FileStreamSinkTask.java     |   79 +
 .../copycat/file/FileStreamSourceConnector.java    |   70 +
 .../kafka/copycat/file/FileStreamSourceTask.java   |  176 ++
 .../copycat/file/FileStreamSinkConnectorTest.java  |   85 +
 .../kafka/copycat/file/FileStreamSinkTaskTest.java |   67 +
 .../file/FileStreamSourceConnectorTest.java        |  104 +
 .../copycat/file/FileStreamSourceTaskTest.java     |  140 ++
 .../apache/kafka/copycat/json/JsonConverter.java   |  265 +++
 .../kafka/copycat/json/JsonDeserializer.java       |   87 +
 .../org/apache/kafka/copycat/json/JsonSchema.java  |  114 +
 .../apache/kafka/copycat/json/JsonSerializer.java  |   72 +
 .../kafka/copycat/json/JsonConverterTest.java      |  173 ++
 .../kafka/copycat/cli/CopycatStandalone.java       |   87 +
 .../org/apache/kafka/copycat/cli/WorkerConfig.java |  141 ++
 .../kafka/copycat/runtime/ConnectorConfig.java     |   87 +
 .../org/apache/kafka/copycat/runtime/Copycat.java  |   94 +
 .../org/apache/kafka/copycat/runtime/Herder.java   |   67 +
 .../kafka/copycat/runtime/SinkTaskContextImpl.java |   24 +
 .../copycat/runtime/SourceTaskOffsetCommitter.java |  103 +
 .../org/apache/kafka/copycat/runtime/Worker.java   |  236 ++
 .../kafka/copycat/runtime/WorkerSinkTask.java      |  226 ++
 .../copycat/runtime/WorkerSinkTaskThread.java      |  112 +
 .../kafka/copycat/runtime/WorkerSourceTask.java    |  310 +++
 .../apache/kafka/copycat/runtime/WorkerTask.java   |   54 +
 .../standalone/StandaloneConnectorContext.java     |   42 +
 .../runtime/standalone/StandaloneHerder.java       |  257 +++
 .../copycat/storage/FileOffsetBackingStore.java    |  111 +
 .../copycat/storage/MemoryOffsetBackingStore.java  |  113 +
 .../kafka/copycat/storage/OffsetBackingStore.java  |   74 +
 .../copycat/storage/OffsetStorageReaderImpl.java   |  114 +
 .../kafka/copycat/storage/OffsetStorageWriter.java |  208 ++
 .../org/apache/kafka/copycat/util/Callback.java    |   31 +
 .../apache/kafka/copycat/util/ConnectorTaskId.java |   71 +
 .../apache/kafka/copycat/util/FutureCallback.java  |   76 +
 .../kafka/copycat/util/ShutdownableThread.java     |  145 ++
 .../kafka/copycat/runtime/WorkerSinkTaskTest.java  |  367 +++
 .../copycat/runtime/WorkerSourceTaskTest.java      |  279 +++
 .../apache/kafka/copycat/runtime/WorkerTest.java   |  179 ++
 .../runtime/standalone/StandaloneHerderTest.java   |  186 ++
 .../storage/FileOffsetBackingStoreTest.java        |  117 +
 .../copycat/storage/OffsetStorageWriterTest.java   |  242 ++
 .../org/apache/kafka/copycat/util/MockTime.java    |   49 +
 .../kafka/copycat/util/ShutdownableThreadTest.java |   72 +
 .../util/TestBackgroundThreadExceptionHandler.java |   37 +
 .../apache/kafka/copycat/util/ThreadedTest.java    |   43 +
 settings.gradle                                    |    4 +-
 82 files changed, 11116 insertions(+), 15 deletions(-)
c8e62c9818a04c01a4eb16cf30772dfbd30d3a26

 Vagrantfile | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
2c55bd8aa2666ea11ee2814b04f782eef8fa52c6

 core/src/main/scala/kafka/cluster/Partition.scala  |  2 +
 .../scala/kafka/common/TopicAndPartition.scala     |  4 --
 .../scala/kafka/controller/KafkaController.scala   | 47 +++++++++++++---------
 core/src/main/scala/kafka/server/KafkaConfig.scala |  7 ++--
 .../main/scala/kafka/server/ReplicaManager.scala   | 43 ++++++++++++--------
 .../main/scala/kafka/utils/ReplicationUtils.scala  | 23 ++++++-----
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 19 +++++----
 .../unit/kafka/integration/TopicMetadataTest.scala |  2 +-
 8 files changed, 88 insertions(+), 59 deletions(-)
e2ebae80982c45c65f709efaedd89d10e109600f

 kafka-merge-pr.py | 23 +++++++++++++++++------
 1 file changed, 17 insertions(+), 6 deletions(-)
78685dc162a867c0b8870faf5baa6a098953ddc8

 .../integration/kafka/api/ConsumerBounceTest.scala |  2 ++
 .../scala/integration/kafka/api/ConsumerTest.scala |  2 ++
 .../kafka/api/IntegrationTestHarness.scala         |  5 ++-
 .../integration/kafka/api/ProducerBounceTest.scala |  4 ++-
 .../kafka/api/ProducerCompressionTest.scala        |  3 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    | 14 ++++----
 .../integration/kafka/api/ProducerSendTest.scala   |  8 ++---
 .../test/scala/unit/kafka/KafkaConfigTest.scala    |  2 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  8 +++--
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  3 +-
 .../scala/unit/kafka/admin/ConfigCommandTest.scala |  7 +---
 .../unit/kafka/admin/DeleteConsumerGroupTest.scala |  3 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  3 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |  5 ++-
 .../test/scala/unit/kafka/api/ApiUtilsTest.scala   |  2 +-
 .../api/RequestResponseSerializationTest.scala     |  2 +-
 .../unit/kafka/cluster/BrokerEndPointTest.scala    |  3 +-
 .../test/scala/unit/kafka/common/ConfigTest.scala  |  2 +-
 .../test/scala/unit/kafka/common/TopicTest.scala   |  2 +-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  9 +++--
 .../kafka/consumer/PartitionAssignorTest.scala     |  5 ++-
 .../unit/kafka/consumer/TopicFilterTest.scala      |  2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  8 +++--
 .../ConsumerCoordinatorResponseTest.scala          |  6 ++--
 .../coordinator/ConsumerGroupMetadataTest.scala    |  2 +-
 .../coordinator/CoordinatorMetadataTest.scala      |  2 +-
 .../kafka/coordinator/PartitionAssignorTest.scala  |  2 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |  9 ++---
 .../scala/unit/kafka/integration/FetcherTest.scala | 11 +++---
 .../kafka/integration/KafkaServerTestHarness.scala | 12 ++++---
 .../unit/kafka/integration/MinIsrConfigTest.scala  |  3 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  5 ++-
 .../integration/ProducerConsumerTestHarness.scala  | 40 ++++++++++++----------
 .../unit/kafka/integration/RollingBounceTest.scala |  8 +++--
 .../unit/kafka/integration/TopicMetadataTest.scala | 10 +++---
 .../integration/UncleanLeaderElectionTest.scala    | 12 +++----
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  6 ++--
 .../javaapi/message/BaseMessageSetTestCases.scala  |  2 +-
 .../javaapi/message/ByteBufferMessageSetTest.scala |  2 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 17 ++++-----
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |  2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  4 +--
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  4 +--
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 18 +++++-----
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  8 ++---
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  2 +-
 .../scala/unit/kafka/log/OffsetIndexTest.scala     |  2 +-
 .../test/scala/unit/kafka/log/OffsetMapTest.scala  |  2 +-
 .../kafka/message/BaseMessageSetTestCases.scala    |  2 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   |  2 +-
 .../kafka/message/MessageCompressionTest.scala     |  2 +-
 .../scala/unit/kafka/message/MessageTest.scala     |  2 +-
 .../unit/kafka/message/MessageWriterTest.scala     |  2 +-
 .../scala/unit/kafka/metrics/KafkaTimerTest.scala  |  5 ++-
 .../scala/unit/kafka/metrics/MetricsTest.scala     |  9 +++--
 .../unit/kafka/network/SocketServerTest.scala      | 27 +++++++--------
 .../unit/kafka/producer/AsyncProducerTest.scala    | 15 ++------
 .../scala/unit/kafka/producer/ProducerTest.scala   | 28 +++++++--------
 .../unit/kafka/producer/SyncProducerTest.scala     |  5 ++-
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |  8 +++--
 .../unit/kafka/server/DelayedOperationTest.scala   | 15 ++++----
 .../kafka/server/DynamicConfigChangeTest.scala     |  3 +-
 .../server/HighwatermarkPersistenceTest.scala      |  3 +-
 .../unit/kafka/server/ISRExpirationTest.scala      | 12 +++----
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  4 +--
 .../unit/kafka/server/LeaderElectionTest.scala     |  8 +++--
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  5 ++-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  6 ++--
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  5 ++-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  6 ++--
 .../unit/kafka/server/ReplicaManagerTest.scala     |  5 ++-
 .../kafka/server/ServerGenerateBrokerIdTest.scala  |  8 ++---
 .../unit/kafka/server/ServerShutdownTest.scala     | 10 +++---
 .../unit/kafka/server/ServerStartupTest.scala      |  5 ++-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  | 16 ++++-----
 .../kafka/utils/ByteBoundedBlockingQueueTest.scala |  2 +-
 .../unit/kafka/utils/CommandLineUtilsTest.scala    |  2 +-
 .../unit/kafka/utils/IteratorTemplateTest.scala    |  2 +-
 .../src/test/scala/unit/kafka/utils/JsonTest.scala |  2 +-
 .../unit/kafka/utils/ReplicationUtilsTest.scala    |  7 ++--
 .../scala/unit/kafka/utils/SchedulerTest.scala     |  2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  5 ++-
 .../unit/kafka/utils/timer/TimerTaskListTest.scala |  2 +-
 .../scala/unit/kafka/utils/timer/TimerTest.scala   |  2 +-
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  4 +--
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala | 13 ++++---
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala | 13 +++----
 87 files changed, 276 insertions(+), 293 deletions(-)
04b0d870b263117e301584bfc00dd8e81486617a

 .../apache/kafka/clients/consumer/Consumer.java    |  2 +
 .../kafka/clients/consumer/KafkaConsumer.java      |  2 +
 .../common/annotation/InterfaceStability.java      | 48 ++++++++++++++++++++++
 3 files changed, 52 insertions(+)
3902dc024595baf715cdfc8fa4b66aacbeca72d1

 .../org/apache/kafka/common/requests/ProduceResponse.java    | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
a62d63007c89c0c6f7ad62fe4643f7adc7fbc661

 .../controller/ControllerChannelManager.scala      | 102 ++++++-----
 .../scala/kafka/controller/KafkaController.scala   |  52 ++++--
 .../kafka/controller/ControllerFailoverTest.scala  | 187 +++++++++++++++++++++
 3 files changed, 288 insertions(+), 53 deletions(-)
be633a713e311c90ebfafc650eb3dcfb94ce372d

 tests/kafkatest/sanity_checks/__init__.py          | 14 ++++
 .../sanity_checks/test_console_consumer.py         | 80 ++++++++++++++++++++++
 tests/kafkatest/services/console_consumer.py       | 61 ++++++++++++++---
 .../services/templates/console_consumer.properties |  2 +-
 .../templates/console_consumer_log4j.properties    | 26 +++++++
 5 files changed, 171 insertions(+), 12 deletions(-)
96534a7d502be58026feec3c2012f022bf330049

 core/src/main/scala/kafka/server/OffsetManager.scala | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)
1fdb758f286868a00cbebcc5bbcfc8195529158e

 core/src/main/scala/kafka/tools/ConsumerPerformance.scala | 15 +++++++++++----
 1 file changed, 11 insertions(+), 4 deletions(-)
1ed88f0eba860bce4be0269cdd4d38c2b57db7f7

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
68ad80f8524931222d78a8125cd012321d784337

 core/src/test/scala/unit/kafka/server/LogRecoveryTest.scala | 3 +++
 1 file changed, 3 insertions(+)
a36befd81ed97c18e3e676559617bffdbb191d65

 core/src/main/scala/kafka/serializer/Decoder.scala | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
47c99f38726dd5bd3bf2c2f8a8a999d36b53ffcf

 .../java/org/apache/kafka/common/network/Selector.java    | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)
63b820c592aba3ec6f26cc99c0c470795029b10c

 .../kafka/coordinator/ConsumerCoordinator.scala    |  2 +-
 .../scala/integration/kafka/api/ConsumerTest.scala | 60 +++++++++++++++++-----
 2 files changed, 49 insertions(+), 13 deletions(-)
f6373e4d9929d123a8474ab7673ee701f63ac593

 .../kafka/clients/consumer/internals/Fetcher.java  |   4 +-
 .../java/org/apache/kafka/clients/MockClient.java  |  49 +++++++-
 .../clients/consumer/internals/FetcherTest.java    | 133 +++++++++++++++++++--
 3 files changed, 169 insertions(+), 17 deletions(-)
006b45c7e5b94e70b3a4200f4646042f3557c48e

 .../kafka/clients/consumer/ConsumerConfig.java     | 11 ++++++++++
 .../kafka/clients/consumer/KafkaConsumer.java      |  1 +
 .../clients/consumer/internals/Coordinator.java    |  3 ++-
 .../clients/consumer/internals/Heartbeat.java      | 24 +++++++++++-----------
 .../consumer/internals/CoordinatorTest.java        |  2 ++
 .../clients/consumer/internals/HeartbeatTest.java  |  7 ++++---
 .../integration/kafka/api/ConsumerBounceTest.scala |  3 ++-
 .../scala/integration/kafka/api/ConsumerTest.scala |  3 +++
 8 files changed, 37 insertions(+), 17 deletions(-)
9b1c52d52e4e9bbbd89b125fd510bf8b247643ac

 core/src/main/scala/kafka/tools/ReplicaVerificationTool.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
907ee7b5eae9e163e7abb24f97dedbaa78bc9d8c

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4b798f0dee004ac6b96ff563a0e2df65e016c694

 .../src/main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
95c626dc04e033c4349e68d47a3bd6e21b77706c

 .../main/java/org/apache/kafka/clients/consumer/ConsumerRecords.java  | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
27d499fe66fc034669a1852ca33ee2f486e1b83c

 core/src/main/scala/kafka/server/KafkaApis.scala   |  5 +++-
 .../unit/kafka/integration/TopicMetadataTest.scala | 28 ++++++++++++++++++++++
 2 files changed, 32 insertions(+), 1 deletion(-)
85d8218ef41381c58eb16d7542e41416c82bdf4a

 .../integration/kafka/api/ProducerSendTest.scala   | 25 ++++++----------------
 1 file changed, 7 insertions(+), 18 deletions(-)
fc40016cf3cc4143f2e8486722737da3461771e6

 bin/kafka-run-class.sh | 20 +++++++++++---------
 1 file changed, 11 insertions(+), 9 deletions(-)
9cefb2a0fb7852d35cfe0f051bc6eadb8e9c4c80

 .../apache/kafka/common/config/AbstractConfig.java |  23 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |   2 +-
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  22 --
 .../kafka/server/KafkaConfigConfigDefTest.scala    | 403 ---------------------
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 154 +++++++-
 5 files changed, 175 insertions(+), 429 deletions(-)
7a666f7aa8b1be927579817187e0b5b93543b5e2

 core/src/main/scala/kafka/controller/KafkaController.scala | 2 +-
 core/src/main/scala/kafka/server/KafkaHealthcheck.scala    | 1 -
 2 files changed, 1 insertion(+), 2 deletions(-)
a56a79055dfba4687f476b0a4d20aeec1c4ebff7

 bin/kafka-configs.sh                               |  17 ++
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  77 +++++----
 .../src/main/scala/kafka/admin/ConfigCommand.scala | 174 ++++++++++++++++++++
 core/src/main/scala/kafka/admin/TopicCommand.scala |  39 +----
 core/src/main/scala/kafka/cluster/Partition.scala  |   5 +-
 .../scala/kafka/controller/KafkaController.scala   |   7 +-
 .../kafka/controller/PartitionLeaderSelector.scala |   6 +-
 .../kafka/controller/TopicDeletionManager.scala    |   5 +-
 .../main/scala/kafka/server/ConfigHandler.scala    |  69 ++++++++
 .../scala/kafka/server/DynamicConfigManager.scala  | 183 +++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaServer.scala |  15 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 .../scala/kafka/server/TopicConfigManager.scala    | 152 -----------------
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  33 +++-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   8 +-
 .../scala/unit/kafka/admin/ConfigCommandTest.scala |  73 ++++++++
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |  13 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |  83 +++++++++-
 18 files changed, 718 insertions(+), 245 deletions(-)
1a0179f21a3937065fea2b745de67967bcafcb68

 kafka-merge-pr.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4b400afceadcbe74e3ecbfeb7c3066fd436da192

 core/src/test/scala/integration/kafka/api/ConsumerBounceTest.scala | 5 +++++
 1 file changed, 5 insertions(+)
3c09630844f6e70793f53a9d4f0ef562fe9d91d3

 .../unit/kafka/coordinator/ConsumerCoordinatorResponseTest.scala | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
cd3dc7a5c9f3a68ad73d2ae7c975f9882f00036e

 .gitignore | 1 +
 1 file changed, 1 insertion(+)
b152c0604cdce8882028b62601916b5d2b82d6a5

 kafka-merge-pr.py | 26 ++++++++++++++------------
 1 file changed, 14 insertions(+), 12 deletions(-)
23a36eb54958485d1e84c64cc739ca268e96b181

 .../src/main/java/org/apache/kafka/common/config/AbstractConfig.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
be82a2afc9e38adc0109dc694834ca5947128877

 .../apache/kafka/clients/consumer/Consumer.java    |  10 +
 .../kafka/clients/consumer/KafkaConsumer.java      |  48 ++++-
 .../kafka/clients/consumer/MockConsumer.java       |  39 +++-
 .../clients/consumer/internals/Coordinator.java    |   8 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  45 ++--
 .../consumer/internals/SubscriptionState.java      | 238 +++++++++++++++------
 .../kafka/clients/consumer/MockConsumerTest.java   |   2 +-
 .../clients/consumer/internals/FetcherTest.java    |  36 +++-
 .../consumer/internals/SubscriptionStateTest.java  |  58 +++--
 .../scala/integration/kafka/api/ConsumerTest.scala |  32 ++-
 10 files changed, 386 insertions(+), 130 deletions(-)
1162cc1dd30e896e8c7a03f960b7d7bcbf883624

 .../main/java/org/apache/kafka/clients/consumer/ConsumerRecord.java  | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
b7bd2978dc3947297fefc06ff9b22949d5bd1b50

 .../main/java/org/apache/kafka/common/protocol/Errors.java  | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)
e43c9aff92c57da6abb0c1d0af3431a550110a89

 .gitignore                                         |   5 +
 Vagrantfile                                        |  39 ++-
 bin/kafka-run-class.sh                             |  10 +
 bin/kafka-verifiable-producer.sh                   |  20 ++
 build.gradle                                       |  60 +++-
 checkstyle/import-control.xml                      |   2 +
 .../kafka/clients/tools/ProducerPerformance.java   | 219 ---------------
 .../main/scala/kafka/tools/EndToEndLatency.scala   |  92 ++++++
 .../scala/kafka/tools/ProducerPerformance.scala    |   4 +-
 .../scala/kafka/tools/TestEndToEndLatency.scala    |  91 ------
 settings.gradle                                    |   3 +-
 tests/.gitignore                                   |  11 +
 tests/README.md                                    | 150 ++++++++++
 tests/kafkatest/__init__.py                        |  16 ++
 tests/kafkatest/services/__init__.py               |  15 +
 tests/kafkatest/services/console_consumer.py       | 146 ++++++++++
 tests/kafkatest/services/kafka.py                  | 227 +++++++++++++++
 tests/kafkatest/services/performance.py            | 163 +++++++++++
 .../services/templates/console_consumer.properties |  19 ++
 .../kafkatest/services/templates/kafka.properties  | 121 ++++++++
 .../services/templates/zookeeper.properties        |  25 ++
 tests/kafkatest/services/verifiable_producer.py    | 107 +++++++
 tests/kafkatest/services/zookeeper.py              |  64 +++++
 tests/kafkatest/tests/__init__.py                  |  15 +
 tests/kafkatest/tests/benchmark_test.py            | 274 ++++++++++++++++++
 tests/kafkatest/tests/kafka_test.py                |  45 +++
 tests/kafkatest/tests/replication_test.py          | 165 +++++++++++
 tests/setup.py                                     |  27 ++
 .../kafka/clients/tools/ProducerPerformance.java   | 201 ++++++++++++++
 .../kafka/clients/tools/ThroughputThrottler.java   | 118 ++++++++
 .../kafka/clients/tools/VerifiableProducer.java    | 307 +++++++++++++++++++++
 vagrant/aws/aws-access-keys-commands               |  29 ++
 vagrant/aws/aws-example-Vagrantfile.local          |  28 ++
 vagrant/aws/aws-init.sh                            |  73 +++++
 vagrant/base.sh                                    |   9 +
 vagrant/system-test-Vagrantfile.local              |  22 ++
 36 files changed, 2603 insertions(+), 319 deletions(-)
f4101ab3fcf7ec65f6541b157f1894ffdc8d861d

 .../java/org/apache/kafka/clients/MetadataTest.java    | 18 +++++++++++++-----
 1 file changed, 13 insertions(+), 5 deletions(-)
594b963930c2054199ed54203415d1cb7917df27

 .../org/apache/kafka/clients/ClientRequest.java    | 29 ++++++++++++--
 .../org/apache/kafka/clients/NetworkClient.java    |  4 +-
 .../apache/kafka/clients/consumer/Consumer.java    |  5 +++
 .../kafka/clients/consumer/KafkaConsumer.java      | 16 ++++++++
 .../kafka/clients/consumer/MockConsumer.java       |  6 +++
 .../kafka/clients/consumer/internals/Fetcher.java  | 44 ++++++++++++++++++++++
 .../clients/consumer/internals/FetcherTest.java    | 13 +++++++
 .../scala/integration/kafka/api/ConsumerTest.scala | 18 +++++++++
 8 files changed, 130 insertions(+), 5 deletions(-)
3df46bf4ce9c134cc7b532be3d01f920127be706

 core/src/main/scala/kafka/javaapi/consumer/ConsumerConnector.java | 6 ++++++
 1 file changed, 6 insertions(+)
269c2407d4e6e38b3b6be00566c480121b5dc51a

 .../consumer/internals/SubscriptionState.java       |  4 +++-
 .../consumer/internals/SubscriptionStateTest.java   | 21 +++++++++++++++++++++
 .../scala/integration/kafka/api/ConsumerTest.scala  | 19 +++++++++++++++++++
 3 files changed, 43 insertions(+), 1 deletion(-)
57386de64530edcb54e9dae4566fb6d4a8b4700e

 core/src/main/scala/kafka/tools/ConsumerOffsetChecker.scala | 2 ++
 1 file changed, 2 insertions(+)
4389a11f68f4c0e028441acd0ef30951296c38ce

 CONTRIBUTING.md | 11 +++++++++++
 build.gradle    |  1 +
 2 files changed, 12 insertions(+)
fd3a3cd59539a741b6d3c830870dae1d5a5f93b5

 README.md    |  8 ++++----
 build.gradle | 19 ++++++++-----------
 2 files changed, 12 insertions(+), 15 deletions(-)
520a8135f4820ee92e63427c5dbb2d5356e6a473

 .../main/scala/kafka/network/SocketServer.scala    | 104 ++++++++++++---------
 1 file changed, 60 insertions(+), 44 deletions(-)
66c8647d85f801893b9f882a7ad49242cef683fd

 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 23 +++++++++++++++++++++-
 1 file changed, 22 insertions(+), 1 deletion(-)
18adec7ed5ad71eb73171aff0e0c82d627cfa5d5

 kafka-merge-pr.py | 24 ++++++++++++++++++++----
 1 file changed, 20 insertions(+), 4 deletions(-)
fd3b4cc41e9249ec6848cde8137691d32b2e79e5

 .../kafka/clients/consumer/internals/Fetcher.java   | 16 +++++++++++++++-
 .../clients/consumer/internals/FetcherTest.java     | 21 +++++++++++++++++++--
 .../integration/kafka/api/ConsumerBounceTest.scala  |  2 +-
 3 files changed, 35 insertions(+), 4 deletions(-)
2040890462a22614ccb836e43837f8739855b84f

 kafka-merge-pr.py | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)
1d2bd6284b06b579c901e6be8919a8a27dbe11ee

 core/src/main/scala/kafka/admin/AdminUtils.scala   | 17 +++++++--
 core/src/main/scala/kafka/admin/TopicCommand.scala |  4 ++-
 core/src/main/scala/kafka/common/Topic.scala       | 22 ++++++++++++
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 16 ++++++++-
 .../test/scala/unit/kafka/common/TopicTest.scala   | 41 ++++++++++++++++++++++
 5 files changed, 95 insertions(+), 5 deletions(-)
84636272422b6379d57d4c5ef68b156edc1c67f8

 .../TopicAlreadyMarkedForDeletionException.scala    | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)
a5b11886df8c7aad0548efd2c7c3dbc579232f03

 core/src/main/scala/kafka/admin/AdminUtils.scala | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)
15cba9f00dc606dd49e428f4ac8ccae0c0b8b37d

 README.md    |  2 +-
 build.gradle | 18 +++++++++---------
 2 files changed, 10 insertions(+), 10 deletions(-)
31f621716ebace5a05d5cbf65d7d5bf2a902ea7b

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 1 +
 1 file changed, 1 insertion(+)
5033b9613e9e9f28c8eb60a734920d90d155e6f9

 .../test/scala/unit/kafka/server/KafkaConfigConfigDefTest.scala   | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
1e0ed7a592cd80cfca727b27ba01f6faa511531f

 core/src/main/scala/kafka/api/TopicMetadata.scala       |  2 +-
 .../test/scala/unit/kafka/admin/AddPartitionsTest.scala | 17 +++++++++--------
 2 files changed, 10 insertions(+), 9 deletions(-)
8fa24a6171781bbdb2b814dcdc37520a92511f69

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala   | 15 ++++++++++++++-
 .../main/scala/kafka/server/AbstractFetcherThread.scala   |  4 +++-
 2 files changed, 17 insertions(+), 2 deletions(-)
458ebeb04bffb3237a46c12e05e270d9b26d4d40

 build.gradle | 20 +++++++++-----------
 1 file changed, 9 insertions(+), 11 deletions(-)
fa03a7c6c48550f01176402139201af75d3836a2

 .../java/org/apache/kafka/clients/consumer/ConsumerConfig.java |  3 ++-
 core/src/main/scala/kafka/consumer/ConsumerConfig.scala        | 10 ++++++++++
 2 files changed, 12 insertions(+), 1 deletion(-)
83d17e5b2403a4916d51ab69825ea657f8c802a7

 .../java/org/apache/kafka/clients/consumer/internals/Coordinator.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4fcb7acafe4c98cd2930e6d348d456a3eb7f7444

 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java     | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
99c0686be2141a0fffe1c55e279370a87ef8c1ea

 .../apache/kafka/clients/consumer/Consumer.java    |  10 +
 .../clients/consumer/ConsumerCommitCallback.java   |  33 ++
 .../consumer/ConsumerRebalanceCallback.java        |   6 +-
 .../kafka/clients/consumer/ConsumerRecords.java    |   4 +
 .../kafka/clients/consumer/KafkaConsumer.java      | 512 ++++------------
 .../kafka/clients/consumer/MockConsumer.java       |  19 +-
 .../consumer/internals/ConsumerNetworkClient.java  | 296 +++++++++
 .../clients/consumer/internals/Coordinator.java    | 660 +++++++++++++--------
 .../clients/consumer/internals/DelayedTask.java    |  24 +
 .../consumer/internals/DelayedTaskQueue.java       |  96 +++
 .../kafka/clients/consumer/internals/Fetcher.java  | 182 ++++--
 .../clients/consumer/internals/Heartbeat.java      |  27 +-
 .../internals/NoAvailableBrokersException.java     |  23 +
 .../clients/consumer/internals/RequestFuture.java  | 219 ++++---
 .../consumer/internals/RequestFutureAdapter.java   |  28 +
 .../consumer/internals/RequestFutureListener.java  |  23 +
 .../consumer/internals/SendFailedException.java    |  27 +
 .../consumer/internals/StaleMetadataException.java |  22 +
 .../consumer/internals/SubscriptionState.java      |   5 +-
 .../ConsumerCoordinatorNotAvailableException.java  |  40 ++
 .../kafka/common/errors/DisconnectException.java   |  39 ++
 .../common/errors/IllegalGenerationException.java  |  33 ++
 .../errors/NotCoordinatorForConsumerException.java |  40 ++
 .../errors/OffsetLoadInProgressException.java      |  40 ++
 .../common/errors/UnknownConsumerIdException.java  |  33 ++
 .../org/apache/kafka/common/protocol/Errors.java   |  10 +-
 .../internals/ConsumerNetworkClientTest.java       | 125 ++++
 .../consumer/internals/CoordinatorTest.java        | 479 ++++++++++-----
 .../consumer/internals/DelayedTaskQueueTest.java   |  89 +++
 .../clients/consumer/internals/FetcherTest.java    |  37 +-
 .../clients/consumer/internals/HeartbeatTest.java  |  15 +
 .../consumer/internals/RequestFutureTest.java      |  57 ++
 .../scala/integration/kafka/api/ConsumerTest.scala |  81 ++-
 33 files changed, 2350 insertions(+), 984 deletions(-)
a7e0ac3659c2b499124a866bc0b16b6b1b412376

 core/src/main/scala/kafka/admin/TopicCommand.scala | 17 +++++++++++------
 1 file changed, 11 insertions(+), 6 deletions(-)
bdbb9672f5e035fd00801037e2affe64811ec6ab

 .../scala/kafka/controller/KafkaController.scala   | 21 +++++--
 .../unit/kafka/integration/TopicMetadataTest.scala | 66 ++++++++++++++++++++--
 2 files changed, 77 insertions(+), 10 deletions(-)
69b451e28944deb162f7427105c3090f41c8797f

 .../java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)
4aba4bc1dfb74cc378ea58d7b0a9f16c96cfe757

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9ca61d17915f09b8010fa1da5ad0285b076a96e1

 .../kafka/coordinator/ConsumerCoordinator.scala    |  2 +-
 .../ConsumerCoordinatorResponseTest.scala          | 45 +++++++++++++++++++---
 2 files changed, 40 insertions(+), 7 deletions(-)
ee88dbb67f19b787e12ccef37982c9459b78c7b6

 core/src/main/scala/kafka/server/KafkaConfig.scala |   3 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  36 +-
 kafka-merge-pr.py                                  | 442 +++++++++++++++++++++
 3 files changed, 477 insertions(+), 4 deletions(-)
7df39e0394a6fd2f26e8f12768ebf7fecd56e3da

 build.gradle | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
67b6b9a45ba6f096645f4f344dfdcf1df1e50dd6

 .../main/java/org/apache/kafka/common/record/MemoryRecords.java   | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
4204f4a06bf23160ceec4aa54331db62681bff82

 build.gradle | 1 +
 1 file changed, 1 insertion(+)
23d72bccbeeeb0774b86c47e05cdcd1575a5d38a

 clients/src/main/java/org/apache/kafka/common/network/Selector.java | 1 +
 1 file changed, 1 insertion(+)
f13dd8024d5bc1c11587a3b539556ea01e2c84ca

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java     | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
826276de1eaabfebf2a414c69ebcdff17429016c

 core/src/main/scala/kafka/controller/KafkaController.scala | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)
a99f70feb23db9ac4274cad9e8cbbf9934d3d075

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java  |  4 ++++
 .../kafka/clients/producer/internals/RecordAccumulator.java    | 10 ++++++++--
 2 files changed, 12 insertions(+), 2 deletions(-)
ad485e148d7ac104abe173687ba27dccff8e4d39

 Vagrantfile       | 7 +++++--
 vagrant/broker.sh | 5 +++++
 vagrant/zk.sh     | 7 ++++++-
 3 files changed, 16 insertions(+), 3 deletions(-)
f77dc386c099da5ff0bac4d2a12b04f7f17f07d3

 .../scala/kafka/common/TopicAndPartition.scala     |  6 +-
 .../scala/kafka/controller/KafkaController.scala   | 69 ++++++++++++++++--
 .../main/scala/kafka/utils/ReplicationUtils.scala  | 16 ++++-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  1 +
 .../unit/kafka/integration/TopicMetadataTest.scala | 84 +++++++++++++++++++---
 .../unit/kafka/utils/ReplicationUtilsTest.scala    |  2 +
 6 files changed, 158 insertions(+), 20 deletions(-)
271b18d119fdc37952c36c573ba185aa672e3f96

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
2d96da05a0af7847aca5edc6d003a18be7f5216a

 build.gradle                                       |  60 ++++++--
 checkstyle/import-control.xml                      |   9 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  97 ------------
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 143 ------------------
 .../kafka/log4jappender/KafkaLog4jAppender.java    | 167 +++++++++++++++++++++
 .../log4jappender/KafkaLog4jAppenderTest.java      |  98 ++++++++++++
 .../log4jappender/MockKafkaLog4jAppender.java      |  47 ++++++
 settings.gradle                                    |   2 +-
 8 files changed, 370 insertions(+), 253 deletions(-)
fd612a2d50f1ee13009395f082357403c4277164

 .rat-excludes                                      |  26 ---
 build.gradle                                       |  27 ++-
 .../test/scala/other/kafka/TestOffsetManager.scala |  17 ++
 gradle/buildscript.gradle                          |  19 +-
 gradle/license.gradle                              |   9 -
 gradle/rat.gradle                                  | 115 ++++++++++++
 gradle/resources/rat-output-to-html.xsl            | 206 +++++++++++++++++++++
 kafka-patch-review.py                              |  17 ++
 scala.gradle                                       |  15 ++
 topics.json                                        |   4 -
 10 files changed, 409 insertions(+), 46 deletions(-)
3f8480ccfb011eb43da774737597c597f703e11b

 .../clients/consumer/internals/Coordinator.java    |  27 +++-
 .../org/apache/kafka/common/protocol/Errors.java   |   6 +-
 .../common/requests/OffsetCommitResponse.java      |   8 +-
 .../kafka/common/requests/OffsetFetchRequest.java  |   3 -
 .../kafka/common/requests/OffsetFetchResponse.java |   5 +-
 .../consumer/internals/CoordinatorTest.java        |   7 -
 core/src/main/scala/kafka/admin/TopicCommand.scala |   4 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  16 +-
 .../kafka/common/OffsetMetadataAndError.scala      |  14 +-
 core/src/main/scala/kafka/common/Topic.scala       |   4 +-
 .../kafka/coordinator/ConsumerCoordinator.scala    | 170 +++++++++++++++++++--
 .../kafka/coordinator/CoordinatorMetadata.scala    |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  69 +++++----
 core/src/main/scala/kafka/server/KafkaServer.scala |  26 +---
 .../main/scala/kafka/server/OffsetManager.scala    |  52 +++----
 .../main/scala/kafka/server/ReplicaManager.scala   |  95 +++++++-----
 .../scala/integration/kafka/api/ConsumerTest.scala |   7 +-
 .../kafka/api/IntegrationTestHarness.scala         |   9 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  |   8 +-
 .../unit/kafka/consumer/TopicFilterTest.scala      |   9 +-
 .../ConsumerCoordinatorResponseTest.scala          |   9 +-
 .../coordinator/CoordinatorMetadataTest.scala      |   2 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  10 +-
 23 files changed, 357 insertions(+), 207 deletions(-)
14e0ce0a47fb7f6ae6dab085b2ea9d5a1f644433

 .../apache/kafka/clients/consumer/KafkaConsumer.java    | 17 ++++++++++-------
 .../kafka/clients/consumer/internals/Coordinator.java   | 10 +++++-----
 .../integration/kafka/api/ConsumerBounceTest.scala      | 14 ++++++--------
 3 files changed, 21 insertions(+), 20 deletions(-)
9ff5b27bc572850863f58a3767da3c72aa2a9831

 .../clients/producer/internals/ErrorLoggingCallback.java   | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)
6d4991e312548bc81e0f6b790a370b6165a92df9

 .../src/main/java/org/apache/kafka/clients/producer/KafkaProducer.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
b6d326b0893e60b350608260fd1bd2542337cb5a

 .../apache/kafka/clients/consumer/Consumer.java    |   5 +
 .../kafka/clients/consumer/ConsumerRecords.java    |   7 +
 .../clients/consumer/ConsumerWakeupException.java  |  20 +
 .../kafka/clients/consumer/KafkaConsumer.java      | 715 ++++++++++++++++-----
 .../kafka/clients/consumer/MockConsumer.java       |   9 +-
 .../clients/consumer/OffsetResetStrategy.java      |  17 +
 .../clients/consumer/internals/Coordinator.java    | 447 ++++++-------
 .../kafka/clients/consumer/internals/Fetcher.java  | 159 ++---
 .../clients/consumer/internals/Heartbeat.java      |  10 +
 .../clients/consumer/internals/RequestFuture.java  | 209 ++++++
 .../consumer/internals/SubscriptionState.java      |  41 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  15 +
 .../kafka/clients/consumer/MockConsumerTest.java   |   2 +-
 .../consumer/internals/CoordinatorTest.java        | 148 ++++-
 .../clients/consumer/internals/FetcherTest.java    |  32 +-
 .../clients/consumer/internals/HeartbeatTest.java  |   9 +
 .../consumer/internals/SubscriptionStateTest.java  |  19 +-
 .../org/apache/kafka/common/utils/UtilsTest.java   |   8 +
 18 files changed, 1330 insertions(+), 542 deletions(-)
2270a7537f7734ec02b2391fae280624520a664d

 core/src/main/scala/kafka/cluster/Partition.scala | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
1eac3ceaf94b3e7583c7b6de2cfe13539ab06dd6

 .../kafka/coordinator/ConsumerCoordinator.scala    |   4 +-
 .../kafka/coordinator/CoordinatorMetadata.scala    |   4 +-
 .../ConsumerCoordinatorResponseTest.scala          | 293 +++++++++++++++++++++
 3 files changed, 297 insertions(+), 4 deletions(-)
dc54055d05742a4a7729a1fe1073c18e3d95cbb2

 core/src/main/scala/kafka/log/LogCleaner.scala | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)
cf28f893963c363bca43747e2f37fad3bb67d033

 core/src/main/scala/kafka/log/OffsetIndex.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
16ecf9806b286d9510103a4426bf0901d7dc8778

 core/src/main/scala/kafka/log/Log.scala          | 18 +++++++++----
 core/src/test/scala/unit/kafka/log/LogTest.scala | 33 ++++++++++++++++++++++++
 2 files changed, 46 insertions(+), 5 deletions(-)
ca758252c5a524fe6135a585282dd4bf747afef2

 core/src/main/scala/kafka/log/FileMessageSet.scala | 58 ++++++++++++++++++++--
 core/src/main/scala/kafka/log/Log.scala            | 30 +++++++++--
 core/src/main/scala/kafka/log/LogCleaner.scala     |  2 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |  6 +++
 core/src/main/scala/kafka/log/LogSegment.scala     |  4 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  5 ++
 core/src/main/scala/kafka/server/KafkaServer.scala |  1 +
 core/src/main/scala/kafka/utils/CoreUtils.scala    | 10 ----
 .../scala/unit/kafka/log/FileMessageSetTest.scala  | 55 +++++++++++++++++++-
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  1 +
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 54 +++++++++++++++++++-
 .../kafka/server/KafkaConfigConfigDefTest.scala    |  1 +
 12 files changed, 204 insertions(+), 23 deletions(-)
19c98cb8ed69d3d6da787dc04e1e88add5f6b9d7

 core/src/main/scala/kafka/log/LogManager.scala | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
1c93bb16a91788d3489d4d784c13f1f0fddb6fb7

 core/src/test/scala/unit/kafka/admin/AdminTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5c2ca30f229c7f39fca65aed6bd45c382aacda77

 .../main/scala/kafka/admin/ReassignPartitionsCommand.scala    | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)
d9c0ad6855b4871694ddf17c9d4546b021302ee8

 .../main/scala/kafka/controller/PartitionStateMachine.scala | 13 +------------
 1 file changed, 1 insertion(+), 12 deletions(-)
5c9040745466945a04ea0315de583ccdab0614ac

 .../apache/kafka/common/config/AbstractConfig.java |  12 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |   2 +-
 .../scala/kafka/controller/KafkaController.scala   |   4 +-
 .../kafka/controller/PartitionLeaderSelector.scala |   2 +-
 core/src/main/scala/kafka/log/LogConfig.scala      | 156 ++----
 core/src/main/scala/kafka/log/LogManager.scala     |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala | 573 ++++++---------------
 core/src/main/scala/kafka/server/KafkaServer.scala |  55 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 .../scala/kafka/server/TopicConfigManager.scala    |   5 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  26 -
 .../src/test/scala/other/kafka/StressTestLog.scala |  10 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   7 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   7 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  55 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   8 +-
 .../test/scala/unit/kafka/log/LogConfigTest.scala  |  19 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  17 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 121 +++--
 .../kafka/server/DynamicConfigChangeTest.scala     |  17 +-
 .../kafka/server/KafkaConfigConfigDefTest.scala    |  20 +-
 22 files changed, 444 insertions(+), 682 deletions(-)
ba86f0a25dd8675d3c840c33605494a2f637576f

 .../java/org/apache/kafka/common/requests/ConsumerMetadataRequest.java  | 2 +-
 .../src/main/java/org/apache/kafka/common/requests/FetchRequest.java    | 2 +-
 .../main/java/org/apache/kafka/common/requests/HeartbeatRequest.java    | 2 +-
 .../main/java/org/apache/kafka/common/requests/ListOffsetRequest.java   | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)
9650e12df2502f85ea665ae46a982d6fd0d2a954

 core/src/main/scala/kafka/log/LogConfig.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
478505632edc8f4b51e4ed561d1adf455256c3e4

 clients/src/main/java/org/apache/kafka/common/network/Selector.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
7009f1d6fffe3866723d1d33a28a4572053eb4e5

 .../main/java/org/apache/kafka/clients/consumer/ConsumerConfig.java | 2 +-
 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 .../org/apache/kafka/clients/consumer/internals/Coordinator.java    | 6 +++---
 .../apache/kafka/clients/consumer/internals/CoordinatorTest.java    | 2 +-
 4 files changed, 6 insertions(+), 6 deletions(-)
28ecea421794d0c9a1c4f95375ccd1a6dfd8f365

 core/src/main/scala/kafka/cluster/EndPoint.scala                | 2 +-
 core/src/test/scala/unit/kafka/cluster/BrokerEndPointTest.scala | 6 ++++++
 2 files changed, 7 insertions(+), 1 deletion(-)
395716ebf0af2520a33ef352a62c10a71239bb4f

 core/src/test/scala/unit/kafka/KafkaConfigTest.scala           |  3 +--
 core/src/test/scala/unit/kafka/common/ConfigTest.scala         |  3 +--
 core/src/test/scala/unit/kafka/common/TopicTest.scala          |  3 +--
 .../test/scala/unit/kafka/consumer/PartitionAssignorTest.scala | 10 ++++------
 .../test/scala/unit/kafka/integration/MinIsrConfigTest.scala   |  3 +--
 core/src/test/scala/unit/kafka/log/LogConfigTest.scala         |  3 +--
 .../scala/unit/kafka/server/KafkaConfigConfigDefTest.scala     |  3 +--
 .../scala/unit/kafka/utils/ByteBoundedBlockingQueueTest.scala  |  5 ++---
 .../src/test/scala/unit/kafka/utils/CommandLineUtilsTest.scala |  5 ++---
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala             |  4 +---
 10 files changed, 15 insertions(+), 27 deletions(-)
54e54f08077c9d71a5121e640b55836e6f7f2c9b

 .../kafka/common/requests/AbstractRequest.java     | 24 +++----
 .../common/requests/ConsumerMetadataRequest.java   | 14 ++++-
 .../apache/kafka/common/requests/FetchRequest.java | 18 ++++--
 .../kafka/common/requests/HeartbeatRequest.java    | 20 ++++--
 .../kafka/common/requests/JoinGroupRequest.java    | 26 ++++++--
 .../kafka/common/requests/JoinGroupResponse.java   |  4 --
 .../kafka/common/requests/ListOffsetRequest.java   | 14 ++++-
 .../kafka/common/requests/MetadataRequest.java     | 21 ++++++-
 .../kafka/common/requests/MetadataResponse.java    | 73 ++++++++++------------
 .../kafka/common/requests/OffsetCommitRequest.java | 14 ++++-
 .../kafka/common/requests/OffsetFetchRequest.java  | 20 ++++--
 .../kafka/common/requests/ProduceRequest.java      | 17 +++--
 .../kafka/common/requests/RequestResponseTest.java | 23 ++++---
 .../main/scala/kafka/network/RequestChannel.scala  |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  2 +-
 15 files changed, 192 insertions(+), 100 deletions(-)
20a31a29f7aa6ce6687a13aa0cf60b92c5ac4d1e

 .../src/main/java/org/apache/kafka/clients/Metadata.java   | 11 +++++++----
 .../apache/kafka/clients/producer/internals/Sender.java    |  2 +-
 .../test/java/org/apache/kafka/clients/MetadataTest.java   | 14 ++++++++++++++
 3 files changed, 22 insertions(+), 5 deletions(-)
719f2bddd147d4583a15ee8398bb0edccbbcc3f4

 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d31a2c2381bebc9c4b27e36fdf986183732e13eb

 .../kafka/clients/producer/MockProducer.java       | 53 +++++++++++++---------
 .../kafka/clients/producer/MockProducerTest.java   | 31 +++++++++++--
 .../java/org/apache/kafka/test/MockSerializer.java |  1 -
 3 files changed, 58 insertions(+), 27 deletions(-)
017c00caf44aaad3418cb99d3ef42c4d1b066ddd

 .../java/org/apache/kafka/common/network/Selector.java  |  2 ++
 .../org/apache/kafka/common/network/SelectorTest.java   | 17 ++++++++++++++++-
 2 files changed, 18 insertions(+), 1 deletion(-)
ab76dbd1f7f0bfdc9841baee64cfa37de1d870fb

 system_test/system_test_runner.py | 135 ++++++++++++++++++++++++++++++++++++--
 1 file changed, 131 insertions(+), 4 deletions(-)
9f80665ec6deff8525b61096034af8dc0cc9a03c

 .../main/scala/kafka/server/DelayedOperation.scala | 45 ++++++++++++++--------
 1 file changed, 29 insertions(+), 16 deletions(-)
ca6d01bc690c2182a611bb65ca46995edc9f356e

 .../apache/kafka/common/errors/UnknownTopicOrPartitionException.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
78ba492e3e70fd9db61bc82469371d04a8d6b762

 .../kafka/clients/ClusterConnectionStates.java     |  78 ++---
 .../apache/kafka/clients/CommonClientConfigs.java  |   2 +
 .../org/apache/kafka/clients/InFlightRequests.java |  18 +-
 .../java/org/apache/kafka/clients/KafkaClient.java |   8 +-
 .../org/apache/kafka/clients/NetworkClient.java    |  59 ++--
 .../kafka/clients/consumer/ConsumerConfig.java     |  11 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   3 +-
 .../clients/consumer/internals/Coordinator.java    |   4 +-
 .../kafka/clients/consumer/internals/Fetcher.java  |  10 +-
 .../kafka/clients/producer/KafkaProducer.java      |   3 +-
 .../kafka/clients/producer/ProducerConfig.java     |   6 +-
 .../kafka/clients/producer/internals/Sender.java   |   6 +-
 .../main/java/org/apache/kafka/common/Node.java    |  10 +
 .../kafka/common/network/ByteBufferReceive.java    |  10 +-
 .../kafka/common/network/ByteBufferSend.java       |  20 +-
 .../common/network/InvalidReceiveException.java    |  30 ++
 .../org/apache/kafka/common/network/MultiSend.java | 100 ++++++
 .../kafka/common/network/NetworkReceive.java       |  59 +++-
 .../apache/kafka/common/network/NetworkSend.java   |   2 +-
 .../org/apache/kafka/common/network/Receive.java   |   8 +-
 .../apache/kafka/common/network/Selectable.java    |  16 +-
 .../org/apache/kafka/common/network/Selector.java  | 230 ++++++++------
 .../java/org/apache/kafka/common/network/Send.java |  18 +-
 .../apache/kafka/common/requests/RequestSend.java  |   2 +-
 .../apache/kafka/common/requests/ResponseSend.java |  41 +++
 .../java/org/apache/kafka/clients/MockClient.java  |   6 +-
 .../apache/kafka/clients/NetworkClientTest.java    |   8 +-
 .../apache/kafka/common/network/SelectorTest.java  |  86 +++---
 .../java/org/apache/kafka/test/MockSelector.java   |  25 +-
 core/src/main/scala/kafka/Kafka.scala              |  12 +-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |   2 +-
 .../scala/kafka/api/ConsumerMetadataRequest.scala  |   7 +-
 .../kafka/api/ControlledShutdownRequest.scala      |   9 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   2 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |  73 +++--
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  12 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |  10 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |  15 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   7 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   7 +-
 core/src/main/scala/kafka/api/RequestKeys.scala    |   4 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |   4 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   8 +-
 .../scala/kafka/api/UpdateMetadataRequest.scala    |   4 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |   2 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  19 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   4 +-
 .../controller/ControllerChannelManager.scala      |  11 +-
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |   7 +-
 .../main/scala/kafka/network/BlockingChannel.scala |  21 +-
 .../kafka/network/BoundedByteBufferReceive.scala   |  90 ------
 .../kafka/network/BoundedByteBufferSend.scala      |  71 -----
 .../main/scala/kafka/network/ByteBufferSend.scala  |  40 ---
 core/src/main/scala/kafka/network/Handler.scala    |   6 +-
 .../main/scala/kafka/network/RequestChannel.scala  |  35 ++-
 .../kafka/network/RequestOrResponseSend.scala      |  57 ++++
 .../main/scala/kafka/network/SocketServer.scala    | 334 ++++++++-------------
 .../main/scala/kafka/network/Transmission.scala    | 122 --------
 .../main/scala/kafka/producer/SyncProducer.scala   |  19 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  44 +--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  56 +++-
 core/src/main/scala/kafka/server/KafkaServer.scala |  33 +-
 .../main/scala/kafka/server/MessageSetSend.scala   |  71 -----
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   2 +-
 .../test/scala/other/kafka/TestOffsetManager.scala |   6 +-
 .../test/scala/unit/kafka/KafkaConfigTest.scala    |  17 +-
 .../unit/kafka/network/SocketServerTest.scala      |  41 +--
 .../kafka/server/KafkaConfigConfigDefTest.scala    |   8 +
 68 files changed, 1075 insertions(+), 1096 deletions(-)
d22987f01d50549d855ae092b69f520d75bfeb7b

 .../clients/consumer/internals/Coordinator.java    | 91 +++++++++++++++-------
 .../kafka/clients/consumer/internals/Fetcher.java  |  7 +-
 .../kafka/common/requests/HeartbeatResponse.java   |  5 +-
 .../kafka/common/requests/JoinGroupResponse.java   |  7 +-
 .../kafka/coordinator/ConsumerCoordinator.scala    | 27 ++++---
 .../kafka/coordinator/ConsumerGroupMetadata.scala  | 18 +++--
 .../main/scala/kafka/network/RequestChannel.scala  |  9 ++-
 core/src/main/scala/kafka/server/KafkaConfig.scala | 28 +++++++
 .../integration/kafka/api/ConsumerBounceTest.scala | 10 ++-
 .../scala/integration/kafka/api/ConsumerTest.scala | 14 ++--
 .../kafka/server/KafkaConfigConfigDefTest.scala    |  5 ++
 11 files changed, 156 insertions(+), 65 deletions(-)
48edeca33b4d47f65ddf47c46b30d0ae605295b8

 .../integration/kafka/api/ConsumerBounceTest.scala   | 20 +++++++++-----------
 .../integration/kafka/api/FixedPortTestUtils.scala   | 19 ++++++++-----------
 .../integration/kafka/api/ProducerBounceTest.scala   | 19 ++++++++-----------
 3 files changed, 25 insertions(+), 33 deletions(-)
9e894aa0173b14d64a900bcf780d6b7809368384

 core/src/main/scala/kafka/utils/timer/Timer.scala  |  5 +-
 .../main/scala/kafka/utils/timer/TimerTask.scala   |  8 ++-
 .../scala/kafka/utils/timer/TimerTaskList.scala    | 65 ++++++++++++++++------
 .../main/scala/kafka/utils/timer/TimingWheel.scala |  5 +-
 4 files changed, 60 insertions(+), 23 deletions(-)
3d8494bca3074f49567f352f6eedd1ed008eeabd

 README.md         |  3 +++
 build.gradle      | 50 ++++++++++++++++++++++++++------------------------
 gradle.properties |  4 ----
 3 files changed, 29 insertions(+), 28 deletions(-)
3836c57865fe9f75f193d9dbdc236c2b81133eac

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d6c45c70fb9773043766446e88370db9709e7995

 .../kafka/clients/producer/KafkaProducer.java      | 82 ++++++++++++--------
 .../kafka/clients/producer/MockProducer.java       | 40 +++++++---
 .../apache/kafka/clients/producer/Partitioner.java | 46 +++++++++++
 .../kafka/clients/producer/ProducerConfig.java     | 14 +++-
 .../producer/internals/DefaultPartitioner.java     | 89 ++++++++++++++++++++++
 .../clients/producer/internals/Partitioner.java    | 89 ----------------------
 .../producer/internals/DefaultPartitionerTest.java | 63 +++++++++++++++
 .../producer/internals/PartitionerTest.java        | 68 -----------------
 8 files changed, 289 insertions(+), 202 deletions(-)
05e8a78145fc3db673bb46be8ba1788558c5a26d

 .../main/scala/kafka/javaapi/consumer/ConsumerConnector.java  | 11 +++++++++++
 1 file changed, 11 insertions(+)
c60f325014b911b8dec04848d598717e49b09011

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
43b92f8b1ce8140c432edf11b0c842f5fbe04120

 .../scala/kafka/admin/ConsumerGroupCommand.scala   |  2 +-
 .../PreferredReplicaLeaderElectionCommand.scala    |  2 +-
 .../kafka/admin/ReassignPartitionsCommand.scala    |  2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |  2 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  2 +-
 .../consumer/ZookeeperTopicEventWatcher.scala      |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  4 +--
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |  2 +-
 .../main/scala/kafka/tools/ExportZkOffsets.scala   |  4 +--
 .../main/scala/kafka/tools/ImportZkOffsets.scala   |  4 +--
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala |  6 ++--
 .../kafka/tools/VerifyConsumerRebalance.scala      |  4 +--
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  9 ++++--
 core/src/test/scala/other/kafka/DeleteZKPath.scala |  5 ++--
 .../test/scala/other/kafka/TestOffsetManager.scala |  4 +--
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  8 ++---
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala | 34 +++++++++-------------
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  4 +--
 21 files changed, 50 insertions(+), 56 deletions(-)
467736c7ad4a24e2eb1048b6fe4211bec02e4a05

 .../main/scala/kafka/javaapi/consumer/ConsumerConnector.java  | 11 -----------
 1 file changed, 11 deletions(-)
23ff851f30bb55e794aefd2fae5367845d9230ee

 .../main/scala/kafka/javaapi/consumer/ConsumerConnector.java  | 11 +++++++++++
 1 file changed, 11 insertions(+)
b4f2391f9e6d7b8cd29a7d79365517c19799a9e7

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 24 +++++++++++++++--------
 1 file changed, 16 insertions(+), 8 deletions(-)
bb133c63b0645c22f2d9b76393886fb506b14a93

 core/src/main/scala/kafka/log/LogCleaner.scala     | 122 +++++++++++++++------
 .../scala/kafka/message/ByteBufferMessageSet.scala |  10 +-
 .../test/scala/kafka/tools/TestLogCleaning.scala   |  36 +++---
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |  63 +++++++----
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  25 +----
 5 files changed, 158 insertions(+), 98 deletions(-)
29419581f5b28b66c7de7d5eb49b3bd6b62c9aba

 .../src/main/scala/kafka/coordinator/PartitionAssignor.scala | 12 ++++--------
 .../scala/unit/kafka/coordinator/PartitionAssignorTest.scala | 11 ++++++++---
 2 files changed, 12 insertions(+), 11 deletions(-)
0ad646620614f257a0485ef3ff69ad8b83eeaf8d

 .../kafka/coordinator/ConsumerCoordinator.scala    |  93 +++++------
 .../kafka/coordinator/ConsumerGroupMetadata.scala  | 131 ++++++++++++++++
 .../scala/kafka/coordinator/ConsumerMetadata.scala |  49 ++++++
 .../kafka/coordinator/CoordinatorMetadata.scala    |  10 +-
 .../scala/kafka/coordinator/DelayedHeartbeat.scala |   4 +-
 .../scala/kafka/coordinator/DelayedJoinGroup.scala |  39 -----
 .../scala/kafka/coordinator/DelayedRebalance.scala |   2 +-
 core/src/main/scala/kafka/coordinator/Group.scala  | 131 ----------------
 .../scala/kafka/coordinator/HeartbeatBucket.scala  |  43 ------
 .../main/scala/kafka/server/DelayedOperation.scala |  43 ++++--
 .../other/kafka/TestPurgatoryPerformance.scala     |  25 +--
 .../coordinator/ConsumerGroupMetadataTest.scala    | 172 +++++++++++++++++++++
 .../scala/unit/kafka/coordinator/GroupTest.scala   | 172 ---------------------
 13 files changed, 448 insertions(+), 466 deletions(-)
41ba26273b497e4cbcc947c742ff6831b7320152

 build.gradle                                                        | 2 +-
 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 3 +++
 core/src/main/scala/kafka/consumer/ZookeeperTopicEventWatcher.scala | 4 ++++
 core/src/main/scala/kafka/controller/KafkaController.scala          | 4 ++++
 core/src/main/scala/kafka/server/KafkaHealthcheck.scala             | 5 +++++
 5 files changed, 17 insertions(+), 1 deletion(-)
49026f11781181c38e9d5edb634be9d27245c961

 .../clients/consumer/internals/Coordinator.java    |   3 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  10 +-
 .../kafka/coordinator/ConsumerCoordinator.scala    | 527 +++++++++++----------
 .../scala/kafka/coordinator/ConsumerRegistry.scala |  52 --
 .../kafka/coordinator/CoordinatorMetadata.scala    | 225 +++++++++
 .../scala/kafka/coordinator/DelayedHeartbeat.scala |  33 +-
 .../scala/kafka/coordinator/DelayedJoinGroup.scala |  29 +-
 .../scala/kafka/coordinator/DelayedRebalance.scala |  37 +-
 core/src/main/scala/kafka/coordinator/Group.scala  | 131 +++++
 .../scala/kafka/coordinator/GroupRegistry.scala    |  79 ---
 .../scala/kafka/coordinator/HeartbeatBucket.scala  |  29 +-
 .../kafka/coordinator/PartitionAssignor.scala      | 129 +++++
 .../scala/kafka/server/DelayedOperationKey.scala   |   6 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |  18 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../main/scala/kafka/server/OffsetManager.scala    |   2 +-
 .../scala/integration/kafka/api/ConsumerTest.scala |   3 +-
 .../kafka/api/IntegrationTestHarness.scala         |   1 +
 .../coordinator/CoordinatorMetadataTest.scala      | 213 +++++++++
 .../scala/unit/kafka/coordinator/GroupTest.scala   | 172 +++++++
 .../kafka/coordinator/PartitionAssignorTest.scala  | 300 ++++++++++++
 21 files changed, 1512 insertions(+), 489 deletions(-)
33af0cba3bff87874ae6cef61900cd065edad064

 .../kafka/clients/producer/KafkaProducer.java      |  84 ++++++++++----
 .../kafka/clients/producer/MockProducer.java       |   5 +
 .../apache/kafka/clients/producer/Producer.java    |   7 ++
 .../producer/internals/RecordAccumulator.java      | 120 ++++++++++++++------
 .../kafka/clients/producer/internals/Sender.java   |  19 +++-
 .../kafka/common/errors/InterruptException.java    |   5 +
 .../kafka/common/serialization/Serializer.java     |   6 +
 .../producer/internals/RecordAccumulatorTest.java  |  26 +++++
 .../integration/kafka/api/ProducerSendTest.scala   | 124 +++++++++++++++++++--
 9 files changed, 332 insertions(+), 64 deletions(-)
2d5e0f07613fba67a0e22aaeda61789588e6a73b

 core/src/main/scala/kafka/cluster/Partition.scala  |   2 +-
 .../main/scala/kafka/server/OffsetManager.scala    | 151 +++++++++++----------
 2 files changed, 80 insertions(+), 73 deletions(-)
9b57fe448f01b1b6f844908adf05dd26e174db48

 core/src/main/scala/kafka/network/SocketServer.scala | 2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala        | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
af506192332f223393639bb390c38a13e0f2ca82

 .../main/scala/kafka/server/AbstractFetcherThread.scala   | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)
4328aa02c0fed198331d7bc6dcddf5d5065ef581

 .../java/org/apache/kafka/test/MockSerializer.java | 46 ++++++++++++++++++++++
 1 file changed, 46 insertions(+)
5a47ef8ecbdf574bb18bd9ee5397188097924558

 .../kafka/common/serialization/Deserializer.java   |  2 ++
 .../kafka/common/serialization/Serializer.java     |  2 ++
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  7 ++---
 .../kafka/clients/producer/KafkaProducerTest.java  | 30 +++++++++++++++++++---
 .../org/apache/kafka/test/MockMetricsReporter.java |  3 ++-
 5 files changed, 36 insertions(+), 8 deletions(-)
31dadf0242e2c4884035f9da1b67d2e916e33743

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 4 ++++
 1 file changed, 4 insertions(+)
944628b0f5b5a7873c2bfd3d52c445b7ab0eaff3

 dev-utils/test-patch.py | 23 ++++++++++++++++-------
 kafka-patch-review.py   | 37 +++++++++++++++++++++++++++++++------
 2 files changed, 47 insertions(+), 13 deletions(-)
e40ebcff6a7da483b5b748053b223a2012c2274c

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala | 5 +++++
 1 file changed, 5 insertions(+)
161b1aa16ef0821c15fc7283d87cd83336b28d1a

 .../org/apache/kafka/common/protocol/Protocol.java |  42 +++++-
 .../kafka/common/requests/OffsetCommitRequest.java |   7 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |   9 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |   2 +-
 .../kafka/common/OffsetMetadataAndError.scala      |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 145 ++++++++++++++-------
 .../api/RequestResponseSerializationTest.scala     |   4 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  23 ++--
 8 files changed, 161 insertions(+), 75 deletions(-)
f148d8659bca757ff889b404841b423d9e71ba41

 core/src/main/scala/kafka/tools/ConsumerPerformance.scala   | 13 +++++--------
 core/src/main/scala/kafka/tools/ProducerPerformance.scala   |  4 ++--
 .../main/scala/kafka/tools/SimpleConsumerPerformance.scala  |  6 ++++--
 3 files changed, 11 insertions(+), 12 deletions(-)
2e90f5e51f688ca2e347668ab83d2d0c2730d071

 core/src/main/scala/kafka/admin/AdminUtils.scala            | 13 +++++++++----
 core/src/main/scala/kafka/consumer/ConsumerConfig.scala     |  4 ++--
 core/src/main/scala/kafka/consumer/ConsumerIterator.scala   |  6 ++----
 .../src/main/scala/kafka/coordinator/DelayedJoinGroup.scala |  4 ++--
 core/src/main/scala/kafka/utils/CoreUtils.scala             |  4 ++--
 5 files changed, 17 insertions(+), 14 deletions(-)
22b3db47e73931a72b8519155be3e48ab5e3849d

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
97358411af15b64a4bc21c58a0e477fbe9c9b79d

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
dbfe8c0a7dfea65e9f32e6157da1c9a3ce256171

 core/src/main/scala/kafka/log/Log.scala            | 55 +++++++++---
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 99 ++++++++++++++++++++++
 2 files changed, 144 insertions(+), 10 deletions(-)
ba3e089582d46b0193a734b6d1c5ebdd41da4dcc

 core/src/main/scala/kafka/server/KafkaServer.scala |  1 +
 .../unit/kafka/integration/MinIsrConfigTest.scala  | 37 ++++++++++++++++++++++
 2 files changed, 38 insertions(+)
1000bb6226d09f627b3d89f12300800ebee071e1

 core/src/main/scala/kafka/Kafka.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
4c010fc2d392a8367f1871745ec1bb19b99f558c

 .../common/ConsumerRebalanceFailedException.scala  | 26 ++++++++++++++++++++++
 1 file changed, 26 insertions(+)
ae797467eb36d75083c87520d8ccaa759dafc7bb

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala  | 2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala                   | 5 -----
 core/src/test/scala/unit/kafka/server/KafkaConfigConfigDefTest.scala | 2 --
 system_test/mirror_maker_testsuite/config/server.properties          | 1 -
 system_test/offset_management_testsuite/config/server.properties     | 1 -
 .../testcase_7002/config/kafka_server_1.properties                   | 1 -
 .../testcase_7002/config/kafka_server_2.properties                   | 1 -
 .../testcase_7002/config/kafka_server_3.properties                   | 1 -
 .../testcase_7002/config/kafka_server_4.properties                   | 1 -
 system_test/replication_testsuite/config/server.properties           | 1 -
 10 files changed, 1 insertion(+), 15 deletions(-)
ed1a548c503f041c025e00e75d338b4fc4a51f47

 .../kafka/clients/consumer/ConsumerConfig.java     | 16 +++++-----
 .../kafka/clients/consumer/ConsumerRecords.java    |  8 ++---
 .../kafka/clients/producer/ProducerConfig.java     |  2 +-
 .../kafka/common/metrics/stats/Histogram.java      |  2 +-
 .../kafka/common/protocol/SecurityProtocol.java    |  2 +-
 .../kafka/common/config/AbstractConfigTest.java    | 12 ++++----
 .../protocol/types/ProtocolSerializationTest.java  |  4 +--
 .../src/main/java/kafka/etl/KafkaETLContext.java   |  2 +-
 .../kafka/admin/ReassignPartitionsCommand.scala    |  2 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |  2 +-
 .../kafka/api/ControlledShutdownRequest.scala      |  8 ++---
 .../kafka/api/ControlledShutdownResponse.scala     |  8 ++---
 .../scala/kafka/api/GenericRequestAndHeader.scala  |  4 +--
 .../scala/kafka/api/GenericResponseAndHeader.scala |  4 +--
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  6 ++--
 .../main/scala/kafka/api/StopReplicaResponse.scala |  8 ++---
 core/src/main/scala/kafka/api/TopicMetadata.scala  |  2 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     | 10 +++----
 core/src/main/scala/kafka/client/ClientUtils.scala |  2 +-
 core/src/main/scala/kafka/cluster/EndPoint.scala   |  2 +-
 .../common/ConsumerReblanceFailedException.scala   | 26 -----------------
 .../controller/ControllerChannelManager.scala      |  4 +--
 .../scala/kafka/controller/KafkaController.scala   |  4 +--
 .../kafka/controller/ReplicaStateMachine.scala     |  2 +-
 .../scala/kafka/coordinator/DelayedRebalance.scala |  3 +-
 core/src/main/scala/kafka/javaapi/Implicits.scala  |  5 ----
 .../javaapi/message/ByteBufferMessageSet.scala     |  6 ++--
 core/src/main/scala/kafka/log/CleanerConfig.scala  | 20 ++++++-------
 core/src/main/scala/kafka/log/LogCleaner.scala     |  4 +--
 core/src/main/scala/kafka/log/LogConfig.scala      | 34 +++++++++++-----------
 core/src/main/scala/kafka/log/OffsetIndex.scala    |  4 +--
 core/src/main/scala/kafka/log/OffsetMap.scala      |  4 +--
 core/src/main/scala/kafka/log/OffsetPosition.scala |  2 +-
 core/src/main/scala/kafka/message/MessageSet.scala |  2 +-
 .../scala/kafka/metrics/KafkaMetricsReporter.scala |  2 +-
 .../main/scala/kafka/network/SocketServer.scala    |  6 ++--
 .../main/scala/kafka/producer/KeyedMessage.scala   |  4 +--
 .../kafka/server/BrokerMetadataCheckpoint.scala    |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 .../scala/kafka/server/LogOffsetMetadata.scala     |  2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |  4 +--
 .../main/scala/kafka/tools/ConsoleProducer.scala   |  4 +--
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 11 ++++---
 .../main/scala/kafka/tools/ImportZkOffsets.scala   |  2 +-
 core/src/main/scala/kafka/tools/JmxTool.scala      |  6 ++--
 .../scala/kafka/tools/ProducerPerformance.scala    |  2 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  2 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |  8 ++---
 core/src/main/scala/kafka/utils/CoreUtils.scala    |  4 +--
 core/src/main/scala/kafka/utils/Mx4jLoader.scala   |  6 ++--
 core/src/main/scala/kafka/utils/Throttler.scala    |  4 +--
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 10 +++----
 .../integration/kafka/api/ConsumerBounceTest.scala |  6 ++--
 .../kafka/api/IntegrationTestHarness.scala         |  6 ++--
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  4 +--
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 12 ++++----
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 17 +++++------
 .../kafka/integration/KafkaServerTestHarness.scala |  4 +--
 .../unit/kafka/integration/RollingBounceTest.scala |  4 +--
 .../integration/UncleanLeaderElectionTest.scala    |  4 +--
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 16 +++++-----
 .../unit/kafka/server/LeaderElectionTest.scala     |  4 +--
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  5 ++--
 .../unit/kafka/utils/IteratorTemplateTest.scala    |  4 +--
 .../scala/unit/kafka/utils/MockScheduler.scala     |  8 ++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 +++----
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala |  8 ++---
 .../java/kafka/examples/SimpleConsumerDemo.java    |  4 +--
 70 files changed, 194 insertions(+), 233 deletions(-)
622e707554f32bf239534c6d8aff566768b85f70

 build.gradle | 2 ++
 1 file changed, 2 insertions(+)
2166104aff174e2ceb45638ca7be34f1db37e3e1

 .../producer/internals/RecordAccumulator.java      | 26 ++++++++-------
 .../producer/internals/RecordAccumulatorTest.java  | 38 ++++++++++++++++++++++
 2 files changed, 53 insertions(+), 11 deletions(-)
01e94e2b4a22eb0dd9ec4c3bbc353d054b1904b1

 .../java/org/apache/kafka/clients/ClientUtils.java |  16 ++
 .../java/org/apache/kafka/clients/KafkaClient.java |   8 +-
 .../kafka/clients/consumer/KafkaConsumer.java      | 178 +++++++++++--------
 .../kafka/clients/producer/KafkaProducer.java      | 192 ++++++++++++---------
 .../kafka/clients/producer/internals/Sender.java   |   7 +-
 .../org/apache/kafka/common/metrics/Metrics.java   |   4 +-
 .../kafka/common/serialization/Deserializer.java   |   7 +-
 .../kafka/common/serialization/Serializer.java     |   7 +-
 .../kafka/clients/consumer/KafkaConsumerTest.java  |  48 ++++++
 .../kafka/clients/producer/KafkaProducerTest.java  |  49 ++++++
 .../org/apache/kafka/test/MockMetricsReporter.java |  52 ++++++
 11 files changed, 397 insertions(+), 171 deletions(-)
6b964461af23e604a1f7f96b24194c276efebe96

 core/src/test/scala/unit/kafka/server/DelayedOperationTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ed11e177d4144a3a803b60f9040ee1bfc17b3b50

 core/src/main/scala/kafka/server/TopicConfigManager.scala | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
3139cc31f6cab26f3dfd429c36280d1567dbf61a

 core/src/main/scala/kafka/log/LogConfig.scala      | 11 ++-
 core/src/main/scala/kafka/log/LogManager.scala     |  2 +
 core/src/main/scala/kafka/server/KafkaConfig.scala | 24 ++++--
 core/src/test/scala/kafka/log/LogConfigTest.scala  | 95 ---------------------
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  2 +-
 .../test/scala/unit/kafka/log/LogConfigTest.scala  | 99 ++++++++++++++++++++++
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 53 ++++++++++++
 7 files changed, 175 insertions(+), 111 deletions(-)
761711ecaf9ce8a876defdcaf6802c1e048edc3d

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java     | 8 ++++----
 .../java/org/apache/kafka/clients/producer/ProducerConfig.java    | 2 +-
 2 files changed, 5 insertions(+), 5 deletions(-)
7c5b2405d89e279fbb2590a1c16147e488588ce6

 .../common/serialization/IntegerDeserializer.java  | 44 ++++++++++++++++++++++
 .../common/serialization/IntegerSerializer.java    | 38 +++++++++++++++++++
 2 files changed, 82 insertions(+)
5408931a2955adf8cb9d604d17dc9b5bd47b4d57

 .../common/serialization/SerializationTest.java    | 20 ++++++
 examples/README                                    |  5 +-
 .../src/main/java/kafka/examples/Consumer.java     | 15 ++--
 .../kafka/examples/KafkaConsumerProducerDemo.java  |  3 +-
 .../src/main/java/kafka/examples/Producer.java     | 83 ++++++++++++++++++----
 .../java/kafka/examples/SimpleConsumerDemo.java    |  4 +-
 6 files changed, 105 insertions(+), 25 deletions(-)
185eb9b59a9676f641af8bac8e8373ad4dfd5dc6

 core/src/main/scala/kafka/utils/ZkUtils.scala      | 50 ++++++++++++++--------
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala | 10 ++++-
 2 files changed, 41 insertions(+), 19 deletions(-)
35297a85ee4a0d9af8a3277b5ea79ed7c67496c2

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 5 +++++
 1 file changed, 5 insertions(+)
813c4230d4c25fa3f411a9b9230cd3f605f09a28

 .../main/java/org/apache/kafka/clients/consumer/ConsumerRecord.java   | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
5397d3c53e028a745f9d6dbfe8fc84c859656de0

 .../other/kafka/TestPurgatoryPerformance.scala     | 24 +++++++++++++++-------
 1 file changed, 17 insertions(+), 7 deletions(-)
bfbd3acbf71fa1b913de154f7ffa12aead28a2d2

 core/src/main/scala/kafka/consumer/PartitionAssignor.scala          | 6 ++++++
 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 4 +---
 2 files changed, 7 insertions(+), 3 deletions(-)
9e5d481c7ccb5ef82196b7093f3b916194bdd90d

 .../consumer/ZookeeperConsumerConnectorTest.scala  |  58 +++++-----
 .../scala/unit/kafka/integration/FetcherTest.scala |  19 +---
 .../integration/UncleanLeaderElectionTest.scala    |  45 +++-----
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  54 +++------
 .../scala/unit/kafka/metrics/MetricsTest.scala     |   4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 122 +++++++++++++--------
 6 files changed, 139 insertions(+), 163 deletions(-)
157fba840759e39bc1422fdca2597e2d9a77bfb2

 core/src/main/scala/kafka/server/OffsetManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
aa365639b2dd36d8feff761f09208154ce71964d

 .../org/apache/kafka/common/protocol/ApiKeys.java  | 24 ++++++++++++----------
 .../org/apache/kafka/common/protocol/Protocol.java |  4 ++++
 .../main/scala/kafka/network/RequestChannel.scala  |  6 +++---
 3 files changed, 20 insertions(+), 14 deletions(-)
fb86cf633833b1daa6ccf6f27b68836646d2bcba

 .../test/scala/unit/kafka/api/RequestResponseSerializationTest.scala    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
26673f982e7da885cdb8f615cc7868237106de64

 core/src/main/scala/kafka/utils/timer/TimingWheel.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
2490b1c4994295ba6c291b1109c5d67ebb4c244d

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
194d1fc030561fd06e39224584b58cc49e2f63e8

 core/src/main/scala/kafka/network/SocketServer.scala | 1 +
 1 file changed, 1 insertion(+)
6880f66c97f63b2d1f3750f1753ec8b6094cb8a5

 .../main/scala/kafka/server/DelayedOperation.scala | 159 ++++++++++----------
 .../main/scala/kafka/server/ReplicaManager.scala   |   1 -
 core/src/main/scala/kafka/utils/timer/Timer.scala  |  86 +++++++++++
 .../main/scala/kafka/utils/timer/TimerTask.scala   |  43 ++++++
 .../scala/kafka/utils/timer/TimerTaskList.scala    | 132 +++++++++++++++++
 .../main/scala/kafka/utils/timer/TimingWheel.scala | 160 +++++++++++++++++++++
 .../unit/kafka/server/DelayedOperationTest.scala   |  45 +++---
 .../unit/kafka/utils/timer/TimerTaskListTest.scala |  95 ++++++++++++
 .../scala/unit/kafka/utils/timer/TimerTest.scala   | 111 ++++++++++++++
 9 files changed, 723 insertions(+), 109 deletions(-)
d3aa99c54a41d45d42c8fd19b98747b4190d8433

 core/src/main/scala/kafka/producer/KafkaLog4jAppender.scala | 5 +++++
 1 file changed, 5 insertions(+)
b47f811ee14a3a7507f435266bbbce85d71f7744

 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 76 +++++++++++-----------
 1 file changed, 38 insertions(+), 38 deletions(-)
fef709d51ae3d568c6b6a9ff41a16f1969d4ffd6

 core/src/main/scala/kafka/tools/PerfConfig.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
06a26656ff103d2cdd7dc90f517278bd1df065a7

 .../scala/kafka/log/LogCleanerManager.scala.orig   | 203 ---------------------
 1 file changed, 203 deletions(-)
013cda2d79e1b82755cf948b668f4fb40b4efe62

 .../clients/consumer/internals/Coordinator.java    |  8 +++----
 .../org/apache/kafka/common/protocol/Errors.java   |  4 +---
 .../org/apache/kafka/common/record/Record.java     |  1 -
 .../consumer/internals/CoordinatorTest.java        |  2 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |  4 +---
 .../kafka/common/NoOffsetsCommittedException.scala | 27 ----------------------
 6 files changed, 6 insertions(+), 40 deletions(-)
79f7cca85e9ed6511ad50cb9412bfa5c8e5b9ddb

 .../scala/kafka/server/AbstractFetcherThread.scala | 139 +++++++++++++--------
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   2 +-
 2 files changed, 87 insertions(+), 54 deletions(-)
d9ab917dcc972aa3ef3644aeb4c96094bd9e54d8

 core/src/main/scala/kafka/cluster/Partition.scala  | 34 +++++++++++++---------
 .../main/scala/kafka/server/DelayedProduce.scala   |  4 +--
 2 files changed, 21 insertions(+), 17 deletions(-)
b1cc72510792fdf83ac2d6f302ea07c7ea397ce4

 .../main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
04fce48e1af183d5133be1044d27e0f526e94f2a

 core/src/main/scala/kafka/admin/AdminUtils.scala             |  8 ++++----
 core/src/main/scala/kafka/api/ConsumerMetadataResponse.scala |  8 ++++----
 core/src/main/scala/kafka/api/LeaderAndIsrRequest.scala      | 10 +++++-----
 core/src/main/scala/kafka/api/TopicMetadata.scala            | 12 ++++++------
 core/src/main/scala/kafka/api/TopicMetadataResponse.scala    |  6 +++---
 core/src/main/scala/kafka/api/UpdateMetadataRequest.scala    |  4 ++--
 core/src/main/scala/kafka/client/ClientUtils.scala           | 10 +++++-----
 core/src/main/scala/kafka/cluster/Broker.scala               |  6 +++---
 core/src/main/scala/kafka/cluster/BrokerEndPoint.scala       | 12 ++++++------
 .../main/scala/kafka/consumer/ConsumerFetcherManager.scala   |  6 +++---
 .../main/scala/kafka/consumer/ConsumerFetcherThread.scala    |  4 ++--
 .../main/scala/kafka/javaapi/ConsumerMetadataResponse.scala  |  4 ++--
 core/src/main/scala/kafka/javaapi/TopicMetadata.scala        |  8 ++++----
 core/src/main/scala/kafka/producer/ProducerPool.scala        |  6 +++---
 .../src/main/scala/kafka/server/AbstractFetcherManager.scala |  8 ++++----
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala |  4 ++--
 core/src/main/scala/kafka/server/MetadataCache.scala         |  8 ++++----
 core/src/main/scala/kafka/server/ReplicaFetcherManager.scala |  4 ++--
 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala  |  4 ++--
 core/src/main/scala/kafka/server/ReplicaManager.scala        |  4 ++--
 .../src/main/scala/kafka/tools/ReplicaVerificationTool.scala |  6 +++---
 core/src/main/scala/kafka/tools/SimpleConsumerShell.scala    |  6 +++---
 core/src/main/scala/kafka/utils/ZkUtils.scala                |  2 +-
 .../unit/kafka/api/RequestResponseSerializationTest.scala    |  4 ++--
 .../test/scala/unit/kafka/cluster/BrokerEndPointTest.scala   |  4 ++--
 .../scala/unit/kafka/integration/TopicMetadataTest.scala     |  4 ++--
 .../test/scala/unit/kafka/producer/AsyncProducerTest.scala   |  8 ++++----
 27 files changed, 85 insertions(+), 85 deletions(-)
75e1cc8bc497e6aaa0dd05454d6c817ed0fb5e23

 .../kafka/clients/producer/KafkaProducer.java      |  3 +-
 .../producer/internals/RecordAccumulator.java      |  7 +++--
 .../producer/internals/RecordAccumulatorTest.java  | 34 +++++++++++-----------
 .../clients/producer/internals/SenderTest.java     |  8 ++---
 4 files changed, 28 insertions(+), 24 deletions(-)
9c23d93553a33c5d85231193614d192a9945796e

 .../java/org/apache/kafka/common/utils/Utils.java  | 124 +++-
 .../org/apache/kafka/common/utils/UtilsTest.java   |  33 ++
 core/src/main/scala/kafka/Kafka.scala              |   3 +-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   |   1 +
 .../PreferredReplicaLeaderElectionCommand.scala    |   4 +-
 .../kafka/admin/ReassignPartitionsCommand.scala    |   9 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |   3 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |   4 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |  16 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |   2 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |   2 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |   2 +-
 .../scala/kafka/consumer/PartitionAssignor.scala   |   4 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |   4 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 .../controller/ControllerChannelManager.scala      |   4 +-
 .../scala/kafka/controller/KafkaController.scala   |   2 +-
 .../kafka/controller/PartitionStateMachine.scala   |   3 +-
 .../kafka/controller/ReplicaStateMachine.scala     |   2 +-
 .../kafka/controller/TopicDeletionManager.scala    |   2 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |   6 +-
 core/src/main/scala/kafka/log/Log.scala            |   6 +-
 .../main/scala/kafka/log/LogCleanerManager.scala   |   2 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |   8 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   8 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    |   8 +-
 core/src/main/scala/kafka/log/OffsetMap.scala      |   3 +-
 core/src/main/scala/kafka/message/Message.scala    |   3 +-
 .../scala/kafka/message/MessageAndMetadata.scala   |   2 +-
 .../main/scala/kafka/message/MessageWriter.scala   |   2 +-
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |   4 +-
 .../scala/kafka/metrics/KafkaMetricsConfig.scala   |   4 +-
 .../scala/kafka/metrics/KafkaMetricsReporter.scala |   6 +-
 .../kafka/network/BoundedByteBufferReceive.scala   |   4 +-
 .../main/scala/kafka/network/SocketServer.scala    |   1 +
 .../kafka/producer/ByteArrayPartitioner.scala      |   1 +
 .../scala/kafka/producer/DefaultPartitioner.scala  |   1 +
 core/src/main/scala/kafka/producer/Producer.scala  |   6 +-
 .../main/scala/kafka/producer/ProducerConfig.scala |   6 +-
 .../kafka/producer/async/DefaultEventHandler.scala |   9 +-
 .../kafka/server/AbstractFetcherManager.scala      |   5 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   2 +-
 .../kafka/server/BrokerMetadataCheckpoint.scala    |   2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  18 +-
 .../scala/kafka/server/KafkaRequestHandler.scala   |   1 +
 core/src/main/scala/kafka/server/KafkaServer.scala |  20 +-
 .../main/scala/kafka/server/MetadataCache.scala    |   2 +-
 .../main/scala/kafka/server/OffsetManager.scala    |   1 +
 .../kafka/server/ZookeeperLeaderElector.scala      |   2 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |   1 +
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   5 +-
 .../main/scala/kafka/tools/KafkaMigrationTool.java |   2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  14 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |   1 +
 .../scala/kafka/tools/StateChangeLogMerger.scala   |   4 +-
 .../scala/kafka/tools/TestEndToEndLatency.scala    |  92 ---
 .../main/scala/kafka/tools/TestLogCleaning.scala   | 311 ----------
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala |   4 +-
 core/src/main/scala/kafka/utils/CoreUtils.scala    | 347 +++++++++++
 core/src/main/scala/kafka/utils/Crc32.java         | 637 ---------------------
 .../main/scala/kafka/utils/KafkaScheduler.scala    |   4 +-
 .../main/scala/kafka/utils/Log4jController.scala   |   2 +-
 core/src/main/scala/kafka/utils/Logging.scala      |  10 +-
 core/src/main/scala/kafka/utils/Utils.scala        | 619 --------------------
 .../scala/kafka/utils/VerifiableProperties.scala   |   2 +-
 .../kafka/api/ProducerCompressionTest.scala        |   4 +-
 .../scala/kafka/tools/TestEndToEndLatency.scala    |  91 +++
 .../test/scala/kafka/tools/TestLogCleaning.scala   | 311 ++++++++++
 core/src/test/scala/other/kafka/DeleteZKPath.scala |   3 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |   2 +-
 .../scala/other/kafka/TestCrcPerformance.scala     |   3 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   4 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |   4 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   2 +-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |   2 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   4 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  12 +-
 .../unit/kafka/integration/RollingBounceTest.scala |   4 +-
 .../integration/UncleanLeaderElectionTest.scala    |   4 +-
 .../unit/kafka/log/BrokerCompressionTest.scala     |   2 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    |   5 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   6 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   4 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |   4 +-
 .../scala/unit/kafka/message/MessageTest.scala     |   3 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |   4 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |   4 +-
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |   4 +-
 .../server/HighwatermarkPersistenceTest.scala      |   4 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  10 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   4 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   2 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |   4 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   2 +-
 .../kafka/server/ServerGenerateBrokerIdTest.scala  |  14 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |  12 +-
 .../unit/kafka/server/ServerStartupTest.scala      |   6 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  14 +-
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  33 +-
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  10 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |   6 +-
 103 files changed, 1154 insertions(+), 1883 deletions(-)
53f31432a0e1da78abf31ad42297790445083072

 .../kafka/clients/producer/ProducerConfig.java     |   1 -
 .../kafka/common/protocol/SecurityProtocol.java    |  63 ++++++++++
 .../java/org/apache/kafka/common/utils/Utils.java  |   4 +-
 .../org/apache/kafka/common/utils/UtilsTest.java   |   4 +-
 config/server.properties                           |   4 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  22 ++--
 core/src/main/scala/kafka/admin/TopicCommand.scala |   6 +-
 core/src/main/scala/kafka/api/ApiVersion.scala     |  78 ++++++++++++
 .../scala/kafka/api/ConsumerMetadataResponse.scala |  12 +-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  10 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  |  20 ++-
 .../scala/kafka/api/TopicMetadataResponse.scala    |   6 +-
 .../scala/kafka/api/UpdateMetadataRequest.scala    |  41 ++++--
 core/src/main/scala/kafka/client/ClientUtils.scala |  25 ++--
 core/src/main/scala/kafka/cluster/Broker.scala     | 118 +++++++++++++----
 .../main/scala/kafka/cluster/BrokerEndPoint.scala  |  67 ++++++++++
 core/src/main/scala/kafka/cluster/EndPoint.scala   |  78 ++++++++++++
 .../BrokerEndPointNotAvailableException.scala      |  22 ++++
 .../kafka/consumer/ConsumerFetcherManager.scala    |  10 +-
 .../kafka/consumer/ConsumerFetcherThread.scala     |   4 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   3 +-
 .../controller/ControllerChannelManager.scala      |  13 +-
 .../scala/kafka/controller/KafkaController.scala   |   9 +-
 .../kafka/javaapi/ConsumerMetadataResponse.scala   |   5 +-
 .../main/scala/kafka/javaapi/TopicMetadata.scala   |   8 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   5 +-
 .../main/scala/kafka/network/SocketServer.scala    |  90 ++++++++-----
 .../main/scala/kafka/producer/ProducerPool.scala   |  18 +--
 .../kafka/server/AbstractFetcherManager.scala      |   8 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   5 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  12 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala | 105 ++++++++++++++--
 .../main/scala/kafka/server/KafkaHealthcheck.scala |  25 ++--
 core/src/main/scala/kafka/server/KafkaServer.scala | 114 +++++++++--------
 .../main/scala/kafka/server/MetadataCache.scala    |  25 ++--
 .../scala/kafka/server/ReplicaFetcherManager.scala |   4 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   4 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   2 +-
 .../kafka/tools/ReplicaVerificationTool.scala      |   6 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  18 ++-
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala |   5 +-
 core/src/main/scala/kafka/utils/Utils.scala        |   9 ++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  38 ++++--
 .../integration/kafka/api/ProducerSendTest.scala   |   2 -
 .../test/scala/other/kafka/TestOffsetManager.scala |   2 +-
 .../test/scala/unit/kafka/KafkaConfigTest.scala    |   8 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |   7 +-
 .../api/RequestResponseSerializationTest.scala     |  74 +++++++++--
 .../unit/kafka/cluster/BrokerEndPointTest.scala    | 124 ++++++++++++++++++
 .../scala/unit/kafka/integration/FetcherTest.scala |   4 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   6 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |  15 +--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   2 +-
 .../unit/kafka/network/SocketServerTest.scala      |  52 ++++++--
 .../unit/kafka/producer/AsyncProducerTest.scala    |   8 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  27 ++--
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |  15 ++-
 .../kafka/server/KafkaConfigConfigDefTest.scala    |   8 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 140 +++++++++++++++++----
 .../unit/kafka/server/LeaderElectionTest.scala     |  18 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  12 +-
 system_test/README.txt                             |  34 ++---
 .../testcase_0001/testcase_0001_properties.json    |   8 +-
 .../testcase_0002/testcase_0002_properties.json    |   8 +-
 .../testcase_0003/testcase_0003_properties.json    |   8 +-
 .../testcase_0004/testcase_0004_properties.json    |   8 +-
 .../testcase_0005/testcase_0005_properties.json    |   8 +-
 .../testcase_0006/testcase_0006_properties.json    |   8 +-
 .../testcase_0007/testcase_0007_properties.json    |   8 +-
 .../testcase_0008/testcase_0008_properties.json    |   8 +-
 .../testcase_0009/testcase_0009_properties.json    |   8 +-
 .../testcase_0101/testcase_0101_properties.json    |   8 +-
 .../testcase_0102/testcase_0102_properties.json    |   8 +-
 .../testcase_0103/testcase_0103_properties.json    |   8 +-
 .../testcase_0104/testcase_0104_properties.json    |   8 +-
 .../testcase_0105/testcase_0105_properties.json    |   8 +-
 .../testcase_0106/testcase_0106_properties.json    |   8 +-
 .../testcase_0107/testcase_0107_properties.json    |   8 +-
 .../testcase_0108/testcase_0108_properties.json    |   8 +-
 .../testcase_0109/testcase_0109_properties.json    |   8 +-
 .../testcase_1/testcase_1_properties.json          |   6 +-
 system_test/run_all.sh                             |   7 ++
 system_test/run_all_replica.sh                     |   7 ++
 system_test/run_sanity.sh                          |   3 -
 system_test/testcase_to_run.json                   |   5 -
 system_test/testcase_to_run_all_replica.json       | 123 ++++++++++++++++++
 system_test/utils/kafka_system_test_utils.py       |   1 +
 88 files changed, 1497 insertions(+), 487 deletions(-)
07598ad8a4e508e738c4af11f16b1649d90d5fdb

 core/src/main/scala/kafka/tools/ConsumerPerformance.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
9a071017ee80331dc5b776e04ee2ed77f1d751db

 core/src/main/scala/kafka/message/Message.scala | 2 +-
 core/src/main/scala/kafka/utils/Utils.scala     | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
7acfa92c09bbfeb6d28a0771c09d36c9c89fc31f

 core/src/main/scala/kafka/log/LogCleaner.scala     |  3 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 46 ++++++++++++++++++++++
 2 files changed, 48 insertions(+), 1 deletion(-)
a686a67f60beb42eb3d4942508fb15b636e5100d

 core/src/main/scala/kafka/utils/Mx4jLoader.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
70e5c92e213bff7502288c610c252735d6b68c08

 core/src/main/scala/kafka/network/SocketServer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6adaffd8ea4bc1f40bd5cf5268c30eb2df1868ab

 .../apache/kafka/common/network/SelectorTest.java  |   9 +-
 .../test/java/org/apache/kafka/test/TestUtils.java |  28 ----
 .../main/scala/kafka/network/SocketServer.scala    |  12 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   5 +-
 .../integration/kafka/api/ConsumerBounceTest.scala | 154 +++++++++++++++++++
 .../scala/integration/kafka/api/ConsumerTest.scala |  83 -----------
 .../integration/kafka/api/FixedPortTestUtils.scala |  55 +++++++
 .../kafka/api/IntegrationTestHarness.scala         |  13 +-
 .../integration/kafka/api/ProducerBounceTest.scala | 164 +++++++++++++++++++++
 .../kafka/api/ProducerCompressionTest.scala        |  14 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |  89 ++---------
 .../integration/kafka/api/ProducerSendTest.scala   |  12 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  27 +---
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  16 +-
 .../unit/kafka/admin/DeleteConsumerGroupTest.scala |   4 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |   6 +-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  29 ++--
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  47 +++---
 .../kafka/integration/AutoOffsetResetTest.scala    |   4 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  28 ++--
 .../kafka/integration/KafkaServerTestHarness.scala |  24 ++-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  12 +-
 .../integration/ProducerConsumerTestHarness.scala  |   5 +-
 .../unit/kafka/integration/RollingBounceTest.scala |  29 +---
 .../unit/kafka/integration/TopicMetadataTest.scala |   7 +-
 .../integration/UncleanLeaderElectionTest.scala    |  25 ++--
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  11 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   2 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  11 +-
 .../scala/unit/kafka/metrics/MetricsTest.scala     |   9 +-
 .../unit/kafka/network/SocketServerTest.scala      |   6 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  24 +--
 .../scala/unit/kafka/producer/ProducerTest.scala   |  55 ++++---
 .../unit/kafka/producer/SyncProducerTest.scala     |  19 ++-
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |   2 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |   3 +-
 .../server/HighwatermarkPersistenceTest.scala      |   2 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   2 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |  36 ++---
 .../unit/kafka/server/LeaderElectionTest.scala     |  13 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   9 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  36 +++--
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   5 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  11 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |   6 +-
 .../kafka/server/ServerGenerateBrokerIdTest.scala  |  19 ++-
 .../unit/kafka/server/ServerShutdownTest.scala     |  21 +--
 .../unit/kafka/server/ServerStartupTest.scala      |   6 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   2 +-
 .../unit/kafka/utils/ReplicationUtilsTest.scala    |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  51 +++----
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |   6 +-
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala |   2 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  11 +-
 54 files changed, 732 insertions(+), 551 deletions(-)
15b93a410a8e988e09dc147c6d5250cbbe328b26

 core/src/main/scala/kafka/cluster/Partition.scala  | 75 ++++++++++----------
 core/src/main/scala/kafka/cluster/Replica.scala    | 25 +++++--
 core/src/main/scala/kafka/log/Log.scala            |  2 +-
 .../main/scala/kafka/server/FetchDataInfo.scala    |  2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala | 10 +--
 .../main/scala/kafka/server/ReplicaManager.scala   | 62 +++++++++++++----
 .../unit/kafka/server/ISRExpirationTest.scala      | 79 ++++++++++++++++++----
 .../kafka/server/KafkaConfigConfigDefTest.scala    |  2 -
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  1 -
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  7 +-
 10 files changed, 177 insertions(+), 88 deletions(-)
48f997047228c327f91e8f848142b4607366fc3e

 core/src/main/scala/kafka/admin/TopicCommand.scala | 18 ++++++----
 .../scala/unit/kafka/admin/TopicCommandTest.scala  | 41 +++++++++++++++++++++-
 2 files changed, 52 insertions(+), 7 deletions(-)
ad722531daafadbcb27b0c0db0b9fcbb68b25b28

 core/src/test/scala/unit/kafka/integration/RollingBounceTest.scala | 1 -
 core/src/test/scala/unit/kafka/utils/TestUtils.scala               | 1 +
 2 files changed, 1 insertion(+), 1 deletion(-)
619d78eb521185f365a002e5f1987b75d3f35192

 .../other/kafka/TestPurgatoryPerformance.scala     | 275 +++++++++++++++++++++
 1 file changed, 275 insertions(+)
66c6f9b1c436187635674f82a9e9940d8f5331f2

 README.md                       |  2 +-
 bin/kafka-run-class.sh          |  2 +-
 bin/windows/kafka-run-class.bat |  2 +-
 build.gradle                    | 18 +++++++++---------
 gradle.properties               |  2 +-
 scala.gradle                    |  4 ++--
 6 files changed, 15 insertions(+), 15 deletions(-)
d8fe98efee5a44ae12c1e3484fa20f89b0f30054

 checkstyle/import-control.xml                      |  4 +-
 .../main/java/org/apache/kafka/common/Node.java    |  4 ++
 .../kafka/common/requests/AbstractRequest.java     | 62 ++++++++++++++++++++++
 .../common/requests/ConsumerMetadataRequest.java   |  9 +++-
 .../apache/kafka/common/requests/FetchRequest.java | 17 +++++-
 .../kafka/common/requests/FetchResponse.java       |  3 ++
 .../kafka/common/requests/HeartbeatRequest.java    |  8 ++-
 .../kafka/common/requests/JoinGroupRequest.java    |  8 ++-
 .../kafka/common/requests/ListOffsetRequest.java   | 15 +++++-
 .../kafka/common/requests/MetadataRequest.java     | 14 ++++-
 .../kafka/common/requests/MetadataResponse.java    | 19 +++++++
 .../kafka/common/requests/OffsetCommitRequest.java | 13 ++++-
 .../kafka/common/requests/OffsetFetchRequest.java  | 17 +++++-
 .../kafka/common/requests/OffsetFetchResponse.java |  3 ++
 .../kafka/common/requests/ProduceRequest.java      | 19 ++++++-
 .../kafka/common/requests/ProduceResponse.java     |  2 +
 .../kafka/common/requests/RequestResponseTest.java | 34 +++++++-----
 .../kafka/api/HeartbeatRequestAndHeader.scala      | 45 ----------------
 .../kafka/api/HeartbeatResponseAndHeader.scala     | 28 ----------
 .../kafka/api/JoinGroupRequestAndHeader.scala      | 45 ----------------
 .../kafka/api/JoinGroupResponseAndHeader.scala     | 28 ----------
 core/src/main/scala/kafka/api/RequestKeys.scala    |  4 +-
 .../kafka/network/BoundedByteBufferSend.scala      |  8 +++
 .../main/scala/kafka/network/RequestChannel.scala  | 19 ++++++-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 48 ++++++++++-------
 .../api/RequestResponseSerializationTest.scala     | 29 +---------
 26 files changed, 287 insertions(+), 218 deletions(-)
c5df2a8e3acca1e2c905fa6b78e73e09b1dd0cd7

 .../clients/consumer/internals/Coordinator.java    |   8 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  77 ++++++++-----
 .../apache/kafka/common/protocol/types/Struct.java |   6 +-
 .../kafka/common/requests/OffsetCommitRequest.java | 103 +++++++++++++----
 .../kafka/common/requests/RequestResponseTest.java |   4 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |  73 ++++++++----
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |  13 ++-
 .../kafka/common/OffsetMetadataAndError.scala      |  64 +++++++----
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  34 +++++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   1 +
 .../main/scala/kafka/server/OffsetManager.scala    |  97 +++++++++++-----
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../api/RequestResponseSerializationTest.scala     |  50 ++++++---
 .../scala/unit/kafka/server/OffsetCommitTest.scala | 122 +++++++++++++++++----
 .../unit/kafka/server/ServerShutdownTest.scala     |   4 +-
 17 files changed, 490 insertions(+), 172 deletions(-)
d2f50fc3886896bc569fea7fb308036008b89f94

 .../scala/kafka/consumer/ConsumerIterator.scala    |  2 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala | 62 +++++++++++++++-------
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 10 ++--
 .../unit/kafka/producer/SyncProducerTest.scala     |  2 +-
 6 files changed, 52 insertions(+), 28 deletions(-)
5b42b538eb46203f7fd308cb3d3f27dde98840b8

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 49 +++++++++--------------
 1 file changed, 19 insertions(+), 30 deletions(-)
a74688de46c23dd34ad964372fbed05c1f7f4b3e

 .../scala/kafka/message/ByteBufferMessageSet.scala |  65 +++----
 .../main/scala/kafka/message/MessageWriter.scala   | 206 +++++++++++++++++++++
 .../unit/kafka/message/MessageWriterTest.scala     | 130 +++++++++++++
 3 files changed, 370 insertions(+), 31 deletions(-)
eb2100876b70d1e0d53a88c2513ca3a4ac7a1c1e

 dev-utils/test-patch.py | 457 ++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 457 insertions(+)
4e0da4965b83b25debdec4d55e075c18be436fa8

 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
991195416e0c179d2d2a79891d0214244c287618

 clients/src/main/java/org/apache/kafka/clients/Metadata.java     | 9 +++++++++
 .../java/org/apache/kafka/clients/producer/KafkaProducer.java    | 9 ++++++---
 2 files changed, 15 insertions(+), 3 deletions(-)
c62cff355936eea2a96e3b9678c761334fce8ee2

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 1 -
 clients/src/main/java/org/apache/kafka/common/record/Record.java        | 2 +-
 2 files changed, 1 insertion(+), 2 deletions(-)
b2c833aa41cb9a7a6232781b273402042e021607

 .../org/apache/kafka/clients/consumer/KafkaConsumer.java    | 13 ++++++-------
 .../apache/kafka/clients/consumer/internals/Fetcher.java    |  2 +-
 .../java/org/apache/kafka/common/record/MemoryRecords.java  |  6 ++++--
 .../main/java/org/apache/kafka/common/record/Record.java    |  8 +++++---
 4 files changed, 16 insertions(+), 13 deletions(-)
82789e75199fdc1cae115c5c2eadfd0f1ece4d0d

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 17 +++++++++--------
 1 file changed, 9 insertions(+), 8 deletions(-)
5bbbb7fddbddc823b0946fda6e82dfba4ab8b5fd

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
1caaf6db400df7e37b7f0416bb83ab451018a5c8

 .../apache/kafka/clients/producer/Callback.java    | 19 +++++++++++++++++++
 .../apache/kafka/common/protocol/types/Field.java  |  5 +++++
 .../apache/kafka/common/protocol/types/Schema.java |  5 +++++
 .../common/protocol/types/SchemaException.java     |  3 +++
 .../apache/kafka/common/protocol/types/Struct.java | 10 ++++++++++
 .../apache/kafka/common/protocol/types/Type.java   | 22 ++++++++++++++++++++--
 6 files changed, 62 insertions(+), 2 deletions(-)
c41c7b40b63ecd668c727a897f29e276a1c5adf7

 .../producer/internals/RecordAccumulator.java      |  28 +-
 .../scala/kafka/consumer/PartitionAssignor.scala   |  38 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  45 +-
 .../consumer/ConsumerRebalanceListener.java        |  12 +
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 691 +++++++--------------
 .../kafka/consumer/PartitionAssignorTest.scala     |   2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  63 +-
 7 files changed, 358 insertions(+), 521 deletions(-)
b7439c8081465f8764e88326b3fa7b320f99f130

 .../src/main/scala/kafka/consumer/ConsumerFetcherThread.scala |  3 ++-
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala  | 11 ++++++++---
 core/src/main/scala/kafka/server/KafkaConfig.scala            |  9 ++++++++-
 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala   |  1 +
 .../scala/unit/kafka/server/KafkaConfigConfigDefTest.scala    |  1 +
 core/src/test/scala/unit/kafka/utils/TestUtils.scala          |  1 +
 6 files changed, 21 insertions(+), 5 deletions(-)
01f20e029fbd068a8493492a2c4a1364a5668579

 .../java/org/apache/kafka/clients/consumer/internals/Coordinator.java | 2 +-
 .../java/org/apache/kafka/clients/consumer/internals/Fetcher.java     | 3 ++-
 .../java/org/apache/kafka/common/requests/ListOffsetResponse.java     | 4 +++-
 core/src/test/scala/integration/kafka/api/ConsumerTest.scala          | 1 +
 4 files changed, 7 insertions(+), 3 deletions(-)
1eb5f53aa4f5c5c0f67ce62d86e8d9b4e5bbc500

 clients/src/main/java/org/apache/kafka/common/record/MemoryRecords.java | 2 +-
 .../apache/kafka/clients/producer/internals/RecordAccumulatorTest.java  | 1 -
 core/src/test/scala/integration/kafka/api/ConsumerTest.scala            | 2 +-
 3 files changed, 2 insertions(+), 3 deletions(-)
01d2a25235841feb01eac55f6ea5141750225a21

 .../kafka/clients/producer/internals/Sender.java     |  3 +--
 .../apache/kafka/common/record/MemoryRecords.java    | 20 ++++++++++----------
 .../clients/consumer/internals/FetcherTest.java      |  2 +-
 .../producer/internals/RecordAccumulatorTest.java    |  6 +++---
 .../kafka/common/record/MemoryRecordsTest.java       |  4 ++--
 .../kafka/api/ProducerFailureHandlingTest.scala      |  7 ++++---
 6 files changed, 21 insertions(+), 21 deletions(-)
0b92cec1e07a1f2d9aa70f3ecd7d0fb12290d2e2

 .../apache/kafka/clients/CommonClientConfigs.java  |   2 +-
 .../java/org/apache/kafka/clients/KafkaClient.java |  11 +-
 .../org/apache/kafka/clients/NetworkClient.java    |  14 +-
 .../kafka/clients/consumer/ConsumerConfig.java     |  28 +
 .../kafka/clients/consumer/KafkaConsumer.java      | 903 +++------------------
 .../clients/consumer/internals/Coordinator.java    | 595 ++++++++++++++
 .../kafka/clients/consumer/internals/Fetcher.java  | 459 +++++++++++
 .../clients/consumer/internals/Heartbeat.java      |  16 +-
 .../consumer/internals/SubscriptionState.java      |  21 +-
 .../kafka/clients/producer/KafkaProducer.java      |  26 +-
 .../kafka/clients/producer/ProducerConfig.java     |  26 +
 .../kafka/clients/producer/internals/Sender.java   |   5 +-
 .../org/apache/kafka/common/network/Selector.java  |   5 +-
 .../org/apache/kafka/common/protocol/Errors.java   |  29 +-
 .../apache/kafka/common/record/MemoryRecords.java  |  12 +-
 .../kafka/common/requests/FetchResponse.java       |  11 +
 .../kafka/common/requests/HeartbeatResponse.java   |   6 +
 .../kafka/common/requests/JoinGroupRequest.java    |   2 +
 .../kafka/common/requests/JoinGroupResponse.java   |   7 +
 .../kafka/common/requests/ListOffsetResponse.java  |   7 +
 .../kafka/common/requests/MetadataResponse.java    |  14 +
 .../common/requests/OffsetCommitResponse.java      |   6 +
 .../kafka/common/requests/OffsetFetchResponse.java |   9 +
 .../kafka/common/requests/ProduceResponse.java     |   7 +
 .../java/org/apache/kafka/clients/MockClient.java  |  59 +-
 .../consumer/internals/CoordinatorTest.java        | 284 +++++++
 .../clients/consumer/internals/FetcherTest.java    | 177 ++++
 .../clients/consumer/internals/HeartbeatTest.java  |  45 +
 .../consumer/internals/SubscriptionStateTest.java  |   3 +-
 .../producer/internals/RecordAccumulatorTest.java  |   3 +
 .../clients/producer/internals/SenderTest.java     |  24 +-
 .../kafka/common/record/MemoryRecordsTest.java     |   2 +
 .../src/main/scala/kafka/common/ErrorMapping.scala |   6 +-
 .../kafka/common/NoOffsetsCommittedException.scala |  27 +
 .../kafka/common/OffsetMetadataAndError.scala      |   2 +-
 .../kafka/coordinator/ConsumerCoordinator.scala    |  38 +-
 .../scala/kafka/coordinator/ConsumerRegistry.scala |   8 +-
 .../scala/kafka/coordinator/DelayedHeartbeat.scala |   2 +-
 .../scala/kafka/coordinator/GroupRegistry.scala    |   7 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../scala/integration/kafka/api/ConsumerTest.scala | 301 +++++++
 .../kafka/api/IntegrationTestHarness.scala         |  12 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |   2 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   2 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  22 +
 46 files changed, 2346 insertions(+), 905 deletions(-)
67940c43e0efa6a49af1fe928fe73a13b21d57f1

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
8f0003f9b694b4da5fbd2f86db872d77a43eb63f

 .gitignore                                         |    1 +
 .../org/apache/kafka/common/config/ConfigDef.java  |  160 +--
 core/src/main/scala/kafka/Kafka.scala              |    6 +-
 .../scala/kafka/controller/KafkaController.scala   |    2 +-
 .../kafka/controller/PartitionLeaderSelector.scala |    2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala | 1169 ++++++++++++++------
 core/src/main/scala/kafka/server/KafkaServer.scala |    2 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |    2 +-
 .../kafka/api/IntegrationTestHarness.scala         |    2 +-
 .../kafka/api/ProducerCompressionTest.scala        |    2 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |   21 +-
 .../integration/kafka/api/ProducerSendTest.scala   |   12 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |    8 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   16 +-
 .../unit/kafka/admin/DeleteConsumerGroupTest.scala |    2 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |    4 +-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |   10 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   12 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |    2 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |    2 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |    2 +-
 .../unit/kafka/integration/RollingBounceTest.scala |    8 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |    2 +-
 .../integration/UncleanLeaderElectionTest.scala    |    2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   15 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |    2 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |    2 +-
 .../scala/unit/kafka/metrics/MetricsTest.scala     |   15 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |    2 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |    4 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |    2 +-
 .../unit/kafka/server/AdvertiseBrokerTest.scala    |    2 +-
 .../kafka/server/DynamicConfigChangeTest.scala     |    2 +-
 .../server/HighwatermarkPersistenceTest.scala      |    2 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   16 +-
 .../kafka/server/KafkaConfigConfigDefTest.scala    |  403 +++++++
 .../scala/unit/kafka/server/KafkaConfigTest.scala  |   39 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |    6 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |    2 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |   20 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |    2 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |    2 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |    6 +-
 .../kafka/server/ServerGenerateBrokerIdTest.scala  |   10 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |    6 +-
 .../unit/kafka/server/ServerStartupTest.scala      |    6 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   17 +-
 .../unit/kafka/utils/ReplicationUtilsTest.scala    |    2 +-
 48 files changed, 1521 insertions(+), 515 deletions(-)
3a9f4b833bb7e86dc759361c33f4321ab043db05

 .../clients/producer/internals/Partitioner.java    | 23 ++++++++++++++++++----
 .../java/org/apache/kafka/common/utils/Utils.java  |  2 +-
 .../org/apache/kafka/common/utils/UtilsTest.java   |  9 +++++++++
 3 files changed, 29 insertions(+), 5 deletions(-)
00c643e6fd6b54c7270e2b5a27441d738c7bcbd5

 core/src/test/scala/unit/kafka/log/CleanerTest.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
151ae42cdf2f54d83563da7c90cd087b99300408

 .../scala/integration/kafka/api/ProducerFailureHandlingTest.scala | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
4c9ad9b8a23e5487fc17579c46472c3693114d8b

 core/src/main/scala/kafka/server/OffsetManager.scala | 1 +
 1 file changed, 1 insertion(+)
61f02fa542380e70c837fbc52deac74daec62505

 core/src/main/scala/kafka/server/OffsetManager.scala | 1 -
 1 file changed, 1 deletion(-)
57d38f672bcb85fdb20d8ca3fab9bd60d1bc8965

 core/src/main/scala/kafka/server/ReplicaManager.scala | 4 ++++
 1 file changed, 4 insertions(+)
c5d654acb2097eabb1784dcc88145e111a3d037b

 core/src/main/scala/kafka/message/CompressionCodec.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
616987d196b654486a1261f4eed50e48560e3041

 core/src/main/scala/kafka/server/KafkaApis.scala   | 22 ++++++++++------------
 core/src/main/scala/kafka/server/KafkaServer.scala |  8 ++++++--
 .../main/scala/kafka/server/MetadataCache.scala    |  7 ++++++-
 .../main/scala/kafka/server/OffsetManager.scala    | 19 ++++++++++++++-----
 .../scala/unit/kafka/server/OffsetCommitTest.scala | 19 +++++++++++++++++++
 5 files changed, 55 insertions(+), 20 deletions(-)
1cd6ed9e2c07a63474ed80a8224bd431d5d4243c

 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     |  49 +++---
 .../main/scala/kafka/log/LogCleanerManager.scala   |  12 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |  44 +++--
 .../main/scala/kafka/server/OffsetManager.scala    |   1 +
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  43 ++++-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 186 ++++++++++++++-------
 .../kafka/message/ByteBufferMessageSetTest.scala   |   4 +-
 8 files changed, 235 insertions(+), 106 deletions(-)
0636928d961a6ceaab46d908f9372d913c3e5faf

 .../java/org/apache/kafka/clients/Metadata.java    |  10 +-
 .../kafka/clients/producer/KafkaProducer.java      | 187 +++++++++++++----
 .../kafka/clients/producer/MockProducer.java       |   5 +
 .../apache/kafka/clients/producer/Producer.java    |   5 +
 .../kafka/clients/producer/ProducerRecord.java     |  20 +-
 .../producer/internals/FutureRecordMetadata.java   |  10 +-
 .../producer/internals/RecordAccumulator.java      |  77 ++++++-
 .../clients/producer/internals/RecordBatch.java    |  13 +-
 .../kafka/common/errors/InterruptException.java    |  34 +++
 .../org/apache/kafka/common/utils/SystemTime.java  |   2 +-
 .../org/apache/kafka/clients/MetadataTest.java     | 103 ++++++++++
 .../kafka/clients/producer/BufferPoolTest.java     | 193 -----------------
 .../kafka/clients/producer/MetadataTest.java       |  95 ---------
 .../kafka/clients/producer/MockProducerTest.java   |   6 +
 .../kafka/clients/producer/PartitionerTest.java    |  69 -------
 .../clients/producer/RecordAccumulatorTest.java    | 207 -------------------
 .../apache/kafka/clients/producer/SenderTest.java  | 155 --------------
 .../clients/producer/internals/BufferPoolTest.java | 193 +++++++++++++++++
 .../producer/internals/PartitionerTest.java        |  68 ++++++
 .../producer/internals/RecordAccumulatorTest.java  | 228 +++++++++++++++++++++
 .../clients/producer/internals/SenderTest.java     | 154 ++++++++++++++
 .../integration/kafka/api/ProducerSendTest.scala   |  62 ++++--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   4 +-
 23 files changed, 1097 insertions(+), 803 deletions(-)
22ff9e943a960a73d2f007b2c52b90e675a61299

 .../main/scala/kafka/tools/ConsoleProducer.scala   | 112 +++++++++++++--------
 .../scala/kafka/tools/ConsoleProducerTest.scala    |  79 +++++++++++++++
 2 files changed, 148 insertions(+), 43 deletions(-)
687abc98a4600bf90ed7a7acb6fb2a5e6eac2055

 core/src/main/scala/kafka/cluster/Partition.scala  | 11 +++++++-
 core/src/main/scala/kafka/log/Log.scala            | 12 +++++++-
 .../scala/unit/kafka/metrics/MetricsTest.scala     | 33 +++++++++++++++++++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  4 +--
 4 files changed, 52 insertions(+), 8 deletions(-)
b56f5973c739072350f3f6bf6efa4eb05bc692bf

 core/src/main/scala/kafka/utils/ZkUtils.scala      |  46 +++++--
 core/src/test/scala/unit/kafka/zk/ZKPathTest.scala | 147 +++++++++++++++++++++
 2 files changed, 183 insertions(+), 10 deletions(-)
a864172da53db009607989e2d7a6c0ff1c600995

 .../scala/integration/kafka/api/ConsumerTest.scala | 289 ---------------------
 1 file changed, 289 deletions(-)
e39373d16bc208128d5d6cf0e0672f27f35e3b20

 core/src/test/scala/unit/kafka/network/SocketServerTest.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
ef252dea704192a8055367d22e45f673f5b06e94

 core/src/test/scala/unit/kafka/admin/DeleteTopicTest.scala | 2 ++
 1 file changed, 2 insertions(+)
b8904e9614b4c1f11b8487e7a4b88b1e37e1f20b

 .../kafka/coordinator/ConsumerCoordinator.scala    |  6 ++---
 .../scala/kafka/coordinator/DelayedHeartbeat.scala |  4 +++
 .../scala/kafka/coordinator/DelayedJoinGroup.scala |  4 +++
 .../scala/kafka/coordinator/DelayedRebalance.scala |  4 +++
 .../src/main/scala/kafka/server/DelayedFetch.scala | 20 +++++++++++++-
 .../main/scala/kafka/server/DelayedOperation.scala | 22 +++++++++++----
 .../main/scala/kafka/server/DelayedProduce.scala   | 31 ++++++++++++++++++++++
 .../main/scala/kafka/server/ReplicaManager.scala   |  9 ++++---
 .../unit/kafka/server/DelayedOperationTest.scala   |  6 ++++-
 9 files changed, 93 insertions(+), 13 deletions(-)
10311c138923dcded5d8f57f587c7f7ef1119dac

 .../clients/producer/internals/Partitioner.java    | 15 +++++------
 .../main/java/org/apache/kafka/common/Cluster.java | 24 ++++++++++++++++--
 .../kafka/clients/producer/PartitionerTest.java    | 29 +++++++++++-----------
 3 files changed, 45 insertions(+), 23 deletions(-)
ee1267b127f3081db491fa1bf9a287084c324e36

 .../clients/producer/internals/Partitioner.java    | 15 ++++++-----
 .../main/java/org/apache/kafka/common/Cluster.java | 24 +++++++++++++++--
 .../kafka/clients/producer/PartitionerTest.java    | 30 +++++++++++-----------
 3 files changed, 45 insertions(+), 24 deletions(-)
7c82afddc812908f9289ded4e2cb0733b8116a77

 bin/kafka-consumer-groups.sh | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
5f3eb1cafaecee746641fa43945cc0762635a0bd

 .../main/scala/kafka/server/KafkaHealthcheck.scala |  7 +---
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 -
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  6 ---
 .../unit/kafka/server/ServerStartupTest.scala      | 43 +++++++++++++++-------
 4 files changed, 30 insertions(+), 28 deletions(-)
41189ea5601837bdb697ade31f55e244abbe6d1c

 .../main/scala/kafka/server/KafkaHealthcheck.scala |  7 +---
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 --
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  6 ----
 .../unit/kafka/server/ServerStartupTest.scala      | 42 +++++++++++++++-------
 4 files changed, 31 insertions(+), 26 deletions(-)
3f1e0882297a102843dcd17e05f54ddbedb4882a

 core/src/main/scala/kafka/log/OffsetIndex.scala | 2 ++
 1 file changed, 2 insertions(+)
62c7e0e485b8b7693354c3a0a0bf95af671c93b6

 core/src/main/scala/kafka/admin/TopicCommand.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
bafecc936787576faf111f12cd59cc17c3523e4e

 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 6 ++++--
 .../org/apache/kafka/clients/producer/internals/Metadata.java     | 8 ++++++++
 2 files changed, 12 insertions(+), 2 deletions(-)
19031823c15cb3a0e5fcecaaf5de79c09b5300ed

 clients/src/main/java/org/apache/kafka/clients/Metadata.java      | 8 ++++++++
 clients/src/main/java/org/apache/kafka/clients/NetworkClient.java | 6 ++++--
 2 files changed, 12 insertions(+), 2 deletions(-)
fbb11549743aa00420e40696f11b48a705dce019

 core/src/main/scala/kafka/utils/DelayedItem.scala | 29 ++++++++---------------
 1 file changed, 10 insertions(+), 19 deletions(-)
8c1b9325be4adc5065c6dbe3dcdbdccb1887d604

 .../main/scala/kafka/controller/ControllerChannelManager.scala   | 8 +++++++-
 .../integration/kafka/api/ProducerFailureHandlingTest.scala      | 7 -------
 core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala     | 9 +--------
 3 files changed, 8 insertions(+), 16 deletions(-)
38346fb106064a10047ecc7cefa634c6f1b09960

 core/src/main/scala/kafka/server/KafkaConfig.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
4c8817e3d156416240906dd06a4494386949ba0a

 core/src/main/scala/kafka/javaapi/OffsetFetchRequest.scala | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
cd8f0b87b9b02302b2fce494e04cc367647a2d2c

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
45b9e1580c656867c5c81e2ad8f6645c64b83f90

 core/src/main/scala/kafka/javaapi/OffsetFetchRequest.scala | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
f7f8ac1a8864acdbfc52326edc7cbeb9e35f4adf

 core/src/test/scala/unit/kafka/server/SimpleFetchTest.scala | 3 +++
 1 file changed, 3 insertions(+)
8d72816f48d18d61e8ef8b174896c6d177a09a92

 core/src/test/scala/unit/kafka/server/SimpleFetchTest.scala | 3 ---
 1 file changed, 3 deletions(-)
f5684366ef60125c4d799121a6c0adca4744e8ab

 .../main/scala/kafka/server/DelayedOperation.scala | 34 +++++++++++++++-------
 1 file changed, 23 insertions(+), 11 deletions(-)
375b15511a93313fce52442fb7d4eab4492da62e

 .../main/scala/kafka/server/RequestPurgatory.scala | 69 ++++++++++++++--------
 1 file changed, 46 insertions(+), 23 deletions(-)
d5fbba633612fd08f15c523362a0c1ff5a121ff2

 .gitignore | 2 ++
 1 file changed, 2 insertions(+)
cdf06564458ac384119d21ac8b25a3a7ebe27014

 core/src/test/scala/other/kafka/TestOffsetManager.scala | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
cb40ec2e7a73bdecdfea6c88ffd8e8717b630d0f

 core/src/main/scala/kafka/server/KafkaRequestHandler.scala  | 2 ++
 core/src/main/scala/kafka/server/ReplicaManager.scala       | 6 ++++++
 core/src/test/scala/unit/kafka/server/SimpleFetchTest.scala | 8 +++++++-
 3 files changed, 15 insertions(+), 1 deletion(-)
b8be3140b68cb62d908ca78fe280b089ded851b8

 core/src/main/scala/kafka/server/ReplicaManager.scala | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
5b949c7b1ad5ab3f71cae6024eea10b59a7ad9b6

 .../kafka/clients/producer/ProducerRecord.java     | 24 ++++++++++
 .../kafka/clients/producer/ProducerRecordTest.java | 52 ++++++++++++++++++++++
 2 files changed, 76 insertions(+)
eab4f4c9f43e20b3d91bf0e2e9be6b6fd72f0acf

 .../errors/InvalidRequiredAcksException.java       | 25 +++++++
 .../NotEnoughReplicasAfterAppendException.java     | 12 ---
 .../org/apache/kafka/common/protocol/Errors.java   | 19 +----
 core/src/main/scala/kafka/cluster/Partition.scala  |  2 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |  2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 85 ++++++++++++++--------
 .../api/RequestResponseSerializationTest.scala     |  2 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 26 +++++++
 8 files changed, 111 insertions(+), 62 deletions(-)
a3d6dcaf1bcc6189c3ef17b63719ae4d12dcb789

 core/src/main/scala/kafka/controller/KafkaController.scala   | 2 ++
 core/src/test/scala/integration/kafka/api/ConsumerTest.scala | 5 ++++-
 2 files changed, 6 insertions(+), 1 deletion(-)
9fe9913e95e1d3e114c74620d8da40f804f71b18

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  56 +++-
 .../scala/kafka/admin/ConsumerGroupCommand.scala   | 310 +++++++++++++++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  26 +-
 .../unit/kafka/admin/DeleteConsumerGroupTest.scala | 212 ++++++++++++++
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  52 +---
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  33 ++-
 6 files changed, 641 insertions(+), 48 deletions(-)
71602de0bbf7727f498a812033027f6cbfe34eb8

 .../kafka/coordinator/ConsumerCoordinator.scala    | 333 +++++++++++++++++++++
 .../scala/kafka/coordinator/ConsumerRegistry.scala |  52 ++++
 .../scala/kafka/coordinator/DelayedHeartbeat.scala |  44 +++
 .../scala/kafka/coordinator/DelayedJoinGroup.scala |  44 +++
 .../scala/kafka/coordinator/DelayedRebalance.scala |  62 ++++
 .../scala/kafka/coordinator/GroupRegistry.scala    |  74 +++++
 .../scala/kafka/coordinator/HeartbeatBucket.scala  |  36 +++
 7 files changed, 645 insertions(+)
39cd48de321585ac55c94ec407fede5858f38962

 .../main/scala/kafka/network/SocketServer.scala    |   2 +-
 .../scala/kafka/server/DelayedOperationKey.scala   |  19 +++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  70 ++++++----
 core/src/main/scala/kafka/server/KafkaServer.scala | 144 +++++++++++++--------
 .../main/scala/kafka/server/MetadataCache.scala    |  17 ++-
 .../main/scala/kafka/server/OffsetManager.scala    |   2 +
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |   6 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |   2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |  13 +-
 .../unit/kafka/server/ServerStartupTest.scala      |  15 ---
 10 files changed, 179 insertions(+), 111 deletions(-)
0839def4bdbfd9f5939e463f42cfbc81a98a8eff

 .../src/main/java/org/apache/kafka/clients/consumer/KafkaConsumer.java  | 2 +-
 clients/src/main/java/org/apache/kafka/common/Node.java                 | 2 +-
 core/src/test/scala/unit/kafka/integration/KafkaServerTestHarness.scala | 1 +
 3 files changed, 3 insertions(+), 2 deletions(-)
1c6d5bbac672cbf49591aed0889510b10e3285fa

 README.md                                          |    3 +
 build.gradle                                       |    6 +
 checkstyle/checkstyle.xml                          |   83 +
 checkstyle/import-control.xml                      |  100 +
 .../java/org/apache/kafka/clients/ClientUtils.java |   48 +
 .../kafka/clients/ClusterConnectionStates.java     |    9 +-
 .../java/org/apache/kafka/clients/Metadata.java    |  170 ++
 .../org/apache/kafka/clients/NetworkClient.java    |    3 +-
 .../apache/kafka/clients/consumer/CommitType.java  |   12 +
 .../kafka/clients/consumer/ConsumerConfig.java     |    8 +-
 .../kafka/clients/consumer/ConsumerRecords.java    |   40 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   43 +-
 .../clients/consumer/internals/Heartbeat.java      |   12 +
 .../internals/NoOpConsumerRebalanceCallback.java   |    4 +-
 .../consumer/internals/SubscriptionState.java      |   16 +-
 .../kafka/clients/producer/KafkaProducer.java      |   25 +-
 .../apache/kafka/clients/producer/Producer.java    |    6 +-
 .../kafka/clients/producer/ProducerConfig.java     |   10 +-
 .../clients/producer/internals/BufferPool.java     |    8 +-
 .../kafka/clients/producer/internals/Metadata.java |  170 --
 .../producer/internals/ProduceRequestResult.java   |    1 -
 .../producer/internals/RecordAccumulator.java      |   40 +-
 .../kafka/clients/producer/internals/Sender.java   |    1 +
 .../kafka/clients/tools/ProducerPerformance.java   |    8 +-
 .../main/java/org/apache/kafka/common/Cluster.java |    4 +-
 .../java/org/apache/kafka/common/MetricName.java   |    4 +-
 .../org/apache/kafka/common/PartitionInfo.java     |    2 +-
 .../org/apache/kafka/common/config/ConfigDef.java  |   82 +-
 .../NotEnoughReplicasAfterAppendException.java     |   33 +-
 .../common/errors/NotEnoughReplicasException.java  |   28 +-
 .../common/message/KafkaLZ4BlockInputStream.java   |  233 --
 .../common/message/KafkaLZ4BlockOutputStream.java  |  387 ----
 .../apache/kafka/common/metrics/JmxReporter.java   |   57 +-
 .../org/apache/kafka/common/metrics/Sensor.java    |   12 +-
 .../apache/kafka/common/metrics/stats/Rate.java    |    2 +-
 .../kafka/common/network/NetworkReceive.java       |    2 +-
 .../org/apache/kafka/common/network/Selector.java  |    9 +-
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   12 +-
 .../org/apache/kafka/common/protocol/Protocol.java |  590 +++--
 .../apache/kafka/common/protocol/types/Struct.java |    2 +-
 .../common/record/ByteBufferOutputStream.java      |    2 +-
 .../org/apache/kafka/common/record/Compressor.java |   29 +-
 .../common/record/KafkaLZ4BlockInputStream.java    |  234 ++
 .../common/record/KafkaLZ4BlockOutputStream.java   |  392 ++++
 .../apache/kafka/common/record/MemoryRecords.java  |   36 +-
 .../common/requests/ConsumerMetadataRequest.java   |    2 +-
 .../common/requests/ConsumerMetadataResponse.java  |    2 +-
 .../apache/kafka/common/requests/FetchRequest.java |    2 +-
 .../kafka/common/requests/FetchResponse.java       |    2 +-
 .../kafka/common/requests/HeartbeatRequest.java    |    2 +-
 .../kafka/common/requests/HeartbeatResponse.java   |    2 +-
 .../kafka/common/requests/JoinGroupRequest.java    |    2 +-
 .../kafka/common/requests/JoinGroupResponse.java   |    2 +-
 .../kafka/common/requests/ListOffsetRequest.java   |    4 +-
 .../kafka/common/requests/ListOffsetResponse.java  |    2 +-
 .../kafka/common/requests/MetadataRequest.java     |    2 +-
 .../kafka/common/requests/MetadataResponse.java    |    8 +-
 .../kafka/common/requests/OffsetCommitRequest.java |    4 +-
 .../common/requests/OffsetCommitResponse.java      |    2 +-
 .../kafka/common/requests/OffsetFetchRequest.java  |    4 +-
 .../kafka/common/requests/OffsetFetchResponse.java |    2 +-
 .../kafka/common/requests/ProduceRequest.java      |    2 +-
 .../kafka/common/requests/ProduceResponse.java     |    2 +-
 .../kafka/common/requests/RequestHeader.java       |    8 +-
 .../kafka/common/requests/ResponseHeader.java      |    4 +-
 .../org/apache/kafka/common/utils/ClientUtils.java |   49 -
 .../java/org/apache/kafka/common/utils/Crc32.java  | 2338 +++-----------------
 .../java/org/apache/kafka/common/utils/Utils.java  |   44 +-
 .../org/apache/kafka/clients/ClientUtilsTest.java  |   42 +
 .../java/org/apache/kafka/clients/MockClient.java  |   18 +-
 .../apache/kafka/clients/NetworkClientTest.java    |   17 +-
 .../kafka/clients/consumer/MockConsumerTest.java   |   16 +
 .../consumer/internals/SubscriptionStateTest.java  |   16 +
 .../kafka/clients/producer/BufferPoolTest.java     |   14 +-
 .../kafka/clients/producer/MetadataTest.java       |    8 +-
 .../kafka/clients/producer/MockProducerTest.java   |    1 +
 .../kafka/clients/producer/PartitionerTest.java    |    2 +-
 .../clients/producer/RecordAccumulatorTest.java    |    3 +-
 .../kafka/clients/producer/RecordSendTest.java     |    5 +-
 .../apache/kafka/clients/producer/SenderTest.java  |    6 +-
 .../kafka/common/config/AbstractConfigTest.java    |  106 +-
 .../apache/kafka/common/config/ConfigDefTest.java  |    5 +-
 .../kafka/common/metrics/FakeMetricsReporter.java  |   32 +
 .../apache/kafka/common/metrics/MetricsTest.java   |    4 +-
 .../kafka/common/metrics/stats/HistogramTest.java  |    1 -
 .../apache/kafka/common/network/SelectorTest.java  |    1 -
 .../protocol/types/ProtocolSerializationTest.java  |   14 +-
 .../kafka/common/record/MemoryRecordsTest.java     |    2 +-
 .../org/apache/kafka/common/record/RecordTest.java |    4 +-
 .../kafka/common/requests/RequestResponseTest.java |   23 +-
 .../common/serialization/SerializationTest.java    |    4 +-
 .../apache/kafka/common/utils/ClientUtilsTest.java |   42 -
 .../org/apache/kafka/common/utils/CrcTest.java     |    8 +-
 .../org/apache/kafka/test/Microbenchmarks.java     |    1 -
 .../test/java/org/apache/kafka/test/TestUtils.java |   16 +-
 .../consumer/ConsumerRebalanceListener.java        |    3 -
 .../scala/kafka/message/CompressionFactory.scala   |    2 +-
 .../main/scala/kafka/tools/KafkaMigrationTool.java |   12 +-
 core/src/main/scala/kafka/utils/Crc32.java         |   40 +-
 .../java/kafka/examples/SimpleConsumerDemo.java    |    9 +-
 100 files changed, 2225 insertions(+), 3721 deletions(-)
f1ba4ff87e60a6dc06fb3d16e84fa94f8c4a7d9e

 core/src/main/scala/kafka/api/OffsetCommitResponse.scala   |  4 +++-
 .../scala/kafka/javaapi/ConsumerMetadataResponse.scala     |  6 ++++++
 .../src/main/scala/kafka/javaapi/OffsetCommitRequest.scala | 14 ++++++++++++--
 .../main/scala/kafka/javaapi/OffsetCommitResponse.scala    |  9 +++++++++
 .../src/main/scala/kafka/javaapi/OffsetFetchResponse.scala |  5 +++++
 5 files changed, 35 insertions(+), 3 deletions(-)
75a286e4308831203cc7e1d4748bdab504e8a1f3

 core/src/main/scala/kafka/server/KafkaApis.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
0699ff2ce60abb466cab5315977a224f1a70a4da

 build.gradle                                       |    1 +
 .../org/apache/kafka/clients/ClientRequest.java    |   19 +-
 .../kafka/clients/ClusterConnectionStates.java     |   30 +-
 .../apache/kafka/clients/CommonClientConfigs.java  |   58 +
 .../org/apache/kafka/clients/ConnectionState.java  |    2 +-
 .../java/org/apache/kafka/clients/KafkaClient.java |   44 +-
 .../org/apache/kafka/clients/NetworkClient.java    |  138 +-
 .../apache/kafka/clients/NodeConnectionState.java  |   31 -
 .../kafka/clients/RequestCompletionHandler.java    |   23 +
 .../apache/kafka/clients/consumer/CommitType.java  |    5 +
 .../apache/kafka/clients/consumer/Consumer.java    |  109 +-
 .../kafka/clients/consumer/ConsumerConfig.java     |  296 ++--
 .../consumer/ConsumerRebalanceCallback.java        |   89 +-
 .../kafka/clients/consumer/ConsumerRecord.java     |   89 +-
 .../kafka/clients/consumer/ConsumerRecords.java    |  107 +-
 .../kafka/clients/consumer/KafkaConsumer.java      | 1865 +++++++++++++++-----
 .../kafka/clients/consumer/MockConsumer.java       |  233 ++-
 .../consumer/NoOffsetForPartitionException.java    |   29 +
 .../kafka/clients/consumer/OffsetMetadata.java     |   59 -
 .../clients/consumer/internals/Heartbeat.java      |   47 +
 .../internals/NoOpConsumerRebalanceCallback.java   |   30 +
 .../consumer/internals/SubscriptionState.java      |  166 ++
 .../kafka/clients/producer/KafkaProducer.java      |    3 +-
 .../kafka/clients/producer/MockProducer.java       |    2 +-
 .../kafka/clients/producer/ProducerConfig.java     |   64 +-
 .../kafka/clients/producer/internals/Metadata.java |   22 +-
 .../clients/producer/internals/Partitioner.java    |   27 +-
 .../kafka/clients/producer/internals/Sender.java   |  155 +-
 .../main/java/org/apache/kafka/common/Cluster.java |   14 +
 .../org/apache/kafka/common/PartitionInfo.java     |    4 +-
 .../org/apache/kafka/common/config/ConfigDef.java  |   26 +-
 .../apache/kafka/common/errors/ApiException.java   |    2 +-
 .../apache/kafka/common/network/Selectable.java    |   58 +-
 .../org/apache/kafka/common/network/Selector.java  |   99 +-
 .../org/apache/kafka/common/protocol/Errors.java   |   59 +-
 .../apache/kafka/common/protocol/types/Struct.java |   46 +-
 .../org/apache/kafka/common/record/LogEntry.java   |    4 +
 .../apache/kafka/common/record/MemoryRecords.java  |   48 +-
 .../common/requests/ConsumerMetadataRequest.java   |    9 +-
 .../common/requests/ConsumerMetadataResponse.java  |   17 +-
 .../apache/kafka/common/requests/FetchRequest.java |   74 +-
 .../kafka/common/requests/FetchResponse.java       |   21 +-
 .../kafka/common/requests/HeartbeatRequest.java    |   13 +-
 .../kafka/common/requests/HeartbeatResponse.java   |    9 +-
 .../kafka/common/requests/JoinGroupRequest.java    |   17 +-
 .../kafka/common/requests/JoinGroupResponse.java   |   25 +-
 .../kafka/common/requests/ListOffsetRequest.java   |   25 +-
 .../kafka/common/requests/ListOffsetResponse.java  |   19 +-
 .../kafka/common/requests/MetadataRequest.java     |    9 +-
 .../kafka/common/requests/MetadataResponse.java    |   33 +-
 .../kafka/common/requests/OffsetCommitRequest.java |   45 +-
 .../common/requests/OffsetCommitResponse.java      |   17 +-
 .../kafka/common/requests/OffsetFetchRequest.java  |   17 +-
 .../kafka/common/requests/OffsetFetchResponse.java |   46 +-
 .../kafka/common/requests/ProduceRequest.java      |   21 +-
 .../kafka/common/requests/ProduceResponse.java     |   19 +-
 .../kafka/common/serialization/Deserializer.java   |    2 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |   42 +
 .../java/org/apache/kafka/clients/MockClient.java  |   31 +-
 .../apache/kafka/clients/NetworkClientTest.java    |   35 +-
 .../clients/consumer/ConsumerExampleTest.java      |  297 ----
 .../kafka/clients/consumer/MockConsumerTest.java   |   32 +
 .../consumer/internals/SubscriptionStateTest.java  |   61 +
 .../kafka/clients/producer/BufferPoolTest.java     |    4 +-
 .../kafka/clients/producer/MockProducerTest.java   |    2 +-
 .../kafka/clients/producer/PartitionerTest.java    |   49 +-
 .../apache/kafka/clients/producer/SenderTest.java  |    6 +-
 .../apache/kafka/common/config/ConfigDefTest.java  |    6 +-
 .../apache/kafka/common/network/SelectorTest.java  |   53 +-
 .../org/apache/kafka/common/utils/UtilsTest.java   |   10 +
 .../java/org/apache/kafka/test/MockSelector.java   |   52 +-
 .../scala/kafka/api/ConsumerMetadataRequest.scala  |    2 +-
 .../scala/kafka/api/ConsumerMetadataResponse.scala |    2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |    2 +-
 .../controller/ControllerChannelManager.scala      |    2 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |    4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   29 +
 .../main/scala/kafka/server/ReplicaManager.scala   |    2 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   |    2 -
 .../scala/kafka/tools/ConsumerPerformance.scala    |  169 +-
 .../kafka/tools/SimpleConsumerPerformance.scala    |    2 +-
 .../main/scala/kafka/utils/KafkaScheduler.scala    |   56 +-
 .../scala/integration/kafka/api/ConsumerTest.scala |  286 +++
 .../kafka/api/IntegrationTestHarness.scala         |   73 +
 .../api/RequestResponseSerializationTest.scala     |    4 +-
 .../kafka/integration/KafkaServerTestHarness.scala |   39 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   19 +-
 .../scala/unit/kafka/utils/MockScheduler.scala     |    2 +
 .../scala/unit/kafka/utils/SchedulerTest.scala     |   17 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   34 +-
 90 files changed, 4002 insertions(+), 1965 deletions(-)
7130da90a9ee9e6fb4beb2a2a6ab05c06c9bfac4

 build.gradle | 3 +++
 1 file changed, 3 insertions(+)
11ec9bf5a5f150e5c172f88bb3e60b197ee9df5a

 build.gradle | 3 +++
 1 file changed, 3 insertions(+)
96ce96dc959dd827ae1f70a17e89e05b91b6ba58

 core/src/main/scala/kafka/api/OffsetCommitResponse.scala   |  4 +++-
 .../scala/kafka/javaapi/ConsumerMetadataResponse.scala     |  6 ++++++
 .../src/main/scala/kafka/javaapi/OffsetCommitRequest.scala | 14 ++++++++++++--
 .../main/scala/kafka/javaapi/OffsetCommitResponse.scala    |  9 +++++++++
 .../src/main/scala/kafka/javaapi/OffsetFetchResponse.scala |  5 +++++
 5 files changed, 35 insertions(+), 3 deletions(-)
f689e9b1e361cdf47e9966567631c06f614e446d

 .../scala/kafka/metrics/KafkaMetricsGroup.scala    | 27 ++++++++++++++++++++--
 1 file changed, 25 insertions(+), 2 deletions(-)
2a1e3d4510e8fadb0cad0cb7290baf54aae39c23

 .../scala/kafka/metrics/KafkaMetricsGroup.scala    | 27 ++++++++++++++++++++--
 1 file changed, 25 insertions(+), 2 deletions(-)
0f6cc0a058bbd2736f1e638448fc64b58a9f6b41

 .../main/scala/kafka/utils/ReplicationUtils.scala  | 32 ++++++++--------------
 .../unit/kafka/utils/ReplicationUtilsTest.scala    | 10 +++++++
 2 files changed, 22 insertions(+), 20 deletions(-)
0b171dee1fca16595f635bc9991056712e9e3b1a

 README.md    | 5 +++++
 build.gradle | 2 +-
 2 files changed, 6 insertions(+), 1 deletion(-)
4aa3dab3de088096461941353ba27cb37f1bd9d1

 .../controller/ControllerChannelManager.scala      | 32 ++++++++++++----------
 1 file changed, 17 insertions(+), 15 deletions(-)
995d0d369363ef3ad7cf43980746c52768b4df2e

 bin/kafka-run-class.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ff5cbcacc6fc3217ea41c624fb293adeae7bb672

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8cff9119f8d125e55898e2095512b90826522336

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
54e53b7312274a3599229a36caa35f0cd931e341

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a0852d477ec097bd4efe120c21de020fccf6dc49

 .../consumer/ZookeeperConsumerConnector.scala      | 57 +++++++++++-----------
 1 file changed, 28 insertions(+), 29 deletions(-)
fcc2521858efd1bd99e06c319de9489330125a4d

 .../test/scala/unit/kafka/consumer/PartitionAssignorTest.scala | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)
0b312a6b9f0833d38eec434bfff4c647c1814564

 core/src/main/scala/kafka/tools/ConsoleProducer.scala | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)
059b09decf52e774fe7aadc00ca3ef715cd4016c

 core/src/main/scala/kafka/server/KafkaApis.scala | 6 ++++++
 1 file changed, 6 insertions(+)
5d648cfdb13dee078bb1b3415f77dbe2d47d7ec4

 README.md    |  2 +-
 build.gradle | 14 +++++++-------
 2 files changed, 8 insertions(+), 8 deletions(-)
1e640177f0fcdc9479a7dc9214d11c240f0786c2

 README.md    |  2 +-
 build.gradle | 14 +++++++-------
 2 files changed, 8 insertions(+), 8 deletions(-)
07cff763633f20f51310e4f123963aaa0c008b2f

 .../scala/integration/kafka/api/ProducerFailureHandlingTest.scala    | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
49d7f8ee1cd96a99f44ac48043db9ad8a5336c7d

 config/server.properties                           | 4 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)
7013b2639eda1ef3e7b2d794bf8513ba40ef34bf

 config/server.properties                           | 4 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)
09234f0e5206b8cb55e89cffc4a0ecfbaafc7f86

 bin/kafka-run-class.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
86a8bc2b024588bbf0b0c6014c401979731fac86

 bin/kafka-run-class.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5174df53778cb5cb2d6d86e4cec9f3185a2c85db

 core/src/main/scala/kafka/server/KafkaApis.scala              | 11 +++++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala            |  6 +++++-
 core/src/main/scala/kafka/server/OffsetManager.scala          |  4 ++--
 .../integration/kafka/api/ProducerFailureHandlingTest.scala   |  7 +++++++
 core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala  |  7 +++++++
 5 files changed, 30 insertions(+), 5 deletions(-)
7a313999d0d2c846541299ded77b25eddf1bf554

 core/src/main/scala/kafka/server/KafkaApis.scala              | 11 +++++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala            |  6 +++++-
 core/src/main/scala/kafka/server/OffsetManager.scala          |  4 ++--
 .../integration/kafka/api/ProducerFailureHandlingTest.scala   |  7 +++++++
 core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala  |  7 +++++++
 5 files changed, 30 insertions(+), 5 deletions(-)
1769642bb779921267bd57d3d338591dbdf33842

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala         | 2 ++
 core/src/main/scala/kafka/javaapi/OffsetCommitRequest.scala     | 1 +
 core/src/main/scala/kafka/javaapi/OffsetFetchRequest.scala      | 2 +-
 core/src/main/scala/kafka/javaapi/consumer/SimpleConsumer.scala | 4 ++--
 4 files changed, 6 insertions(+), 3 deletions(-)
1d3fd0f6c875e8162682679fa9299c3dd71a25ed

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala         | 2 ++
 core/src/main/scala/kafka/javaapi/OffsetCommitRequest.scala     | 1 +
 core/src/main/scala/kafka/javaapi/OffsetFetchRequest.scala      | 2 +-
 core/src/main/scala/kafka/javaapi/consumer/SimpleConsumer.scala | 4 ++--
 4 files changed, 6 insertions(+), 3 deletions(-)
988e695fa294c5e9799509f6313b95e1f96682da

 .../kafka/clients/producer/KafkaProducer.java      | 34 +++++++++++-----------
 .../kafka/clients/producer/MockProducer.java       |  8 ++---
 .../java/org/apache/kafka/common/MetricName.java   | 24 +++++++++------
 3 files changed, 36 insertions(+), 30 deletions(-)
602d572f6365f80f14e8c968390972ea9767e263

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 4 ----
 1 file changed, 4 deletions(-)
17c8bdcbb42d81db47d03091049588238df7e3c6

 core/src/main/scala/kafka/tools/ConsoleConsumer.scala | 4 ----
 1 file changed, 4 deletions(-)
45697ed6c6132475b5dd4dd0069a2a192a75d329

 core/src/main/scala/kafka/log/Log.scala                          | 6 +++---
 core/src/main/scala/kafka/log/LogConfig.scala                    | 7 +++----
 core/src/main/scala/kafka/message/CompressionCodec.scala         | 6 ++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala               | 9 ++++-----
 core/src/test/scala/kafka/log/LogConfigTest.scala                | 2 +-
 .../test/scala/unit/kafka/message/ByteBufferMessageSetTest.scala | 4 ++--
 6 files changed, 17 insertions(+), 17 deletions(-)
1c8f89bc73ec1844371c812215b255db037e24a5

 core/src/main/scala/kafka/log/Log.scala            | 23 +++---
 core/src/main/scala/kafka/log/LogConfig.scala      | 20 +++++-
 .../scala/kafka/message/ByteBufferMessageSet.scala | 14 ++--
 .../scala/kafka/message/CompressionCodec.scala     | 39 ++++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 11 +++
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 core/src/test/scala/kafka/log/LogConfigTest.scala  |  2 +
 .../unit/kafka/log/BrokerCompressionTest.scala     | 84 ++++++++++++++++++++++
 .../kafka/message/ByteBufferMessageSetTest.scala   |  6 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 28 +++++++-
 10 files changed, 201 insertions(+), 29 deletions(-)
a611178408cf8497054ff015caba18cfcff70a60

 .../kafka/clients/producer/KafkaProducer.java      | 22 ++++++++++----------
 .../java/org/apache/kafka/common/MetricName.java   | 24 ++++++++++++++--------
 2 files changed, 26 insertions(+), 20 deletions(-)
a643be62afb23bca15ed2e88db9e76cb0ebfa906

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
bfb2da3c82ab01f5914d5559ee196d5aa977b17c

 .../java/org/apache/kafka/clients/tools/ProducerPerformance.java   | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
d4629df1c25efe06a9e54ed96375884c5de69442

 .../java/org/apache/kafka/clients/tools/ProducerPerformance.java   | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
e79ebdfe222288f2c5d997ba7e7c5e18c8c514ed

 kafka-patch-review.py | 31 +++++++++++++++++++++++--------
 1 file changed, 23 insertions(+), 8 deletions(-)
4e584deeb652d9bc0b606f710e2bb137392f6f5f

 core/src/main/scala/kafka/tools/ConsoleProducer.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
432d397af8a1d4467fe8041bcff8790864010a80

 .../org/apache/kafka/common/protocol/Protocol.java | 36 ++++++--
 .../kafka/common/requests/OffsetCommitRequest.java | 22 +++--
 .../main/scala/kafka/api/OffsetCommitRequest.scala | 21 +++--
 .../scala/kafka/api/OffsetCommitResponse.scala     |  5 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |  4 +-
 .../kafka/common/OffsetMetadataAndError.scala      |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 96 ++++++++++++++++++----
 .../api/RequestResponseSerializationTest.scala     |  4 +-
 8 files changed, 151 insertions(+), 39 deletions(-)
688e38ce45a7358a1e0bb359aa9b1a698a841619

 build.gradle                                       |   1 +
 .../apache/kafka/clients/consumer/Consumer.java    |   5 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   3 +-
 .../kafka/clients/consumer/MockConsumer.java       |   3 +-
 .../kafka/clients/producer/KafkaProducer.java      |  19 ++-
 .../kafka/clients/producer/MockProducer.java       |   7 +-
 .../apache/kafka/clients/producer/Producer.java    |   4 +-
 .../clients/producer/internals/BufferPool.java     |  28 ++--
 .../producer/internals/RecordAccumulator.java      |  25 +--
 .../kafka/clients/producer/internals/Sender.java   |  81 +++++++---
 .../main/java/org/apache/kafka/common/Metric.java  |   9 +-
 .../java/org/apache/kafka/common/MetricName.java   | 179 +++++++++++++++++++++
 .../apache/kafka/common/metrics/CompoundStat.java  |  14 +-
 .../apache/kafka/common/metrics/JmxReporter.java   |  60 +++----
 .../apache/kafka/common/metrics/KafkaMetric.java   |  18 +--
 .../org/apache/kafka/common/metrics/Metrics.java   |  58 +++----
 .../org/apache/kafka/common/metrics/Sensor.java    |  51 ++----
 .../kafka/common/metrics/stats/Percentile.java     |  18 +--
 .../kafka/common/metrics/stats/Percentiles.java    |   2 +-
 .../org/apache/kafka/common/network/Selector.java  |  93 +++++++----
 .../kafka/clients/producer/BufferPoolTest.java     |  14 +-
 .../clients/producer/RecordAccumulatorTest.java    |  16 +-
 .../apache/kafka/clients/producer/SenderTest.java  |  11 +-
 .../kafka/common/metrics/JmxReporterTest.java      |  13 +-
 .../apache/kafka/common/metrics/MetricsTest.java   |  87 ++++++----
 .../apache/kafka/common/network/SelectorTest.java  |   3 +-
 .../java/org/apache/kafka/test/MetricsBench.java   |  11 +-
 27 files changed, 533 insertions(+), 300 deletions(-)
9b6744d3ae1587444b91e76cc5bdeb9d35f96760

 build.gradle                                       |   1 +
 .../apache/kafka/clients/consumer/Consumer.java    |   5 +-
 .../kafka/clients/consumer/KafkaConsumer.java      |   3 +-
 .../kafka/clients/consumer/MockConsumer.java       |   3 +-
 .../kafka/clients/producer/KafkaProducer.java      |  19 ++-
 .../kafka/clients/producer/MockProducer.java       |   7 +-
 .../apache/kafka/clients/producer/Producer.java    |   4 +-
 .../clients/producer/internals/BufferPool.java     |  28 ++--
 .../producer/internals/RecordAccumulator.java      |  25 +--
 .../kafka/clients/producer/internals/Sender.java   |  81 +++++++---
 .../main/java/org/apache/kafka/common/Metric.java  |   9 +-
 .../java/org/apache/kafka/common/MetricName.java   | 179 +++++++++++++++++++++
 .../apache/kafka/common/metrics/CompoundStat.java  |  14 +-
 .../apache/kafka/common/metrics/JmxReporter.java   |  60 +++----
 .../apache/kafka/common/metrics/KafkaMetric.java   |  18 +--
 .../org/apache/kafka/common/metrics/Metrics.java   |  58 +++----
 .../org/apache/kafka/common/metrics/Sensor.java    |  51 ++----
 .../kafka/common/metrics/stats/Percentile.java     |  18 +--
 .../kafka/common/metrics/stats/Percentiles.java    |   2 +-
 .../org/apache/kafka/common/network/Selector.java  |  93 +++++++----
 .../kafka/clients/producer/BufferPoolTest.java     |  14 +-
 .../clients/producer/RecordAccumulatorTest.java    |  16 +-
 .../apache/kafka/clients/producer/SenderTest.java  |  11 +-
 .../kafka/common/metrics/JmxReporterTest.java      |  13 +-
 .../apache/kafka/common/metrics/MetricsTest.java   |  87 ++++++----
 .../apache/kafka/common/network/SelectorTest.java  |   3 +-
 .../java/org/apache/kafka/test/MetricsBench.java   |  11 +-
 27 files changed, 533 insertions(+), 300 deletions(-)
828b808f98afcd0c670d144af07dc14fcf743edc

 .../kafka/clients/producer/MockProducer.java       |  6 ++---
 .../kafka/clients/tools/ProducerPerformance.java   |  4 ++--
 .../kafka/clients/producer/MockProducerTest.java   |  9 +++-----
 .../kafka/clients/producer/PartitionerTest.java    | 27 ++++++++++------------
 .../kafka/api/ProducerFailureHandlingTest.scala    |  2 +-
 5 files changed, 21 insertions(+), 27 deletions(-)
6f4dea9dbce5cc9f69a917182981b41a56a98a85

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java    | 2 +-
 .../java/org/apache/kafka/clients/producer/MockProducerTest.java | 9 +++------
 core/src/main/scala/kafka/tools/MirrorMaker.scala                | 2 +-
 3 files changed, 5 insertions(+), 8 deletions(-)
8d5d459049b495d8196ed29ff6c760cb04699914

 core/src/main/scala/kafka/log/LogCleaner.scala     | 11 +++-
 .../main/scala/kafka/log/LogCleanerManager.scala   | 17 ++++--
 core/src/main/scala/kafka/log/LogManager.scala     |  9 ++-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 64 +++++++++++++++++++++-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala | 14 +++++
 5 files changed, 103 insertions(+), 12 deletions(-)
14779dddb6a9bb3aefbaa825a62874f89bb47d2c

 core/src/main/scala/kafka/log/LogCleaner.scala     | 11 +++-
 .../main/scala/kafka/log/LogCleanerManager.scala   | 17 ++++--
 core/src/main/scala/kafka/log/LogManager.scala     |  9 ++-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 64 +++++++++++++++++++++-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala | 14 +++++
 5 files changed, 103 insertions(+), 12 deletions(-)
ad4883a0cd5afc4219e28cdafbd98576eeaee2d1

 .../kafka/clients/producer/internals/Metadata.java | 13 ++++---
 .../kafka/clients/producer/MetadataTest.java       | 41 ++++++++++++++++++----
 2 files changed, 43 insertions(+), 11 deletions(-)
b1b80860a01cc378cfada3549a3480f0773c3ff8

 .../kafka/common/GenerateBrokerIdException.scala   |  27 +++
 .../common/InconsistentBrokerIdException.scala     |  27 +++
 .../scala/kafka/log/LogCleanerManager.scala.orig   | 203 +++++++++++++++++++++
 .../kafka/server/BrokerMetadataCheckpoint.scala    |  83 +++++++++
 core/src/main/scala/kafka/server/KafkaConfig.scala |  20 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  87 +++++++--
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  38 +++-
 .../kafka/server/ServerGenerateBrokerIdTest.scala  | 127 +++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   9 +-
 9 files changed, 596 insertions(+), 25 deletions(-)
e52a6181bf0969f315ac0f0d325eac34d2b4a6ee

 core/src/main/scala/kafka/server/KafkaApis.scala             | 6 +++++-
 core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala | 9 ++++++++-
 2 files changed, 13 insertions(+), 2 deletions(-)
f88db16d15ff8a1883b7aed3c60eefa64faa764c

 core/src/main/scala/kafka/server/KafkaApis.scala             | 6 +++++-
 core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala | 9 ++++++++-
 2 files changed, 13 insertions(+), 2 deletions(-)
a93ef199b2375c422e35d82ac7aa3a2fdacc1e74

 .../org/apache/kafka/common/serialization/StringDeserializer.java    | 5 ++++-
 .../java/org/apache/kafka/common/serialization/StringSerializer.java | 5 ++++-
 .../org/apache/kafka/common/serialization/SerializationTest.java     | 4 +++-
 3 files changed, 11 insertions(+), 3 deletions(-)
f71933ef103dc6af70152cf9915f27a9e4c1128f

 .../org/apache/kafka/common/serialization/StringDeserializer.java    | 5 ++++-
 .../java/org/apache/kafka/common/serialization/StringSerializer.java | 5 ++++-
 .../org/apache/kafka/common/serialization/SerializationTest.java     | 4 +++-
 3 files changed, 11 insertions(+), 3 deletions(-)
f82518a85001307334132056fe32c28b452cf48b

 .../main/scala/kafka/network/SocketServer.scala    |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 .../unit/kafka/network/SocketServerTest.scala      | 45 ++++++++++++++++------
 3 files changed, 36 insertions(+), 14 deletions(-)
367ee76c08ecac376198bf1dc05820589055641b

 .../main/scala/kafka/network/SocketServer.scala    |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 .../unit/kafka/network/SocketServerTest.scala      | 40 ++++++++++++++++------
 3 files changed, 33 insertions(+), 12 deletions(-)
fec9f32dafaaada396a045569c20e625e2a114e3

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java     | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
517503db2616531b08ee4d08d39c0e1c0bd19e97

 .../java/org/apache/kafka/clients/producer/KafkaProducer.java     | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
50b734690a93e58030f69cede8d0a84d1e3f5461

 build.gradle                                       |  1 +
 .../clients/consumer/ByteArrayDeserializer.java    | 34 -----------
 .../kafka/clients/consumer/ConsumerConfig.java     |  4 +-
 .../kafka/clients/consumer/Deserializer.java       | 38 ------------
 .../kafka/clients/consumer/KafkaConsumer.java      | 37 ++++++++++--
 .../clients/producer/ByteArraySerializer.java      | 34 -----------
 .../kafka/clients/producer/KafkaProducer.java      | 59 +++++++++++++++----
 .../kafka/clients/producer/ProducerConfig.java     |  4 +-
 .../apache/kafka/clients/producer/Serializer.java  | 38 ------------
 .../apache/kafka/common/config/AbstractConfig.java | 13 +++--
 .../common/errors/DeserializationException.java    | 47 ---------------
 .../serialization/ByteArrayDeserializer.java       | 34 +++++++++++
 .../common/serialization/ByteArraySerializer.java  | 34 +++++++++++
 .../kafka/common/serialization/Deserializer.java   | 45 ++++++++++++++
 .../kafka/common/serialization/Serializer.java     | 44 ++++++++++++++
 .../common/serialization/StringDeserializer.java   | 50 ++++++++++++++++
 .../common/serialization/StringSerializer.java     | 50 ++++++++++++++++
 .../common/serialization/SerializationTest.java    | 68 ++++++++++++++++++++++
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  2 +
 .../main/scala/kafka/tools/ConsoleProducer.scala   |  2 +
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 10 ++--
 .../scala/kafka/tools/ProducerPerformance.scala    |  2 +
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  2 +
 .../scala/kafka/tools/TestEndToEndLatency.scala    |  2 +
 .../main/scala/kafka/tools/TestLogCleaning.scala   |  2 +
 .../kafka/api/ProducerCompressionTest.scala        |  2 +
 .../integration/kafka/api/ProducerSendTest.scala   | 53 +++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +
 28 files changed, 492 insertions(+), 221 deletions(-)
f32e5ce247eb07ce33cfcb876771293e8a2eacdc

 build.gradle                                       |  1 +
 .../clients/consumer/ByteArrayDeserializer.java    | 34 -----------
 .../kafka/clients/consumer/ConsumerConfig.java     |  4 +-
 .../kafka/clients/consumer/Deserializer.java       | 38 ------------
 .../kafka/clients/consumer/KafkaConsumer.java      | 37 ++++++++++--
 .../clients/producer/ByteArraySerializer.java      | 34 -----------
 .../kafka/clients/producer/KafkaProducer.java      | 59 +++++++++++++++----
 .../kafka/clients/producer/ProducerConfig.java     |  4 +-
 .../apache/kafka/clients/producer/Serializer.java  | 38 ------------
 .../apache/kafka/common/config/AbstractConfig.java | 13 +++--
 .../common/errors/DeserializationException.java    | 47 ---------------
 .../serialization/ByteArrayDeserializer.java       | 34 +++++++++++
 .../common/serialization/ByteArraySerializer.java  | 34 +++++++++++
 .../kafka/common/serialization/Deserializer.java   | 45 ++++++++++++++
 .../kafka/common/serialization/Serializer.java     | 45 ++++++++++++++
 .../common/serialization/StringDeserializer.java   | 50 ++++++++++++++++
 .../common/serialization/StringSerializer.java     | 50 ++++++++++++++++
 .../common/serialization/SerializationTest.java    | 68 ++++++++++++++++++++++
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  2 +
 .../main/scala/kafka/tools/ConsoleProducer.scala   |  2 +
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  7 ++-
 .../scala/kafka/tools/ProducerPerformance.scala    |  2 +
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  2 +
 .../scala/kafka/tools/TestEndToEndLatency.scala    |  2 +
 .../main/scala/kafka/tools/TestLogCleaning.scala   |  2 +
 .../kafka/api/ProducerCompressionTest.scala        |  2 +
 .../integration/kafka/api/ProducerSendTest.scala   | 53 +++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +
 28 files changed, 492 insertions(+), 219 deletions(-)
4471dc08b64809f3cdcbff6b8c830e13df87b117

 .../java/org/apache/kafka/clients/NetworkClient.java    | 17 ++++++++++++++---
 1 file changed, 14 insertions(+), 3 deletions(-)
53329583a871ac2027c21979a81dbe0e3bbed4ff

 .../java/org/apache/kafka/clients/NetworkClient.java    | 17 ++++++++++++++---
 1 file changed, 14 insertions(+), 3 deletions(-)
79d16dc36d005bcdab2fe6d8fef31540821785ea

 bin/kafka-run-class.sh          |  2 +-
 bin/windows/kafka-run-class.bat |  2 +-
 build.gradle                    | 14 +++++++-------
 gradle.properties               |  2 +-
 scala.gradle                    |  4 ++--
 5 files changed, 12 insertions(+), 12 deletions(-)
10c6dec34dae8820bf7ce24839c938135f9a9189

 .../scala/kafka/consumer/ConsumerConnector.scala   |  15 +
 .../consumer/ZookeeperConsumerConnector.scala      |  56 ++--
 .../consumer/ZookeeperConsumerConnector.scala      |   9 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 335 ++++++++++++---------
 .../main/scala/kafka/utils/DoublyLinkedList.scala  | 126 ++++++++
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  50 +++
 6 files changed, 423 insertions(+), 168 deletions(-)
84521872d18dd90aff6eb47d470893f64749783f

 core/src/main/scala/kafka/tools/ConsoleProducer.scala | 10 ++++------
 1 file changed, 4 insertions(+), 6 deletions(-)
92d1d4cd31e1045f0e000e8d2d777c73f7529743

 .../clients/consumer/ByteArrayDeserializer.java    |  34 ++++++
 .../apache/kafka/clients/consumer/Consumer.java    |   4 +-
 .../kafka/clients/consumer/ConsumerConfig.java     |  14 ++-
 .../consumer/ConsumerRebalanceCallback.java        |   4 +-
 .../kafka/clients/consumer/ConsumerRecord.java     |  16 +--
 .../kafka/clients/consumer/ConsumerRecords.java    |  14 +--
 .../kafka/clients/consumer/Deserializer.java       |  38 +++++++
 .../kafka/clients/consumer/KafkaConsumer.java      | 124 +++++++++++++--------
 .../kafka/clients/consumer/MockConsumer.java       |   6 +-
 .../clients/producer/ByteArraySerializer.java      |  34 ++++++
 .../kafka/clients/producer/KafkaProducer.java      |  76 ++++++++++---
 .../kafka/clients/producer/MockProducer.java       |  14 +--
 .../apache/kafka/clients/producer/Producer.java    |   6 +-
 .../kafka/clients/producer/ProducerConfig.java     |  15 ++-
 .../kafka/clients/producer/ProducerRecord.java     |  20 ++--
 .../apache/kafka/clients/producer/Serializer.java  |  38 +++++++
 .../clients/producer/internals/Partitioner.java    |   2 +-
 .../kafka/clients/tools/ProducerPerformance.java   |   4 +-
 .../common/errors/DeserializationException.java    |  47 ++++++++
 .../common/errors/SerializationException.java      |  46 ++++++++
 .../kafka/clients/producer/MockProducerTest.java   |   6 +-
 .../kafka/clients/producer/PartitionerTest.java    |  12 +-
 .../main/scala/kafka/producer/BaseProducer.scala   |   4 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |   6 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |   3 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   4 +-
 .../scala/kafka/tools/TestEndToEndLatency.scala    |   4 +-
 .../main/scala/kafka/tools/TestLogCleaning.scala   |   6 +-
 .../kafka/api/ProducerCompressionTest.scala        |   4 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |  32 +++---
 .../integration/kafka/api/ProducerSendTest.scala   |  16 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   4 +-
 32 files changed, 499 insertions(+), 158 deletions(-)
03ad248226a4ffc7236ac4ffeeb3a4d125d92efe

 .../clients/consumer/ByteArrayDeserializer.java    |  34 ++++++
 .../apache/kafka/clients/consumer/Consumer.java    |   4 +-
 .../kafka/clients/consumer/ConsumerConfig.java     |  14 ++-
 .../consumer/ConsumerRebalanceCallback.java        |   4 +-
 .../kafka/clients/consumer/ConsumerRecord.java     |  16 +--
 .../kafka/clients/consumer/ConsumerRecords.java    |  14 +--
 .../kafka/clients/consumer/Deserializer.java       |  38 +++++++
 .../kafka/clients/consumer/KafkaConsumer.java      | 122 +++++++++++++--------
 .../kafka/clients/consumer/MockConsumer.java       |   6 +-
 .../clients/producer/ByteArraySerializer.java      |  34 ++++++
 .../kafka/clients/producer/KafkaProducer.java      |  68 ++++++++++--
 .../apache/kafka/clients/producer/Producer.java    |   6 +-
 .../kafka/clients/producer/ProducerConfig.java     |  15 ++-
 .../kafka/clients/producer/ProducerRecord.java     |  20 ++--
 .../apache/kafka/clients/producer/Serializer.java  |  38 +++++++
 .../clients/producer/internals/Partitioner.java    |   2 +-
 .../common/errors/DeserializationException.java    |  47 ++++++++
 .../common/errors/SerializationException.java      |  46 ++++++++
 .../main/scala/kafka/producer/BaseProducer.scala   |   4 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |   6 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  21 ++--
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   4 +-
 .../scala/kafka/tools/TestEndToEndLatency.scala    |   4 +-
 .../main/scala/kafka/tools/TestLogCleaning.scala   |   6 +-
 .../kafka/api/ProducerCompressionTest.scala        |   4 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |  32 +++---
 .../integration/kafka/api/ProducerSendTest.scala   |  16 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   4 +-
 28 files changed, 484 insertions(+), 145 deletions(-)
ae0bb84fa7e599774cd984196dc62b3dc84b13ca

 core/src/main/scala/kafka/log/Log.scala          | 22 ++++++-
 core/src/main/scala/kafka/log/LogManager.scala   |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala | 75 ++++++++++++++++++++++++
 3 files changed, 95 insertions(+), 4 deletions(-)
523b36589e942cb99a95debd2c45e795ae533d08

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
0ef631bc694d0c6071450c43501ca319a58859f4

 .../unit/kafka/consumer/ZookeeperConsumerConnectorTest.scala |  3 ++-
 .../test/scala/unit/kafka/server/ServerShutdownTest.scala    | 12 ++++++++++--
 2 files changed, 12 insertions(+), 3 deletions(-)
e8ffbd0fee0bc715ad0fe6c9afe85715f84d8e51

 core/src/main/scala/kafka/utils/Utils.scala        | 105 +++++++++++----------
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  36 +++++++
 2 files changed, 91 insertions(+), 50 deletions(-)
2801629964882015a9148e1c0ade22da46376faa

 .../consumer/ZookeeperConsumerConnector.scala      |  47 ++-
 .../consumer/ConsumerRebalanceListener.java        |  42 +++
 .../consumer/ZookeeperConsumerConnector.scala      |   4 +
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 414 +++++++++++++++++----
 .../kafka/utils/ByteBoundedBlockingQueue.scala     |  11 +
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  60 ++-
 6 files changed, 493 insertions(+), 85 deletions(-)
4fc74958e3569f6179c11fddace99b674c81f370

 .../apache/kafka/clients/tools/ProducerPerformance.java  | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)
09e2fd651e0a98a96107f0ee1087c785a54b4e20

 .gitignore        |   7 ++-
 README.md         |   4 ++
 Vagrantfile       | 168 ++++++++++++++++++++++++++++++++++++++++++++++++++++++
 vagrant/README.md | 126 ++++++++++++++++++++++++++++++++++++++++
 vagrant/base.sh   |  43 ++++++++++++++
 vagrant/broker.sh |  38 ++++++++++++
 vagrant/zk.sh     |  42 ++++++++++++++
 7 files changed, 427 insertions(+), 1 deletion(-)
3cc10d5ff9bf73cff2045685f89d71fee92a41f4

 core/src/main/scala/kafka/cluster/Partition.scala  |  14 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |  10 +-
 .../main/scala/kafka/server/DelayedOperation.scala | 316 ++++++++++++++++++++
 .../scala/kafka/server/DelayedOperationKey.scala   |  38 +++
 .../main/scala/kafka/server/DelayedProduce.scala   |  14 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  42 +--
 .../main/scala/kafka/server/RequestPurgatory.scala | 317 ---------------------
 .../unit/kafka/server/DelayedOperationTest.scala   | 124 ++++++++
 .../unit/kafka/server/RequestPurgatoryTest.scala   | 124 --------
 system_test/metrics.json                           |   4 +-
 10 files changed, 520 insertions(+), 483 deletions(-)
7e9368baf2e1cd457293b815a665e5d3e4418dfb

 core/src/main/scala/kafka/log/LogConfig.scala | 7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)
15f9e2762d32a0345a5ca13a1e981be646856b41

 config/log4j.properties | 2 --
 1 file changed, 2 deletions(-)
723fa4c40d2d04a8557ef9a0ae1626e56f30a9a3

 .../scala/unit/kafka/server/ServerShutdownTest.scala     | 14 ++++++++++++++
 .../test/scala/unit/kafka/server/ServerStartupTest.scala | 16 ++++++++++++++--
 2 files changed, 28 insertions(+), 2 deletions(-)
b24f9c0890302a5149aaaf26dc933bd0a842f1be

 .../main/java/org/apache/kafka/common/config/ConfigDef.java    | 10 ++++++++--
 .../java/org/apache/kafka/common/config/ConfigDefTest.java     |  9 ++++++++-
 2 files changed, 16 insertions(+), 3 deletions(-)
bd212b7a90deaf7f565d620e1aaf9a137f9a0796

 .../apache/kafka/common/config/AbstractConfig.java |   7 +-
 .../kafka/common/config/AbstractConfigTest.java    | 100 +++++++++++++++++++++
 2 files changed, 106 insertions(+), 1 deletion(-)
74bc8860c3c3d582f88581fc7d9edffdfa2dc3a5

 .../kafka/common/config/AbstractConfigTest.java    | 100 +++++++++++++++++++++
 1 file changed, 100 insertions(+)
8a719e037201e343e22a3d2479651e781ddaccc1

 .../main/java/org/apache/kafka/common/config/AbstractConfig.java   | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
4408f487ae911e29dbc6ef4d94010a6fad702109

 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
834b6419806750ff555e8ffd104caa420004e84e

 .../org/apache/kafka/common/config/ConfigDef.java  |   9 ++
 core/src/main/scala/kafka/admin/TopicCommand.scala |   2 +-
 core/src/main/scala/kafka/log/LogConfig.scala      | 144 ++++++++++++---------
 core/src/main/scala/kafka/utils/Utils.scala        |  26 ++++
 core/src/test/scala/kafka/log/LogConfigTest.scala  |  93 +++++++++++++
 .../integration/UncleanLeaderElectionTest.scala    |   4 +-
 6 files changed, 218 insertions(+), 60 deletions(-)
9f8b8dad2b7ad31c9595f559f6d9e7d07d2f696d

 core/src/main/scala/kafka/admin/AdminUtils.scala   | 21 ++++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  5 ++
 .../main/scala/kafka/server/OffsetManager.scala    | 13 ++--
 .../main/scala/kafka/server/ReplicaManager.scala   | 88 ++++++++++++----------
 .../kafka/api/ProducerFailureHandlingTest.scala    | 23 +++---
 5 files changed, 87 insertions(+), 63 deletions(-)
72601f783e24217734a3923c6318e12a0f600d0f

 bin/kafka-run-class.sh          |  2 +-
 bin/windows/kafka-run-class.bat |  2 +-
 build.gradle                    | 14 +++++++-------
 gradle.properties               |  2 +-
 scala.gradle                    |  4 ++--
 5 files changed, 12 insertions(+), 12 deletions(-)
409c367ceb5f9eae395cb346dd3fa02b8ee8ee70

 bin/kafka-server-start.sh                          |   2 +-
 core/src/main/scala/kafka/Kafka.scala              |  38 +++++--
 .../test/scala/unit/kafka/KafkaConfigTest.scala    | 120 +++++++++++++++++++++
 3 files changed, 150 insertions(+), 10 deletions(-)
f0fd70929a1ad607aa1fbf6ed9b40b16ab95b807

 .../main/scala/kafka/common/UnknownTopicOrPartitionException.scala    | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
457744a820d806e546edebbd8ffd33f6772e519f

 build.gradle                                       |   6 +
 core/src/main/scala/kafka/cluster/Partition.scala  |  13 +-
 core/src/main/scala/kafka/common/AppInfo.scala     |  66 ++++++++++
 .../scala/kafka/common/ClientIdAndBroker.scala     |  14 ++-
 .../main/scala/kafka/common/ClientIdAndTopic.scala |  14 ++-
 .../kafka/consumer/ConsumerFetcherThread.scala     |   2 +-
 .../scala/kafka/consumer/ConsumerTopicStats.scala  |  17 ++-
 .../consumer/FetchRequestAndResponseStats.scala    |  28 +++--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   5 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  37 +++---
 core/src/main/scala/kafka/log/Log.scala            |  38 ++++--
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    | 135 ++++++++++++---------
 .../main/scala/kafka/network/RequestChannel.scala  |  27 +++--
 .../main/scala/kafka/network/SocketServer.scala    |   2 +-
 core/src/main/scala/kafka/producer/Producer.scala  |   3 +-
 .../kafka/producer/ProducerRequestStats.scala      |  23 ++--
 .../main/scala/kafka/producer/ProducerStats.scala  |   7 +-
 .../scala/kafka/producer/ProducerTopicStats.scala  |  23 ++--
 .../main/scala/kafka/producer/SyncProducer.scala   |  12 +-
 .../kafka/producer/async/ProducerSendThread.scala  |   5 +-
 .../kafka/server/AbstractFetcherManager.scala      |  31 ++---
 .../scala/kafka/server/AbstractFetcherThread.scala |  36 +++---
 .../src/main/scala/kafka/server/DelayedFetch.scala |   1 -
 .../main/scala/kafka/server/DelayedProduce.scala   |   4 +-
 .../scala/kafka/server/DelayedRequestKey.scala     |  38 ------
 .../scala/kafka/server/KafkaRequestHandler.scala   |  25 ++--
 core/src/main/scala/kafka/server/KafkaServer.scala |   1 -
 .../scala/kafka/server/KafkaServerStartable.scala  |   2 +
 .../main/scala/kafka/server/ReplicaManager.scala   |  15 ++-
 .../scala/kafka/tools/ProducerPerformance.scala    |   1 -
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 101 +++------------
 .../scala/unit/kafka/metrics/MetricsTest.scala     |  72 +++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  74 ++++++++++-
 33 files changed, 540 insertions(+), 338 deletions(-)
1c7d783dd648d0e691ad80cb1357c52d3f0af11a

 core/src/main/scala/kafka/consumer/ConsumerConnector.scala    |  7 ++++++-
 .../scala/kafka/consumer/ZookeeperConsumerConnector.scala     | 11 ++++++++---
 .../kafka/javaapi/consumer/ZookeeperConsumerConnector.scala   |  2 +-
 .../unit/kafka/consumer/ZookeeperConsumerConnectorTest.scala  |  4 ++--
 4 files changed, 17 insertions(+), 7 deletions(-)
fbecd489cd469c102aa42cc12fef58bb8596c92a

 core/src/main/scala/kafka/consumer/ConsumerConnector.scala    |  7 ++++++-
 .../scala/kafka/consumer/ZookeeperConsumerConnector.scala     | 11 ++++++++---
 .../kafka/javaapi/consumer/ZookeeperConsumerConnector.scala   |  2 +-
 .../unit/kafka/consumer/ZookeeperConsumerConnectorTest.scala  |  4 ++--
 4 files changed, 17 insertions(+), 7 deletions(-)
6f4b8a10115a7373917cf2a55b74aa8a14c547b9

 build.gradle | 6 ++++++
 1 file changed, 6 insertions(+)
00dfa89260a3ddc7809b4626176114622a42024c

 build.gradle | 6 ++++++
 1 file changed, 6 insertions(+)
117a02de06bab60e179345d6cd82d56e5b725189

 build.gradle                                       |   6 +
 core/src/main/scala/kafka/cluster/Partition.scala  |  13 +-
 core/src/main/scala/kafka/common/AppInfo.scala     |  66 ++++++++++
 .../scala/kafka/common/ClientIdAndBroker.scala     |  14 ++-
 .../main/scala/kafka/common/ClientIdAndTopic.scala |  14 ++-
 .../kafka/consumer/ConsumerFetcherThread.scala     |   2 +-
 .../scala/kafka/consumer/ConsumerTopicStats.scala  |  17 ++-
 .../consumer/FetchRequestAndResponseStats.scala    |  28 +++--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   5 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  37 +++---
 core/src/main/scala/kafka/log/Log.scala            |  38 ++++--
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    | 135 ++++++++++++---------
 .../main/scala/kafka/network/RequestChannel.scala  |  27 +++--
 .../main/scala/kafka/network/SocketServer.scala    |   2 +-
 core/src/main/scala/kafka/producer/Producer.scala  |   3 +-
 .../kafka/producer/ProducerRequestStats.scala      |  23 ++--
 .../main/scala/kafka/producer/ProducerStats.scala  |   7 +-
 .../scala/kafka/producer/ProducerTopicStats.scala  |  23 ++--
 .../main/scala/kafka/producer/SyncProducer.scala   |  12 +-
 .../kafka/producer/async/ProducerSendThread.scala  |   5 +-
 .../kafka/server/AbstractFetcherManager.scala      |  31 ++---
 .../scala/kafka/server/AbstractFetcherThread.scala |  36 +++---
 .../src/main/scala/kafka/server/DelayedFetch.scala |   2 +-
 .../main/scala/kafka/server/DelayedProduce.scala   |   2 +-
 .../scala/kafka/server/DelayedRequestKey.scala     |  38 ------
 core/src/main/scala/kafka/server/KafkaApis.scala   |   7 +-
 .../scala/kafka/server/KafkaRequestHandler.scala   |  25 ++--
 core/src/main/scala/kafka/server/KafkaServer.scala |   1 -
 .../scala/kafka/server/KafkaServerStartable.scala  |   2 +
 .../kafka/server/ProducerRequestPurgatory.scala    |  22 ++--
 .../main/scala/kafka/server/ReplicaManager.scala   |   8 +-
 .../scala/kafka/tools/ProducerPerformance.scala    |   1 -
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 101 +++------------
 .../scala/unit/kafka/metrics/MetricsTest.scala     |  72 +++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  74 ++++++++++-
 35 files changed, 555 insertions(+), 344 deletions(-)
7e1907e32bfc3f88cc311aa474fe360c72dfa4ef

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
26ad54c109db9eca01df926255017ece3eb65645

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8bd57381c4f000565881028582a6a1b2a3a07d4d

 .../kafka/clients/ClusterConnectionStates.java     | 21 +++++++
 .../java/org/apache/kafka/clients/KafkaClient.java | 10 ++++
 .../org/apache/kafka/clients/NetworkClient.java    | 13 +++++
 .../producer/internals/RecordAccumulator.java      | 18 ++++--
 .../kafka/clients/producer/internals/Sender.java   | 13 ++++-
 .../java/org/apache/kafka/clients/MockClient.java  |  5 ++
 .../clients/producer/RecordAccumulatorTest.java    | 64 ++++++++++++++++++----
 7 files changed, 124 insertions(+), 20 deletions(-)
7d89867c05a7cca6e76cc48c47f8e703d68a9a43

 .../kafka/clients/ClusterConnectionStates.java     | 21 +++++++
 .../java/org/apache/kafka/clients/KafkaClient.java | 10 ++++
 .../org/apache/kafka/clients/NetworkClient.java    | 13 +++++
 .../producer/internals/RecordAccumulator.java      | 18 ++++--
 .../kafka/clients/producer/internals/Sender.java   | 13 ++++-
 .../java/org/apache/kafka/clients/MockClient.java  |  5 ++
 .../clients/producer/RecordAccumulatorTest.java    | 64 ++++++++++++++++++----
 7 files changed, 124 insertions(+), 20 deletions(-)
de6d4e4f00aae019df8171ed79c95605c73e4af5

 core/src/main/scala/kafka/consumer/ConsumerIterator.scala           | 1 -
 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 2 +-
 core/src/test/scala/unit/kafka/consumer/ConsumerIteratorTest.scala  | 2 +-
 3 files changed, 2 insertions(+), 3 deletions(-)
ca2cf97a6b151566f091a5dd016b93dfdaf87628

 core/src/main/scala/kafka/consumer/ConsumerIterator.scala           | 1 -
 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 2 +-
 core/src/test/scala/unit/kafka/consumer/ConsumerIteratorTest.scala  | 2 +-
 3 files changed, 2 insertions(+), 3 deletions(-)
8c35030e4d24e603e5dbd53862ca6ae4fe59b4e9

 core/src/main/scala/kafka/consumer/ConsumerIterator.scala           | 1 +
 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)
d99af88eafefbfd1c537a64f8107cd9041346015

 core/src/main/scala/kafka/consumer/ConsumerIterator.scala           | 1 -
 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 2 +-
 2 files changed, 1 insertion(+), 2 deletions(-)
91f8ce7eff5c62c619454ad9d67415878805f600

 core/src/main/scala/kafka/network/BlockingChannel.scala | 11 +++++++----
 core/src/main/scala/kafka/producer/SyncProducer.scala   |  2 +-
 2 files changed, 8 insertions(+), 5 deletions(-)
2cd9ae74544efe049393e1a6bf60533aea956d7d

 .../main/java/org/apache/kafka/clients/producer/ProducerConfig.java   | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
383ac3e198d6af6f3eb40ab7a42fc73f2f1b4a36

 core/src/main/scala/kafka/controller/KafkaController.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
53160bb07c9f77ed21f486ed448aff0277c139b0

 core/src/main/scala/kafka/controller/KafkaController.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
9b3da9fbfd60e3a0482ec7bd615dc9806cd9941c

 .../test/scala/unit/kafka/message/MessageCompressionTest.scala   | 9 ---------
 1 file changed, 9 deletions(-)
f20e5108a271e1fc37ca6752773efa74e2fef67f

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
80eb04f994963c1c6b5e3f0e8742b81ff140fc65

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
cbdcd5f108d783e9d0e758fbf0d8479968db3a68

 system_test/mirror_maker_testsuite/mirror_maker_test.py           | 1 +
 system_test/offset_management_testsuite/offset_management_test.py | 1 +
 system_test/replication_testsuite/replica_basic_test.py           | 2 ++
 system_test/system_test_runner.py                                 | 2 +-
 system_test/utils/kafka_system_test_utils.py                      | 3 +++
 5 files changed, 8 insertions(+), 1 deletion(-)
06e1a6552e2c1de08c185359f3114eb12e61cfae

 system_test/utils/testcase_env.py | 117 +++++++++++++++++++-------------------
 1 file changed, 58 insertions(+), 59 deletions(-)
4bb020212aa0260a750b69dc18856cf25c1e7011

 .../kafka/utils/ByteBoundedBlockingQueue.scala     | 219 +++++++++++++++++++++
 .../kafka/utils/ByteBoundedBlockingQueueTest.scala |  99 ++++++++++
 2 files changed, 318 insertions(+)
58e3f99e244d6c4b9ad4166cc5fcf75561d87dab

 core/src/main/scala/kafka/network/BlockingChannel.scala | 11 +++++++----
 core/src/main/scala/kafka/producer/SyncProducer.scala   |  2 +-
 2 files changed, 8 insertions(+), 5 deletions(-)
2ec356fa903bc65026bef9f6c1b35dd182dbe48d

 core/src/main/scala/kafka/server/ReplicaManager.scala | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)
1ed9cf6d03603518d950f7e9a5f122c4ed5d7cee

 core/src/main/scala/kafka/server/ReplicaManager.scala | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)
89831204c092f3a417bf41945925a2e9a0ec828e

 core/src/main/scala/kafka/api/FetchRequest.scala   |   1 -
 core/src/main/scala/kafka/api/FetchResponse.scala  |  12 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |  24 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   1 -
 .../main/scala/kafka/api/ProducerResponse.scala    |   3 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  50 ++-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   2 +
 core/src/main/scala/kafka/log/Log.scala            |  26 +-
 .../kafka/network/BoundedByteBufferSend.scala      |   4 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala | 125 ++++---
 .../main/scala/kafka/server/DelayedProduce.scala   | 135 ++++----
 .../scala/kafka/server/FetchRequestPurgatory.scala |  69 ----
 core/src/main/scala/kafka/server/KafkaApis.scala   | 325 ++++++------------
 .../main/scala/kafka/server/OffsetManager.scala    |  93 +++++-
 .../kafka/server/ProducerRequestPurgatory.scala    |  69 ----
 .../main/scala/kafka/server/ReplicaManager.scala   | 370 ++++++++++++++-------
 .../main/scala/kafka/server/RequestPurgatory.scala | 336 +++++++++----------
 core/src/main/scala/kafka/utils/DelayedItem.scala  |   8 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |  18 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |   4 +-
 .../server/HighwatermarkPersistenceTest.scala      |   7 +
 .../unit/kafka/server/ISRExpirationTest.scala      |  17 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |   6 +
 .../unit/kafka/server/RequestPurgatoryTest.scala   | 103 +++---
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  | 270 +++++----------
 26 files changed, 1006 insertions(+), 1074 deletions(-)
9be9a80d0c794efb0be9a23908b286e1650f6a95

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
20f5b01feacd1e95d558073b7be511cb82888b3e

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
5e071cd2502fec73cd1b060dae7995eeb2d52465

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 74 +++++++++++++++--------
 1 file changed, 48 insertions(+), 26 deletions(-)
43cb192b59ab676d35c38f9144fbc98a954a11d3

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 74 +++++++++++++++--------
 1 file changed, 48 insertions(+), 26 deletions(-)
a75a295437d8ba41bf52f596f670d51330773c41

 .../testcase_15001/testcase_15001_properties.json  | 158 ++++++++++++++++++
 .../testcase_15002/testcase_15002_properties.json  | 158 ++++++++++++++++++
 .../testcase_15003/testcase_15003_properties.json  | 156 ++++++++++++++++++
 .../testcase_15004/testcase_15004_properties.json  | 156 ++++++++++++++++++
 .../testcase_15005/testcase_15005_properties.json  | 178 +++++++++++++++++++++
 .../testcase_15006/testcase_15006_properties.json  | 178 +++++++++++++++++++++
 .../testcase_10101/testcase_10101_properties.json  |  86 ++++++++++
 .../testcase_10102/testcase_10102_properties.json  |  86 ++++++++++
 .../testcase_10103/testcase_10103_properties.json  |  86 ++++++++++
 .../testcase_10104/testcase_10104_properties.json  |  86 ++++++++++
 .../testcase_10105/testcase_10105_properties.json  |  86 ++++++++++
 .../testcase_10106/testcase_10106_properties.json  |  86 ++++++++++
 .../testcase_10107/testcase_10107_properties.json  |  86 ++++++++++
 .../testcase_10108/testcase_10108_properties.json  |  86 ++++++++++
 .../testcase_10109/testcase_10109_properties.json  |  86 ++++++++++
 .../testcase_10110/testcase_10110_properties.json  |  86 ++++++++++
 .../testcase_10131/testcase_10131_properties.json  | 110 +++++++++++++
 .../testcase_10132/testcase_10132_properties.json  | 107 +++++++++++++
 .../testcase_10133/testcase_10133_properties.json  | 107 +++++++++++++
 .../testcase_10134/testcase_10134_properties.json  |  92 +++++++++++
 20 files changed, 2260 insertions(+)
caf4787e505a637d5a643eccba0aa3d5c6b965d7

 .../testcase_15001/testcase_5001_properties.json   | 158 ------------------
 .../testcase_15002/testcase_5002_properties.json   | 158 ------------------
 .../testcase_15003/testcase_5003_properties.json   | 156 ------------------
 .../testcase_15004/testcase_5004_properties.json   | 156 ------------------
 .../testcase_15005/testcase_5005_properties.json   | 178 ---------------------
 .../testcase_15006/testcase_5006_properties.json   | 178 ---------------------
 .../testcase_0001/testcase_0001_properties.json    |   2 +-
 .../testcase_10101/testcase_0101_properties.json   |  86 ----------
 .../testcase_10102/testcase_0102_properties.json   |  86 ----------
 .../testcase_10103/testcase_0103_properties.json   |  86 ----------
 .../testcase_10104/testcase_0104_properties.json   |  86 ----------
 .../testcase_10105/testcase_0105_properties.json   |  86 ----------
 .../testcase_10106/testcase_0106_properties.json   |  86 ----------
 .../testcase_10107/testcase_0107_properties.json   |  86 ----------
 .../testcase_10108/testcase_0108_properties.json   |  86 ----------
 .../testcase_10109/testcase_0109_properties.json   |  86 ----------
 .../testcase_10110/testcase_0110_properties.json   |  86 ----------
 .../testcase_10131/testcase_0131_properties.json   | 110 -------------
 .../testcase_10132/testcase_0132_properties.json   | 107 -------------
 .../testcase_10133/testcase_0133_properties.json   | 107 -------------
 .../testcase_10134/testcase_0134_properties.json   |  92 -----------
 system_test/utils/metrics.py                       |   2 +
 22 files changed, 3 insertions(+), 2261 deletions(-)
12ce4b1e1e0e6ec7fd3585baf3ed531ecc16a5d9

 .../testcase_15001/testcase_15001_properties.json  | 158 ++++++++++++++++++
 .../testcase_15001/testcase_5001_properties.json   | 158 ------------------
 .../testcase_15002/testcase_15002_properties.json  | 158 ++++++++++++++++++
 .../testcase_15002/testcase_5002_properties.json   | 158 ------------------
 .../testcase_15003/testcase_15003_properties.json  | 156 ++++++++++++++++++
 .../testcase_15003/testcase_5003_properties.json   | 156 ------------------
 .../testcase_15004/testcase_15004_properties.json  | 156 ++++++++++++++++++
 .../testcase_15004/testcase_5004_properties.json   | 156 ------------------
 .../testcase_15005/testcase_15005_properties.json  | 178 +++++++++++++++++++++
 .../testcase_15005/testcase_5005_properties.json   | 178 ---------------------
 .../testcase_15006/testcase_15006_properties.json  | 178 +++++++++++++++++++++
 .../testcase_15006/testcase_5006_properties.json   | 178 ---------------------
 .../testcase_0001/testcase_0001_properties.json    |   2 +-
 .../testcase_10101/testcase_0101_properties.json   |  86 ----------
 .../testcase_10101/testcase_10101_properties.json  |  86 ++++++++++
 .../testcase_10102/testcase_0102_properties.json   |  86 ----------
 .../testcase_10102/testcase_10102_properties.json  |  86 ++++++++++
 .../testcase_10103/testcase_0103_properties.json   |  86 ----------
 .../testcase_10103/testcase_10103_properties.json  |  86 ++++++++++
 .../testcase_10104/testcase_0104_properties.json   |  86 ----------
 .../testcase_10104/testcase_10104_properties.json  |  86 ++++++++++
 .../testcase_10105/testcase_0105_properties.json   |  86 ----------
 .../testcase_10105/testcase_10105_properties.json  |  86 ++++++++++
 .../testcase_10106/testcase_0106_properties.json   |  86 ----------
 .../testcase_10106/testcase_10106_properties.json  |  86 ++++++++++
 .../testcase_10107/testcase_0107_properties.json   |  86 ----------
 .../testcase_10107/testcase_10107_properties.json  |  86 ++++++++++
 .../testcase_10108/testcase_0108_properties.json   |  86 ----------
 .../testcase_10108/testcase_10108_properties.json  |  86 ++++++++++
 .../testcase_10109/testcase_0109_properties.json   |  86 ----------
 .../testcase_10109/testcase_10109_properties.json  |  86 ++++++++++
 .../testcase_10110/testcase_0110_properties.json   |  86 ----------
 .../testcase_10110/testcase_10110_properties.json  |  86 ++++++++++
 .../testcase_10131/testcase_0131_properties.json   | 110 -------------
 .../testcase_10131/testcase_10131_properties.json  | 110 +++++++++++++
 .../testcase_10132/testcase_0132_properties.json   | 107 -------------
 .../testcase_10132/testcase_10132_properties.json  | 107 +++++++++++++
 .../testcase_10133/testcase_0133_properties.json   | 107 -------------
 .../testcase_10133/testcase_10133_properties.json  | 107 +++++++++++++
 .../testcase_10134/testcase_0134_properties.json   |  92 -----------
 .../testcase_10134/testcase_10134_properties.json  |  92 +++++++++++
 system_test/utils/metrics.py                       |   2 +
 topics.json                                        |   4 +
 43 files changed, 2267 insertions(+), 2261 deletions(-)
e402c7be723e5f189a8f2b4f91a28f3b26ea9112

 core/src/main/scala/kafka/tools/ConsoleProducer.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
b77099626e8fc258abed67dc10b2816347ba0f2b

 examples/README                             | 13 +--------
 examples/bin/java-producer-consumer-demo.sh | 43 ++---------------------------
 examples/bin/java-simple-consumer-demo.sh   | 43 ++---------------------------
 3 files changed, 7 insertions(+), 92 deletions(-)
35f589bb4654b49035c27780717f560e74400444

 .../main/scala/kafka/log/LogCleanerManager.scala   | 30 +++++++++++++++++-----
 1 file changed, 24 insertions(+), 6 deletions(-)
cda1f73d0498d66aafc8c6e57f84e0cd3c69928a

 core/src/main/scala/kafka/message/Message.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c2dadda3acf1391ebac586c4b66f1845f7ff6cff

 .../PreferredReplicaLeaderElectionCommand.scala    | 11 +++++++---
 .../kafka/admin/ReassignPartitionsCommand.scala    | 24 +++++++++++++++++++---
 core/src/main/scala/kafka/admin/TopicCommand.scala |  4 ++++
 .../scala/kafka/tools/StateChangeLogMerger.scala   |  7 ++++++-
 core/src/main/scala/kafka/utils/Utils.scala        | 10 +++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 15 +++++++++-----
 6 files changed, 59 insertions(+), 12 deletions(-)
e8923ae33ac90170381d8c4a59a5eb810ee9f36d

 .../PreferredReplicaLeaderElectionCommand.scala    | 11 +++++++---
 .../kafka/admin/ReassignPartitionsCommand.scala    | 24 +++++++++++++++++++---
 core/src/main/scala/kafka/admin/TopicCommand.scala |  4 ++++
 .../scala/kafka/tools/StateChangeLogMerger.scala   |  7 ++++++-
 core/src/main/scala/kafka/utils/Utils.scala        | 10 +++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 15 +++++++++-----
 6 files changed, 59 insertions(+), 12 deletions(-)
a6170d4f6da8d8f853219078a22f4d7b636bd221

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4b095760cb38c726c49e6f245ffd7dc8ccf49863

 .../org/apache/kafka/common/config/ConfigDef.java  |  2 ++
 .../apache/kafka/common/config/ConfigDefTest.java  | 41 ++++++++++++++++++++++
 2 files changed, 43 insertions(+)
eb7ac9eb7eebc4e0655b65e07cae594e61a6c05e

 build.gradle | 1 +
 1 file changed, 1 insertion(+)
2d322a7bd12966e4a66f04b75add619a481ff22d

 build.gradle | 1 +
 1 file changed, 1 insertion(+)
91d828a1a511c7a96b2eee1197e871215c6c62c0

 core/src/main/scala/kafka/server/KafkaServer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5152fb7e8eea720046ce844ca5153d2766ee002e

 core/src/main/scala/kafka/server/KafkaServer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5771f15f52a4c2887ff7ae5ca4e058de96e4c9c0

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5f1ad107b71318144af07a0fd9098b560c4efa82

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ee1bab755fdc87c3aa2c505b4abecc52ac280641

 .../kafka/clients/producer/ProducerConfig.java     |   2 +-
 .../common/message/KafkaLZ4BlockInputStream.java   | 233 +++++++++++++
 .../common/message/KafkaLZ4BlockOutputStream.java  | 387 +++++++++++++++++++++
 .../kafka/common/record/CompressionType.java       |   6 +-
 .../org/apache/kafka/common/record/Compressor.java |  21 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  60 ++++
 config/producer.properties                         |   4 +-
 .../scala/kafka/message/CompressionCodec.scala     |   7 -
 .../scala/kafka/message/CompressionFactory.scala   |  13 +-
 .../main/scala/kafka/tools/ConsoleProducer.scala   |   2 +-
 core/src/main/scala/kafka/tools/PerfConfig.scala   |   2 +-
 .../kafka/api/ProducerCompressionTest.scala        |   5 +-
 .../kafka/message/MessageCompressionTest.scala     |  12 -
 .../scala/unit/kafka/message/MessageTest.scala     |   2 +-
 14 files changed, 698 insertions(+), 58 deletions(-)
37356bfee09bf0dffc93d85270c342e03c36ca44

 .../kafka/clients/producer/ProducerConfig.java     |   2 +-
 .../common/message/KafkaLZ4BlockInputStream.java   | 233 +++++++++++++
 .../common/message/KafkaLZ4BlockOutputStream.java  | 387 +++++++++++++++++++++
 .../kafka/common/record/CompressionType.java       |   6 +-
 .../org/apache/kafka/common/record/Compressor.java |  21 +-
 .../java/org/apache/kafka/common/utils/Utils.java  |  60 ++++
 config/producer.properties                         |   4 +-
 .../scala/kafka/message/CompressionCodec.scala     |   7 -
 .../scala/kafka/message/CompressionFactory.scala   |  13 +-
 .../main/scala/kafka/tools/ConsoleProducer.scala   |   2 +-
 core/src/main/scala/kafka/tools/PerfConfig.scala   |   2 +-
 .../kafka/api/ProducerCompressionTest.scala        |   5 +-
 .../kafka/message/MessageCompressionTest.scala     |  12 -
 .../scala/unit/kafka/message/MessageTest.scala     |   2 +-
 14 files changed, 698 insertions(+), 58 deletions(-)
f084127a37cad806ab91f6548c48cc2379e05339

 .../scala/kafka/common/OffsetMetadataAndError.scala   |  1 +
 core/src/main/scala/kafka/server/KafkaApis.scala      |  7 ++++++-
 .../scala/unit/kafka/server/OffsetCommitTest.scala    | 19 ++++++++++++++++---
 3 files changed, 23 insertions(+), 4 deletions(-)
ede0ec3210cc778da28f30ea458c63d8ee46fc57

 .../scala/kafka/common/OffsetMetadataAndError.scala   |  1 -
 core/src/main/scala/kafka/server/KafkaApis.scala      |  8 +-------
 .../scala/unit/kafka/server/OffsetCommitTest.scala    | 19 +++----------------
 3 files changed, 4 insertions(+), 24 deletions(-)
4271ecbf06d0ffe16db3222b4e75247641a4c35f

 .../scala/kafka/common/OffsetMetadataAndError.scala   |  1 +
 core/src/main/scala/kafka/server/KafkaApis.scala      |  7 ++++++-
 .../scala/unit/kafka/server/OffsetCommitTest.scala    | 19 ++++++++++++++++---
 3 files changed, 23 insertions(+), 4 deletions(-)
841387b23ac30707dd7f24a79de441c3302458d4

 .../scala/kafka/common/OffsetMetadataAndError.scala   |  1 -
 core/src/main/scala/kafka/server/KafkaApis.scala      |  8 +-------
 .../scala/unit/kafka/server/OffsetCommitTest.scala    | 19 +++----------------
 3 files changed, 4 insertions(+), 24 deletions(-)
5257e9ddebab868beac591279dfbf60183577bf5

 .../scala/kafka/common/OffsetMetadataAndError.scala   |  1 +
 core/src/main/scala/kafka/server/KafkaApis.scala      |  8 +++++++-
 .../scala/unit/kafka/server/OffsetCommitTest.scala    | 19 ++++++++++++++++---
 3 files changed, 24 insertions(+), 4 deletions(-)
de432a09e632f78df9e580b51277f81582c3f026

 .../scala/kafka/common/OffsetMetadataAndError.scala   |  1 +
 core/src/main/scala/kafka/server/KafkaApis.scala      |  8 +++++++-
 .../scala/unit/kafka/server/OffsetCommitTest.scala    | 19 ++++++++++++++++---
 3 files changed, 24 insertions(+), 4 deletions(-)
75fb44dfd020384e88a38e426549d86f454a5d1c

 core/src/main/scala/kafka/log/Log.scala            |  8 +++++--
 core/src/main/scala/kafka/log/LogCleaner.scala     |  2 +-
 core/src/main/scala/kafka/log/LogConfig.scala      | 12 ++++++++++
 core/src/main/scala/kafka/log/LogSegment.scala     |  6 +++--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 16 ++++++++++++-
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 ++-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 26 ++++++++++++++++++++++
 8 files changed, 67 insertions(+), 8 deletions(-)
22643bfc2b683b426eb41d4b66cf90c3b7ec7f0d

 core/src/main/scala/kafka/log/Log.scala            |  8 +++++--
 core/src/main/scala/kafka/log/LogCleaner.scala     |  2 +-
 core/src/main/scala/kafka/log/LogConfig.scala      | 12 ++++++++++
 core/src/main/scala/kafka/log/LogSegment.scala     |  6 +++--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 16 ++++++++++++-
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 ++-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 26 ++++++++++++++++++++++
 8 files changed, 67 insertions(+), 8 deletions(-)
4546b9dba4814acb2e38cabd19dfd5c9b38524ee

 .../kafka/clients/producer/ProducerConfig.java     | 17 ++++--
 .../org/apache/kafka/common/config/ConfigDef.java  | 42 +++++++++++++++
 .../NotEnoughReplicasAfterAppendException.java     | 43 +++++++++++++++
 .../common/errors/NotEnoughReplicasException.java  | 40 ++++++++++++++
 .../org/apache/kafka/common/protocol/Errors.java   |  7 +--
 core/src/main/scala/kafka/cluster/Partition.scala  | 27 ++++++++--
 .../src/main/scala/kafka/common/ErrorMapping.scala | 20 ++++---
 .../NotEnoughReplicasAfterAppendException.scala    | 27 ++++++++++
 .../kafka/common/NotEnoughReplicasException.scala  | 25 +++++++++
 core/src/main/scala/kafka/log/LogConfig.scala      | 62 ++++++++++++++--------
 .../scala/kafka/producer/SyncProducerConfig.scala  | 14 +++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  6 ++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  5 ++
 .../kafka/api/ProducerFailureHandlingTest.scala    | 57 +++++++++++++++++++-
 .../scala/unit/kafka/producer/ProducerTest.scala   | 27 +++++-----
 .../unit/kafka/producer/SyncProducerTest.scala     | 22 ++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 ++--
 17 files changed, 384 insertions(+), 67 deletions(-)
d5041bc79fd656fe361c7f6643f9f26c2e8f22fe

 .../kafka/producer/async/DefaultEventHandler.scala | 102 +++++++++++----------
 1 file changed, 53 insertions(+), 49 deletions(-)
133a4fb752810ad8b5ea7b63fa15f594428c5cf6

 core/src/main/scala/kafka/server/KafkaConfig.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
be2e8a769efe35dc5c360545e6220a9fe652cced

 core/src/main/scala/kafka/server/KafkaConfig.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
da2c7cd50e3fea4aa44b0804d729c01990dfb2c1

 .../main/java/org/apache/kafka/clients/producer/ProducerConfig.java   | 4 ++--
 core/src/main/scala/kafka/tools/ConsoleProducer.scala                 | 4 ++--
 core/src/main/scala/kafka/tools/PerfConfig.scala                      | 2 +-
 .../test/scala/integration/kafka/api/ProducerCompressionTest.scala    | 3 +++
 core/src/test/scala/unit/kafka/message/MessageTest.scala              | 2 +-
 5 files changed, 9 insertions(+), 6 deletions(-)
0d65f043fed14c482a788d403c6a05544c0dd01b

 .../main/java/org/apache/kafka/clients/producer/ProducerConfig.java   | 4 ++--
 core/src/main/scala/kafka/tools/ConsoleProducer.scala                 | 4 ++--
 core/src/main/scala/kafka/tools/PerfConfig.scala                      | 2 +-
 .../test/scala/integration/kafka/api/ProducerCompressionTest.scala    | 3 +++
 core/src/test/scala/unit/kafka/message/MessageTest.scala              | 2 +-
 5 files changed, 9 insertions(+), 6 deletions(-)
fcfeba73bd8053ec41a61448315f2217df6459de

 .../src/main/java/org/apache/kafka/clients/producer/KafkaProducer.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
7062ed7db36f913328a9124797c47f70e3461025

 .../src/main/java/org/apache/kafka/clients/producer/KafkaProducer.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
ca0a95665436c9c5bb386c094d276c585f4e450d

 .../testcase_15001/testcase_5001_properties.json           | 12 ++++++------
 .../testcase_15002/testcase_5002_properties.json           | 14 +++++++-------
 .../testcase_15003/testcase_5003_properties.json           | 14 +++++++-------
 .../testcase_15004/testcase_5004_properties.json           | 14 +++++++-------
 .../testcase_15005/testcase_5005_properties.json           | 14 +++++++-------
 .../testcase_15006/testcase_5006_properties.json           | 14 +++++++-------
 .../testcase_5001/testcase_5001_properties.json            | 14 +++++++-------
 .../testcase_5002/testcase_5002_properties.json            | 14 +++++++-------
 .../testcase_5003/testcase_5003_properties.json            | 14 +++++++-------
 .../testcase_5004/testcase_5004_properties.json            | 14 +++++++-------
 .../testcase_5005/testcase_5005_properties.json            | 14 +++++++-------
 .../testcase_5006/testcase_5006_properties.json            | 14 +++++++-------
 .../testcase_7001/testcase_7001_properties.json            |  8 ++++----
 .../testcase_7002/testcase_7002_properties.json            |  8 ++++----
 .../testcase_0001/testcase_0001_properties.json            |  8 ++++----
 .../testcase_0002/testcase_0002_properties.json            |  8 ++++----
 .../testcase_0003/testcase_0003_properties.json            |  8 ++++----
 .../testcase_0004/testcase_0004_properties.json            |  8 ++++----
 .../testcase_0005/testcase_0005_properties.json            |  8 ++++----
 .../testcase_0006/testcase_0006_properties.json            |  8 ++++----
 .../testcase_0007/testcase_0007_properties.json            |  8 ++++----
 .../testcase_0008/testcase_0008_properties.json            |  8 ++++----
 .../testcase_0009/testcase_0009_properties.json            |  8 ++++----
 .../testcase_0101/testcase_0101_properties.json            |  8 ++++----
 .../testcase_0102/testcase_0102_properties.json            |  8 ++++----
 .../testcase_0103/testcase_0103_properties.json            |  8 ++++----
 .../testcase_0104/testcase_0104_properties.json            |  8 ++++----
 .../testcase_0105/testcase_0105_properties.json            |  8 ++++----
 .../testcase_0106/testcase_0106_properties.json            |  8 ++++----
 .../testcase_0107/testcase_0107_properties.json            |  8 ++++----
 .../testcase_0108/testcase_0108_properties.json            |  8 ++++----
 .../testcase_0109/testcase_0109_properties.json            |  8 ++++----
 .../testcase_1/testcase_1_properties.json                  |  8 ++++----
 .../testcase_10101/testcase_0101_properties.json           |  8 ++++----
 .../testcase_10102/testcase_0102_properties.json           |  8 ++++----
 .../testcase_10103/testcase_0103_properties.json           |  8 ++++----
 .../testcase_10104/testcase_0104_properties.json           |  8 ++++----
 .../testcase_10105/testcase_0105_properties.json           |  8 ++++----
 .../testcase_10106/testcase_0106_properties.json           |  8 ++++----
 .../testcase_10107/testcase_0107_properties.json           |  8 ++++----
 .../testcase_10108/testcase_0108_properties.json           |  8 ++++----
 .../testcase_10109/testcase_0109_properties.json           |  8 ++++----
 42 files changed, 203 insertions(+), 203 deletions(-)
1733c0bfb06a86eba7b16db3c80cabc91fc04b22

 .../testcase_15001/testcase_5001_properties.json           | 12 ++++++------
 .../testcase_15002/testcase_5002_properties.json           | 14 +++++++-------
 .../testcase_15003/testcase_5003_properties.json           | 14 +++++++-------
 .../testcase_15004/testcase_5004_properties.json           | 14 +++++++-------
 .../testcase_15005/testcase_5005_properties.json           | 14 +++++++-------
 .../testcase_15006/testcase_5006_properties.json           | 14 +++++++-------
 .../testcase_5001/testcase_5001_properties.json            | 14 +++++++-------
 .../testcase_5002/testcase_5002_properties.json            | 14 +++++++-------
 .../testcase_5003/testcase_5003_properties.json            | 14 +++++++-------
 .../testcase_5004/testcase_5004_properties.json            | 14 +++++++-------
 .../testcase_5005/testcase_5005_properties.json            | 14 +++++++-------
 .../testcase_5006/testcase_5006_properties.json            | 14 +++++++-------
 .../testcase_7001/testcase_7001_properties.json            |  8 ++++----
 .../testcase_7002/testcase_7002_properties.json            |  8 ++++----
 .../testcase_0001/testcase_0001_properties.json            |  8 ++++----
 .../testcase_0002/testcase_0002_properties.json            |  8 ++++----
 .../testcase_0003/testcase_0003_properties.json            |  8 ++++----
 .../testcase_0004/testcase_0004_properties.json            |  8 ++++----
 .../testcase_0005/testcase_0005_properties.json            |  8 ++++----
 .../testcase_0006/testcase_0006_properties.json            |  8 ++++----
 .../testcase_0007/testcase_0007_properties.json            |  8 ++++----
 .../testcase_0008/testcase_0008_properties.json            |  8 ++++----
 .../testcase_0009/testcase_0009_properties.json            |  8 ++++----
 .../testcase_0101/testcase_0101_properties.json            |  8 ++++----
 .../testcase_0102/testcase_0102_properties.json            |  8 ++++----
 .../testcase_0103/testcase_0103_properties.json            |  8 ++++----
 .../testcase_0104/testcase_0104_properties.json            |  8 ++++----
 .../testcase_0105/testcase_0105_properties.json            |  8 ++++----
 .../testcase_0106/testcase_0106_properties.json            |  8 ++++----
 .../testcase_0107/testcase_0107_properties.json            |  8 ++++----
 .../testcase_0108/testcase_0108_properties.json            |  8 ++++----
 .../testcase_0109/testcase_0109_properties.json            |  8 ++++----
 .../testcase_1/testcase_1_properties.json                  |  8 ++++----
 .../testcase_10101/testcase_0101_properties.json           |  8 ++++----
 .../testcase_10102/testcase_0102_properties.json           |  8 ++++----
 .../testcase_10103/testcase_0103_properties.json           |  8 ++++----
 .../testcase_10104/testcase_0104_properties.json           |  8 ++++----
 .../testcase_10105/testcase_0105_properties.json           |  8 ++++----
 .../testcase_10106/testcase_0106_properties.json           |  8 ++++----
 .../testcase_10107/testcase_0107_properties.json           |  8 ++++----
 .../testcase_10108/testcase_0108_properties.json           |  8 ++++----
 .../testcase_10109/testcase_0109_properties.json           |  8 ++++----
 42 files changed, 203 insertions(+), 203 deletions(-)
c63e06200d341345a1756e35ff0f48af2ec34d4a

 core/src/main/scala/kafka/controller/KafkaController.scala | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
09b2b3cbe07e8cdea42434fa6c54af0a064a93a2

 core/src/main/scala/kafka/controller/KafkaController.scala | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
043190c601f37e42c32189f3df5ddd986e57da95

 .../kafka/clients/producer/ProducerConfig.java     | 17 ++++--
 .../org/apache/kafka/common/config/ConfigDef.java  | 42 +++++++++++++++
 .../NotEnoughReplicasAfterAppendException.java     | 43 +++++++++++++++
 .../common/errors/NotEnoughReplicasException.java  | 40 ++++++++++++++
 .../org/apache/kafka/common/protocol/Errors.java   |  7 +--
 core/src/main/scala/kafka/cluster/Partition.scala  | 27 ++++++++--
 .../src/main/scala/kafka/common/ErrorMapping.scala | 20 ++++---
 .../NotEnoughReplicasAfterAppendException.scala    | 27 ++++++++++
 .../kafka/common/NotEnoughReplicasException.scala  | 25 +++++++++
 core/src/main/scala/kafka/log/LogConfig.scala      | 62 ++++++++++++++--------
 .../scala/kafka/producer/SyncProducerConfig.scala  | 14 +++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  6 ++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  5 ++
 .../kafka/api/ProducerFailureHandlingTest.scala    | 57 +++++++++++++++++++-
 .../scala/unit/kafka/producer/ProducerTest.scala   | 27 +++++-----
 .../unit/kafka/producer/SyncProducerTest.scala     | 22 ++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 ++--
 17 files changed, 384 insertions(+), 67 deletions(-)
58e58529b350a3da860b1f51fdfa356dfc42761f

 .../scala/kafka/consumer/PartitionAssignor.scala   | 62 +++++++++++-----------
 .../kafka/consumer/PartitionAssignorTest.scala     |  2 +-
 2 files changed, 33 insertions(+), 31 deletions(-)
841d44139dc1c2f46f9ed0d783776776a6da3e7e

 core/src/main/scala/kafka/controller/KafkaController.scala       | 3 +--
 core/src/main/scala/kafka/controller/PartitionStateMachine.scala | 4 ++--
 2 files changed, 3 insertions(+), 4 deletions(-)
a314461fa04b3249608607d1040c8e0cf8724bac

 core/src/main/scala/kafka/controller/KafkaController.scala       | 3 +--
 core/src/main/scala/kafka/controller/PartitionStateMachine.scala | 4 ++--
 2 files changed, 3 insertions(+), 4 deletions(-)
3d6df5494c20dffb7d2765d62bc19d81f16f932c

 core/src/main/scala/kafka/controller/TopicDeletionManager.scala | 2 ++
 1 file changed, 2 insertions(+)
5e45b55cacb136c5c61502a4d252c081ab1314e9

 core/src/main/scala/kafka/controller/TopicDeletionManager.scala | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
a7e49298b02ae35c227a40deae63debeae91138f

 core/src/main/scala/kafka/controller/TopicDeletionManager.scala | 2 ++
 1 file changed, 2 insertions(+)
1ac8df1d32597dca8e0f3537df051b4f787879ea

 core/src/main/scala/kafka/api/FetchResponse.scala | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)
db0d76b5d1facbac5deab8a9941e6439bc30a2e3

 .../errors/RecordBatchTooLargeException.java       | 39 ++++++++++++++++++++++
 .../org/apache/kafka/common/protocol/Errors.java   |  3 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |  5 +--
 .../common/MessageSetSizeTooLargeException.scala   | 22 ++++++++++++
 core/src/main/scala/kafka/log/Log.scala            | 27 +++++++++++----
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 34 ++++++++++++++-----
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  8 ++---
 8 files changed, 117 insertions(+), 23 deletions(-)
c940470e32916e2dbbe8f95bd295950a3681c5b7

 .../errors/RecordBatchTooLargeException.java       | 39 ++++++++++++++++++++++
 .../org/apache/kafka/common/protocol/Errors.java   |  3 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |  5 +--
 .../common/MessageSetSizeTooLargeException.scala   | 22 ++++++++++++
 core/src/main/scala/kafka/log/Log.scala            | 27 +++++++++++----
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 34 ++++++++++++++-----
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  8 ++---
 8 files changed, 117 insertions(+), 23 deletions(-)
68b9f7716df1d994a9d43bec6bc42c90e66f1e99

 core/src/main/scala/kafka/api/FetchResponse.scala | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)
5fcc3747faae69353f045ad7e3a88e13737145d3

 core/src/main/scala/kafka/server/RequestPurgatory.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1a6c9207c7c19f04b91b455e86bbf4e779e7e7a2

 core/src/main/scala/kafka/server/RequestPurgatory.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
88595bfb5229bda0ad7c3de2ce3b04f95a9f38a7

 core/src/main/scala/kafka/admin/TopicCommand.scala | 3 +++
 1 file changed, 3 insertions(+)
f43358197e2d2856543b3a345442fc1ddfa3240a

 .../apache/kafka/clients/producer/internals/BufferPool.java | 13 +++++--------
 1 file changed, 5 insertions(+), 8 deletions(-)
f452c426bb562ffc5cc2db38665591d157d5c80a

 .../apache/kafka/clients/producer/internals/BufferPool.java | 13 +++++--------
 1 file changed, 5 insertions(+), 8 deletions(-)
40948a33c93ab7b5bdc62c7cf680538e920afa4d

 core/src/main/scala/kafka/controller/TopicDeletionManager.scala | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
9cb59f319e26a5ad0b2646f9718bdb90deb21656

 core/src/main/scala/kafka/utils/VerifiableProperties.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
108f6d7621687efc823bf7980a6885732f394d40

 gradle.properties | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
e05704c40b51b399e2143faa3dbb668daca9890c

 gradle.properties | 1 +
 1 file changed, 1 insertion(+)
795e262b9f7c9c046b397e670f35698f17d2c13d

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
54b6419bb37ed88c8b77aee3c0c23aeb9b5be419

 core/src/main/scala/kafka/network/SocketServer.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
6861d4688ad044447881bfff22a1183ed8b6fc9e

 core/src/main/scala/kafka/utils/ToolsUtils.scala | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
a9c7d77249224666b1e5fcded213c516fdd46ac0

 .../main/scala/kafka/tools/ConsoleProducer.scala   | 11 ++++---
 .../main/scala/kafka/tools/GetOffsetShell.scala    |  6 ++--
 .../scala/kafka/tools/ProducerPerformance.scala    |  3 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  3 +-
 .../kafka/tools/ReplicaVerificationTool.scala      |  4 ++-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  4 ++-
 core/src/main/scala/kafka/utils/ToolsUtils.scala   | 38 ++++++++++++++++++++++
 7 files changed, 58 insertions(+), 11 deletions(-)
9c17747baab829adb268da28b4d943bbd6ef4e9f

 config/server.properties                           |   2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 167 +++++++++++----------
 .../scala/kafka/server/KafkaServerStartable.scala  |   4 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |  27 ++++
 4 files changed, 121 insertions(+), 79 deletions(-)
f750dba65f9d9552a61a0754c46fa6e294785b31

 core/src/main/scala/kafka/server/KafkaServer.scala | 20 +++++++-
 .../unit/kafka/server/ServerStartupTest.scala      | 54 ++++++++++++++++++++++
 2 files changed, 73 insertions(+), 1 deletion(-)
084566b837ee2204b6898b82156e811d0601085f

 build.gradle                                       |   5 +-
 contrib/hadoop-consumer/lib/piggybank.jar          | Bin 308044 -> 0 bytes
 contrib/hadoop-producer/lib/piggybank.jar          | Bin 308044 -> 0 bytes
 lib/apache-rat-0.8.jar                             | Bin 1165578 -> 0 bytes
 .../0.7/bin/kafka-run-class.sh                     |  87 ------
 .../0.7/bin/zookeeper-server-start.sh              |  23 --
 .../0.7/config/log4j.properties                    |  78 ------
 .../0.7/config/test-log4j.properties               |  68 -----
 .../0.7/lib/kafka-0.7.0.jar                        | Bin 1306797 -> 0 bytes
 .../0.7/lib/kafka-perf-0.7.0.jar                   | Bin 55427 -> 0 bytes
 .../0.7/lib/zkclient-0.1.jar                       | Bin 62913 -> 0 bytes
 system_test/migration_tool_testsuite/__init__.py   |   1 -
 .../migration_tool_testsuite/cluster_config.json   | 103 -------
 .../config/migration_consumer.properties           |  29 --
 .../config/migration_producer.properties           |  68 -----
 .../config/server.properties                       | 125 ---------
 .../config/zookeeper.properties                    |  20 --
 .../migration_tool_test.py                         | 308 ---------------------
 .../testcase_9001/testcase_9001_properties.json    | 125 ---------
 .../testcase_9003/cluster_config.json              | 112 --------
 .../testcase_9003/testcase_9003_properties.json    | 138 ---------
 .../testcase_9004/cluster_config.json              | 112 --------
 .../testcase_9004/testcase_9004_properties.json    | 138 ---------
 .../testcase_9005/cluster_config.json              | 141 ----------
 .../testcase_9005/testcase_9005_properties.json    | 168 -----------
 .../testcase_9006/cluster_config.json              | 141 ----------
 .../testcase_9006/testcase_9006_properties.json    | 168 -----------
 system_test/testcase_to_run_all.json               |   8 -
 28 files changed, 2 insertions(+), 2164 deletions(-)
27bc37289c316fb5a978423f4b2c88f49ae15e52

 README.md   |   1 +
 gradlew     |   2 +-
 gradlew.bat | 180 ++++++++++++++++++++++++++++++------------------------------
 3 files changed, 92 insertions(+), 91 deletions(-)
db0b0b8509ce904a0eab021a0453a80cecf3efb7

 wrapper.gradle | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)
d2d1ef357b3b07e83f880ee2a6e02fb3c18ae011

 README.md                                |   7 +++++++
 build.gradle                             |   5 +++++
 gradle/wrapper/gradle-wrapper.jar        | Bin 49875 -> 0 bytes
 gradle/wrapper/gradle-wrapper.properties |   6 ------
 4 files changed, 12 insertions(+), 6 deletions(-)
6d7057566f0c3a872f625957aa086b993e76071f

 build.gradle | 52 ++++++++++++++++++++++++++++++----------------------
 1 file changed, 30 insertions(+), 22 deletions(-)
8eac7d789f588b48ad278f4db620402c426c65bc

 .../main/scala/kafka/network/SocketServer.scala    | 44 ++++++++++++++++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  3 ++
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 .../unit/kafka/network/SocketServerTest.scala      |  3 +-
 4 files changed, 47 insertions(+), 6 deletions(-)
be5edd2f8d0c0355cb33feb2ac7482b7df7dccbc

 .../org/apache/kafka/common/utils/ClientUtils.java | 17 +++++---
 .../java/org/apache/kafka/common/utils/Utils.java  | 36 +++++++++++++++
 .../apache/kafka/common/utils/ClientUtilsTest.java | 42 ++++++++++++++++++
 .../org/apache/kafka/common/utils/UtilsTest.java   | 51 ++++++++++++++++++++++
 .../main/java/kafka/etl/impl/DataGenerator.java    |  7 +--
 core/src/main/scala/kafka/admin/TopicCommand.scala |  4 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  |  4 +-
 core/src/main/scala/kafka/client/ClientUtils.scala | 14 +++---
 core/src/main/scala/kafka/cluster/Broker.scala     |  7 +--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  3 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |  8 ++--
 core/src/main/scala/kafka/utils/Utils.scala        | 16 ++-----
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  4 +-
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  9 ++--
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  5 +--
 15 files changed, 176 insertions(+), 51 deletions(-)
c892c08df01c3dfc2d466bd37a6838072d390819

 core/src/main/scala/kafka/api/FetchRequest.scala      | 14 +++++++-------
 core/src/main/scala/kafka/api/RequestOrResponse.scala |  2 +-
 core/src/main/scala/kafka/cluster/Broker.scala        |  4 ++--
 3 files changed, 10 insertions(+), 10 deletions(-)
a1423aec7bd2ba857bf3d5e829c960907c297def

 core/src/main/scala/kafka/server/ReplicaManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
cf0f5750b39e675cf9a9c6d6394a665366db0f58

 .../main/scala/kafka/network/RequestChannel.scala    |  4 ++++
 core/src/main/scala/kafka/network/SocketServer.scala | 20 ++++++++++++++++++--
 2 files changed, 22 insertions(+), 2 deletions(-)
d677701b93b3b792fac6191588984f7a5323eecd

 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 2 +-
 core/src/test/scala/unit/kafka/producer/AsyncProducerTest.scala    | 6 ++++++
 2 files changed, 7 insertions(+), 1 deletion(-)
3e8854c0c86e75311994d805bcb3b2d5d9836879

 core/src/main/scala/kafka/producer/KafkaLog4jAppender.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
cb6a1597b768404d758540e3ed53f5918c28c31b

 .../migration_tool_testsuite/cluster_config.json   |  2 +-
 system_test/testcase_to_run.json                   |  2 +-
 system_test/utils/system_test_utils.py             | 28 ++++++++++++----------
 3 files changed, 18 insertions(+), 14 deletions(-)
f5ab8e1780cf80f267906e3259ad4f9278c32d28

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f9d9b3814317f80ea08df9c7879de966aa0a2554

 README.md                              |  2 +-
 bin/kafka-run-class.sh                 |  8 ++++++--
 bin/windows/kafka-console-consumer.bat |  2 +-
 bin/windows/kafka-console-producer.bat |  2 +-
 bin/windows/kafka-run-class.bat        | 10 +++++++---
 5 files changed, 16 insertions(+), 8 deletions(-)
8d0ab1de70f3361d26e1e2cbfc4363f5ca45d4c2

 README.md       |  4 ++--
 build.gradle    | 23 ++++-------------------
 settings.gradle |  2 +-
 3 files changed, 7 insertions(+), 22 deletions(-)
3d3c544d6f87ddff58fc01be00410321ef0d497d

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala | 4 +++-
 core/src/main/scala/kafka/server/KafkaConfig.scala      | 4 +++-
 2 files changed, 6 insertions(+), 2 deletions(-)
e22f8ededaf838e7cec9dd22975d8461764ab076

 .../consumer/ZookeeperConsumerConnector.scala      | 26 +++++++++-------------
 1 file changed, 11 insertions(+), 15 deletions(-)
ffb81a581b6cbd3bd7338ec88022aa745a05b1c9

 .../main/scala/kafka/server/RequestPurgatory.scala | 64 ++++++++++++----------
 .../unit/kafka/server/RequestPurgatoryTest.scala   | 33 ++++++++++-
 2 files changed, 67 insertions(+), 30 deletions(-)
ae24141275727255e0dd5d8a739648851d0a0491

 .../scala/kafka/tools/ZooKeeperMainWrapper.scala   | 39 ++++++++++++++++++++++
 1 file changed, 39 insertions(+)
3abe3403a1a9dfb2eae4b73f79e60b99401079f6

 build.gradle | 66 +++++++++++++++++++++++++++---------------------------------
 1 file changed, 30 insertions(+), 36 deletions(-)
953e35b5c591559a600b4e6bd01d1dd1f2e979db

 .../main/scala/kafka/consumer/ConsumerConfig.scala |   4 +
 .../scala/kafka/consumer/PartitionAssignor.scala   | 161 ++++++++++++++++
 .../src/main/scala/kafka/consumer/TopicCount.scala |  39 ++--
 .../consumer/ZookeeperConsumerConnector.scala      |  95 ++++------
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |   2 +
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   6 +-
 .../kafka/consumer/PartitionAssignorTest.scala     | 207 +++++++++++++++++++++
 7 files changed, 441 insertions(+), 73 deletions(-)
538122fa793fe59021ac35feaef22e302b194030

 core/src/main/scala/kafka/network/SocketServer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
2cdc83e85b56c946eed51da6143fbe9d2d0c9d08

 build.gradle                                              | 2 +-
 core/src/test/scala/unit/kafka/zk/EmbeddedZookeeper.scala | 4 +++-
 system_test/utils/kafka_system_test_utils.py              | 6 +++---
 3 files changed, 7 insertions(+), 5 deletions(-)
aa775a199edbdbb4bcb1b3ac8f75d7e5c80fcaee

 .../kafka/common/requests/MetadataResponse.java    | 27 ++++++++++------------
 1 file changed, 12 insertions(+), 15 deletions(-)
a30491ac5d3fc5967e8c4b16c68bdbfc312748f5

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f402b7a96d802c1cf8624416c98da416e193e7fd

 core/src/main/scala/kafka/Kafka.scala | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
780225506d89b587d3974615b8444ef2b62122d5

 core/src/main/scala/kafka/admin/TopicCommand.scala | 23 ++++++++++++++++++++--
 1 file changed, 21 insertions(+), 2 deletions(-)
c6f08b6094924ff3560a8e16090c85ed1a415b03

 .../kafka/common/errors/InvalidTopicException.java | 38 ++++++++++++++++++++++
 .../org/apache/kafka/common/protocol/Errors.java   | 16 +++------
 .../src/main/scala/kafka/common/ErrorMapping.scala |  4 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 12 +++++--
 .../kafka/api/ProducerFailureHandlingTest.scala    |  9 ++++-
 5 files changed, 63 insertions(+), 16 deletions(-)
f550970b0a2fd008efb0b0cf0c9e74a2a3778ece

 .../main/scala/kafka/api/TransactionRequest.scala    | 20 ++++++++++++--------
 1 file changed, 12 insertions(+), 8 deletions(-)
45c4de00daa0c20cb7718e851f65e46074b0c247

 core/src/main/scala/kafka/api/RequestKeys.scala    |   6 +-
 .../main/scala/kafka/api/TransactionRequest.scala  | 184 +++++++++++++++++++++
 .../main/scala/kafka/api/TransactionResponse.scala |  97 +++++++++++
 .../kafka/api/TxCoordinatorMetadataRequest.scala   |  79 +++++++++
 .../kafka/api/TxCoordinatorMetadataResponse.scala  |  59 +++++++
 .../src/main/scala/kafka/common/ErrorMapping.scala |   1 +
 .../api/RequestResponseSerializationTest.scala     |  31 +++-
 7 files changed, 455 insertions(+), 2 deletions(-)
d678449b967ed92a5a02289c061f201da25b07de

 system_test/utils/kafka_system_test_utils.py | 34 +++++++++++++++-------------
 1 file changed, 18 insertions(+), 16 deletions(-)
caf256ad8ce1b204959b431b6268c7c66f9c480d

 kafka-patch-review.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a552d4b743c44db0adcb58273b92301b2a4df38b

 kafka-patch-review.py | 26 ++++++++++++++++++++++----
 1 file changed, 22 insertions(+), 4 deletions(-)
aa70a7d02552585a83c62784b92b67ed8ae3a304

 .../scala/kafka/consumer/ConsumerTopicStats.scala  |   4 +
 .../consumer/FetchRequestAndResponseStats.scala    |  16 ++-
 .../consumer/ZookeeperConsumerConnector.scala      |  37 +++----
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    | 120 ++++++++++++++++++++-
 core/src/main/scala/kafka/producer/Producer.scala  |  13 ++-
 .../kafka/producer/ProducerRequestStats.scala      |   4 +
 .../main/scala/kafka/producer/ProducerStats.scala  |   4 +
 .../scala/kafka/producer/ProducerTopicStats.scala  |   4 +
 8 files changed, 175 insertions(+), 27 deletions(-)
48cc2dc0ead0df1501abf16f583b3e365488e2d0

 build.gradle                                              | 2 +-
 core/src/test/scala/unit/kafka/zk/EmbeddedZookeeper.scala | 4 +---
 2 files changed, 2 insertions(+), 4 deletions(-)
8a8c49028a19444684a23cb1ef456d0dc82e022f

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
0607953f3ad5a8a77bdd83870897541af66c7ced

 core/src/main/scala/kafka/network/SocketServer.scala | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
4d0759713fb2722bac8ce7dcbbb047d7af99280a

 README.md                                          |  4 +-
 bin/kafka-run-class.sh                             |  4 +-
 build.gradle                                       | 46 +++++++---------------
 .../javaapi/message/ByteBufferMessageSet.scala     |  5 ++-
 .../scala/kafka/message/ByteBufferMessageSet.scala |  5 ++-
 core/src/main/scala/kafka/utils/Annotations.scala  | 38 ++++++++++++++++++
 .../main/scala/kafka/utils/Annotations_2.8.scala   | 36 -----------------
 .../main/scala/kafka/utils/Annotations_2.9+.scala  | 38 ------------------
 .../test/scala/unit/kafka/common/ConfigTest.scala  |  4 +-
 .../test/scala/unit/kafka/common/TopicTest.scala   |  2 +-
 gradle.properties                                  |  2 +-
 gradle/buildscript.gradle                          |  2 +-
 gradle/wrapper/gradle-wrapper.properties           |  2 +-
 scala.gradle                                       | 12 ++++--
 14 files changed, 78 insertions(+), 122 deletions(-)
c9894fb6ee4d33155bdb669a2e2f64ed9c3f9441

 .../scala/kafka/controller/KafkaController.scala   | 37 ++++++++++++++++--
 .../kafka/controller/PartitionStateMachine.scala   | 44 ++++++++++++++++++----
 .../kafka/controller/ReplicaStateMachine.scala     | 32 +++++++++++++---
 3 files changed, 97 insertions(+), 16 deletions(-)
0dc243b92a6ae1683795caf8222edc1b2bb49565

 core/src/main/scala/kafka/api/FetchRequest.scala   |   6 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |   3 +-
 core/src/main/scala/kafka/cluster/Partition.scala  | 161 ++++----
 core/src/main/scala/kafka/cluster/Replica.scala    |  80 ++--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   2 +-
 core/src/main/scala/kafka/log/Log.scala            |  74 ++--
 core/src/main/scala/kafka/log/LogCleaner.scala     |  13 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  38 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  17 +-
 .../src/main/scala/kafka/server/DelayedFetch.scala |  91 +++++
 .../main/scala/kafka/server/DelayedProduce.scala   | 115 ++++++
 .../scala/kafka/server/DelayedRequestKey.scala     |  38 ++
 .../main/scala/kafka/server/FetchDataInfo.scala    |  22 +
 .../scala/kafka/server/FetchRequestPurgatory.scala |  69 ++++
 core/src/main/scala/kafka/server/KafkaApis.scala   | 446 +++------------------
 .../scala/kafka/server/LogOffsetMetadata.scala     |  87 ++++
 .../main/scala/kafka/server/OffsetManager.scala    |  29 +-
 .../kafka/server/ProducerRequestPurgatory.scala    |  69 ++++
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  25 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 183 +++++++--
 .../main/scala/kafka/server/RequestPurgatory.scala |  98 +++--
 .../scala/kafka/tools/TestEndToEndLatency.scala    |  23 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |   2 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  10 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   4 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  16 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  26 +-
 .../kafka/message/BaseMessageSetTestCases.scala    |   2 +-
 .../server/HighwatermarkPersistenceTest.scala      |  38 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   8 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  10 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |   4 +-
 .../unit/kafka/server/RequestPurgatoryTest.scala   |  26 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  58 ++-
 34 files changed, 1149 insertions(+), 744 deletions(-)
7a67a72261bcb5b09d9defb2fd95a65c89e75172

 build.gradle                                              | 2 +-
 core/src/test/scala/unit/kafka/zk/EmbeddedZookeeper.scala | 4 +++-
 2 files changed, 4 insertions(+), 2 deletions(-)
09690e339aabea6e9141f7e2ddd50449cc1c9180

 kafka-patch-review.py | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
0386790e757fe4eeae4a179e573f71ef8c7de43c

 .../src/main/java/org/apache/kafka/common/protocol/types/Struct.java    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1d2e776d8c4ffbe59e40985ecfc3b010d99519d1

 .../org/apache/kafka/clients/producer/MetadataTest.java    | 14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)
f8d521a9616134d78966419e5cf2aa73e8d6a5c5

 core/src/main/scala/kafka/admin/AdminUtils.scala   | 10 +++-
 core/src/main/scala/kafka/admin/TopicCommand.scala |  4 +-
 .../scala/unit/kafka/admin/TopicCommandTest.scala  | 63 ++++++++++++++++++++++
 3 files changed, 73 insertions(+), 4 deletions(-)
a01a101e82d5b06e89857e79c4b8268589d81fca

 .../kafka/server/ZookeeperLeaderElector.scala      | 30 +++++++++++++++++-----
 1 file changed, 23 insertions(+), 7 deletions(-)
50f2b245c1a666400fab7ddfdebf7c1c2bdf3084

 .../src/main/java/org/apache/kafka/common/network/Selector.java    | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
f489493c385e3266c3bc17db2e8ebc215a6e54e2

 config/server.properties                           |   4 +
 core/src/main/scala/kafka/log/LogManager.scala     | 179 +++++++++++++++------
 core/src/main/scala/kafka/server/KafkaConfig.scala |   3 +
 core/src/main/scala/kafka/server/KafkaServer.scala |   1 +
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  18 +--
 core/src/main/scala/kafka/utils/Utils.scala        |   6 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  97 ++---------
 .../server/HighwatermarkPersistenceTest.scala      |  17 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     |  20 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  25 +++
 10 files changed, 203 insertions(+), 167 deletions(-)
fa34841d9889fc45b4824b729b71bfb2215a082d

 clients/src/main/java/org/apache/kafka/common/network/Selector.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7f2278fb9de08141f21b017ba66752857dcdeba4

 core/src/main/scala/kafka/cluster/Partition.scala  | 27 +++++++++++-----------
 .../main/scala/kafka/server/MetadataCache.scala    | 17 +++++++-------
 core/src/main/scala/kafka/utils/Utils.scala        | 11 ++++++---
 3 files changed, 29 insertions(+), 26 deletions(-)
d9e5080dfceff12ea599f8d518ad402ba7d54c9d

 .../main/scala/kafka/server/ReplicaManager.scala   | 35 ++++++----------------
 1 file changed, 9 insertions(+), 26 deletions(-)
db41f98ea943d806362487b8f8192360a488eb39

 core/src/main/scala/kafka/log/LogCleaner.scala | 14 ++++++++++++--
 1 file changed, 12 insertions(+), 2 deletions(-)
3f1a9c4cee778d089d3ec3167555c2b89cdc48bb

 .../main/scala/kafka/tools/DumpLogSegments.scala   | 27 +++++++++++++++++-----
 1 file changed, 21 insertions(+), 6 deletions(-)
ff05e9b3616a222e29a42f6e8fdf41945a417f41

 .../org/apache/kafka/clients/NetworkClient.java    | 13 +++-
 .../kafka/clients/producer/internals/Metadata.java |  7 ++
 .../kafka/api/ProducerFailureHandlingTest.scala    | 88 +++++++++-------------
 .../integration/kafka/api/ProducerSendTest.scala   | 56 ++++++--------
 .../kafka/integration/KafkaServerTestHarness.scala |  2 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 6 files changed, 78 insertions(+), 90 deletions(-)
014b700f0323b4dc00d3aa0e1b598f7e2ed07957

 .../scala/kafka/api/GenericRequestAndHeader.scala  | 55 ++++++++++++++++++++++
 .../api/GenericRequestOrResponseAndHeader.scala    | 45 ------------------
 .../scala/kafka/api/GenericResponseAndHeader.scala | 46 ++++++++++++++++++
 .../kafka/api/HeartbeatRequestAndHeader.scala      | 20 +++++---
 .../kafka/api/HeartbeatResponseAndHeader.scala     | 10 ++--
 .../kafka/api/JoinGroupRequestAndHeader.scala      | 17 ++++---
 .../kafka/api/JoinGroupResponseAndHeader.scala     | 10 ++--
 .../api/RequestResponseSerializationTest.scala     | 12 ++---
 8 files changed, 139 insertions(+), 76 deletions(-)
1e4b0841b37e9e6526d7a7a7c643b1369d9f03c5

 core/src/main/scala/kafka/server/OffsetCheckpoint.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
592678e4d72151940002ffb1a367ec433b27f2ef

 .../src/main/scala/kafka/consumer/TopicCount.scala |  4 ++--
 core/src/main/scala/kafka/utils/Utils.scala        | 24 ++++++++++++++++++++
 .../unit/kafka/consumer/TopicFilterTest.scala      | 26 ++++++++++++++++++++++
 3 files changed, 52 insertions(+), 2 deletions(-)
fc0e03f79131746da81c05c12e056862c08d79d4

 .../kafka/clients/producer/internals/Sender.java   |  12 +-
 .../main/java/org/apache/kafka/common/Cluster.java |  15 +-
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   7 +-
 .../org/apache/kafka/common/protocol/Protocol.java | 280 ++++++++++++++++++++-
 .../apache/kafka/common/protocol/types/Struct.java |  67 +++++
 .../common/requests/AbstractRequestResponse.java   |  66 +++++
 .../common/requests/ConsumerMetadataRequest.java   |  47 ++++
 .../common/requests/ConsumerMetadataResponse.java  |  69 +++++
 .../apache/kafka/common/requests/FetchRequest.java | 132 ++++++++++
 .../kafka/common/requests/FetchResponse.java       | 110 ++++++++
 .../kafka/common/requests/HeartbeatRequest.java    |  64 +++++
 .../kafka/common/requests/HeartbeatResponse.java   |  45 ++++
 .../kafka/common/requests/JoinGroupRequest.java    |  87 +++++++
 .../kafka/common/requests/JoinGroupResponse.java   | 102 ++++++++
 .../kafka/common/requests/ListOffsetRequest.java   | 114 +++++++++
 .../kafka/common/requests/ListOffsetResponse.java  | 108 ++++++++
 .../kafka/common/requests/MetadataRequest.java     |  29 ++-
 .../kafka/common/requests/MetadataResponse.java    |  98 ++++++--
 .../kafka/common/requests/OffsetCommitRequest.java | 180 +++++++++++++
 .../common/requests/OffsetCommitResponse.java      |  87 +++++++
 .../kafka/common/requests/OffsetFetchRequest.java  |  98 ++++++++
 .../kafka/common/requests/OffsetFetchResponse.java | 107 ++++++++
 .../kafka/common/requests/ProduceRequest.java      | 124 +++++----
 .../kafka/common/requests/ProduceResponse.java     |  96 ++++---
 .../kafka/common/requests/RequestHeader.java       |  49 ++--
 .../kafka/common/requests/ResponseHeader.java      |  22 +-
 .../apache/kafka/common/utils/CollectionUtils.java |  62 +++++
 .../apache/kafka/clients/NetworkClientTest.java    |   4 +-
 .../kafka/common/requests/RequestResponseTest.java | 173 +++++++++++++
 .../scala/kafka/api/ConsumerMetadataRequest.scala  |   4 +-
 .../scala/kafka/api/ConsumerMetadataResponse.scala |   4 +-
 .../kafka/api/ControlledShutdownRequest.scala      |   4 +-
 .../kafka/api/ControlledShutdownResponse.scala     |   4 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   4 +-
 .../api/GenericRequestOrResponseAndHeader.scala    |  45 ++++
 .../kafka/api/HeartbeatRequestAndHeader.scala      |  39 +++
 .../kafka/api/HeartbeatResponseAndHeader.scala     |  28 +++
 .../kafka/api/JoinGroupRequestAndHeader.scala      |  40 +++
 .../kafka/api/JoinGroupResponseAndHeader.scala     |  28 +++
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |   4 +-
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |   4 +-
 .../main/scala/kafka/api/OffsetCommitRequest.scala |  38 ++-
 .../scala/kafka/api/OffsetCommitResponse.scala     |   4 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |   4 +-
 .../main/scala/kafka/api/OffsetFetchResponse.scala |   4 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   4 +-
 core/src/main/scala/kafka/api/OffsetResponse.scala |   4 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   4 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |   4 +-
 core/src/main/scala/kafka/api/RequestKeys.scala    |   7 +-
 .../main/scala/kafka/api/RequestOrResponse.scala   |   2 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |   4 +-
 .../main/scala/kafka/api/StopReplicaResponse.scala |   4 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   4 +-
 .../scala/kafka/api/TopicMetadataResponse.scala    |   4 +-
 .../scala/kafka/api/UpdateMetadataRequest.scala    |   4 +-
 .../scala/kafka/api/UpdateMetadataResponse.scala   |   4 +-
 .../controller/ControllerChannelManager.scala      |   8 +-
 .../scala/kafka/javaapi/OffsetCommitRequest.scala  |   2 -
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |   4 +-
 .../api/RequestResponseSerializationTest.scala     |  74 ++++--
 61 files changed, 2610 insertions(+), 239 deletions(-)
4ebcdfd51f1e9e4c3d684204e6a785fae6c0e549

 core/src/main/scala/kafka/api/TopicMetadataRequest.scala    |  2 +-
 core/src/main/scala/kafka/api/TopicMetadataResponse.scala   | 13 +++----------
 core/src/main/scala/kafka/server/KafkaApis.scala            |  5 +++--
 core/src/main/scala/kafka/server/MetadataCache.scala        |  6 ++++++
 .../main/scala/kafka/tools/ReplicaVerificationTool.scala    |  2 +-
 .../unit/kafka/api/RequestResponseSerializationTest.scala   |  2 +-
 6 files changed, 15 insertions(+), 15 deletions(-)
8e444a3562d6723b9f33cbdaa6a461409c84c98b

 .../main/scala/kafka/network/SocketServer.scala    | 146 +++++++++++++++------
 core/src/main/scala/kafka/server/KafkaConfig.scala |   6 +
 core/src/main/scala/kafka/server/KafkaServer.scala |   3 +-
 .../unit/kafka/network/SocketServerTest.scala      |  20 ++-
 4 files changed, 129 insertions(+), 46 deletions(-)
b428d8cc48237099af648de12d18be78d54446eb

 config/consumer.properties |  2 +-
 config/server.properties   | 14 +++++++-------
 2 files changed, 8 insertions(+), 8 deletions(-)
3e6b386b72b0d1a39621d7e166f2228c97646e1d

 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 31 ----------------------
 1 file changed, 31 deletions(-)
4b3d03e8e0d660b27c7823c03dde075d6ce8348b

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 7 +++++++
 1 file changed, 7 insertions(+)
83a9aa55d340f6b2720394a49f01a88509e17e52

 .../org/apache/kafka/clients/NetworkClient.java    | 33 ++++++++++++++--------
 .../kafka/clients/producer/internals/Metadata.java |  2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 31 ++++++++++----------
 3 files changed, 37 insertions(+), 29 deletions(-)
8034390ef0f49a1ed180bc1e883dbbd1f6d864a0

 .../consumer/ConsumerRebalanceCallback.java        |  4 +-
 .../apache/kafka/common/network/Selectable.java    |  8 +--
 .../src/main/java/kafka/etl/Props.java             | 73 ++++++++++------------
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  3 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    |  2 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  2 +-
 6 files changed, 44 insertions(+), 48 deletions(-)
420628d695cc675711b94af5cfd14653147bf7f7

 core/src/main/scala/kafka/server/KafkaConfig.scala | 23 ++++++++--
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 53 ++++++++++++++++++++++
 3 files changed, 73 insertions(+), 5 deletions(-)
cd3ce27d4baf5434676ec040d64663ad3ce09817

 .../org/apache/kafka/clients/NetworkClient.java    |  4 +-
 .../kafka/clients/producer/KafkaProducer.java      | 40 +++++++++++--
 .../kafka/clients/producer/internals/Metadata.java | 68 ++++++++++------------
 .../kafka/clients/producer/internals/Sender.java   |  4 +-
 .../kafka/clients/producer/MetadataTest.java       |  9 ++-
 5 files changed, 77 insertions(+), 48 deletions(-)
6de56b30b0f9aee19bf110431bcb4511d9b748f2

 .../main/scala/kafka/utils/CommandLineUtils.scala  | 17 ++++----
 .../unit/kafka/utils/CommandLineUtilsTest.scala    | 49 ++++++++++++++++++++++
 2 files changed, 59 insertions(+), 7 deletions(-)
b1a1cae880817332f172dccaa5e3e4a69228074f

 core/src/main/scala/kafka/server/KafkaServerStartable.scala | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)
2a4718c1a7e8e1566c5c87468779fdd1f95fe3bc

 core/src/main/scala/kafka/controller/PartitionLeaderSelector.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
b8d87d0b22cc4e87bac2e9fdfe761b23734851ff

 build.gradle | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
e3dfad304e6c2ffc146cdb9bc25a1d683f289ace

 .../main/java/org/apache/kafka/clients/producer/internals/Sender.java    | 1 +
 1 file changed, 1 insertion(+)
f1c6e97d718581566d037a48640ac3d869d1f15a

 .../org/apache/kafka/clients/NetworkClient.java    | 20 +++---
 .../kafka/clients/producer/KafkaProducer.java      | 16 +++--
 .../kafka/clients/producer/internals/Metadata.java | 15 ++---
 .../producer/internals/RecordAccumulator.java      | 76 ++++++++++++++++------
 .../kafka/clients/producer/internals/Sender.java   | 26 +++++---
 .../apache/kafka/common/record/MemoryRecords.java  | 26 ++++++--
 .../apache/kafka/clients/NetworkClientTest.java    |  2 +-
 .../kafka/clients/producer/MetadataTest.java       | 10 +--
 .../clients/producer/RecordAccumulatorTest.java    | 14 ++--
 .../apache/kafka/clients/producer/SenderTest.java  |  6 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 63 +++++++++---------
 .../kafka/api/ProducerFailureHandlingTest.scala    | 25 ++++---
 .../unit/kafka/network/SocketServerTest.scala      |  8 ++-
 13 files changed, 187 insertions(+), 120 deletions(-)
c4b95641ea295478f9480b264652b7b52d8f71c5

 core/src/main/scala/kafka/api/ConsumerMetadataResponse.scala | 3 ++-
 core/src/main/scala/kafka/client/ClientUtils.scala           | 5 +++++
 2 files changed, 7 insertions(+), 1 deletion(-)
62f208704fe7fb08f085d569a26e780e0050dba0

 .../scala/kafka/controller/KafkaController.scala   | 53 +++++-----------------
 1 file changed, 12 insertions(+), 41 deletions(-)
7847e9c703f3a0b70519666cdb8a6e4c8e37c3a7

 build.gradle      | 7 +++++--
 gradle.properties | 2 +-
 2 files changed, 6 insertions(+), 3 deletions(-)
6b0ae4bba0d0f8e4c8da19de65a8f03f162bec39

 bin/kafka-consumer-offset-checker.sh               | 17 +++++++
 bin/kafka-mirror-maker.sh                          | 17 +++++++
 bin/kafka-replica-verification.sh                  | 17 +++++++
 bin/kafka-simple-consumer-perf-test.sh             | 21 --------
 bin/windows/kafka-consumer-offset-checker.bat      | 17 +++++++
 bin/windows/kafka-consumer-perf-test.bat           | 20 ++++++++
 bin/windows/kafka-mirror-maker.bat                 | 17 +++++++
 bin/windows/kafka-preferred-replica-election.bat   | 17 +++++++
 bin/windows/kafka-producer-perf-test.bat           | 20 ++++++++
 bin/windows/kafka-reassign-partitions.bat          | 17 +++++++
 bin/windows/kafka-replay-log-producer.bat          | 17 +++++++
 bin/windows/kafka-replica-verification.bat         | 17 +++++++
 bin/windows/kafka-simple-consumer-shell.bat        | 17 +++++++
 bin/windows/zookeeper-shell.bat                    | 22 +++++++++
 .../PreferredReplicaLeaderElectionCommand.scala    |  4 ++
 .../kafka/admin/ReassignPartitionsCommand.scala    | 28 +++++------
 core/src/main/scala/kafka/admin/TopicCommand.scala | 10 ++--
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 26 +++-------
 .../main/scala/kafka/tools/ConsoleProducer.scala   | 12 ++---
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 10 ++--
 .../scala/kafka/tools/ConsumerPerformance.scala    | 10 +---
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 10 ++--
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 13 ++---
 .../main/scala/kafka/tools/GetOffsetShell.scala    |  3 ++
 .../main/scala/kafka/tools/ImportZkOffsets.scala   | 13 ++---
 core/src/main/scala/kafka/tools/JmxTool.scala      |  5 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  3 ++
 .../scala/kafka/tools/ProducerPerformance.scala    | 11 ++---
 .../main/scala/kafka/tools/ReplayLogProducer.scala | 12 ++---
 .../kafka/tools/ReplicaVerificationTool.scala      |  4 +-
 .../kafka/tools/SimpleConsumerPerformance.scala    |  9 +---
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 13 ++---
 .../scala/kafka/tools/StateChangeLogMerger.scala   |  5 +-
 .../main/scala/kafka/tools/TestLogCleaning.scala   |  8 ++--
 .../kafka/tools/VerifyConsumerRebalance.scala      | 12 ++---
 .../main/scala/kafka/utils/CommandLineUtils.scala  | 56 +++++++++++++---------
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  8 +---
 37 files changed, 358 insertions(+), 180 deletions(-)
d0c019a07ee63a8c31de2d60513ed8f03494e348

 .../java/org/apache/kafka/clients/producer/internals/Sender.java   | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
dd048d8fee60db7282076a71eeeb8a1d0a4381d9

 core/src/main/scala/kafka/cluster/Partition.scala  |  35 ++++---
 .../scala/kafka/controller/KafkaController.scala   |  31 ++-----
 .../kafka/controller/PartitionStateMachine.scala   |   9 +-
 .../kafka/controller/ReplicaStateMachine.scala     |   6 +-
 .../main/scala/kafka/utils/ReplicationUtils.scala  |  39 ++++----
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  38 +++-----
 .../unit/kafka/utils/ReplicationUtilsTest.scala    | 103 +++++++++------------
 7 files changed, 110 insertions(+), 151 deletions(-)
548d1ba0939c43fff14531510140e2c641b1caa5

 .../org/apache/kafka/clients/ClientRequest.java    |  61 ++
 .../org/apache/kafka/clients/ClientResponse.java   |  78 +++
 .../kafka/clients/ClusterConnectionStates.java     | 113 ++++
 .../org/apache/kafka/clients/ConnectionState.java  |  20 +
 .../org/apache/kafka/clients/InFlightRequests.java | 126 ++++
 .../java/org/apache/kafka/clients/KafkaClient.java |  83 +++
 .../org/apache/kafka/clients/NetworkClient.java    | 383 ++++++++++++
 .../apache/kafka/clients/NodeConnectionState.java  |  31 +
 .../kafka/clients/producer/KafkaProducer.java      |  18 +-
 .../kafka/clients/producer/internals/Metadata.java |   8 +-
 .../producer/internals/RecordAccumulator.java      |  41 +-
 .../clients/producer/internals/RecordBatch.java    |   6 +-
 .../kafka/clients/producer/internals/Sender.java   | 675 ++++-----------------
 .../apache/kafka/common/metrics/Measurable.java    |  28 +-
 .../org/apache/kafka/common/metrics/stats/Avg.java |  29 +-
 .../apache/kafka/common/metrics/stats/Count.java   |  29 +-
 .../org/apache/kafka/common/metrics/stats/Max.java |  29 +-
 .../org/apache/kafka/common/metrics/stats/Min.java |  29 +-
 .../kafka/common/metrics/stats/Percentiles.java    |  37 +-
 .../apache/kafka/common/metrics/stats/Rate.java    |   8 +-
 .../kafka/common/metrics/stats/SampledStat.java    |  18 +-
 .../apache/kafka/common/metrics/stats/Total.java   |  28 +-
 .../kafka/common/network/ByteBufferSend.java       |   2 +-
 .../org/apache/kafka/common/network/Selector.java  |  36 +-
 .../java/org/apache/kafka/common/network/Send.java |  26 +-
 .../apache/kafka/common/protocol/types/Schema.java |  34 +-
 .../apache/kafka/common/record/MemoryRecords.java  |  44 +-
 .../kafka/common/requests/ProduceRequest.java      |  71 +++
 .../kafka/common/requests/ProduceResponse.java     |  87 +--
 .../java/org/apache/kafka/clients/MockClient.java  |  96 +++
 .../apache/kafka/clients/NetworkClientTest.java    |  99 +++
 .../clients/producer/RecordAccumulatorTest.java    |   7 +-
 .../apache/kafka/clients/producer/SenderTest.java  | 132 ++--
 .../apache/kafka/common/metrics/MetricsTest.java   |   2 +-
 .../org/apache/kafka/common/utils/MockTime.java    |  29 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   1 +
 37 files changed, 1582 insertions(+), 964 deletions(-)
dcc88408c98a07cb9a816ab55cd81e55f1d2217d

 .../clients/producer/internals/BufferPool.java     | 31 ++++++++++++++++++----
 .../producer/internals/RecordAccumulator.java      |  2 +-
 .../kafka/clients/producer/BufferPoolTest.java     | 26 +++++++++---------
 3 files changed, 40 insertions(+), 19 deletions(-)
bb01847579dcf86841956c29278649bcf8609732

 .../kafka/clients/producer/internals/Sender.java   | 28 +++++++++++++++++-----
 .../org/apache/kafka/common/record/Compressor.java |  8 +++++++
 .../apache/kafka/common/record/MemoryRecords.java  | 10 ++++++++
 3 files changed, 40 insertions(+), 6 deletions(-)
dee16451e04a4bb905a0479e08fa1f0848fea4fb

 core/src/main/scala/kafka/cluster/Partition.scala  |  40 ++++----
 .../scala/kafka/controller/KafkaController.scala   |  14 ++-
 .../kafka/controller/PartitionStateMachine.scala   |   6 +-
 .../main/scala/kafka/utils/ReplicationUtils.scala  |  83 ++++++++++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  46 ++++-----
 .../unit/kafka/utils/ReplicationUtilsTest.scala    | 110 +++++++++++++++++++++
 6 files changed, 247 insertions(+), 52 deletions(-)
b04a3be54e872599a1e3a0fda488de5f19ce7c24

 .../scala/kafka/controller/KafkaController.scala   | 34 +++++++++++----------
 .../kafka/api/ProducerFailureHandlingTest.scala    |  6 ++--
 .../integration/kafka/api/ProducerSendTest.scala   |  6 ++--
 .../scala/unit/kafka/admin/AddPartitionsTest.scala | 10 +++----
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 14 ++++-----
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |  4 +--
 .../unit/kafka/integration/RollingBounceTest.scala |  8 ++---
 .../scala/unit/kafka/producer/ProducerTest.scala   |  8 ++---
 .../unit/kafka/producer/SyncProducerTest.scala     |  3 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  6 ++--
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 10 +++----
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  4 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 35 ++++++++++++----------
 13 files changed, 75 insertions(+), 73 deletions(-)
6d1992274cce97dc13e5ace099b7af1a69eb3894

 config/test-log4j.properties | 8 +++-----
 1 file changed, 3 insertions(+), 5 deletions(-)
d3007171102a95cd2979fad6dec5d0bbefb57d7a

 core/src/main/scala/kafka/utils/Utils.scala          | 2 +-
 core/src/test/scala/unit/kafka/utils/UtilsTest.scala | 9 +++++++++
 2 files changed, 10 insertions(+), 1 deletion(-)
ee4456a3f45eac7df31a170d6ce9d0a4a2fe98a0

 .../scala/kafka/admin/DeleteTopicCommand.scala     | 66 ----------------------
 core/src/main/scala/kafka/admin/TopicCommand.scala | 16 +++++-
 2 files changed, 13 insertions(+), 69 deletions(-)
1363ed7c5268546e657d2d8d9e9e3aeac2df04d8

 bin/kafka-console-consumer.sh                      |   6 +-
 bin/kafka-console-producer.sh                      |   6 +-
 bin/kafka-consumer-perf-test.sh                    |   6 +-
 bin/kafka-producer-perf-test.sh                    |   6 +-
 bin/kafka-run-class.sh                             |  12 +-
 bin/kafka-simple-consumer-perf-test.sh             |   6 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     | 284 -------------------
 .../scala/kafka/producer/ConsoleProducer.scala     | 299 --------------------
 .../main/scala/kafka/server/OffsetManager.scala    |   5 +-
 .../main/scala/kafka/tools/ConsoleConsumer.scala   | 284 +++++++++++++++++++
 .../main/scala/kafka/tools/ConsoleProducer.scala   | 300 +++++++++++++++++++++
 .../scala/kafka/tools/ConsumerPerformance.scala    | 199 ++++++++++++++
 core/src/main/scala/kafka/tools/PerfConfig.scala   |  60 +++++
 .../scala/kafka/tools/ProducerPerformance.scala    | 286 ++++++++++++++++++++
 .../kafka/tools/SimpleConsumerPerformance.scala    | 163 +++++++++++
 perf/config/log4j.properties                       |  24 --
 .../scala/kafka/perf/ConsumerPerformance.scala     | 199 --------------
 perf/src/main/scala/kafka/perf/PerfConfig.scala    |  60 -----
 .../scala/kafka/perf/ProducerPerformance.scala     | 286 --------------------
 .../kafka/perf/SimpleConsumerPerformance.scala     | 163 -----------
 system_test/broker_failure/bin/run-test.sh         |  40 +--
 .../producer_perf/bin/run-compression-test.sh      |   9 +-
 system_test/producer_perf/bin/run-test.sh          |   9 +-
 system_test/utils/kafka_system_test_utils.py       |  93 ++++---
 24 files changed, 1385 insertions(+), 1420 deletions(-)
df449a24a7bd7b87502cab93c847a0dfea12c6db

 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 67 +++-------------------
 1 file changed, 7 insertions(+), 60 deletions(-)
3a048e80d526d5eaa39ec1588c6ee47af975d015

 system_test/utils/kafka_system_test_utils.py | 34 ++++++++++++++++++++++------
 1 file changed, 27 insertions(+), 7 deletions(-)
02311c0642b3358e8180191ea0542e985ed0f6dc

 .../kafka/clients/producer/KafkaProducer.java      |   1 +
 .../kafka/clients/producer/ProducerConfig.java     |  12 +-
 .../kafka/clients/producer/internals/Sender.java   |  31 ++-
 .../kafka/clients/tools/ProducerPerformance.java   | 220 ++++++++++++++++-----
 .../apache/kafka/clients/producer/SenderTest.java  |   3 +
 core/src/main/scala/kafka/server/KafkaConfig.scala |   4 +-
 .../main/scala/kafka/server/RequestPurgatory.scala |   6 +-
 .../scala/kafka/tools/TestEndToEndLatency.scala    |  17 +-
 8 files changed, 230 insertions(+), 64 deletions(-)
26eb1277e502efe1b1c5c4e4382fc80fa231bade

 core/src/main/scala/kafka/tools/ConsumerOffsetChecker.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e73e90e99984c29151dbae063c72ab737cf99968

 system_test/README.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f8ea4ac01d63831d7f5e170d7669e92fca73b673

 .../scala/kafka/consumer/ConsoleConsumer.scala     | 111 ++++++---------------
 1 file changed, 28 insertions(+), 83 deletions(-)
0ccc1dc08e3664bb2c9bc1548d4d7966e14cc7f9

 .../scala/kafka/tools/ConsumerOffsetChecker.scala    | 20 +++++++++++++-------
 1 file changed, 13 insertions(+), 7 deletions(-)
01ea4eb42dfea5f47586e2f12be2344f7910fee0

 core/src/main/scala/kafka/javaapi/TopicMetadata.scala         |  5 ++++-
 core/src/main/scala/kafka/javaapi/TopicMetadataResponse.scala | 11 +++++++++++
 2 files changed, 15 insertions(+), 1 deletion(-)
547ccedcfa081de2679f9607e4e868041c2cc55f

 build.gradle                                       |  1 +
 .../kafka/common/record/CompressionType.java       | 10 ++++++-
 .../org/apache/kafka/common/record/Compressor.java | 34 ++++++++++++++++++++++
 .../org/apache/kafka/common/record/Record.java     |  4 +--
 config/producer.properties                         |  4 +--
 .../scala/kafka/message/CompressionCodec.scala     | 14 +++++++++
 .../scala/kafka/message/CompressionFactory.scala   |  9 ++++++
 core/src/main/scala/kafka/message/Message.scala    |  4 +--
 .../kafka/message/MessageCompressionTest.scala     | 23 +++++++++++++++
 system_test/producer_perf/config/server.properties |  4 +--
 10 files changed, 98 insertions(+), 9 deletions(-)
52f1149ddbb31ff33d1fd122bb9ffed937be14f6

 .../consumer/ZookeeperConsumerConnector.scala      | 59 ++++++++++++----------
 1 file changed, 31 insertions(+), 28 deletions(-)
d0df33df3df314ccd42f700a592e8efc31e80f87

 .../main/scala/kafka/admin/ShutdownBroker.scala    | 124 ---------------------
 .../scala/kafka/controller/KafkaController.scala   |  51 ++++-----
 core/src/main/scala/kafka/server/KafkaConfig.scala |  64 +++++------
 3 files changed, 53 insertions(+), 186 deletions(-)
bf83131dffbdb6c39de0135e0426701ca141f150

 .../kafka/clients/consumer/KafkaConsumer.java      | 48 ++++++++++++----------
 .../clients/consumer/ConsumerExampleTest.java      |  5 +--
 2 files changed, 29 insertions(+), 24 deletions(-)
c24740c7b0f6a6e7c66659da786a346650b76766

 .../apache/kafka/clients/consumer/Consumer.java    | 125 +++++
 .../kafka/clients/consumer/ConsumerConfig.java     | 187 +++++++
 .../consumer/ConsumerRebalanceCallback.java        |  50 ++
 .../kafka/clients/consumer/ConsumerRecord.java     | 127 +++++
 .../kafka/clients/consumer/ConsumerRecords.java    |  61 +++
 .../kafka/clients/consumer/KafkaConsumer.java      | 575 +++++++++++++++++++++
 .../kafka/clients/consumer/MockConsumer.java       | 192 +++++++
 .../kafka/clients/consumer/OffsetMetadata.java     |  59 +++
 .../kafka/clients/producer/KafkaProducer.java      |  26 +-
 .../org/apache/kafka/common/utils/ClientUtils.java |  44 ++
 .../clients/consumer/ConsumerExampleTest.java      | 298 +++++++++++
 11 files changed, 1720 insertions(+), 24 deletions(-)
bf7fb63218640873781720a494d1114fbe628795

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
345c52ee3581847ddfaa4e53173714d8d97896c5

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 47 +++++++++++++----------
 1 file changed, 26 insertions(+), 21 deletions(-)
b4c1089fa963ec204dc350693a6a69dc929c99c3

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 59 ++++++++++++++++++-----
 1 file changed, 48 insertions(+), 11 deletions(-)
8d454f374b4f879b50825b192617167070749b4f

 .../common/MessageStreamsExistException.scala      | 23 +++++++++++++++++
 .../consumer/ZookeeperConsumerConnector.scala      | 29 +++++++++++-----------
 .../consumer/ZookeeperConsumerConnector.scala      | 17 ++++++++-----
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 23 +++++++++++------
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 26 ++++++++++++-------
 5 files changed, 80 insertions(+), 38 deletions(-)
99f10739b5921534dddc6e3773e4f8a05b8909b0

 .../kafka/clients/producer/KafkaProducer.java      |   2 +-
 .../kafka/clients/producer/MockProducer.java       |   4 +-
 .../kafka/clients/producer/internals/Metadata.java |   2 +-
 .../clients/producer/internals/Partitioner.java    |   4 +-
 .../producer/internals/RecordAccumulator.java      | 125 +++++++++++----------
 .../kafka/clients/producer/internals/Sender.java   |  52 +++------
 .../main/java/org/apache/kafka/common/Cluster.java |  46 ++++++--
 .../clients/producer/RecordAccumulatorTest.java    |  63 ++++++-----
 .../kafka/common/utils/AbstractIteratorTest.java   |   9 +-
 9 files changed, 167 insertions(+), 140 deletions(-)
b866c5506a936572c9a948c4bae68da0d045fc53

 .../scala/kafka/consumer/ConsoleConsumer.scala     | 31 +++++++++++++---------
 1 file changed, 18 insertions(+), 13 deletions(-)
c179c45f2375cb1253e519d0be8c8e9e6ff679f6

 core/src/main/scala/kafka/api/ConsumerMetadataResponse.scala   | 10 +++++-----
 core/src/main/scala/kafka/client/ClientUtils.scala             |  2 +-
 .../main/scala/kafka/javaapi/ConsumerMetadataResponse.scala    |  2 +-
 core/src/test/scala/other/kafka/TestOffsetManager.scala        |  2 +-
 .../unit/kafka/api/RequestResponseSerializationTest.scala      |  3 ++-
 core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala   |  2 +-
 6 files changed, 11 insertions(+), 10 deletions(-)
31e32b386b7c31ca6b69f883a94268902e2cf17b

 .../kafka/api/ProducerFailureHandlingTest.scala    | 45 ++++++++--------------
 .../integration/kafka/api/ProducerSendTest.scala   |  2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 20 ++++++++--
 3 files changed, 34 insertions(+), 33 deletions(-)
1d35cce79d3f2e928fe27d109f962c0a9dda73ea

 kafka-patch-review.py | 35 ++++++++++++++++++++++++-----------
 1 file changed, 24 insertions(+), 11 deletions(-)
754dacb90b48ee2cd226d544ab0c9cefa692f171

 system_test/utils/kafka_system_test_utils.py | 1 +
 1 file changed, 1 insertion(+)
2848a7ab5e80bce9007420517a634229e03ec6f9

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 43 +++++++++++++----------
 1 file changed, 24 insertions(+), 19 deletions(-)
4fe5c46848821872fb6e21513cd47d564242c576

 .../src/main/scala/kafka/server/BrokerStates.scala | 80 ++++++++++++++++++++++
 1 file changed, 80 insertions(+)
9b6bf407874ef0fda12d8b2cc7f8331ce4aebeea

 .../scala/kafka/controller/KafkaController.scala   |  7 ++-
 core/src/main/scala/kafka/log/LogManager.scala     |  6 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 26 +++++++--
 .../scala/kafka/server/KafkaServerStartable.scala  |  8 +++
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 64 +++++++++++++++++++---
 .../server/HighwatermarkPersistenceTest.scala      |  1 +
 .../unit/kafka/server/ReplicaManagerTest.scala     |  1 +
 7 files changed, 97 insertions(+), 16 deletions(-)
44c39c4ea48f365445b8c08ce57d0f16b15f0d0b

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  18 +-
 .../controller/ControllerChannelManager.scala      |  14 +-
 .../scala/kafka/controller/KafkaController.scala   |   8 +-
 .../kafka/controller/ReplicaStateMachine.scala     |  10 +-
 .../kafka/controller/TopicDeletionManager.scala    |  60 +-
 core/src/main/scala/kafka/log/LogManager.scala     |   1 -
 .../main/scala/kafka/server/ReplicaManager.scala   |  11 +-
 .../scala/kafka/utils/ShutdownableThread.scala     |  27 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 612 +++++++++------------
 .../kafka/server/DynamicConfigChangeTest.scala     |  17 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 -
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   2 +
 12 files changed, 376 insertions(+), 406 deletions(-)
3f7a9061b4d1b9ef9e0f4dae3117fd985f84e072

 .../main/scala/kafka/producer/BaseProducer.scala   |  69 ++++++++
 .../kafka/producer/ByteArrayPartitioner.scala      |   2 +-
 .../scala/kafka/producer/ConsoleProducer.scala     | 123 ++++++--------
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 152 +++++++++++------
 .../kafka/tools/newproducer/MirrorMaker.scala      | 187 ---------------------
 .../scala/kafka/perf/ProducerPerformance.scala     | 127 ++++++--------
 system_test/utils/kafka_system_test_utils.py       |   2 +-
 7 files changed, 270 insertions(+), 392 deletions(-)
fe18595492ee91a6a8a796b21c66a682ee9db4a0

 core/src/main/scala/kafka/consumer/KafkaStream.scala | 3 +++
 1 file changed, 3 insertions(+)
0062d4cc94843bfc67b1cb03bad708a8121f9d06

 .../kafka/api/ProducerFailureHandlingTest.scala    | 21 +++++---------------
 .../integration/kafka/api/ProducerSendTest.scala   | 18 +++++------------
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 23 ++++++++++++++++++++++
 3 files changed, 33 insertions(+), 29 deletions(-)
198c793ab1f96f1fc4b46ec35aa7008335583fdc

 core/src/main/scala/kafka/log/Log.scala | 8 ++++++++
 1 file changed, 8 insertions(+)
6b4217d192275e35b6b6d1a73ef37dcba46d1ac1

 .../consumer/ZookeeperConsumerConnectorTest.scala  |  34 +++---
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  42 ++++----
 .../unit/kafka/producer/AsyncProducerTest.scala    |  22 ++--
 .../scala/unit/kafka/producer/ProducerTest.scala   | 117 ++++++++++++---------
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  17 ++-
 5 files changed, 123 insertions(+), 109 deletions(-)
3de97c7c4039783f4a5d1db9de48f6778123a953

 core/src/test/scala/unit/kafka/network/SocketServerTest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
bbb357c174ffe4ead1229301847c08c3879c6723

 core/src/main/scala/kafka/utils/Utils.scala | 18 ++++++++++++------
 1 file changed, 12 insertions(+), 6 deletions(-)
2f5666408fa9cf44c59f068f19d654a4b7b52914

 core/src/test/scala/unit/kafka/network/SocketServerTest.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
631536327e3aad866d7c797984794a8800fa9fc3

 core/src/main/scala/kafka/server/MetadataCache.scala | 13 +++----------
 core/src/test/scala/unit/kafka/admin/AdminTest.scala | 10 +++++-----
 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 10 +++++++++-
 3 files changed, 17 insertions(+), 16 deletions(-)
8a0314d01786541f06d0eb41b2e81c8bb1d45a8d

 .../kafka/integration/AutoOffsetResetTest.scala    | 61 +++++----------
 .../scala/unit/kafka/integration/FetcherTest.scala |  6 +-
 .../integration/ProducerConsumerTestHarness.scala  | 12 ++-
 .../integration/UncleanLeaderElectionTest.scala    |  7 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 25 ++++---
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 86 +++++++---------------
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  6 +-
 .../unit/kafka/server/ServerShutdownTest.scala     | 28 ++++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 38 ++++++----
 9 files changed, 116 insertions(+), 153 deletions(-)
c9bb24f153e0975f68386cd7818feceb3ebade3e

 .../test/scala/unit/kafka/admin/AdminTest.scala    | 50 ++++++++++++++--------
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 25 +++++++----
 .../unit/kafka/network/SocketServerTest.scala      |  7 ++-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  6 ++-
 .../unit/kafka/server/LeaderElectionTest.scala     |  3 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    | 13 +++---
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 26 ++++++-----
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 37 ++++++++++------
 9 files changed, 100 insertions(+), 69 deletions(-)
0bd4c87f9f88fe7f011c7eefc0410132fcf30ff2

 core/src/main/scala/kafka/cluster/Partition.scala  | 39 +++++++-------
 core/src/main/scala/kafka/log/Log.scala            | 62 +++++++++++++++-------
 core/src/main/scala/kafka/message/MessageSet.scala | 12 +----
 core/src/main/scala/kafka/server/KafkaApis.scala   | 27 +++++-----
 .../scala/kafka/server/KafkaRequestHandler.scala   |  2 +-
 5 files changed, 79 insertions(+), 63 deletions(-)
e69c613274250bca2bd40a2b3523b55c8231978b

 core/src/test/scala/unit/kafka/producer/ProducerTest.scala | 1 +
 1 file changed, 1 insertion(+)
3ebbaaea99d9ce94026fb1eef7d024839cf2e436

 .../test/scala/integration/kafka/api/ProducerCompressionTest.scala  | 4 +++-
 .../scala/integration/kafka/api/ProducerFailureHandlingTest.scala   | 6 +++---
 .../scala/unit/kafka/integration/UncleanLeaderElectionTest.scala    | 2 +-
 core/src/test/scala/unit/kafka/producer/ProducerTest.scala          | 6 ++++++
 4 files changed, 13 insertions(+), 5 deletions(-)
0efdfa6f7b6be688d5c531e801c9d37882e55f7f

 core/src/main/scala/kafka/admin/TopicCommand.scala |  2 +-
 .../controller/ControllerChannelManager.scala      |  4 +-
 .../kafka/tools/ReplicaVerificationTool.scala      |  2 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala | 52 +++++++---------------
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  3 +-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  5 +--
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 21 ++++-----
 .../kafka/integration/AutoOffsetResetTest.scala    |  2 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  5 +--
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  5 +--
 .../unit/kafka/integration/RollingBounceTest.scala | 36 +++------------
 .../unit/kafka/integration/TopicMetadataTest.scala | 15 +++----
 .../integration/UncleanLeaderElectionTest.scala    |  6 +--
 .../unit/kafka/producer/AsyncProducerTest.scala    |  2 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   | 25 +++--------
 .../unit/kafka/producer/SyncProducerTest.scala     |  3 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  9 +---
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  6 +--
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 33 +++-----------
 .../scala/unit/kafka/server/OffsetCommitTest.scala | 11 ++---
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  4 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |  6 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 30 ++++++++++---
 23 files changed, 95 insertions(+), 192 deletions(-)
93af67cd4f75d2f4cc3a25ad999fe6349925504e

 .../kafka/clients/producer/internals/Metadata.java |  14 +--
 .../producer/internals/RecordAccumulator.java      |  26 ++--
 .../clients/producer/internals/RecordBatch.java    |  12 +-
 .../kafka/clients/producer/internals/Sender.java   | 133 +++++++++++----------
 .../apache/kafka/common/metrics/KafkaMetric.java   |   6 +-
 .../apache/kafka/common/metrics/Measurable.java    |   4 +-
 .../apache/kafka/common/metrics/MetricConfig.java  |  10 +-
 .../org/apache/kafka/common/metrics/Sensor.java    |  18 +--
 .../java/org/apache/kafka/common/metrics/Stat.java |   4 +-
 .../org/apache/kafka/common/metrics/stats/Avg.java |   4 +-
 .../apache/kafka/common/metrics/stats/Count.java   |   4 +-
 .../org/apache/kafka/common/metrics/stats/Max.java |   4 +-
 .../org/apache/kafka/common/metrics/stats/Min.java |   4 +-
 .../kafka/common/metrics/stats/Percentiles.java    |  18 +--
 .../apache/kafka/common/metrics/stats/Rate.java    |  28 ++---
 .../kafka/common/metrics/stats/SampledStat.java    |  60 +++++-----
 .../apache/kafka/common/metrics/stats/Total.java   |   4 +-
 .../org/apache/kafka/common/network/Selector.java  |  16 +--
 .../org/apache/kafka/common/utils/SystemTime.java  |   1 +
 .../apache/kafka/common/metrics/MetricsTest.java   |  26 ++--
 .../org/apache/kafka/test/Microbenchmarks.java     |   4 +-
 21 files changed, 202 insertions(+), 198 deletions(-)
caafc9d614dcb8584fbaf01902fbeaf2d5ea6786

 core/src/main/scala/kafka/server/KafkaApis.scala   | 186 +++------------------
 .../main/scala/kafka/server/MetadataCache.scala    | 151 +++++++++++++++++
 .../main/scala/kafka/server/ReplicaManager.scala   |  20 ++-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   4 +-
 4 files changed, 194 insertions(+), 167 deletions(-)
ed68ba402e088070da0513a3675ed420ec6a70b0

 .../kafka/integration/LazyInitProducerTest.scala   | 173 ---------------------
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  18 +--
 .../unit/kafka/producer/AsyncProducerTest.scala    |  36 -----
 3 files changed, 1 insertion(+), 226 deletions(-)
150d0a70cbe2b1f980e9565a4fa59b0420d1c0a1

 gradle.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3af3efe3773348fd7adb8ca43f2abc5490416e55

 core/src/main/scala/kafka/log/LogCleaner.scala        | 10 ++++++----
 core/src/main/scala/kafka/log/LogCleanerManager.scala | 18 ++++++++++--------
 2 files changed, 16 insertions(+), 12 deletions(-)
874620d965c066519686315c591e09aa379304d6

 core/src/main/scala/kafka/log/LogCleaner.scala       | 10 ++++++----
 .../src/main/scala/kafka/log/LogCleanerManager.scala | 20 +++++++++++---------
 2 files changed, 17 insertions(+), 13 deletions(-)
1e9e107ee92b9b8b37c22eb9ecf0db67a445000a

 core/src/main/scala/kafka/server/KafkaApis.scala | 25 ++++++++++++++----------
 1 file changed, 15 insertions(+), 10 deletions(-)
69fbdf9cb39895198c14f00b483a3a3f47936b78

 core/src/main/scala/kafka/log/Log.scala            |  3 ++
 core/src/main/scala/kafka/log/LogCleaner.scala     | 43 ++++++++++++++++++++--
 .../main/scala/kafka/log/LogCleanerManager.scala   | 27 +++++++++-----
 core/src/main/scala/kafka/utils/Throttler.scala    | 12 ++++--
 4 files changed, 69 insertions(+), 16 deletions(-)
4bcb22f47e594c127b02d001620fd1f453034b2a

 .../src/main/scala/kafka/server/TopicConfigManager.scala |  6 +++---
 .../unit/kafka/server/DynamicConfigChangeTest.scala      | 16 ++++++++++++++++
 2 files changed, 19 insertions(+), 3 deletions(-)
2ce7ff6b6e56aa480792a298a8a92ef02e67a2f8

 .../scala/kafka/server/TopicConfigManager.scala    | 52 +++++++++++++---------
 .../kafka/server/DynamicConfigChangeTest.scala     | 35 +++++++++++++++
 2 files changed, 67 insertions(+), 20 deletions(-)
89f040c8c9807fc4f9e219f0b57279b692b6e45d

 .../src/main/scala/kafka/server/TopicConfigManager.scala |  6 +++---
 .../unit/kafka/server/DynamicConfigChangeTest.scala      | 16 ++++++++++++++++
 2 files changed, 19 insertions(+), 3 deletions(-)
b18d2c379bbaf65629c041f75918a4711e4063d6

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  2 +
 .../controller/ControllerChannelManager.scala      | 55 ++++++++++++----------
 .../scala/kafka/controller/KafkaController.scala   |  8 ++--
 .../kafka/controller/TopicDeletionManager.scala    | 17 ++++---
 core/src/main/scala/kafka/server/KafkaApis.scala   | 30 ++++++------
 5 files changed, 64 insertions(+), 48 deletions(-)
037c054be260bcc3b470b9724572cb814b704bff

 README.md                                          |  10 +
 build.gradle                                       | 107 +++++++----
 contrib/LICENSE                                    |   1 +
 contrib/NOTICE                                     |   1 +
 contrib/hadoop-consumer/LICENSE                    | 203 ---------------------
 contrib/hadoop-producer/LICENSE                    | 203 ---------------------
 .../scala/kafka/utils/VerifiableProperties.scala   |   4 +-
 7 files changed, 89 insertions(+), 440 deletions(-)
7502696e105057bdb2b546de7a774ea62cda766a

 README.md                                          |  10 +
 build.gradle                                       | 107 +++++++----
 contrib/LICENSE                                    |   1 +
 contrib/NOTICE                                     |   1 +
 contrib/hadoop-consumer/LICENSE                    | 203 ---------------------
 contrib/hadoop-producer/LICENSE                    | 203 ---------------------
 .../scala/kafka/utils/VerifiableProperties.scala   |   4 +-
 7 files changed, 89 insertions(+), 440 deletions(-)
8b052150f55fb9a6f8c4aedc6b3fa0528719671e

 .../scala/kafka/producer/ConsoleProducer.scala     | 37 ++++++++++++----------
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  4 +--
 .../scala/kafka/tools/TestEndToEndLatency.scala    |  8 ++---
 .../main/scala/kafka/tools/TestLogCleaning.scala   |  6 ++--
 4 files changed, 30 insertions(+), 25 deletions(-)
eaf514b41a54242c825eab972765e2a764cd0b7f

 core/src/main/scala/kafka/server/KafkaApis.scala | 40 +++++++++++-------------
 1 file changed, 18 insertions(+), 22 deletions(-)
b9351e04f0a26f2f9e4abc7ec526ed802495f991

 .../scala/kafka/server/TopicConfigManager.scala    | 52 +++++++++++++---------
 .../kafka/server/DynamicConfigChangeTest.scala     | 35 +++++++++++++++
 2 files changed, 67 insertions(+), 20 deletions(-)
839f1b1220d2f32fe10ceb51474efaddf1968e25

 core/src/main/scala/kafka/controller/KafkaController.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
82f4a8e1c05a4ef197ef94e6f09c3132f5628037

 core/src/main/scala/kafka/api/TopicMetadata.scala  |   8 +-
 .../scala/kafka/controller/KafkaController.scala   |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   | 260 ++++++++++++---------
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  10 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   2 +-
 6 files changed, 160 insertions(+), 125 deletions(-)
3c4ca854fd2da5e5fcecdaf0856a38a9ebe4763c

 core/src/main/scala/kafka/cluster/Partition.scala  |  2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 78 ++++++++++++++++++----
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 37 +++++-----
 .../unit/kafka/server/ReplicaManagerTest.scala     | 55 +++++++++++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 +++
 7 files changed, 140 insertions(+), 46 deletions(-)
97f13ec73255f3978c1cbb80ea26f446cf756515

 core/src/main/scala/kafka/cluster/Partition.scala  |  2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 78 ++++++++++++++++++----
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 27 ++++----
 .../unit/kafka/server/ReplicaManagerTest.scala     | 48 ++++++++++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 +++
 7 files changed, 132 insertions(+), 37 deletions(-)
ec075c5a853e4168ff30cf133493588671aa2fac

 .../kafka/clients/producer/internals/Sender.java   | 104 ++++++++++++---------
 .../org/apache/kafka/common/network/Selector.java  |  90 +++++++++++-------
 2 files changed, 118 insertions(+), 76 deletions(-)
9a6f7113ed630d8e6bb50f4a58846d976a2d5f97

 core/src/main/scala/kafka/api/FetchRequest.scala   |   2 +-
 .../main/scala/kafka/api/RequestOrResponse.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  35 -
 .../kafka/api/ProducerFailureHandlingTest.scala    |  17 +
 .../integration/kafka/api/ProducerSendTest.scala   |   2 +-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  16 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   4 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 716 ++++++++++-----------
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |   2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  28 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |  41 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |   2 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   4 +-
 .../unit/kafka/integration/RollingBounceTest.scala |  10 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |   2 +-
 .../integration/UncleanLeaderElectionTest.scala    |  21 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   4 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  18 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |   8 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  12 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   2 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  16 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   4 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |   2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  59 +-
 27 files changed, 520 insertions(+), 515 deletions(-)
4bd33e5ba792667913991638a15f0a2c9f20d7b5

 bin/windows/kafka-console-consumer.bat |   4 +-
 bin/windows/kafka-console-producer.bat |   5 +-
 bin/windows/kafka-run-class.bat        | 111 ++++++++++++++++++++++-----------
 bin/windows/kafka-server-start.bat     |  15 +++--
 bin/windows/kafka-topics.bat           |  17 +++++
 bin/windows/zookeeper-server-start.bat |  10 ++-
 6 files changed, 111 insertions(+), 51 deletions(-)
2bfd49b955831f3455ff486ce4f613d73239a317

 .../scala/unit/kafka/admin/AddPartitionsTest.scala | 41 ++++++----------------
 1 file changed, 10 insertions(+), 31 deletions(-)
d37ca7f627551c9960e2edb8498784bf2487d53e

 core/src/test/scala/unit/kafka/server/LogRecoveryTest.scala | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
05612ac44de775cf3bc8ffdc15c033920d4a1440

 core/src/test/scala/unit/kafka/server/LogOffsetTest.scala | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)
6bb616e5ae6a2f45cfa190e245c9217a8bf9771a

 doap_Kafka.rdf | 57 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 57 insertions(+)
a3a2cba842a9945d4ce7b032e311d17956c33249

 .../scala/kafka/controller/TopicDeletionManager.scala    | 16 +++++++++++++---
 1 file changed, 13 insertions(+), 3 deletions(-)
2d429e19da22416aeb7de68b9e00f33a337e31a0

 system_test/utils/kafka_system_test_utils.py | 1 +
 1 file changed, 1 insertion(+)
48f1b74909df3c08553a7783ddae9d93c41da7cf

 core/src/main/scala/kafka/log/LogCleanerManager.scala            | 9 +++++----
 core/src/main/scala/kafka/server/KafkaConfig.scala               | 2 +-
 core/src/main/scala/kafka/server/OffsetCheckpoint.scala          | 2 +-
 .../test/scala/unit/kafka/log/LogCleanerIntegrationTest.scala    | 2 +-
 4 files changed, 8 insertions(+), 7 deletions(-)
44ee6b7c9d9da207bebe6d927b38ed7df1388df3

 .../main/scala/kafka/network/RequestChannel.scala  |  4 +++
 .../main/scala/kafka/network/SocketServer.scala    | 28 +++++++++++++++----
 .../scala/kafka/server/KafkaRequestHandler.scala   | 31 ++++++++++++++++++----
 3 files changed, 53 insertions(+), 10 deletions(-)
47019a849e69209c16defa81001055aa9f57674d

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
911ff524515148421ff58b41f271c21f792ed9de

 .../src/test/scala/unit/kafka/server/ReplicaManagerTest.scala | 11 +++++------
 1 file changed, 5 insertions(+), 6 deletions(-)
8d15de85114da6012530f0dd837f131bd1e367cd

 core/src/main/scala/kafka/log/LogCleanerManager.scala            | 9 +++++----
 core/src/main/scala/kafka/server/KafkaConfig.scala               | 2 +-
 core/src/main/scala/kafka/server/OffsetCheckpoint.scala          | 2 +-
 core/src/main/scala/kafka/server/OffsetManager.scala             | 2 +-
 .../test/scala/unit/kafka/log/LogCleanerIntegrationTest.scala    | 2 +-
 5 files changed, 9 insertions(+), 8 deletions(-)
75d5f5bff8519b36d5eb0a904ebbd0d3c0b7c8cc

 README.md | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
de6066e8e78e62739e3eb6f771d0739bf9b73dfd

 gradlew.bat | 90 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 90 insertions(+)
33e07a61f9a0455da544659b62e4ce8ffca7e9ab

 .gitignore | 2 ++
 1 file changed, 2 insertions(+)
a39f2c18c027708ff5830a81c1263c6ebb073445

 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 2 +-
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala        | 2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala                    | 6 +++---
 3 files changed, 5 insertions(+), 5 deletions(-)
69655d5fb92ea7e15ebcbfbe345bea9fe04f69d1

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)
0e1d853c04cb2fe86cf98f0b1006a96e1bb1e177

 core/src/main/scala/kafka/api/TopicMetadata.scala  |   8 +-
 .../scala/kafka/controller/KafkaController.scala   |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   | 222 +++++++++++++--------
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  10 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   2 +-
 6 files changed, 150 insertions(+), 97 deletions(-)
8f94bc3315e7d469489da55f94e08a51235c01f3

 .../org/apache/kafka/common/config/ConfigDef.java  |  5 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  | 33 +++++++------
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 54 ++++------------------
 3 files changed, 33 insertions(+), 59 deletions(-)
a840c73c36f10e212190ca4ed3918af08a8810e6

 .../mirror_maker_testsuite/config/mirror_producer.properties       | 7 +++++++
 1 file changed, 7 insertions(+)
62fcaedd66c46d8c15e1fd1725badcd575b10849

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  2 +
 .../controller/ControllerChannelManager.scala      | 55 ++++++++++++----------
 .../scala/kafka/controller/KafkaController.scala   |  8 ++--
 .../kafka/controller/TopicDeletionManager.scala    | 17 ++++---
 core/src/main/scala/kafka/server/KafkaApis.scala   | 34 ++++++-------
 5 files changed, 62 insertions(+), 54 deletions(-)
640f3b05efd00d5e1d7bfc8fe9c90c7aadc3d087

 .../kafka/clients/producer/KafkaProducer.java      |  38 ++-
 .../kafka/clients/producer/ProducerConfig.java     | 285 +++++++++++----------
 .../kafka/clients/tools/ProducerPerformance.java   |  10 +-
 .../apache/kafka/common/config/AbstractConfig.java |  21 ++
 .../org/apache/kafka/common/config/ConfigDef.java  | 130 ++++++++--
 .../apache/kafka/common/metrics/JmxReporter.java   |   6 +-
 .../kafka/common/metrics/MetricsReporter.java      |  30 +--
 .../apache/kafka/common/config/ConfigDefTest.java  |  52 ++--
 .../kafka/api/ProducerCompressionTest.scala        |   2 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |  14 +-
 .../integration/kafka/api/ProducerSendTest.scala   |  10 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |  17 +-
 .../config/mirror_producer.properties              |   7 +-
 13 files changed, 376 insertions(+), 246 deletions(-)
0ffec142a991849833d9767be07e895428ccaea1

 core/src/main/scala/kafka/controller/KafkaController.scala | 1 +
 1 file changed, 1 insertion(+)
2b6375b61c0137cdff4b7c25967405f6f521489a

 core/src/main/scala/kafka/controller/KafkaController.scala | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
3721821108ef344423ebe149a4dad96a3b2f989f

 .../main/scala/kafka/producer/ConsoleProducer.scala   | 19 +++++++++++++------
 1 file changed, 13 insertions(+), 6 deletions(-)
4f23ed32debfd77272ee972ed064567d7d614bf2

 core/src/main/scala/kafka/log/Log.scala            |  3 ++
 core/src/main/scala/kafka/log/LogCleaner.scala     | 43 ++++++++++++++++++++--
 .../main/scala/kafka/log/LogCleanerManager.scala   | 25 +++++++++----
 core/src/main/scala/kafka/utils/Throttler.scala    | 12 ++++--
 4 files changed, 68 insertions(+), 15 deletions(-)
98952b3cc7bb9b08ad553da014c80b79d0bc24d6

 .../kafka/clients/producer/KafkaProducer.java      | 18 +++++------
 .../kafka/clients/producer/internals/Sender.java   | 10 +++---
 .../org/apache/kafka/common/network/Selector.java  | 36 ++++++++++------------
 3 files changed, 29 insertions(+), 35 deletions(-)
bd784aeb20b6a4252675c681116b47ea86402130

 system_test/README.txt                             |  5 +-
 .../0.7/config/log4j.properties                    | 78 ++++++++++++++++++++++
 .../config/migration_producer.properties           |  2 +
 .../migration_tool_test.py                         |  5 --
 system_test/utils/kafka_system_test_utils.py       | 23 +++++--
 5 files changed, 100 insertions(+), 13 deletions(-)
083b6265c93619dd8b672c59fc31f0ed3d5da29b

 clients/src/main/java/org/apache/kafka/common/network/Selector.java | 5 +++--
 .../src/test/java/org/apache/kafka/common/network/SelectorTest.java | 6 ++++++
 2 files changed, 9 insertions(+), 2 deletions(-)
f82ce3314f74c6755f09eec1044cf68ea6d1dc9f

 core/src/main/scala/kafka/cluster/Partition.scala          |  2 +-
 .../scala/kafka/controller/ControllerChannelManager.scala  |  4 ++--
 core/src/main/scala/kafka/controller/KafkaController.scala |  6 ++++--
 .../scala/kafka/controller/PartitionStateMachine.scala     |  2 +-
 .../main/scala/kafka/controller/ReplicaStateMachine.scala  |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala           | 14 ++++++--------
 core/src/main/scala/kafka/server/ReplicaManager.scala      |  2 +-
 7 files changed, 16 insertions(+), 16 deletions(-)
1d5bbc8b5afa35d7a7784670bcea4e9cf2093723

 system_test/mirror_maker_testsuite/config/mirror_producer.properties | 1 +
 1 file changed, 1 insertion(+)
dd08538a4f942695852949cc1e455c38f148486c

 core/src/main/scala/kafka/cluster/Partition.scala          |  2 +-
 .../scala/kafka/controller/ControllerChannelManager.scala  |  4 ++--
 core/src/main/scala/kafka/controller/KafkaController.scala |  6 ++++--
 .../scala/kafka/controller/PartitionStateMachine.scala     |  2 +-
 .../main/scala/kafka/controller/ReplicaStateMachine.scala  |  2 +-
 core/src/main/scala/kafka/network/RequestChannel.scala     |  9 ++++++---
 core/src/main/scala/kafka/server/KafkaApis.scala           | 14 ++++++--------
 core/src/main/scala/kafka/server/ReplicaManager.scala      |  2 +-
 8 files changed, 22 insertions(+), 19 deletions(-)
5a6a1d83b81caaebec0f10a0039b422acaeb5c35

 .../main/scala/kafka/controller/TopicDeletionManager.scala    | 11 +++++------
 1 file changed, 5 insertions(+), 6 deletions(-)
fb92b3a2cdf571715b948f81f1f8bb4bc363d497

 .../scala/kafka/controller/KafkaController.scala   | 12 ++--------
 .../kafka/controller/TopicDeletionManager.scala    | 27 ++++++++++++++--------
 .../unit/kafka/server/ServerShutdownTest.scala     | 20 ++++++++++++++++
 3 files changed, 39 insertions(+), 20 deletions(-)
e287e02b12ca3ca00184fabf07a7dc0a52571a23

 .../apache/kafka/clients/producer/internals/Sender.java  | 16 +++++++++-------
 .../java/org/apache/kafka/common/network/Selector.java   |  2 +-
 2 files changed, 10 insertions(+), 8 deletions(-)
23d7fc470638c4dffa5ca005ef2e3d34c14dc92e

 .../kafka/clients/producer/KafkaProducer.java      |  46 +++--
 .../kafka/clients/producer/ProducerConfig.java     |  15 +-
 .../producer/internals/FutureRecordMetadata.java   |  25 +--
 .../producer/internals/RecordAccumulator.java      |  37 ++--
 .../clients/producer/internals/RecordBatch.java    |   6 +-
 .../kafka/clients/producer/internals/Sender.java   | 218 +++++++++++++++++----
 .../kafka/clients/tools/ProducerPerformance.java   |  39 ++--
 .../org/apache/kafka/common/metrics/Metrics.java   |  61 +++---
 .../org/apache/kafka/common/metrics/Sensor.java    |  45 +++--
 .../kafka/common/metrics/stats/Percentiles.java    |   2 +-
 .../apache/kafka/common/metrics/stats/Rate.java    |  42 ++--
 .../kafka/common/metrics/stats/SampledStat.java    |  49 ++---
 .../kafka/common/network/ByteBufferSend.java       |  30 +--
 .../kafka/common/network/NetworkReceive.java       |  24 +--
 .../org/apache/kafka/common/network/Selector.java  | 109 ++++++++++-
 .../apache/kafka/common/utils/CopyOnWriteMap.java  |  26 ++-
 .../kafka/clients/producer/MetadataTest.java       |  24 +--
 .../clients/producer/RecordAccumulatorTest.java    |   8 +-
 .../apache/kafka/clients/producer/SenderTest.java  |   2 +
 .../apache/kafka/common/metrics/MetricsTest.java   |  40 ++--
 .../apache/kafka/common/network/SelectorTest.java  |  34 ++--
 .../java/org/apache/kafka/test/MetricsBench.java   |  27 ++-
 .../org/apache/kafka/test/Microbenchmarks.java     |  63 ++++--
 config/log4j.properties                            |   2 +-
 24 files changed, 643 insertions(+), 331 deletions(-)
9bc47bc1365d17c34f8d43239846de28219a663c

 .../kafka/common/record/ByteBufferInputStream.java |  49 +++++
 .../common/record/ByteBufferOutputStream.java      |  57 +++++
 .../org/apache/kafka/common/record/Compressor.java | 244 +++++++++++++++++++++
 .../org/apache/kafka/common/utils/CrcTest.java     |  59 +++++
 .../kafka/api/ProducerCompressionTest.scala        | 126 +++++++++++
 5 files changed, 535 insertions(+)
466a83b78c2bfcb9ac3116748394e7845a99bf7a

 build.gradle                                       |   3 +-
 .../kafka/clients/producer/KafkaProducer.java      |   4 +-
 .../kafka/clients/producer/ProducerConfig.java     |  10 +-
 .../clients/producer/internals/BufferPool.java     |  31 ++--
 .../producer/internals/RecordAccumulator.java      |  43 +++---
 .../clients/producer/internals/RecordBatch.java    |   7 +-
 .../kafka/clients/tools/ProducerPerformance.java   |   6 +-
 .../kafka/common/record/CompressionType.java       |   7 +-
 .../apache/kafka/common/record/MemoryRecords.java  | 168 ++++++++++++++++-----
 .../org/apache/kafka/common/record/Record.java     | 122 ++++++++++-----
 .../java/org/apache/kafka/common/utils/Crc32.java  |  36 +++++
 .../java/org/apache/kafka/common/utils/Utils.java  |  24 ---
 .../kafka/common/record/MemoryRecordsTest.java     |  32 ++--
 .../org/apache/kafka/common/record/RecordTest.java |  13 +-
 .../test/java/org/apache/kafka/test/TestUtils.java |   2 +-
 .../scala/kafka/producer/ConsoleProducer.scala     |   4 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    |   6 +-
 .../integration/kafka/api/ProducerSendTest.scala   |  26 ++--
 .../scala/kafka/perf/ProducerPerformance.scala     |   1 +
 19 files changed, 367 insertions(+), 178 deletions(-)
39a560789e65e28cc91468933487c0b23e1a1db0

 .../scala/kafka/controller/KafkaController.scala   | 19 ++++++-------------
 .../kafka/controller/TopicDeletionManager.scala    | 22 +++++++++++++++-------
 .../unit/kafka/server/ServerShutdownTest.scala     | 20 ++++++++++++++++++++
 3 files changed, 41 insertions(+), 20 deletions(-)
655e1a8aa5a2fbb5bb8551b6efd4eec27a606039

 build.gradle | 1 -
 1 file changed, 1 deletion(-)
455c490f63692de076bbf06749bf4aec8f481bbc

 build.gradle | 1 -
 1 file changed, 1 deletion(-)
d9be502bcc6b9d7e5716c01d2273189c00506f53

 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 .../server/HighwatermarkPersistenceTest.scala      |  2 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 46 ++++++++++++++++++++++
 3 files changed, 48 insertions(+), 2 deletions(-)
c66e408b244de52f1c5c5bbd7627aa1f028f9a87

 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 .../server/HighwatermarkPersistenceTest.scala      |  2 +-
 .../unit/kafka/server/ReplicaManagerTest.scala     | 46 ++++++++++++++++++++++
 3 files changed, 48 insertions(+), 2 deletions(-)
03762453fb867ed215ecb96ea27f6f482094de04

 core/src/main/scala/kafka/admin/TopicCommand.scala | 19 ++----
 .../kafka/controller/PartitionStateMachine.scala   |  3 +-
 .../kafka/controller/TopicDeletionManager.scala    | 76 ++++++++++++++--------
 core/src/main/scala/kafka/server/KafkaConfig.scala |  3 +
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 12 +++-
 5 files changed, 67 insertions(+), 46 deletions(-)
80e92064dcc1fdcf96af91b73816f5bb16fe6536

 README.md | 2 ++
 1 file changed, 2 insertions(+)
8477b4f2a216562e36e0e09b105fdc4daa503e96

 .gitignore | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
4484916d656243384d91e172a8e0b7ca240785f0

 core/src/main/scala/kafka/admin/TopicCommand.scala | 19 ++----
 .../kafka/controller/PartitionStateMachine.scala   |  3 +-
 .../kafka/controller/TopicDeletionManager.scala    | 78 ++++++++++++++--------
 core/src/main/scala/kafka/server/KafkaConfig.scala |  4 ++
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 12 +++-
 5 files changed, 69 insertions(+), 47 deletions(-)
74e22092519270428c067a5209ec3028e0745bea

 .../apache/kafka/common/metrics/JmxReporter.java   | 32 ++++++++++++----------
 1 file changed, 18 insertions(+), 14 deletions(-)
cc859dcca791dc8e1e6eeabe8b88387a11241b24

 .../org/apache/kafka/clients/producer/internals/BufferPool.java   | 3 ++-
 .../kafka/clients/producer/internals/ErrorLoggingCallback.java    | 8 +++++---
 .../org/apache/kafka/clients/producer/internals/Metadata.java     | 8 +++++---
 .../kafka/clients/producer/internals/RecordAccumulator.java       | 6 +++---
 .../main/java/org/apache/kafka/common/config/AbstractConfig.java  | 6 +++++-
 .../src/main/java/org/apache/kafka/common/config/ConfigDef.java   | 2 +-
 .../src/main/java/org/apache/kafka/common/network/Selector.java   | 5 ++++-
 .../main/java/org/apache/kafka/common/protocol/types/Struct.java  | 4 +++-
 .../test/java/org/apache/kafka/common/network/SelectorTest.java   | 2 +-
 core/src/main/scala/kafka/tools/newproducer/MirrorMaker.scala     | 4 ++--
 perf/src/main/scala/kafka/perf/ProducerPerformance.scala          | 2 +-
 11 files changed, 32 insertions(+), 18 deletions(-)
423d9d5af9481b782c7655dc2410e61e1b48a0bb

 core/src/main/scala/kafka/api/OffsetCommitRequest.scala        |  4 ++--
 .../main/scala/kafka/consumer/ZookeeperConsumerConnector.scala |  2 +-
 core/src/main/scala/kafka/javaapi/OffsetCommitRequest.scala    |  4 ++--
 core/src/test/scala/other/kafka/TestOffsetManager.scala        |  2 +-
 .../unit/kafka/api/RequestResponseSerializationTest.scala      |  2 +-
 core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala   | 10 +++++-----
 6 files changed, 12 insertions(+), 12 deletions(-)
53e4061b2b0170ee35939ba1d6462e6c6f37ccea

 .../integration/UncleanLeaderElectionTest.scala    | 290 +++++++++++++++++++++
 1 file changed, 290 insertions(+)
616086b909252eeee2cb05f379659a2de2c7bd83

 .../kafka/common/NoReplicaOnlineException.scala    |  3 +-
 .../scala/kafka/controller/KafkaController.scala   | 17 ++++-
 .../kafka/controller/PartitionLeaderSelector.scala | 22 ++++--
 core/src/main/scala/kafka/log/LogConfig.scala      | 81 ++++++++++++++--------
 core/src/main/scala/kafka/server/KafkaConfig.scala |  3 +
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 22 ++++--
 .../unit/kafka/integration/RollingBounceTest.scala |  3 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 37 +++++++++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  4 +-
 9 files changed, 150 insertions(+), 42 deletions(-)
a670537aa33732b15b56644d8ccc1681e16395f5

 core/src/main/scala/kafka/admin/TopicCommand.scala |   7 +-
 .../scala/kafka/api/ConsumerMetadataRequest.scala  |  79 ++++
 .../scala/kafka/api/ConsumerMetadataResponse.scala |  57 +++
 .../main/scala/kafka/api/OffsetCommitRequest.scala |  57 ++-
 .../scala/kafka/api/OffsetCommitResponse.scala     |  40 +-
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |  20 +-
 core/src/main/scala/kafka/api/RequestKeys.scala    |   4 +-
 core/src/main/scala/kafka/client/ClientUtils.scala | 100 ++++-
 core/src/main/scala/kafka/cluster/Partition.scala  |  28 +-
 .../ConsumerCoordinatorNotAvailableException.scala |  22 +
 .../src/main/scala/kafka/common/ErrorMapping.scala |   8 +-
 .../NotCoordinatorForConsumerException.scala       |  22 +
 .../kafka/common/OffsetMetadataAndError.scala      |  41 +-
 .../common/OffsetsLoadInProgressException.scala    |  26 ++
 core/src/main/scala/kafka/common/Topic.scala       |   4 +
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  16 +-
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  39 ++
 .../scala/kafka/consumer/ConsumerConnector.scala   |   2 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  11 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |  14 +-
 .../main/scala/kafka/consumer/TopicFilter.scala    |  11 +-
 .../consumer/ZookeeperConsumerConnector.scala      | 300 ++++++++++---
 .../scala/kafka/controller/KafkaController.scala   |   4 +-
 .../kafka/javaapi/ConsumerMetadataResponse.scala   |  42 ++
 .../scala/kafka/javaapi/OffsetCommitRequest.scala  |  13 +-
 .../scala/kafka/javaapi/OffsetCommitResponse.scala |   2 +-
 .../kafka/javaapi/consumer/ConsumerConnector.java  |   6 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   8 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |   4 +-
 .../main/scala/kafka/producer/ProducerConfig.scala |  11 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 324 ++++++++------
 core/src/main/scala/kafka/server/KafkaConfig.scala |  44 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  30 +-
 .../main/scala/kafka/server/OffsetManager.scala    | 480 +++++++++++++++++++++
 .../main/scala/kafka/server/ReplicaManager.scala   |  19 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |  93 ++--
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   8 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |   1 -
 .../kafka/tools/ReplicaVerificationTool.scala      |   5 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |   4 +-
 .../scala/kafka/utils/VerifiableProperties.scala   |  20 +
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   4 +-
 .../test/scala/other/kafka/TestOffsetManager.scala | 291 +++++++++++++
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |  73 ----
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   |   7 -
 .../api/RequestResponseSerializationTest.scala     | 155 ++-----
 .../unit/kafka/consumer/TopicFilterTest.scala      |  24 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   4 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala | 111 ++---
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   9 +-
 .../migration_tool_test.py                         |   2 +-
 system_test/mirror_maker/README                    |  22 -
 system_test/mirror_maker/bin/expected.out          |  18 -
 system_test/mirror_maker/bin/run-test.sh           | 357 ---------------
 .../config/blacklisttest.consumer.properties       |  28 --
 .../mirror_maker/config/mirror_producer.properties |  30 --
 .../config/server_source_1_1.properties            |  76 ----
 .../config/server_source_1_2.properties            |  76 ----
 .../config/server_source_2_1.properties            |  76 ----
 .../config/server_source_2_2.properties            |  76 ----
 .../config/server_target_1_1.properties            |  78 ----
 .../config/server_target_1_2.properties            |  78 ----
 .../config/whitelisttest_1.consumer.properties     |  28 --
 .../config/whitelisttest_2.consumer.properties     |  28 --
 .../config/zookeeper_source_1.properties           |  18 -
 .../config/zookeeper_source_2.properties           |  18 -
 .../config/zookeeper_target.properties             |  18 -
 .../mirror_maker_testsuite/mirror_maker_test.py    |   2 +-
 .../cluster_config.json                            | 103 +++++
 .../config/console_consumer.properties             |   2 +
 .../config/producer_performance.properties         |   0
 .../config/server.properties                       | 144 +++++++
 .../config/zookeeper.properties                    |  23 +
 .../offset_management_test.py                      | 298 +++++++++++++
 .../testcase_7001/testcase_7001_properties.json    |  95 ++++
 .../testcase_7002/config/kafka_server_1.properties | 148 +++++++
 .../testcase_7002/config/kafka_server_2.properties | 148 +++++++
 .../testcase_7002/config/kafka_server_3.properties | 148 +++++++
 .../testcase_7002/config/kafka_server_4.properties | 148 +++++++
 .../testcase_7002/config/zookeeper_0.properties    |  24 ++
 .../testcase_7002/testcase_7002_properties.json    | 127 ++++++
 .../replication_testsuite/replica_basic_test.py    |   2 +-
 system_test/utils/kafka_system_test_utils.py       | 170 +++++++-
 system_test/utils/testcase_env.py                  |   6 +
 84 files changed, 3642 insertions(+), 1677 deletions(-)
84a3a9a3d9a5f1c4936dfb9d65b4bf0cd3b445d6

 .../producer/internals/ErrorLoggingCallback.java   | 43 ++++++++++++++++++++++
 .../kafka/clients/producer/internals/Sender.java   | 11 +++---
 .../apache/kafka/common/protocol/types/Struct.java | 15 +++++++-
 .../kafka/common/requests/ProduceResponse.java     | 28 ++++++++++++++
 .../kafka/tools/newproducer/MirrorMaker.scala      |  7 +++-
 core/src/main/scala/kafka/utils/Utils.scala        | 23 ------------
 .../scala/kafka/perf/ProducerPerformance.scala     |  5 ++-
 7 files changed, 98 insertions(+), 34 deletions(-)
c124bbbb6c3e2152915411e1c3b00fca67634eed

 .../clients/producer/internals/RecordAccumulator.java      | 14 ++++++++++++++
 .../apache/kafka/clients/producer/internals/Sender.java    | 10 +++-------
 system_test/replication_testsuite/config/server.properties |  2 +-
 3 files changed, 18 insertions(+), 8 deletions(-)
c765d7bd4e30e0b952fc4bc00d142f7939b498a6

 .../kafka/tools/newproducer/MirrorMaker.scala      |   4 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  23 ++-
 .../scala/kafka/perf/ProducerPerformance.scala     |  27 +++-
 system_test/README.txt                             |   5 +-
 .../migration_tool_test.py                         |   1 +
 .../config/mirror_producer.properties              |   5 +-
 .../mirror_maker_testsuite/mirror_maker_test.py    |   1 +
 .../testcase_15001/testcase_5001_properties.json   | 158 ++++++++++++++++++
 .../testcase_15002/testcase_5002_properties.json   | 158 ++++++++++++++++++
 .../testcase_15003/cluster_config.json             | 135 ++++++++++++++++
 .../testcase_15003/testcase_5003_properties.json   | 156 ++++++++++++++++++
 .../testcase_15004/cluster_config.json             | 135 ++++++++++++++++
 .../testcase_15004/testcase_5004_properties.json   | 156 ++++++++++++++++++
 .../testcase_15005/cluster_config.json             | 153 ++++++++++++++++++
 .../testcase_15005/testcase_5005_properties.json   | 178 +++++++++++++++++++++
 .../testcase_15006/cluster_config.json             | 153 ++++++++++++++++++
 .../testcase_15006/testcase_5006_properties.json   | 178 +++++++++++++++++++++
 .../testcase_5001/testcase_5001_properties.json    |   2 +
 .../testcase_5002/testcase_5002_properties.json    |   2 +
 .../testcase_5003/testcase_5003_properties.json    |   3 +
 .../testcase_5004/testcase_5004_properties.json    |   3 +
 .../testcase_5005/testcase_5005_properties.json    |   4 +
 .../testcase_5006/testcase_5006_properties.json    |   4 +
 .../replication_testsuite/replica_basic_test.py    |   1 +
 .../testcase_0001/testcase_0001_properties.json    |   1 +
 .../testcase_0002/testcase_0002_properties.json    |   1 +
 .../testcase_0003/testcase_0003_properties.json    |   1 +
 .../testcase_0004/testcase_0004_properties.json    |   1 +
 .../testcase_0005/testcase_0005_properties.json    |   1 +
 .../testcase_0006/testcase_0006_properties.json    |   1 +
 .../testcase_0007/testcase_0007_properties.json    |   1 +
 .../testcase_0008/testcase_0008_properties.json    |   1 +
 .../testcase_0009/testcase_0009_properties.json    |   1 +
 .../testcase_0010/testcase_0010_properties.json    |   1 +
 .../testcase_0011/testcase_0011_properties.json    |   1 +
 .../testcase_0021/testcase_0021_properties.json    |   2 +
 .../testcase_0022/testcase_0022_properties.json    |   2 +
 .../testcase_0023/testcase_0023_properties.json    |   2 +
 .../testcase_0024/testcase_0024_properties.json    |   1 +
 .../testcase_0101/testcase_0101_properties.json    |   1 +
 .../testcase_0102/testcase_0102_properties.json    |   1 +
 .../testcase_0103/testcase_0103_properties.json    |   1 +
 .../testcase_0104/testcase_0104_properties.json    |   1 +
 .../testcase_0105/testcase_0105_properties.json    |   1 +
 .../testcase_0106/testcase_0106_properties.json    |   1 +
 .../testcase_0107/testcase_0107_properties.json    |   1 +
 .../testcase_0108/testcase_0108_properties.json    |   1 +
 .../testcase_0109/testcase_0109_properties.json    |   1 +
 .../testcase_0110/testcase_0110_properties.json    |   1 +
 .../testcase_0111/testcase_0111_properties.json    |   1 +
 .../testcase_0112/testcase_0112_properties.json    |   1 +
 .../testcase_0113/testcase_0113_properties.json    |   1 +
 .../testcase_0114/testcase_0114_properties.json    |   1 +
 .../testcase_0115/testcase_0115_properties.json    |   1 +
 .../testcase_0116/testcase_0116_properties.json    |   1 +
 .../testcase_0117/testcase_0117_properties.json    |   1 +
 .../testcase_0118/testcase_0118_properties.json    |   1 +
 .../testcase_0119/testcase_0119_properties.json    |   1 +
 .../testcase_0121/testcase_0121_properties.json    |   2 +
 .../testcase_0122/testcase_0122_properties.json    |   2 +
 .../testcase_0123/testcase_0123_properties.json    |   2 +
 .../testcase_0124/testcase_0124_properties.json    |   2 +
 .../testcase_0125/testcase_0125_properties.json    |   2 +
 .../testcase_0126/testcase_0126_properties.json    |   2 +
 .../testcase_0127/testcase_0127_properties.json    |   2 +
 .../testcase_0128/testcase_0128_properties.json    |   1 +
 .../testcase_0131/testcase_0131_properties.json    |   2 +
 .../testcase_0132/testcase_0132_properties.json    |   2 +
 .../testcase_0133/testcase_0133_properties.json    |   2 +
 .../testcase_0134/testcase_0134_properties.json    |   1 +
 .../testcase_0151/testcase_0151_properties.json    |   1 +
 .../testcase_0152/testcase_0152_properties.json    |   1 +
 .../testcase_0153/testcase_0153_properties.json    |   1 +
 .../testcase_0154/testcase_0154_properties.json    |   1 +
 .../testcase_0155/testcase_0155_properties.json    |   1 +
 .../testcase_0156/testcase_0156_properties.json    |   1 +
 .../testcase_0157/testcase_0157_properties.json    |   1 +
 .../testcase_0158/testcase_0158_properties.json    |   1 +
 .../testcase_0159/testcase_0159_properties.json    |   1 +
 .../testcase_0201/testcase_0201_properties.json    |   1 +
 .../testcase_0202/testcase_0202_properties.json    |   1 +
 .../testcase_0203/testcase_0203_properties.json    |   1 +
 .../testcase_0204/testcase_0204_properties.json    |   1 +
 .../testcase_0205/testcase_0205_properties.json    |   1 +
 .../testcase_0206/testcase_0206_properties.json    |   1 +
 .../testcase_0207/testcase_0207_properties.json    |   1 +
 .../testcase_0208/testcase_0208_properties.json    |   1 +
 .../testcase_0209/testcase_0209_properties.json    |   1 +
 .../testcase_0251/testcase_0251_properties.json    |   1 +
 .../testcase_0252/testcase_0252_properties.json    |   1 +
 .../testcase_0253/testcase_0253_properties.json    |   1 +
 .../testcase_0254/testcase_0254_properties.json    |   1 +
 .../testcase_0255/testcase_0255_properties.json    |   1 +
 .../testcase_0256/testcase_0256_properties.json    |   1 +
 .../testcase_0257/testcase_0257_properties.json    |   1 +
 .../testcase_0258/testcase_0258_properties.json    |   1 +
 .../testcase_0259/testcase_0259_properties.json    |   1 +
 .../testcase_0301/testcase_0301_properties.json    |   1 +
 .../testcase_0302/testcase_0302_properties.json    |   1 +
 .../testcase_0303/testcase_0303_properties.json    |   1 +
 .../testcase_0304/testcase_0304_properties.json    |   1 +
 .../testcase_0305/testcase_0305_properties.json    |   1 +
 .../testcase_0306/testcase_0306_properties.json    |   1 +
 .../testcase_0307/testcase_0307_properties.json    |   1 +
 .../testcase_0308/testcase_0308_properties.json    |   1 +
 .../testcase_0309/testcase_0309_properties.json    |   1 +
 .../testcase_1/testcase_1_properties.json          |   1 +
 .../testcase_10101/testcase_0101_properties.json   |  86 ++++++++++
 .../testcase_10102/testcase_0102_properties.json   |  86 ++++++++++
 .../testcase_10103/testcase_0103_properties.json   |  86 ++++++++++
 .../testcase_10104/testcase_0104_properties.json   |  86 ++++++++++
 .../testcase_10105/testcase_0105_properties.json   |  86 ++++++++++
 .../testcase_10106/testcase_0106_properties.json   |  86 ++++++++++
 .../testcase_10107/testcase_0107_properties.json   |  86 ++++++++++
 .../testcase_10108/testcase_0108_properties.json   |  86 ++++++++++
 .../testcase_10109/testcase_0109_properties.json   |  86 ++++++++++
 .../testcase_10110/testcase_0110_properties.json   |  86 ++++++++++
 .../testcase_10131/cluster_config.json             |  76 +++++++++
 .../testcase_10131/testcase_0131_properties.json   | 110 +++++++++++++
 .../testcase_10132/cluster_config.json             |  76 +++++++++
 .../testcase_10132/testcase_0132_properties.json   | 107 +++++++++++++
 .../testcase_10133/cluster_config.json             |  76 +++++++++
 .../testcase_10133/testcase_0133_properties.json   | 107 +++++++++++++
 .../testcase_10134/testcase_0134_properties.json   |  92 +++++++++++
 .../testcase_4001/testcase_4001_properties.json    |   2 +
 .../testcase_4002/testcase_4002_properties.json    |   2 +
 .../testcase_4003/testcase_4003_properties.json    |   2 +
 .../testcase_4004/testcase_4004_properties.json    |   2 +
 .../testcase_4005/testcase_4005_properties.json    |   2 +
 .../testcase_4006/testcase_4006_properties.json    |   2 +
 .../testcase_4007/testcase_4007_properties.json    |   2 +
 .../testcase_4008/testcase_4008_properties.json    |   2 +
 .../testcase_4011/testcase_4011_properties.json    |   2 +
 .../testcase_4012/testcase_4012_properties.json    |   2 +
 .../testcase_4013/testcase_4013_properties.json    |   2 +
 .../testcase_4014/testcase_4014_properties.json    |   2 +
 .../testcase_4015/testcase_4015_properties.json    |   2 +
 .../testcase_4016/testcase_4016_properties.json    |   2 +
 .../testcase_4017/testcase_4017_properties.json    |   2 +
 .../testcase_4018/testcase_4018_properties.json    |   2 +
 .../testcase_9051/testcase_9051_properties.json    |   1 +
 system_test/testcase_to_run_all.json               |  26 ++-
 system_test/utils/kafka_system_test_utils.py       |  34 ++--
 143 files changed, 3314 insertions(+), 24 deletions(-)
74c54c7eeb236cbf66710751165ea9f632cf3f52

 .../kafka/clients/producer/ProducerConfig.java     |   7 -
 config/tools-log4j.properties                      |   2 -
 .../scala/kafka/producer/ConsoleProducer.scala     | 334 +++++++++++++--------
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  36 +--
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  55 ++--
 .../scala/kafka/tools/TestEndToEndLatency.scala    |  72 +++++
 .../main/scala/kafka/tools/TestLogCleaning.scala   | 309 +++++++++++++++++++
 .../main/scala/kafka/utils/CommandLineUtils.scala  |  15 +-
 .../scala/other/kafka/TestEndToEndLatency.scala    |  71 -----
 .../test/scala/other/kafka/TestLogCleaning.scala   | 315 -------------------
 10 files changed, 623 insertions(+), 593 deletions(-)
c3520fe7e0e50f0eeb4f82ad1ed961bdd39440fc

 bin/kafka-server-stop.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6319f26e6f47350f1e7926dea153ed848f464d2e

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4524f384dc041f33297b47b181be6b59061577b4

 .../apache/kafka/clients/producer/internals/RecordAccumulator.java    | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
2404191be9f4323fc6144a8f56ae36f794d50da6

 .../src/main/java/org/apache/kafka/clients/producer/ProducerConfig.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5ba48348b3abb8f84fda0798d992ff2e0a04051d

 .../kafka/clients/producer/KafkaProducer.java      |  1 +
 .../kafka/clients/producer/ProducerConfig.java     |  9 ++-
 .../producer/internals/RecordAccumulator.java      | 19 +++++-
 .../clients/producer/internals/RecordBatch.java    |  2 +
 .../kafka/clients/producer/internals/Sender.java   | 74 +++++++++++----------
 .../org/apache/kafka/common/protocol/ApiKeys.java  | 14 +++-
 .../kafka/common/requests/MetadataRequest.java     | 12 ++++
 .../kafka/common/requests/MetadataResponse.java    | 12 ++++
 .../kafka/common/requests/ProduceResponse.java     | 57 ++++++++++++++++
 .../clients/producer/RecordAccumulatorTest.java    | 10 +--
 .../apache/kafka/clients/producer/SenderTest.java  |  2 +-
 .../scala/kafka/controller/KafkaController.scala   |  5 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  4 +-
 .../kafka/api/ProducerFailureHandlingTest.scala    | 75 +++++++++++++++++++---
 14 files changed, 237 insertions(+), 59 deletions(-)
153ac8aa604014351e6958dce5d479e4875031fa

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
68baaa41607c2cc8a82534c5a25c79a1d50b6cd5

 build.gradle | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
77118a935ee28da80c67d4050f41a1e7e838ebaa

 config/log4j.properties                                          | 2 --
 config/server.properties                                         | 9 +++++----
 core/src/main/scala/kafka/log/CleanerConfig.scala                | 2 +-
 core/src/main/scala/kafka/log/LogCleaner.scala                   | 7 ++++++-
 core/src/main/scala/kafka/log/LogCleanerManager.scala            | 5 ++++-
 core/src/main/scala/kafka/log/LogConfig.scala                    | 8 ++++----
 core/src/main/scala/kafka/log/LogManager.scala                   | 2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala               | 2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala               | 2 +-
 core/src/test/scala/other/kafka/TestLogCleaning.scala            | 9 +++++----
 core/src/test/scala/unit/kafka/log/CleanerTest.scala             | 2 +-
 .../test/scala/unit/kafka/log/LogCleanerIntegrationTest.scala    | 2 +-
 12 files changed, 30 insertions(+), 22 deletions(-)
71a6318be6d099c9c0ad511d1152e347ae93052f

 config/log4j.properties                                          | 2 --
 config/server.properties                                         | 9 +++++----
 core/src/main/scala/kafka/log/CleanerConfig.scala                | 2 +-
 core/src/main/scala/kafka/log/LogCleaner.scala                   | 7 ++++++-
 core/src/main/scala/kafka/log/LogCleanerManager.scala            | 5 ++++-
 core/src/main/scala/kafka/log/LogConfig.scala                    | 8 ++++----
 core/src/main/scala/kafka/log/LogManager.scala                   | 2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala               | 2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala               | 2 +-
 core/src/test/scala/other/kafka/TestLogCleaning.scala            | 9 +++++----
 core/src/test/scala/unit/kafka/log/CleanerTest.scala             | 2 +-
 .../test/scala/unit/kafka/log/LogCleanerIntegrationTest.scala    | 2 +-
 12 files changed, 30 insertions(+), 22 deletions(-)
40c6555eb0d0db25d6bd06c5eb4040246805c79f

 build.gradle | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
220cc842a6e866806e3f53c394b5547fe7c44b3e

 README.md                                   |  4 ++++
 build.gradle                                |  4 ++++
 clients/src/test/resources/log4j.properties | 21 +++++++++++++++++++++
 core/src/test/resources/log4j.properties    |  1 +
 4 files changed, 30 insertions(+)
8cdb234ad81ec324f15c9c1f8e484861926076f9

 .../main/scala/kafka/network/BlockingChannel.scala | 48 ++++++++++++----------
 1 file changed, 26 insertions(+), 22 deletions(-)
f1a53b972eb1f8e75db54d3272d9eb7c398e238a

 build.gradle                                       |  1 +
 .../kafka/clients/producer/KafkaProducer.java      | 15 +++++-
 .../kafka/clients/producer/ProducerRecord.java     | 30 ++++++-----
 .../kafka/clients/producer/internals/Metadata.java |  6 +++
 .../producer/internals/RecordAccumulator.java      |  5 ++
 .../clients/producer/internals/RecordBatch.java    | 23 +++++++--
 .../kafka/clients/producer/internals/Sender.java   | 53 ++++++++++++++++---
 .../main/java/org/apache/kafka/common/Cluster.java |  9 +++-
 .../main/java/org/apache/kafka/common/Node.java    | 26 ++++------
 .../org/apache/kafka/common/PartitionInfo.java     | 49 +++++++++++++-----
 .../apache/kafka/common/config/AbstractConfig.java | 59 +++++++++++++++-------
 .../apache/kafka/common/metrics/JmxReporter.java   | 31 ++++++------
 .../org/apache/kafka/common/network/Selector.java  | 35 +++++++------
 .../kafka/common/requests/RequestHeader.java       | 30 +++++------
 .../apache/kafka/common/requests/RequestSend.java  | 30 +++++------
 .../org/apache/kafka/common/utils/KafkaThread.java | 33 ++++++------
 .../java/org/apache/kafka/common/utils/Utils.java  | 27 +++++-----
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 18 files changed, 291 insertions(+), 173 deletions(-)
a810b8ecbe66f36f8ef58a440d439a54762b3d9c

 .../kafka/api/ProducerFailureHandlingTest.scala            | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)
eb6da57492caad7a6b71692ad184a95c89035b67

 system_test/utils/kafka_system_test_utils.py | 33 +++++++++++++++++++++++++---
 1 file changed, 30 insertions(+), 3 deletions(-)
5e2a9a560d847bd0cf364d86bd6784f70d99c71a

 .../kafka/clients/producer/KafkaProducer.java      |   8 +-
 .../kafka/clients/producer/MockProducer.java       |   2 +-
 .../kafka/clients/producer/RecordMetadata.java     |   8 +-
 .../producer/internals/FutureRecordMetadata.java   |   2 +-
 .../kafka/clients/producer/internals/Metadata.java |   4 +-
 .../clients/producer/internals/RecordBatch.java    |  13 +-
 .../kafka/clients/producer/internals/Sender.java   |   2 +-
 .../org/apache/kafka/common/network/Selector.java  |   1 +
 .../org/apache/kafka/common/protocol/Errors.java   |  14 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  85 +++---
 .../kafka/api/ProducerFailureHandlingTest.scala    | 284 +++++++++++++++++++++
 .../integration/kafka/api/ProducerSendTest.scala   |  59 ++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  23 +-
 14 files changed, 392 insertions(+), 115 deletions(-)
57be6c81a748a30e583037ddc70d2eec9acc7832

 build.gradle | 1 +
 1 file changed, 1 insertion(+)
edbed2823fc3e4948bb56ec3bee02fe4ad1bbdca

 bin/kafka-console-consumer.sh          |  5 ++++-
 bin/kafka-console-producer.sh          |  4 +++-
 bin/kafka-consumer-perf-test.sh        |  4 +++-
 bin/kafka-producer-perf-test.sh        |  4 +++-
 bin/kafka-run-class.sh                 |  9 ++++++---
 bin/kafka-server-start.sh              | 10 ++++++++--
 bin/kafka-simple-consumer-perf-test.sh |  5 ++++-
 bin/zookeeper-server-start.sh          | 10 ++++++++--
 8 files changed, 39 insertions(+), 12 deletions(-)
b5971264f29c6646bc543b47c58786f6322f0bd0

 .../scala/kafka/controller/KafkaController.scala   | 44 ++++++++++------------
 1 file changed, 20 insertions(+), 24 deletions(-)
00afb619cb1f2aaca0ddc785ab1d649428f9c93e

 core/src/main/scala/kafka/controller/KafkaController.scala | 1 -
 1 file changed, 1 deletion(-)
5b80758b57d8063b8a8124562cc5c83854a99e00
3955915a5f8a0daa7b96be69a87b3fbd013c9501

 .../main/scala/kafka/network/SocketServer.scala    | 16 +++++++--
 .../unit/kafka/network/SocketServerTest.scala      | 38 ++++++++++------------
 2 files changed, 31 insertions(+), 23 deletions(-)
5de68ef4aef7812fd9f2d5e4fb6158bf753658e3
993e1aac8f351b9ea5c322c568505d795f6d664a

 core/src/main/scala/kafka/admin/TopicCommand.scala | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
6ab9b1ecd89c74a42233fc792684e7a8757e9460

 .../src/main/scala/kafka/consumer/SimpleConsumer.scala |  8 +++-----
 .../src/main/scala/kafka/network/BlockingChannel.scala | 18 +++++++++++-------
 core/src/main/scala/kafka/producer/SyncProducer.scala  |  6 ++----
 core/src/main/scala/kafka/server/KafkaConfig.scala     |  2 +-
 .../src/main/scala/kafka/server/KafkaHealthcheck.scala |  8 +++++++-
 core/src/main/scala/kafka/server/KafkaServer.scala     |  6 ++++--
 core/src/main/scala/kafka/utils/ZkUtils.scala          |  6 ++++++
 .../test/scala/unit/kafka/server/LogRecoveryTest.scala |  2 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala     |  4 ++--
 9 files changed, 37 insertions(+), 23 deletions(-)
a2745382de26d30cfcbad11abc398150e720540f

 core/src/main/scala/kafka/controller/KafkaController.scala | 3 ++-
 core/src/main/scala/kafka/utils/ZkUtils.scala              | 2 +-
 2 files changed, 3 insertions(+), 2 deletions(-)
90bea0b12e3944226df29d78d3aa9658cfb7799a

 core/src/main/scala/kafka/controller/KafkaController.scala | 3 ++-
 core/src/main/scala/kafka/utils/ZkUtils.scala              | 2 +-
 2 files changed, 3 insertions(+), 2 deletions(-)
d392f56b803c41a32860346398f36c9a453d0406

 bin/kafka-run-class.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a8297cc6ca90f2b528091a46e3cf254e84e74d47

 LICENSE                           |  31 -----
 README-sbt.md                     |  60 ---------
 bin/kafka-run-class.sh            |   7 --
 clients/build.sbt                 |  11 --
 contrib/hadoop-consumer/build.sbt |   1 -
 contrib/hadoop-producer/build.sbt |   1 -
 core/build.sbt                    |  32 -----
 examples/build.sbt                |   3 -
 lib/sbt-launch.jar                | Bin 1103618 -> 0 bytes
 perf/build.sbt                    |   1 -
 project/Build.scala               | 152 -----------------------
 project/build.properties          |  17 ---
 project/build/KafkaProject.scala  | 251 --------------------------------------
 project/plugins.sbt               |   9 --
 sbt                               |  16 ---
 sbt.bat                           |  17 ---
 16 files changed, 609 deletions(-)
fbb3525ce8f2656869959bce0f32392577d776a0

 LICENSE                           |  31 -----
 README-sbt.md                     |  60 ---------
 bin/kafka-run-class.sh            |   7 --
 clients/build.sbt                 |  11 --
 contrib/hadoop-consumer/build.sbt |   1 -
 contrib/hadoop-producer/build.sbt |   1 -
 core/build.sbt                    |  32 -----
 examples/build.sbt                |   3 -
 lib/sbt-launch.jar                | Bin 1103618 -> 0 bytes
 perf/build.sbt                    |   1 -
 project/Build.scala               | 152 -----------------------
 project/build.properties          |  17 ---
 project/build/KafkaProject.scala  | 251 --------------------------------------
 project/plugins.sbt               |   9 --
 sbt                               |  16 ---
 sbt.bat                           |  17 ---
 16 files changed, 609 deletions(-)
16c69a844fabfe512f8c090fedde2014e392800b

 README.md         | 2 +-
 gradle.properties | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)
11f3975930a72823b20532c8c37732e47f4a2f6b

 README.md         | 2 +-
 gradle.properties | 3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)
22f76d8b362417858e61f0f9a2fc80d620790f2f

 core/src/main/scala/kafka/tools/newproducer/MirrorMaker.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3f0b67b6ac864befccfdd4bb5dee08c0b33c3b43

 .../kafka/clients/producer/KafkaProducer.java      |   5 +-
 .../kafka/clients/producer/ProducerConfig.java     |  25 +-
 .../kafka/clients/producer/internals/Metadata.java |  32 +--
 .../producer/internals/RecordAccumulator.java      |  53 +++--
 .../clients/producer/internals/RecordBatch.java    |  26 +--
 .../kafka/clients/producer/internals/Sender.java   | 255 ++++++++++++++++-----
 .../main/java/org/apache/kafka/common/Cluster.java |  40 +---
 .../common/errors/CorruptRecordException.java      |  30 +--
 .../common/errors/InvalidMetadataException.java    |  39 ++++
 .../common/errors/LeaderNotAvailableException.java |  38 ++-
 .../kafka/common/errors/NetworkException.java      |  30 +--
 .../errors/NotLeaderForPartitionException.java     |  29 ++-
 .../common/errors/OffsetMetadataTooLarge.java      |  27 ++-
 .../common/errors/OffsetOutOfRangeException.java   |  30 +--
 .../common/errors/RecordTooLargeException.java     |  27 ++-
 .../kafka/common/errors/RetriableException.java    |  37 +++
 .../kafka/common/errors/RetryableException.java    |  47 ----
 .../kafka/common/errors/TimeoutException.java      |  29 ++-
 .../common/errors/UnknownServerException.java      |  29 +--
 .../errors/UnknownTopicOrPartitionException.java   |  29 ++-
 .../org/apache/kafka/common/network/Selector.java  |  30 ++-
 .../clients/producer/RecordAccumulatorTest.java    |  27 +--
 .../apache/kafka/clients/producer/SenderTest.java  | 139 +++++++++--
 23 files changed, 652 insertions(+), 401 deletions(-)
f550cc76cd4aa6a1ed771c477ed8cc832520ba1a

 .../unit/kafka/integration/PrimitiveApiTest.scala  | 140 ++++++---------------
 1 file changed, 39 insertions(+), 101 deletions(-)
dc5a993e676da4f7042ba1dd9efc034202d46263

 build.gradle      | 40 +++++++++++++++++++++++-----------------
 gradle.properties |  4 ----
 2 files changed, 23 insertions(+), 21 deletions(-)
cb23e5d915ce14ca25d74abb55b329b83054500b

 build.gradle      | 40 +++++++++++++++++++++++-----------------
 gradle.properties |  4 ----
 2 files changed, 23 insertions(+), 21 deletions(-)
5be973674fe726181fc12e7a098b46286a545361

 README.md | 112 ++++++++++++++++++++++++++++++--------------------------------
 1 file changed, 55 insertions(+), 57 deletions(-)
879e3e770ebc49f916137e8416df74373fa26a74

 README.md | 112 ++++++++++++++++++++++++++++++--------------------------------
 1 file changed, 55 insertions(+), 57 deletions(-)
3d830c9ef1a186cd36e4f5c7bdc2dfef2d51edc7

 core/src/main/scala/kafka/cluster/Partition.scala  |  36 +++----
 .../kafka/controller/ReplicaStateMachine.scala     |   5 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 117 ++++++++++++---------
 3 files changed, 87 insertions(+), 71 deletions(-)
7e154a36f74ad0ea7e0f6d48b71a5a73d99330e7

 .../kafka/clients/producer/KafkaProducer.java      | 29 ++++++++---------
 .../kafka/clients/producer/ProducerConfig.java     | 38 +++++++++++++---------
 2 files changed, 36 insertions(+), 31 deletions(-)
84a5803a7e5235e3fa0af7de8e40bdf77ff9affe

 .../kafka/clients/producer/PartitionerTest.java    | 12 +++-
 .../integration/kafka/api/ProducerSendTest.scala   | 75 +++++++---------------
 2 files changed, 33 insertions(+), 54 deletions(-)
5023c2ff2e7293cd559513d3fed811b08048198d

 README.md       |  5 ++---
 build.gradle    | 37 ++++++++++++++++++++++++++++++++++---
 scala.gradle    |  5 +++++
 settings.gradle |  1 +
 4 files changed, 42 insertions(+), 6 deletions(-)
b494cd9de6002c59b7181cefab6854b9a0c88817

 README.md       |  5 ++---
 build.gradle    | 37 ++++++++++++++++++++++++++++++++++---
 scala.gradle    |  5 +++++
 settings.gradle |  1 +
 4 files changed, 42 insertions(+), 6 deletions(-)
ef1e30bf5b0aba1758522f8cacd2804d3bfbd4fb

 .../org/apache/kafka/clients/producer/internals/Sender.java | 13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)
e1845ba1d80f0ba89d01d450c066aae90b416ab1

 .../kafka/clients/producer/internals/Sender.java   | 26 +++++++++++++++++-----
 1 file changed, 21 insertions(+), 5 deletions(-)
cdd03d19943d42b6401b255196c83ee32ef6c792

 .../src/main/scala/kafka/tools/newproducer/MirrorMaker.scala | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
d6303ec79e6871c901951e7dcde93d4996b52c49

 .../integration/kafka/api/ProducerSendTest.scala   | 306 +++++++++++++++++++++
 1 file changed, 306 insertions(+)
a0939f412d7c5c0e294f7d1c2779ae9321338155

 build.gradle                                         |  1 +
 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 15 +++++++++++++++
 2 files changed, 16 insertions(+)
71e21c6bacb75bf7b5f65dc67c921d4c7583fa12

 build.gradle                                       |   1 +
 .../kafka/tools/newproducer/MirrorMaker.scala      | 184 +++++++++++++++++++++
 2 files changed, 185 insertions(+)
6b80dbb97b3d9b533f60d5c09639ea6c7c5f2be5

 bin/kafka-run-class.sh                             |   8 +-
 .../kafka/clients/producer/internals/Sender.java   |  27 ++-
 .../kafka/clients/tools/ProducerPerformance.java   |  19 +-
 .../scala/other/kafka/TestEndToEndLatency.scala    |  22 +--
 .../scala/kafka/perf/ConsumerPerformance.scala     | 105 +++++-----
 .../scala/kafka/perf/ProducerPerformance.scala     | 216 ++++++++++++---------
 project/Build.scala                                |   2 +-
 7 files changed, 213 insertions(+), 186 deletions(-)
02bb382621ea5079ac77094928d12a129db251c0

 .../src/main/java/org/apache/kafka/common/network/ByteBufferSend.java   | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d2ec321a03e654552ee364f6572437f233b0c226

 .../kafka/clients/producer/internals/Sender.java   | 25 ++++---
 .../apache/kafka/common/protocol/ProtoUtils.java   | 49 --------------
 .../kafka/common/requests/MetadataRequest.java     | 25 +++++++
 .../kafka/common/requests/MetadataResponse.java    | 77 ++++++++++++++++++++++
 4 files changed, 117 insertions(+), 59 deletions(-)
962b5475cbccfba7dbc424915fe517123f5e5203

 .../java/org/apache/kafka/common/protocol/types/Schema.java    | 10 ++++++++--
 .../main/java/org/apache/kafka/common/protocol/types/Type.java |  1 -
 2 files changed, 8 insertions(+), 3 deletions(-)
8014b6ff694d07956da10135508d98c625f3da3d

 bin/run-rat.sh | 35 -----------------------------------
 1 file changed, 35 deletions(-)
8d623e157d23af345857b5e69af5f3577c49ebad

 bin/run-rat.sh | 35 -----------------------------------
 1 file changed, 35 deletions(-)
cef51736c70f591baf4b384444e2f0d28a906d5e

 .../controller/ControllerChannelManager.scala      | 35 +++++++----
 .../scala/kafka/controller/KafkaController.scala   | 20 +++----
 .../kafka/controller/PartitionStateMachine.scala   | 41 ++++++++-----
 .../kafka/controller/ReplicaStateMachine.scala     | 62 +++++++++----------
 .../kafka/controller/TopicDeletionManager.scala    | 69 +++++++++++-----------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  5 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 63 +++++++++++++++++++-
 7 files changed, 193 insertions(+), 102 deletions(-)
1a7048d41bb56118d4f31ff972618ebe13007857

 .../controller/ControllerChannelManager.scala      | 35 +++++++----
 .../scala/kafka/controller/KafkaController.scala   | 20 +++----
 .../kafka/controller/PartitionStateMachine.scala   | 41 ++++++++-----
 .../kafka/controller/ReplicaStateMachine.scala     | 62 +++++++++----------
 .../kafka/controller/TopicDeletionManager.scala    | 69 +++++++++++-----------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  5 +-
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 63 +++++++++++++++++++-
 7 files changed, 193 insertions(+), 102 deletions(-)
36eae8f63c81f8d38c2351054c15bf7d5eb612d9

 HEADER                                             | 26 ++++++++++------------
 .../clients/producer/BufferExhaustedException.java | 16 +++++++++++++
 .../apache/kafka/clients/producer/Callback.java    | 16 +++++++++++++
 .../kafka/clients/producer/KafkaProducer.java      | 16 +++++++++++++
 .../kafka/clients/producer/MockProducer.java       | 16 +++++++++++++
 .../apache/kafka/clients/producer/Producer.java    | 16 +++++++++++++
 .../kafka/clients/producer/ProducerConfig.java     | 16 +++++++++++++
 .../kafka/clients/producer/ProducerRecord.java     | 16 +++++++++++++
 .../kafka/clients/producer/RecordMetadata.java     | 16 +++++++++++++
 .../clients/producer/internals/BufferPool.java     | 16 +++++++++++++
 .../producer/internals/FutureRecordMetadata.java   | 16 +++++++++++++
 .../kafka/clients/producer/internals/Metadata.java | 16 +++++++++++++
 .../clients/producer/internals/Partitioner.java    | 16 +++++++++++++
 .../producer/internals/ProduceRequestResult.java   | 16 +++++++++++++
 .../producer/internals/RecordAccumulator.java      | 16 +++++++++++++
 .../clients/producer/internals/RecordBatch.java    | 16 +++++++++++++
 .../kafka/clients/producer/internals/Sender.java   | 16 +++++++++++++
 .../kafka/clients/tools/ProducerPerformance.java   | 16 +++++++++++++
 .../main/java/org/apache/kafka/common/Cluster.java | 16 +++++++++++++
 .../java/org/apache/kafka/common/Configurable.java | 16 +++++++++++++
 .../org/apache/kafka/common/KafkaException.java    | 16 +++++++++++++
 .../main/java/org/apache/kafka/common/Metric.java  | 16 +++++++++++++
 .../main/java/org/apache/kafka/common/Node.java    | 16 +++++++++++++
 .../org/apache/kafka/common/PartitionInfo.java     | 16 +++++++++++++
 .../org/apache/kafka/common/TopicPartition.java    | 16 +++++++++++++
 .../apache/kafka/common/config/AbstractConfig.java | 16 +++++++++++++
 .../org/apache/kafka/common/config/ConfigDef.java  | 16 +++++++++++++
 .../kafka/common/config/ConfigException.java       | 16 +++++++++++++
 .../apache/kafka/common/errors/ApiException.java   | 16 +++++++++++++
 .../common/errors/CorruptRecordException.java      | 16 +++++++++++++
 .../common/errors/LeaderNotAvailableException.java | 16 +++++++++++++
 .../kafka/common/errors/NetworkException.java      | 16 +++++++++++++
 .../errors/NotLeaderForPartitionException.java     | 16 +++++++++++++
 .../common/errors/OffsetMetadataTooLarge.java      | 16 +++++++++++++
 .../common/errors/OffsetOutOfRangeException.java   | 16 +++++++++++++
 .../common/errors/RecordTooLargeException.java     | 16 +++++++++++++
 .../kafka/common/errors/RetryableException.java    | 16 +++++++++++++
 .../kafka/common/errors/TimeoutException.java      | 16 +++++++++++++
 .../common/errors/UnknownServerException.java      | 16 +++++++++++++
 .../errors/UnknownTopicOrPartitionException.java   | 16 +++++++++++++
 .../apache/kafka/common/metrics/CompoundStat.java  | 16 +++++++++++++
 .../apache/kafka/common/metrics/JmxReporter.java   | 16 +++++++++++++
 .../apache/kafka/common/metrics/KafkaMetric.java   | 16 +++++++++++++
 .../apache/kafka/common/metrics/Measurable.java    | 16 +++++++++++++
 .../kafka/common/metrics/MeasurableStat.java       | 16 +++++++++++++
 .../apache/kafka/common/metrics/MetricConfig.java  | 16 +++++++++++++
 .../org/apache/kafka/common/metrics/Metrics.java   | 16 +++++++++++++
 .../kafka/common/metrics/MetricsReporter.java      | 16 +++++++++++++
 .../org/apache/kafka/common/metrics/Quota.java     | 16 +++++++++++++
 .../common/metrics/QuotaViolationException.java    | 16 +++++++++++++
 .../org/apache/kafka/common/metrics/Sensor.java    | 16 +++++++++++++
 .../java/org/apache/kafka/common/metrics/Stat.java | 16 +++++++++++++
 .../org/apache/kafka/common/metrics/stats/Avg.java | 16 +++++++++++++
 .../apache/kafka/common/metrics/stats/Count.java   | 16 +++++++++++++
 .../kafka/common/metrics/stats/Histogram.java      | 16 +++++++++++++
 .../org/apache/kafka/common/metrics/stats/Max.java | 16 +++++++++++++
 .../org/apache/kafka/common/metrics/stats/Min.java | 16 +++++++++++++
 .../kafka/common/metrics/stats/Percentile.java     | 16 +++++++++++++
 .../kafka/common/metrics/stats/Percentiles.java    | 16 +++++++++++++
 .../apache/kafka/common/metrics/stats/Rate.java    | 16 +++++++++++++
 .../kafka/common/metrics/stats/SampledStat.java    | 16 +++++++++++++
 .../apache/kafka/common/metrics/stats/Total.java   | 16 +++++++++++++
 .../kafka/common/network/ByteBufferReceive.java    | 16 +++++++++++++
 .../kafka/common/network/ByteBufferSend.java       | 16 +++++++++++++
 .../kafka/common/network/NetworkReceive.java       | 16 +++++++++++++
 .../apache/kafka/common/network/NetworkSend.java   | 16 +++++++++++++
 .../org/apache/kafka/common/network/Receive.java   | 16 +++++++++++++
 .../apache/kafka/common/network/Selectable.java    | 16 +++++++++++++
 .../org/apache/kafka/common/network/Selector.java  | 16 +++++++++++++
 .../java/org/apache/kafka/common/network/Send.java | 16 +++++++++++++
 .../org/apache/kafka/common/protocol/ApiKeys.java  | 16 +++++++++++++
 .../org/apache/kafka/common/protocol/Errors.java   | 16 +++++++++++++
 .../apache/kafka/common/protocol/ProtoUtils.java   | 16 +++++++++++++
 .../org/apache/kafka/common/protocol/Protocol.java | 16 +++++++++++++
 .../kafka/common/protocol/types/ArrayOf.java       | 16 +++++++++++++
 .../apache/kafka/common/protocol/types/Field.java  | 16 +++++++++++++
 .../apache/kafka/common/protocol/types/Schema.java | 16 +++++++++++++
 .../common/protocol/types/SchemaException.java     | 16 +++++++++++++
 .../apache/kafka/common/protocol/types/Struct.java | 16 +++++++++++++
 .../apache/kafka/common/protocol/types/Type.java   | 16 +++++++++++++
 .../kafka/common/record/CompressionType.java       | 16 +++++++++++++
 .../common/record/InvalidRecordException.java      | 16 +++++++++++++
 .../org/apache/kafka/common/record/LogEntry.java   | 16 +++++++++++++
 .../apache/kafka/common/record/MemoryRecords.java  | 16 +++++++++++++
 .../org/apache/kafka/common/record/Record.java     | 16 +++++++++++++
 .../org/apache/kafka/common/record/Records.java    | 16 +++++++++++++
 .../kafka/common/requests/RequestHeader.java       | 16 +++++++++++++
 .../apache/kafka/common/requests/RequestSend.java  | 16 +++++++++++++
 .../kafka/common/requests/ResponseHeader.java      | 16 +++++++++++++
 .../kafka/common/utils/AbstractIterator.java       | 16 +++++++++++++
 .../apache/kafka/common/utils/CopyOnWriteMap.java  | 16 +++++++++++++
 .../org/apache/kafka/common/utils/KafkaThread.java | 16 +++++++++++++
 .../org/apache/kafka/common/utils/SystemTime.java  | 16 +++++++++++++
 .../java/org/apache/kafka/common/utils/Time.java   | 16 +++++++++++++
 .../java/org/apache/kafka/common/utils/Utils.java  | 16 +++++++++++++
 .../kafka/clients/producer/BufferPoolTest.java     | 16 +++++++++++++
 .../kafka/clients/producer/MetadataTest.java       | 16 +++++++++++++
 .../kafka/clients/producer/MockProducerTest.java   | 16 +++++++++++++
 .../kafka/clients/producer/PartitionerTest.java    | 16 +++++++++++++
 .../clients/producer/RecordAccumulatorTest.java    | 16 +++++++++++++
 .../kafka/clients/producer/RecordSendTest.java     | 16 +++++++++++++
 .../apache/kafka/clients/producer/SenderTest.java  | 16 +++++++++++++
 .../apache/kafka/common/config/ConfigDefTest.java  | 16 +++++++++++++
 .../kafka/common/metrics/JmxReporterTest.java      | 16 +++++++++++++
 .../apache/kafka/common/metrics/MetricsTest.java   | 16 +++++++++++++
 .../kafka/common/metrics/stats/HistogramTest.java  | 16 +++++++++++++
 .../apache/kafka/common/network/SelectorTest.java  | 16 +++++++++++++
 .../protocol/types/ProtocolSerializationTest.java  | 16 +++++++++++++
 .../kafka/common/record/MemoryRecordsTest.java     | 16 +++++++++++++
 .../org/apache/kafka/common/record/RecordTest.java | 16 +++++++++++++
 .../kafka/common/utils/AbstractIteratorTest.java   | 16 +++++++++++++
 .../org/apache/kafka/common/utils/MockTime.java    | 16 +++++++++++++
 .../java/org/apache/kafka/test/MetricsBench.java   | 16 +++++++++++++
 .../org/apache/kafka/test/Microbenchmarks.java     | 16 +++++++++++++
 .../java/org/apache/kafka/test/MockSelector.java   | 16 +++++++++++++
 .../test/java/org/apache/kafka/test/TestUtils.java | 16 +++++++++++++
 core/src/main/scala/kafka/consumer/package.html    | 18 +++++++++++++++
 core/src/main/scala/kafka/log/package.html         | 18 +++++++++++++++
 core/src/main/scala/kafka/message/package.html     | 18 +++++++++++++++
 core/src/main/scala/kafka/network/package.html     | 18 +++++++++++++++
 core/src/main/scala/kafka/server/package.html      | 18 +++++++++++++++
 .../scala/other/kafka/TestCrcPerformance.scala     | 16 +++++++++++++
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 16 +++++++++++++
 .../unit/kafka/utils/IteratorTemplateTest.scala    | 16 +++++++++++++
 .../src/test/scala/unit/kafka/utils/JsonTest.scala | 16 +++++++++++++
 125 files changed, 2006 insertions(+), 14 deletions(-)
52614ad65e698a9860ab22b2ce66bae773263b36

 HEADER                                       |  16 ++
 README-sbt.md                                |  60 ++++++
 README.md                                    | 110 ++++++----
 bin/kafka-run-class.sh                       |  31 ++-
 build.gradle                                 | 292 +++++++++++++++++++++++++++
 core/src/main/scala/kafka/utils/package.html |   1 -
 gradle.properties                            |  24 +++
 gradle/buildscript.gradle                    |  12 ++
 gradle/license.gradle                        |   9 +
 gradle/wrapper/gradle-wrapper.jar            | Bin 0 -> 49875 bytes
 gradle/wrapper/gradle-wrapper.properties     |   6 +
 gradlew                                      | 164 +++++++++++++++
 settings.gradle                              |  16 ++
 13 files changed, 695 insertions(+), 46 deletions(-)
8c9a7811c492d23b706ff2c3a728d8c49a387885

 core/src/main/scala/kafka/controller/PartitionStateMachine.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1032bf74054a198d5d663713be1152a9216ca150

 core/src/main/scala/kafka/admin/TopicCommand.scala | 125 ++++++++++++---------
 .../main/scala/kafka/utils/CommandLineUtils.scala  |  24 +++-
 2 files changed, 90 insertions(+), 59 deletions(-)
167acb832d7f104eb2c344dcfd7b914c763d881d

 core/src/main/scala/kafka/admin/AdminUtils.scala   |   3 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala |   3 +-
 .../kafka/api/ControlledShutdownResponse.scala     |   4 +-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |   1 +
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  22 +-
 .../main/scala/kafka/api/StopReplicaResponse.scala |  18 +-
 .../scala/kafka/api/UpdateMetadataRequest.scala    |   1 +
 .../controller/ControllerChannelManager.scala      | 127 ++++---
 .../scala/kafka/controller/KafkaController.scala   | 319 +++++++++++------
 .../kafka/controller/PartitionLeaderSelector.scala |  16 +-
 .../kafka/controller/PartitionStateMachine.scala   | 106 +++++-
 .../kafka/controller/ReplicaStateMachine.scala     | 165 ++++++---
 .../kafka/controller/TopicDeletionManager.scala    | 373 ++++++++++++++++++++
 .../main/scala/kafka/network/BlockingChannel.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  54 ++-
 .../main/scala/kafka/server/KafkaHealthcheck.scala |   1 -
 .../main/scala/kafka/server/OffsetCheckpoint.scala |   1 -
 .../main/scala/kafka/server/ReplicaManager.scala   |  29 +-
 .../scala/kafka/server/TopicConfigManager.scala    |   9 +-
 .../kafka/server/ZookeeperLeaderElector.scala      |  10 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  12 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  52 +--
 .../scala/unit/kafka/admin/DeleteTopicTest.scala   | 377 +++++++++++++++++++++
 .../api/RequestResponseSerializationTest.scala     |   6 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   4 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala |  32 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  11 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  27 +-
 28 files changed, 1444 insertions(+), 341 deletions(-)
fa6339c19cd06880d32ec9a5ee6b66e7f1488dcf

 .../clients/producer/BufferExhaustedException.java |   17 -
 .../main/java/kafka/clients/producer/Callback.java |   18 -
 .../java/kafka/clients/producer/KafkaProducer.java |  286 ---
 .../java/kafka/clients/producer/MockProducer.java  |  199 --
 .../main/java/kafka/clients/producer/Producer.java |   48 -
 .../kafka/clients/producer/ProducerConfig.java     |  130 --
 .../kafka/clients/producer/ProducerRecord.java     |   84 -
 .../kafka/clients/producer/RecordMetadata.java     |   39 -
 .../clients/producer/internals/BufferPool.java     |  223 --
 .../producer/internals/FutureRecordMetadata.java   |   63 -
 .../kafka/clients/producer/internals/Metadata.java |  120 --
 .../clients/producer/internals/Partitioner.java    |   55 -
 .../producer/internals/ProduceRequestResult.java   |   81 -
 .../producer/internals/RecordAccumulator.java      |  234 ---
 .../clients/producer/internals/RecordBatch.java    |   86 -
 .../kafka/clients/producer/internals/Sender.java   |  504 -----
 .../kafka/clients/tools/ProducerPerformance.java   |   65 -
 clients/src/main/java/kafka/common/Cluster.java    |  123 --
 .../src/main/java/kafka/common/Configurable.java   |   15 -
 .../src/main/java/kafka/common/KafkaException.java |   26 -
 clients/src/main/java/kafka/common/Metric.java     |   23 -
 clients/src/main/java/kafka/common/Node.java       |   76 -
 .../src/main/java/kafka/common/PartitionInfo.java  |   58 -
 .../src/main/java/kafka/common/TopicPartition.java |   61 -
 .../java/kafka/common/config/AbstractConfig.java   |   93 -
 .../main/java/kafka/common/config/ConfigDef.java   |  253 ---
 .../java/kafka/common/config/ConfigException.java  |   24 -
 .../java/kafka/common/errors/ApiException.java     |   35 -
 .../common/errors/CorruptRecordException.java      |   23 -
 .../common/errors/LeaderNotAvailableException.java |   19 -
 .../java/kafka/common/errors/NetworkException.java |   23 -
 .../errors/NotLeaderForPartitionException.java     |   23 -
 .../common/errors/OffsetMetadataTooLarge.java      |   22 -
 .../common/errors/OffsetOutOfRangeException.java   |   22 -
 .../common/errors/RecordTooLargeException.java     |   23 -
 .../kafka/common/errors/RetryableException.java    |   31 -
 .../java/kafka/common/errors/TimeoutException.java |   23 -
 .../common/errors/UnknownServerException.java      |   22 -
 .../errors/UnknownTopicOrPartitionException.java   |   22 -
 .../java/kafka/common/metrics/CompoundStat.java    |   40 -
 .../java/kafka/common/metrics/JmxReporter.java     |  184 --
 .../java/kafka/common/metrics/KafkaMetric.java     |   55 -
 .../main/java/kafka/common/metrics/Measurable.java |   16 -
 .../java/kafka/common/metrics/MeasurableStat.java  |   10 -
 .../java/kafka/common/metrics/MetricConfig.java    |   71 -
 .../main/java/kafka/common/metrics/Metrics.java    |  190 --
 .../java/kafka/common/metrics/MetricsReporter.java |   27 -
 .../src/main/java/kafka/common/metrics/Quota.java  |   36 -
 .../common/metrics/QuotaViolationException.java    |   16 -
 .../src/main/java/kafka/common/metrics/Sensor.java |  171 --
 .../src/main/java/kafka/common/metrics/Stat.java   |   16 -
 .../main/java/kafka/common/metrics/stats/Avg.java  |   33 -
 .../java/kafka/common/metrics/stats/Count.java     |   29 -
 .../java/kafka/common/metrics/stats/Histogram.java |  141 --
 .../main/java/kafka/common/metrics/stats/Max.java  |   29 -
 .../main/java/kafka/common/metrics/stats/Min.java  |   29 -
 .../kafka/common/metrics/stats/Percentile.java     |   32 -
 .../kafka/common/metrics/stats/Percentiles.java    |  104 -
 .../main/java/kafka/common/metrics/stats/Rate.java |   85 -
 .../kafka/common/metrics/stats/SampledStat.java    |  110 -
 .../java/kafka/common/metrics/stats/Total.java     |   31 -
 .../kafka/common/network/ByteBufferReceive.java    |   45 -
 .../java/kafka/common/network/ByteBufferSend.java  |   54 -
 .../java/kafka/common/network/NetworkReceive.java  |   74 -
 .../java/kafka/common/network/NetworkSend.java     |   26 -
 .../main/java/kafka/common/network/Receive.java    |   35 -
 .../main/java/kafka/common/network/Selectable.java |   68 -
 .../main/java/kafka/common/network/Selector.java   |  349 ----
 .../src/main/java/kafka/common/network/Send.java   |   41 -
 .../main/java/kafka/common/protocol/ApiKeys.java   |   35 -
 .../main/java/kafka/common/protocol/Errors.java    |   97 -
 .../java/kafka/common/protocol/ProtoUtils.java     |   97 -
 .../main/java/kafka/common/protocol/Protocol.java  |  130 --
 .../java/kafka/common/protocol/types/ArrayOf.java  |   63 -
 .../java/kafka/common/protocol/types/Field.java    |   48 -
 .../java/kafka/common/protocol/types/Schema.java   |  134 --
 .../common/protocol/types/SchemaException.java     |   13 -
 .../java/kafka/common/protocol/types/Struct.java   |  227 --
 .../java/kafka/common/protocol/types/Type.java     |  216 --
 .../java/kafka/common/record/CompressionType.java  |   40 -
 .../common/record/InvalidRecordException.java      |   11 -
 .../main/java/kafka/common/record/LogEntry.java    |   28 -
 .../java/kafka/common/record/MemoryRecords.java    |  102 -
 .../src/main/java/kafka/common/record/Record.java  |  286 ---
 .../src/main/java/kafka/common/record/Records.java |   29 -
 .../java/kafka/common/requests/RequestHeader.java  |   68 -
 .../java/kafka/common/requests/RequestSend.java    |   38 -
 .../java/kafka/common/requests/ResponseHeader.java |   45 -
 .../java/kafka/common/utils/AbstractIterator.java  |   72 -
 .../java/kafka/common/utils/CopyOnWriteMap.java    |  130 --
 .../src/main/java/kafka/common/utils/Crc32.java    | 2169 --------------------
 .../main/java/kafka/common/utils/KafkaThread.java  |   18 -
 .../main/java/kafka/common/utils/SystemTime.java   |   26 -
 clients/src/main/java/kafka/common/utils/Time.java |   23 -
 .../src/main/java/kafka/common/utils/Utils.java    |  230 ---
 .../clients/producer/BufferExhaustedException.java |   17 +
 .../apache/kafka/clients/producer/Callback.java    |   18 +
 .../kafka/clients/producer/KafkaProducer.java      |  287 +++
 .../kafka/clients/producer/MockProducer.java       |  200 ++
 .../apache/kafka/clients/producer/Producer.java    |   49 +
 .../kafka/clients/producer/ProducerConfig.java     |  131 ++
 .../kafka/clients/producer/ProducerRecord.java     |   84 +
 .../kafka/clients/producer/RecordMetadata.java     |   39 +
 .../clients/producer/internals/BufferPool.java     |  224 ++
 .../producer/internals/FutureRecordMetadata.java   |   64 +
 .../kafka/clients/producer/internals/Metadata.java |  121 ++
 .../clients/producer/internals/Partitioner.java    |   56 +
 .../producer/internals/ProduceRequestResult.java   |   82 +
 .../producer/internals/RecordAccumulator.java      |  235 +++
 .../clients/producer/internals/RecordBatch.java    |   87 +
 .../kafka/clients/producer/internals/Sender.java   |  505 +++++
 .../kafka/clients/tools/ProducerPerformance.java   |   66 +
 .../main/java/org/apache/kafka/common/Cluster.java |  124 ++
 .../java/org/apache/kafka/common/Configurable.java |   15 +
 .../org/apache/kafka/common/KafkaException.java    |   26 +
 .../main/java/org/apache/kafka/common/Metric.java  |   23 +
 .../main/java/org/apache/kafka/common/Node.java    |   76 +
 .../org/apache/kafka/common/PartitionInfo.java     |   58 +
 .../org/apache/kafka/common/TopicPartition.java    |   61 +
 .../apache/kafka/common/config/AbstractConfig.java |   94 +
 .../org/apache/kafka/common/config/ConfigDef.java  |  253 +++
 .../kafka/common/config/ConfigException.java       |   24 +
 .../apache/kafka/common/errors/ApiException.java   |   35 +
 .../common/errors/CorruptRecordException.java      |   23 +
 .../common/errors/LeaderNotAvailableException.java |   19 +
 .../kafka/common/errors/NetworkException.java      |   23 +
 .../errors/NotLeaderForPartitionException.java     |   23 +
 .../common/errors/OffsetMetadataTooLarge.java      |   22 +
 .../common/errors/OffsetOutOfRangeException.java   |   22 +
 .../common/errors/RecordTooLargeException.java     |   23 +
 .../kafka/common/errors/RetryableException.java    |   31 +
 .../kafka/common/errors/TimeoutException.java      |   23 +
 .../common/errors/UnknownServerException.java      |   22 +
 .../errors/UnknownTopicOrPartitionException.java   |   22 +
 .../apache/kafka/common/metrics/CompoundStat.java  |   40 +
 .../apache/kafka/common/metrics/JmxReporter.java   |  185 ++
 .../apache/kafka/common/metrics/KafkaMetric.java   |   55 +
 .../apache/kafka/common/metrics/Measurable.java    |   16 +
 .../kafka/common/metrics/MeasurableStat.java       |   10 +
 .../apache/kafka/common/metrics/MetricConfig.java  |   71 +
 .../org/apache/kafka/common/metrics/Metrics.java   |  191 ++
 .../kafka/common/metrics/MetricsReporter.java      |   27 +
 .../org/apache/kafka/common/metrics/Quota.java     |   36 +
 .../common/metrics/QuotaViolationException.java    |   16 +
 .../org/apache/kafka/common/metrics/Sensor.java    |  172 ++
 .../java/org/apache/kafka/common/metrics/Stat.java |   16 +
 .../org/apache/kafka/common/metrics/stats/Avg.java |   34 +
 .../apache/kafka/common/metrics/stats/Count.java   |   30 +
 .../kafka/common/metrics/stats/Histogram.java      |  141 ++
 .../org/apache/kafka/common/metrics/stats/Max.java |   30 +
 .../org/apache/kafka/common/metrics/stats/Min.java |   30 +
 .../kafka/common/metrics/stats/Percentile.java     |   32 +
 .../kafka/common/metrics/stats/Percentiles.java    |  105 +
 .../apache/kafka/common/metrics/stats/Rate.java    |   90 +
 .../kafka/common/metrics/stats/SampledStat.java    |  111 +
 .../apache/kafka/common/metrics/stats/Total.java   |   31 +
 .../kafka/common/network/ByteBufferReceive.java    |   45 +
 .../kafka/common/network/ByteBufferSend.java       |   54 +
 .../kafka/common/network/NetworkReceive.java       |   74 +
 .../apache/kafka/common/network/NetworkSend.java   |   26 +
 .../org/apache/kafka/common/network/Receive.java   |   35 +
 .../apache/kafka/common/network/Selectable.java    |   68 +
 .../org/apache/kafka/common/network/Selector.java  |  350 ++++
 .../java/org/apache/kafka/common/network/Send.java |   41 +
 .../org/apache/kafka/common/protocol/ApiKeys.java  |   35 +
 .../org/apache/kafka/common/protocol/Errors.java   |   98 +
 .../apache/kafka/common/protocol/ProtoUtils.java   |   98 +
 .../org/apache/kafka/common/protocol/Protocol.java |  131 ++
 .../kafka/common/protocol/types/ArrayOf.java       |   63 +
 .../apache/kafka/common/protocol/types/Field.java  |   48 +
 .../apache/kafka/common/protocol/types/Schema.java |  134 ++
 .../common/protocol/types/SchemaException.java     |   13 +
 .../apache/kafka/common/protocol/types/Struct.java |  227 ++
 .../apache/kafka/common/protocol/types/Type.java   |  217 ++
 .../kafka/common/record/CompressionType.java       |   40 +
 .../common/record/InvalidRecordException.java      |   11 +
 .../org/apache/kafka/common/record/LogEntry.java   |   28 +
 .../apache/kafka/common/record/MemoryRecords.java  |  103 +
 .../org/apache/kafka/common/record/Record.java     |  287 +++
 .../org/apache/kafka/common/record/Records.java    |   29 +
 .../kafka/common/requests/RequestHeader.java       |   69 +
 .../apache/kafka/common/requests/RequestSend.java  |   39 +
 .../kafka/common/requests/ResponseHeader.java      |   46 +
 .../kafka/common/utils/AbstractIterator.java       |   72 +
 .../apache/kafka/common/utils/CopyOnWriteMap.java  |  130 ++
 .../java/org/apache/kafka/common/utils/Crc32.java  | 2169 ++++++++++++++++++++
 .../org/apache/kafka/common/utils/KafkaThread.java |   18 +
 .../org/apache/kafka/common/utils/SystemTime.java  |   26 +
 .../java/org/apache/kafka/common/utils/Time.java   |   23 +
 .../java/org/apache/kafka/common/utils/Utils.java  |  231 +++
 .../kafka/clients/common/network/SelectorTest.java |  292 ---
 .../kafka/clients/producer/BufferPoolTest.java     |  170 --
 .../java/kafka/clients/producer/MetadataTest.java  |   49 -
 .../kafka/clients/producer/MockProducerTest.java   |   63 -
 .../kafka/clients/producer/PartitionerTest.java    |   54 -
 .../clients/producer/RecordAccumulatorTest.java    |  135 --
 .../kafka/clients/producer/RecordSendTest.java     |   78 -
 .../java/kafka/clients/producer/SenderTest.java    |   87 -
 .../java/kafka/common/config/ConfigDefTest.java    |   88 -
 .../java/kafka/common/metrics/JmxReporterTest.java |   21 -
 .../java/kafka/common/metrics/MetricsTest.java     |  210 --
 .../kafka/common/metrics/stats/HistogramTest.java  |   86 -
 .../protocol/types/ProtocolSerializationTest.java  |   96 -
 .../kafka/common/record/MemoryRecordsTest.java     |   44 -
 .../test/java/kafka/common/record/RecordTest.java  |   87 -
 .../kafka/common/utils/AbstractIteratorTest.java   |   54 -
 .../src/test/java/kafka/common/utils/MockTime.java |   28 -
 clients/src/test/java/kafka/test/MetricsBench.java |   38 -
 .../src/test/java/kafka/test/Microbenchmarks.java  |  143 --
 clients/src/test/java/kafka/test/MockSelector.java |   87 -
 clients/src/test/java/kafka/test/TestUtils.java    |   95 -
 .../kafka/clients/producer/BufferPoolTest.java     |  171 ++
 .../kafka/clients/producer/MetadataTest.java       |   49 +
 .../kafka/clients/producer/MockProducerTest.java   |   66 +
 .../kafka/clients/producer/PartitionerTest.java    |   55 +
 .../clients/producer/RecordAccumulatorTest.java    |  135 ++
 .../kafka/clients/producer/RecordSendTest.java     |   78 +
 .../apache/kafka/clients/producer/SenderTest.java  |   88 +
 .../apache/kafka/common/config/ConfigDefTest.java  |   90 +
 .../kafka/common/metrics/JmxReporterTest.java      |   24 +
 .../apache/kafka/common/metrics/MetricsTest.java   |  218 ++
 .../kafka/common/metrics/stats/HistogramTest.java  |   87 +
 .../apache/kafka/common/network/SelectorTest.java  |  292 +++
 .../protocol/types/ProtocolSerializationTest.java  |  102 +
 .../kafka/common/record/MemoryRecordsTest.java     |   47 +
 .../org/apache/kafka/common/record/RecordTest.java |   90 +
 .../kafka/common/utils/AbstractIteratorTest.java   |   55 +
 .../org/apache/kafka/common/utils/MockTime.java    |   30 +
 .../java/org/apache/kafka/test/MetricsBench.java   |   39 +
 .../org/apache/kafka/test/Microbenchmarks.java     |  144 ++
 .../java/org/apache/kafka/test/MockSelector.java   |   88 +
 .../test/java/org/apache/kafka/test/TestUtils.java |   96 +
 232 files changed, 11898 insertions(+), 11819 deletions(-)
3220af1fe2fad8da1f5bcc101ab9d3e8919b03bd

 .../java/kafka/common/metrics/stats/Histogram.java |  8 ++-
 .../kafka/common/metrics/stats/Percentiles.java    | 74 +++++++++++++++-------
 .../kafka/common/metrics/stats/SampledStat.java    | 12 ++--
 .../java/kafka/common/metrics/MetricsTest.java     | 34 ++++++++++
 .../kafka/common/metrics/stats/HistogramTest.java  | 44 +++++++++++--
 5 files changed, 136 insertions(+), 36 deletions(-)
2d848c5ae0d10fc4d49ad9a3477b8c46f1c3dab7
253f86e31062fb86401abdc13835c251eef47417

 .../main/java/kafka/clients/producer/Callback.java |  13 +-
 .../kafka/clients/producer/DefaultPartitioner.java |  35 -----
 .../java/kafka/clients/producer/KafkaProducer.java | 164 +++++++++++++--------
 .../java/kafka/clients/producer/MockProducer.java  |  82 +++++------
 .../java/kafka/clients/producer/Partitioner.java   |  30 ----
 .../main/java/kafka/clients/producer/Producer.java |  18 ++-
 .../kafka/clients/producer/ProducerConfig.java     |  46 ++----
 .../kafka/clients/producer/ProducerRecord.java     |  46 +++---
 .../kafka/clients/producer/RecordMetadata.java     |  39 +++++
 .../java/kafka/clients/producer/RecordSend.java    |  88 -----------
 .../producer/internals/FutureRecordMetadata.java   |  63 ++++++++
 .../clients/producer/internals/Partitioner.java    |  55 +++++++
 .../producer/internals/ProduceRequestResult.java   |  34 ++---
 .../producer/internals/RecordAccumulator.java      |  28 ++--
 .../clients/producer/internals/RecordBatch.java    |  32 ++--
 .../kafka/clients/producer/internals/Sender.java   |   5 +-
 .../kafka/clients/tools/ProducerPerformance.java   |  31 ++--
 .../main/java/kafka/common/ByteSerialization.java  |  18 ---
 clients/src/main/java/kafka/common/Cluster.java    |  47 ++++--
 .../src/main/java/kafka/common/Deserializer.java   |  18 ---
 .../src/main/java/kafka/common/PartitionInfo.java  |  14 +-
 clients/src/main/java/kafka/common/Serializer.java |  21 ---
 .../java/kafka/common/StringSerialization.java     |  58 --------
 .../common/errors/CorruptMessageException.java     |  23 ---
 .../common/errors/CorruptRecordException.java      |  23 +++
 .../common/errors/MessageTooLargeException.java    |  23 ---
 .../common/errors/RecordTooLargeException.java     |  23 +++
 .../kafka/common/network/ByteBufferReceive.java    |   4 +-
 .../main/java/kafka/common/protocol/Errors.java    |   8 +-
 .../java/kafka/common/protocol/ProtoUtils.java     |  28 ++--
 .../main/java/kafka/common/protocol/Protocol.java  |   2 +-
 .../java/kafka/common/record/MemoryRecords.java    |   4 +-
 .../src/main/java/kafka/common/record/Record.java  |   4 +-
 .../java/kafka/clients/producer/MetadataTest.java  |  10 +-
 .../kafka/clients/producer/MockProducerTest.java   |  67 ++++-----
 .../kafka/clients/producer/PartitionerTest.java    |  54 +++++++
 .../kafka/clients/producer/RecordSendTest.java     |  32 ++--
 .../java/kafka/clients/producer/SenderTest.java    |  17 +--
 clients/src/test/java/kafka/test/TestUtils.java    |  22 +++
 39 files changed, 670 insertions(+), 659 deletions(-)
c9052c5ff510f4b750d456b7efa159b39501da98

 contrib/hadoop-consumer/README | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
74b42a8f810281e26d80d764fc8f391836b87844

 bin/windows/kafka-run-class.bat                                 | 2 +-
 core/build.sbt                                                  | 2 +-
 project/build/KafkaProject.scala                                | 2 +-
 system_test/migration_tool_testsuite/0.7/bin/kafka-run-class.sh | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)
2b0c6a7d7b83a58362e32191674e55da25d3077f

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)
9c1d8e35c5913d22098cf80ae69035131cfee87f

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala         | 4 ++++
 core/src/main/scala/kafka/consumer/ConsumerFetcherManager.scala | 2 +-
 core/src/test/scala/unit/kafka/utils/TestUtils.scala            | 1 +
 perf/src/main/scala/kafka/perf/ConsumerPerformance.scala        | 6 ++++++
 4 files changed, 12 insertions(+), 1 deletion(-)
269d16d3c915d09f650ae32aa81542bd8522ca68

 clients/build.sbt                                  |   11 +
 .../clients/producer/BufferExhaustedException.java |   17 +
 .../main/java/kafka/clients/producer/Callback.java |   15 +
 .../kafka/clients/producer/DefaultPartitioner.java |   35 +
 .../java/kafka/clients/producer/KafkaProducer.java |  240 +++
 .../java/kafka/clients/producer/MockProducer.java  |  201 ++
 .../java/kafka/clients/producer/Partitioner.java   |   30 +
 .../main/java/kafka/clients/producer/Producer.java |   38 +
 .../kafka/clients/producer/ProducerConfig.java     |  148 ++
 .../kafka/clients/producer/ProducerRecord.java     |   84 +
 .../java/kafka/clients/producer/RecordSend.java    |   88 +
 .../clients/producer/internals/BufferPool.java     |  223 ++
 .../kafka/clients/producer/internals/Metadata.java |  120 ++
 .../producer/internals/ProduceRequestResult.java   |   83 +
 .../producer/internals/RecordAccumulator.java      |  236 +++
 .../clients/producer/internals/RecordBatch.java    |   84 +
 .../kafka/clients/producer/internals/Sender.java   |  503 +++++
 .../kafka/clients/tools/ProducerPerformance.java   |   70 +
 .../main/java/kafka/common/ByteSerialization.java  |   18 +
 clients/src/main/java/kafka/common/Cluster.java    |  102 +
 .../src/main/java/kafka/common/Configurable.java   |   15 +
 .../src/main/java/kafka/common/Deserializer.java   |   18 +
 .../src/main/java/kafka/common/KafkaException.java |   26 +
 clients/src/main/java/kafka/common/Metric.java     |   23 +
 clients/src/main/java/kafka/common/Node.java       |   76 +
 .../src/main/java/kafka/common/PartitionInfo.java  |   58 +
 clients/src/main/java/kafka/common/Serializer.java |   21 +
 .../java/kafka/common/StringSerialization.java     |   58 +
 .../src/main/java/kafka/common/TopicPartition.java |   61 +
 .../java/kafka/common/config/AbstractConfig.java   |   93 +
 .../main/java/kafka/common/config/ConfigDef.java   |  253 +++
 .../java/kafka/common/config/ConfigException.java  |   24 +
 .../java/kafka/common/errors/ApiException.java     |   35 +
 .../common/errors/CorruptMessageException.java     |   23 +
 .../common/errors/LeaderNotAvailableException.java |   19 +
 .../common/errors/MessageTooLargeException.java    |   23 +
 .../java/kafka/common/errors/NetworkException.java |   23 +
 .../errors/NotLeaderForPartitionException.java     |   23 +
 .../common/errors/OffsetMetadataTooLarge.java      |   22 +
 .../common/errors/OffsetOutOfRangeException.java   |   22 +
 .../kafka/common/errors/RetryableException.java    |   31 +
 .../java/kafka/common/errors/TimeoutException.java |   23 +
 .../common/errors/UnknownServerException.java      |   22 +
 .../errors/UnknownTopicOrPartitionException.java   |   22 +
 .../java/kafka/common/metrics/CompoundStat.java    |   40 +
 .../java/kafka/common/metrics/JmxReporter.java     |  184 ++
 .../java/kafka/common/metrics/KafkaMetric.java     |   55 +
 .../main/java/kafka/common/metrics/Measurable.java |   16 +
 .../java/kafka/common/metrics/MeasurableStat.java  |   10 +
 .../java/kafka/common/metrics/MetricConfig.java    |   71 +
 .../main/java/kafka/common/metrics/Metrics.java    |  190 ++
 .../java/kafka/common/metrics/MetricsReporter.java |   27 +
 .../src/main/java/kafka/common/metrics/Quota.java  |   36 +
 .../common/metrics/QuotaViolationException.java    |   16 +
 .../src/main/java/kafka/common/metrics/Sensor.java |  171 ++
 .../src/main/java/kafka/common/metrics/Stat.java   |   16 +
 .../main/java/kafka/common/metrics/stats/Avg.java  |   33 +
 .../java/kafka/common/metrics/stats/Count.java     |   29 +
 .../java/kafka/common/metrics/stats/Histogram.java |  137 ++
 .../main/java/kafka/common/metrics/stats/Max.java  |   29 +
 .../main/java/kafka/common/metrics/stats/Min.java  |   29 +
 .../kafka/common/metrics/stats/Percentile.java     |   32 +
 .../kafka/common/metrics/stats/Percentiles.java    |   76 +
 .../main/java/kafka/common/metrics/stats/Rate.java |   85 +
 .../kafka/common/metrics/stats/SampledStat.java    |  106 +
 .../java/kafka/common/metrics/stats/Total.java     |   31 +
 .../kafka/common/network/ByteBufferReceive.java    |   43 +
 .../java/kafka/common/network/ByteBufferSend.java  |   54 +
 .../java/kafka/common/network/NetworkReceive.java  |   74 +
 .../java/kafka/common/network/NetworkSend.java     |   26 +
 .../main/java/kafka/common/network/Receive.java    |   35 +
 .../main/java/kafka/common/network/Selectable.java |   68 +
 .../main/java/kafka/common/network/Selector.java   |  349 ++++
 .../src/main/java/kafka/common/network/Send.java   |   41 +
 .../main/java/kafka/common/protocol/ApiKeys.java   |   35 +
 .../main/java/kafka/common/protocol/Errors.java    |   97 +
 .../java/kafka/common/protocol/ProtoUtils.java     |   95 +
 .../main/java/kafka/common/protocol/Protocol.java  |  130 ++
 .../java/kafka/common/protocol/types/ArrayOf.java  |   63 +
 .../java/kafka/common/protocol/types/Field.java    |   48 +
 .../java/kafka/common/protocol/types/Schema.java   |  134 ++
 .../common/protocol/types/SchemaException.java     |   13 +
 .../java/kafka/common/protocol/types/Struct.java   |  227 ++
 .../java/kafka/common/protocol/types/Type.java     |  216 ++
 .../java/kafka/common/record/CompressionType.java  |   40 +
 .../common/record/InvalidRecordException.java      |   11 +
 .../main/java/kafka/common/record/LogEntry.java    |   28 +
 .../java/kafka/common/record/MemoryRecords.java    |  102 +
 .../src/main/java/kafka/common/record/Record.java  |  286 +++
 .../src/main/java/kafka/common/record/Records.java |   29 +
 .../java/kafka/common/requests/RequestHeader.java  |   68 +
 .../java/kafka/common/requests/RequestSend.java    |   38 +
 .../java/kafka/common/requests/ResponseHeader.java |   45 +
 .../java/kafka/common/utils/AbstractIterator.java  |   72 +
 .../java/kafka/common/utils/CopyOnWriteMap.java    |  130 ++
 .../src/main/java/kafka/common/utils/Crc32.java    | 2169 ++++++++++++++++++++
 .../main/java/kafka/common/utils/KafkaThread.java  |   18 +
 .../main/java/kafka/common/utils/SystemTime.java   |   26 +
 clients/src/main/java/kafka/common/utils/Time.java |   23 +
 .../src/main/java/kafka/common/utils/Utils.java    |  230 +++
 .../kafka/clients/common/network/SelectorTest.java |  292 +++
 .../kafka/clients/producer/BufferPoolTest.java     |  170 ++
 .../java/kafka/clients/producer/MetadataTest.java  |   55 +
 .../kafka/clients/producer/MockProducerTest.java   |   66 +
 .../clients/producer/RecordAccumulatorTest.java    |  135 ++
 .../kafka/clients/producer/RecordSendTest.java     |   76 +
 .../java/kafka/clients/producer/SenderTest.java    |   92 +
 .../java/kafka/common/config/ConfigDefTest.java    |   88 +
 .../java/kafka/common/metrics/JmxReporterTest.java |   21 +
 .../java/kafka/common/metrics/MetricsTest.java     |  176 ++
 .../kafka/common/metrics/stats/HistogramTest.java  |   56 +
 .../protocol/types/ProtocolSerializationTest.java  |   96 +
 .../kafka/common/record/MemoryRecordsTest.java     |   44 +
 .../test/java/kafka/common/record/RecordTest.java  |   87 +
 .../kafka/common/utils/AbstractIteratorTest.java   |   54 +
 .../src/test/java/kafka/common/utils/MockTime.java |   28 +
 clients/src/test/java/kafka/test/MetricsBench.java |   38 +
 .../src/test/java/kafka/test/Microbenchmarks.java  |  143 ++
 clients/src/test/java/kafka/test/MockSelector.java |   87 +
 clients/src/test/java/kafka/test/TestUtils.java    |   73 +
 project/Build.scala                                |    1 +
 121 files changed, 11720 insertions(+)
3f473566ab2ef51f17034dc02f632df5d38fe307
26a02c32dda0222c6ab1ad897992558c1c1eab76

 core/src/main/scala/kafka/server/KafkaApis.scala           | 5 ++++-
 core/src/main/scala/kafka/server/KafkaRequestHandler.scala | 1 +
 2 files changed, 5 insertions(+), 1 deletion(-)
c9028ad8c5d8bac9278836ebbc21fada5e6b562b

 bin/zookeeper-shell.sh | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
e1f7bea157c828d1eefdc5f9cf0337be79d809eb

 examples/README | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
c2ed6415fcfa02d08dde031f0f799f5a0f18d8c5

 system_test/utils/kafka_system_test_utils.py | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
855340a2e65ffbb79520c49d0b9a231b94acd538

 .../controller/ControllerChannelManager.scala      |   4 -
 .../scala/kafka/controller/KafkaController.scala   | 132 ++++++++++++++-------
 .../kafka/controller/PartitionLeaderSelector.scala |  40 ++++---
 .../kafka/controller/PartitionStateMachine.scala   |  22 +++-
 .../kafka/controller/ReplicaStateMachine.scala     |  35 +++---
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  43 -------
 6 files changed, 146 insertions(+), 130 deletions(-)
d401292abb0f3660895173d4613f712058ae097f

 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
d2e2c607d1490cf2121dd64f4e79f34ba64c8ed7

 .../kafka/api/ControlledShutdownRequest.scala      | 16 ++++++++-----
 .../kafka/api/ControlledShutdownResponse.scala     |  3 +++
 core/src/main/scala/kafka/api/FetchRequest.scala   | 26 +++++++++++++---------
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala | 23 +++++++++++--------
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |  3 +++
 .../main/scala/kafka/api/OffsetCommitRequest.scala | 16 +++++++++++++
 .../scala/kafka/api/OffsetCommitResponse.scala     |  3 +++
 .../main/scala/kafka/api/OffsetFetchRequest.scala  | 18 ++++++++++++++-
 .../main/scala/kafka/api/OffsetFetchResponse.scala |  4 +++-
 core/src/main/scala/kafka/api/OffsetRequest.scala  | 23 +++++++++++--------
 core/src/main/scala/kafka/api/OffsetResponse.scala |  1 +
 .../src/main/scala/kafka/api/ProducerRequest.scala | 24 ++++++++++++--------
 .../main/scala/kafka/api/ProducerResponse.scala    |  2 ++
 .../main/scala/kafka/api/RequestOrResponse.scala   |  8 ++++++-
 .../main/scala/kafka/api/StopReplicaRequest.scala  | 25 ++++++++++++---------
 .../main/scala/kafka/api/StopReplicaResponse.scala |  2 ++
 .../scala/kafka/api/TopicMetadataRequest.scala     | 21 ++++++++++-------
 .../scala/kafka/api/TopicMetadataResponse.scala    |  2 ++
 .../scala/kafka/api/UpdateMetadataRequest.scala    | 19 ++++++++++------
 .../scala/kafka/api/UpdateMetadataResponse.scala   |  2 ++
 .../scala/kafka/javaapi/TopicMetadataRequest.scala | 25 +++++++++++++++++++++
 .../main/scala/kafka/network/RequestChannel.scala  |  6 ++++-
 22 files changed, 199 insertions(+), 73 deletions(-)
f63e3f730673f60ca179030cf0d64380689c2a40

 core/src/main/scala/kafka/cluster/Partition.scala  |  19 +-
 .../kafka/common/LogCleaningAbortedException.scala |  24 +++
 .../common/OptimisticLockFailureException.scala    |  23 ---
 .../kafka/common/ThreadShutdownException.scala     |  24 +++
 .../scala/kafka/controller/KafkaController.scala   |   2 +-
 core/src/main/scala/kafka/log/Log.scala            |  37 ++--
 core/src/main/scala/kafka/log/LogCleaner.scala     | 208 ++++++++-------------
 .../main/scala/kafka/log/LogCleanerManager.scala   | 188 +++++++++++++++++++
 core/src/main/scala/kafka/log/LogManager.scala     |  76 +++++---
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   7 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  18 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  15 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  39 ++--
 13 files changed, 452 insertions(+), 228 deletions(-)
15f3c8417e07e6bc6cbe0c5991f5641396c61b24

 core/src/main/scala/kafka/admin/TopicCommand.scala | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
3f88be6318670864b372deccb2af705e8c84382a

 .../controller/ControllerChannelManager.scala      | 49 +++++++++++++++++-----
 .../main/scala/kafka/producer/SyncProducer.scala   |  5 ---
 2 files changed, 39 insertions(+), 15 deletions(-)
a119f532c8b310122d85391efe11fd26027ef7f9
10fa20001dd22a2cfc7da065d75d7cf6c0009b42

 .../scala/kafka/controller/KafkaController.scala   | 32 +++++++++++--------
 .../kafka/server/ZookeeperLeaderElector.scala      | 36 ++++++++++++----------
 2 files changed, 40 insertions(+), 28 deletions(-)
b23cf1968f2aa4f8dbd6629634ae813b5e14564c

 .../scala/kafka/controller/KafkaController.scala   | 92 +++++++++++++++++++++-
 core/src/main/scala/kafka/server/KafkaConfig.scala | 12 +++
 2 files changed, 102 insertions(+), 2 deletions(-)
72610d1fc0bbf706a14f1605bf9862ea3830e707
e88f1acdaac9fe738787ccb8375519293c913a37

 core/src/main/scala/kafka/controller/KafkaController.scala | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)
425af9b4a7afeb21191c33ba6bc3f20623a3f0b3

 .../scala/kafka/controller/KafkaController.scala   | 48 +++++++++++++---------
 1 file changed, 29 insertions(+), 19 deletions(-)
b5d16871c02a585643aec3229546af04721bb42c

 core/src/main/scala/kafka/admin/TopicCommand.scala | 112 ++++++++++++---------
 .../consumer/ZookeeperConsumerConnector.scala      |  19 ++--
 2 files changed, 72 insertions(+), 59 deletions(-)
dd58d753ce3ffb41776a6fa6322cb822f2222500

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 1 +
 core/src/main/scala/kafka/controller/KafkaController.scala          | 1 +
 core/src/main/scala/kafka/controller/PartitionStateMachine.scala    | 3 ++-
 3 files changed, 4 insertions(+), 1 deletion(-)
169a79e687799bffd5cf1f4bb86855bf3725cb88

 kafka-patch-review.py | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
6bc290f66d738a9133afe93e2a6ac64f1344c111

 .../kafka/admin/ReassignPartitionsCommand.scala    |  2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  2 +-
 .../scala/kafka/controller/KafkaController.scala   | 17 ++++++++-----
 .../kafka/server/AbstractFetcherManager.scala      |  4 ++--
 .../main/scala/kafka/server/ReplicaManager.scala   | 28 ++++++++++++++--------
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 20 ++++++++++++++--
 6 files changed, 51 insertions(+), 22 deletions(-)
55d77c67c236488df2b9f6bb59d99eeb645a0553

 .../scala/kafka/controller/KafkaController.scala   | 87 ++++++++++++++--------
 1 file changed, 56 insertions(+), 31 deletions(-)
32aae7202ce041128fb1f6d2ea43580ee7864d74

 core/src/main/scala/kafka/cluster/Partition.scala  |  10 +-
 .../controller/ControllerChannelManager.scala      |  10 +-
 .../scala/kafka/controller/KafkaController.scala   |   2 +-
 .../kafka/controller/ReplicaStateMachine.scala     |  29 +++---
 core/src/main/scala/kafka/server/KafkaConfig.scala |   5 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 102 ++++++++++++---------
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  27 ++++--
 .../unit/kafka/server/ISRExpirationTest.scala      |   1 +
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |   1 +
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   1 +
 10 files changed, 106 insertions(+), 82 deletions(-)
876cfdb59730f0e0c0f87aed15d65fa747c19bd3

 core/src/main/scala/kafka/admin/TopicCommand.scala | 23 ++++++++++++++++++----
 1 file changed, 19 insertions(+), 4 deletions(-)
7dee06ee99bf2610d71df04e4e5238a10a8388a2

 core/src/main/scala/kafka/server/KafkaApis.scala | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
8a2ba3f6f2eab88db4b5ea6d880ec2feba93276c

 core/src/main/scala/kafka/controller/KafkaController.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6c36beef873e8696e3e68b38c886893e01ce6dbb

 core/src/main/scala/kafka/server/ReplicaManager.scala | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
ea3961fc84c5a45a5458b9db4080b32f28855f7b

 .../kafka/admin/ReassignPartitionsCommand.scala    | 231 +++++++++++----------
 .../scala/kafka/controller/KafkaController.scala   |  10 +-
 2 files changed, 123 insertions(+), 118 deletions(-)
b638b0f34623769e2efbcb7c2c36f7b742f6b690

 core/src/main/scala/kafka/server/KafkaConfig.scala | 12 ------------
 1 file changed, 12 deletions(-)
7c7951426df5fe8a65b176fe49584868e7af3b4f

 core/src/main/scala/kafka/api/FetchRequest.scala   |  2 +-
 .../main/scala/kafka/api/RequestOrResponse.scala   |  3 ++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  6 +--
 .../main/scala/kafka/server/ReplicaManager.scala   | 25 +++++----
 .../kafka/tools/ReplicaVerificationTool.scala      | 60 ++++++++++++----------
 5 files changed, 52 insertions(+), 44 deletions(-)
224f192c776b4348596fbf068771c98aa9db9f3d

 .../main/scala/kafka/server/ReplicaManager.scala   | 24 +++++++++++++++-------
 1 file changed, 17 insertions(+), 7 deletions(-)
df288b75a0c6685deeda99ce4db3e17fff39b0ad

 .../scala/kafka/consumer/ConsumerIterator.scala    |  5 +--
 .../scala/kafka/message/MessageAndMetadata.scala   | 15 ++++++++-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala | 36 ++++++++++++++++++++++
 3 files changed, 51 insertions(+), 5 deletions(-)
ac239da502c4de10f63b0b5d638c3d8b11711eae

 config/server.properties                                      | 5 +++--
 system_test/migration_tool_testsuite/config/server.properties | 5 +++--
 system_test/mirror_maker_testsuite/config/server.properties   | 5 +++--
 system_test/replication_testsuite/config/server.properties    | 5 +++--
 4 files changed, 12 insertions(+), 8 deletions(-)
583044cd5109cd060bdfc9e516f4c85d1d4e73a0

 core/src/main/scala/kafka/log/FileMessageSet.scala |  2 ++
 core/src/main/scala/kafka/log/Log.scala            | 28 +++++++--------
 core/src/main/scala/kafka/log/LogManager.scala     |  2 ++
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 40 +++++++++++++---------
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  5 ++-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 22 ++++++------
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 ++++--
 7 files changed, 62 insertions(+), 47 deletions(-)
15bb3961d9171c1c54c4c840a554ce2c76168163

 project/Build.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
bb2dc49bde2f77b7ceb9e47a0f710204530774a4

 project/Build.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
87efda7f818218e0868be7032c73c994d75931fd

 core/src/main/scala/kafka/consumer/TopicFilter.scala  |  6 ------
 .../kafka/consumer/ZookeeperConsumerConnector.scala   | 18 +++++-------------
 .../kafka/consumer/ZookeeperTopicEventWatcher.scala   | 19 ++++++-------------
 .../scala/unit/kafka/consumer/TopicFilterTest.scala   |  4 ----
 4 files changed, 11 insertions(+), 36 deletions(-)
2477a7468e7bfe728abae793236d8aaf1c211d3b

 core/src/main/scala/kafka/producer/KafkaLog4jAppender.scala | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)
99dd94c9b659775e738e12330d90ae7ebe7bdbb6

 .../hadoop-consumer/src/main/java/kafka/etl/impl/DataGenerator.java    | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)
7f32a1c276f5a027870d7cc340cce34274d9a896
cd81d37ac872654c0cc68fab830ee457c56b7c6a

 core/src/main/scala/kafka/api/FetchResponse.scala                 | 4 ----
 .../scala/unit/kafka/api/RequestResponseSerializationTest.scala   | 8 ++++----
 2 files changed, 4 insertions(+), 8 deletions(-)
c2dd071b52632c638fefcf864cc2aa1a2cac629b

 project/Build.scala | 2 ++
 1 file changed, 2 insertions(+)
59a0c79ea6714b4d8a6525cc77ee4d0fc653603a

 project/Build.scala | 2 ++
 1 file changed, 2 insertions(+)
9b0776d157afd9eacddb84a99f2420fa9c0d505b

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  2 +-
 .../PreferredReplicaLeaderElectionCommand.scala    |  9 +---
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  6 +--
 .../src/main/scala/kafka/consumer/TopicCount.scala | 23 ++-------
 .../consumer/ZookeeperConsumerConnector.scala      |  8 +--
 .../scala/kafka/controller/KafkaController.scala   |  2 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |  2 -
 core/src/main/scala/kafka/log/Log.scala            | 28 +++++-----
 core/src/main/scala/kafka/log/LogManager.scala     |  2 -
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 40 ++++++---------
 .../kafka/server/ZookeeperLeaderElector.scala      |  6 +--
 core/src/main/scala/kafka/utils/Utils.scala        | 59 ----------------------
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 33 ++++--------
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  5 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 22 ++++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 +---
 16 files changed, 72 insertions(+), 185 deletions(-)
440e45e5131131a30987b991eabfee147061c42b

 core/src/main/scala/kafka/api/OffsetResponse.scala |   6 +-
 .../kafka/tools/ReplicaVerificationTool.scala      | 387 +++++++++++++++++++++
 2 files changed, 392 insertions(+), 1 deletion(-)
033872b316fd5a68d7463138d8199fb5d821f41b

 core/src/main/scala/kafka/controller/KafkaController.scala | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
a4cd17a37bf0f5ccae7b8f6a404c8b8c0de4dbad

 core/src/main/scala/kafka/admin/AdminUtils.scala           | 4 ----
 core/src/main/scala/kafka/controller/KafkaController.scala | 7 +------
 2 files changed, 1 insertion(+), 10 deletions(-)
09e807bda103fe632e62312f036b850a59576f36

 core/src/main/scala/kafka/admin/TopicCommand.scala | 8 --------
 1 file changed, 8 deletions(-)
5bcb41835f58be142bb6ac7c3155dfc163a516b4

 .../scala/kafka/controller/KafkaController.scala   | 67 ++++++++++++++++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 12 ++++
 2 files changed, 74 insertions(+), 5 deletions(-)
39c5b75c9675636d1f77a549fc55b527ed1d7f38
58789d7cbe21f0b29f4a94a1fe75d1f1e0851d86

 bin/kafka-run-class.sh        | 43 +++++++++++++++++++++++++++++++++++++------
 bin/kafka-server-start.sh     | 17 +++++++++++++++--
 bin/zookeeper-server-start.sh | 17 +++++++++++++++--
 config/log4j.properties       | 11 +++++++----
 4 files changed, 74 insertions(+), 14 deletions(-)
7c54e39bd48c9908c220ee68cee608a0d0cf5d9d

 core/src/main/scala/kafka/log/FileMessageSet.scala |  2 ++
 core/src/main/scala/kafka/log/Log.scala            | 28 +++++++--------
 core/src/main/scala/kafka/log/LogManager.scala     |  2 ++
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 40 +++++++++++++---------
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  5 ++-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 22 ++++++------
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 10 ++++--
 7 files changed, 62 insertions(+), 47 deletions(-)
793b60763c0bb073dd5cacf3117b34877f557fb8
eedbea6526986783257ad0e025c451a8ee3d9095

 core/src/main/scala/kafka/admin/AdminUtils.scala   | 27 ++++++++------
 core/src/main/scala/kafka/admin/TopicCommand.scala | 43 +++++++++++++++++-----
 core/src/main/scala/kafka/log/LogConfig.scala      |  2 +-
 .../scala/kafka/server/TopicConfigManager.scala    |  1 -
 4 files changed, 50 insertions(+), 23 deletions(-)
a700c99efddb3ae83b42a2bcf5c58dd16ee7edf1

 DISCLAIMER | 15 ---------------
 1 file changed, 15 deletions(-)
98568cccee4d6ae2fd11a817b2433a864857a2c2

 DISCLAIMER | 15 ---------------
 1 file changed, 15 deletions(-)
98616188645d1d57e98a6b92f615345fc7653d9d

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 12 ++++++------
 1 file changed, 6 insertions(+), 6 deletions(-)
7d1ac1d806ea893a1503c35dbd6087941dc5c25c

 core/src/main/scala/kafka/log/OffsetIndex.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
df7f7a255bdd803cddfdf3fea2ace4f1ae366377

 .../kafka/admin/ReassignPartitionsCommand.scala    |  14 ++-
 core/src/main/scala/kafka/cluster/Partition.scala  |  49 ++++++--
 .../kafka/common/NotAssignedReplicaException.scala |  23 ++++
 .../scala/kafka/controller/KafkaController.scala   | 127 +++++++++++++++++----
 .../kafka/controller/ReplicaStateMachine.scala     |   2 +
 .../main/scala/kafka/server/ReplicaManager.scala   |  63 +++++-----
 kafka-patch-review.py                              |   6 +-
 project/Build.scala                                |   2 +-
 8 files changed, 214 insertions(+), 72 deletions(-)
e602ed0582b04d7b6fd442990dd3182f1e2834a5

 config/server.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a4fafefdb3a2701d30f14feed3be11f1c0905c31

 core/src/main/scala/kafka/log/Log.scala          | 3 +--
 core/src/test/scala/unit/kafka/log/LogTest.scala | 2 +-
 2 files changed, 2 insertions(+), 3 deletions(-)
ec547737de730cddb29200eba62c0165f901447b

 core/src/main/scala/kafka/log/Log.scala          | 11 +++++++++
 core/src/main/scala/kafka/log/LogManager.scala   |  6 ++++-
 core/src/test/scala/unit/kafka/log/LogTest.scala | 30 +++++++++++++++++++++++-
 3 files changed, 45 insertions(+), 2 deletions(-)
a55ec0620f6ce805fafe2e1d4035ec3e0ab4e0d0

 config/server.properties                           | 13 ++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala | 13 +++++-
 .../main/scala/kafka/server/KafkaHealthcheck.scala | 14 +++---
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   | 12 ++---
 .../unit/kafka/server/AdvertiseBrokerTest.scala    | 52 ++++++++++++++++++++++
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 34 +++++++++++++-
 7 files changed, 118 insertions(+), 22 deletions(-)
bf4dbd5ee3be67a214c01aae0bf01b1492994cf5

 .../main/scala/kafka/network/RequestChannel.scala  | 29 ++++++++++++++--------
 .../scala/kafka/server/KafkaRequestHandler.scala   |  2 +-
 2 files changed, 20 insertions(+), 11 deletions(-)
bd49e4f3e77c86a9cd93262e628143fff762d4ee

 core/src/main/scala/kafka/cluster/Partition.scala  |  66 ++----
 .../src/main/scala/kafka/common/ErrorMapping.scala |   1 +
 .../scala/kafka/common/TopicAndPartition.scala     |   6 +
 .../kafka/consumer/ConsumerFetcherManager.scala    |  34 +--
 .../kafka/consumer/ConsumerFetcherThread.scala     |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  16 ++
 .../kafka/server/AbstractFetcherManager.scala      |  48 ++--
 .../scala/kafka/server/AbstractFetcherThread.scala |  27 ++-
 .../main/scala/kafka/server/ReplicaManager.scala   | 254 ++++++++++++++-------
 9 files changed, 275 insertions(+), 179 deletions(-)
274b12f3351e007f76e8ef64ba9baf5b0824e690

 core/src/main/scala/kafka/server/KafkaConfig.scala | 13 ++++-
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 .../scala/unit/kafka/server/KafkaConfigTest.scala  | 67 ++++++++++++++++++++++
 3 files changed, 80 insertions(+), 2 deletions(-)
0e90c246c68954204ea524139023d97173bfde56

 core/src/main/scala/kafka/log/Log.scala | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
0198e67febfa805b7a5d7ef8a939254bbe0b0d00

 core/src/main/scala/kafka/log/Log.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b61d147fd0774370a41d2a6cadcbfd30c7703a34

 kafka-patch-review.py | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
d4553da609ea9af6db8a79faf116d1623c8a856f

 kafka-patch-review.py | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
d030778861e6d274281adf7e0311dc4d51448c84

 core/src/main/scala/kafka/log/Log.scala          | 20 +++++++++++++++-----
 core/src/main/scala/kafka/log/LogSegment.scala   |  4 ++--
 core/src/test/scala/unit/kafka/log/LogTest.scala | 12 +++++-------
 3 files changed, 22 insertions(+), 14 deletions(-)
d0e948ca86730a900adbe3300fe4af01cf15922a

 .../scala/unit/kafka/network/SocketServerTest.scala    | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)
c66e4d58687bee54bae6a31e976d4b9b63c36de1

 core/src/main/scala/kafka/server/KafkaApis.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b448d4e075f0f138530e6cfc0634f4035c8d1878

 core/src/main/scala/kafka/tools/GetOffsetShell.scala | 12 +++---------
 1 file changed, 3 insertions(+), 9 deletions(-)
cd3b79699341afb8d52c51d9ac7317d93c32eeb6

 .../main/scala/kafka/tools/GetOffsetShell.scala    | 70 +++++++++++++++-------
 kafka-patch-review.py                              |  2 +-
 2 files changed, 49 insertions(+), 23 deletions(-)
d5dfa28596857d5564c14b598901653714717bdc

 .../0.7/bin/kafka-run-class.sh                     |  8 ++-
 .../0.7/config/test-log4j.properties               | 68 ++++++++++++++++++++++
 system_test/utils/kafka_system_test_utils.py       |  1 +
 3 files changed, 76 insertions(+), 1 deletion(-)
1c36605687d8244536b337f83cde2c5f88a60d0a

 .../0.7/bin/kafka-run-class.sh                     |  8 ++-
 .../0.7/config/test-log4j.properties               | 68 ++++++++++++++++++++++
 system_test/utils/kafka_system_test_utils.py       |  1 +
 3 files changed, 76 insertions(+), 1 deletion(-)
ccdb56201e494d6025e47a48c82f233ccc9386ac

 core/src/main/scala/kafka/log/OffsetIndex.scala         |  2 +-
 core/src/main/scala/kafka/server/OffsetCheckpoint.scala | 16 ++++++++--------
 2 files changed, 9 insertions(+), 9 deletions(-)
c98b6de15db9a2ce72f44a5b2736f74de5066113

 .../kafka/consumer/ConsumerFetcherManager.scala    |  11 +--
 .../consumer/ZookeeperConsumerConnector.scala      |   6 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 109 +++++++++++++++------
 .../scala/kafka/server/AbstractFetcherThread.scala |  11 +--
 core/src/main/scala/kafka/utils/Os.scala           |  23 +++++
 core/src/main/scala/kafka/utils/Utils.scala        |  13 +++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  12 +--
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  14 +++
 8 files changed, 138 insertions(+), 61 deletions(-)
a160f1023b23c7d9d79c7970a72f48ae883dfe07

 .../main/scala/kafka/tools/GetOffsetShell.scala    | 63 ++++++++++++++++------
 kafka-patch-review.py                              |  2 +-
 2 files changed, 48 insertions(+), 17 deletions(-)
e351039b1a9ed188e3be1581f31674b876094274

 core/src/main/scala/kafka/utils/VerifiableProperties.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
062d910e3235ef71b1e7a01472f4360658c83bea

 core/src/main/scala/kafka/consumer/ConsumerFetcherManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
51966c336f23c5477003ce394e7242940b88a80a

 core/src/main/scala/kafka/consumer/ConsumerFetcherManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
3e7c9c6abfed90b4e6e0e1bb3c806adf1c6bbbe9

 bin/kafka-console-consumer.sh           |  2 +-
 bin/kafka-console-producer.sh           |  2 +-
 bin/kafka-consumer-perf-test.sh         |  2 +-
 bin/kafka-preferred-replica-election.sh |  2 +-
 bin/kafka-producer-perf-test.sh         |  2 +-
 bin/kafka-reassign-partitions.sh        |  2 +-
 bin/kafka-replay-log-producer.sh        |  2 +-
 bin/kafka-run-class.sh                  | 18 ++----------------
 bin/kafka-server-start.sh               |  2 +-
 bin/kafka-simple-consumer-perf-test.sh  |  2 +-
 bin/kafka-simple-consumer-shell.sh      |  2 +-
 bin/kafka-topics.sh                     |  2 +-
 bin/zookeeper-server-start.sh           |  2 +-
 bin/zookeeper-shell.sh                  |  2 +-
 14 files changed, 15 insertions(+), 29 deletions(-)
ba1ceea6d3126e3f6bff427f7f5a1dcb705fe402

 bin/kafka-add-partitions.sh             |  2 +-
 bin/kafka-console-consumer.sh           |  2 +-
 bin/kafka-console-producer.sh           |  2 +-
 bin/kafka-consumer-perf-test.sh         |  2 +-
 bin/kafka-create-topic.sh               |  2 +-
 bin/kafka-list-topic.sh                 |  2 +-
 bin/kafka-preferred-replica-election.sh |  2 +-
 bin/kafka-producer-perf-test.sh         |  2 +-
 bin/kafka-reassign-partitions.sh        |  2 +-
 bin/kafka-replay-log-producer.sh        |  2 +-
 bin/kafka-run-class.sh                  | 18 ++----------------
 bin/kafka-server-start.sh               |  2 +-
 bin/kafka-simple-consumer-perf-test.sh  |  2 +-
 bin/kafka-simple-consumer-shell.sh      |  2 +-
 bin/zookeeper-server-start.sh           |  2 +-
 bin/zookeeper-shell.sh                  |  2 +-
 16 files changed, 17 insertions(+), 31 deletions(-)
b0fecacbe8232deea5ea8a71e8dd9b57c7cf0435

 project/Build.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
ace95c48a924db69ea6c6053d4cc2943c7b8958a

 bin/kafka-add-partitions.sh | 18 ------------------
 1 file changed, 18 deletions(-)
24c90526074e2edd58ce1766b439523498a17743

 project/Build.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
8d4dbe60f188c48a7f0d552b7b1109fb8e126521

 .../scala/kafka/admin/AddPartitionsCommand.scala   | 127 ---------------------
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  56 +++++++++
 core/src/main/scala/kafka/admin/TopicCommand.scala |  23 ++--
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  10 +-
 4 files changed, 76 insertions(+), 140 deletions(-)
7c920e97ef9e2db80774d6ccd9b85e3934e92645

 core/src/main/scala/kafka/admin/TopicCommand.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
b998f5d8790cf6f4d079cba399f5c5ea8ea43e68

 core/src/main/scala/kafka/admin/AdminUtils.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c304a92a1ce39cc7b7e329fde0b97f93cb8caee3

 .../scala/kafka/admin/AddPartitionsCommand.scala   | 127 ---------------------
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  57 +++++++++
 core/src/main/scala/kafka/admin/TopicCommand.scala |  22 ++--
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  10 +-
 4 files changed, 76 insertions(+), 140 deletions(-)
6273696fb2a2da22b3b99af60ffe31c01362fdbc

 .../kafka/consumer/ConsumerFetcherManager.scala    |  11 +--
 .../consumer/ZookeeperConsumerConnector.scala      |   6 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 108 +++++++++++++++------
 .../scala/kafka/server/AbstractFetcherThread.scala |  11 +--
 core/src/main/scala/kafka/utils/Os.scala           |  23 +++++
 core/src/main/scala/kafka/utils/Utils.scala        |  13 +++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  12 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   6 +-
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  14 +++
 9 files changed, 140 insertions(+), 64 deletions(-)
343a1e2660aa7c3c847c459360a5fbbcb065c759
b384c27c33dc12d466b4e432b03faea5f88b55aa

 README.md | 28 ++++++++++++++++++----------
 1 file changed, 18 insertions(+), 10 deletions(-)
a6904a2644a95a3d8d2a59e3915a76e7ee43557a

 system_test/utils/kafka_system_test_utils.py | 14 ++++++++++----
 1 file changed, 10 insertions(+), 4 deletions(-)
f53fe18361a434c388e88b0eed90b8faa0983fd8

 core/src/main/scala/kafka/cluster/Partition.scala | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
bfc4ba499521addf3d109c3fbe77b8908eabc644
1cb217579bbb1f9d4df24a3d32bf88644697b7fe

 .../consumer/ZookeeperConsumerConnector.scala      | 38 ++++++++++++++++++----
 1 file changed, 32 insertions(+), 6 deletions(-)
40efe0a972e8a1673b51b05f3937265d97acb01c

 core/src/main/scala/kafka/admin/ReassignPartitionsCommand.scala | 2 +-
 core/src/test/scala/unit/kafka/admin/AdminTest.scala            | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)
71ed6ca3368ff38909f502565a4bf0f39e70fc6c

 bin/kafka-check-reassignment-status.sh             |  17 ----
 .../kafka/admin/CheckReassignmentStatus.scala      | 110 ---------------------
 .../kafka/admin/ReassignPartitionsCommand.scala    |  74 +++++++++++---
 3 files changed, 63 insertions(+), 138 deletions(-)
2c6d3c7b450e50e2efaab8d55a5574b2ec1cd376

 config/test-log4j.properties                 | 68 ++++++++++++++++++++++++++++
 system_test/utils/kafka_system_test_utils.py |  1 +
 2 files changed, 69 insertions(+)
93921a3a5720a1ffd9e272d59d8a7627da28e89e

 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
dcbf0bf0b7e949e0f2652d6f3bd967349813bf6f

 core/src/main/scala/kafka/controller/KafkaController.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
56ada9576204b754e792a3d3c9063908f4f24b4d

 project/Build.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
bb7b45cd5d454d64c3454b01f8f3f1e13ed26ff3

 .../hadoop-consumer/src/main/java/kafka/etl/KafkaETLContext.java   | 2 +-
 .../src/main/java/kafka/etl/impl/SimpleKafkaETLMapper.java         | 7 ++++---
 2 files changed, 5 insertions(+), 4 deletions(-)
61b8b2bf818c36e5844a32b24b2855c32bd34254

 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8959690e96f22e6905f80c76faa355448e4d2e51

 .reviewboardrc        |   3 ++
 kafka-patch-review.py | 103 ++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 106 insertions(+)
d6f95cf97a928067977fef5216e954d5147fd138

 .reviewboardrc        |   3 ++
 kafka-patch-review.py | 103 ++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 106 insertions(+)
c6ca971738700643ecba78ad1f3998062481aab9

 .../scala/kafka/consumer/ZookeeperConsumerConnector.scala  | 14 ++------------
 1 file changed, 2 insertions(+), 12 deletions(-)
9feef9fd60920cf25a88e03dc5711745c0b7c0c5

 core/src/main/scala/kafka/utils/Utils.scala | 22 +++++++++++-----------
 1 file changed, 11 insertions(+), 11 deletions(-)
aebf746190685d055358ca122aedc424fe024afa

 core/src/main/scala/kafka/api/FetchRequest.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
0c1885b800077e4d360935a6d91fe1068a684560

 core/src/main/scala/kafka/api/ProducerRequest.scala | 15 ++++++++++-----
 1 file changed, 10 insertions(+), 5 deletions(-)
324936609f9e087aa4168e7f7581148e34b346a4
fed901cad2e7f8fe8dffd36b72006d912c18743a

 .../main/scala/kafka/utils/Annotations_2.8.scala   | 36 ++++++++++++++++++++
 .../main/scala/kafka/utils/Annotations_2.9+.scala  | 38 ++++++++++++++++++++++
 2 files changed, 74 insertions(+)
8e554c4d2acf5108805905b9f06198f20398ee3a

 core/build.sbt                                     |  1 +
 core/src/main/scala/kafka/Kafka.scala              |  2 +-
 .../scala/kafka/admin/AddPartitionsCommand.scala   |  2 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   | 14 ++++++---
 .../scala/kafka/admin/DeleteTopicCommand.scala     |  2 +-
 .../PreferredReplicaLeaderElectionCommand.scala    |  6 ++--
 .../kafka/admin/ReassignPartitionsCommand.scala    |  4 +--
 core/src/main/scala/kafka/client/ClientUtils.scala |  2 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |  2 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  6 ++--
 .../kafka/consumer/ConsumerFetcherManager.scala    |  4 +--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  2 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |  2 +-
 .../consumer/ZookeeperConsumerConnector.scala      | 10 +++---
 .../consumer/ZookeeperTopicEventWatcher.scala      |  2 +-
 .../controller/ControllerChannelManager.scala      |  4 +--
 .../scala/kafka/controller/KafkaController.scala   | 16 +++++-----
 .../kafka/controller/PartitionStateMachine.scala   | 20 +++++++-----
 .../kafka/controller/ReplicaStateMachine.scala     |  4 +--
 .../main/scala/kafka/javaapi/FetchRequest.scala    |  7 +++--
 core/src/main/scala/kafka/javaapi/Implicits.scala  |  6 ++++
 .../scala/kafka/javaapi/OffsetCommitRequest.scala  |  5 ++-
 .../scala/kafka/javaapi/OffsetCommitResponse.scala |  3 +-
 .../scala/kafka/javaapi/OffsetFetchRequest.scala   |  6 +++-
 .../scala/kafka/javaapi/OffsetFetchResponse.scala  |  3 +-
 .../main/scala/kafka/javaapi/OffsetRequest.scala   |  7 +++--
 .../main/scala/kafka/javaapi/TopicMetadata.scala   | 24 ++++++++++-----
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |  8 +++--
 .../consumer/ZookeeperConsumerConnector.scala      | 15 ++++++---
 .../javaapi/message/ByteBufferMessageSet.scala     |  4 ++-
 .../scala/kafka/javaapi/producer/Producer.scala    |  3 +-
 core/src/main/scala/kafka/log/Log.scala            | 14 ++++++---
 core/src/main/scala/kafka/log/LogConfig.scala      |  3 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  4 +--
 .../kafka/network/BoundedByteBufferReceive.scala   |  2 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |  2 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  4 +--
 .../kafka/producer/async/ProducerSendThread.scala  |  4 +--
 .../scala/kafka/server/AbstractFetcherThread.scala |  6 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 12 ++++----
 .../scala/kafka/server/KafkaServerStartable.scala  |  4 +--
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 .../scala/kafka/server/TopicConfigManager.scala    |  6 ++--
 .../kafka/server/ZookeeperLeaderElector.scala      |  2 +-
 .../main/scala/kafka/tools/ImportZkOffsets.scala   |  2 +-
 core/src/main/scala/kafka/tools/JmxTool.scala      |  2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  4 +--
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  2 +-
 core/src/main/scala/kafka/utils/Annotations.scala  | 36 ----------------------
 core/src/main/scala/kafka/utils/Json.scala         |  2 +-
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  2 +-
 core/src/main/scala/kafka/utils/Mx4jLoader.scala   |  2 +-
 core/src/main/scala/kafka/utils/Pool.scala         | 12 ++++++--
 .../scala/kafka/utils/VerifiableProperties.scala   |  5 ++-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 24 +++++++--------
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  4 +--
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  8 +++--
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  9 +++---
 .../javaapi/message/BaseMessageSetTestCases.scala  |  7 ++---
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  2 +-
 .../scala/unit/kafka/metrics/KafkaTimerTest.scala  |  5 +--
 .../unit/kafka/producer/AsyncProducerTest.scala    |  7 +++--
 .../scala/unit/kafka/producer/ProducerTest.scala   | 14 ++++-----
 .../unit/kafka/producer/SyncProducerTest.scala     |  4 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 .../scala/kafka/perf/ConsumerPerformance.scala     |  2 +-
 project/Build.scala                                |  3 +-
 67 files changed, 230 insertions(+), 191 deletions(-)
75d95d9b0770d187916bed1dd1ca7a3e82ef08b0
c12d2ea9e5b4bdcf9aeb07c89c69553a9f270c82

 core/build.sbt                                     |  1 +
 core/src/main/scala/kafka/Kafka.scala              |  2 +-
 .../scala/kafka/admin/AddPartitionsCommand.scala   |  2 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  2 +-
 .../scala/kafka/admin/CreateTopicCommand.scala     |  2 +-
 .../scala/kafka/admin/DeleteTopicCommand.scala     |  2 +-
 .../main/scala/kafka/admin/ListTopicCommand.scala  |  2 +-
 .../PreferredReplicaLeaderElectionCommand.scala    |  6 +-
 .../kafka/admin/ReassignPartitionsCommand.scala    |  4 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |  2 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |  2 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  6 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |  4 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  2 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |  2 +-
 .../consumer/ZookeeperConsumerConnector.scala      | 10 +--
 .../consumer/ZookeeperTopicEventWatcher.scala      |  2 +-
 .../controller/ControllerChannelManager.scala      |  4 +-
 .../scala/kafka/controller/KafkaController.scala   | 16 ++--
 .../kafka/controller/PartitionStateMachine.scala   | 20 +++--
 .../kafka/controller/ReplicaStateMachine.scala     |  4 +-
 .../main/scala/kafka/javaapi/FetchRequest.scala    |  6 +-
 core/src/main/scala/kafka/javaapi/Implicits.scala  |  6 ++
 .../main/scala/kafka/javaapi/OffsetRequest.scala   |  5 +-
 .../main/scala/kafka/javaapi/TopicMetadata.scala   | 24 ++++--
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |  8 +-
 .../consumer/ZookeeperConsumerConnector.scala      | 15 ++--
 .../javaapi/message/ByteBufferMessageSet.scala     |  4 +-
 .../scala/kafka/javaapi/producer/Producer.scala    |  3 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  2 +-
 .../kafka/network/BoundedByteBufferReceive.scala   |  2 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |  2 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  4 +-
 .../kafka/producer/async/ProducerSendThread.scala  |  4 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  6 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  8 +-
 .../scala/kafka/server/KafkaServerStartable.scala  |  4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 .../kafka/server/ZookeeperLeaderElector.scala      |  2 +-
 .../main/scala/kafka/tools/ImportZkOffsets.scala   |  2 +-
 core/src/main/scala/kafka/tools/JmxTool.scala      |  2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  4 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  2 +-
 core/src/main/scala/kafka/utils/Annotations.scala  | 36 ---------
 .../main/scala/kafka/utils/Annotations_2.8.scala   | 36 +++++++++
 .../main/scala/kafka/utils/Annotations_2.9+.scala  | 38 ++++++++++
 core/src/main/scala/kafka/utils/Json.scala         |  2 +-
 core/src/main/scala/kafka/utils/Mx4jLoader.scala   |  2 +-
 core/src/main/scala/kafka/utils/Pool.scala         | 12 ++-
 core/src/main/scala/kafka/utils/Utils.scala        |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 24 +++---
 .../scala/unit/kafka/admin/AddPartitionsTest.scala |  4 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 12 +--
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  6 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  5 +-
 .../javaapi/message/BaseMessageSetTestCases.scala  |  7 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 88 +++++++++++-----------
 .../scala/unit/kafka/metrics/KafkaTimerTest.scala  |  5 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  5 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   | 14 ++--
 .../unit/kafka/producer/SyncProducerTest.scala     |  4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 .../scala/kafka/perf/ConsumerPerformance.scala     |  2 +-
 project/Build.scala                                |  3 +-
 64 files changed, 302 insertions(+), 221 deletions(-)
da4512174b6f7c395ffe053a86d2c6bb19d2538a

 core/src/main/scala/kafka/producer/ConsoleProducer.scala | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)
20953b52558935ba210eaee18e9504bf16bfec27

 .../scala/kafka/consumer/ConsumerFetcherManager.scala     | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)
f89ddced1ba058f0c51697957cde8bb2e2b05c4d

 .../main/scala/kafka/network/RequestChannel.scala  | 24 ++++++++++++++-
 .../main/scala/kafka/network/SocketServer.scala    | 34 +++++++++++++---------
 core/src/main/scala/kafka/server/KafkaApis.scala   | 17 +++++++----
 .../scala/unit/kafka/producer/ProducerTest.scala   |  4 ++-
 .../unit/kafka/producer/SyncProducerTest.scala     | 27 +++++++++++++++++
 5 files changed, 86 insertions(+), 20 deletions(-)
ea54700d57e18e59e210814b70bddca38739d414
51de7c55d2b3107b79953f401fc8c9530bd0eea0

 bin/kafka-server-stop.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
39fc578d5da3f871fbcd5205de010f1f574507d1

 .../kafka/admin/ReassignPartitionsCommand.scala    |  94 +++++++++++----
 .../scala/kafka/controller/KafkaController.scala   | 130 ++++++++++-----------
 .../kafka/controller/ReplicaStateMachine.scala     |   7 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  18 +++
 4 files changed, 162 insertions(+), 87 deletions(-)
7640bee3d281e0658f97997738a1f1f599fd4c07

 core/src/main/scala/kafka/server/ZookeeperLeaderElector.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
d217f4cc276eee021a0d756d3390b633e43f7115

 core/src/main/scala/kafka/producer/Producer.scala  | 33 ++++++----
 .../kafka/producer/async/DefaultEventHandler.scala | 77 +++++++++++-----------
 2 files changed, 56 insertions(+), 54 deletions(-)
ff6292904a67cd021d365ef1e07c113002b80582

 core/src/main/scala/kafka/log/FileMessageSet.scala    | 5 +++++
 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 4 ++--
 2 files changed, 7 insertions(+), 2 deletions(-)
ceb55cad5863fa7c39615e48a5d6358eb416a83e

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala      | 2 +-
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 8 ++++----
 core/src/main/scala/kafka/server/KafkaApis.scala             | 3 +--
 core/src/main/scala/kafka/server/KafkaRequestHandler.scala   | 2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala            | 5 +++--
 5 files changed, 10 insertions(+), 10 deletions(-)
6849da0505da1f38edfbfb64e27cff504231142a

 core/src/main/scala/kafka/cluster/Broker.scala     |   2 -
 .../consumer/ZookeeperConsumerConnector.scala      |  24 +----
 .../scala/kafka/controller/KafkaController.scala   |  25 ++++-
 .../kafka/server/ZookeeperLeaderElector.scala      |  89 +++++-------------
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 101 +++++++++++----------
 5 files changed, 103 insertions(+), 138 deletions(-)
7a9faa49ed5c7581cb2bd6c86b68df06a8879fec

 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 3 ++-
 core/src/main/scala/kafka/tools/ImportZkOffsets.scala               | 3 ---
 2 files changed, 2 insertions(+), 4 deletions(-)
1db824ed2fcdaa45c3b1d0dcbf9101299fded09c

 .../consumer/ZookeeperConsumerConnector.scala      | 30 ++++++-
 .../scala/kafka/controller/KafkaController.scala   |  3 +-
 .../kafka/server/ZookeeperLeaderElector.scala      | 98 +++++++++++++++++-----
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 20 ++++-
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 5 files changed, 126 insertions(+), 27 deletions(-)
1d75e09313b5b3f1cde6c39fdda20bc7185cfdf6

 .../consumer/ZookeeperConsumerConnector.scala      | 30 +------
 .../scala/kafka/controller/KafkaController.scala   |  3 +-
 .../kafka/server/ZookeeperLeaderElector.scala      | 97 +++++-----------------
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 22 +----
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 5 files changed, 28 insertions(+), 126 deletions(-)
81c49bbdae5e490f9d5dc7b042ee60e617fbb22b

 .../consumer/ZookeeperConsumerConnector.scala      | 30 ++++++-
 .../scala/kafka/controller/KafkaController.scala   |  3 +-
 .../kafka/server/ZookeeperLeaderElector.scala      | 97 +++++++++++++++++-----
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 22 ++++-
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 5 files changed, 126 insertions(+), 28 deletions(-)
e7a546b67cdcdcbb1071ed805a4e4177cbbc15ff

 core/src/main/scala/kafka/consumer/ConsumerFetcherManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9753d15ef1da0ecab9bbee51d8cdc08c2159c50b

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala  | 14 +++++++-------
 core/src/main/scala/kafka/cluster/Partition.scala   | 21 +++++++++++----------
 .../kafka/controller/ControllerChannelManager.scala |  7 +++----
 .../scala/kafka/controller/KafkaController.scala    |  4 ++--
 .../kafka/controller/PartitionStateMachine.scala    |  4 ++--
 .../kafka/controller/ReplicaStateMachine.scala      |  2 +-
 .../main/scala/kafka/server/ReplicaManager.scala    |  6 +++---
 7 files changed, 29 insertions(+), 29 deletions(-)
df18fe13ad50bba3dbc7d1db0ecd8b698169ade2

 config/server.properties                           |  18 +--
 core/src/main/scala/kafka/cluster/Partition.scala  |   1 +
 core/src/main/scala/kafka/log/FileMessageSet.scala |   4 +-
 core/src/main/scala/kafka/log/Log.scala            | 137 +++++++++++----------
 core/src/main/scala/kafka/log/LogManager.scala     |  38 ++++--
 core/src/main/scala/kafka/log/LogSegment.scala     |  11 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    |   1 -
 core/src/main/scala/kafka/server/KafkaConfig.scala |  14 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |   1 +
 .../src/test/scala/other/kafka/StressTestLog.scala |   2 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   | 116 +++++++++++++----
 .../scala/other/kafka/TestLogPerformance.scala     |  58 ---------
 .../test/scala/unit/kafka/log/CleanerTest.scala    |   2 +-
 .../unit/kafka/log/LogCleanerIntegrationTest.scala |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  39 +++++-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  13 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  88 +++++++++----
 .../server/HighwatermarkPersistenceTest.scala      |   1 +
 .../unit/kafka/server/ServerShutdownTest.scala     |   7 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   9 ++
 20 files changed, 331 insertions(+), 231 deletions(-)
1d6ad3d7d441bc7174a445a4e5e49319ee1003eb

 .../consumer/ZookeeperConsumerConnector.scala      | 94 ++++++++++++----------
 1 file changed, 50 insertions(+), 44 deletions(-)
7fbbb6666bef10f31301c4af17a6077e8895fa06

 core/src/test/scala/unit/kafka/utils/TestUtils.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
14af713252f016929f8150f2f6c2df9d0d447ddb

 README.md                                   | 55 +++++++++++++----------------
 bin/kafka-add-partitions.sh                 |  1 -
 bin/kafka-check-reassignment-status.sh      |  3 +-
 bin/kafka-console-consumer-log4j.properties | 21 -----------
 bin/kafka-console-consumer.sh               |  5 ++-
 bin/kafka-console-producer.sh               |  4 +--
 bin/kafka-consumer-perf-test.sh             |  1 +
 bin/kafka-create-topic.sh                   |  4 +--
 bin/kafka-delete-topic.sh                   | 19 ----------
 bin/kafka-list-topic.sh                     |  4 +--
 bin/kafka-preferred-replica-election.sh     |  3 +-
 bin/kafka-producer-perf-test.sh             |  1 +
 bin/kafka-reassign-partitions.sh            |  3 +-
 bin/kafka-replay-log-producer.sh            |  4 +--
 bin/kafka-run-class.sh                      | 53 ++++++++++++++++++++++-----
 bin/kafka-server-start.sh                   |  8 ++---
 bin/kafka-simple-consumer-perf-test.sh      |  1 +
 bin/zookeeper-server-start.sh               |  5 ++-
 config/log4j.properties                     |  8 ++---
 config/producer.properties                  |  2 +-
 config/server.properties                    | 18 ++++------
 config/tools-log4j.properties               | 22 ++++++++++++
 22 files changed, 123 insertions(+), 122 deletions(-)
f3f8fa5c8c17ade2205ef0f80d9092cae640327d

 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 40 +++++++++++++++++-----
 2 files changed, 33 insertions(+), 9 deletions(-)
493a46613e9a90c0879de96d04c42696fdf95510

 core/src/main/scala/kafka/server/KafkaServer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
bdb2fdc6460c48189b487e1e8a75c344e32aa222

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
81a9f6a682e5ca35a041717d6c1d4a60af5fd36a

 system_test/mirror_maker_testsuite/mirror_maker_test.py | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
ed3e146cf4b48683756e3c445f539fa99ba9076a
0c8aefc251d03ba824cecd6acbcbdf143fdebfb8

 core/src/main/scala/kafka/consumer/PartitionTopicInfo.scala | 2 ++
 1 file changed, 2 insertions(+)
b6479e8adca6be8e363d289be29dc755e0655550

 contrib/hadoop-producer/README.md                    |  4 ++--
 .../java/kafka/bridge/hadoop/KafkaOutputFormat.java  |  7 +++----
 .../java/kafka/bridge/hadoop/KafkaRecordWriter.java  | 20 +++++++++++---------
 3 files changed, 16 insertions(+), 15 deletions(-)
8edd3e63024832f2c05b5819ab3dfc2e0b300729

 .../src/main/java/kafka/bridge/hadoop/KafkaOutputFormat.java       | 7 +++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala                 | 4 ++--
 2 files changed, 7 insertions(+), 4 deletions(-)
d285e263bf403f3db27f5d138594c395643a2284

 .../scala/kafka/producer/ConsoleProducer.scala     |  2 +-
 .../scala/kafka/producer/DefaultPartitioner.scala  |  4 +--
 .../main/scala/kafka/producer/KeyedMessage.scala   | 18 ++++++++++---
 .../main/scala/kafka/producer/Partitioner.scala    |  4 +--
 core/src/main/scala/kafka/producer/Producer.scala  |  2 +-
 .../kafka/producer/async/DefaultEventHandler.scala | 11 ++++----
 .../test/scala/other/kafka/TestLogCleaning.scala   |  4 +--
 .../scala/unit/kafka/integration/FetcherTest.scala |  2 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    | 31 +++++++++++-----------
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 14 +++++-----
 10 files changed, 53 insertions(+), 39 deletions(-)
76d39052f717cb6d9fdac6a516df298036b5ffff

 .../kafka/producer/async/DefaultEventHandler.scala | 27 ++++++++++++++++------
 1 file changed, 20 insertions(+), 7 deletions(-)
bc5620cbd270cd8ab443f567fee5203c66db253f

 core/src/main/scala/kafka/tools/MirrorMaker.scala | 29 +++++++++++++----------
 1 file changed, 17 insertions(+), 12 deletions(-)
5cf6a546649c213c33ef41d5d47e6af959c0c587

 .../kafka/producer/ByteArrayPartitioner.scala      | 27 +++++++++++++++++++
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 30 ++++++++++++++++++----
 2 files changed, 52 insertions(+), 5 deletions(-)
401d59199cf727f5001dcec3eaa05fa9cdfd079e

 .../kafka/consumer/ZookeeperConsumerConnector.scala  | 20 ++++++++++++--------
 1 file changed, 12 insertions(+), 8 deletions(-)
ce7d588055e7d3aacebcc696665b1260fa2e9063

 .../0.7/lib/kafka-perf-0.7.0.jar                    | Bin 52975 -> 55427 bytes
 .../config/migration_producer.properties            |   3 +++
 .../migration_tool_testsuite/migration_tool_test.py |   4 +++-
 .../testcase_9001/testcase_9001_properties.json     |   1 -
 .../testcase_9003/testcase_9003_properties.json     |   1 -
 .../testcase_9004/testcase_9004_properties.json     |   1 -
 .../testcase_9005/testcase_9005_properties.json     |   2 --
 .../testcase_9006/testcase_9006_properties.json     |   2 --
 system_test/utils/kafka_system_test_utils.py        |   1 +
 9 files changed, 7 insertions(+), 8 deletions(-)
a984f2fe5e3370163fb53586a04611ebd878c5ae

 .../scala/kafka/perf/ProducerPerformance.scala     | 52 ++++++++++++++++++++--
 1 file changed, 48 insertions(+), 4 deletions(-)
f596ab577869a71811fee6bffdfcd171cd188fa6

 system_test/replication_testsuite/replica_basic_test.py               | 4 ++--
 .../replication_testsuite/testcase_0001/testcase_0001_properties.json | 1 +
 .../replication_testsuite/testcase_0002/testcase_0002_properties.json | 1 +
 .../replication_testsuite/testcase_0003/testcase_0003_properties.json | 1 +
 .../replication_testsuite/testcase_0004/testcase_0004_properties.json | 1 +
 .../replication_testsuite/testcase_0005/testcase_0005_properties.json | 1 +
 .../replication_testsuite/testcase_0006/testcase_0006_properties.json | 1 +
 .../replication_testsuite/testcase_0007/testcase_0007_properties.json | 1 +
 .../replication_testsuite/testcase_0008/testcase_0008_properties.json | 1 +
 .../replication_testsuite/testcase_0009/testcase_0009_properties.json | 1 +
 .../replication_testsuite/testcase_0010/testcase_0010_properties.json | 1 +
 .../replication_testsuite/testcase_0011/testcase_0011_properties.json | 1 +
 .../replication_testsuite/testcase_0021/testcase_0021_properties.json | 2 ++
 .../replication_testsuite/testcase_0022/testcase_0022_properties.json | 2 ++
 .../replication_testsuite/testcase_0023/testcase_0023_properties.json | 2 ++
 .../replication_testsuite/testcase_0111/testcase_0111_properties.json | 1 +
 .../replication_testsuite/testcase_0112/testcase_0112_properties.json | 1 +
 .../replication_testsuite/testcase_0113/testcase_0113_properties.json | 1 +
 .../replication_testsuite/testcase_0114/testcase_0114_properties.json | 1 +
 .../replication_testsuite/testcase_0115/testcase_0115_properties.json | 1 +
 .../replication_testsuite/testcase_0116/testcase_0116_properties.json | 1 +
 .../replication_testsuite/testcase_0117/testcase_0117_properties.json | 1 +
 .../replication_testsuite/testcase_0118/testcase_0118_properties.json | 1 +
 .../replication_testsuite/testcase_0121/testcase_0121_properties.json | 2 ++
 .../replication_testsuite/testcase_0122/testcase_0122_properties.json | 2 ++
 .../replication_testsuite/testcase_0123/testcase_0123_properties.json | 2 ++
 .../replication_testsuite/testcase_0124/testcase_0124_properties.json | 2 ++
 .../replication_testsuite/testcase_0125/testcase_0125_properties.json | 2 ++
 .../replication_testsuite/testcase_0126/testcase_0126_properties.json | 2 ++
 .../replication_testsuite/testcase_0127/testcase_0127_properties.json | 2 ++
 .../replication_testsuite/testcase_0131/testcase_0131_properties.json | 2 ++
 .../replication_testsuite/testcase_0132/testcase_0132_properties.json | 2 ++
 .../replication_testsuite/testcase_0133/testcase_0133_properties.json | 2 ++
 .../replication_testsuite/testcase_0201/testcase_0201_properties.json | 1 +
 .../replication_testsuite/testcase_0202/testcase_0202_properties.json | 1 +
 .../replication_testsuite/testcase_0203/testcase_0203_properties.json | 1 +
 .../replication_testsuite/testcase_0204/testcase_0204_properties.json | 1 +
 .../replication_testsuite/testcase_0205/testcase_0205_properties.json | 1 +
 .../replication_testsuite/testcase_0206/testcase_0206_properties.json | 1 +
 .../replication_testsuite/testcase_0207/testcase_0207_properties.json | 1 +
 .../replication_testsuite/testcase_0208/testcase_0208_properties.json | 1 +
 .../replication_testsuite/testcase_0251/testcase_0251_properties.json | 1 +
 .../replication_testsuite/testcase_0252/testcase_0252_properties.json | 1 +
 .../replication_testsuite/testcase_0253/testcase_0253_properties.json | 1 +
 .../replication_testsuite/testcase_0254/testcase_0254_properties.json | 1 +
 .../replication_testsuite/testcase_0255/testcase_0255_properties.json | 1 +
 .../replication_testsuite/testcase_0256/testcase_0256_properties.json | 1 +
 .../replication_testsuite/testcase_0257/testcase_0257_properties.json | 1 +
 .../replication_testsuite/testcase_0258/testcase_0258_properties.json | 1 +
 .../replication_testsuite/testcase_0301/testcase_0301_properties.json | 1 +
 .../replication_testsuite/testcase_0302/testcase_0302_properties.json | 1 +
 .../replication_testsuite/testcase_0303/testcase_0303_properties.json | 1 +
 .../replication_testsuite/testcase_0304/testcase_0304_properties.json | 1 +
 .../replication_testsuite/testcase_0305/testcase_0305_properties.json | 1 +
 .../replication_testsuite/testcase_0306/testcase_0306_properties.json | 1 +
 .../replication_testsuite/testcase_0307/testcase_0307_properties.json | 1 +
 .../replication_testsuite/testcase_0308/testcase_0308_properties.json | 1 +
 .../replication_testsuite/testcase_4001/testcase_4001_properties.json | 2 ++
 .../replication_testsuite/testcase_4002/testcase_4002_properties.json | 2 ++
 .../replication_testsuite/testcase_4003/testcase_4003_properties.json | 2 ++
 .../replication_testsuite/testcase_4004/testcase_4004_properties.json | 2 ++
 .../replication_testsuite/testcase_4005/testcase_4005_properties.json | 2 ++
 .../replication_testsuite/testcase_4006/testcase_4006_properties.json | 2 ++
 .../replication_testsuite/testcase_4007/testcase_4007_properties.json | 2 ++
 .../replication_testsuite/testcase_4008/testcase_4008_properties.json | 2 ++
 .../replication_testsuite/testcase_4011/testcase_4011_properties.json | 2 ++
 .../replication_testsuite/testcase_4012/testcase_4012_properties.json | 2 ++
 .../replication_testsuite/testcase_4013/testcase_4013_properties.json | 2 ++
 .../replication_testsuite/testcase_4014/testcase_4014_properties.json | 2 ++
 .../replication_testsuite/testcase_4015/testcase_4015_properties.json | 2 ++
 .../replication_testsuite/testcase_4016/testcase_4016_properties.json | 2 ++
 .../replication_testsuite/testcase_4017/testcase_4017_properties.json | 2 ++
 .../replication_testsuite/testcase_4018/testcase_4018_properties.json | 2 ++
 73 files changed, 103 insertions(+), 2 deletions(-)
d3aa3ef073fe773a10168f925a45747f52c4e3c0

 .../replication_testsuite/replica_basic_test.py    | 36 +++++++-------
 system_test/utils/kafka_system_test_utils.py       | 57 ++++++++++++++++++++++
 2 files changed, 75 insertions(+), 18 deletions(-)
3817857b15f9ce03f10a9730f0ff4619d728b06f

 bin/kafka-add-partitions.sh                        |  19 ++
 .../scala/kafka/admin/AddPartitionsCommand.scala   | 127 +++++++++++
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  27 ++-
 .../scala/kafka/admin/CreateTopicCommand.scala     |   2 +-
 .../scala/kafka/controller/KafkaController.scala   |   2 +
 .../kafka/controller/PartitionStateMachine.scala   |  28 ++-
 .../scala/unit/kafka/admin/AddPartitionsTest.scala | 251 +++++++++++++++++++++
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  16 +-
 8 files changed, 448 insertions(+), 24 deletions(-)
b1891e700889e8e4ae78a6d73d785ff681ac70b9

 project/Build.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c27c768463a5dc6be113f2e5b3e00bf8d9d9d602

 .../src/main/scala/kafka/api/OffsetCommitResponse.scala | 17 +++--------------
 core/src/main/scala/kafka/api/OffsetFetchResponse.scala | 15 ++-------------
 core/src/main/scala/kafka/server/KafkaApis.scala        |  6 ++----
 3 files changed, 7 insertions(+), 31 deletions(-)
db37ed0054305a3f5d824166914092076b10ac1e
bf31a6bf705f0438dfc15320ff7047a62eb8f94d

 .../consumer/ZookeeperConsumerConnector.scala      | 152 +++++++++++----------
 1 file changed, 81 insertions(+), 71 deletions(-)
2cda5d1fca90e93ecfd44665fe32033ddce99c52
c98bdd3e4f6edb7a4db97a876c26e7d37e88e12a
c39d37e9dd97bf2462ffbd1a96c0b2cb05034bae

 .../src/main/java/kafka/bridge/hadoop/KafkaOutputFormat.java        | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
6b53c649e9d5708d683431522ca750e2fde40fb9

 project/plugins.sbt | 4 ++++
 1 file changed, 4 insertions(+)
86e314aa7301cc2802bb4910c07f0957e391ed18

 config/server.properties                                    | 2 +-
 core/src/main/scala/kafka/tools/ConsumerOffsetChecker.scala | 6 +++++-
 2 files changed, 6 insertions(+), 2 deletions(-)
5f14a69c2e5c21be9b1257e62040e89f400ac2d9

 core/src/main/scala/kafka/log/LogSegment.scala | 1 +
 1 file changed, 1 insertion(+)
5a084f7be6986ccbe6ede9df0b519d0fd7929d01

 core/src/main/scala/kafka/controller/ReplicaStateMachine.scala | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
cc6027b3279ac5cd8908d01d35511c93716fbe60

 core/src/main/scala/kafka/server/ReplicaManager.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
7b43f0132ce93a231b21e943d665ec4227f67b6b

 project/Build.scala | 17 ++++++++++++++++-
 1 file changed, 16 insertions(+), 1 deletion(-)
0a8716f8e026abcc586057a4fbaeb32d538cd393

 project/Build.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7ad742d802498542d0b60e87c331053805a94ac7

 core/src/main/scala/kafka/producer/SyncProducerConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
23acbd309f5e17de71db46cb6f1a60c8d38ea4e4

 .../scala/kafka/admin/CheckReassignmentStatus.scala    | 17 ++++++++++++++++-
 core/src/main/scala/kafka/api/ApiUtils.scala           | 18 +++++++++++++++++-
 .../main/scala/kafka/api/UpdateMetadataRequest.scala   | 18 +++++++++++++++++-
 core/src/main/scala/kafka/client/ClientUtils.scala     | 18 +++++++++++++++++-
 .../scala/kafka/common/BrokerNotExistException.scala   | 16 ++++++++++++++++
 .../main/scala/kafka/consumer/ConsumerTopicStat.scala  | 16 ++++++++++++++++
 core/src/main/scala/kafka/log/LogSegment.scala         | 18 +++++++++++++++++-
 .../kafka/producer/async/AsyncProducerStats.scala      | 16 ++++++++++++++++
 core/src/main/scala/kafka/utils/CommandLineUtils.scala | 18 +++++++++++++++++-
 core/src/main/scala/kafka/utils/FileLock.scala         | 18 +++++++++++++++++-
 core/src/main/scala/kafka/utils/Json.scala             | 18 +++++++++++++++++-
 core/src/main/scala/kafka/utils/Topic.scala            | 16 ++++++++++++++++
 .../src/test/scala/unit/kafka/log/LogSegmentTest.scala | 18 +++++++++++++++++-
 13 files changed, 216 insertions(+), 9 deletions(-)
5bd33c1517bb2e7734166dc3e787ac90a4ef8f86

 .../scala/kafka/consumer/ConsoleConsumer.scala     |  2 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    | 78 ++++++++--------------
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  6 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  2 +-
 4 files changed, 35 insertions(+), 53 deletions(-)
640026467cf705fbcf6fd6bcada058b18a95bff5

 core/src/main/scala/kafka/javaapi/Implicits.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6881bf08f26ec64c056c6880922c4321679ba92d

 core/src/main/scala/kafka/utils/DelayedItem.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ddb7947c05583ea317e8f994f07b83bf6d5213c3

 core/src/main/scala/kafka/producer/Producer.scala | 1 -
 1 file changed, 1 deletion(-)
9b30aceea3996853b95464d29a2582dbc173d2ac

 core/src/main/scala/kafka/admin/ShutdownBroker.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
9bd2a11486420a313f800d734cab8a858fac6d0e

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala | 8 ++++----
 core/src/main/scala/kafka/utils/ZkUtils.scala           | 2 +-
 core/src/test/scala/unit/kafka/utils/TestUtils.scala    | 1 +
 3 files changed, 6 insertions(+), 5 deletions(-)
fb37ea8c749c41b1e34158debc7e9221b4db8f31

 .../kafka/common/InvalidOffsetException.scala      | 22 ++++++++++++++++++++++
 core/src/main/scala/kafka/log/Log.scala            | 16 ++++++++++++++--
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 20 +++++++++++++-------
 .../scala/unit/kafka/log/OffsetIndexTest.scala     |  3 ++-
 4 files changed, 51 insertions(+), 10 deletions(-)
43c43b1c6d05fb93f4ca96a4e1a1aa8c6fd58d18

 core/src/main/scala/kafka/server/HighwaterMarkCheckpoint.scala | 10 +++++++---
 1 file changed, 7 insertions(+), 3 deletions(-)
4f387ae43544c422b1845b3da5ab09aee8e4acd0

 .../kafka/api/ControlledShutdownRequest.scala      |  73 +++++++++++
 .../kafka/api/ControlledShutdownResponse.scala     |  70 +++++++++++
 core/src/main/scala/kafka/api/RequestKeys.scala    |   4 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  11 +-
 .../scala/kafka/controller/KafkaController.scala   |  94 +++++---------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  13 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  14 ++-
 core/src/main/scala/kafka/server/KafkaServer.scala | 112 +++++++++++++++--
 .../main/scala/kafka/server/ReplicaManager.scala   |   3 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   6 +-
 .../unit/kafka/integration/RollingBounceTest.scala | 140 +++++++++++++++++++++
 .../server/HighwatermarkPersistenceTest.scala      |   5 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   3 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   8 +-
 14 files changed, 472 insertions(+), 84 deletions(-)
658427638f1b00ae1d284e579b4631f7119e54cc

 core/src/main/scala/kafka/controller/PartitionStateMachine.scala | 5 ++---
 core/src/main/scala/kafka/controller/ReplicaStateMachine.scala   | 5 ++---
 2 files changed, 4 insertions(+), 6 deletions(-)
4850519a2c32b3ee882eb79375ba77de8d0488f7

 .../kafka/consumer/ConsumerFetcherManager.scala    |  3 +-
 .../kafka/server/AbstractFetcherManager.scala      | 34 +++++++++++++++++++++-
 .../scala/kafka/server/AbstractFetcherThread.scala |  2 +-
 .../scala/kafka/server/ReplicaFetcherManager.scala |  3 +-
 4 files changed, 38 insertions(+), 4 deletions(-)
1caae2c2a10856ea2a31c8b82f1fae5b107a2a07

 .../scala/kafka/common/UnknownTopicException.scala | 25 ---------------
 .../kafka/producer/async/DefaultEventHandler.scala | 36 +++++++++++++---------
 .../kafka/producer/async/ProducerSendThread.scala  |  2 +-
 3 files changed, 22 insertions(+), 41 deletions(-)
d93cbc610a412d099324c2b4ce04660a00178fa9

 core/build.sbt                                |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala | 15 +++++----------
 2 files changed, 6 insertions(+), 11 deletions(-)
dc0de292531f0af0a0eba71d170c7bd2706500d8

 core/src/main/scala/kafka/api/OffsetRequest.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
492ed7a35d031b737b7c98dadcc8be777b9d2d57

 core/src/main/scala/kafka/message/Message.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
3b470f56b479f618b7e90577f9857b4e25b38c1a

 core/src/main/scala/kafka/consumer/ConsoleConsumer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
436dd25a4885fa13749604111000f52724eb4ccd

 bin/kafka-run-class.sh | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
bbb161aa250ce3071b03e01d9fa82091f23e1b30

 core/src/main/scala/kafka/controller/KafkaController.scala |  2 +-
 .../scala/kafka/controller/PartitionStateMachine.scala     |  8 +++-----
 .../main/scala/kafka/controller/ReplicaStateMachine.scala  | 12 +++++++++++-
 core/src/main/scala/kafka/utils/ZkUtils.scala              | 14 ++++++--------
 4 files changed, 21 insertions(+), 15 deletions(-)
e4f287db6142cafdf1ddb4ebf7110180ec06f7c4

 .../kafka/controller/PartitionLeaderSelector.scala |  7 ++++---
 core/src/main/scala/kafka/server/KafkaApis.scala   | 22 ++++++++++++++--------
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  8 ++++----
 3 files changed, 22 insertions(+), 15 deletions(-)
312ed2e67a0bca194ee3012c61239d30d8890566

 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
85c71591548d1069ff78214dd943df87fa87b3db

 .../replication_testsuite/testcase_0119/testcase_0119_properties.json    | 1 +
 1 file changed, 1 insertion(+)
517af4779aed73efa9889b89d99a9c789f091b06

 core/src/main/scala/kafka/consumer/ConsumerFetcherManager.scala | 1 -
 core/src/main/scala/kafka/consumer/ConsumerFetcherThread.scala  | 1 +
 2 files changed, 1 insertion(+), 1 deletion(-)
59599cc127f32e17b07092a6c59fce742d027c47

 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 1 +
 1 file changed, 1 insertion(+)
ffd84eb23fcbb279a63ba5d4cb72077a0c079cff

 .../kafka/consumer/ConsumerFetcherManager.scala    | 28 +++++++++++++++++--
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 32 ++++++++++++++++------
 2 files changed, 49 insertions(+), 11 deletions(-)
32cd8994bf35b65a8053e0caea9a7710cc889df7

 core/src/main/scala/kafka/controller/ControllerChannelManager.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
e93937c88639146657f314bfdd29b200c054cade

 core/src/main/scala/kafka/api/TopicMetadata.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
2d40ca30d34b2d4de35d5b811858b0f915451a19

 .../scala/kafka/controller/ControllerChannelManager.scala | 15 +++++++++++++--
 core/src/main/scala/kafka/server/KafkaApis.scala          |  8 ++++++--
 2 files changed, 19 insertions(+), 4 deletions(-)
eff59330f2ce19e7074d74f4d268774dd260bca7

 core/src/main/scala/kafka/server/KafkaApis.scala   | 50 +++++++++-------------
 .../unit/kafka/producer/AsyncProducerTest.scala    |  4 +-
 2 files changed, 23 insertions(+), 31 deletions(-)
cfdc403e1780882f62df6e9a092cda6bea017fbe

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  85 ------------
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  34 ++---
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |   2 +-
 core/src/main/scala/kafka/api/RequestKeys.scala    |   4 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |   9 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  |  28 ++++
 .../scala/kafka/api/TopicMetadataRequest.scala     |   2 +-
 .../scala/kafka/api/UpdateMetadataRequest.scala    | 104 +++++++++++++++
 .../scala/kafka/api/UpdateMetadataResponse.scala   |  44 +++++++
 core/src/main/scala/kafka/client/ClientUtils.scala |   7 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     |   7 +
 .../main/scala/kafka/consumer/ConsumerConfig.scala |   3 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |  30 +++--
 .../kafka/consumer/ConsumerFetcherThread.scala     |   3 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   6 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   6 +-
 .../controller/ControllerChannelManager.scala      |  47 ++++++-
 .../scala/kafka/controller/KafkaController.scala   |  40 ++++--
 .../kafka/controller/PartitionStateMachine.scala   |  12 +-
 .../kafka/controller/ReplicaStateMachine.scala     |  14 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   2 +-
 .../main/scala/kafka/network/SocketServer.scala    |   7 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |   9 +-
 .../kafka/producer/async/DefaultEventHandler.scala |   8 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 142 +++++++++++++++------
 .../scala/kafka/server/KafkaRequestHandler.scala   |  11 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   6 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  85 ++++--------
 .../api/RequestResponseSerializationTest.scala     |   4 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  34 +++--
 .../kafka/integration/AutoOffsetResetTest.scala    |  10 +-
 .../kafka/integration/LazyInitProducerTest.scala   |   9 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   7 +-
 .../unit/kafka/integration/TopicMetadataTest.scala | 125 +++++++++---------
 .../unit/kafka/producer/AsyncProducerTest.scala    |  11 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  88 +++++++------
 .../unit/kafka/server/LeaderElectionTest.scala     |   2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   7 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   9 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   7 +
 42 files changed, 664 insertions(+), 412 deletions(-)
988d4d8e65a14390abd748318a64e281e4a37c19

 core/src/main/scala/kafka/network/RequestChannel.scala | 7 +++++--
 core/src/main/scala/kafka/server/KafkaApis.scala       | 4 +---
 2 files changed, 6 insertions(+), 5 deletions(-)
cae19aa44f36775d8f95256e63e0cb50a0c0ba9f

 core/src/main/scala/kafka/network/RequestChannel.scala | 9 +++++++++
 1 file changed, 9 insertions(+)
d726e14eea2133cb8a1e52d20f6a17047f726e1c

 core/src/main/scala/kafka/client/ClientUtils.scala | 14 +++++++++-----
 1 file changed, 9 insertions(+), 5 deletions(-)
103aef8ca3c0eb1ff5574df656bfe5273ed9492b

 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
a61e7381382ada885debef15379675fea6974ec1

 core/src/main/scala/kafka/admin/AdminUtils.scala    |  2 +-
 core/src/main/scala/kafka/cluster/Partition.scala   | 21 ++++++++++++---------
 core/src/main/scala/kafka/cluster/Replica.scala     | 10 +++++-----
 .../kafka/consumer/ConsumerFetcherThread.scala      |  2 +-
 core/src/main/scala/kafka/log/LogManager.scala      |  2 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala  |  4 ++--
 .../scala/kafka/server/AbstractFetcherThread.scala  |  6 +++---
 .../kafka/server/HighwaterMarkCheckpoint.scala      |  5 ++---
 core/src/main/scala/kafka/server/KafkaApis.scala    |  9 +++++----
 .../scala/kafka/server/ReplicaFetcherThread.scala   |  2 +-
 .../scala/kafka/tools/VerifyConsumerRebalance.scala | 10 +++++-----
 core/src/main/scala/kafka/utils/ZkUtils.scala       |  8 ++++----
 .../consumer/ZookeeperConsumerConnectorTest.scala   |  4 ++--
 .../src/test/scala/unit/kafka/utils/TestUtils.scala | 12 ++++++------
 14 files changed, 50 insertions(+), 47 deletions(-)
e37a4644209de00f265a5361b31ca63cafc895e9

 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6e640e355632d97e322e462c2bbc379c05d407a4

 core/src/main/scala/kafka/consumer/ConsumerFetcherManager.scala | 4 ++++
 1 file changed, 4 insertions(+)
2d7403174f8fd6d35fce05585a7ee6edb8af7dd4

 config/consumer.properties                         |  6 +--
 config/producer.properties                         |  2 +-
 config/server.properties                           |  6 +--
 .../main/java/kafka/etl/impl/DataGenerator.java    |  2 +-
 contrib/hadoop-producer/README.md                  |  2 +-
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     |  4 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |  4 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  2 +-
 .../scala/kafka/consumer/ConsumerConnector.scala   |  4 +-
 .../scala/kafka/producer/ConsoleProducer.scala     |  2 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  4 +-
 .../main/scala/kafka/producer/ProducerConfig.scala |  2 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  4 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |  2 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  8 ++--
 .../scala/other/kafka/TestEndToEndLatency.scala    |  4 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  4 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |  2 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    | 18 ++++-----
 .../scala/unit/kafka/producer/ProducerTest.scala   | 12 +++---
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 12 +++---
 .../src/main/java/kafka/examples/Consumer.java     |  6 +--
 .../src/main/java/kafka/examples/Producer.java     |  2 +-
 .../scala/kafka/perf/ConsumerPerformance.scala     |  2 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |  2 +-
 .../config/migration_producer.properties           |  2 +-
 .../config/server.properties                       |  2 +
 .../testcase_9001/testcase_9001_properties.json    |  6 +--
 .../testcase_9003/testcase_9003_properties.json    |  6 +--
 .../testcase_9004/testcase_9004_properties.json    |  6 +--
 .../testcase_9005/testcase_9005_properties.json    |  6 +--
 .../testcase_9006/testcase_9006_properties.json    |  6 +--
 .../config/mirror_consumer.properties              |  6 +--
 .../config/mirror_producer.properties              |  2 +-
 .../config/server.properties                       |  4 +-
 .../replication_testsuite/config/server.properties |  4 +-
 system_test/utils/kafka_system_test_utils.py       | 43 +++++++++++++---------
 38 files changed, 111 insertions(+), 102 deletions(-)
ede85875a3aea5723baf82736cc71bb1a04a6102

 core/src/main/scala/kafka/network/SocketServer.scala | 20 ++++++++++++++++----
 core/src/main/scala/kafka/server/KafkaServer.scala   |  2 ++
 .../scala/unit/kafka/network/SocketServerTest.scala  |  2 ++
 3 files changed, 20 insertions(+), 4 deletions(-)
68c8434f61fc7ef1152db576b359ff88ec0a4de3

 .../src/main/java/kafka/bridge/hadoop/KafkaRecordWriter.java        | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)
1976ce8069818c2c6d093b5b75e8f7b6653120bc

 .../src/main/java/kafka/bridge/hadoop/KafkaRecordWriter.java         | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
f1d2141ca065d51b41aeac8c7e2124672298d5f0

 core/src/main/scala/kafka/log/Log.scala | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
731ba9007d4e2fa2f3a5e44f7b30827975fca420
c5bb1d49942fd94a1ead938567031f9faaeacfbd

 project/Build.scala | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)
b29b6296ac5b799a78d61920a3f4131051230a02

 core/src/main/scala/kafka/message/ByteBufferMessageSet.scala |  2 +-
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 11 ++++++++---
 2 files changed, 9 insertions(+), 4 deletions(-)
158baf661c142d1ebeb96a817f5a121ca71360ac

 bin/kafka-run-class.sh | 11 +++++++++++
 project/Build.scala    | 38 ++++++++++++++++++++++++++++++++++++--
 sbt                    |  2 +-
 3 files changed, 48 insertions(+), 3 deletions(-)
f9e36ca790060a12a51569169cc4a53c4ebc5d74

 core/src/main/scala/kafka/cluster/Partition.scala  | 26 ++++++++++++++++++++--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 13 ++++++-----
 .../main/scala/kafka/server/ReplicaManager.scala   |  4 ++--
 3 files changed, 34 insertions(+), 9 deletions(-)
6dbf9212ae4dc6ed7f91fc99135b8a3b35ab5edb

 bin/kafka-run-class.sh                             |  33 ++-----------
 core/build.sbt                                     |   6 ++-
 core/lib/metrics-annotation-3.0.0-c0c8be71.jar     | Bin 4766 -> 0 bytes
 core/lib/metrics-core-3.0.0-c0c8be71.jar           | Bin 81782 -> 0 bytes
 core/lib/zkclient-20120522.jar                     | Bin 99193 -> 0 bytes
 core/src/main/scala/kafka/cluster/Partition.scala  |   2 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 .../scala/kafka/controller/KafkaController.scala   |   4 +-
 core/src/main/scala/kafka/log/Log.scala            |   4 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   2 +-
 .../kafka/producer/async/ProducerSendThread.scala  |   2 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   6 +--
 .../main/scala/kafka/server/RequestPurgatory.scala |   4 +-
 .../scala/unit/kafka/metrics/KafkaTimerTest.scala  |  10 ++--
 project/Build.scala                                |  51 +--------------------
 project/build/KafkaProject.scala                   |  46 -------------------
 project/plugins.sbt                                |   2 +-
 18 files changed, 29 insertions(+), 147 deletions(-)
ae362b0864cab835088fc1cd2faf8f646a502af6

 core/src/main/scala/kafka/cluster/Partition.scala            |  5 +++--
 core/src/main/scala/kafka/consumer/ConsumerIterator.scala    |  2 +-
 .../scala/kafka/controller/PartitionLeaderSelector.scala     | 10 +++++-----
 core/src/main/scala/kafka/log/FileMessageSet.scala           |  2 +-
 core/src/main/scala/kafka/log/Log.scala                      |  2 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala              |  2 +-
 .../scala/kafka/producer/async/DefaultEventHandler.scala     |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala             | 12 +++++++-----
 core/src/main/scala/kafka/server/ReplicaManager.scala        |  6 +++---
 core/src/main/scala/kafka/utils/ZkUtils.scala                |  8 ++++----
 10 files changed, 27 insertions(+), 24 deletions(-)
ef123c20b82dab2f9bfa125bbb81521b0ff806ae

 .../main/scala/kafka/server/AbstractFetcherManager.scala  |  4 ++--
 core/src/main/scala/kafka/server/ReplicaManager.scala     | 15 +++++++--------
 2 files changed, 9 insertions(+), 10 deletions(-)
d4a70eb9b04bd4cec286cfb09eeeb3794ab4f4ee

 .../main/scala/kafka/admin/ListTopicCommand.scala  | 38 ++++++++++++++++------
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  2 +-
 2 files changed, 29 insertions(+), 11 deletions(-)
756be5363b83782b55922dfedd8ef9d3b405199c

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  2 +-
 .../main/scala/kafka/admin/ListTopicCommand.scala  |  3 +-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala | 37 +++++++++++++---------
 core/src/main/scala/kafka/api/TopicMetadata.scala  |  1 +
 core/src/main/scala/kafka/cluster/Partition.scala  |  4 +--
 .../controller/ControllerChannelManager.scala      |  4 +--
 .../scala/kafka/controller/KafkaController.scala   | 25 ++++++++-------
 core/src/main/scala/kafka/log/LogSegment.scala     |  2 +-
 .../kafka/server/AbstractFetcherManager.scala      |  2 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  4 +++
 .../main/scala/kafka/server/ReplicaManager.scala   |  7 ++--
 11 files changed, 51 insertions(+), 40 deletions(-)
1d3c343f57db55076c7e627bc362b4a64e22dcb2

 core/src/main/scala/kafka/cluster/Partition.scala | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
afecc9f23108b100b27017974b132331d6bab8e6

 .../mirror_maker_testsuite/cluster_config.json     | 10 +++++++++
 .../config/mirror_producer.properties              |  3 ++-
 .../mirror_maker_testsuite/mirror_maker_test.py    | 25 ++++++++++++++++------
 .../testcase_5001/testcase_5001_properties.json    | 22 +++++++++++++++++++
 .../testcase_5002/testcase_5002_properties.json    | 22 +++++++++++++++++++
 .../testcase_5003/testcase_5003_properties.json    | 13 +++++++++++
 .../testcase_5004/testcase_5004_properties.json    | 13 +++++++++++
 .../testcase_5005/testcase_5005_properties.json    | 14 ++++++++++++
 .../testcase_5006/testcase_5006_properties.json    | 14 ++++++++++++
 9 files changed, 128 insertions(+), 8 deletions(-)
3ead78b966a8464efa6d53fbb81fcb0efc75ba63

 .../main/scala/kafka/controller/PartitionStateMachine.scala | 13 +++++++------
 .../main/scala/kafka/controller/ReplicaStateMachine.scala   | 13 +++++++------
 2 files changed, 14 insertions(+), 12 deletions(-)
5a50f7e555510b8cde08cd588cf4b67b06484b16

 .../scala/kafka/consumer/PartitionTopicInfo.scala  | 17 +++----------
 .../scala/kafka/server/AbstractFetcherThread.scala | 28 +++++++++++++---------
 2 files changed, 20 insertions(+), 25 deletions(-)
bd262ac708062e502406e8d775f4c9432a5364e7

 core/src/main/scala/kafka/tools/KafkaMigrationTool.java | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
3c27988ca4036985f4c7bef62b9bbae3f95f0fb9

 core/src/main/scala/kafka/admin/ListTopicCommand.scala |  4 ++--
 core/src/main/scala/kafka/api/TopicMetadata.scala      | 11 +++++++++++
 2 files changed, 13 insertions(+), 2 deletions(-)
a9ce73cfd36bdb197e722ce8b828f27153f9e4ed

 core/src/main/scala/kafka/controller/KafkaController.scala   |  4 ++--
 .../main/scala/kafka/controller/PartitionStateMachine.scala  | 12 ++++++++----
 .../main/scala/kafka/controller/ReplicaStateMachine.scala    | 12 ++++++++----
 3 files changed, 18 insertions(+), 10 deletions(-)
06911384f2f32fe17a3057c9830e3f7dc30d66e6

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
68528dafa1fcfb7a469654575288e19f5b4bda04

 core/src/main/scala/kafka/producer/ConsoleProducer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9f6af315ca101272748de54fd1347c9def7d80af

 core/src/main/scala/kafka/cluster/Partition.scala  |  2 +-
 .../kafka/controller/ReplicaStateMachine.scala     | 23 ++++++++++------------
 2 files changed, 11 insertions(+), 14 deletions(-)
6e05d7da865898c1c44f552c735484dfe2603b60

 .../kafka/consumer/ConsumerFetcherManager.scala    | 39 ++++++++++------------
 .../consumer/ZookeeperConsumerConnector.scala      |  4 +--
 .../scala/kafka/server/AbstractFetcherThread.scala | 15 ++-------
 .../scala/unit/kafka/integration/FetcherTest.scala |  4 +--
 4 files changed, 25 insertions(+), 37 deletions(-)
1d5e95f6c4067884a374deddd88ec3f471664658

 core/src/main/scala/kafka/controller/KafkaController.scala | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
66b103895720700c5ea47e8f75a1105aca6e9342

 config/producer.properties                         |  2 +-
 .../scala/kafka/javaapi/producer/Producer.scala    |  4 +-
 .../main/scala/kafka/tools/KafkaMigrationTool.java | 25 ++++---
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 79 ++++++++++++++--------
 4 files changed, 64 insertions(+), 46 deletions(-)
be3ce14721a97df8331331b024ac602dcf66abe3

 .../common/LeaderElectionNotNeededException.scala  | 27 ++++++++++++++++++++++
 1 file changed, 27 insertions(+)
2fe3f9fef6e641ed64aca654b607c4d398e11d25

 .../PreferredReplicaLeaderElectionCommand.scala    |  7 +++--
 .../scala/kafka/controller/KafkaController.scala   | 31 +++++++++++-----------
 .../kafka/controller/PartitionLeaderSelector.scala |  8 +++---
 .../kafka/controller/PartitionStateMachine.scala   |  3 ++-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 17 +-----------
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  2 +-
 6 files changed, 27 insertions(+), 41 deletions(-)
f570cce1f4bec4ce50b4b1878a804b725f316b91

 .../replication_testsuite/replica_basic_test.py    |  2 +
 system_test/utils/kafka_system_test_utils.py       | 74 ++++++++++++++++++++++
 2 files changed, 76 insertions(+)
c5e354d3ab8ee4f9d18da6c084d4abfb00911b7c

 core/src/main/scala/kafka/controller/ReplicaStateMachine.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
26c50fac47802e4aa03793c60cb8316995bb37f1

 .../mirror_maker_testsuite/mirror_maker_test.py    |   7 +-
 .../replication_testsuite/replica_basic_test.py    |  15 +-
 system_test/utils/kafka_system_test_utils.py       | 304 +++++++++------------
 system_test/utils/replication_utils.py             |   3 +
 system_test/utils/system_test_utils.py             |  78 +++++-
 5 files changed, 222 insertions(+), 185 deletions(-)
e367f3ffb3340a0f0c0f46b0787d12476d751815

 core/src/main/scala/kafka/controller/KafkaController.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
df221297c715f2a9dbe389f727a840ea1ab27e47

 .../kafka/common/NoReplicaOnlineException.scala    | 28 ++++++++++++++++++++++
 1 file changed, 28 insertions(+)
28ee7855360b8e6ea690fc802dac4eaa60ad81e2

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  7 ++--
 .../kafka/common/PartitionOfflineException.scala   | 28 -------------
 .../controller/ControllerChannelManager.scala      |  6 ++-
 .../scala/kafka/controller/KafkaController.scala   | 47 ++++++++++++++--------
 .../kafka/controller/PartitionLeaderSelector.scala | 44 ++++++++++++--------
 .../kafka/controller/PartitionStateMachine.scala   | 28 ++++++-------
 .../kafka/controller/ReplicaStateMachine.scala     |  6 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  6 +--
 .../api/RequestResponseSerializationTest.scala     |  2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  3 +-
 11 files changed, 87 insertions(+), 92 deletions(-)
51421fcc0111031bb77f779a6f6c00520d526a34

 core/src/main/scala/kafka/server/KafkaApis.scala | 28 +++++++++++++++++++++++-
 1 file changed, 27 insertions(+), 1 deletion(-)
08b2a37c33ed907614e9621f315bb737f9be490e

 core/src/main/scala/kafka/admin/AdminUtils.scala   | 36 ++++++++++++++--------
 .../scala/kafka/producer/BrokerPartitionInfo.scala | 10 +++---
 .../main/scala/kafka/producer/ProducerPool.scala   |  4 +--
 3 files changed, 31 insertions(+), 19 deletions(-)
7b14ebae3382427b44a928d0b186001735c15efb

 core/src/main/scala/kafka/tools/KafkaMigrationTool.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
a737986e54ea53a2b93f3d08f5eb7fd155095f3c

 .../main/scala/kafka/consumer/ConsoleConsumer.scala   |  5 +++++
 .../main/scala/kafka/tools/SimpleConsumerShell.scala  | 19 +++++++++++++++----
 2 files changed, 20 insertions(+), 4 deletions(-)
a376f922149330995f91d427d76ff1595fbd26ce

 .../main/scala/kafka/tools/DumpLogSegments.scala   | 98 ++++++++++++++++------
 1 file changed, 71 insertions(+), 27 deletions(-)
46ebdc16e99c4bb9236a6c25c47ff2c97fdc0f53

 core/src/main/scala/kafka/log/Log.scala          | 30 ++++++++++++------------
 core/src/test/scala/unit/kafka/log/LogTest.scala |  8 +++----
 2 files changed, 19 insertions(+), 19 deletions(-)
d40d255bc86a8b82dddd79c71f4a0309af6731e0

 core/src/main/scala/kafka/tools/KafkaMigrationTool.java | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
7fd9268f7b89afa2e41b526f1f4d7bfc90a519cf

 core/src/main/scala/kafka/tools/KafkaMigrationTool.java | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
3b3fb7fed622cc0339c3b9e3fb175e6093e427a3

 core/src/main/scala/kafka/consumer/ConsumerFetcherThread.scala | 7 +------
 core/src/main/scala/kafka/consumer/SimpleConsumer.scala        | 1 +
 2 files changed, 2 insertions(+), 6 deletions(-)
0a9283530418781941b7c232a8b09e4ec071b0e9

 .../main/scala/kafka/consumer/SimpleConsumer.scala | 18 ++++--------------
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 22 +++++++++++-----------
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  5 ++---
 3 files changed, 17 insertions(+), 28 deletions(-)
c5462864aab05b98158bcbe623123db083b8e136

 core/src/main/scala/kafka/log/Log.scala            | 15 +++++++++------
 core/src/main/scala/kafka/server/KafkaConfig.scala |  2 +-
 2 files changed, 10 insertions(+), 7 deletions(-)
dd9676163956b3e577808a1e9744aa9fb5e83e4e

 core/src/main/scala/kafka/log/Log.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
290d5e0eac38e9917c64353a131154821b899f26

 .../main/scala/kafka/consumer/ConsumerConfig.scala |  3 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala | 79 ++++++++--------------
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 43 ++++++++----
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 19 +++++-
 4 files changed, 78 insertions(+), 66 deletions(-)
485afe646af282c59927b177ddc70742349cdad8

 core/src/main/scala/kafka/cluster/Partition.scala    | 20 ++++++++++++--------
 .../src/main/scala/kafka/server/ReplicaManager.scala |  6 +++++-
 2 files changed, 17 insertions(+), 9 deletions(-)
9ff4e8eb10e0ddd86f257e99d55971a132426605

 .../java/kafka/etl/impl/SimpleKafkaETLMapper.java  |   2 +
 .../scala/kafka/consumer/ConsumerIterator.scala    |   2 +-
 core/src/main/scala/kafka/log/CleanerConfig.scala  |   4 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala |   3 +-
 core/src/main/scala/kafka/log/LogCleaner.scala     | 104 +++++++----
 core/src/main/scala/kafka/log/LogConfig.scala      |   6 +
 core/src/main/scala/kafka/log/LogSegment.scala     |   9 +-
 core/src/main/scala/kafka/log/OffsetMap.scala      | 103 +++++++----
 core/src/main/scala/kafka/message/Message.scala    |  16 +-
 .../kafka/producer/async/DefaultEventHandler.scala |   5 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  14 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   5 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |   2 +-
 .../main/scala/kafka/utils/IteratorTemplate.scala  |  17 +-
 .../scala/kafka/utils/VerifiableProperties.scala   |   6 +-
 .../test/scala/other/kafka/TestLogCleaning.scala   | 198 +++++++++++++++------
 .../test/scala/unit/kafka/log/CleanerTest.scala    |  66 ++++---
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  13 ++
 .../test/scala/unit/kafka/log/OffsetMapTest.scala  |  43 ++---
 .../scala/unit/kafka/message/MessageTest.scala     |   9 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  25 ++-
 .../unit/kafka/utils/IteratorTemplateTest.scala    |  41 +++++
 23 files changed, 504 insertions(+), 191 deletions(-)
da1dc17887e536824df35958c6abdc14828fb4cb

 core/src/main/scala/kafka/metrics/KafkaMetricsGroup.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c1ed12e44ddebe41dc464683e3d7eeb4e6d39a45

 bin/kafka-create-topic.sh                          |  19 ---
 bin/kafka-delete-topic.sh                          |  19 ---
 bin/kafka-list-topic.sh                            |  19 ---
 bin/kafka-topics.sh                                |  19 +++
 .../kafka/admin/AdminOperationException.scala      |  23 +++
 core/src/main/scala/kafka/admin/AdminUtils.scala   | 137 ++++++++++++---
 .../scala/kafka/admin/CreateTopicCommand.scala     | 117 -------------
 .../PreferredReplicaLeaderElectionCommand.scala    |   6 +-
 core/src/main/scala/kafka/admin/TopicCommand.scala | 185 +++++++++++++++++++++
 core/src/main/scala/kafka/cluster/Partition.scala  |   5 +-
 .../scala/kafka/common/KafkaZookeperClient.scala   |  35 ----
 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogConfig.scala      |  97 ++++++++++-
 core/src/main/scala/kafka/log/LogManager.scala     |  31 ++--
 .../main/scala/kafka/network/SocketServer.scala    |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  43 ++---
 .../main/scala/kafka/server/KafkaHealthcheck.scala |  86 ++++++++++
 .../scala/kafka/server/KafkaRequestHandler.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  77 ++++-----
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  90 ----------
 .../main/scala/kafka/server/ReplicaManager.scala   |   2 +-
 .../scala/kafka/server/TopicConfigManager.scala    | 133 +++++++++++++++
 .../main/scala/kafka/utils/CommandLineUtils.scala  |   2 +-
 core/src/main/scala/kafka/utils/Json.scala         |  31 ++++
 core/src/main/scala/kafka/utils/Utils.scala        |  19 +++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  25 +--
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 158 +++++++++---------
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |   5 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   4 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |   3 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |   4 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  27 +--
 .../unit/kafka/integration/TopicMetadataTest.scala |   8 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  12 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  23 +--
 .../unit/kafka/producer/SyncProducerTest.scala     |   8 +-
 .../server/HighwatermarkPersistenceTest.scala      |   6 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   6 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |  16 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  23 +--
 .../scala/unit/kafka/server/OffsetCommitTest.scala |   1 -
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  10 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   4 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   4 +-
 .../src/test/scala/unit/kafka/utils/JsonTest.scala |  27 +++
 .../scala/unit/kafka/utils/SchedulerTest.scala     |   8 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  13 +-
 47 files changed, 1003 insertions(+), 593 deletions(-)
b5edbb193b33ebf0b3056935a537967ff21478a6

 .../testcase_9001/testcase_9001_properties.json             |  6 +++---
 .../testcase_9003/testcase_9003_properties.json             |  6 +++---
 .../testcase_9004/testcase_9004_properties.json             |  6 +++---
 .../testcase_9005/testcase_9005_properties.json             |  6 +++---
 .../testcase_9006/testcase_9006_properties.json             |  6 +++---
 .../testcase_5001/testcase_5001_properties.json             | 12 ++++++------
 .../testcase_5002/testcase_5002_properties.json             | 12 ++++++------
 .../testcase_5003/testcase_5003_properties.json             | 12 ++++++------
 .../testcase_5004/testcase_5004_properties.json             | 12 ++++++------
 .../testcase_5005/testcase_5005_properties.json             | 12 ++++++------
 .../testcase_5006/testcase_5006_properties.json             | 12 ++++++------
 .../testcase_0001/testcase_0001_properties.json             | 12 +++++++++---
 .../testcase_0002/testcase_0002_properties.json             | 12 +++++++++---
 .../testcase_0003/testcase_0003_properties.json             | 12 +++++++++---
 .../testcase_0004/testcase_0004_properties.json             | 12 +++++++++---
 .../testcase_0005/testcase_0005_properties.json             | 12 +++++++++---
 .../testcase_0006/testcase_0006_properties.json             | 12 +++++++++---
 .../testcase_0007/testcase_0007_properties.json             | 12 +++++++++---
 .../testcase_0008/testcase_0008_properties.json             | 12 +++++++++---
 .../testcase_0009/testcase_0009_properties.json             | 12 +++++++++---
 .../testcase_0010/testcase_0010_properties.json             | 12 +++++++++---
 .../testcase_0021/testcase_0021_properties.json             | 12 +++++++++---
 .../testcase_0022/testcase_0022_properties.json             | 12 +++++++++---
 .../testcase_0023/testcase_0023_properties.json             | 12 +++++++++---
 .../testcase_0101/testcase_0101_properties.json             | 12 +++++++++---
 .../testcase_0102/testcase_0102_properties.json             | 12 +++++++++---
 .../testcase_0103/testcase_0103_properties.json             | 12 +++++++++---
 .../testcase_0104/testcase_0104_properties.json             | 12 +++++++++---
 .../testcase_0105/testcase_0105_properties.json             | 12 +++++++++---
 .../testcase_0106/testcase_0106_properties.json             | 12 +++++++++---
 .../testcase_0107/testcase_0107_properties.json             | 12 +++++++++---
 .../testcase_0108/testcase_0108_properties.json             | 12 +++++++++---
 .../testcase_0109/testcase_0109_properties.json             | 12 +++++++++---
 .../testcase_0110/testcase_0110_properties.json             | 12 +++++++++---
 .../testcase_0111/testcase_0111_properties.json             | 13 ++++++++++---
 .../testcase_0112/testcase_0112_properties.json             | 13 ++++++++++---
 .../testcase_0113/testcase_0113_properties.json             | 13 ++++++++++---
 .../testcase_0114/testcase_0114_properties.json             | 13 ++++++++++---
 .../testcase_0115/testcase_0115_properties.json             | 13 ++++++++++---
 .../testcase_0116/testcase_0116_properties.json             | 13 ++++++++++---
 .../testcase_0117/testcase_0117_properties.json             | 13 ++++++++++---
 .../testcase_0118/testcase_0118_properties.json             | 13 ++++++++++---
 .../testcase_0121/testcase_0121_properties.json             | 13 ++++++++++---
 .../testcase_0122/testcase_0122_properties.json             | 13 ++++++++++---
 .../testcase_0123/testcase_0123_properties.json             | 13 ++++++++++---
 .../testcase_0124/testcase_0124_properties.json             | 13 ++++++++++---
 .../testcase_0125/testcase_0125_properties.json             | 13 ++++++++++---
 .../testcase_0126/testcase_0126_properties.json             | 13 ++++++++++---
 .../testcase_0127/testcase_0127_properties.json             | 13 ++++++++++---
 .../testcase_0131/testcase_0131_properties.json             | 13 ++++++++++---
 .../testcase_0132/testcase_0132_properties.json             | 13 ++++++++++---
 .../testcase_0133/testcase_0133_properties.json             | 13 ++++++++++---
 .../testcase_0151/testcase_0151_properties.json             | 13 ++++++++++---
 .../testcase_0152/testcase_0152_properties.json             | 13 ++++++++++---
 .../testcase_0153/testcase_0153_properties.json             | 13 ++++++++++---
 .../testcase_0154/testcase_0154_properties.json             | 13 ++++++++++---
 .../testcase_0155/testcase_0155_properties.json             | 13 ++++++++++---
 .../testcase_0156/testcase_0156_properties.json             | 13 ++++++++++---
 .../testcase_0157/testcase_0157_properties.json             | 13 ++++++++++---
 .../testcase_0158/testcase_0158_properties.json             | 13 ++++++++++---
 .../testcase_0201/testcase_0201_properties.json             | 12 +++++++++---
 .../testcase_0202/testcase_0202_properties.json             | 12 +++++++++---
 .../testcase_0203/testcase_0203_properties.json             | 12 +++++++++---
 .../testcase_0204/testcase_0204_properties.json             | 12 +++++++++---
 .../testcase_0205/testcase_0205_properties.json             | 12 +++++++++---
 .../testcase_0206/testcase_0206_properties.json             | 12 +++++++++---
 .../testcase_0207/testcase_0207_properties.json             | 12 +++++++++---
 .../testcase_0208/testcase_0208_properties.json             | 12 +++++++++---
 .../testcase_0251/testcase_0251_properties.json             | 12 +++++++++---
 .../testcase_0252/testcase_0252_properties.json             | 12 +++++++++---
 .../testcase_0253/testcase_0253_properties.json             | 12 +++++++++---
 .../testcase_0254/testcase_0254_properties.json             | 12 +++++++++---
 .../testcase_0255/testcase_0255_properties.json             | 12 +++++++++---
 .../testcase_0256/testcase_0256_properties.json             | 12 +++++++++---
 .../testcase_0257/testcase_0257_properties.json             | 12 +++++++++---
 .../testcase_0258/testcase_0258_properties.json             | 12 +++++++++---
 .../testcase_0301/testcase_0301_properties.json             | 12 +++++++++---
 .../testcase_0302/testcase_0302_properties.json             | 12 +++++++++---
 .../testcase_0303/testcase_0303_properties.json             | 12 +++++++++---
 .../testcase_0304/testcase_0304_properties.json             | 12 +++++++++---
 .../testcase_0305/testcase_0305_properties.json             | 12 +++++++++---
 .../testcase_0306/testcase_0306_properties.json             | 12 +++++++++---
 .../testcase_0307/testcase_0307_properties.json             | 12 +++++++++---
 .../testcase_0308/testcase_0308_properties.json             | 12 +++++++++---
 .../testcase_1/testcase_1_properties.json                   |  6 +++---
 .../testcase_4001/testcase_4001_properties.json             | 12 +++++++++---
 .../testcase_4002/testcase_4002_properties.json             | 12 +++++++++---
 .../testcase_4003/testcase_4003_properties.json             | 12 +++++++++---
 .../testcase_4004/testcase_4004_properties.json             | 12 +++++++++---
 .../testcase_4005/testcase_4005_properties.json             | 12 +++++++++---
 .../testcase_4006/testcase_4006_properties.json             | 12 +++++++++---
 .../testcase_4007/testcase_4007_properties.json             | 12 +++++++++---
 .../testcase_4008/testcase_4008_properties.json             | 12 +++++++++---
 .../testcase_4011/testcase_4011_properties.json             | 12 +++++++++---
 .../testcase_4012/testcase_4012_properties.json             | 12 +++++++++---
 .../testcase_4013/testcase_4013_properties.json             | 12 +++++++++---
 .../testcase_4014/testcase_4014_properties.json             | 12 +++++++++---
 .../testcase_4015/testcase_4015_properties.json             | 12 +++++++++---
 .../testcase_4016/testcase_4016_properties.json             | 12 +++++++++---
 .../testcase_4017/testcase_4017_properties.json             | 12 +++++++++---
 .../testcase_4018/testcase_4018_properties.json             | 12 +++++++++---
 .../testcase_9051/testcase_9051_properties.json             |  6 +++---
 102 files changed, 884 insertions(+), 324 deletions(-)
5a275b077af41803e22e5ac53a1fe474c53116ff

 core/src/main/scala/kafka/server/ReplicaManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
19ae1959b091df44475243e3b199d6121ddedc72

 .../admin/PreferredReplicaLeaderElectionCommand.scala  |  8 ++++----
 core/src/main/scala/kafka/api/StopReplicaRequest.scala | 16 +++++++++++-----
 core/src/main/scala/kafka/cluster/Partition.scala      |  2 +-
 .../kafka/controller/ControllerChannelManager.scala    | 18 +++++++-----------
 .../main/scala/kafka/controller/KafkaController.scala  |  1 +
 .../scala/kafka/controller/PartitionStateMachine.scala |  2 +-
 .../scala/kafka/controller/ReplicaStateMachine.scala   |  2 +-
 core/src/main/scala/kafka/server/ReplicaManager.scala  |  2 +-
 .../kafka/api/RequestResponseSerializationTest.scala   |  3 ++-
 9 files changed, 29 insertions(+), 25 deletions(-)
771760ce23f00ba86b916420d8e209b2611b23c0

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala            | 6 ------
 core/src/main/scala/kafka/consumer/ConsumerIterator.scala          | 7 +------
 core/src/main/scala/kafka/consumer/KafkaStream.scala               | 3 +--
 .../src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 3 +--
 core/src/test/scala/unit/kafka/consumer/ConsumerIteratorTest.scala | 1 -
 5 files changed, 3 insertions(+), 17 deletions(-)
eae1bd52ef1d991834151898e768e57de8bb07bf

 .../PreferredReplicaLeaderElectionCommand.scala    | 32 ++++++----
 .../kafka/admin/ReassignPartitionsCommand.scala    | 23 +++----
 .../src/main/scala/kafka/api/ProducerRequest.scala |  1 -
 .../consumer/ZookeeperConsumerConnector.scala      |  4 +-
 .../main/scala/kafka/tools/KafkaMigrationTool.java |  4 +-
 core/src/main/scala/kafka/utils/Utils.scala        | 71 ++++++++--------------
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 51 ++++++++++------
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  3 +-
 8 files changed, 94 insertions(+), 95 deletions(-)
2457bc49ef39c70622816250025eefc3bfcc7640

 bin/kafka-run-class.sh                             |   2 +-
 config/log4j.properties                            |  13 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   4 +-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  21 ++-
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |   4 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   4 +-
 core/src/main/scala/kafka/api/OffsetResponse.scala |   4 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   4 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |   5 +-
 .../main/scala/kafka/api/RequestOrResponse.scala   |   2 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |   4 +-
 .../main/scala/kafka/api/StopReplicaResponse.scala |   5 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   4 +-
 .../scala/kafka/api/TopicMetadataResponse.scala    |   3 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  37 ++--
 core/src/main/scala/kafka/common/Topic.scala       |   2 +-
 .../controller/ControllerChannelManager.scala      |  34 ++--
 .../scala/kafka/controller/KafkaController.scala   |   4 +-
 .../kafka/controller/PartitionStateMachine.scala   |  81 +++++----
 .../kafka/controller/ReplicaStateMachine.scala     |  33 ++--
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |   7 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  71 +++++---
 .../scala/kafka/tools/StateChangeLogMerger.scala   | 188 +++++++++++++++++++++
 .../api/RequestResponseSerializationTest.scala     |   2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  12 +-
 25 files changed, 414 insertions(+), 136 deletions(-)
2e64c6a5f221c616b2ac222fdadb96618f65e1ec

 core/src/main/scala/kafka/tools/DumpLogSegments.scala          | 10 ----------
 core/src/main/scala/kafka/tools/JmxTool.scala                  |  4 ++--
 core/src/main/scala/kafka/tools/SimpleConsumerShell.scala      |  8 ++------
 perf/src/main/scala/kafka/perf/SimpleConsumerPerformance.scala |  2 +-
 4 files changed, 5 insertions(+), 19 deletions(-)
a971a27b59dacb4fbc882a8fead5406c5b4144c6

 .../kafka/admin/PreferredReplicaLeaderElectionCommand.scala | 13 ++-----------
 .../main/scala/kafka/admin/ReassignPartitionsCommand.scala  |  8 --------
 2 files changed, 2 insertions(+), 19 deletions(-)
0ee46e05ddcbf1d6bc2aa0039800aaeac860ad56

 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
4f2742d60d16f5ba468aa66d2c3ed7aa37479dce
82b11aa0d4bc32c5a351ace3a67cd2d57c9d1e8d

 core/src/main/scala/kafka/api/OffsetCommitResponse.scala | 6 +-----
 core/src/main/scala/kafka/api/OffsetFetchResponse.scala  | 6 +-----
 core/src/main/scala/kafka/server/KafkaApis.scala         | 2 --
 3 files changed, 2 insertions(+), 12 deletions(-)
92ecebecd0551eb61e4ee31dfd020fe51f4090e2
db65c9573533b5d6f8a3a5cbfdd287ebdcde72e4

 .../main/scala/kafka/admin/ShutdownBroker.scala    | 36 ++++++++++++----------
 core/src/main/scala/kafka/cluster/Broker.scala     |  4 +--
 .../scala/kafka/controller/KafkaController.scala   |  2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 32 +++++++++++--------
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 10 ++++--
 .../kafka/tools/VerifyConsumerRebalance.scala      |  5 ++-
 6 files changed, 54 insertions(+), 35 deletions(-)
cea27356feedb66f91b734c9c63de1ea44ac0d47

 .../main/scala/kafka/admin/ShutdownBroker.scala    | 36 ++++++++++++----------
 core/src/main/scala/kafka/cluster/Broker.scala     |  4 +--
 .../scala/kafka/controller/KafkaController.scala   |  2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 32 +++++++++++--------
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 10 ++++--
 .../kafka/tools/VerifyConsumerRebalance.scala      |  5 ++-
 6 files changed, 54 insertions(+), 35 deletions(-)
89622c8e88ddddeddb8c3449ef1782c1d399c2b0

 core/src/main/scala/kafka/api/ProducerRequest.scala    | 13 +++++++++----
 core/src/main/scala/kafka/network/RequestChannel.scala |  6 +++---
 .../kafka/producer/async/DefaultEventHandler.scala     |  8 ++++----
 core/src/main/scala/kafka/server/KafkaApis.scala       | 18 ++++++++++--------
 .../kafka/api/RequestResponseSerializationTest.scala   |  2 +-
 .../scala/unit/kafka/network/SocketServerTest.scala    | 10 ++++++----
 .../scala/unit/kafka/producer/SyncProducerTest.scala   |  5 +++--
 7 files changed, 36 insertions(+), 26 deletions(-)
4f752cab189878053c4eb2dd78515bbf94026f3e

 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
6989dac889f2afd3cd192d345d3bd29995e605b9

 core/src/main/scala/kafka/admin/AdminUtils.scala   | 57 ++++++++++------------
 .../kafka/common/LeaderNotAvailableException.scala |  7 +--
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  5 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  1 -
 4 files changed, 33 insertions(+), 37 deletions(-)
37ca9db782b43180385704201633ca38e932b4cf

 core/src/test/scala/unit/kafka/integration/PrimitiveApiTest.scala | 7 +++++++
 1 file changed, 7 insertions(+)
76a4fbfb13a3541960c8c9312defdb69fa4c3f32

 .../main/scala/kafka/message/ByteBufferMessageSet.scala  | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)
db1cb5bbd9dbd46da67cb3bf859829ffa1d69ad8

 core/src/main/scala/kafka/log/Log.scala                      |  6 +++++-
 core/src/main/scala/kafka/message/ByteBufferMessageSet.scala | 10 ++++++----
 2 files changed, 11 insertions(+), 5 deletions(-)
218e6a53c1385be897d9f8a3a39baa38b68d7992

 core/src/main/scala/kafka/server/KafkaApis.scala             |  2 +-
 core/src/test/scala/unit/kafka/server/OffsetCommitTest.scala | 10 ++++++++++
 2 files changed, 11 insertions(+), 1 deletion(-)
d925b157f42b13cb410a86e8850c23a11de3d2f1

 .../consumer/ZookeeperConsumerConnector.scala      |   1 +
 core/src/main/scala/kafka/producer/Producer.scala  |   3 +-
 .../main/scala/kafka/tools/KafkaMigrationTool.java | 364 ++++++++++++++-------
 core/src/main/scala/kafka/utils/Utils.scala        |   2 +-
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |   5 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |   2 +-
 6 files changed, 244 insertions(+), 133 deletions(-)
ccfdabc045175491ebe95ee50d18646caeafd916
9115977b38ad207028c7c194524a408b9e5789f0

 core/src/main/scala/kafka/cluster/Partition.scala             |  2 +-
 core/src/main/scala/kafka/consumer/ConsumerTopicStats.scala   |  8 ++++----
 .../scala/kafka/consumer/FetchRequestAndResponseStats.scala   |  8 ++++----
 core/src/main/scala/kafka/log/Log.scala                       |  2 +-
 core/src/main/scala/kafka/producer/Producer.scala             |  6 +++---
 core/src/main/scala/kafka/producer/ProducerRequestStats.scala |  8 ++++----
 core/src/main/scala/kafka/producer/ProducerStats.scala        |  1 -
 core/src/main/scala/kafka/producer/ProducerTopicStats.scala   | 11 ++++++-----
 .../main/scala/kafka/producer/async/DefaultEventHandler.scala |  2 +-
 .../main/scala/kafka/producer/async/ProducerSendThread.scala  |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala              |  8 ++++----
 core/src/main/scala/kafka/server/KafkaRequestHandler.scala    |  4 ++--
 core/src/main/scala/kafka/server/KafkaServer.scala            |  2 +-
 core/src/main/scala/kafka/server/ReplicaManager.scala         |  6 ++++++
 14 files changed, 38 insertions(+), 32 deletions(-)
4d8fb1eebc043fab11c58d3309e93cc83ef24a89

 config/log4j.properties                            |  1 +
 .../main/scala/kafka/api/ProducerResponse.scala    |  2 -
 .../main/scala/kafka/network/RequestChannel.scala  |  2 +-
 .../main/scala/kafka/network/SocketServer.scala    | 30 +++++++---
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  2 +-
 .../scala/kafka/producer/ConsoleProducer.scala     | 10 +++-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  | 13 ++--
 core/src/main/scala/kafka/producer/Producer.scala  |  2 +-
 .../main/scala/kafka/producer/SyncProducer.scala   | 17 ++++--
 .../kafka/producer/async/DefaultEventHandler.scala | 30 +++++-----
 core/src/main/scala/kafka/server/KafkaApis.scala   |  9 ++-
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 48 +++++++++++----
 .../integration/ProducerConsumerTestHarness.scala  | 14 +----
 .../scala/unit/kafka/log/OffsetIndexTest.scala     |  2 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  7 ++-
 .../unit/kafka/network/SocketServerTest.scala      | 36 ++++++++++-
 .../unit/kafka/producer/AsyncProducerTest.scala    | 13 ++--
 .../scala/unit/kafka/producer/ProducerTest.scala   |  3 +-
 .../unit/kafka/producer/SyncProducerTest.scala     | 69 +++++++++++-----------
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |  2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 25 +++++---
 22 files changed, 215 insertions(+), 124 deletions(-)
828ce83dcb442d1cc6c0dbc538d12bbb04a0884d

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  16 +--
 .../scala/kafka/admin/CreateTopicCommand.scala     |  10 +-
 .../PreferredReplicaLeaderElectionCommand.scala    |   6 +-
 .../kafka/admin/ReassignPartitionsCommand.scala    |   3 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   2 +-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |   2 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |   2 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   2 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |  18 ++-
 .../src/main/scala/kafka/consumer/TopicCount.scala | 127 ++++++++---------
 .../consumer/ZookeeperConsumerConnector.scala      |   8 +-
 .../scala/kafka/controller/KafkaController.scala   |   3 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  66 ++++++---
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 151 ++++++++++-----------
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  77 +++++------
 15 files changed, 248 insertions(+), 245 deletions(-)
144a0a2ac02ecf6297f4dee4ae773be59095b1e7

 core/src/main/scala/kafka/server/ReplicaManager.scala | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)
0be45b334b821b079d6d0336515248bf11b4cf8d

 core/src/main/scala/kafka/log/Log.scala | 19 ++++++++++++-------
 1 file changed, 12 insertions(+), 7 deletions(-)
b056a9a1eca8fb27812c7e4bc5872a9d96aae866

 core/src/main/scala/kafka/server/KafkaConfig.scala          | 3 +--
 core/src/main/scala/kafka/server/KafkaServerStartable.scala | 1 -
 2 files changed, 1 insertion(+), 3 deletions(-)
049ac882bfa3d9f01100f84ab4cf9b0a41ae88a8

 core/src/main/scala/kafka/server/KafkaServerStartable.scala | 1 +
 1 file changed, 1 insertion(+)
859959f974225dd066ae94fc8254809203ffd980

 core/src/main/scala/kafka/admin/AdminUtils.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
30f992c52dd3aba8cc35c9835df5b5e56581e0d8

 core/src/main/scala/kafka/server/ReplicaManager.scala | 2 ++
 1 file changed, 2 insertions(+)
4d7629dd7f416f94bd148b815518eaa60531e299

 .../scala/kafka/producer/KafkaLog4jAppender.scala  | 39 ++++++++++++++++++----
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  1 +
 2 files changed, 33 insertions(+), 7 deletions(-)
b84168a3e3b68bb7d6d2904d4f7c591e43fc5435

 bin/windows/kafka-run-class.bat | 33 ++++++++++++++++++++++++---------
 1 file changed, 24 insertions(+), 9 deletions(-)
8103b4f6355a8267aa5638cfd382412221bdddfa

 config/log4j.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e81b0a3ded9ff31f5089f2a3f294fbe0aef9614b

 core/src/main/scala/kafka/log/Log.scala         | 11 ++++++++++-
 core/src/main/scala/kafka/log/OffsetIndex.scala | 18 ++++++++++++------
 2 files changed, 22 insertions(+), 7 deletions(-)
48745f04d12988121cb770cbd33ed3ed6fe98cff

 core/src/main/scala/kafka/api/FetchResponse.scala  |  4 ++--
 core/src/main/scala/kafka/log/FileMessageSet.scala | 16 +++++++++++++---
 .../main/scala/kafka/network/SocketServer.scala    |  2 +-
 .../main/scala/kafka/network/Transmission.scala    | 22 +++++++++++++++++-----
 4 files changed, 33 insertions(+), 11 deletions(-)
879d2692ea1192a4989297acbcbc01092ccbfb54
2f0df95f796db9049ed2dfc8e1253957e9e0cfd8

 core/src/main/scala/kafka/admin/CheckReassignmentStatus.scala           | 2 +-
 .../main/scala/kafka/admin/PreferredReplicaLeaderElectionCommand.scala  | 2 +-
 core/src/main/scala/kafka/admin/ReassignPartitionsCommand.scala         | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
790a1504c3437b84ce2d910b9769a2b4ae481ed3

 core/src/main/scala/kafka/log/Log.scala              |  8 ++++++--
 core/src/main/scala/kafka/log/OffsetIndex.scala      | 20 +++++++++++++-------
 .../test/scala/unit/kafka/log/OffsetIndexTest.scala  |  6 ++++--
 3 files changed, 23 insertions(+), 11 deletions(-)
b89fc2be8a771a8a7b4a618805a6154ec0bda18b

 .../main/scala/kafka/producer/async/DefaultEventHandler.scala  | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
814c9709c07c514b1a1255e2adb5555c323e6485

 .../kafka/consumer/ConsumerFetcherThread.scala     |  3 +-
 .../scala/kafka/server/AbstractFetcherThread.scala | 16 +++++---
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 43 +++++++++++++---------
 .../main/scala/kafka/server/RequestPurgatory.scala |  3 +-
 .../scala/kafka/utils/ShutdownableThread.scala     |  5 ++-
 5 files changed, 42 insertions(+), 28 deletions(-)
826f02a74e00bec1efb9d60b43cf9e0702d8d58a

 core/src/main/scala/kafka/network/RequestChannel.scala     | 4 ++++
 core/src/main/scala/kafka/network/SocketServer.scala       | 1 +
 core/src/main/scala/kafka/server/KafkaRequestHandler.scala | 2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala         | 4 ++--
 4 files changed, 8 insertions(+), 3 deletions(-)
aed6c3c0313ec00fa10b2fb0dd07658c96a99647

 core/src/main/scala/kafka/controller/PartitionStateMachine.scala | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
1086d001d8f2389cd8cf409d099ca3260b00eb49

 core/src/main/scala/kafka/cluster/Partition.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
295734f6abb69d0c184faa0085ca198040b2adbf

 contrib/hadoop-producer/README.md                  | 119 ++++++---------------
 .../java/kafka/bridge/examples/TextPublisher.java  |  14 ++-
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     | 103 ++++++++----------
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |  35 +++---
 .../java/kafka/bridge/pig/AvroKafkaStorage.java    |   8 +-
 project/build/KafkaProject.scala                   |   2 +-
 6 files changed, 108 insertions(+), 173 deletions(-)
2ae069024120a7c9775ac53966f0af08435f2e5b

 system_test/mirror_maker_testsuite/config/mirror_consumer.properties    | 2 +-
 .../mirror_maker_testsuite/testcase_5003/testcase_5003_properties.json  | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
b3a4fe9cedca778a95b7f22054cb8f8ef6cf38c7

 core/src/main/scala/kafka/api/FetchRequest.scala             |  6 +++++-
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 11 +++++------
 2 files changed, 10 insertions(+), 7 deletions(-)
e7edb5e1e933f5535378d546bcf4d8b178d2e69c

 config/log4j.properties                            |  15 +-
 config/server.properties                           |   1 +
 core/src/main/scala/kafka/cluster/Partition.scala  |   8 +-
 .../common/OptimisticLockFailureException.scala    |  23 +
 core/src/main/scala/kafka/log/CleanerConfig.scala  |  41 ++
 core/src/main/scala/kafka/log/FileMessageSet.scala |  30 +-
 core/src/main/scala/kafka/log/Log.scala            | 265 ++++++----
 core/src/main/scala/kafka/log/LogCleaner.scala     | 557 +++++++++++++++++++++
 core/src/main/scala/kafka/log/LogConfig.scala      |  51 ++
 core/src/main/scala/kafka/log/LogManager.scala     | 120 ++---
 core/src/main/scala/kafka/log/LogSegment.scala     |  24 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    |  33 +-
 core/src/main/scala/kafka/log/OffsetMap.scala      | 136 +++++
 .../scala/kafka/message/ByteBufferMessageSet.scala |   4 +-
 .../kafka/server/HighwaterMarkCheckpoint.scala     | 118 -----
 core/src/main/scala/kafka/server/KafkaConfig.scala |  33 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  51 +-
 .../main/scala/kafka/server/OffsetCheckpoint.scala | 103 ++++
 .../main/scala/kafka/server/ReplicaManager.scala   |  14 +-
 core/src/main/scala/kafka/utils/FileLock.scala     |  94 ++--
 core/src/main/scala/kafka/utils/Logging.scala      |   5 +-
 core/src/main/scala/kafka/utils/Throttler.scala    |  26 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  36 +-
 .../scala/kafka/utils/VerifiableProperties.scala   |  35 +-
 .../src/test/scala/other/kafka/StressTestLog.scala |  12 +-
 .../test/scala/other/kafka/TestLogCleaning.scala   | 216 ++++++++
 .../scala/other/kafka/TestLogPerformance.scala     |   3 +-
 .../test/scala/unit/kafka/log/CleanerTest.scala    | 227 +++++++++
 .../unit/kafka/log/LogCleanerIntegrationTest.scala | 117 +++++
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  57 +--
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  15 +
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 139 ++---
 .../test/scala/unit/kafka/log/OffsetMapTest.scala  |  87 ++++
 .../server/HighwatermarkPersistenceTest.scala      |  16 +-
 .../scala/unit/kafka/server/LogOffsetTest.scala    |   2 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  48 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   2 -
 .../scala/unit/kafka/utils/MockScheduler.scala     |  32 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  11 +-
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  20 +
 40 files changed, 2280 insertions(+), 547 deletions(-)
1fb3e8c037c01ecfe6bb1d4261b59cb19baae6cf

 .../main/scala/kafka/server/RequestPurgatory.scala | 29 +++++++++-------------
 1 file changed, 12 insertions(+), 17 deletions(-)
92f177b309834a9b572bbab33e8f6198316bd156
40a80fa7b7ae3d49e32c40fbaad1a4e402b2ac71

 core/src/main/scala/kafka/network/RequestChannel.scala | 3 ++-
 core/src/main/scala/kafka/network/SocketServer.scala   | 5 +++--
 core/src/main/scala/kafka/server/KafkaApis.scala       | 2 +-
 3 files changed, 6 insertions(+), 4 deletions(-)
22a010b8bcd19e29a9acfe1489ffb6db429f8e07

 perf/build.sbt      | 1 +
 project/Build.scala | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)
758778ebaa357f41fb9f1e4f3c1a13c639ad6d2f

 .../testcase_0011/testcase_0011_properties.json    | 84 ++++++++++++++++++++
 .../testcase_0024/testcase_0024_properties.json    | 86 ++++++++++++++++++++
 .../testcase_0119/testcase_0119_properties.json    | 87 ++++++++++++++++++++
 .../testcase_0128/testcase_0128_properties.json    | 89 +++++++++++++++++++++
 .../testcase_0134/testcase_0134_properties.json    | 92 ++++++++++++++++++++++
 .../testcase_0159/testcase_0159_properties.json    | 91 +++++++++++++++++++++
 .../testcase_0209/testcase_0209_properties.json    | 90 +++++++++++++++++++++
 .../testcase_0259/testcase_0259_properties.json    | 90 +++++++++++++++++++++
 .../testcase_0309/testcase_0309_properties.json    | 88 +++++++++++++++++++++
 9 files changed, 797 insertions(+)
8d41620a427a027d212c241ae105d09cd470e64f

 core/src/main/scala/kafka/api/FetchRequest.scala   | 25 ++++++-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala | 24 +++++++
 core/src/main/scala/kafka/api/OffsetRequest.scala  | 24 ++++++-
 .../src/main/scala/kafka/api/ProducerRequest.scala | 24 ++++++-
 .../main/scala/kafka/api/RequestOrResponse.scala   |  8 ++-
 .../main/scala/kafka/api/StopReplicaRequest.scala  | 27 +++++++-
 .../scala/kafka/api/TopicMetadataRequest.scala     | 23 +++++-
 core/src/main/scala/kafka/cluster/Partition.scala  |  4 +-
 .../main/scala/kafka/network/RequestChannel.scala  | 11 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 81 ++--------------------
 10 files changed, 156 insertions(+), 95 deletions(-)
a15f1f2d84d133a3e01b2c7fe88cbed033ee7bac

 core/src/main/scala/kafka/tools/KafkaMigrationTool.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8e7effc0550f57064fba0c3b48a248ad9c3ab003

 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
cb3359f9f14c4632ed31b7fcef7f311d7597955c

 bin/kafka-run-class.sh | 33 ++++++++++++++++++++-------------
 1 file changed, 20 insertions(+), 13 deletions(-)
aeac593a90e0d796260f876159d3cf2b0416ca61

 bin/kafka-run-class.sh | 2 ++
 1 file changed, 2 insertions(+)
2bee455ed86f5780862c09edd01cd347a5551665

 .../migration_tool_testsuite/0.7/bin/kafka-run-class.sh   | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
7833c894a89779b4d49c329b16d66b3296f6c09d

 core/src/main/scala/kafka/client/ClientUtils.scala                  | 3 ++-
 core/src/main/scala/kafka/consumer/ConsoleConsumer.scala            | 6 ++++++
 core/src/main/scala/kafka/consumer/ConsumerFetcherManager.scala     | 5 ++++-
 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 5 ++++-
 core/src/main/scala/kafka/tools/SimpleConsumerShell.scala           | 2 +-
 5 files changed, 17 insertions(+), 4 deletions(-)
311a5d81d8a8b34e18e1ad2fdc491661477de83c

 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   5 +-
 .../src/test/scala/other/kafka/StressTestLog.scala | 109 +++++++++++++++++++++
 3 files changed, 113 insertions(+), 3 deletions(-)
22bde135a85da9507f08698f29403c792db31e42
eb0d5a7f815ac51e3bdcf7bb2c1d3af9f33f2d83

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  2 +-
 .../scala/kafka/controller/KafkaController.scala   | 26 ++++----
 .../kafka/controller/PartitionLeaderSelector.scala | 47 +++++++-------
 .../kafka/controller/PartitionStateMachine.scala   | 26 ++++----
 .../kafka/controller/ReplicaStateMachine.scala     | 71 +++++++++++-----------
 core/src/main/scala/kafka/utils/Logging.scala      |  2 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 11 ++--
 .../test/scala/unit/kafka/utils/UtilsTest.scala    | 12 ++++
 9 files changed, 105 insertions(+), 94 deletions(-)
307b1f338ad9748809c9b782dc3f28263edcadf2

 core/src/main/scala/kafka/api/FetchRequest.scala   |  1 -
 .../scala/kafka/server/AbstractFetcherThread.scala | 24 +++++-----------------
 .../scala/kafka/server/ReplicaFetcherManager.scala |  2 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  2 +-
 4 files changed, 7 insertions(+), 22 deletions(-)
22cd8bfd6eca64a1a6d23ecef7f5dc938ac02c7f
b5d685bb7c1649f46f6553b0e807e704ffcef748

 bin/kafka-run-class.sh | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
0d197f9b97c586d53bb5328eaac67ef0c39601bd

 .../scala/kafka/controller/KafkaController.scala   | 35 ++++++++++++----------
 1 file changed, 19 insertions(+), 16 deletions(-)
5e3e181aceb22dd7054f134beee53e185dc0d05b

 bin/kafka-run-class.sh | 18 +++++++++++++-----
 core/build.sbt         |  3 +++
 project/Build.scala    |  2 +-
 3 files changed, 17 insertions(+), 6 deletions(-)
d5c980a912e2d1f48e99ccc16c713b1ba187b716
e6aa600813549ed6219ea5cfda95ecb08dc3717d
f112ef2b5799cc8cf7786e98d1269145a19ef361

 .../scala/kafka/controller/ReplicaStateMachine.scala     | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)
5490884e9cbd28ac57e4b73bec72bcab81ce6523

 .../main/scala/kafka/controller/PartitionLeaderSelector.scala |  3 +--
 .../main/scala/kafka/controller/PartitionStateMachine.scala   |  9 ---------
 core/src/main/scala/kafka/utils/ZkUtils.scala                 | 11 +++++------
 3 files changed, 6 insertions(+), 17 deletions(-)
426ef1662590893ff27a4be0b5f17b73115f154c

 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
2d059148febe3804116311924ad7953c40914dc1
999813821c091adcc5c50d0cb6b8c702473a0a8c
96dc298438994fb5c93daa8c544bf8581a0eeb69

 perf/src/main/scala/kafka/perf/PerfConfig.scala          |  2 +-
 perf/src/main/scala/kafka/perf/ProducerPerformance.scala | 14 --------------
 2 files changed, 1 insertion(+), 15 deletions(-)
1e011bf42efce996a553d6c0a2d7e51b45622b6b

 core/src/test/scala/unit/kafka/producer/AsyncProducerTest.scala | 1 +
 1 file changed, 1 insertion(+)
aa1546b0907c959a4df90a7e3d48bad0890d1f2f

 .../main/scala/kafka/controller/PartitionLeaderSelector.scala |  3 ++-
 .../main/scala/kafka/controller/PartitionStateMachine.scala   |  9 +++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala                 | 11 ++++++-----
 3 files changed, 17 insertions(+), 6 deletions(-)
ecd1f19f5aea2d2907d1a5594080062cb5c945f1

 core/src/main/scala/kafka/producer/async/AsyncProducerConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
9ee795ac563c3ce4c4f03e022c7f951e065ad1ed
214a0af46b98aa9eaf54d0fbe982bc8ba2ae0a74

 .../kafka/consumer/ConsumerFetcherManager.scala    |  8 ++++--
 .../kafka/consumer/ConsumerFetcherThread.scala     |  7 ++++-
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  9 +++++--
 .../consumer/ZookeeperConsumerConnector.scala      | 31 +++-------------------
 .../scala/kafka/server/AbstractFetcherThread.scala | 21 ++++++++++-----
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  9 ++++---
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  1 -
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  1 -
 .../scala/unit/kafka/integration/FetcherTest.scala |  1 -
 9 files changed, 44 insertions(+), 44 deletions(-)
da7f14676e677bb6b4fc1ea75fe9792709954591

 core/src/main/scala/kafka/network/RequestChannel.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
777f66220153a64cd33cd5484a64de556f4fa3a8

 core/src/main/scala/kafka/api/FetchRequest.scala   | 36 +++++++++++++++++-----
 .../main/scala/kafka/javaapi/FetchRequest.scala    |  6 ++--
 2 files changed, 30 insertions(+), 12 deletions(-)
de1a4d727693c39be19fd9db427746fa6c8a4a12

 core/src/main/scala/kafka/log/Log.scala | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)
362eba981de40a69ae509a291649531ead6f6aee
3696d728116ee1b408d11bab54ca3f0234438610
eeb817ac23f4aa756ebe404a85eeb618a7cb5a08

 core/src/main/scala/kafka/common/Config.scala          | 6 +++---
 core/src/main/scala/kafka/common/Topic.scala           | 8 +++++---
 core/src/test/scala/unit/kafka/common/ConfigTest.scala | 8 ++++----
 core/src/test/scala/unit/kafka/common/TopicTest.scala  | 4 ++--
 4 files changed, 14 insertions(+), 12 deletions(-)
b2eec991d35e7d17b3cfc05438d81637a056aa83

 core/src/main/scala/kafka/common/Config.scala          | 6 +++---
 core/src/main/scala/kafka/common/Topic.scala           | 8 +++++---
 core/src/test/scala/unit/kafka/common/ConfigTest.scala | 8 ++++----
 core/src/test/scala/unit/kafka/common/TopicTest.scala  | 4 ++--
 4 files changed, 14 insertions(+), 12 deletions(-)
b052e80de20785946dff27559ee3fd5eb45e7ce1
bd5504c0520d393715afe524313c5c8ac00337a2

 .../testcase_9001/testcase_9001_properties.json    | 17 +++++++------
 .../testcase_9003/testcase_9003_properties.json    | 17 +++++++------
 .../testcase_9004/testcase_9004_properties.json    | 17 +++++++------
 .../testcase_9005/testcase_9005_properties.json    | 19 ++++++++-------
 .../testcase_9006/testcase_9006_properties.json    | 19 ++++++++-------
 .../testcase_5001/testcase_5001_properties.json    | 26 ++++++++++----------
 .../testcase_5002/testcase_5002_properties.json    | 26 ++++++++++----------
 .../testcase_5003/testcase_5003_properties.json    | 26 ++++++++++----------
 .../testcase_5004/testcase_5004_properties.json    | 26 ++++++++++----------
 .../testcase_5005/testcase_5005_properties.json    | 28 +++++++++++-----------
 .../testcase_5006/testcase_5006_properties.json    | 28 +++++++++++-----------
 .../testcase_0001/testcase_0001_properties.json    | 14 +++++------
 .../testcase_0002/testcase_0002_properties.json    | 14 +++++------
 .../testcase_0003/testcase_0003_properties.json    | 14 +++++------
 .../testcase_0004/testcase_0004_properties.json    | 14 +++++------
 .../testcase_0005/testcase_0005_properties.json    | 14 +++++------
 .../testcase_0006/testcase_0006_properties.json    | 14 +++++------
 .../testcase_0007/testcase_0007_properties.json    | 14 +++++------
 .../testcase_0008/testcase_0008_properties.json    | 14 +++++------
 .../testcase_0009/testcase_0009_properties.json    | 14 +++++------
 .../testcase_0010/testcase_0010_properties.json    | 14 +++++------
 .../testcase_0021/testcase_0021_properties.json    | 16 ++++++-------
 .../testcase_0022/testcase_0022_properties.json    | 16 ++++++-------
 .../testcase_0023/testcase_0023_properties.json    | 16 ++++++-------
 .../testcase_0101/testcase_0101_properties.json    | 14 +++++------
 .../testcase_0102/testcase_0102_properties.json    | 14 +++++------
 .../testcase_0103/testcase_0103_properties.json    | 14 +++++------
 .../testcase_0104/testcase_0104_properties.json    | 14 +++++------
 .../testcase_0105/testcase_0105_properties.json    | 14 +++++------
 .../testcase_0106/testcase_0106_properties.json    | 14 +++++------
 .../testcase_0107/testcase_0107_properties.json    | 14 +++++------
 .../testcase_0108/testcase_0108_properties.json    | 14 +++++------
 .../testcase_0109/testcase_0109_properties.json    | 14 +++++------
 .../testcase_0110/testcase_0110_properties.json    | 14 +++++------
 .../testcase_0111/testcase_0111_properties.json    | 14 +++++------
 .../testcase_0112/testcase_0112_properties.json    | 14 +++++------
 .../testcase_0113/testcase_0113_properties.json    | 14 +++++------
 .../testcase_0114/testcase_0114_properties.json    | 14 +++++------
 .../testcase_0115/testcase_0115_properties.json    | 14 +++++------
 .../testcase_0116/testcase_0116_properties.json    | 14 +++++------
 .../testcase_0117/testcase_0117_properties.json    | 14 +++++------
 .../testcase_0118/testcase_0118_properties.json    | 14 +++++------
 .../testcase_0121/testcase_0121_properties.json    | 16 ++++++-------
 .../testcase_0122/testcase_0122_properties.json    | 16 ++++++-------
 .../testcase_0123/testcase_0123_properties.json    | 16 ++++++-------
 .../testcase_0124/testcase_0124_properties.json    | 16 ++++++-------
 .../testcase_0125/testcase_0125_properties.json    | 16 ++++++-------
 .../testcase_0126/testcase_0126_properties.json    | 16 ++++++-------
 .../testcase_0127/testcase_0127_properties.json    | 16 ++++++-------
 .../testcase_0131/testcase_0131_properties.json    | 16 ++++++-------
 .../testcase_0132/testcase_0132_properties.json    | 16 ++++++-------
 .../testcase_0133/testcase_0133_properties.json    | 16 ++++++-------
 .../testcase_0151/testcase_0151_properties.json    | 14 +++++------
 .../testcase_0152/testcase_0152_properties.json    | 14 +++++------
 .../testcase_0153/testcase_0153_properties.json    | 14 +++++------
 .../testcase_0154/testcase_0154_properties.json    | 14 +++++------
 .../testcase_0155/testcase_0155_properties.json    | 14 +++++------
 .../testcase_0156/testcase_0156_properties.json    | 14 +++++------
 .../testcase_0157/testcase_0157_properties.json    | 14 +++++------
 .../testcase_0158/testcase_0158_properties.json    | 14 +++++------
 .../testcase_0201/testcase_0201_properties.json    | 14 +++++------
 .../testcase_0202/testcase_0202_properties.json    | 14 +++++------
 .../testcase_0203/testcase_0203_properties.json    | 14 +++++------
 .../testcase_0204/testcase_0204_properties.json    | 14 +++++------
 .../testcase_0205/testcase_0205_properties.json    | 14 +++++------
 .../testcase_0206/testcase_0206_properties.json    | 14 +++++------
 .../testcase_0207/testcase_0207_properties.json    | 14 +++++------
 .../testcase_0208/testcase_0208_properties.json    | 14 +++++------
 .../testcase_0251/testcase_0251_properties.json    | 14 +++++------
 .../testcase_0252/testcase_0252_properties.json    | 14 +++++------
 .../testcase_0253/testcase_0253_properties.json    | 14 +++++------
 .../testcase_0254/testcase_0254_properties.json    | 14 +++++------
 .../testcase_0255/testcase_0255_properties.json    | 14 +++++------
 .../testcase_0256/testcase_0256_properties.json    | 14 +++++------
 .../testcase_0257/testcase_0257_properties.json    | 14 +++++------
 .../testcase_0258/testcase_0258_properties.json    | 14 +++++------
 .../testcase_0301/testcase_0301_properties.json    | 14 +++++------
 .../testcase_0302/testcase_0302_properties.json    | 14 +++++------
 .../testcase_0303/testcase_0303_properties.json    | 14 +++++------
 .../testcase_0304/testcase_0304_properties.json    | 14 +++++------
 .../testcase_0305/testcase_0305_properties.json    | 14 +++++------
 .../testcase_0306/testcase_0306_properties.json    | 14 +++++------
 .../testcase_0307/testcase_0307_properties.json    | 14 +++++------
 .../testcase_0308/testcase_0308_properties.json    | 14 +++++------
 .../testcase_1/testcase_1_properties.json          | 14 +++++------
 .../testcase_4001/testcase_4001_properties.json    | 16 ++++++-------
 .../testcase_4002/testcase_4002_properties.json    | 16 ++++++-------
 .../testcase_4003/testcase_4003_properties.json    | 16 ++++++-------
 .../testcase_4004/testcase_4004_properties.json    | 16 ++++++-------
 .../testcase_4005/testcase_4005_properties.json    | 16 ++++++-------
 .../testcase_4006/testcase_4006_properties.json    | 16 ++++++-------
 .../testcase_4007/testcase_4007_properties.json    | 16 ++++++-------
 .../testcase_4008/testcase_4008_properties.json    | 16 ++++++-------
 .../testcase_4011/testcase_4011_properties.json    | 16 ++++++-------
 .../testcase_4012/testcase_4012_properties.json    | 16 ++++++-------
 .../testcase_4013/testcase_4013_properties.json    | 16 ++++++-------
 .../testcase_4014/testcase_4014_properties.json    | 16 ++++++-------
 .../testcase_4015/testcase_4015_properties.json    | 16 ++++++-------
 .../testcase_4016/testcase_4016_properties.json    | 16 ++++++-------
 .../testcase_4017/testcase_4017_properties.json    | 16 ++++++-------
 .../testcase_4018/testcase_4018_properties.json    | 16 ++++++-------
 .../testcase_9051/testcase_9051_properties.json    | 14 +++++------
 system_test/utils/kafka_system_test_utils.py       | 12 +++++++++-
 103 files changed, 809 insertions(+), 784 deletions(-)
53818bb7ee8022486eee06a22328200fc5cfced1

 config/consumer.properties                         |  2 +-
 config/server.properties                           |  2 +-
 .../scala/kafka/producer/ConsoleProducer.scala     | 34 +++++++++++++---------
 3 files changed, 22 insertions(+), 16 deletions(-)
d7f410925e870f3f8b220fb7bdc2c2f265f06ed6
c02e7fd690301e93454638a73cd31343cad178b8

 config/log4j.properties | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
9249b76d1d04f2583843cf5fe09ba8bbdf611183
a40953196e1ef558eb61b78219a20c20a4bd63df

 config/consumer.properties                         |  2 +-
 config/producer.properties                         | 25 ++------
 config/server.properties                           | 34 +++++-----
 .../main/java/kafka/etl/impl/DataGenerator.java    |  2 +-
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     |  3 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |  2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  | 10 +--
 .../scala/kafka/consumer/ConsoleConsumer.scala     | 16 ++---
 .../main/scala/kafka/consumer/ConsumerConfig.scala | 32 +++++-----
 .../kafka/consumer/ConsumerFetcherThread.scala     |  8 +--
 .../consumer/ZookeeperConsumerConnector.scala      | 20 +++---
 core/src/main/scala/kafka/log/LogManager.scala     | 34 +++++-----
 .../scala/kafka/producer/ConsoleProducer.scala     | 10 +--
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  4 +-
 core/src/main/scala/kafka/producer/Producer.scala  | 12 ++--
 .../main/scala/kafka/producer/ProducerConfig.scala | 25 ++++----
 .../main/scala/kafka/producer/SyncProducer.scala   |  2 +-
 .../scala/kafka/producer/SyncProducerConfig.scala  | 10 ++-
 .../kafka/producer/async/AsyncProducerConfig.scala |  8 +--
 .../kafka/producer/async/DefaultEventHandler.scala |  9 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  6 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala | 72 +++++++++++-----------
 core/src/main/scala/kafka/server/KafkaServer.scala |  4 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  8 +--
 .../main/scala/kafka/server/ReplicaManager.scala   |  6 +-
 .../main/scala/kafka/tools/KafkaMigrationTool.java |  4 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala | 14 ++---
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  6 +-
 .../scala/other/kafka/TestEndToEndLatency.scala    |  4 +-
 .../scala/other/kafka/TestLogPerformance.scala     |  2 +-
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |  2 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |  4 +-
 .../integration/ProducerConsumerTestHarness.scala  |  8 +--
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 22 +++----
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |  6 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 36 +++++------
 .../unit/kafka/producer/AsyncProducerTest.scala    |  8 +--
 .../scala/unit/kafka/producer/ProducerTest.scala   | 16 ++---
 .../unit/kafka/producer/SyncProducerTest.scala     | 17 +++--
 .../unit/kafka/server/ISRExpirationTest.scala      | 10 +--
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  8 +--
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 24 ++++----
 .../src/main/java/kafka/examples/Consumer.java     |  8 +--
 .../scala/kafka/perf/ConsumerPerformance.scala     | 12 ++--
 .../scala/kafka/perf/ProducerPerformance.scala     | 16 ++---
 .../config/mirror_producer.properties              |  4 +-
 .../config/mirror_producer1.properties             |  4 +-
 .../config/mirror_producer2.properties             |  4 +-
 .../config/mirror_producer3.properties             |  4 +-
 .../config/server_source1.properties               | 20 +++---
 .../config/server_source2.properties               | 20 +++---
 .../config/server_source3.properties               | 20 +++---
 .../config/server_source4.properties               | 20 +++---
 .../config/server_target1.properties               | 20 +++---
 .../config/server_target2.properties               | 20 +++---
 .../config/server_target3.properties               | 20 +++---
 .../config/whitelisttest.consumer.properties       |  6 +-
 system_test/common/util.sh                         |  8 +--
 .../config/migration_producer.properties           | 29 ++-------
 .../config/server.properties                       | 36 +++++------
 .../config/blacklisttest.consumer.properties       |  6 +-
 .../mirror_maker/config/mirror_producer.properties |  4 +-
 .../config/server_source_1_1.properties            | 20 +++---
 .../config/server_source_1_2.properties            | 20 +++---
 .../config/server_source_2_1.properties            | 20 +++---
 .../config/server_source_2_2.properties            | 20 +++---
 .../config/server_target_1_1.properties            | 20 +++---
 .../config/server_target_1_2.properties            | 20 +++---
 .../config/whitelisttest_1.consumer.properties     |  6 +-
 .../config/whitelisttest_2.consumer.properties     |  6 +-
 .../config/mirror_consumer.properties              | 20 +++---
 .../config/mirror_producer.properties              |  2 +-
 .../config/server.properties                       | 56 ++++++++---------
 system_test/producer_perf/config/server.properties | 20 +++---
 .../replication_testsuite/config/server.properties | 56 ++++++++---------
 76 files changed, 541 insertions(+), 585 deletions(-)
dbe87f6df314190225956fff338dd14173e04715

 config/log4j.properties | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
03eb903ce223ab55c5acbcf4243ce805aaaf4fad

 config/log4j.properties                            | 44 ++++++++++++++++------
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  5 ++-
 .../src/main/scala/kafka/api/ProducerRequest.scala |  1 -
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  4 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     | 19 ++++++----
 core/src/main/scala/kafka/client/ClientUtils.scala | 13 ++++---
 .../kafka/consumer/ConsumerFetcherThread.scala     |  2 +-
 .../controller/ControllerChannelManager.scala      |  6 +--
 .../scala/kafka/controller/KafkaController.scala   |  4 +-
 .../kafka/controller/PartitionStateMachine.scala   |  5 ++-
 .../kafka/controller/ReplicaStateMachine.scala     |  2 +-
 .../scala/kafka/javaapi/TopicMetadataRequest.scala | 11 ++++--
 core/src/main/scala/kafka/log/FileMessageSet.scala |  1 +
 core/src/main/scala/kafka/log/Log.scala            | 29 ++++++++++----
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 12 ++++--
 .../main/scala/kafka/network/RequestChannel.scala  | 11 ++++--
 .../main/scala/kafka/network/SocketServer.scala    |  2 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  8 ++--
 .../kafka/producer/async/DefaultEventHandler.scala | 34 +++++++++++------
 .../scala/kafka/server/AbstractFetcherThread.scala |  6 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 38 ++++++++++---------
 .../api/RequestResponseSerializationTest.scala     |  6 +--
 .../unit/kafka/integration/TopicMetadataTest.scala |  8 ++--
 .../unit/kafka/producer/AsyncProducerTest.scala    | 12 +++---
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |  1 +
 26 files changed, 179 insertions(+), 107 deletions(-)
c12608c5fed04ece82582cb5b764ceb0b5b389e0

 core/src/main/scala/kafka/consumer/ConsoleConsumer.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b71e6dc352770f22daec0c9a3682138666f032be

 .../scala/kafka/producer/DefaultPartitioner.scala  |  5 +--
 .../main/scala/kafka/producer/ProducerConfig.scala | 10 ++++++
 .../kafka/producer/async/DefaultEventHandler.scala | 37 +++++++++++++++-------
 3 files changed, 37 insertions(+), 15 deletions(-)
ddd66cbd80d1765898fd82322dc5c5afc9b29fba

 project/build.properties         |  2 +-
 project/build/KafkaProject.scala | 44 ++++++++++++++++++++++------------------
 2 files changed, 25 insertions(+), 21 deletions(-)
e0b3b6316342271d798af10494c0ceab13e1eb02

 .../scala/kafka/api/TopicMetadataRequest.scala     |  1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |  9 +++++--
 .../unit/kafka/integration/TopicMetadataTest.scala | 31 +++++++++++++++++-----
 3 files changed, 32 insertions(+), 9 deletions(-)
85c9e91c8010c9455ac484c1c679437bd5f43a3c

 .../scala/kafka/producer/ConsoleProducer.scala     | 57 +++++++++++++++++-----
 1 file changed, 44 insertions(+), 13 deletions(-)
fd94251d89180cdb6cf815cf2d6f568e15b85c59

 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 65 +++++++++++-----------
 1 file changed, 31 insertions(+), 34 deletions(-)
241fea700758cec7746103c50d1751155d08576a

 lib/sbt-launch.jar | Bin 920993 -> 1103618 bytes
 1 file changed, 0 insertions(+), 0 deletions(-)
ed36a7f07a45650862e115f42696b9ec70e563a5

 project/build.properties         |  2 +-
 project/build/KafkaProject.scala | 44 ++++++++++++++++++++++------------------
 2 files changed, 25 insertions(+), 21 deletions(-)
dc9edc462257f535ebf1acc2d6a1404904b8798e

 README.md | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
274cd02f1ad69650e8abe7022d36049124219317

 core/src/main/scala/kafka/server/KafkaConfig.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
222c0e46ab78a12e1f58e3fb526667a4f73d344a

 .../main/scala/kafka/api/OffsetCommitRequest.scala | 100 ++++++++++++
 .../scala/kafka/api/OffsetCommitResponse.scala     |  93 +++++++++++
 .../main/scala/kafka/api/OffsetFetchRequest.scala  |  89 +++++++++++
 .../main/scala/kafka/api/OffsetFetchResponse.scala | 100 ++++++++++++
 core/src/main/scala/kafka/api/RequestKeys.scala    |   6 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   4 +-
 .../kafka/common/OffsetMetadataAndError.scala      |  36 +++++
 .../common/OffsetMetadataTooLargeException.scala   |  27 ++++
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  14 ++
 .../main/scala/kafka/javaapi/FetchRequest.scala    |   4 -
 core/src/main/scala/kafka/javaapi/Implicits.scala  |   6 +
 .../scala/kafka/javaapi/OffsetCommitRequest.scala  |  55 +++++++
 .../scala/kafka/javaapi/OffsetCommitResponse.scala |  30 ++++
 .../scala/kafka/javaapi/OffsetFetchRequest.scala   |  58 +++++++
 .../scala/kafka/javaapi/OffsetFetchResponse.scala  |  30 ++++
 .../main/scala/kafka/javaapi/OffsetRequest.scala   |   5 -
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |  21 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  88 ++++++++++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   3 +
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../api/RequestResponseSerializationTest.scala     |  65 +++++++-
 .../unit/kafka/integration/TopicMetadataTest.scala |   4 +-
 .../scala/unit/kafka/server/OffsetCommitTest.scala | 174 +++++++++++++++++++++
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   4 +-
 24 files changed, 998 insertions(+), 20 deletions(-)
a39c34a2d138b3bdc5af70f4888982b02dea0742
2f4bfc645a597892c3b0a8dfe722158f3b993874

 core/src/main/scala/kafka/api/ApiUtils.scala       | 13 ++--
 .../test/scala/unit/kafka/api/ApiUtilsTest.scala   | 84 ++++++++++++++++++++++
 2 files changed, 92 insertions(+), 5 deletions(-)
6cf46e7cabd2041cb0c171bab4166d5f8b377a51

 .../main/scala/kafka/server/HighwaterMarkCheckpoint.scala  | 14 ++++++--------
 1 file changed, 6 insertions(+), 8 deletions(-)
25d77cc69c5f12394f55e22516fc90fd3c272166

 .../main/scala/kafka/admin/ShutdownBroker.scala    | 33 +++++++++++-----------
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  3 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  4 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 4 files changed, 21 insertions(+), 21 deletions(-)
c6d41102d81ac48b345d3f42d669e6a6bbfbe062

 config/server.properties                           | 11 +++---
 .../main/scala/kafka/network/SocketServer.scala    | 40 +++++++++++++++++-----
 core/src/main/scala/kafka/server/KafkaConfig.scala |  6 ++--
 core/src/main/scala/kafka/server/KafkaServer.scala |  1 +
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  8 +++--
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  2 +-
 .../unit/kafka/network/SocketServerTest.scala      |  1 +
 7 files changed, 48 insertions(+), 21 deletions(-)
32dae955d5e2e2dd45bddb628cb07c874241d856
85ec04452b1039acd927b9794ab848f4f052c765

 project/build/KafkaProject.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
04b52743f8eaa9057b0b5687fb3681e1bd1e2d49

 core/src/main/scala/kafka/server/KafkaApis.scala   | 12 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  8 ++-
 .../main/scala/kafka/server/RequestPurgatory.scala | 76 ++++++++++++----------
 .../unit/kafka/integration/TopicMetadataTest.scala |  2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  4 +-
 5 files changed, 58 insertions(+), 44 deletions(-)
4e5a6fc0cf3454e665cd156ca2b8db34e3d0bcaf
994fe081b6e429ba1cfd5c09d464015c41e64cf7

 .../scala/kafka/common/ClientIdAndBroker.scala     | 26 +++++++
 .../main/scala/kafka/common/ClientIdAndTopic.scala | 27 +++++++
 core/src/main/scala/kafka/common/Config.scala      | 40 ++++++++++
 .../kafka/common/InvalidClientIdException.scala    |  0
 core/src/main/scala/kafka/common/Topic.scala       | 40 ++++++++++
 .../consumer/FetchRequestAndResponseStats.scala    | 58 ++++++++++++++
 .../kafka/producer/ProducerRequestStats.scala      | 56 ++++++++++++++
 .../main/scala/kafka/producer/ProducerStats.scala  | 40 ++++++++++
 .../scala/kafka/producer/ProducerTopicStats.scala  | 57 ++++++++++++++
 .../main/scala/kafka/utils/ClientIdAndTopic.scala  |  0
 .../test/scala/unit/kafka/common/ConfigTest.scala  | 89 ++++++++++++++++++++++
 .../test/scala/unit/kafka/common/TopicTest.scala   | 61 +++++++++++++++
 .../test/scala/unit/kafka/utils/ClientIdTest.scala |  0
 .../test/scala/unit/kafka/utils/TopicTest.scala    |  0
 14 files changed, 494 insertions(+)
af83dfbe0c092eea37e9b1b840870386bb612db8

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
792b071ccaa9a01259af34cd86a705d474df7036
9001d74839772d148443d3d86aca48f5dbbc890b

 .../testcase_9051/cluster_config.json              | 48 +++++++-------
 .../testcase_9051/testcase_9051_properties.json    |  5 +-
 system_test/utils/kafka_system_test_utils.py       | 77 ++++++++++++++++++++--
 system_test/utils/testcase_env.py                  |  5 ++
 4 files changed, 103 insertions(+), 32 deletions(-)
8ad9018ea197676bdc4e57ccf985dc752e54e5c7

 .../scala/kafka/admin/CreateTopicCommand.scala     |  1 +
 .../kafka/common/InvalidClientIdException.scala    | 22 --------
 .../main/scala/kafka/consumer/ConsumerConfig.scala | 31 ++++++++++-
 .../scala/kafka/consumer/ConsumerIterator.scala    |  3 +-
 .../scala/kafka/consumer/ConsumerTopicStats.scala  | 26 +++++++--
 .../main/scala/kafka/consumer/KafkaStream.scala    |  4 +-
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  4 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala | 22 ++++----
 .../consumer/ZookeeperConsumerConnector.scala      | 14 ++---
 core/src/main/scala/kafka/producer/Producer.scala  | 61 ++++-----------------
 .../main/scala/kafka/producer/ProducerConfig.scala | 29 ++++++++++
 .../main/scala/kafka/producer/SyncProducer.scala   | 22 ++++----
 .../kafka/producer/async/DefaultEventHandler.scala |  7 ++-
 .../scala/kafka/server/AbstractFetcherThread.scala | 46 +++++++++-------
 .../main/scala/kafka/utils/ClientIdAndTopic.scala  | 64 ----------------------
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  6 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  6 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    | 40 ++++----------
 .../test/scala/unit/kafka/utils/ClientIdTest.scala | 60 --------------------
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  1 -
 .../test/scala/unit/kafka/utils/TopicTest.scala    | 61 ---------------------
 21 files changed, 172 insertions(+), 358 deletions(-)
739b2df6806c10b934f69e6181555fccb85cd9b8

 core/src/main/scala/kafka/utils/Crc32.java         | 637 +++++++++++++++++++++
 core/src/main/scala/kafka/utils/Utils.scala        |   5 +-
 .../scala/other/kafka/TestCrcPerformance.scala     |  31 +
 3 files changed, 670 insertions(+), 3 deletions(-)
f0d26335f2aa3397f0fd6125bfd833c331e90ae9

 core/src/main/scala/kafka/log/LogManager.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
45cb03d456c3c541815691e80f5216a6e524c95c

 .gitignore                        |   2 +
 README.md                         |  21 +++---
 bin/run-rat.sh                    |   2 +-
 contrib/hadoop-consumer/build.sbt |   1 +
 contrib/hadoop-producer/build.sbt |   1 +
 core/build.sbt                    |  24 +++++++
 examples/build.sbt                |   3 +
 lib/apache-rat-0.8.jar            | Bin 0 -> 1165578 bytes
 project/Build.scala               | 143 ++++++++++++++++++++++++++++++++++++++
 project/build.properties          |  10 +--
 project/plugins.sbt               |   5 ++
 project/plugins/Plugins.scala     |  23 ------
 12 files changed, 193 insertions(+), 42 deletions(-)
3244bcafe4233611fc0366f9df53ec98b44ca571

 core/src/main/scala/kafka/log/Log.scala          | 31 +++++++++++++++---------
 core/src/test/scala/unit/kafka/log/LogTest.scala | 26 ++++++++++++++++++++
 2 files changed, 46 insertions(+), 11 deletions(-)
ac35ae1fef0294cc5a33908209598f938dc7d84c

 core/src/main/scala/kafka/log/Log.scala            |  88 +++++++++++++-----
 core/src/main/scala/kafka/log/LogManager.scala     |  12 ++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   2 +
 .../scala/other/kafka/TestLogPerformance.scala     |   5 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  19 ++--
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 102 +++++++++++++++++----
 .../scala/unit/kafka/message/MessageTest.scala     |   8 +-
 .../scala/unit/kafka/utils/MockScheduler.scala     |  53 +++++------
 .../scala/unit/kafka/utils/SchedulerTest.scala     |   7 ++
 9 files changed, 210 insertions(+), 86 deletions(-)
f9702c66b76873de6b2cce1f688e233dae4bf590

 core/src/main/scala/kafka/server/HighwaterMarkCheckpoint.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
e15432efd3d43b2814703d2d5ed6d05758861a6b

 bin/windows/kafka-server-stop.bat     | 18 ++++++++++++++++++
 bin/windows/zookeeper-server-stop.bat | 17 +++++++++++++++++
 2 files changed, 35 insertions(+)
a10be4b69c904a596af198feaac4cef4c391bf4c

 .../consumer/ZookeeperConsumerConnector.scala      |  11 +-
 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  30 +++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |   3 +
 core/src/main/scala/kafka/server/KafkaServer.scala |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   6 +-
 .../main/scala/kafka/utils/KafkaScheduler.scala    | 124 ++++++++++++++-------
 core/src/main/scala/kafka/utils/MockTime.scala     |  34 ------
 core/src/main/scala/kafka/utils/Utils.scala        |  20 ----
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  30 ++---
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   6 +-
 .../server/HighwatermarkPersistenceTest.scala      |   2 +-
 .../scala/unit/kafka/utils/MockScheduler.scala     |  83 ++++++++++++++
 .../src/test/scala/unit/kafka/utils/MockTime.scala |  49 ++++++++
 .../scala/unit/kafka/utils/SchedulerTest.scala     |  82 ++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  12 +-
 16 files changed, 356 insertions(+), 142 deletions(-)
133c88278da2469bdf5c3d012a03c5eb117022bd

 core/src/main/scala/kafka/log/Log.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
8a93698a75fccb8fbad5c9c24b6657c646e11b3a

 system_test/replication_testsuite/replica_basic_test.py | 14 ++++++++++----
 system_test/testcase_to_run.json                        |  2 +-
 2 files changed, 11 insertions(+), 5 deletions(-)
12706637371fa95067dbbb76c246a4fe983387c7

 .../migration_tool_test.py                         |  14 +--
 .../mirror_maker_testsuite/mirror_maker_test.py    |  17 ++-
 .../replication_testsuite/replica_basic_test.py    |  15 ++-
 system_test/utils/kafka_system_test_utils.py       | 114 +++++++++++++++++----
 4 files changed, 118 insertions(+), 42 deletions(-)
ab2494470c56d48b79eea3260d6db3c8274fe2aa

 core/src/main/scala/kafka/message/Message.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f5a48b06e31ebe925dc99abfb6518f6057871318

 core/src/main/scala/kafka/api/FetchRequest.scala   |  2 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |  8 ++----
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  2 +-
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |  8 ++----
 core/src/main/scala/kafka/api/OffsetRequest.scala  |  2 +-
 core/src/main/scala/kafka/api/OffsetResponse.scala |  8 ++----
 .../src/main/scala/kafka/api/ProducerRequest.scala |  2 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |  9 ++-----
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  2 +-
 .../main/scala/kafka/api/StopReplicaResponse.scala |  8 ++----
 .../scala/kafka/api/TopicMetadataRequest.scala     |  2 +-
 .../scala/kafka/api/TopicMetadataResponse.scala    |  9 +++----
 core/src/main/scala/kafka/server/KafkaApis.scala   | 30 +++++++++++-----------
 .../api/RequestResponseSerializationTest.scala     | 12 ++++-----
 .../unit/kafka/producer/AsyncProducerTest.scala    |  4 +--
 15 files changed, 42 insertions(+), 66 deletions(-)
a4c767582991787ca4a06b6e2844b23a2010def9

 .../test/scala/unit/kafka/admin/AdminTest.scala    | 61 ++++++++++++----------
 1 file changed, 32 insertions(+), 29 deletions(-)
98042e912392ec01173a4fcc5413a72577ee7576

 core/src/main/scala/kafka/api/FetchResponse.scala         | 11 +++--------
 core/src/main/scala/kafka/api/TopicMetadataResponse.scala |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala          |  9 ++++-----
 3 files changed, 8 insertions(+), 14 deletions(-)
e11447650a9a9fbaebff0e5c6a369375e087f1ae

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |   8 +-
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |   6 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   6 +-
 core/src/main/scala/kafka/api/OffsetResponse.scala |   6 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |   8 +-
 .../main/scala/kafka/api/StopReplicaResponse.scala |   6 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  | 120 ++++++---------------
 .../scala/kafka/api/TopicMetadataRequest.scala     |  11 +-
 .../scala/kafka/api/TopicMetadataResponse.scala    |  32 ++++--
 core/src/main/scala/kafka/client/ClientUtils.scala |   3 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |  20 ++--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  19 +++-
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |   7 +-
 core/src/main/scala/kafka/message/Message.scala    |  64 ++++++-----
 .../main/scala/kafka/producer/ProducerConfig.scala |   2 +-
 .../scala/kafka/producer/SyncProducerConfig.scala  |   4 -
 .../kafka/producer/async/DefaultEventHandler.scala |   7 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  16 +--
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |   3 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   4 +-
 .../api/RequestResponseSerializationTest.scala     |  19 ++--
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |   2 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |   2 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   8 +-
 .../unit/kafka/network/SocketServerTest.scala      |   2 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  15 +--
 .../unit/kafka/producer/SyncProducerTest.scala     |   6 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  38 ++++---
 29 files changed, 222 insertions(+), 224 deletions(-)
494706999c43003f1f16ce3558bebe39421ff3eb

 core/src/main/scala/kafka/log/SegmentList.scala    | 100 ----------
 core/src/main/scala/kafka/utils/Range.scala        |  42 ----
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  | 219 ---------------------
 .../scala/unit/kafka/log/SegmentListTest.scala     | 113 -----------
 .../scala/unit/kafka/server/LogOffsetTest.scala    | 219 +++++++++++++++++++++
 5 files changed, 219 insertions(+), 474 deletions(-)
4be0b1be29e301500515b6c5e00655b06e829045

 core/src/main/scala/kafka/log/FileMessageSet.scala | 110 +++-
 core/src/main/scala/kafka/log/Log.scala            | 647 +++++++++------------
 core/src/main/scala/kafka/log/LogManager.scala     |  78 ++-
 core/src/main/scala/kafka/log/LogSegment.scala     | 171 ++++--
 core/src/main/scala/kafka/log/OffsetIndex.scala    |  24 +-
 core/src/main/scala/kafka/log/package.html         |   7 +-
 core/src/main/scala/kafka/message/MessageSet.scala |  14 +-
 .../main/scala/kafka/producer/ProducerConfig.scala |  12 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  92 ++-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../main/scala/kafka/server/LeaderElector.scala    |   2 -
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   2 +-
 .../main/scala/kafka/tools/KafkaMigrationTool.java |   2 +-
 core/src/main/scala/kafka/utils/Throttler.scala    |  37 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   2 -
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |  79 ++-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  52 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 107 +++-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 318 +++++-----
 .../kafka/message/BaseMessageSetTestCases.scala    |   2 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |   1 +
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  58 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   1 -
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |   3 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |   6 +-
 .../src/main/java/kafka/examples/Consumer.java     |   1 -
 26 files changed, 1044 insertions(+), 786 deletions(-)
6ca7b3acfdfe34752c42a0a1a26ea991b8e4c3b1

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  5 +-
 core/src/main/scala/kafka/client/ClientUtils.scala | 29 +++++++-
 core/src/main/scala/kafka/cluster/Broker.scala     |  4 +-
 .../scala/kafka/common/TopicExistsException.scala  | 22 ++++++
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  4 +
 .../kafka/consumer/ConsumerFetcherManager.scala    |  2 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  2 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  4 +-
 .../main/scala/kafka/producer/ProducerPool.scala   | 11 ---
 .../scala/kafka/producer/SyncProducerConfig.scala  |  2 +-
 .../kafka/producer/async/DefaultEventHandler.scala | 39 +++++-----
 core/src/main/scala/kafka/server/KafkaApis.scala   | 10 ++-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  2 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  4 +-
 .../scala/kafka/perf/ProducerPerformance.scala     | 19 ++---
 .../replication_testsuite/replica_basic_test.py    |  6 +-
 .../testcase_9051/cluster_config.json              | 87 +++++-----------------
 .../testcase_9051/testcase_9051_properties.json    | 51 +------------
 system_test/testcase_to_run.json                   |  2 +-
 20 files changed, 130 insertions(+), 177 deletions(-)
6486fd1a9f503af24c83d16a014a6405ae07cf9b

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala      | 8 ++++----
 core/src/main/scala/kafka/producer/SyncProducer.scala        | 8 ++++----
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala | 7 ++++---
 core/src/main/scala/kafka/server/ReplicaFetcherThread.scala  | 2 +-
 core/src/test/scala/unit/kafka/utils/ClientIdTest.scala      | 1 -
 5 files changed, 13 insertions(+), 13 deletions(-)
d7c71c0949e0cbae8963ca76bc69d64bee8f10af

 .../src/main/java/kafka/etl/KafkaETLContext.java   |  2 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |  2 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |  4 +-
 .../kafka/common/InvalidClientIdException.scala    | 22 +++++++
 .../kafka/consumer/ConsumerFetcherManager.scala    |  2 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |  7 ++-
 .../scala/kafka/consumer/ConsumerTopicStat.scala   | 40 ------------
 .../scala/kafka/consumer/ConsumerTopicStats.scala  | 41 ++++++++++++
 .../main/scala/kafka/consumer/KafkaStream.scala    |  5 +-
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  7 ++-
 .../main/scala/kafka/consumer/SimpleConsumer.scala | 23 ++++---
 .../consumer/ZookeeperConsumerConnector.scala      | 21 ++++---
 .../scala/kafka/controller/KafkaController.scala   |  2 +-
 .../kafka/controller/PartitionLeaderSelector.scala |  6 +-
 .../kafka/controller/PartitionStateMachine.scala   |  4 +-
 .../kafka/controller/ReplicaStateMachine.scala     |  2 +-
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |  6 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  1 -
 core/src/main/scala/kafka/log/Log.scala            |  6 +-
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |  1 -
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  6 +-
 .../scala/kafka/producer/ConsoleProducer.scala     |  1 -
 .../scala/kafka/producer/DefaultPartitioner.scala  |  1 -
 core/src/main/scala/kafka/producer/Producer.scala  | 73 +++++++++++++---------
 .../main/scala/kafka/producer/ProducerPool.scala   | 29 ++++++---
 .../main/scala/kafka/producer/SyncProducer.scala   | 14 ++---
 .../scala/kafka/producer/SyncProducerConfig.scala  |  2 +-
 .../kafka/producer/async/AsyncProducerStats.scala  | 25 --------
 .../kafka/producer/async/DefaultEventHandler.scala | 14 +++--
 .../kafka/producer/async/ProducerSendThread.scala  |  5 +-
 core/src/main/scala/kafka/serializer/Decoder.scala |  1 -
 core/src/main/scala/kafka/serializer/Encoder.scala |  2 -
 .../scala/kafka/server/AbstractFetcherThread.scala | 45 +++++++------
 core/src/main/scala/kafka/server/KafkaApis.scala   | 16 ++---
 .../scala/kafka/server/KafkaRequestHandler.scala   |  8 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |  8 +--
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |  2 +-
 .../main/scala/kafka/tools/GetOffsetShell.scala    |  2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  1 -
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  2 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  8 +--
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala |  2 +-
 .../main/scala/kafka/utils/ClientIdAndTopic.scala  | 64 +++++++++++++++++++
 core/src/main/scala/kafka/utils/Topic.scala        | 41 ------------
 .../test/scala/other/kafka/TestKafkaAppender.scala |  1 -
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |  1 -
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  6 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |  1 -
 .../scala/unit/kafka/integration/FetcherTest.scala |  4 +-
 .../kafka/integration/LazyInitProducerTest.scala   |  2 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  1 -
 .../integration/ProducerConsumerTestHarness.scala  |  6 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  2 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |  2 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  3 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    | 65 ++++++++++++-------
 .../scala/unit/kafka/producer/ProducerTest.scala   |  5 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  2 -
 .../unit/kafka/server/ServerShutdownTest.scala     |  7 +--
 .../test/scala/unit/kafka/utils/ClientIdTest.scala | 61 ++++++++++++++++++
 .../java/kafka/examples/SimpleConsumerDemo.java    |  3 +-
 .../kafka/perf/SimpleConsumerPerformance.scala     |  2 +-
 63 files changed, 441 insertions(+), 311 deletions(-)
e556063520193c8065d7f8e39153d23dae8cf8b8

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)
7b2d9c33126f21efa06d2b2f9f275c66fbaac078

 bin/kafka-producer-shell.sh                        | 17 ------
 .../src/main/scala/kafka/tools/ProducerShell.scala | 71 ----------------------
 2 files changed, 88 deletions(-)
bdb04bba67326bdf1451df3ec4a855ed3c109869

 core/src/main/scala/kafka/api/ProducerRequest.scala                | 6 +++---
 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 6 +-----
 core/src/test/scala/unit/kafka/producer/SyncProducerTest.scala     | 2 +-
 3 files changed, 5 insertions(+), 9 deletions(-)
99a98bf487846c0ecc9cc22132de91e113027971
f9e2a01f487b0c51c91944a86a6208170931cdb6
491b37d79352422a6fe522838458084df51e4376
469e36de39ce5162f80d9c459b31a46801403758
941d404b79fc38834d65de87db4105121d14ee92
bccb189be9e430158d091fb4c63c546b4503d416
b559b3b82827164734f674efafbd96329ff0ed47
62ff81c31d4cff05465436f947a0ad881ddacff5
d45f2fe06c223f5c3e2e2b0d3968584c97f313f1
b7470a8f64279806192bf172c61b178ba3b7a14d
0314c8b70ec848cf4719e5ff5b7270bf3211f9fb
0e7b5cfdd931e69daaadfb174f3e43274a1c2d7f
12fc9225fbf00963a093fa5321e6e23f96d98c5d
3d93852fda00437d71ab05c06b374adac640451a
a475d7c4348a206c759720fcf3117a58571260bf

 .gitignore                                         |  14 +
 .rat-excludes                                      |  26 +
 DISCLAIMER                                         |  15 +
 LICENSE                                            | 233 ++++++
 NOTICE                                             |   5 +
 README.md                                          |  56 ++
 bin/kafka-console-consumer-log4j.properties        |  21 +
 bin/kafka-console-consumer.sh                      |  19 +
 bin/kafka-console-producer.sh                      |  18 +
 bin/kafka-consumer-perf-test.sh                    |  17 +
 bin/kafka-consumer-shell.sh                        |  17 +
 bin/kafka-producer-perf-test.sh                    |  17 +
 bin/kafka-producer-shell.sh                        |  17 +
 bin/kafka-replay-log-producer.sh                   |  19 +
 bin/kafka-run-class.sh                             |  66 ++
 bin/kafka-server-start.sh                          |  25 +
 bin/kafka-server-stop.sh                           |  16 +
 bin/kafka-simple-consumer-perf-test.sh             |  17 +
 bin/kafka-simple-consumer-shell.sh                 |  17 +
 bin/run-rat.sh                                     |  35 +
 bin/zookeeper-server-start.sh                      |  23 +
 bin/zookeeper-server-stop.sh                       |  16 +
 bin/zookeeper-shell.sh                             |  23 +
 config/consumer.properties                         |  29 +
 config/log4j.properties                            |  30 +
 config/producer.properties                         |  80 ++
 config/server.properties                           | 116 +++
 config/zookeeper.properties                        |  20 +
 contrib/hadoop-consumer/LICENSE                    | 203 +++++
 contrib/hadoop-consumer/README                     |  66 ++
 contrib/hadoop-consumer/copy-jars.sh               |  69 ++
 contrib/hadoop-consumer/hadoop-setup.sh            |  20 +
 contrib/hadoop-consumer/lib/piggybank.jar          | Bin 0 -> 308044 bytes
 contrib/hadoop-consumer/run-class.sh               |  65 ++
 .../src/main/java/kafka/etl/KafkaETLContext.java   | 286 +++++++
 .../main/java/kafka/etl/KafkaETLInputFormat.java   |  78 ++
 .../src/main/java/kafka/etl/KafkaETLJob.java       | 172 +++++
 .../src/main/java/kafka/etl/KafkaETLKey.java       | 104 +++
 .../main/java/kafka/etl/KafkaETLRecordReader.java  | 180 +++++
 .../src/main/java/kafka/etl/KafkaETLRequest.java   | 128 ++++
 .../src/main/java/kafka/etl/KafkaETLUtils.java     | 205 +++++
 .../src/main/java/kafka/etl/Props.java             | 461 +++++++++++
 .../java/kafka/etl/UndefinedPropertyException.java |  28 +
 .../main/java/kafka/etl/impl/DataGenerator.java    | 134 ++++
 .../java/kafka/etl/impl/SimpleKafkaETLJob.java     | 104 +++
 .../java/kafka/etl/impl/SimpleKafkaETLMapper.java  |  88 +++
 contrib/hadoop-consumer/test/test.properties       |  42 +
 contrib/hadoop-producer/LICENSE                    | 203 +++++
 contrib/hadoop-producer/README.md                  | 147 ++++
 contrib/hadoop-producer/lib/piggybank.jar          | Bin 0 -> 308044 bytes
 .../java/kafka/bridge/examples/TextPublisher.java  |  68 ++
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     | 173 +++++
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |  74 ++
 .../java/kafka/bridge/pig/AvroKafkaStorage.java    | 117 +++
 core/src/main/scala/kafka/Kafka.scala              |  55 ++
 core/src/main/scala/kafka/api/FetchRequest.scala   |  51 ++
 .../main/scala/kafka/api/MultiFetchRequest.scala   |  58 ++
 .../main/scala/kafka/api/MultiFetchResponse.scala  |  52 ++
 .../scala/kafka/api/MultiProducerRequest.scala     |  57 ++
 core/src/main/scala/kafka/api/OffsetRequest.scala  | 100 +++
 .../src/main/scala/kafka/api/ProducerRequest.scala |  83 ++
 core/src/main/scala/kafka/api/RequestKeys.scala    |  26 +
 core/src/main/scala/kafka/cluster/Broker.scala     |  48 ++
 core/src/main/scala/kafka/cluster/Cluster.scala    |  45 ++
 core/src/main/scala/kafka/cluster/Partition.scala  |  57 ++
 .../common/ConsumerReblanceFailedException.scala   |  26 +
 .../src/main/scala/kafka/common/ErrorMapping.scala |  61 ++
 .../kafka/common/InvalidConfigException.scala      |  25 +
 .../kafka/common/InvalidMessageSizeException.scala |  26 +
 .../kafka/common/InvalidPartitionException.scala   |  24 +
 .../common/NoBrokersForPartitionException.scala    |  26 +
 .../kafka/common/OffsetOutOfRangeException.scala   |  26 +
 .../common/UnavailableProducerException.scala      |  24 +
 .../scala/kafka/common/UnknownCodecException.scala |  26 +
 .../main/scala/kafka/common/UnknownException.scala |  23 +
 .../kafka/common/UnknownMagicByteException.scala   |  26 +
 .../scala/kafka/consumer/ConsoleConsumer.scala     | 249 ++++++
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  98 +++
 .../scala/kafka/consumer/ConsumerConnector.scala   |  92 +++
 .../scala/kafka/consumer/ConsumerIterator.scala    | 100 +++
 .../scala/kafka/consumer/ConsumerTopicStat.scala   |  60 ++
 .../scala/kafka/consumer/FetchedDataChunk.scala    |  24 +
 core/src/main/scala/kafka/consumer/Fetcher.scala   |  95 +++
 .../scala/kafka/consumer/FetcherRunnable.scala     | 141 ++++
 .../main/scala/kafka/consumer/KafkaStream.scala    |  47 ++
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  81 ++
 .../main/scala/kafka/consumer/SimpleConsumer.scala | 226 ++++++
 .../src/main/scala/kafka/consumer/TopicCount.scala | 176 +++++
 .../scala/kafka/consumer/TopicEventHandler.scala   |  24 +
 .../main/scala/kafka/consumer/TopicFilter.scala    |  76 ++
 .../consumer/ZookeeperConsumerConnector.scala      | 808 ++++++++++++++++++++
 .../consumer/ZookeeperTopicEventWatcher.scala      | 105 +++
 core/src/main/scala/kafka/consumer/package.html    |   1 +
 .../consumer/storage/MemoryOffsetStorage.scala     |  44 ++
 .../kafka/consumer/storage/OffsetStorage.scala     |  40 +
 .../consumer/storage/OracleOffsetStorage.scala     | 155 ++++
 core/src/main/scala/kafka/javaapi/Implicits.scala  | 123 +++
 .../scala/kafka/javaapi/MultiFetchResponse.scala   |  45 ++
 .../main/scala/kafka/javaapi/ProducerRequest.scala |  52 ++
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  69 ++
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |  71 ++
 .../consumer/ZookeeperConsumerConnector.scala      | 109 +++
 .../javaapi/message/ByteBufferMessageSet.scala     |  79 ++
 .../scala/kafka/javaapi/message/MessageSet.scala   |  55 ++
 .../scala/kafka/javaapi/producer/Producer.scala    | 122 +++
 .../kafka/javaapi/producer/ProducerData.scala      |  34 +
 .../kafka/javaapi/producer/SyncProducer.scala      |  48 ++
 .../javaapi/producer/async/CallbackHandler.java    |  77 ++
 .../kafka/javaapi/producer/async/EventHandler.java |  48 ++
 core/src/main/scala/kafka/log/Log.scala            | 412 ++++++++++
 core/src/main/scala/kafka/log/LogManager.scala     | 357 +++++++++
 core/src/main/scala/kafka/log/LogStats.scala       |  44 ++
 core/src/main/scala/kafka/log/SegmentList.scala    |  86 +++
 core/src/main/scala/kafka/log/package.html         |   1 +
 .../message/ByteBufferBackedInputStream.scala      |  42 +
 .../scala/kafka/message/ByteBufferMessageSet.scala | 203 +++++
 .../scala/kafka/message/CompressionCodec.scala     |  39 +
 .../scala/kafka/message/CompressionUtils.scala     | 160 ++++
 .../main/scala/kafka/message/FileMessageSet.scala  | 280 +++++++
 .../kafka/message/InvalidMessageException.scala    |  25 +
 core/src/main/scala/kafka/message/Message.scala    | 180 +++++
 .../scala/kafka/message/MessageAndMetadata.scala   |  21 +
 .../scala/kafka/message/MessageAndOffset.scala     |  22 +
 .../kafka/message/MessageLengthException.scala     |  24 +
 core/src/main/scala/kafka/message/MessageSet.scala | 114 +++
 core/src/main/scala/kafka/message/package.html     |   1 +
 .../kafka/network/BoundedByteBufferReceive.scala   |  92 +++
 .../kafka/network/BoundedByteBufferSend.scala      |  56 ++
 .../main/scala/kafka/network/ByteBufferSend.scala  |  40 +
 .../scala/kafka/network/ConnectionConfig.scala     |  27 +
 core/src/main/scala/kafka/network/Handler.scala    |  33 +
 .../kafka/network/InvalidRequestException.scala    |  24 +
 core/src/main/scala/kafka/network/Request.scala    |  28 +
 .../main/scala/kafka/network/SocketServer.scala    | 354 +++++++++
 .../scala/kafka/network/SocketServerStats.scala    |  90 +++
 .../main/scala/kafka/network/Transmission.scala    | 107 +++
 core/src/main/scala/kafka/network/package.html     |  11 +
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  59 ++
 .../kafka/producer/ConfigBrokerPartitionInfo.scala |  96 +++
 .../scala/kafka/producer/ConsoleProducer.scala     | 144 ++++
 .../scala/kafka/producer/DefaultPartitioner.scala  |  29 +
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  94 +++
 .../main/scala/kafka/producer/Partitioner.scala    |  26 +
 core/src/main/scala/kafka/producer/Producer.scala  | 213 ++++++
 .../main/scala/kafka/producer/ProducerConfig.scala |  89 +++
 .../main/scala/kafka/producer/ProducerData.scala   |  39 +
 .../main/scala/kafka/producer/ProducerPool.scala   | 179 +++++
 .../main/scala/kafka/producer/SyncProducer.scala   | 229 ++++++
 .../scala/kafka/producer/SyncProducerConfig.scala  |  47 ++
 .../kafka/producer/ZKBrokerPartitionInfo.scala     | 380 ++++++++++
 .../scala/kafka/producer/async/AsyncProducer.scala | 144 ++++
 .../kafka/producer/async/AsyncProducerConfig.scala |  61 ++
 .../async/AsyncProducerInterruptedException.scala  |  23 +
 .../kafka/producer/async/AsyncProducerStats.scala  |  50 ++
 .../producer/async/AsyncProducerStatsMBean.scala   |  27 +
 .../kafka/producer/async/CallbackHandler.scala     |  75 ++
 .../kafka/producer/async/DefaultEventHandler.scala | 133 ++++
 .../scala/kafka/producer/async/EventHandler.scala  |  45 ++
 .../async/IllegalQueueStateException.scala         |  25 +
 .../producer/async/MissingConfigException.scala    |  23 +
 .../kafka/producer/async/ProducerSendThread.scala  | 129 ++++
 .../producer/async/QueueClosedException.scala      |  23 +
 .../kafka/producer/async/QueueFullException.scala  |  23 +
 core/src/main/scala/kafka/serializer/Decoder.scala |  37 +
 core/src/main/scala/kafka/serializer/Encoder.scala |  32 +
 core/src/main/scala/kafka/server/KafkaConfig.scala | 108 +++
 .../scala/kafka/server/KafkaRequestHandlers.scala  | 194 +++++
 core/src/main/scala/kafka/server/KafkaServer.scala | 116 +++
 .../scala/kafka/server/KafkaServerStartable.scala  |  59 ++
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 117 +++
 .../main/scala/kafka/server/MessageSetSend.scala   |  71 ++
 .../scala/kafka/server/MultiMessageSetSend.scala   |  36 +
 core/src/main/scala/kafka/server/package.html      |   1 +
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 162 ++++
 .../src/main/scala/kafka/tools/ConsumerShell.scala | 108 +++
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  53 ++
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 123 +++
 .../main/scala/kafka/tools/GetOffsetShell.scala    |  73 ++
 .../main/scala/kafka/tools/ImportZkOffsets.scala   | 112 +++
 core/src/main/scala/kafka/tools/JmxTool.scala      | 110 +++
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 171 +++++
 .../src/main/scala/kafka/tools/ProducerShell.scala |  71 ++
 .../main/scala/kafka/tools/ReplayLogProducer.scala | 209 +++++
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 113 +++
 .../kafka/tools/VerifyConsumerRebalance.scala      | 135 ++++
 core/src/main/scala/kafka/utils/Annotations.scala  |  36 +
 core/src/main/scala/kafka/utils/DelayedItem.scala  |  49 ++
 .../main/scala/kafka/utils/IteratorTemplate.scala  |  80 ++
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  51 ++
 .../main/scala/kafka/utils/Log4jController.scala   |  98 +++
 core/src/main/scala/kafka/utils/Logging.scala      | 101 +++
 core/src/main/scala/kafka/utils/MockTime.scala     |  34 +
 core/src/main/scala/kafka/utils/Mx4jLoader.scala   |  72 ++
 core/src/main/scala/kafka/utils/Pool.scala         |  66 ++
 core/src/main/scala/kafka/utils/Range.scala        |  42 +
 core/src/main/scala/kafka/utils/Throttler.scala    |  79 ++
 core/src/main/scala/kafka/utils/Time.scala         |  61 ++
 .../scala/kafka/utils/TopicNameValidator.scala     |  41 +
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |  79 ++
 core/src/main/scala/kafka/utils/Utils.scala        | 841 +++++++++++++++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 312 ++++++++
 core/src/main/scala/kafka/utils/package.html       |   1 +
 core/src/test/resources/log4j.properties           |  25 +
 .../MagicByte0-0/00000000000000000000.kafka        | Bin 0 -> 10900 bytes
 core/src/test/scala/other/kafka.log4j.properties   |  22 +
 core/src/test/scala/other/kafka/DeleteZKPath.scala |  45 ++
 .../test/scala/other/kafka/TestKafkaAppender.scala |  50 ++
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  76 ++
 .../scala/other/kafka/TestLogPerformance.scala     |  56 ++
 core/src/test/scala/other/kafka/TestTruncate.scala |  39 +
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |  74 ++
 .../unit/kafka/consumer/TopicFilterTest.scala      |  51 ++
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 288 +++++++
 .../kafka/integration/AutoOffsetResetTest.scala    | 223 ++++++
 .../integration/BackwardsCompatibilityTest.scala   |  76 ++
 .../scala/unit/kafka/integration/FetcherTest.scala | 107 +++
 .../kafka/integration/KafkaServerTestHarness.scala |  45 ++
 .../kafka/integration/LazyInitProducerTest.scala   | 185 +++++
 .../unit/kafka/integration/LogCorruptionTest.scala | 111 +++
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 271 +++++++
 .../integration/ProducerConsumerTestHarness.scala  |  52 ++
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 124 +++
 .../javaapi/integration/PrimitiveApiTest.scala     | 417 ++++++++++
 .../integration/ProducerConsumerTestHarness.scala  |  53 ++
 .../javaapi/message/BaseMessageSetTestCases.scala  |  74 ++
 .../javaapi/message/ByteBufferMessageSetTest.scala |  86 +++
 .../unit/kafka/javaapi/producer/ProducerTest.scala | 633 ++++++++++++++++
 .../kafka/javaapi/producer/SyncProducerTest.scala  |  98 +++
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 233 ++++++
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  | 215 ++++++
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 299 ++++++++
 .../scala/unit/kafka/log/SegmentListTest.scala     |  58 ++
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 254 +++++++
 .../kafka/message/BaseMessageSetTestCases.scala    |  69 ++
 .../kafka/message/ByteBufferMessageSetTest.scala   | 162 ++++
 .../unit/kafka/message/CompressionUtilsTest.scala  |  75 ++
 .../unit/kafka/message/FileMessageSetTest.scala    |  84 ++
 .../scala/unit/kafka/message/MessageTest.scala     |  70 ++
 .../unit/kafka/network/SocketServerTest.scala      |  79 ++
 .../unit/kafka/producer/AsyncProducerTest.scala    | 319 ++++++++
 .../unit/kafka/producer/ProducerMethodsTest.scala  |  57 ++
 .../scala/unit/kafka/producer/ProducerTest.scala   | 702 +++++++++++++++++
 .../unit/kafka/producer/SyncProducerTest.scala     | 134 ++++
 .../unit/kafka/server/ServerShutdownTest.scala     | 122 +++
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 308 ++++++++
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  54 ++
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  40 +
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  57 ++
 .../scala/unit/kafka/zk/ZKLoadBalanceTest.scala    | 127 ++++
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  42 +
 examples/README                                    |  19 +
 examples/bin/java-producer-consumer-demo.sh        |  59 ++
 examples/bin/java-simple-consumer-demo.sh          |  59 ++
 .../src/main/java/kafka/examples/Consumer.java     |  65 ++
 .../src/main/java/kafka/examples/ExampleUtils.java |  32 +
 .../kafka/examples/KafkaConsumerProducerDemo.java  |  30 +
 .../main/java/kafka/examples/KafkaProperties.java  |  31 +
 .../src/main/java/kafka/examples/Producer.java     |  50 ++
 .../java/kafka/examples/SimpleConsumerDemo.java    |  83 ++
 lib/sbt-launch.jar                                 | Bin 0 -> 920993 bytes
 perf/config/log4j.properties                       |  24 +
 .../scala/kafka/perf/ConsumerPerformance.scala     | 196 +++++
 perf/src/main/scala/kafka/perf/PerfConfig.scala    |  48 ++
 .../scala/kafka/perf/ProducerPerformance.scala     | 237 ++++++
 .../kafka/perf/SimpleConsumerPerformance.scala     | 141 ++++
 project/build.properties                           |  24 +
 project/build/KafkaProject.scala                   | 249 ++++++
 project/plugins/Plugins.scala                      |  23 +
 sbt                                                |  16 +
 system_test/broker_failure/README                  |  72 ++
 system_test/broker_failure/bin/kafka-run-class.sh  |  67 ++
 system_test/broker_failure/bin/run-test.sh         | 823 ++++++++++++++++++++
 system_test/broker_failure/config/log4j.properties |  86 +++
 .../config/mirror_producer.properties              |  27 +
 .../config/mirror_producer1.properties             |  28 +
 .../config/mirror_producer2.properties             |  28 +
 .../config/mirror_producer3.properties             |  28 +
 .../config/server_source1.properties               |  81 ++
 .../config/server_source2.properties               |  82 ++
 .../config/server_source3.properties               |  82 ++
 .../config/server_source4.properties               |  82 ++
 .../config/server_target1.properties               |  85 +++
 .../config/server_target2.properties               |  85 +++
 .../config/server_target3.properties               |  85 +++
 .../config/whitelisttest.consumer.properties       |  29 +
 .../config/zookeeper_source.properties             |  18 +
 .../config/zookeeper_target.properties             |  18 +
 system_test/common/util.sh                         | 182 +++++
 system_test/mirror_maker/README                    |  22 +
 system_test/mirror_maker/bin/expected.out          |  18 +
 system_test/mirror_maker/bin/run-test.sh           | 357 +++++++++
 .../config/blacklisttest.consumer.properties       |  28 +
 .../mirror_maker/config/mirror_producer.properties |  30 +
 .../config/server_source_1_1.properties            |  76 ++
 .../config/server_source_1_2.properties            |  76 ++
 .../config/server_source_2_1.properties            |  76 ++
 .../config/server_source_2_2.properties            |  76 ++
 .../config/server_target_1_1.properties            |  78 ++
 .../config/server_target_1_2.properties            |  78 ++
 .../config/whitelisttest_1.consumer.properties     |  28 +
 .../config/whitelisttest_2.consumer.properties     |  28 +
 .../config/zookeeper_source_1.properties           |  18 +
 .../config/zookeeper_source_2.properties           |  18 +
 .../config/zookeeper_target.properties             |  18 +
 system_test/producer_perf/README                   |   9 +
 system_test/producer_perf/bin/expected.out         |  32 +
 .../producer_perf/bin/run-compression-test.sh      |  62 ++
 system_test/producer_perf/bin/run-test.sh          |  62 ++
 system_test/producer_perf/config/server.properties |  78 ++
 .../producer_perf/config/zookeeper.properties      |  18 +
 310 files changed, 29774 insertions(+)
45ba1019cb007c9876b2392577a4db7a9ab5dba8
961affa3fcf2721fc80883f4710bb1a92bb18b17
6e6522c7c96c15007a69eba24ea0db8ec16fb978

 .../scala/kafka/consumer/ConsoleConsumer.scala     | 23 +++++++-
 .../scala/kafka/producer/ConsoleProducer.scala     | 68 +++++++++++++++++-----
 .../kafka/producer/async/ProducerSendThread.scala  |  6 +-
 core/src/main/scala/kafka/serializer/Decoder.scala |  7 ---
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  2 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  2 +-
 6 files changed, 79 insertions(+), 29 deletions(-)
3f432cd01c4728396f277e33897f6f898c530c99
c6009bc4f538775d76a3699430949fdec1a3a137
602acaf412f924ab139c731d629b9b129301d20b

 .../kafka/consumer/ConsumerFetcherManager.scala    |  3 +
 .../kafka/server/AbstractFetcherManager.scala      | 21 ++++--
 .../scala/kafka/server/AbstractFetcherThread.scala | 75 ++++++++++++++--------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  2 +
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +
 5 files changed, 71 insertions(+), 32 deletions(-)
8e7b0d40169f93710d08ee36e53b4a16c1d3a344

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  60 ++++---
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |  20 ++-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  12 +-
 .../main/scala/kafka/api/StopReplicaResponse.scala |  22 ++-
 core/src/main/scala/kafka/cluster/Partition.scala  |  26 ++-
 .../kafka/common/ControllerMovedException.scala    |  23 +++
 .../src/main/scala/kafka/common/ErrorMapping.scala |   4 +-
 .../controller/ControllerChannelManager.scala      |  16 +-
 .../scala/kafka/controller/KafkaController.scala   | 185 ++++++++++++++++-----
 .../kafka/controller/PartitionLeaderSelector.scala |   2 +-
 .../kafka/controller/PartitionStateMachine.scala   |  50 ++++--
 .../kafka/controller/ReplicaStateMachine.scala     |  36 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |  14 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  93 ++++++-----
 .../kafka/server/ZookeeperLeaderElector.scala      |  22 ++-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  52 +++++-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   4 +-
 .../api/RequestResponseSerializationTest.scala     |  11 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |   2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  52 ++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   6 +-
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |   4 +-
 22 files changed, 512 insertions(+), 204 deletions(-)
79d3be92932bbe0222c6cf61add639eeb676063f

 .../kafka/consumer/ConsumerFetcherManager.scala    | 26 ++++++----------------
 .../kafka/consumer/ConsumerFetcherThread.scala     |  5 +++--
 .../scala/kafka/server/AbstractFetcherThread.scala |  2 +-
 3 files changed, 11 insertions(+), 22 deletions(-)
39edb7beea33bc0075c15f88183764f8515e1874

 core/src/main/scala/kafka/tools/KafkaMigrationTool.java | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
92d64170bbae8b1d44c55c61181de2451f0bf5de

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
8c884ee6a6433745e68febdc68f0b22520a7e335

 .../kafka/javaapi/producer/ProducerData.scala      | 36 ----------------------
 .../main/scala/kafka/tools/KafkaMigrationTool.java |  5 ++-
 2 files changed, 2 insertions(+), 39 deletions(-)
e13ecfc1df8966c91384e9c7787f9026b0c500ab

 .../replication_testsuite/replica_basic_test.py    |  34 ++++--
 .../testcase_0151/testcase_0151_properties.json    |   2 +-
 .../testcase_0152/testcase_0152_properties.json    |   2 +-
 .../testcase_0153/testcase_0153_properties.json    |   2 +-
 .../testcase_0154/testcase_0154_properties.json    |   2 +-
 .../testcase_0155/testcase_0155_properties.json    |   2 +-
 .../testcase_0156/testcase_0156_properties.json    |   2 +-
 .../testcase_0157/testcase_0157_properties.json    |   2 +-
 .../testcase_0158/testcase_0158_properties.json    |   2 +-
 .../testcase_9051/cluster_config.json              | 107 +++++++++++++++++
 .../testcase_9051/testcase_9051_properties.json    | 129 +++++++++++++++++++++
 system_test/testcase_to_run_all.json               |   4 +-
 system_test/utils/kafka_system_test_utils.py       | 107 +++++++++++++----
 13 files changed, 357 insertions(+), 40 deletions(-)
125548274a414355bb1241695e7593cc0ddc7b5b

 core/src/main/scala/kafka/server/KafkaConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
60d0587e8fca7197683b55e00537c32ddee4795d

 core/src/main/scala/kafka/log/Log.scala            |  3 +
 core/src/main/scala/kafka/log/LogSegment.scala     |  6 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  3 +
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  2 +-
 .../scala/other/kafka/TestEndToEndLatency.scala    |  2 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   | 96 +++++++++++++++++++---
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  4 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |  2 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  2 +-
 .../server/HighwatermarkPersistenceTest.scala      |  4 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  1 -
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  2 +-
 .../src/main/java/kafka/examples/ExampleUtils.java | 32 --------
 perf/src/main/scala/kafka/perf/PerfConfig.scala    | 16 ++++
 .../scala/kafka/perf/ProducerPerformance.scala     | 28 ++++---
 16 files changed, 136 insertions(+), 69 deletions(-)
f4ccf21d5d65ae313b2a400eb831df6d2d3daa67

 .../main/java/kafka/etl/impl/DataGenerator.java    |   9 +-
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |   6 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  38 +----
 .../scala/kafka/consumer/ConsumerConnector.scala   |  37 +++--
 .../scala/kafka/consumer/ConsumerIterator.scala    |  24 +--
 .../main/scala/kafka/consumer/KafkaStream.scala    |  17 ++-
 .../consumer/ZookeeperConsumerConnector.scala      |  59 +++++---
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  24 +--
 .../consumer/ZookeeperConsumerConnector.scala      |  43 +++---
 .../scala/kafka/javaapi/producer/Producer.scala    |  12 +-
 .../scala/kafka/message/MessageAndMetadata.scala   |   2 +-
 .../main/scala/kafka/network/BlockingChannel.scala |   8 +
 .../scala/kafka/producer/ConsoleProducer.scala     |   2 +-
 .../scala/kafka/producer/DefaultPartitioner.scala  |   4 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |   3 +-
 .../main/scala/kafka/producer/KeyedMessage.scala   |  30 ++++
 .../main/scala/kafka/producer/Partitioner.scala    |   7 +
 core/src/main/scala/kafka/producer/Producer.scala  |  48 +++---
 .../main/scala/kafka/producer/ProducerData.scala   |  41 ------
 .../kafka/producer/async/AsyncProducerConfig.scala |   6 +-
 .../kafka/producer/async/DefaultEventHandler.scala | 123 ++++++++--------
 .../scala/kafka/producer/async/EventHandler.scala  |   4 +-
 .../kafka/producer/async/ProducerSendThread.scala  |  37 ++---
 core/src/main/scala/kafka/serializer/Decoder.scala |  43 ++++--
 core/src/main/scala/kafka/serializer/Encoder.scala |  40 ++++-
 .../main/scala/kafka/tools/KafkaMigrationTool.java |   4 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |  26 ++--
 .../src/main/scala/kafka/tools/ProducerShell.scala |   2 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   8 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |   6 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  36 ++---
 .../scala/other/kafka/TestEndToEndLatency.scala    |   2 +-
 .../test/scala/other/kafka/TestKafkaAppender.scala |   4 +-
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |   4 +-
 .../unit/kafka/consumer/ConsumerIteratorTest.scala |  28 ++--
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 164 +++++++++------------
 .../kafka/integration/AutoOffsetResetTest.scala    |   8 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  11 +-
 .../kafka/integration/LazyInitProducerTest.scala   |  43 +++---
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  68 ++++-----
 .../integration/ProducerConsumerTestHarness.scala  |   4 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  50 ++++---
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |   7 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    | 115 ++++++++-------
 .../scala/unit/kafka/producer/ProducerTest.scala   |  26 ++--
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  51 ++-----
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  10 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |  19 ++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  30 ++--
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  10 ++
 .../src/main/java/kafka/examples/Consumer.java     |   8 +-
 .../src/main/java/kafka/examples/Producer.java     |   4 +-
 .../java/kafka/examples/SimpleConsumerDemo.java    |  14 +-
 .../scala/kafka/perf/ConsumerPerformance.scala     |   6 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |  19 ++-
 55 files changed, 755 insertions(+), 699 deletions(-)
22e032fdd4f8fd8dff5c4b77c61834b4f7561980

 .../scala/kafka/controller/KafkaController.scala   | 139 ++++++++++-----------
 .../kafka/controller/PartitionLeaderSelector.scala |   2 +-
 .../kafka/controller/PartitionStateMachine.scala   |  38 +++---
 .../kafka/controller/ReplicaStateMachine.scala     |  27 ++--
 4 files changed, 98 insertions(+), 108 deletions(-)
6c97767b88de625ea5101999ace7fb78744b75b5

 config/server.properties                           |   5 +++--
 core/lib/metrics-annotation-3.0.0-c0c8be71.jar     | Bin 0 -> 4766 bytes
 core/lib/metrics-annotation-3.0.1.jar              | Bin 4762 -> 0 bytes
 core/lib/metrics-core-3.0.0-c0c8be71.jar           | Bin 0 -> 81782 bytes
 core/lib/metrics-core-3.0.1.jar                    | Bin 81781 -> 0 bytes
 core/src/main/scala/kafka/Kafka.scala              |   6 ++---
 .../scala/kafka/consumer/ConsoleConsumer.scala     |   4 ++--
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |  24 ++------------------
 .../scala/kafka/metrics/KafkaMetricsReporter.scala |  25 ++++++++++++++++++++-
 core/src/main/scala/kafka/producer/Producer.scala  |   2 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |   4 ++--
 project/build/KafkaProject.scala                   |   4 ++--
 system_test/testcase_to_run.json                   |   3 +--
 14 files changed, 41 insertions(+), 38 deletions(-)
1cc8c3beab1cf42d8f6d3216af081b767761693c

 .../migration_tool_test.py                         |  64 ++--
 .../testcase_9001/testcase_9001_properties.json    |   2 +-
 .../testcase_9003/cluster_config.json              | 112 ++++++
 .../testcase_9003/testcase_9003_properties.json    | 136 +++++++
 .../testcase_9004/cluster_config.json              | 112 ++++++
 .../testcase_9004/testcase_9004_properties.json    | 136 +++++++
 .../testcase_9005/cluster_config.json              | 141 ++++++++
 .../testcase_9005/testcase_9005_properties.json    | 167 +++++++++
 .../testcase_9006/cluster_config.json              | 141 ++++++++
 .../testcase_9006/testcase_9006_properties.json    | 167 +++++++++
 .../mirror_maker_testsuite/mirror_maker_test.py    |  22 +-
 .../testcase_5003/cluster_config.json              | 135 +++++++
 .../testcase_5003/testcase_5003_properties.json    | 143 ++++++++
 .../testcase_5004/cluster_config.json              | 135 +++++++
 .../testcase_5004/testcase_5004_properties.json    | 143 ++++++++
 .../testcase_5005/cluster_config.json              | 153 ++++++++
 .../testcase_5005/testcase_5005_properties.json    | 164 +++++++++
 .../testcase_5006/cluster_config.json              | 153 ++++++++
 .../testcase_5006/testcase_5006_properties.json    | 164 +++++++++
 .../replication_testsuite/replica_basic_test.py    | 193 ++++++----
 .../testcase_0124/cluster_config.json              |  76 ++++
 .../testcase_0124/testcase_0124_properties.json    | 102 ++++++
 .../testcase_0125/cluster_config.json              |  76 ++++
 .../testcase_0125/testcase_0125_properties.json    | 102 ++++++
 .../testcase_0126/cluster_config.json              |  76 ++++
 .../testcase_0126/testcase_0126_properties.json    | 102 ++++++
 .../testcase_0127/cluster_config.json              |  76 ++++
 .../testcase_0127/testcase_0127_properties.json    | 102 ++++++
 .../testcase_0131/cluster_config.json              |  76 ++++
 .../testcase_0131/testcase_0131_properties.json    | 101 ++++++
 .../testcase_0132/cluster_config.json              |  76 ++++
 .../testcase_0132/testcase_0132_properties.json    |  98 ++++++
 .../testcase_0133/cluster_config.json              |  76 ++++
 .../testcase_0133/testcase_0133_properties.json    |  98 ++++++
 .../testcase_0153/testcase_0153_properties.json    |   1 +
 .../testcase_0154/testcase_0154_properties.json    |   1 +
 .../testcase_0157/testcase_0157_properties.json    |   1 +
 .../testcase_0158/testcase_0158_properties.json    |   1 +
 .../testcase_4001/cluster_config.json              |  76 ++++
 .../testcase_4001/testcase_4001_properties.json    | 103 ++++++
 .../testcase_4002/cluster_config.json              |  76 ++++
 .../testcase_4002/testcase_4002_properties.json    | 103 ++++++
 .../testcase_4003/cluster_config.json              |  76 ++++
 .../testcase_4003/testcase_4003_properties.json    | 103 ++++++
 .../testcase_4004/cluster_config.json              |  76 ++++
 .../testcase_4004/testcase_4004_properties.json    | 103 ++++++
 .../testcase_4005/cluster_config.json              |  76 ++++
 .../testcase_4005/testcase_4005_properties.json    | 103 ++++++
 .../testcase_4006/cluster_config.json              |  76 ++++
 .../testcase_4006/testcase_4006_properties.json    | 103 ++++++
 .../testcase_4007/cluster_config.json              |  76 ++++
 .../testcase_4007/testcase_4007_properties.json    | 103 ++++++
 .../testcase_4008/cluster_config.json              |  76 ++++
 .../testcase_4008/testcase_4008_properties.json    | 103 ++++++
 .../testcase_4011/cluster_config.json              |  76 ++++
 .../testcase_4011/testcase_4011_properties.json    | 103 ++++++
 .../testcase_4012/cluster_config.json              |  76 ++++
 .../testcase_4012/testcase_4012_properties.json    | 103 ++++++
 .../testcase_4013/cluster_config.json              |  76 ++++
 .../testcase_4013/testcase_4013_properties.json    | 103 ++++++
 .../testcase_4014/cluster_config.json              |  76 ++++
 .../testcase_4014/testcase_4014_properties.json    | 103 ++++++
 .../testcase_4015/cluster_config.json              |  76 ++++
 .../testcase_4015/testcase_4015_properties.json    | 103 ++++++
 .../testcase_4016/cluster_config.json              |  76 ++++
 .../testcase_4016/testcase_4016_properties.json    | 103 ++++++
 .../testcase_4017/cluster_config.json              |  76 ++++
 .../testcase_4017/testcase_4017_properties.json    | 103 ++++++
 .../testcase_4018/cluster_config.json              |  76 ++++
 .../testcase_4018/testcase_4018_properties.json    | 103 ++++++
 system_test/testcase_to_run_all.json               |  40 ++-
 system_test/utils/kafka_system_test_utils.py       | 392 ++++++++++++++++-----
 system_test/utils/testcase_env.py                  |   6 +
 73 files changed, 6918 insertions(+), 208 deletions(-)
6800b0ed3b2519952c3253023c4fda06627bc1e0

 .../scala/kafka/consumer/ConsumerIterator.scala    | 24 ++++--
 core/src/main/scala/kafka/log/LogManager.scala     |  2 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |  6 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  1 -
 .../unit/kafka/consumer/ConsumerIteratorTest.scala | 88 ++++++++++++++++++++++
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  2 -
 .../server/HighwatermarkPersistenceTest.scala      |  2 +-
 7 files changed, 110 insertions(+), 15 deletions(-)
ed6243852af125c0399b9ceae817f863043b2373

 core/src/main/scala/kafka/log/Log.scala          | 10 ++++++++-
 core/src/main/scala/kafka/log/LogSegment.scala   |  4 +++-
 core/src/main/scala/kafka/log/OffsetIndex.scala  | 22 +++++++++++++-------
 core/src/test/scala/unit/kafka/log/LogTest.scala | 26 +++++++++++++++++++++++-
 4 files changed, 52 insertions(+), 10 deletions(-)
f54f481873b9fe8f5675ef5a1faf823aa590697a

 .../main/scala/kafka/tools/DumpLogSegments.scala   | 85 ++++++++++++++++++++--
 1 file changed, 77 insertions(+), 8 deletions(-)
989c9bfbab5838525783a0cb3ca48c5db4939c85

 core/src/main/scala/kafka/log/LogSegment.scala | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)
75fc5eab35aa33cffd9c09a2070dfe287db0ef4e

 core/src/main/scala/kafka/cluster/Partition.scala  |   5 +-
 core/src/main/scala/kafka/log/LogManager.scala     | 266 +++++++++++++--------
 .../kafka/server/HighwaterMarkCheckpoint.scala     |  29 +--
 core/src/main/scala/kafka/server/KafkaConfig.scala |   5 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  32 +--
 .../main/scala/kafka/server/ReplicaManager.scala   |  27 +--
 core/src/main/scala/kafka/utils/FileLock.scala     |  64 +++++
 core/src/main/scala/kafka/utils/Utils.scala        |  32 ++-
 .../scala/kafka/utils/VerifiableProperties.scala   |   4 +
 .../kafka/integration/KafkaServerTestHarness.scala |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  64 +++--
 .../scala/unit/kafka/producer/ProducerTest.scala   |   4 +-
 .../server/HighwatermarkPersistenceTest.scala      |  52 ++--
 .../unit/kafka/server/LeaderElectionTest.scala     |   2 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  20 +-
 .../unit/kafka/server/ServerShutdownTest.scala     | 109 ++++-----
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   2 -
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   1 +
 18 files changed, 440 insertions(+), 280 deletions(-)
3adf92151a2f794559d9ef9961bd04b7ba6af1fd

 .../scala/kafka/api/LeaderAndIsrResponse.scala     | 10 +--
 .../main/scala/kafka/api/StopReplicaResponse.scala | 12 ++--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 77 +++++++++++++++++++---
 .../scala/kafka/server/KafkaRequestHandler.scala   | 20 +++---
 4 files changed, 86 insertions(+), 33 deletions(-)
1828b1852cd745ae3ed5847fef55fdc53890ffdf

 .../mirror_maker_testsuite/config/server.properties | 21 +++++++++++++++++++--
 .../replication_testsuite/config/server.properties  | 21 +++++++++++++++++++--
 2 files changed, 38 insertions(+), 4 deletions(-)
6d86e43f0a44f3ba0d4188a7b44c83e0ed351927

 .../testcase_5001/testcase_5001_properties.json         |  2 +-
 .../testcase_5002/testcase_5002_properties.json         |  2 +-
 .../testcase_0001/testcase_0001_properties.json         | 10 +++++-----
 .../testcase_0002/testcase_0002_properties.json         |  2 +-
 .../testcase_0003/testcase_0003_properties.json         |  2 +-
 .../testcase_0004/testcase_0004_properties.json         |  2 +-
 .../testcase_0005/testcase_0005_properties.json         |  2 +-
 .../testcase_0006/testcase_0006_properties.json         |  2 +-
 .../testcase_0007/testcase_0007_properties.json         |  2 +-
 .../testcase_0008/testcase_0008_properties.json         |  2 +-
 .../testcase_0009/testcase_0009_properties.json         |  2 +-
 .../testcase_0010/testcase_0010_properties.json         |  2 +-
 .../testcase_0021/testcase_0021_properties.json         |  4 ++--
 .../testcase_0022/testcase_0022_properties.json         |  4 ++--
 .../testcase_0023/testcase_0023_properties.json         |  4 ++--
 .../testcase_0101/testcase_0101_properties.json         |  2 +-
 .../testcase_0102/testcase_0102_properties.json         |  2 +-
 .../testcase_0103/testcase_0103_properties.json         |  2 +-
 .../testcase_0104/testcase_0104_properties.json         |  2 +-
 .../testcase_0105/testcase_0105_properties.json         |  2 +-
 .../testcase_0106/testcase_0106_properties.json         |  2 +-
 .../testcase_0107/testcase_0107_properties.json         |  2 +-
 .../testcase_0108/testcase_0108_properties.json         |  2 +-
 .../testcase_0109/testcase_0109_properties.json         |  2 +-
 .../testcase_0110/testcase_0110_properties.json         |  2 +-
 .../testcase_0111/testcase_0111_properties.json         |  2 +-
 .../testcase_0112/testcase_0112_properties.json         |  2 +-
 .../testcase_0113/testcase_0113_properties.json         |  2 +-
 .../testcase_0114/testcase_0114_properties.json         |  2 +-
 .../testcase_0115/testcase_0115_properties.json         |  2 +-
 .../testcase_0116/testcase_0116_properties.json         |  2 +-
 .../testcase_0117/testcase_0117_properties.json         |  2 +-
 .../testcase_0118/testcase_0118_properties.json         |  2 +-
 .../testcase_0121/testcase_0121_properties.json         |  4 ++--
 .../testcase_0122/testcase_0122_properties.json         |  4 ++--
 .../testcase_0123/testcase_0123_properties.json         |  4 ++--
 .../testcase_0151/testcase_0151_properties.json         |  3 ++-
 .../testcase_0152/testcase_0152_properties.json         |  3 ++-
 .../testcase_0153/testcase_0153_properties.json         |  2 +-
 .../testcase_0154/testcase_0154_properties.json         |  2 +-
 .../testcase_0155/testcase_0155_properties.json         |  3 ++-
 .../testcase_0156/testcase_0156_properties.json         |  3 ++-
 .../testcase_0157/testcase_0157_properties.json         |  2 +-
 .../testcase_0158/testcase_0158_properties.json         |  2 +-
 .../testcase_0201/testcase_0201_properties.json         |  2 +-
 .../testcase_0202/testcase_0202_properties.json         |  2 +-
 .../testcase_0203/testcase_0203_properties.json         |  2 +-
 .../testcase_0204/testcase_0204_properties.json         |  2 +-
 .../testcase_0205/testcase_0205_properties.json         |  2 +-
 .../testcase_0206/testcase_0206_properties.json         |  2 +-
 .../testcase_0207/testcase_0207_properties.json         |  2 +-
 .../testcase_0208/testcase_0208_properties.json         |  2 +-
 .../testcase_0251/testcase_0251_properties.json         |  2 +-
 .../testcase_0252/testcase_0252_properties.json         |  2 +-
 .../testcase_0253/testcase_0253_properties.json         |  2 +-
 .../testcase_0254/testcase_0254_properties.json         |  2 +-
 .../testcase_0255/testcase_0255_properties.json         |  2 +-
 .../testcase_0256/testcase_0256_properties.json         |  2 +-
 .../testcase_0257/testcase_0257_properties.json         |  2 +-
 .../testcase_0258/testcase_0258_properties.json         |  2 +-
 .../testcase_0301/testcase_0301_properties.json         |  2 +-
 .../testcase_0302/testcase_0302_properties.json         |  2 +-
 .../testcase_0303/testcase_0303_properties.json         |  2 +-
 .../testcase_0304/testcase_0304_properties.json         |  2 +-
 .../testcase_0305/testcase_0305_properties.json         |  2 +-
 .../testcase_0306/testcase_0306_properties.json         |  2 +-
 .../testcase_0307/testcase_0307_properties.json         |  2 +-
 .../testcase_0308/testcase_0308_properties.json         |  2 +-
 system_test/utils/kafka_system_test_utils.py            | 17 ++++++++++++++---
 69 files changed, 96 insertions(+), 81 deletions(-)
414e9faf9badd67bdfd4f0d055a771a41775165e

 core/src/main/scala/kafka/log/OffsetIndex.scala    | 40 +++++++++++-----------
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 33 ++++++++++++++----
 .../scala/unit/kafka/log/OffsetIndexTest.scala     | 12 +++++++
 3 files changed, 58 insertions(+), 27 deletions(-)
4d7c0b7a51cea25b3d42dfe588d771b750e0a8b1

 core/src/main/scala/kafka/server/KafkaServer.scala | 12 +++++++++++-
 1 file changed, 11 insertions(+), 1 deletion(-)
ddabfa7da5580fc633a184ba6a031a93863d5415

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  21 ++++-
 core/src/main/scala/kafka/cluster/Partition.scala  | 105 ++++++++++-----------
 .../controller/ControllerChannelManager.scala      |   6 +-
 .../scala/kafka/controller/KafkaController.scala   |   2 +-
 .../kafka/controller/PartitionStateMachine.scala   |   4 +-
 .../kafka/controller/ReplicaStateMachine.scala     |   2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   1 -
 .../main/scala/kafka/server/ReplicaManager.scala   |  10 +-
 .../api/RequestResponseSerializationTest.scala     |   2 +-
 9 files changed, 83 insertions(+), 70 deletions(-)
743ac37382113f526d706a7cb65340d1f8880897

 .../scala/kafka/perf/ConsumerPerformance.scala     |   4 +
 perf/src/main/scala/kafka/perf/PerfConfig.scala    |   4 -
 .../scala/kafka/perf/ProducerPerformance.scala     | 305 +++++++++------------
 .../kafka/perf/SimpleConsumerPerformance.scala     |   4 +
 system_test/broker_failure/bin/run-test.sh         |   2 +-
 system_test/mirror_maker/bin/run-test.sh           |   2 +-
 .../producer_perf/bin/run-compression-test.sh      |   2 +-
 system_test/producer_perf/bin/run-test.sh          |   2 +-
 .../testcase_0001/testcase_0001_properties.json    |  10 +-
 system_test/utils/kafka_system_test_utils.py       |   4 +-
 10 files changed, 151 insertions(+), 188 deletions(-)
4f529c74445804a85d8eabfb353727b032094589

 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
947ad072af00cb16b818836041be1d48e1e142f4

 .../main/scala/kafka/admin/ShutdownBroker.scala    | 121 ++++++++++++
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  33 +++-
 .../scala/kafka/common/TopicAndPartition.scala     |   2 +
 .../controller/ControllerChannelManager.scala      |  41 +++-
 .../scala/kafka/controller/KafkaController.scala   | 217 +++++++++++++++++++--
 .../kafka/controller/PartitionLeaderSelector.scala |  42 +++-
 .../kafka/controller/PartitionStateMachine.scala   |  26 ++-
 .../kafka/controller/ReplicaStateMachine.scala     |  72 ++++---
 .../kafka/server/AbstractFetcherManager.scala      |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  23 ++-
 .../scala/kafka/server/ReplicaFetcherManager.scala |   2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   5 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   2 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  50 ++++-
 .../api/RequestResponseSerializationTest.scala     |   2 +-
 15 files changed, 539 insertions(+), 101 deletions(-)
9eb9e510118d1a69a3ab9ceac2acee6ab08099d6

 core/src/main/scala/kafka/network/RequestChannel.scala | 13 +++++++++----
 1 file changed, 9 insertions(+), 4 deletions(-)
4ef91667692101cec0e82bfb9f0d3c14cd915ef0

 core/src/main/scala/kafka/utils/CommandLineUtils.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
adebb7d78a52fc7c5cca1e2368c7e54d64f6a626

 .../0.7/bin/kafka-run-class.sh                     |  66 +++
 .../0.7/bin/zookeeper-server-start.sh              |  23 +
 .../0.7/lib/kafka-0.7.0.jar                        | Bin 0 -> 1306797 bytes
 .../0.7/lib/kafka-perf-0.7.0.jar                   | Bin 0 -> 52975 bytes
 .../0.7/lib/zkclient-0.1.jar                       | Bin 0 -> 62913 bytes
 system_test/migration_tool_testsuite/__init__.py   |   1 +
 .../migration_tool_testsuite/cluster_config.json   | 103 ++++
 .../config/migration_consumer.properties           |  29 ++
 .../config/migration_producer.properties           |  80 +++
 .../config/server.properties                       | 122 +++++
 .../config/zookeeper.properties                    |  20 +
 .../migration_tool_test.py                         | 322 +++++++++++++
 .../testcase_9001/testcase_9001_properties.json    | 123 +++++
 .../config/console_consumer.properties             |   4 -
 .../config/consumer.properties                     |  29 --
 .../mirror_maker_testsuite/config/log4j.properties |  38 --
 .../config/producer.properties                     |  80 ---
 .../config/producer_performance.properties         |   5 -
 .../mirror_maker_testsuite/mirror_maker_test.py    |  68 +--
 .../testcase_5001/testcase_5001_properties.json    |   1 +
 .../testcase_5002/testcase_5002_properties.json    | 136 ++++++
 .../config/console_consumer.properties             |   4 -
 .../config/consumer.properties                     |  29 --
 .../replication_testsuite/config/log4j.properties  |  38 --
 .../config/producer.properties                     |  80 ---
 .../config/producer_performance.properties         |   5 -
 .../replication_testsuite/replica_basic_test.py    | 146 ++++--
 .../testcase_0001/testcase_0001_properties.json    |   3 +-
 .../testcase_0002/testcase_0002_properties.json    |   3 +-
 .../testcase_0003/testcase_0003_properties.json    |   3 +-
 .../testcase_0004/testcase_0004_properties.json    |   3 +-
 .../testcase_0005/testcase_0005_properties.json    |   3 +-
 .../testcase_0006/testcase_0006_properties.json    |   3 +-
 .../testcase_0007/testcase_0007_properties.json    |   3 +-
 .../testcase_0008/testcase_0008_properties.json    |   3 +-
 .../testcase_0009/testcase_0009_properties.json    |   3 +-
 .../testcase_0010/testcase_0010_properties.json    |   3 +-
 .../testcase_0021/testcase_0021_properties.json    |   3 +-
 .../testcase_0022/testcase_0022_properties.json    |   3 +-
 .../testcase_0023/testcase_0023_properties.json    |   3 +-
 .../testcase_0101/testcase_0101_properties.json    |   3 +-
 .../testcase_0102/testcase_0102_properties.json    |   3 +-
 .../testcase_0103/testcase_0103_properties.json    |   3 +-
 .../testcase_0104/testcase_0104_properties.json    |   3 +-
 .../testcase_0105/testcase_0105_properties.json    |   3 +-
 .../testcase_0106/testcase_0106_properties.json    |   3 +-
 .../testcase_0107/testcase_0107_properties.json    |   3 +-
 .../testcase_0108/testcase_0108_properties.json    |   3 +-
 .../testcase_0109/testcase_0109_properties.json    |   3 +-
 .../testcase_0110/testcase_0110_properties.json    |   3 +-
 .../testcase_0111/testcase_0111_properties.json    |   3 +-
 .../testcase_0112/testcase_0112_properties.json    |   3 +-
 .../testcase_0113/testcase_0113_properties.json    |   3 +-
 .../testcase_0114/testcase_0114_properties.json    |   3 +-
 .../testcase_0115/testcase_0115_properties.json    |   3 +-
 .../testcase_0116/testcase_0116_properties.json    |   3 +-
 .../testcase_0117/testcase_0117_properties.json    |   3 +-
 .../testcase_0118/testcase_0118_properties.json    |   3 +-
 .../testcase_0121/testcase_0121_properties.json    |   3 +-
 .../testcase_0122/testcase_0122_properties.json    |   3 +-
 .../testcase_0123/testcase_0123_properties.json    |   3 +-
 .../testcase_0151/testcase_0151_properties.json    |  81 ++++
 .../testcase_0152/testcase_0152_properties.json    |  81 ++++
 .../testcase_0153/testcase_0153_properties.json    |  81 ++++
 .../testcase_0154/testcase_0154_properties.json    |  81 ++++
 .../testcase_0155/testcase_0155_properties.json    |  81 ++++
 .../testcase_0156/testcase_0156_properties.json    |  81 ++++
 .../testcase_0157/testcase_0157_properties.json    |  81 ++++
 .../testcase_0158/testcase_0158_properties.json    |  81 ++++
 .../testcase_0201/testcase_0201_properties.json    |  81 ++++
 .../testcase_0202/testcase_0202_properties.json    |  81 ++++
 .../testcase_0203/testcase_0203_properties.json    |  81 ++++
 .../testcase_0204/testcase_0204_properties.json    |  81 ++++
 .../testcase_0205/testcase_0205_properties.json    |  81 ++++
 .../testcase_0206/testcase_0206_properties.json    |  81 ++++
 .../testcase_0207/testcase_0207_properties.json    |  81 ++++
 .../testcase_0208/testcase_0208_properties.json    |  81 ++++
 .../testcase_0251/testcase_0251_properties.json    |  81 ++++
 .../testcase_0252/testcase_0252_properties.json    |  81 ++++
 .../testcase_0253/testcase_0253_properties.json    |  81 ++++
 .../testcase_0254/testcase_0254_properties.json    |  81 ++++
 .../testcase_0255/testcase_0255_properties.json    |  81 ++++
 .../testcase_0256/testcase_0256_properties.json    |  81 ++++
 .../testcase_0257/testcase_0257_properties.json    |  81 ++++
 .../testcase_0258/testcase_0258_properties.json    |  81 ++++
 .../testcase_0301/testcase_0301_properties.json    |  79 +++
 .../testcase_0302/testcase_0302_properties.json    |  79 +++
 .../testcase_0303/testcase_0303_properties.json    |  79 +++
 .../testcase_0304/testcase_0304_properties.json    |  79 +++
 .../testcase_0305/testcase_0305_properties.json    |  79 +++
 .../testcase_0306/testcase_0306_properties.json    |  79 +++
 .../testcase_0307/testcase_0307_properties.json    |  79 +++
 .../testcase_0308/testcase_0308_properties.json    |  79 +++
 .../testcase_1/testcase_1_properties.json          |   3 +-
 system_test/system_test_runner.py                  |  15 +-
 system_test/testcase_to_run_all.json               |  87 ++++
 system_test/utils/kafka_system_test_utils.py       | 534 +++++++++++++++------
 system_test/utils/replication_utils.py             |   7 +
 system_test/utils/system_test_utils.py             |  33 +-
 99 files changed, 4321 insertions(+), 588 deletions(-)
0d9f7ffe4d6d0eb571a3699176eb765c2e77cf47

 bin/windows/kafka-console-consumer.bat | 20 +++++++++
 bin/windows/kafka-console-producer.bat | 17 ++++++++
 bin/windows/kafka-run-class.bat        | 77 ++++++++++++++++++++++++++++++++++
 bin/windows/kafka-server-start.bat     | 27 ++++++++++++
 bin/windows/zookeeper-server-start.bat | 22 ++++++++++
 sbt.bat                                | 17 ++++++++
 6 files changed, 180 insertions(+)
68d8f59045defe4da5e10d2fe4351ba2247d433c

 .../main/scala/kafka/producer/ProducerConfig.scala |  6 ------
 .../main/scala/kafka/producer/SyncProducer.scala   | 23 +++-------------------
 .../scala/kafka/producer/SyncProducerConfig.scala  |  7 -------
 core/src/main/scala/kafka/server/KafkaConfig.scala |  4 ----
 4 files changed, 3 insertions(+), 37 deletions(-)
23bce10e779a8be03a3f1883e60c9a5e85cf6fe0

 core/src/main/scala/kafka/api/FetchResponse.scala      |  8 ++++----
 core/src/main/scala/kafka/api/ProducerRequest.scala    |  2 +-
 .../kafka/javaapi/message/ByteBufferMessageSet.scala   |  4 ++--
 .../main/scala/kafka/javaapi/message/MessageSet.scala  |  2 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala     | 18 +++++++++---------
 core/src/main/scala/kafka/log/Log.scala                |  6 +++---
 core/src/main/scala/kafka/log/LogSegment.scala         |  2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala     | 14 ++++++--------
 core/src/main/scala/kafka/message/MessageSet.scala     |  4 ++--
 core/src/main/scala/kafka/server/MessageSetSend.scala  | 10 +++++-----
 .../javaapi/message/BaseMessageSetTestCases.scala      |  6 +++---
 .../src/test/scala/unit/kafka/log/LogManagerTest.scala |  6 +++---
 core/src/test/scala/unit/kafka/log/LogTest.scala       |  8 ++++----
 .../unit/kafka/message/BaseMessageSetTestCases.scala   |  4 ++--
 .../unit/kafka/message/ByteBufferMessageSetTest.scala  |  4 ++--
 15 files changed, 48 insertions(+), 50 deletions(-)
3deb6cd4208351fa6831331da5b60e8e2ffc97c6

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala   | 11 +++++++----
 core/src/main/scala/kafka/tools/SimpleConsumerShell.scala | 12 ++++++++----
 2 files changed, 15 insertions(+), 8 deletions(-)
2c66f5b701bff82cca8dcdb759194557e412719a

 .../kafka/consumer/ConsumerFetcherManager.scala    | 49 +++++++++++-----------
 1 file changed, 25 insertions(+), 24 deletions(-)
1b7b43c6e1387baea50fb7c1225411342db5b62b

 config/server.properties                           |   8 ++--
 core/lib/metrics-annotation-3.0.0-10ccc80c.jar     | Bin 4764 -> 0 bytes
 core/lib/metrics-annotation-3.0.1.jar              | Bin 0 -> 4762 bytes
 core/lib/metrics-core-3.0.0-10ccc80c.jar           | Bin 87567 -> 0 bytes
 core/lib/metrics-core-3.0.1.jar                    | Bin 0 -> 81781 bytes
 core/src/main/scala/kafka/Kafka.scala              |  13 ++----
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   3 +-
 .../PreferredReplicaLeaderElectionCommand.scala    |   2 +-
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |   1 -
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   1 -
 core/src/main/scala/kafka/api/OffsetResponse.scala |   1 -
 .../src/main/scala/kafka/api/ProducerRequest.scala |   1 -
 .../main/scala/kafka/api/ProducerResponse.scala    |   1 -
 .../main/scala/kafka/api/StopReplicaResponse.scala |   1 -
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  27 ++++++++++--
 .../main/scala/kafka/consumer/ConsumerConfig.scala |   2 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |   1 -
 .../consumer/ZookeeperConsumerConnector.scala      |   5 ++-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   5 +--
 .../scala/kafka/message/CompressionFactory.scala   |   5 ---
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |  24 ++++++++++-
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |   9 ++--
 .../main/scala/kafka/network/RequestChannel.scala  |  32 +++++++-------
 .../main/scala/kafka/network/SocketServer.scala    |   2 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |   5 +--
 core/src/main/scala/kafka/producer/Producer.scala  |   5 ++-
 .../main/scala/kafka/producer/ProducerPool.scala   |   2 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |   1 -
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   3 +-
 .../scala/kafka/server/KafkaRequestHandler.scala   |   2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   1 -
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   3 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   2 -
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   2 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |   2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   2 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   |   1 -
 .../kafka/message/MessageCompressionTest.scala     |   2 -
 .../scala/unit/kafka/message/MessageTest.scala     |   3 --
 .../unit/kafka/producer/AsyncProducerTest.scala    |   1 -
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |   2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   8 ++--
 .../scala/kafka/perf/ProducerPerformance.scala     |  25 ++++++++++-
 project/build/KafkaProject.scala                   |   4 +-
 system_test/metrics.json                           |  28 ++++++-------
 system_test/utils/kafka_system_test_utils.py       |  46 +++++++++++++++++----
 system_test/utils/metrics.py                       |  44 ++++++++++++++++----
 49 files changed, 216 insertions(+), 126 deletions(-)
e35854062f7dd48714ef756657321020d7351a5c

 core/src/main/scala/kafka/log/FileMessageSet.scala | 30 +++++++++++++---------
 core/src/main/scala/kafka/log/Log.scala            |  5 ++--
 core/src/main/scala/kafka/log/LogSegment.scala     |  6 ++---
 .../scala/kafka/message/ByteBufferMessageSet.scala |  5 +++-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  8 +++---
 .../main/scala/kafka/tools/DumpLogSegments.scala   | 10 ++++----
 6 files changed, 37 insertions(+), 27 deletions(-)
98f64070891a34e3a8b3f0483a7f5397b8a6933b

 .../src/main/java/kafka/etl/KafkaETLContext.java   |  5 ++--
 core/src/main/scala/kafka/api/FetchRequest.scala   | 28 ++++++++++------------
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  6 +++++
 .../kafka/consumer/ConsumerFetcherThread.scala     | 13 ++++++----
 .../scala/kafka/server/AbstractFetcherThread.scala | 20 ++++++++--------
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 20 +++++++++++-----
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 17 +++++++------
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  4 +---
 .../java/kafka/examples/SimpleConsumerDemo.java    |  2 --
 .../kafka/perf/SimpleConsumerPerformance.scala     |  3 ---
 10 files changed, 63 insertions(+), 55 deletions(-)
d1a22b2e3b59c2cf00adabd75d29ddd53938bacb

 core/src/main/scala/kafka/Kafka.scala              |   2 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   3 +-
 .../kafka/admin/CheckReassignmentStatus.scala      |   4 +-
 .../PreferredReplicaLeaderElectionCommand.scala    |   8 +-
 .../kafka/admin/ReassignPartitionsCommand.scala    |   4 +-
 core/src/main/scala/kafka/api/ApiUtils.scala       |  92 ++++++
 core/src/main/scala/kafka/api/FetchRequest.scala   |  15 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |   8 +-
 .../scala/kafka/api/LeaderAndISRResponse.scala     |  66 ----
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  21 +-
 .../scala/kafka/api/LeaderAndIsrResponse.scala     |  67 ++++
 core/src/main/scala/kafka/api/OffsetRequest.scala  |  13 +-
 core/src/main/scala/kafka/api/OffsetResponse.scala |   7 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |  13 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |   7 +-
 core/src/main/scala/kafka/api/RequestKeys.scala    |  12 +-
 .../main/scala/kafka/api/RequestOrResponse.scala   |   6 -
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  13 +-
 .../main/scala/kafka/api/StopReplicaResponse.scala |   5 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  |  24 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |  14 +-
 core/src/main/scala/kafka/client/ClientUtils.scala |  60 ++++
 core/src/main/scala/kafka/cluster/Broker.scala     |   1 +
 core/src/main/scala/kafka/cluster/Partition.scala  |  62 ++--
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  11 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |   3 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |   4 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   3 +-
 .../controller/ControllerChannelManager.scala      |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  22 +-
 core/src/main/scala/kafka/message/Message.scala    |   4 +-
 .../scala/kafka/metrics/KafkaMetricsConfig.scala   |   2 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |   7 +-
 .../scala/kafka/producer/DefaultPartitioner.scala  |   4 +-
 core/src/main/scala/kafka/producer/Producer.scala  |   8 +-
 .../main/scala/kafka/producer/ProducerConfig.scala |   2 +-
 .../kafka/producer/async/DefaultEventHandler.scala |   9 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  16 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  14 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  13 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   4 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  |   5 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  20 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  11 +-
 .../main/scala/kafka/utils/CommandLineUtils.scala  |  20 ++
 core/src/main/scala/kafka/utils/Json.scala         |  24 ++
 core/src/main/scala/kafka/utils/Utils.scala        | 357 ++++-----------------
 .../scala/kafka/utils/VerifiableProperties.scala   |  19 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  42 ++-
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |   2 +-
 .../api/RequestResponseSerializationTest.scala     |  38 +--
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   4 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   2 +-
 .../scala/unit/kafka/message/MessageTest.scala     |   2 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |  14 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  18 +-
 .../scala/kafka/perf/ConsumerPerformance.scala     |   4 +-
 58 files changed, 630 insertions(+), 609 deletions(-)
3015d0a447a72fd571e71123bae0e541c46a1830

 bin/kafka-check-reassignment-status.sh             |   1 -
 bin/kafka-preferred-replica-election.sh            |  18 ++
 bin/kafka-reassign-partitions.sh                   |   1 -
 .../kafka/admin/CheckReassignmentStatus.scala      |  32 ++-
 .../PreferredReplicaLeaderElectionCommand.scala    | 140 +++++++++++
 .../kafka/admin/ReassignPartitionsCommand.scala    |  10 +-
 .../scala/kafka/controller/KafkaController.scala   | 266 +++++++++++++--------
 .../kafka/controller/PartitionLeaderSelector.scala |  53 +++-
 .../kafka/controller/PartitionStateMachine.scala   |  93 +++----
 .../kafka/controller/ReplicaStateMachine.scala     |  23 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  16 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  67 ++++--
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 123 ++++------
 13 files changed, 559 insertions(+), 284 deletions(-)
669ae397f8846d8ddc5af350b44bd7c0e442d3aa

 core/src/main/scala/kafka/api/FetchResponse.scala  | 46 ++++++-----
 .../src/main/scala/kafka/api/ProducerRequest.scala | 35 ++------
 .../kafka/consumer/ConsumerFetcherManager.scala    | 10 +--
 .../kafka/consumer/ConsumerFetcherThread.scala     | 11 ++-
 .../main/scala/kafka/network/RequestChannel.scala  |  3 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  4 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  9 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 96 +++++++++++-----------
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 10 +--
 .../api/RequestResponseSerializationTest.scala     | 31 +++----
 .../unit/kafka/network/SocketServerTest.scala      |  5 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  5 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 13 files changed, 130 insertions(+), 137 deletions(-)
c0fdcd305c8487610b7bdb2ac080b4a1055534f3

 core/src/main/scala/kafka/producer/async/ProducerSendThread.scala | 2 ++
 1 file changed, 2 insertions(+)
2b13581711ec506e87a93f0c3dc0ec43fb66707f

 bin/kafka-consumer-shell.sh                         | 0
 core/src/main/scala/kafka/tools/ConsumerShell.scala | 0
 2 files changed, 0 insertions(+), 0 deletions(-)
3629f6f882b354265489d4b2b7c80975bb9134d7

 bin/kafka-server-stop.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
dd44ec672a95a414972747a23c76cbe74efb37ea

 bin/kafka-consumer-shell.sh                        |  17 --
 core/src/main/scala/kafka/api/FetchRequest.scala   |  21 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   7 +-
 .../main/scala/kafka/api/RequestOrResponse.scala   |   4 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |   2 +-
 .../common/ReplicaNotAvailableException.scala      |   5 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     | 240 +++++++++++----------
 .../kafka/consumer/ConsumerFetcherThread.scala     |  12 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  41 ++++
 .../consumer/ZookeeperConsumerConnector.scala      |  31 +--
 .../main/scala/kafka/javaapi/OffsetRequest.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  62 +++---
 .../main/scala/kafka/server/ReplicaManager.scala   |  10 +-
 .../src/main/scala/kafka/tools/ConsumerShell.scala | 108 ----------
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   2 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 194 ++++++++++++-----
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |   2 +-
 17 files changed, 382 insertions(+), 378 deletions(-)
97d434513fe949005ae87d7c0fb3912708f3f728

 contrib/hadoop-consumer/src/main/java/kafka/etl/KafkaETLContext.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
eb06b93f97808a7071df43621bd09a4f168864f8

 .../scala/kafka/api/LeaderAndISRResponse.scala     |  2 +-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala | 68 ++++++++++++----------
 core/src/main/scala/kafka/cluster/Partition.scala  |  9 +--
 core/src/main/scala/kafka/cluster/Replica.scala    |  2 +-
 .../controller/ControllerChannelManager.scala      | 14 +++--
 .../kafka/controller/PartitionStateMachine.scala   |  9 +--
 .../kafka/controller/ReplicaStateMachine.scala     | 14 +++--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 18 ++++--
 .../main/scala/kafka/server/ReplicaManager.scala   | 68 +++++++++++++---------
 .../api/RequestResponseSerializationTest.scala     |  5 +-
 .../server/HighwatermarkPersistenceTest.scala      |  6 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |  2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  2 +-
 13 files changed, 129 insertions(+), 90 deletions(-)
432423518310a5ed9e8f6fbcf238767b25d63f35

 core/src/main/scala/kafka/log/Log.scala            | 121 ++++++++++++++-------
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  26 +++++
 4 files changed, 112 insertions(+), 39 deletions(-)
aaa5d14e39d1b784facf5048b99a097ce45cdc8a

 core/src/main/scala/kafka/log/FileMessageSet.scala          |  4 ++--
 core/src/main/scala/kafka/log/Log.scala                     |  6 ++++--
 core/src/main/scala/kafka/log/LogManager.scala              |  1 -
 core/src/main/scala/kafka/log/LogSegment.scala              |  2 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala             |  4 ++--
 .../src/main/scala/kafka/message/ByteBufferMessageSet.scala |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala            | 13 +++++++++----
 7 files changed, 19 insertions(+), 13 deletions(-)
93fdcfa0e2a26a7fa68fd882564903ca5d9710fd

 bin/kafka-check-reassignment-status.sh             |  19 +++
 bin/kafka-reassign-partitions.sh                   |  19 +++
 .../kafka/admin/CheckReassignmentStatus.scala      |  97 +++++++++++++++
 .../kafka/admin/ReassignPartitionsCommand.scala    | 137 +++++++++++++++++++++
 .../kafka/common/AdminCommandFailedException.scala |  23 ++++
 .../kafka/controller/PartitionLeaderSelector.scala | 120 ++++++++++++++++++
 6 files changed, 415 insertions(+)
23d7620442df299f43d147a2ad924b2759f7efbd

 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  23 +-
 .../kafka/common/PartitionOfflineException.scala   |   6 +-
 .../kafka/common/StateChangeFailedException.scala  |   6 +-
 .../controller/ControllerChannelManager.scala      |  37 +-
 .../scala/kafka/controller/KafkaController.scala   | 398 +++++++++++++++++++--
 .../kafka/controller/PartitionStateMachine.scala   | 152 +++-----
 .../kafka/controller/ReplicaStateMachine.scala     | 100 ++++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  15 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 100 +++++-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 182 +++++++++-
 .../api/RequestResponseSerializationTest.scala     |   2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   8 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 15 files changed, 821 insertions(+), 217 deletions(-)
a1698e2b70341cae20c53fb6b2e890df34b29a3e

 bin/kafka-check-reassignment-status.sh             |  19 -
 bin/kafka-reassign-partitions.sh                   |  19 -
 config/server.properties                           |   7 +
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 .../kafka/admin/CheckReassignmentStatus.scala      |  97 -----
 .../kafka/admin/ReassignPartitionsCommand.scala    | 137 -------
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |   1 +
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  23 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |   4 +-
 .../kafka/common/AdminCommandFailedException.scala |  23 --
 .../kafka/common/PartitionOfflineException.scala   |   6 +-
 .../kafka/common/StateChangeFailedException.scala  |   6 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 .../controller/ControllerChannelManager.scala      |  37 +-
 .../scala/kafka/controller/KafkaController.scala   | 398 ++-------------------
 .../kafka/controller/PartitionLeaderSelector.scala | 120 -------
 .../kafka/controller/PartitionStateMachine.scala   | 152 +++++---
 .../kafka/controller/ReplicaStateMachine.scala     | 100 ++----
 core/src/main/scala/kafka/log/FileMessageSet.scala |  51 +--
 core/src/main/scala/kafka/log/Log.scala            |  32 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   6 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    |  68 ++--
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |   5 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   2 +-
 .../main/scala/kafka/producer/ProducerPool.scala   |   2 +-
 .../kafka/producer/async/ProducerSendThread.scala  |   2 +-
 .../kafka/server/AbstractFetcherManager.scala      |  15 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   2 +-
 .../scala/kafka/server/ReplicaFetcherManager.scala |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  17 +-
 .../main/scala/kafka/server/RequestPurgatory.scala |   2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   4 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   4 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  15 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 100 +-----
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 182 +---------
 .../api/RequestResponseSerializationTest.scala     |   2 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |   2 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   2 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |   4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  27 ++
 .../scala/unit/kafka/log/OffsetIndexTest.scala     |  37 +-
 .../kafka/message/BaseMessageSetTestCases.scala    |   2 +-
 .../kafka/message/MessageCompressionTest.scala     |   1 +
 .../scala/unit/kafka/metrics/KafkaTimerTest.scala  |  10 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   8 +-
 .../unit/kafka/server/RequestPurgatoryTest.scala   |   5 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 project/build/KafkaProject.scala                   |  30 +-
 system_test/testcase_to_run.json                   |   3 +-
 52 files changed, 400 insertions(+), 1411 deletions(-)
6d0042b4f4125b3731d3b85a0e741f1dde1413fe

 bin/kafka-check-reassignment-status.sh             |  19 +
 bin/kafka-reassign-partitions.sh                   |  19 +
 config/server.properties                           |   7 -
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 .../kafka/admin/CheckReassignmentStatus.scala      |  97 +++++
 .../kafka/admin/ReassignPartitionsCommand.scala    | 137 +++++++
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |   1 -
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  23 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |   4 +-
 .../kafka/common/AdminCommandFailedException.scala |  23 ++
 .../kafka/common/PartitionOfflineException.scala   |   6 +-
 .../kafka/common/StateChangeFailedException.scala  |   6 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 .../controller/ControllerChannelManager.scala      |  37 +-
 .../scala/kafka/controller/KafkaController.scala   | 398 +++++++++++++++++++--
 .../kafka/controller/PartitionLeaderSelector.scala | 120 +++++++
 .../kafka/controller/PartitionStateMachine.scala   | 152 +++-----
 .../kafka/controller/ReplicaStateMachine.scala     | 100 ++++--
 core/src/main/scala/kafka/log/FileMessageSet.scala |  51 ++-
 core/src/main/scala/kafka/log/Log.scala            |  32 +-
 core/src/main/scala/kafka/log/LogSegment.scala     |   6 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    |  68 ++--
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |   5 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   2 +-
 .../main/scala/kafka/producer/ProducerPool.scala   |   2 +-
 .../kafka/producer/async/ProducerSendThread.scala  |   2 +-
 .../kafka/server/AbstractFetcherManager.scala      |  15 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   2 +-
 .../scala/kafka/server/ReplicaFetcherManager.scala |   3 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  17 +-
 .../main/scala/kafka/server/RequestPurgatory.scala |   2 +-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   4 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |   4 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  15 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 100 +++++-
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 182 +++++++++-
 .../api/RequestResponseSerializationTest.scala     |   2 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |   2 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   2 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |   4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  27 --
 .../scala/unit/kafka/log/OffsetIndexTest.scala     |  37 +-
 .../kafka/message/BaseMessageSetTestCases.scala    |   2 +-
 .../kafka/message/MessageCompressionTest.scala     |   1 -
 .../scala/unit/kafka/metrics/KafkaTimerTest.scala  |  10 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |   8 +-
 .../unit/kafka/server/RequestPurgatoryTest.scala   |   5 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   3 +-
 project/build/KafkaProject.scala                   |  30 +-
 system_test/testcase_to_run.json                   |   3 +-
 52 files changed, 1411 insertions(+), 400 deletions(-)
01a8b8d12377eae66a1924d2e26ed4e94d3f52bc

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala | 68 ++++++++++------------
 core/src/main/scala/kafka/cluster/Partition.scala  |  9 ++-
 core/src/main/scala/kafka/cluster/Replica.scala    |  2 +-
 .../controller/ControllerChannelManager.scala      | 13 ++---
 .../kafka/controller/PartitionStateMachine.scala   | 10 ++--
 .../kafka/controller/ReplicaStateMachine.scala     |  9 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 15 ++---
 .../main/scala/kafka/server/ReplicaManager.scala   | 64 +++++++++-----------
 .../api/RequestResponseSerializationTest.scala     |  5 +-
 .../server/HighwatermarkPersistenceTest.scala      |  6 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |  2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  2 +-
 12 files changed, 89 insertions(+), 116 deletions(-)
cdc6ca2c7bd691b194f631942e14586284e8d655

 system_test/run_sanity.sh | 0
 1 file changed, 0 insertions(+), 0 deletions(-)
1b4d3c3061d030ce5ebf67c15803fff7f9bca4ac

 system_test/cluster_config.json                    |  10 +-
 system_test/logging.conf                           |  56 ++
 system_test/mirror_maker_testsuite/__init__.py     |   1 +
 .../mirror_maker_testsuite/cluster_config.json     | 126 +++
 .../config/console_consumer.properties             |   4 +
 .../config/consumer.properties                     |  29 +
 .../mirror_maker_testsuite/config/log4j.properties |  38 +
 .../config/mirror_consumer.properties              |  12 +
 .../config/mirror_producer.properties              |   5 +
 .../config/producer.properties                     |  80 ++
 .../config/producer_performance.properties         |   5 +
 .../config/server.properties                       | 122 +++
 .../config/zookeeper.properties                    |  23 +
 .../mirror_maker_testsuite/mirror_maker_test.py    | 325 ++++++++
 .../testcase_5001/testcase_5001_properties.json    | 135 ++++
 .../config/producer_performance.properties         |   1 +
 .../replication_testsuite/replica_basic_test.py    | 225 +++---
 .../testcase_0001/testcase_0001_properties.json    |  76 ++
 .../testcase_0002/testcase_0002_properties.json    |  76 ++
 .../testcase_0003/testcase_0003_properties.json    |  76 ++
 .../testcase_0004/testcase_0004_properties.json    |  76 ++
 .../testcase_0005/testcase_0005_properties.json    |  76 ++
 .../testcase_0006/testcase_0006_properties.json    |  76 ++
 .../testcase_0007/testcase_0007_properties.json    |  76 ++
 .../testcase_0008/testcase_0008_properties.json    |  76 ++
 .../testcase_0009/testcase_0009_properties.json    |  76 ++
 .../testcase_0010/testcase_0010_properties.json    |  76 ++
 .../testcase_0021/cluster_config.json              |  76 ++
 .../testcase_0021/testcase_0021_properties.json    |  94 +++
 .../testcase_0022/cluster_config.json              |  76 ++
 .../testcase_0022/testcase_0022_properties.json    |  94 +++
 .../testcase_0023/cluster_config.json              |  76 ++
 .../testcase_0023/testcase_0023_properties.json    |  94 +++
 .../testcase_0101/testcase_0101_properties.json    |  79 ++
 .../testcase_0102/testcase_0102_properties.json    |  79 ++
 .../testcase_0103/testcase_0103_properties.json    |  79 ++
 .../testcase_0104/testcase_0104_properties.json    |  79 ++
 .../testcase_0105/testcase_0105_properties.json    |  79 ++
 .../testcase_0106/testcase_0106_properties.json    |  79 ++
 .../testcase_0107/testcase_0107_properties.json    |  79 ++
 .../testcase_0108/testcase_0108_properties.json    |  79 ++
 .../testcase_0109/testcase_0109_properties.json    |  79 ++
 .../testcase_0110/testcase_0110_properties.json    |  79 ++
 .../testcase_0111/testcase_0111_properties.json    |  79 ++
 .../testcase_0112/testcase_0112_properties.json    |  79 ++
 .../testcase_0113/testcase_0113_properties.json    |  79 ++
 .../testcase_0114/testcase_0114_properties.json    |  79 ++
 .../testcase_0115/testcase_0115_properties.json    |  79 ++
 .../testcase_0116/testcase_0116_properties.json    |  79 ++
 .../testcase_0117/testcase_0117_properties.json    |  79 ++
 .../testcase_0118/testcase_0118_properties.json    |  79 ++
 .../testcase_0121/cluster_config.json              |  76 ++
 .../testcase_0121/testcase_0121_properties.json    |  97 +++
 .../testcase_0122/cluster_config.json              |  76 ++
 .../testcase_0122/testcase_0122_properties.json    |  97 +++
 .../testcase_0123/cluster_config.json              |  76 ++
 .../testcase_0123/testcase_0123_properties.json    |  97 +++
 .../testcase_1/cluster_config.json                 |  58 ++
 .../testcase_1/testcase_1_properties.json          |  18 +-
 system_test/run_sanity.sh                          |  10 +
 system_test/system_test_env.py                     |  82 +-
 system_test/system_test_runner.py                  | 213 ++---
 system_test/testcase_to_run.json                   |   6 +
 system_test/testcase_to_run_sanity.json            |   5 +
 system_test/testcase_to_skip.json                  |   3 +
 system_test/utils/kafka_system_test_utils.py       | 872 +++++++++++++++++----
 system_test/utils/metrics.py                       |   2 +-
 system_test/utils/replication_utils.py             |  60 ++
 system_test/utils/setup_utils.py                   |  10 +-
 system_test/utils/system_test_utils.py             | 141 +++-
 system_test/utils/testcase_env.py                  |  61 +-
 71 files changed, 5536 insertions(+), 413 deletions(-)
3c335bfbdc2720863a5fe18c6aa27dea0528b719

 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
6ccdc40ae8767138be01f7dab5db1ece771f7c99

 .../main/scala/kafka/api/LeaderAndIsrRequest.scala | 68 ++++++++++++----------
 core/src/main/scala/kafka/cluster/Partition.scala  |  9 +--
 core/src/main/scala/kafka/cluster/Replica.scala    |  2 +-
 .../controller/ControllerChannelManager.scala      | 13 +++--
 .../kafka/controller/PartitionStateMachine.scala   | 10 ++--
 .../kafka/controller/ReplicaStateMachine.scala     |  9 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 15 +++--
 .../main/scala/kafka/server/ReplicaManager.scala   | 64 +++++++++++---------
 .../api/RequestResponseSerializationTest.scala     |  5 +-
 .../server/HighwatermarkPersistenceTest.scala      |  6 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |  2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  2 +-
 12 files changed, 116 insertions(+), 89 deletions(-)
a975113c0eb038d8ffdb1e4286b367bcec3a66cc

 config/producer.properties | 13 +------------
 1 file changed, 1 insertion(+), 12 deletions(-)
5a33bfa9d42b1158273ec24ac9633bd149162488

 core/src/main/scala/kafka/admin/AdminUtils.scala   | 91 ++++++++++++----------
 .../main/scala/kafka/admin/ListTopicCommand.scala  |  2 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |  2 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  2 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  4 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 24 +++---
 core/src/main/scala/kafka/utils/Utils.scala        |  4 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  8 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  3 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   | 12 +--
 11 files changed, 76 insertions(+), 78 deletions(-)
dd21b35120119dc35da7e800bfd50dad3dd2f44b

 .../consumer/ZookeeperConsumerConnector.scala      | 40 ++++++++++------------
 1 file changed, 19 insertions(+), 21 deletions(-)
2f41be0916e0a15ed19d639528e3e46e0b175034

 .../consumer/ZookeeperConsumerConnector.scala      | 38 ++++++++++------------
 1 file changed, 18 insertions(+), 20 deletions(-)
542ac86313916b7903a50c1d4f2a4ce5ee2d4ebd

 config/server.properties                           |   7 +++++
 core/lib/metrics-annotation-3.0.0-10ccc80c.jar     | Bin 0 -> 4764 bytes
 core/lib/metrics-core-3.0.0-10ccc80c.jar           | Bin 0 -> 87567 bytes
 core/src/main/scala/kafka/cluster/Partition.scala  |   2 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 .../scala/kafka/controller/KafkaController.scala   |   2 +-
 core/src/main/scala/kafka/log/Log.scala            |   4 +--
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |   5 ++--
 .../main/scala/kafka/network/RequestChannel.scala  |   2 +-
 .../kafka/producer/async/ProducerSendThread.scala  |   2 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |   4 +--
 .../main/scala/kafka/server/RequestPurgatory.scala |   2 +-
 .../scala/unit/kafka/metrics/KafkaTimerTest.scala  |  10 +++----
 project/build/KafkaProject.scala                   |  30 ++++++++++++++++++---
 15 files changed, 53 insertions(+), 21 deletions(-)
3a525e0bfa4cd5b3dd963bb95617e3431f6040fd

 core/src/test/scala/unit/kafka/message/MessageCompressionTest.scala | 1 +
 1 file changed, 1 insertion(+)
d5df29b84f65fbcfab7b3289ec761eebbf6174f8

 .../main/scala/kafka/server/AbstractFetcherManager.scala  | 15 +++------------
 1 file changed, 3 insertions(+), 12 deletions(-)
452be9080ea00327834386014657c01f057aaaca

 core/src/main/scala/kafka/log/FileMessageSet.scala | 51 +++++-----------
 core/src/main/scala/kafka/log/Log.scala            | 28 +++------
 core/src/main/scala/kafka/log/LogSegment.scala     |  6 +-
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 68 ++++++++++------------
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  4 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  |  2 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala |  4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 27 +++++++++
 .../scala/unit/kafka/log/OffsetIndexTest.scala     | 37 ++----------
 .../kafka/message/BaseMessageSetTestCases.scala    |  2 +-
 10 files changed, 98 insertions(+), 131 deletions(-)
3819adc48631d6841032c0d8d08b74ea1912daf2

 core/src/main/scala/kafka/consumer/ConsumerConnector.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
eed59835968603c6dd10a124e8b119e7cb66be12

 core/src/main/scala/kafka/cluster/Partition.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7294dd3333238423cd665f3103221e24182173ec

 core/src/main/scala/kafka/tools/ConsumerOffsetChecker.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
c85c01b6e4c5fc5bf0894522210617710131751e

 core/src/main/scala/kafka/tools/ConsumerOffsetChecker.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
f64fd3dcbaace1dba7bbd72398bb3e7d28b41d61

 core/src/main/scala/kafka/Kafka.scala              |   1 -
 core/src/main/scala/kafka/api/FetchResponse.scala  |   3 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |  19 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |   2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  10 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   8 -
 .../scala/kafka/common/InvalidTopicException.scala |  22 +
 .../common/MessageSizeTooLargeException.scala      |  22 +
 .../kafka/consumer/ConsumerFetcherThread.scala     |  14 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |  11 +-
 .../scala/kafka/consumer/FetchedDataChunk.scala    |   6 +-
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  35 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   8 +-
 .../consumer/storage/MemoryOffsetStorage.scala     |  44 --
 .../kafka/consumer/storage/OffsetStorage.scala     |  40 --
 .../consumer/storage/OracleOffsetStorage.scala     | 155 -------
 core/src/main/scala/kafka/javaapi/Implicits.scala  |   5 +-
 .../main/scala/kafka/javaapi/TopicMetadata.scala   |   8 +-
 .../scala/kafka/javaapi/TopicMetadataRequest.scala |   4 +-
 .../javaapi/message/ByteBufferMessageSet.scala     |  19 +-
 core/src/main/scala/kafka/log/FileMessageSet.scala | 204 +++++++++
 core/src/main/scala/kafka/log/Log.scala            | 472 ++++++++++++---------
 core/src/main/scala/kafka/log/LogManager.scala     |  40 +-
 core/src/main/scala/kafka/log/LogSegment.scala     | 151 +++++++
 core/src/main/scala/kafka/log/OffsetIndex.scala    | 277 ++++++++++++
 core/src/main/scala/kafka/log/OffsetPosition.scala |  25 ++
 core/src/main/scala/kafka/log/SegmentList.scala    |   6 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala | 218 ++++++----
 .../scala/kafka/message/CompressionFactory.scala   |  55 +++
 .../scala/kafka/message/CompressionUtils.scala     | 160 -------
 .../main/scala/kafka/message/FileMessageSet.scala  | 245 -----------
 core/src/main/scala/kafka/message/Message.scala    | 237 +++++++----
 .../scala/kafka/message/MessageAndOffset.scala     |   8 +-
 core/src/main/scala/kafka/message/MessageSet.scala |  54 ++-
 .../scala/kafka/producer/ConsoleProducer.scala     |   3 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  17 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 203 ++++-----
 core/src/main/scala/kafka/server/KafkaConfig.scala |  60 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |   8 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  72 +++-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   4 +-
 .../scala/other/kafka/TestLogPerformance.scala     |   2 +-
 .../api/RequestResponseSerializationTest.scala     | 238 +++++++++++
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   9 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |   4 +-
 .../kafka/integration/LazyInitProducerTest.scala   |   5 +-
 .../unit/kafka/integration/LogCorruptionTest.scala | 100 -----
 .../javaapi/message/ByteBufferMessageSetTest.scala |   3 +-
 .../scala/unit/kafka/log/FileMessageSetTest.scala  | 107 +++++
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  29 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   8 +-
 .../test/scala/unit/kafka/log/LogSegmentTest.scala | 105 +++++
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 273 ++++++------
 .../scala/unit/kafka/log/OffsetIndexTest.scala     | 182 ++++++++
 .../kafka/message/BaseMessageSetTestCases.scala    |  16 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   |  65 ++-
 .../unit/kafka/message/CompressionUtilsTest.scala  |  75 ----
 .../unit/kafka/message/FileMessageSetTest.scala    |  84 ----
 .../kafka/message/MessageCompressionTest.scala     |  65 +++
 .../scala/unit/kafka/message/MessageTest.scala     |  66 ++-
 .../scala/unit/kafka/metrics/KafkaTimerTest.scala  |   3 +-
 .../kafka/network/RpcDataSerializationTest.scala   | 238 -----------
 .../unit/kafka/producer/AsyncProducerTest.scala    |  19 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  15 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  20 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  83 ++--
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |   4 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  11 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  26 +-
 .../scala/kafka/perf/ConsumerPerformance.scala     |   2 +-
 73 files changed, 2711 insertions(+), 2109 deletions(-)
3f1fbb1d077a63d49f2d0dbdca5eb95af1d987f1

 core/src/main/scala/kafka/api/FetchResponse.scala  | 22 +++++++--------
 .../src/main/scala/kafka/api/ProducerRequest.scala | 25 ++++++++++++++---
 .../kafka/consumer/ConsumerFetcherThread.scala     |  4 +--
 .../main/scala/kafka/network/RequestChannel.scala  |  2 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  4 +--
 .../scala/kafka/server/AbstractFetcherThread.scala |  4 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 10 +++----
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  4 +--
 .../kafka/network/RpcDataSerializationTest.scala   | 31 +++++++++++++++-------
 .../unit/kafka/network/SocketServerTest.scala      |  4 +--
 .../unit/kafka/producer/SyncProducerTest.scala     |  4 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  2 +-
 12 files changed, 74 insertions(+), 42 deletions(-)
c42726cdaf213544c965162925dd9bda75a62d91

 core/src/main/scala/kafka/producer/async/ProducerSendThread.scala | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)
3bb1c16691877a86754509d2170e40ce5804b78f

 .../scala/kafka/common/KafkaStorageException.scala | 25 ++++++++++++++++++++++
 core/src/main/scala/kafka/log/Log.scala            |  5 ++---
 core/src/main/scala/kafka/server/KafkaApis.scala   | 15 +++++--------
 3 files changed, 32 insertions(+), 13 deletions(-)
db4e02f2630d157ad021751aa47d0251bdac4d0e

 config/producer.properties                         |  5 ++--
 .../scala/kafka/message/CompressionCodec.scala     | 30 ++++++++++++++++++----
 .../main/scala/kafka/producer/ProducerConfig.scala | 11 +++++++-
 3 files changed, 38 insertions(+), 8 deletions(-)
db78c35fc051be561dadbf07dac9cedd659662a2

 core/src/main/scala/kafka/log/LogManager.scala                 | 9 ++++++---
 core/src/main/scala/kafka/server/HighwaterMarkCheckpoint.scala | 8 +-------
 2 files changed, 7 insertions(+), 10 deletions(-)
9623ae4de3e4c65ab2e90798843769795b8a00c6

 core/src/main/scala/kafka/cluster/Partition.scala                  | 6 ++++--
 core/src/main/scala/kafka/cluster/Replica.scala                    | 2 +-
 .../src/main/scala/kafka/controller/ControllerChannelManager.scala | 2 +-
 core/src/main/scala/kafka/controller/KafkaController.scala         | 2 +-
 core/src/main/scala/kafka/message/FileMessageSet.scala             | 7 +++----
 core/src/main/scala/kafka/network/RequestChannel.scala             | 6 ++++--
 core/src/main/scala/kafka/producer/SyncProducer.scala              | 5 ++---
 core/src/main/scala/kafka/server/AbstractFetcherThread.scala       | 2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala                   | 3 ++-
 core/src/main/scala/kafka/server/ReplicaFetcherManager.scala       | 2 +-
 core/src/main/scala/kafka/tools/DumpLogSegments.scala              | 5 ++++-
 11 files changed, 24 insertions(+), 18 deletions(-)
df3248b758340990010b6a83ebfced60b1339c4c
dd7f808d6d3d74d4cdee8e401f297f4f2d057937

 sbt                        | 15 +++++++++++++++
 system_test/common/util.sh | 14 ++++++++++++++
 2 files changed, 29 insertions(+)
77b511f696f7fa75777a003ade5065fab128bf38

 sbt                        | 15 +++++++++++++++
 system_test/common/util.sh | 14 ++++++++++++++
 2 files changed, 29 insertions(+)
80d571049f60414537d385d1c688a6fb7f724740

 sbt                        | 15 +++++++++++++++
 system_test/common/util.sh | 14 ++++++++++++++
 2 files changed, 29 insertions(+)
14b42f795641e13f9703286a527015cbf99a7788

 .../src/main/java/kafka/etl/KafkaETLContext.java   | 25 +++++--
 core/src/main/scala/kafka/api/FetchRequest.scala   |  8 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  | 73 +++++++++++++-----
 core/src/main/scala/kafka/api/OffsetResponse.scala | 84 ++++++++++++++-------
 .../main/scala/kafka/api/ProducerResponse.scala    |  5 +-
 .../main/scala/kafka/api/RequestOrResponse.scala   |  6 ++
 .../kafka/consumer/ConsumerFetcherThread.scala     | 11 +--
 .../main/scala/kafka/consumer/SimpleConsumer.scala | 16 +---
 .../consumer/ZookeeperConsumerConnector.scala      |  8 +-
 core/src/main/scala/kafka/javaapi/Implicits.scala  |  3 +
 .../main/scala/kafka/javaapi/OffsetRequest.scala   | 61 +++++++++++++++
 .../main/scala/kafka/javaapi/OffsetResponse.scala  | 49 ++++++++++++
 .../kafka/javaapi/consumer/SimpleConsumer.scala    | 13 ++--
 core/src/main/scala/kafka/log/Log.scala            | 21 +++---
 core/src/main/scala/kafka/log/LogManager.scala     | 10 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 45 +++++++----
 .../scala/kafka/server/ReplicaFetcherThread.scala  | 13 +++-
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 13 +++-
 .../main/scala/kafka/tools/GetOffsetShell.scala    |  7 +-
 .../main/scala/kafka/tools/UpdateOffsetsInZK.scala | 87 ++++++++++++++++++++++
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala | 84 ---------------------
 core/src/main/scala/kafka/utils/Utils.scala        |  7 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  | 69 +++++++++--------
 .../kafka/network/RpcDataSerializationTest.scala   | 13 ++--
 .../scala/unit/kafka/server/SimpleFetchTest.scala  | 65 +++++++++++++++-
 .../kafka/perf/SimpleConsumerPerformance.scala     | 12 ++-
 26 files changed, 554 insertions(+), 254 deletions(-)
3310531d8752c9d19bf3083f9b0c062c2578ba52

 .../main/scala/kafka/admin/CreateTopicCommand.scala | 14 +++-----------
 core/src/main/scala/kafka/server/KafkaApis.scala    |  6 ++----
 core/src/main/scala/kafka/server/KafkaConfig.scala  |  3 ---
 .../main/scala/kafka/tools/KafkaMigrationTool.java  | 21 +++++++++------------
 core/src/main/scala/kafka/utils/Topic.scala         | 19 ++++++++-----------
 .../src/test/scala/unit/kafka/utils/TopicTest.scala | 17 +++++++++++++----
 6 files changed, 35 insertions(+), 45 deletions(-)
1cf88bc6c5ede994f8d7ee46fffedc146a9d7d68

 .../kafka/consumer/ConsumerFetcherManager.scala    | 39 ++++++++++------
 .../consumer/ZookeeperConsumerConnector.scala      | 31 +++++++++----
 .../scala/kafka/producer/BrokerPartitionInfo.scala | 52 +++++++---------------
 .../main/scala/kafka/producer/ProducerPool.scala   | 17 +++----
 core/src/main/scala/kafka/utils/Utils.scala        | 30 +++++++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  8 ----
 6 files changed, 100 insertions(+), 77 deletions(-)
a77df21c4d7863e24f72664d858419dd1c7c41f7
85d5edfa9c8c519ceb4ec9c375645c38616e2bbe

 LICENSE | 31 +------------------------------
 NOTICE  |  5 -----
 2 files changed, 1 insertion(+), 35 deletions(-)
12336aedf293e698111773d0a013e02761ff93a3

 LICENSE | 31 +------------------------------
 NOTICE  |  5 -----
 2 files changed, 1 insertion(+), 35 deletions(-)
2a62bdb040352f838fd0afceb9983c35a6a9dafe

 LICENSE | 31 +------------------------------
 NOTICE  |  5 -----
 2 files changed, 1 insertion(+), 35 deletions(-)
9a4ef48ef145e2fecf3b6f4154e5086c5e00e848

 clients/cpp/LICENSE                                | 203 -----
 clients/cpp/Makefile.am                            |  51 --
 clients/cpp/README.md                              |  56 --
 clients/cpp/autoconf.sh                            |  33 -
 clients/cpp/configure.ac                           |  42 -
 clients/cpp/src/encoder.hpp                        |  62 --
 clients/cpp/src/encoder_helper.hpp                 |  79 --
 clients/cpp/src/example.cpp                        |  54 --
 clients/cpp/src/producer.cpp                       | 117 ---
 clients/cpp/src/producer.hpp                       | 116 ---
 clients/cpp/src/tests/encoder_helper_tests.cpp     |  88 --
 clients/cpp/src/tests/encoder_tests.cpp            |  69 --
 clients/cpp/src/tests/producer_tests.cpp           |  76 --
 clients/csharp/.gitignore                          |   5 -
 clients/csharp/LICENSE                             | 202 -----
 clients/csharp/README.md                           |  66 --
 clients/csharp/Settings.StyleCop                   |  92 ---
 .../csharp/lib/StyleCop/Microsoft.StyleCop.Targets | 125 ---
 clients/csharp/lib/StyleCop/Settings.StyleCop      |  48 --
 clients/csharp/lib/nunit/2.5.9/nunit.framework.dll | Bin 135168 -> 0 bytes
 .../src/Kafka/Kafka.Client/AbstractRequest.cs      |  51 --
 .../Kafka/Kafka.Client/Cfg/AsyncProducerConfig.cs  |  74 --
 .../Kafka/Kafka.Client/Cfg/BrokerPartitionInfo.cs  |  72 --
 .../Cfg/BrokerPartitionInfoCollection.cs           |  52 --
 .../csharp/src/Kafka/Kafka.Client/Cfg/Consumer.cs  | 136 ----
 .../src/Kafka/Kafka.Client/Cfg/ConsumerConfig.cs   |  72 --
 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs |  26 -
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  |  30 -
 .../Kafka.Client/Cfg/KafkaClientConfiguration.cs   |  93 ---
 .../src/Kafka/Kafka.Client/Cfg/KafkaServer.cs      |  52 --
 .../src/Kafka/Kafka.Client/Cfg/ProducerConfig.cs   |  94 ---
 .../Kafka/Kafka.Client/Cfg/SyncProducerConfig.cs   |  66 --
 .../csharp/src/Kafka/Kafka.Client/Cfg/ZKConfig.cs  |  43 -
 .../src/Kafka/Kafka.Client/Cfg/ZooKeeperServers.cs |  45 --
 .../src/Kafka/Kafka.Client/Cluster/Broker.cs       |  68 --
 .../src/Kafka/Kafka.Client/Cluster/Cluster.cs      | 130 ---
 .../src/Kafka/Kafka.Client/Cluster/Partition.cs    | 147 ----
 clients/csharp/src/Kafka/Kafka.Client/Consumer.cs  | 249 ------
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 235 ------
 .../Kafka.Client/Consumers/ConsumerIterator.cs     | 211 -----
 .../Consumers/ConsumerIteratorState.cs             |  28 -
 .../Kafka.Client/Consumers/FetchedDataChunk.cs     |  58 --
 .../src/Kafka/Kafka.Client/Consumers/Fetcher.cs    | 170 ----
 .../Kafka.Client/Consumers/FetcherRunnable.cs      | 191 -----
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  |  74 --
 .../Kafka.Client/Consumers/IConsumerConnector.cs   |  45 --
 .../Kafka.Client/Consumers/KafkaMessageStream.cs   |  53 --
 .../Kafka.Client/Consumers/PartitionTopicInfo.cs   | 198 -----
 .../src/Kafka/Kafka.Client/Consumers/TopicCount.cs | 111 ---
 .../Consumers/ZookeeperConsumerConnector.cs        | 322 --------
 .../Exceptions/ConsumerTimeoutException.cs         |  28 -
 .../Kafka.Client/Exceptions/KafkaException.cs      | 100 ---
 .../Exceptions/MessageSizeTooLargeException.cs     |  25 -
 .../Exceptions/ZKRebalancerException.cs            |  33 -
 .../Kafka.Client/Exceptions/ZooKeeperException.cs  |  45 --
 .../Exceptions/ZooKeeperTimeoutException.cs        |  34 -
 .../src/Kafka/Kafka.Client/Kafka.Client.csproj     | 245 ------
 .../src/Kafka/Kafka.Client/KafkaClientBase.cs      |  44 -
 .../src/Kafka/Kafka.Client/KafkaConnection.cs      | 224 ------
 .../src/Kafka/Kafka.Client/KafkaException.cs       |  98 ---
 clients/csharp/src/Kafka/Kafka.Client/Message.cs   | 157 ----
 .../Kafka/Kafka.Client/Messages/BoundedBuffer.cs   |  38 -
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 407 ----------
 .../src/Kafka/Kafka.Client/Messages/Message.cs     | 329 --------
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  |  91 ---
 clients/csharp/src/Kafka/Kafka.Client/Producer.cs  | 152 ----
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  | 207 -----
 .../Producers/Async/AsyncProducerPool.cs           | 224 ------
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs |  80 --
 .../Producers/Async/ICallbackHandler.cs            |  35 -
 .../Kafka.Client/Producers/Async/MessageSent.cs    |  31 -
 .../src/Kafka/Kafka.Client/Producers/IProducer.cs  |  46 --
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  |  58 --
 .../Partitioning/ConfigBrokerPartitionInfo.cs      | 119 ---
 .../Producers/Partitioning/DefaultPartitioner.cs   |  50 --
 .../Producers/Partitioning/IBrokerPartitionInfo.cs |  49 --
 .../Producers/Partitioning/IPartitioner.cs         |  36 -
 .../Partitioning/ZKBrokerPartitionInfo.cs          | 342 --------
 .../Kafka.Client/Producers/Producer.StrMsg.cs      |  96 ---
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   | 337 --------
 .../Kafka/Kafka.Client/Producers/ProducerData.cs   |  95 ---
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   | 206 -----
 .../Kafka.Client/Producers/ProducerPoolData.cs     |  65 --
 .../Kafka/Kafka.Client/Producers/ProducerTypes.cs  |  29 -
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   |  60 --
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    | 155 ----
 .../Producers/Sync/SyncProducerPool.cs             | 226 ------
 .../Kafka/Kafka.Client/Properties/AssemblyInfo.cs  |  34 -
 .../src/Kafka/Kafka.Client/Request/FetchRequest.cs | 129 ---
 .../Kafka.Client/Request/MultiFetchRequest.cs      |  79 --
 .../Kafka.Client/Request/MultiProducerRequest.cs   |  87 --
 .../Kafka/Kafka.Client/Request/OffsetRequest.cs    | 107 ---
 .../Kafka/Kafka.Client/Request/ProducerRequest.cs  | 115 ---
 .../src/Kafka/Kafka.Client/RequestContext.cs       |  54 --
 .../csharp/src/Kafka/Kafka.Client/RequestType.cs   |  53 --
 .../Kafka/Kafka.Client/Requests/AbstractRequest.cs |  61 --
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    | 156 ----
 .../Kafka.Client/Requests/MultiFetchRequest.cs     | 109 ---
 .../Kafka.Client/Requests/MultiProducerRequest.cs  | 134 ----
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   | 136 ----
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs | 142 ----
 .../Kafka/Kafka.Client/Requests/RequestTypes.cs    |  53 --
 .../Kafka.Client/Serialization/DefaultEncoder.cs   |  41 -
 .../Kafka/Kafka.Client/Serialization/IEncoder.cs   |  41 -
 .../Kafka/Kafka.Client/Serialization/IWritable.cs  |  43 -
 .../Serialization/KafkaBinaryReader.cs             | 148 ----
 .../Serialization/KafkaBinaryWriter.cs             | 127 ---
 .../Kafka.Client/Serialization/StringEncoder.cs    |  43 -
 .../csharp/src/Kafka/Kafka.Client/Util/BitWorks.cs |  86 --
 .../csharp/src/Kafka/Kafka.Client/Util/Crc32.cs    | 132 ---
 .../src/Kafka/Kafka.Client/Utils/BitWorks.cs       |  83 --
 .../src/Kafka/Kafka.Client/Utils/Crc32Hasher.cs    | 138 ----
 .../src/Kafka/Kafka.Client/Utils/ErrorMapping.cs   |  29 -
 .../src/Kafka/Kafka.Client/Utils/Extensions.cs     |  49 --
 .../csharp/src/Kafka/Kafka.Client/Utils/Guard.cs   | 120 ---
 .../src/Kafka/Kafka.Client/Utils/KafkaScheduler.cs |  86 --
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   |  56 --
 .../src/Kafka/Kafka.Client/Utils/ZKGroupDirs.cs    |  39 -
 .../Kafka/Kafka.Client/Utils/ZKGroupTopicDirs.cs   |  32 -
 .../csharp/src/Kafka/Kafka.Client/Utils/ZkUtils.cs | 147 ----
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  |  44 -
 .../Events/ChildChangedEventItem.cs                | 113 ---
 .../Events/DataChangedEventItem.cs                 | 161 ----
 .../Events/ZooKeeperChildChangedEventArgs.cs       |  60 --
 .../Events/ZooKeeperDataChangedEventArgs.cs        |  88 --
 .../Events/ZooKeeperEventArgs.cs                   |  56 --
 .../Events/ZooKeeperEventTypes.cs                  |  35 -
 .../Events/ZooKeeperSessionCreatedEventArgs.cs     |  46 --
 .../Events/ZooKeeperStateChangedEventArgs.cs       |  55 --
 .../ZooKeeperIntegration/IZooKeeperClient.cs       | 469 -----------
 .../ZooKeeperIntegration/IZooKeeperConnection.cs   | 164 ----
 .../ZooKeeperIntegration/IZooKeeperSerializer.cs   |  48 --
 .../Listeners/BrokerTopicsListener.cs              | 257 ------
 .../Listeners/IZooKeeperChildListener.cs           |  43 -
 .../Listeners/IZooKeeperDataListener.cs            |  49 --
 .../Listeners/IZooKeeperStateListener.cs           |  42 -
 .../Listeners/ZKRebalancerListener.cs              | 368 ---------
 .../Listeners/ZKSessionExpireListener.cs           |  86 --
 .../ZooKeeperClient.Watcher.cs                     | 682 ----------------
 .../ZooKeeperIntegration/ZooKeeperClient.cs        | 893 ---------------------
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    | 327 --------
 .../ZooKeeperStringSerializer.cs                   |  72 --
 clients/csharp/src/Kafka/Kafka.FxCop               | 120 ---
 clients/csharp/src/Kafka/Kafka.sln                 |  61 --
 .../Tests/Kafka.Client.IntegrationTests/App.config |  43 -
 .../Config/Debug/App.config                        |  43 -
 .../Config/Integration/App.config                  |  37 -
 .../ConsumerRebalancingTests.cs                    | 236 ------
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 307 -------
 .../IntegrationFixtureBase.cs                      | 147 ----
 .../Kafka.Client.IntegrationTests.csproj           | 141 ----
 .../KafkaIntegrationTest.cs                        | 488 -----------
 .../Kafka.Client.IntegrationTests/Log4Net.config   |  55 --
 .../MockAlwaysZeroPartitioner.cs                   |  34 -
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 226 ------
 .../Properties/AssemblyInfo.cs                     |  52 --
 .../Kafka.Client.IntegrationTests/TestHelper.cs    |  48 --
 .../TestMultipleBrokersHelper.cs                   |  78 --
 .../Kafka.Client.IntegrationTests/TestsSetup.cs    |  35 -
 .../ZKBrokerPartitionInfoTests.cs                  | 464 -----------
 .../ZooKeeperAwareProducerTests.cs                 | 224 ------
 .../ZooKeeperClientTests.cs                        | 411 ----------
 .../ZooKeeperConnectionTests.cs                    | 118 ---
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   | 118 ---
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    | 108 ---
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs | 138 ----
 .../Producers/PartitioningTests.cs                 |  73 --
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs  |  51 --
 .../Request/FetchRequestTests.cs                   |  76 --
 .../Request/MultiFetchRequestTests.cs              |  78 --
 .../Request/MultiProducerRequestTests.cs           |  69 --
 .../Request/OffsetRequestTests.cs                  |  73 --
 .../Request/ProducerRequestTests.cs                |  77 --
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs | 121 ---
 clients/go/.gitignore                              |  13 -
 clients/go/LICENSE                                 | 208 -----
 clients/go/Makefile                                |  26 -
 clients/go/README.md                               |  99 ---
 clients/go/kafka_test.go                           | 277 -------
 clients/go/src/consumer.go                         | 199 -----
 clients/go/src/converts.go                         |  51 --
 clients/go/src/kafka.go                            |  95 ---
 clients/go/src/message.go                          | 182 -----
 clients/go/src/payload_codec.go                    | 116 ---
 clients/go/src/publisher.go                        |  55 --
 clients/go/src/request.go                          | 101 ---
 clients/go/src/timing.go                           |  49 --
 clients/go/tools/consumer/Makefile                 |   7 -
 clients/go/tools/consumer/consumer.go              | 111 ---
 clients/go/tools/offsets/Makefile                  |   7 -
 clients/go/tools/offsets/offsets.go                |  62 --
 clients/go/tools/publisher/Makefile                |   7 -
 clients/go/tools/publisher/publisher.go            |  89 --
 clients/php/LICENSE                                | 203 -----
 clients/php/README.md                              |  20 -
 clients/php/src/examples/autoloader.php            |  40 -
 clients/php/src/examples/consume.php               |  53 --
 clients/php/src/examples/produce.php               |  46 --
 .../src/lib/Kafka/BoundedByteBuffer/Receive.php    | 154 ----
 .../php/src/lib/Kafka/BoundedByteBuffer/Send.php   | 118 ---
 clients/php/src/lib/Kafka/Encoder.php              |  73 --
 clients/php/src/lib/Kafka/FetchRequest.php         | 126 ---
 clients/php/src/lib/Kafka/Message.php              | 126 ---
 clients/php/src/lib/Kafka/MessageSet.php           | 122 ---
 clients/php/src/lib/Kafka/Producer.php             | 122 ---
 clients/php/src/lib/Kafka/Request.php              |  30 -
 clients/php/src/lib/Kafka/RequestKeys.php          |  30 -
 clients/php/src/lib/Kafka/SimpleConsumer.php       | 142 ----
 .../tests/Kafka/BoundedByteBuffer/ReceiveTest.php  | 133 ---
 .../src/tests/Kafka/BoundedByteBuffer/SendTest.php | 100 ---
 clients/php/src/tests/Kafka/EncoderTest.php        |  61 --
 clients/php/src/tests/Kafka/FetchRequestTest.php   |  88 --
 clients/php/src/tests/Kafka/MessageTest.php        |  62 --
 clients/php/src/tests/Kafka/ProducerTest.php       |  76 --
 clients/php/src/tests/bootstrap.php                |  53 --
 clients/php/src/tests/phpunit.xml                  |  17 -
 clients/python/LICENSE                             | 203 -----
 clients/python/kafka.py                            |  73 --
 clients/python/setup.py                            |  33 -
 clients/ruby/LICENSE                               | 202 -----
 clients/ruby/README.md                             |  62 --
 clients/ruby/Rakefile                              |  76 --
 clients/ruby/TODO                                  |   1 -
 clients/ruby/kafka-rb.gemspec                      |  46 --
 clients/ruby/lib/kafka.rb                          |  27 -
 clients/ruby/lib/kafka/batch.rb                    |  27 -
 clients/ruby/lib/kafka/consumer.rb                 | 149 ----
 clients/ruby/lib/kafka/error_codes.rb              |  35 -
 clients/ruby/lib/kafka/io.rb                       |  53 --
 clients/ruby/lib/kafka/message.rb                  |  49 --
 clients/ruby/lib/kafka/producer.rb                 |  63 --
 clients/ruby/lib/kafka/request_type.rb             |  23 -
 clients/ruby/spec/batch_spec.rb                    |  35 -
 clients/ruby/spec/consumer_spec.rb                 | 134 ----
 clients/ruby/spec/io_spec.rb                       |  91 ---
 clients/ruby/spec/kafka_spec.rb                    |  21 -
 clients/ruby/spec/message_spec.rb                  |  69 --
 clients/ruby/spec/producer_spec.rb                 | 109 ---
 clients/ruby/spec/spec_helper.rb                   |  18 -
 239 files changed, 26121 deletions(-)
d895420f57e970fd47d1eb401cf3db613c60eeef

 clients/cpp/LICENSE                                | 203 -----
 clients/cpp/Makefile.am                            |  51 --
 clients/cpp/README.md                              |  56 --
 clients/cpp/autoconf.sh                            |  33 -
 clients/cpp/configure.ac                           |  42 -
 clients/cpp/src/encoder.hpp                        |  62 --
 clients/cpp/src/encoder_helper.hpp                 |  79 --
 clients/cpp/src/example.cpp                        |  54 --
 clients/cpp/src/producer.cpp                       | 117 ---
 clients/cpp/src/producer.hpp                       | 116 ---
 clients/cpp/src/tests/encoder_helper_tests.cpp     |  88 --
 clients/cpp/src/tests/encoder_tests.cpp            |  69 --
 clients/cpp/src/tests/producer_tests.cpp           |  76 --
 clients/csharp/.gitignore                          |   5 -
 clients/csharp/LICENSE                             | 202 -----
 clients/csharp/README.md                           |  66 --
 clients/csharp/Settings.StyleCop                   |  92 ---
 .../csharp/lib/StyleCop/Microsoft.StyleCop.Targets | 125 ---
 clients/csharp/lib/StyleCop/Settings.StyleCop      |  48 --
 clients/csharp/lib/nunit/2.5.9/nunit.framework.dll | Bin 135168 -> 0 bytes
 .../src/Kafka/Kafka.Client/AbstractRequest.cs      |  51 --
 .../Kafka/Kafka.Client/Cfg/AsyncProducerConfig.cs  |  74 --
 .../Kafka/Kafka.Client/Cfg/BrokerPartitionInfo.cs  |  72 --
 .../Cfg/BrokerPartitionInfoCollection.cs           |  52 --
 .../csharp/src/Kafka/Kafka.Client/Cfg/Consumer.cs  | 136 ----
 .../src/Kafka/Kafka.Client/Cfg/ConsumerConfig.cs   |  72 --
 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs |  26 -
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  |  30 -
 .../Kafka.Client/Cfg/KafkaClientConfiguration.cs   |  93 ---
 .../src/Kafka/Kafka.Client/Cfg/KafkaServer.cs      |  52 --
 .../src/Kafka/Kafka.Client/Cfg/ProducerConfig.cs   |  94 ---
 .../Kafka/Kafka.Client/Cfg/SyncProducerConfig.cs   |  66 --
 .../csharp/src/Kafka/Kafka.Client/Cfg/ZKConfig.cs  |  43 -
 .../src/Kafka/Kafka.Client/Cfg/ZooKeeperServers.cs |  45 --
 .../src/Kafka/Kafka.Client/Cluster/Broker.cs       |  68 --
 .../src/Kafka/Kafka.Client/Cluster/Cluster.cs      | 130 ---
 .../src/Kafka/Kafka.Client/Cluster/Partition.cs    | 147 ----
 clients/csharp/src/Kafka/Kafka.Client/Consumer.cs  | 249 ------
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 235 ------
 .../Kafka.Client/Consumers/ConsumerIterator.cs     | 211 -----
 .../Consumers/ConsumerIteratorState.cs             |  28 -
 .../Kafka.Client/Consumers/FetchedDataChunk.cs     |  58 --
 .../src/Kafka/Kafka.Client/Consumers/Fetcher.cs    | 170 ----
 .../Kafka.Client/Consumers/FetcherRunnable.cs      | 191 -----
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  |  74 --
 .../Kafka.Client/Consumers/IConsumerConnector.cs   |  45 --
 .../Kafka.Client/Consumers/KafkaMessageStream.cs   |  53 --
 .../Kafka.Client/Consumers/PartitionTopicInfo.cs   | 198 -----
 .../src/Kafka/Kafka.Client/Consumers/TopicCount.cs | 111 ---
 .../Consumers/ZookeeperConsumerConnector.cs        | 322 --------
 .../Exceptions/ConsumerTimeoutException.cs         |  28 -
 .../Kafka.Client/Exceptions/KafkaException.cs      | 100 ---
 .../Exceptions/MessageSizeTooLargeException.cs     |  25 -
 .../Exceptions/ZKRebalancerException.cs            |  33 -
 .../Kafka.Client/Exceptions/ZooKeeperException.cs  |  45 --
 .../Exceptions/ZooKeeperTimeoutException.cs        |  34 -
 .../src/Kafka/Kafka.Client/Kafka.Client.csproj     | 245 ------
 .../src/Kafka/Kafka.Client/KafkaClientBase.cs      |  44 -
 .../src/Kafka/Kafka.Client/KafkaConnection.cs      | 224 ------
 .../src/Kafka/Kafka.Client/KafkaException.cs       |  98 ---
 clients/csharp/src/Kafka/Kafka.Client/Message.cs   | 157 ----
 .../Kafka/Kafka.Client/Messages/BoundedBuffer.cs   |  38 -
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 407 ----------
 .../src/Kafka/Kafka.Client/Messages/Message.cs     | 329 --------
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  |  91 ---
 clients/csharp/src/Kafka/Kafka.Client/Producer.cs  | 152 ----
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  | 207 -----
 .../Producers/Async/AsyncProducerPool.cs           | 224 ------
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs |  80 --
 .../Producers/Async/ICallbackHandler.cs            |  35 -
 .../Kafka.Client/Producers/Async/MessageSent.cs    |  31 -
 .../src/Kafka/Kafka.Client/Producers/IProducer.cs  |  46 --
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  |  58 --
 .../Partitioning/ConfigBrokerPartitionInfo.cs      | 119 ---
 .../Producers/Partitioning/DefaultPartitioner.cs   |  50 --
 .../Producers/Partitioning/IBrokerPartitionInfo.cs |  49 --
 .../Producers/Partitioning/IPartitioner.cs         |  36 -
 .../Partitioning/ZKBrokerPartitionInfo.cs          | 342 --------
 .../Kafka.Client/Producers/Producer.StrMsg.cs      |  96 ---
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   | 337 --------
 .../Kafka/Kafka.Client/Producers/ProducerData.cs   |  95 ---
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   | 206 -----
 .../Kafka.Client/Producers/ProducerPoolData.cs     |  65 --
 .../Kafka/Kafka.Client/Producers/ProducerTypes.cs  |  29 -
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   |  60 --
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    | 155 ----
 .../Producers/Sync/SyncProducerPool.cs             | 226 ------
 .../Kafka/Kafka.Client/Properties/AssemblyInfo.cs  |  34 -
 .../src/Kafka/Kafka.Client/Request/FetchRequest.cs | 129 ---
 .../Kafka.Client/Request/MultiFetchRequest.cs      |  79 --
 .../Kafka.Client/Request/MultiProducerRequest.cs   |  87 --
 .../Kafka/Kafka.Client/Request/OffsetRequest.cs    | 107 ---
 .../Kafka/Kafka.Client/Request/ProducerRequest.cs  | 115 ---
 .../src/Kafka/Kafka.Client/RequestContext.cs       |  54 --
 .../csharp/src/Kafka/Kafka.Client/RequestType.cs   |  53 --
 .../Kafka/Kafka.Client/Requests/AbstractRequest.cs |  61 --
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    | 156 ----
 .../Kafka.Client/Requests/MultiFetchRequest.cs     | 109 ---
 .../Kafka.Client/Requests/MultiProducerRequest.cs  | 134 ----
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   | 136 ----
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs | 142 ----
 .../Kafka/Kafka.Client/Requests/RequestTypes.cs    |  53 --
 .../Kafka.Client/Serialization/DefaultEncoder.cs   |  41 -
 .../Kafka/Kafka.Client/Serialization/IEncoder.cs   |  41 -
 .../Kafka/Kafka.Client/Serialization/IWritable.cs  |  43 -
 .../Serialization/KafkaBinaryReader.cs             | 148 ----
 .../Serialization/KafkaBinaryWriter.cs             | 127 ---
 .../Kafka.Client/Serialization/StringEncoder.cs    |  43 -
 .../csharp/src/Kafka/Kafka.Client/Util/BitWorks.cs |  86 --
 .../csharp/src/Kafka/Kafka.Client/Util/Crc32.cs    | 132 ---
 .../src/Kafka/Kafka.Client/Utils/BitWorks.cs       |  83 --
 .../src/Kafka/Kafka.Client/Utils/Crc32Hasher.cs    | 138 ----
 .../src/Kafka/Kafka.Client/Utils/ErrorMapping.cs   |  29 -
 .../src/Kafka/Kafka.Client/Utils/Extensions.cs     |  49 --
 .../csharp/src/Kafka/Kafka.Client/Utils/Guard.cs   | 120 ---
 .../src/Kafka/Kafka.Client/Utils/KafkaScheduler.cs |  86 --
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   |  56 --
 .../src/Kafka/Kafka.Client/Utils/ZKGroupDirs.cs    |  39 -
 .../Kafka/Kafka.Client/Utils/ZKGroupTopicDirs.cs   |  32 -
 .../csharp/src/Kafka/Kafka.Client/Utils/ZkUtils.cs | 147 ----
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  |  44 -
 .../Events/ChildChangedEventItem.cs                | 113 ---
 .../Events/DataChangedEventItem.cs                 | 161 ----
 .../Events/ZooKeeperChildChangedEventArgs.cs       |  60 --
 .../Events/ZooKeeperDataChangedEventArgs.cs        |  88 --
 .../Events/ZooKeeperEventArgs.cs                   |  56 --
 .../Events/ZooKeeperEventTypes.cs                  |  35 -
 .../Events/ZooKeeperSessionCreatedEventArgs.cs     |  46 --
 .../Events/ZooKeeperStateChangedEventArgs.cs       |  55 --
 .../ZooKeeperIntegration/IZooKeeperClient.cs       | 469 -----------
 .../ZooKeeperIntegration/IZooKeeperConnection.cs   | 164 ----
 .../ZooKeeperIntegration/IZooKeeperSerializer.cs   |  48 --
 .../Listeners/BrokerTopicsListener.cs              | 257 ------
 .../Listeners/IZooKeeperChildListener.cs           |  43 -
 .../Listeners/IZooKeeperDataListener.cs            |  49 --
 .../Listeners/IZooKeeperStateListener.cs           |  42 -
 .../Listeners/ZKRebalancerListener.cs              | 368 ---------
 .../Listeners/ZKSessionExpireListener.cs           |  86 --
 .../ZooKeeperClient.Watcher.cs                     | 682 ----------------
 .../ZooKeeperIntegration/ZooKeeperClient.cs        | 893 ---------------------
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    | 327 --------
 .../ZooKeeperStringSerializer.cs                   |  72 --
 clients/csharp/src/Kafka/Kafka.FxCop               | 120 ---
 clients/csharp/src/Kafka/Kafka.sln                 |  61 --
 .../Tests/Kafka.Client.IntegrationTests/App.config |  43 -
 .../Config/Debug/App.config                        |  43 -
 .../Config/Integration/App.config                  |  37 -
 .../ConsumerRebalancingTests.cs                    | 236 ------
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 307 -------
 .../IntegrationFixtureBase.cs                      | 147 ----
 .../Kafka.Client.IntegrationTests.csproj           | 141 ----
 .../KafkaIntegrationTest.cs                        | 488 -----------
 .../Kafka.Client.IntegrationTests/Log4Net.config   |  55 --
 .../MockAlwaysZeroPartitioner.cs                   |  34 -
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 226 ------
 .../Properties/AssemblyInfo.cs                     |  52 --
 .../Kafka.Client.IntegrationTests/TestHelper.cs    |  48 --
 .../TestMultipleBrokersHelper.cs                   |  78 --
 .../Kafka.Client.IntegrationTests/TestsSetup.cs    |  35 -
 .../ZKBrokerPartitionInfoTests.cs                  | 464 -----------
 .../ZooKeeperAwareProducerTests.cs                 | 224 ------
 .../ZooKeeperClientTests.cs                        | 411 ----------
 .../ZooKeeperConnectionTests.cs                    | 118 ---
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   | 118 ---
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    | 108 ---
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs | 138 ----
 .../Producers/PartitioningTests.cs                 |  73 --
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs  |  51 --
 .../Request/FetchRequestTests.cs                   |  76 --
 .../Request/MultiFetchRequestTests.cs              |  78 --
 .../Request/MultiProducerRequestTests.cs           |  69 --
 .../Request/OffsetRequestTests.cs                  |  73 --
 .../Request/ProducerRequestTests.cs                |  77 --
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs | 121 ---
 clients/go/.gitignore                              |  13 -
 clients/go/LICENSE                                 | 208 -----
 clients/go/Makefile                                |  26 -
 clients/go/README.md                               |  99 ---
 clients/go/kafka_test.go                           | 277 -------
 clients/go/src/consumer.go                         | 199 -----
 clients/go/src/converts.go                         |  51 --
 clients/go/src/kafka.go                            |  95 ---
 clients/go/src/message.go                          | 182 -----
 clients/go/src/payload_codec.go                    | 116 ---
 clients/go/src/publisher.go                        |  55 --
 clients/go/src/request.go                          | 101 ---
 clients/go/src/timing.go                           |  49 --
 clients/go/tools/consumer/Makefile                 |   7 -
 clients/go/tools/consumer/consumer.go              | 111 ---
 clients/go/tools/offsets/Makefile                  |   7 -
 clients/go/tools/offsets/offsets.go                |  62 --
 clients/go/tools/publisher/Makefile                |   7 -
 clients/go/tools/publisher/publisher.go            |  89 --
 clients/php/LICENSE                                | 203 -----
 clients/php/README.md                              |  20 -
 clients/php/src/examples/autoloader.php            |  40 -
 clients/php/src/examples/consume.php               |  53 --
 clients/php/src/examples/produce.php               |  46 --
 .../src/lib/Kafka/BoundedByteBuffer/Receive.php    | 154 ----
 .../php/src/lib/Kafka/BoundedByteBuffer/Send.php   | 118 ---
 clients/php/src/lib/Kafka/Encoder.php              |  73 --
 clients/php/src/lib/Kafka/FetchRequest.php         | 126 ---
 clients/php/src/lib/Kafka/Message.php              | 126 ---
 clients/php/src/lib/Kafka/MessageSet.php           | 122 ---
 clients/php/src/lib/Kafka/Producer.php             | 122 ---
 clients/php/src/lib/Kafka/Request.php              |  30 -
 clients/php/src/lib/Kafka/RequestKeys.php          |  30 -
 clients/php/src/lib/Kafka/SimpleConsumer.php       | 142 ----
 .../tests/Kafka/BoundedByteBuffer/ReceiveTest.php  | 133 ---
 .../src/tests/Kafka/BoundedByteBuffer/SendTest.php | 100 ---
 clients/php/src/tests/Kafka/EncoderTest.php        |  61 --
 clients/php/src/tests/Kafka/FetchRequestTest.php   |  88 --
 clients/php/src/tests/Kafka/MessageTest.php        |  62 --
 clients/php/src/tests/Kafka/ProducerTest.php       |  76 --
 clients/php/src/tests/bootstrap.php                |  53 --
 clients/php/src/tests/phpunit.xml                  |  17 -
 clients/python/LICENSE                             | 203 -----
 clients/python/kafka.py                            |  73 --
 clients/python/setup.py                            |  33 -
 clients/ruby/LICENSE                               | 202 -----
 clients/ruby/README.md                             |  62 --
 clients/ruby/Rakefile                              |  76 --
 clients/ruby/TODO                                  |   1 -
 clients/ruby/kafka-rb.gemspec                      |  46 --
 clients/ruby/lib/kafka.rb                          |  27 -
 clients/ruby/lib/kafka/batch.rb                    |  27 -
 clients/ruby/lib/kafka/consumer.rb                 | 149 ----
 clients/ruby/lib/kafka/error_codes.rb              |  35 -
 clients/ruby/lib/kafka/io.rb                       |  53 --
 clients/ruby/lib/kafka/message.rb                  |  49 --
 clients/ruby/lib/kafka/producer.rb                 |  63 --
 clients/ruby/lib/kafka/request_type.rb             |  23 -
 clients/ruby/spec/batch_spec.rb                    |  35 -
 clients/ruby/spec/consumer_spec.rb                 | 134 ----
 clients/ruby/spec/io_spec.rb                       |  91 ---
 clients/ruby/spec/kafka_spec.rb                    |  21 -
 clients/ruby/spec/message_spec.rb                  |  69 --
 clients/ruby/spec/producer_spec.rb                 | 109 ---
 clients/ruby/spec/spec_helper.rb                   |  18 -
 239 files changed, 26121 deletions(-)
e9d07d72fa3bd29d61b4995abff07ea287853f6b

 clients/cpp/LICENSE                                | 203 -----
 clients/cpp/Makefile.am                            |  51 --
 clients/cpp/README.md                              |  56 --
 clients/cpp/autoconf.sh                            |  33 -
 clients/cpp/configure.ac                           |  42 -
 clients/cpp/src/encoder.hpp                        |  62 --
 clients/cpp/src/encoder_helper.hpp                 |  79 --
 clients/cpp/src/example.cpp                        |  54 --
 clients/cpp/src/producer.cpp                       | 117 ---
 clients/cpp/src/producer.hpp                       | 116 ---
 clients/cpp/src/tests/encoder_helper_tests.cpp     |  88 --
 clients/cpp/src/tests/encoder_tests.cpp            |  69 --
 clients/cpp/src/tests/producer_tests.cpp           |  76 --
 clients/csharp/.gitignore                          |   5 -
 clients/csharp/LICENSE                             | 202 -----
 clients/csharp/README.md                           |  66 --
 clients/csharp/Settings.StyleCop                   |  92 ---
 .../csharp/lib/StyleCop/Microsoft.StyleCop.Targets | 125 ---
 clients/csharp/lib/StyleCop/Settings.StyleCop      |  48 --
 clients/csharp/lib/nunit/2.5.9/nunit.framework.dll | Bin 135168 -> 0 bytes
 .../src/Kafka/Kafka.Client/AbstractRequest.cs      |  51 --
 .../Kafka/Kafka.Client/Cfg/AsyncProducerConfig.cs  |  74 --
 .../Kafka/Kafka.Client/Cfg/BrokerPartitionInfo.cs  |  72 --
 .../Cfg/BrokerPartitionInfoCollection.cs           |  52 --
 .../csharp/src/Kafka/Kafka.Client/Cfg/Consumer.cs  | 136 ----
 .../src/Kafka/Kafka.Client/Cfg/ConsumerConfig.cs   |  72 --
 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs |  26 -
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  |  30 -
 .../Kafka.Client/Cfg/KafkaClientConfiguration.cs   |  93 ---
 .../src/Kafka/Kafka.Client/Cfg/KafkaServer.cs      |  52 --
 .../src/Kafka/Kafka.Client/Cfg/ProducerConfig.cs   |  94 ---
 .../Kafka/Kafka.Client/Cfg/SyncProducerConfig.cs   |  66 --
 .../csharp/src/Kafka/Kafka.Client/Cfg/ZKConfig.cs  |  43 -
 .../src/Kafka/Kafka.Client/Cfg/ZooKeeperServers.cs |  45 --
 .../src/Kafka/Kafka.Client/Cluster/Broker.cs       |  68 --
 .../src/Kafka/Kafka.Client/Cluster/Cluster.cs      | 130 ---
 .../src/Kafka/Kafka.Client/Cluster/Partition.cs    | 147 ----
 clients/csharp/src/Kafka/Kafka.Client/Consumer.cs  | 249 ------
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 235 ------
 .../Kafka.Client/Consumers/ConsumerIterator.cs     | 211 -----
 .../Consumers/ConsumerIteratorState.cs             |  28 -
 .../Kafka.Client/Consumers/FetchedDataChunk.cs     |  58 --
 .../src/Kafka/Kafka.Client/Consumers/Fetcher.cs    | 170 ----
 .../Kafka.Client/Consumers/FetcherRunnable.cs      | 191 -----
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  |  74 --
 .../Kafka.Client/Consumers/IConsumerConnector.cs   |  45 --
 .../Kafka.Client/Consumers/KafkaMessageStream.cs   |  53 --
 .../Kafka.Client/Consumers/PartitionTopicInfo.cs   | 198 -----
 .../src/Kafka/Kafka.Client/Consumers/TopicCount.cs | 111 ---
 .../Consumers/ZookeeperConsumerConnector.cs        | 322 --------
 .../Exceptions/ConsumerTimeoutException.cs         |  28 -
 .../Kafka.Client/Exceptions/KafkaException.cs      | 100 ---
 .../Exceptions/MessageSizeTooLargeException.cs     |  25 -
 .../Exceptions/ZKRebalancerException.cs            |  33 -
 .../Kafka.Client/Exceptions/ZooKeeperException.cs  |  45 --
 .../Exceptions/ZooKeeperTimeoutException.cs        |  34 -
 .../src/Kafka/Kafka.Client/Kafka.Client.csproj     | 245 ------
 .../src/Kafka/Kafka.Client/KafkaClientBase.cs      |  44 -
 .../src/Kafka/Kafka.Client/KafkaConnection.cs      | 224 ------
 .../src/Kafka/Kafka.Client/KafkaException.cs       |  98 ---
 clients/csharp/src/Kafka/Kafka.Client/Message.cs   | 157 ----
 .../Kafka/Kafka.Client/Messages/BoundedBuffer.cs   |  38 -
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 407 ----------
 .../src/Kafka/Kafka.Client/Messages/Message.cs     | 329 --------
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  |  91 ---
 clients/csharp/src/Kafka/Kafka.Client/Producer.cs  | 152 ----
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  | 207 -----
 .../Producers/Async/AsyncProducerPool.cs           | 224 ------
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs |  80 --
 .../Producers/Async/ICallbackHandler.cs            |  35 -
 .../Kafka.Client/Producers/Async/MessageSent.cs    |  31 -
 .../src/Kafka/Kafka.Client/Producers/IProducer.cs  |  46 --
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  |  58 --
 .../Partitioning/ConfigBrokerPartitionInfo.cs      | 119 ---
 .../Producers/Partitioning/DefaultPartitioner.cs   |  50 --
 .../Producers/Partitioning/IBrokerPartitionInfo.cs |  49 --
 .../Producers/Partitioning/IPartitioner.cs         |  36 -
 .../Partitioning/ZKBrokerPartitionInfo.cs          | 342 --------
 .../Kafka.Client/Producers/Producer.StrMsg.cs      |  96 ---
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   | 337 --------
 .../Kafka/Kafka.Client/Producers/ProducerData.cs   |  95 ---
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   | 206 -----
 .../Kafka.Client/Producers/ProducerPoolData.cs     |  65 --
 .../Kafka/Kafka.Client/Producers/ProducerTypes.cs  |  29 -
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   |  60 --
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    | 155 ----
 .../Producers/Sync/SyncProducerPool.cs             | 226 ------
 .../Kafka/Kafka.Client/Properties/AssemblyInfo.cs  |  34 -
 .../src/Kafka/Kafka.Client/Request/FetchRequest.cs | 129 ---
 .../Kafka.Client/Request/MultiFetchRequest.cs      |  79 --
 .../Kafka.Client/Request/MultiProducerRequest.cs   |  87 --
 .../Kafka/Kafka.Client/Request/OffsetRequest.cs    | 107 ---
 .../Kafka/Kafka.Client/Request/ProducerRequest.cs  | 115 ---
 .../src/Kafka/Kafka.Client/RequestContext.cs       |  54 --
 .../csharp/src/Kafka/Kafka.Client/RequestType.cs   |  53 --
 .../Kafka/Kafka.Client/Requests/AbstractRequest.cs |  61 --
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    | 156 ----
 .../Kafka.Client/Requests/MultiFetchRequest.cs     | 109 ---
 .../Kafka.Client/Requests/MultiProducerRequest.cs  | 134 ----
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   | 136 ----
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs | 142 ----
 .../Kafka/Kafka.Client/Requests/RequestTypes.cs    |  53 --
 .../Kafka.Client/Serialization/DefaultEncoder.cs   |  41 -
 .../Kafka/Kafka.Client/Serialization/IEncoder.cs   |  41 -
 .../Kafka/Kafka.Client/Serialization/IWritable.cs  |  43 -
 .../Serialization/KafkaBinaryReader.cs             | 148 ----
 .../Serialization/KafkaBinaryWriter.cs             | 127 ---
 .../Kafka.Client/Serialization/StringEncoder.cs    |  43 -
 .../csharp/src/Kafka/Kafka.Client/Util/BitWorks.cs |  86 --
 .../csharp/src/Kafka/Kafka.Client/Util/Crc32.cs    | 132 ---
 .../src/Kafka/Kafka.Client/Utils/BitWorks.cs       |  83 --
 .../src/Kafka/Kafka.Client/Utils/Crc32Hasher.cs    | 138 ----
 .../src/Kafka/Kafka.Client/Utils/ErrorMapping.cs   |  29 -
 .../src/Kafka/Kafka.Client/Utils/Extensions.cs     |  49 --
 .../csharp/src/Kafka/Kafka.Client/Utils/Guard.cs   | 120 ---
 .../src/Kafka/Kafka.Client/Utils/KafkaScheduler.cs |  86 --
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   |  56 --
 .../src/Kafka/Kafka.Client/Utils/ZKGroupDirs.cs    |  39 -
 .../Kafka/Kafka.Client/Utils/ZKGroupTopicDirs.cs   |  32 -
 .../csharp/src/Kafka/Kafka.Client/Utils/ZkUtils.cs | 147 ----
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  |  44 -
 .../Events/ChildChangedEventItem.cs                | 113 ---
 .../Events/DataChangedEventItem.cs                 | 161 ----
 .../Events/ZooKeeperChildChangedEventArgs.cs       |  60 --
 .../Events/ZooKeeperDataChangedEventArgs.cs        |  88 --
 .../Events/ZooKeeperEventArgs.cs                   |  56 --
 .../Events/ZooKeeperEventTypes.cs                  |  35 -
 .../Events/ZooKeeperSessionCreatedEventArgs.cs     |  46 --
 .../Events/ZooKeeperStateChangedEventArgs.cs       |  55 --
 .../ZooKeeperIntegration/IZooKeeperClient.cs       | 469 -----------
 .../ZooKeeperIntegration/IZooKeeperConnection.cs   | 164 ----
 .../ZooKeeperIntegration/IZooKeeperSerializer.cs   |  48 --
 .../Listeners/BrokerTopicsListener.cs              | 257 ------
 .../Listeners/IZooKeeperChildListener.cs           |  43 -
 .../Listeners/IZooKeeperDataListener.cs            |  49 --
 .../Listeners/IZooKeeperStateListener.cs           |  42 -
 .../Listeners/ZKRebalancerListener.cs              | 368 ---------
 .../Listeners/ZKSessionExpireListener.cs           |  86 --
 .../ZooKeeperClient.Watcher.cs                     | 682 ----------------
 .../ZooKeeperIntegration/ZooKeeperClient.cs        | 893 ---------------------
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    | 327 --------
 .../ZooKeeperStringSerializer.cs                   |  72 --
 clients/csharp/src/Kafka/Kafka.FxCop               | 120 ---
 clients/csharp/src/Kafka/Kafka.sln                 |  61 --
 .../Tests/Kafka.Client.IntegrationTests/App.config |  43 -
 .../Config/Debug/App.config                        |  43 -
 .../Config/Integration/App.config                  |  37 -
 .../ConsumerRebalancingTests.cs                    | 236 ------
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 307 -------
 .../IntegrationFixtureBase.cs                      | 147 ----
 .../Kafka.Client.IntegrationTests.csproj           | 141 ----
 .../KafkaIntegrationTest.cs                        | 488 -----------
 .../Kafka.Client.IntegrationTests/Log4Net.config   |  55 --
 .../MockAlwaysZeroPartitioner.cs                   |  34 -
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 226 ------
 .../Properties/AssemblyInfo.cs                     |  52 --
 .../Kafka.Client.IntegrationTests/TestHelper.cs    |  48 --
 .../TestMultipleBrokersHelper.cs                   |  78 --
 .../Kafka.Client.IntegrationTests/TestsSetup.cs    |  35 -
 .../ZKBrokerPartitionInfoTests.cs                  | 464 -----------
 .../ZooKeeperAwareProducerTests.cs                 | 224 ------
 .../ZooKeeperClientTests.cs                        | 411 ----------
 .../ZooKeeperConnectionTests.cs                    | 118 ---
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   | 118 ---
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    | 108 ---
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs | 138 ----
 .../Producers/PartitioningTests.cs                 |  73 --
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs  |  51 --
 .../Request/FetchRequestTests.cs                   |  76 --
 .../Request/MultiFetchRequestTests.cs              |  78 --
 .../Request/MultiProducerRequestTests.cs           |  69 --
 .../Request/OffsetRequestTests.cs                  |  73 --
 .../Request/ProducerRequestTests.cs                |  77 --
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs | 121 ---
 clients/go/.gitignore                              |  13 -
 clients/go/LICENSE                                 | 208 -----
 clients/go/Makefile                                |  26 -
 clients/go/README.md                               |  99 ---
 clients/go/kafka_test.go                           | 277 -------
 clients/go/src/consumer.go                         | 199 -----
 clients/go/src/converts.go                         |  51 --
 clients/go/src/kafka.go                            |  95 ---
 clients/go/src/message.go                          | 182 -----
 clients/go/src/payload_codec.go                    | 116 ---
 clients/go/src/publisher.go                        |  55 --
 clients/go/src/request.go                          | 101 ---
 clients/go/src/timing.go                           |  49 --
 clients/go/tools/consumer/Makefile                 |   7 -
 clients/go/tools/consumer/consumer.go              | 111 ---
 clients/go/tools/offsets/Makefile                  |   7 -
 clients/go/tools/offsets/offsets.go                |  62 --
 clients/go/tools/publisher/Makefile                |   7 -
 clients/go/tools/publisher/publisher.go            |  89 --
 clients/php/LICENSE                                | 203 -----
 clients/php/README.md                              |  20 -
 clients/php/src/examples/autoloader.php            |  40 -
 clients/php/src/examples/consume.php               |  53 --
 clients/php/src/examples/produce.php               |  46 --
 .../src/lib/Kafka/BoundedByteBuffer/Receive.php    | 154 ----
 .../php/src/lib/Kafka/BoundedByteBuffer/Send.php   | 118 ---
 clients/php/src/lib/Kafka/Encoder.php              |  73 --
 clients/php/src/lib/Kafka/FetchRequest.php         | 126 ---
 clients/php/src/lib/Kafka/Message.php              | 126 ---
 clients/php/src/lib/Kafka/MessageSet.php           | 122 ---
 clients/php/src/lib/Kafka/Producer.php             | 122 ---
 clients/php/src/lib/Kafka/Request.php              |  30 -
 clients/php/src/lib/Kafka/RequestKeys.php          |  30 -
 clients/php/src/lib/Kafka/SimpleConsumer.php       | 142 ----
 .../tests/Kafka/BoundedByteBuffer/ReceiveTest.php  | 133 ---
 .../src/tests/Kafka/BoundedByteBuffer/SendTest.php | 100 ---
 clients/php/src/tests/Kafka/EncoderTest.php        |  61 --
 clients/php/src/tests/Kafka/FetchRequestTest.php   |  88 --
 clients/php/src/tests/Kafka/MessageTest.php        |  62 --
 clients/php/src/tests/Kafka/ProducerTest.php       |  76 --
 clients/php/src/tests/bootstrap.php                |  53 --
 clients/php/src/tests/phpunit.xml                  |  17 -
 clients/python/LICENSE                             | 203 -----
 clients/python/kafka.py                            |  73 --
 clients/python/setup.py                            |  33 -
 clients/ruby/LICENSE                               | 202 -----
 clients/ruby/README.md                             |  62 --
 clients/ruby/Rakefile                              |  76 --
 clients/ruby/TODO                                  |   1 -
 clients/ruby/kafka-rb.gemspec                      |  46 --
 clients/ruby/lib/kafka.rb                          |  27 -
 clients/ruby/lib/kafka/batch.rb                    |  27 -
 clients/ruby/lib/kafka/consumer.rb                 | 149 ----
 clients/ruby/lib/kafka/error_codes.rb              |  35 -
 clients/ruby/lib/kafka/io.rb                       |  53 --
 clients/ruby/lib/kafka/message.rb                  |  49 --
 clients/ruby/lib/kafka/producer.rb                 |  63 --
 clients/ruby/lib/kafka/request_type.rb             |  23 -
 clients/ruby/spec/batch_spec.rb                    |  35 -
 clients/ruby/spec/consumer_spec.rb                 | 134 ----
 clients/ruby/spec/io_spec.rb                       |  91 ---
 clients/ruby/spec/kafka_spec.rb                    |  21 -
 clients/ruby/spec/message_spec.rb                  |  69 --
 clients/ruby/spec/producer_spec.rb                 | 109 ---
 clients/ruby/spec/spec_helper.rb                   |  18 -
 239 files changed, 26121 deletions(-)
e1c0b0946423a9f6ab414f2ab73006929cd9b578
b5dc73219e2e4b02b0d7f49e4059a8308f899995

 system_test/utils/kafka_system_test_utils.py | 2 +-
 system_test/utils/system_test_utils.py       | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
2482bb9cfc5aa2df9b5ec0dddf65da72cc95da1e
5d43d6730215c81c438985961ce8c89d6e4fb7d1
081f0d2353ffb86db3aa3a5080e00b0b0aee7c4a

 config/producer.properties                         |   4 +-
 .../main/scala/kafka/tools/KafkaMigrationTool.java | 362 +++++++++++++++++++++
 2 files changed, 364 insertions(+), 2 deletions(-)
07d1b238bafa36a4fbcd2bce8c256aae30fe9a33
0f06136aa87393f3c3ac8be3ab9e0c601a13fd63

 core/src/main/scala/kafka/admin/AdminUtils.scala   | 15 ++--
 .../scala/kafka/api/TopicMetaDataResponse.scala    | 53 -------------
 core/src/main/scala/kafka/api/TopicMetadata.scala  | 88 +---------------------
 .../scala/kafka/api/TopicMetadataRequest.scala     | 60 ++-------------
 .../scala/kafka/api/TopicMetadataResponse.scala    | 46 +++++++++++
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  7 +-
 .../kafka/controller/ReplicaStateMachine.scala     |  2 +-
 .../main/scala/kafka/javaapi/FetchResponse.scala   | 10 +--
 core/src/main/scala/kafka/javaapi/Implicits.scala  | 19 +++--
 .../main/scala/kafka/javaapi/TopicMetadata.scala   | 62 +++++++++++++++
 .../scala/kafka/javaapi/TopicMetadataRequest.scala | 35 +++++++++
 .../kafka/javaapi/TopicMetadataResponse.scala      | 26 +++++++
 .../kafka/javaapi/consumer/SimpleConsumer.scala    | 13 +++-
 .../consumer/ZookeeperConsumerConnector.scala      |  2 +-
 .../javaapi/message/ByteBufferMessageSet.scala     | 17 +----
 .../scala/kafka/message/ByteBufferMessageSet.scala |  4 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  8 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |  8 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 45 ++++++-----
 .../kafka/server/ZookeeperLeaderElector.scala      |  2 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |  6 +-
 .../javaapi/message/ByteBufferMessageSetTest.scala | 32 ++------
 .../kafka/network/RpcDataSerializationTest.scala   |  6 +-
 23 files changed, 262 insertions(+), 304 deletions(-)
8c68cd0575cc3e69150f9aefc317d236bea11c54

 project/build.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
8460405e4b2b0219c6af02ade39da61603159885

 trunk/.gitignore                                   |  14 -
 trunk/.rat-excludes                                |  26 -
 trunk/DISCLAIMER                                   |  15 -
 trunk/LICENSE                                      | 262 ------
 trunk/NOTICE                                       |  10 -
 trunk/README.md                                    |  56 --
 trunk/bin/kafka-console-consumer-log4j.properties  |  21 -
 trunk/bin/kafka-console-consumer.sh                |  19 -
 trunk/bin/kafka-console-producer.sh                |  18 -
 trunk/bin/kafka-consumer-perf-test.sh              |  17 -
 trunk/bin/kafka-consumer-shell.sh                  |  17 -
 trunk/bin/kafka-producer-perf-test.sh              |  17 -
 trunk/bin/kafka-producer-shell.sh                  |  17 -
 trunk/bin/kafka-replay-log-producer.sh             |  19 -
 trunk/bin/kafka-run-class.sh                       |  66 --
 trunk/bin/kafka-server-start.sh                    |  25 -
 trunk/bin/kafka-server-stop.sh                     |  16 -
 trunk/bin/kafka-simple-consumer-perf-test.sh       |  17 -
 trunk/bin/kafka-simple-consumer-shell.sh           |  17 -
 trunk/bin/run-rat.sh                               |  35 -
 trunk/bin/zookeeper-server-start.sh                |  23 -
 trunk/bin/zookeeper-server-stop.sh                 |  16 -
 trunk/bin/zookeeper-shell.sh                       |  23 -
 trunk/clients/cpp/LICENSE                          | 203 -----
 trunk/clients/cpp/Makefile.am                      |  51 --
 trunk/clients/cpp/README.md                        |  56 --
 trunk/clients/cpp/autoconf.sh                      |  33 -
 trunk/clients/cpp/configure.ac                     |  42 -
 trunk/clients/cpp/src/encoder.hpp                  |  62 --
 trunk/clients/cpp/src/encoder_helper.hpp           |  79 --
 trunk/clients/cpp/src/example.cpp                  |  54 --
 trunk/clients/cpp/src/producer.cpp                 | 117 ---
 trunk/clients/cpp/src/producer.hpp                 | 116 ---
 .../clients/cpp/src/tests/encoder_helper_tests.cpp |  88 --
 trunk/clients/cpp/src/tests/encoder_tests.cpp      |  69 --
 trunk/clients/cpp/src/tests/producer_tests.cpp     |  76 --
 trunk/clients/csharp/.gitignore                    |   5 -
 trunk/clients/csharp/LICENSE                       | 202 -----
 trunk/clients/csharp/README.md                     |  66 --
 trunk/clients/csharp/Settings.StyleCop             |  92 ---
 .../csharp/lib/StyleCop/Microsoft.StyleCop.Targets | 125 ---
 .../clients/csharp/lib/StyleCop/Settings.StyleCop  |  48 --
 .../csharp/lib/nunit/2.5.9/nunit.framework.dll     | Bin 135168 -> 0 bytes
 .../src/Kafka/Kafka.Client/AbstractRequest.cs      |  51 --
 .../Kafka/Kafka.Client/Cfg/AsyncProducerConfig.cs  |  74 --
 .../Kafka/Kafka.Client/Cfg/BrokerPartitionInfo.cs  |  72 --
 .../Cfg/BrokerPartitionInfoCollection.cs           |  52 --
 .../csharp/src/Kafka/Kafka.Client/Cfg/Consumer.cs  | 136 ----
 .../src/Kafka/Kafka.Client/Cfg/ConsumerConfig.cs   |  72 --
 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs |  26 -
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  |  30 -
 .../Kafka.Client/Cfg/KafkaClientConfiguration.cs   |  93 ---
 .../src/Kafka/Kafka.Client/Cfg/KafkaServer.cs      |  52 --
 .../src/Kafka/Kafka.Client/Cfg/ProducerConfig.cs   |  94 ---
 .../Kafka/Kafka.Client/Cfg/SyncProducerConfig.cs   |  66 --
 .../csharp/src/Kafka/Kafka.Client/Cfg/ZKConfig.cs  |  43 -
 .../src/Kafka/Kafka.Client/Cfg/ZooKeeperServers.cs |  45 --
 .../src/Kafka/Kafka.Client/Cluster/Broker.cs       |  68 --
 .../src/Kafka/Kafka.Client/Cluster/Cluster.cs      | 130 ---
 .../src/Kafka/Kafka.Client/Cluster/Partition.cs    | 147 ----
 .../csharp/src/Kafka/Kafka.Client/Consumer.cs      | 249 ------
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 235 ------
 .../Kafka.Client/Consumers/ConsumerIterator.cs     | 211 -----
 .../Consumers/ConsumerIteratorState.cs             |  28 -
 .../Kafka.Client/Consumers/FetchedDataChunk.cs     |  58 --
 .../src/Kafka/Kafka.Client/Consumers/Fetcher.cs    | 170 ----
 .../Kafka.Client/Consumers/FetcherRunnable.cs      | 191 -----
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  |  74 --
 .../Kafka.Client/Consumers/IConsumerConnector.cs   |  45 --
 .../Kafka.Client/Consumers/KafkaMessageStream.cs   |  53 --
 .../Kafka.Client/Consumers/PartitionTopicInfo.cs   | 198 -----
 .../src/Kafka/Kafka.Client/Consumers/TopicCount.cs | 111 ---
 .../Consumers/ZookeeperConsumerConnector.cs        | 322 --------
 .../Exceptions/ConsumerTimeoutException.cs         |  28 -
 .../Kafka.Client/Exceptions/KafkaException.cs      | 100 ---
 .../Exceptions/MessageSizeTooLargeException.cs     |  25 -
 .../Exceptions/ZKRebalancerException.cs            |  33 -
 .../Kafka.Client/Exceptions/ZooKeeperException.cs  |  45 --
 .../Exceptions/ZooKeeperTimeoutException.cs        |  34 -
 .../src/Kafka/Kafka.Client/Kafka.Client.csproj     | 245 ------
 .../src/Kafka/Kafka.Client/KafkaClientBase.cs      |  44 -
 .../src/Kafka/Kafka.Client/KafkaConnection.cs      | 224 ------
 .../src/Kafka/Kafka.Client/KafkaException.cs       |  98 ---
 .../csharp/src/Kafka/Kafka.Client/Message.cs       | 157 ----
 .../Kafka/Kafka.Client/Messages/BoundedBuffer.cs   |  38 -
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 407 ----------
 .../src/Kafka/Kafka.Client/Messages/Message.cs     | 329 --------
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  |  91 ---
 .../csharp/src/Kafka/Kafka.Client/Producer.cs      | 152 ----
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  | 207 -----
 .../Producers/Async/AsyncProducerPool.cs           | 224 ------
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs |  80 --
 .../Producers/Async/ICallbackHandler.cs            |  35 -
 .../Kafka.Client/Producers/Async/MessageSent.cs    |  31 -
 .../src/Kafka/Kafka.Client/Producers/IProducer.cs  |  46 --
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  |  58 --
 .../Partitioning/ConfigBrokerPartitionInfo.cs      | 119 ---
 .../Producers/Partitioning/DefaultPartitioner.cs   |  50 --
 .../Producers/Partitioning/IBrokerPartitionInfo.cs |  49 --
 .../Producers/Partitioning/IPartitioner.cs         |  36 -
 .../Partitioning/ZKBrokerPartitionInfo.cs          | 342 --------
 .../Kafka.Client/Producers/Producer.StrMsg.cs      |  96 ---
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   | 337 --------
 .../Kafka/Kafka.Client/Producers/ProducerData.cs   |  95 ---
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   | 206 -----
 .../Kafka.Client/Producers/ProducerPoolData.cs     |  65 --
 .../Kafka/Kafka.Client/Producers/ProducerTypes.cs  |  29 -
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   |  60 --
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    | 155 ----
 .../Producers/Sync/SyncProducerPool.cs             | 226 ------
 .../Kafka/Kafka.Client/Properties/AssemblyInfo.cs  |  34 -
 .../src/Kafka/Kafka.Client/Request/FetchRequest.cs | 129 ---
 .../Kafka.Client/Request/MultiFetchRequest.cs      |  79 --
 .../Kafka.Client/Request/MultiProducerRequest.cs   |  87 --
 .../Kafka/Kafka.Client/Request/OffsetRequest.cs    | 107 ---
 .../Kafka/Kafka.Client/Request/ProducerRequest.cs  | 115 ---
 .../src/Kafka/Kafka.Client/RequestContext.cs       |  54 --
 .../csharp/src/Kafka/Kafka.Client/RequestType.cs   |  53 --
 .../Kafka/Kafka.Client/Requests/AbstractRequest.cs |  61 --
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    | 156 ----
 .../Kafka.Client/Requests/MultiFetchRequest.cs     | 109 ---
 .../Kafka.Client/Requests/MultiProducerRequest.cs  | 134 ----
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   | 136 ----
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs | 142 ----
 .../Kafka/Kafka.Client/Requests/RequestTypes.cs    |  53 --
 .../Kafka.Client/Serialization/DefaultEncoder.cs   |  41 -
 .../Kafka/Kafka.Client/Serialization/IEncoder.cs   |  41 -
 .../Kafka/Kafka.Client/Serialization/IWritable.cs  |  43 -
 .../Serialization/KafkaBinaryReader.cs             | 148 ----
 .../Serialization/KafkaBinaryWriter.cs             | 127 ---
 .../Kafka.Client/Serialization/StringEncoder.cs    |  43 -
 .../csharp/src/Kafka/Kafka.Client/Util/BitWorks.cs |  86 --
 .../csharp/src/Kafka/Kafka.Client/Util/Crc32.cs    | 132 ---
 .../src/Kafka/Kafka.Client/Utils/BitWorks.cs       |  83 --
 .../src/Kafka/Kafka.Client/Utils/Crc32Hasher.cs    | 138 ----
 .../src/Kafka/Kafka.Client/Utils/ErrorMapping.cs   |  29 -
 .../src/Kafka/Kafka.Client/Utils/Extensions.cs     |  49 --
 .../csharp/src/Kafka/Kafka.Client/Utils/Guard.cs   | 120 ---
 .../src/Kafka/Kafka.Client/Utils/KafkaScheduler.cs |  86 --
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   |  56 --
 .../src/Kafka/Kafka.Client/Utils/ZKGroupDirs.cs    |  39 -
 .../Kafka/Kafka.Client/Utils/ZKGroupTopicDirs.cs   |  32 -
 .../csharp/src/Kafka/Kafka.Client/Utils/ZkUtils.cs | 147 ----
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  |  44 -
 .../Events/ChildChangedEventItem.cs                | 113 ---
 .../Events/DataChangedEventItem.cs                 | 161 ----
 .../Events/ZooKeeperChildChangedEventArgs.cs       |  60 --
 .../Events/ZooKeeperDataChangedEventArgs.cs        |  88 --
 .../Events/ZooKeeperEventArgs.cs                   |  56 --
 .../Events/ZooKeeperEventTypes.cs                  |  35 -
 .../Events/ZooKeeperSessionCreatedEventArgs.cs     |  46 --
 .../Events/ZooKeeperStateChangedEventArgs.cs       |  55 --
 .../ZooKeeperIntegration/IZooKeeperClient.cs       | 469 -----------
 .../ZooKeeperIntegration/IZooKeeperConnection.cs   | 164 ----
 .../ZooKeeperIntegration/IZooKeeperSerializer.cs   |  48 --
 .../Listeners/BrokerTopicsListener.cs              | 257 ------
 .../Listeners/IZooKeeperChildListener.cs           |  43 -
 .../Listeners/IZooKeeperDataListener.cs            |  49 --
 .../Listeners/IZooKeeperStateListener.cs           |  42 -
 .../Listeners/ZKRebalancerListener.cs              | 368 ---------
 .../Listeners/ZKSessionExpireListener.cs           |  86 --
 .../ZooKeeperClient.Watcher.cs                     | 682 ----------------
 .../ZooKeeperIntegration/ZooKeeperClient.cs        | 893 ---------------------
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    | 327 --------
 .../ZooKeeperStringSerializer.cs                   |  72 --
 trunk/clients/csharp/src/Kafka/Kafka.FxCop         | 120 ---
 trunk/clients/csharp/src/Kafka/Kafka.sln           |  61 --
 .../Tests/Kafka.Client.IntegrationTests/App.config |  43 -
 .../Config/Debug/App.config                        |  43 -
 .../Config/Integration/App.config                  |  37 -
 .../ConsumerRebalancingTests.cs                    | 236 ------
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 307 -------
 .../IntegrationFixtureBase.cs                      | 147 ----
 .../Kafka.Client.IntegrationTests.csproj           | 141 ----
 .../KafkaIntegrationTest.cs                        | 488 -----------
 .../Kafka.Client.IntegrationTests/Log4Net.config   |  55 --
 .../MockAlwaysZeroPartitioner.cs                   |  34 -
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 226 ------
 .../Properties/AssemblyInfo.cs                     |  52 --
 .../Kafka.Client.IntegrationTests/TestHelper.cs    |  48 --
 .../TestMultipleBrokersHelper.cs                   |  78 --
 .../Kafka.Client.IntegrationTests/TestsSetup.cs    |  35 -
 .../ZKBrokerPartitionInfoTests.cs                  | 464 -----------
 .../ZooKeeperAwareProducerTests.cs                 | 224 ------
 .../ZooKeeperClientTests.cs                        | 411 ----------
 .../ZooKeeperConnectionTests.cs                    | 118 ---
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   | 118 ---
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    | 108 ---
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs | 138 ----
 .../Producers/PartitioningTests.cs                 |  73 --
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs  |  51 --
 .../Request/FetchRequestTests.cs                   |  76 --
 .../Request/MultiFetchRequestTests.cs              |  78 --
 .../Request/MultiProducerRequestTests.cs           |  69 --
 .../Request/OffsetRequestTests.cs                  |  73 --
 .../Request/ProducerRequestTests.cs                |  77 --
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs | 121 ---
 trunk/clients/go/.gitignore                        |  13 -
 trunk/clients/go/LICENSE                           | 208 -----
 trunk/clients/go/Makefile                          |  26 -
 trunk/clients/go/README.md                         |  99 ---
 trunk/clients/go/kafka_test.go                     | 277 -------
 trunk/clients/go/src/consumer.go                   | 199 -----
 trunk/clients/go/src/converts.go                   |  51 --
 trunk/clients/go/src/kafka.go                      |  95 ---
 trunk/clients/go/src/message.go                    | 182 -----
 trunk/clients/go/src/payload_codec.go              | 116 ---
 trunk/clients/go/src/publisher.go                  |  55 --
 trunk/clients/go/src/request.go                    | 101 ---
 trunk/clients/go/src/timing.go                     |  49 --
 trunk/clients/go/tools/consumer/Makefile           |   7 -
 trunk/clients/go/tools/consumer/consumer.go        | 111 ---
 trunk/clients/go/tools/offsets/Makefile            |   7 -
 trunk/clients/go/tools/offsets/offsets.go          |  62 --
 trunk/clients/go/tools/publisher/Makefile          |   7 -
 trunk/clients/go/tools/publisher/publisher.go      |  89 --
 trunk/clients/php/LICENSE                          | 203 -----
 trunk/clients/php/README.md                        |  20 -
 trunk/clients/php/src/examples/autoloader.php      |  40 -
 trunk/clients/php/src/examples/consume.php         |  53 --
 trunk/clients/php/src/examples/produce.php         |  46 --
 .../src/lib/Kafka/BoundedByteBuffer/Receive.php    | 154 ----
 .../php/src/lib/Kafka/BoundedByteBuffer/Send.php   | 118 ---
 trunk/clients/php/src/lib/Kafka/Encoder.php        |  73 --
 trunk/clients/php/src/lib/Kafka/FetchRequest.php   | 126 ---
 trunk/clients/php/src/lib/Kafka/Message.php        | 126 ---
 trunk/clients/php/src/lib/Kafka/MessageSet.php     | 122 ---
 trunk/clients/php/src/lib/Kafka/Producer.php       | 122 ---
 trunk/clients/php/src/lib/Kafka/Request.php        |  30 -
 trunk/clients/php/src/lib/Kafka/RequestKeys.php    |  30 -
 trunk/clients/php/src/lib/Kafka/SimpleConsumer.php | 142 ----
 .../tests/Kafka/BoundedByteBuffer/ReceiveTest.php  | 133 ---
 .../src/tests/Kafka/BoundedByteBuffer/SendTest.php | 100 ---
 trunk/clients/php/src/tests/Kafka/EncoderTest.php  |  61 --
 .../php/src/tests/Kafka/FetchRequestTest.php       |  88 --
 trunk/clients/php/src/tests/Kafka/MessageTest.php  |  62 --
 trunk/clients/php/src/tests/Kafka/ProducerTest.php |  76 --
 trunk/clients/php/src/tests/bootstrap.php          |  53 --
 trunk/clients/php/src/tests/phpunit.xml            |  17 -
 trunk/clients/python/LICENSE                       | 203 -----
 trunk/clients/python/kafka.py                      |  73 --
 trunk/clients/python/setup.py                      |  33 -
 trunk/clients/ruby/LICENSE                         | 202 -----
 trunk/clients/ruby/README.md                       |  62 --
 trunk/clients/ruby/Rakefile                        |  76 --
 trunk/clients/ruby/TODO                            |   1 -
 trunk/clients/ruby/kafka-rb.gemspec                |  46 --
 trunk/clients/ruby/lib/kafka.rb                    |  27 -
 trunk/clients/ruby/lib/kafka/batch.rb              |  27 -
 trunk/clients/ruby/lib/kafka/consumer.rb           | 149 ----
 trunk/clients/ruby/lib/kafka/error_codes.rb        |  35 -
 trunk/clients/ruby/lib/kafka/io.rb                 |  53 --
 trunk/clients/ruby/lib/kafka/message.rb            |  49 --
 trunk/clients/ruby/lib/kafka/producer.rb           |  63 --
 trunk/clients/ruby/lib/kafka/request_type.rb       |  23 -
 trunk/clients/ruby/spec/batch_spec.rb              |  35 -
 trunk/clients/ruby/spec/consumer_spec.rb           | 134 ----
 trunk/clients/ruby/spec/io_spec.rb                 |  91 ---
 trunk/clients/ruby/spec/kafka_spec.rb              |  21 -
 trunk/clients/ruby/spec/message_spec.rb            |  69 --
 trunk/clients/ruby/spec/producer_spec.rb           | 109 ---
 trunk/clients/ruby/spec/spec_helper.rb             |  18 -
 trunk/config/consumer.properties                   |  29 -
 trunk/config/log4j.properties                      |  30 -
 trunk/config/producer.properties                   |  80 --
 trunk/config/server.properties                     | 116 ---
 trunk/config/zookeeper.properties                  |  20 -
 trunk/contrib/hadoop-consumer/LICENSE              | 203 -----
 trunk/contrib/hadoop-consumer/README               |  66 --
 trunk/contrib/hadoop-consumer/copy-jars.sh         |  69 --
 trunk/contrib/hadoop-consumer/hadoop-setup.sh      |  20 -
 trunk/contrib/hadoop-consumer/lib/piggybank.jar    | Bin 308044 -> 0 bytes
 trunk/contrib/hadoop-consumer/run-class.sh         |  65 --
 .../src/main/java/kafka/etl/KafkaETLContext.java   | 286 -------
 .../main/java/kafka/etl/KafkaETLInputFormat.java   |  78 --
 .../src/main/java/kafka/etl/KafkaETLJob.java       | 172 ----
 .../src/main/java/kafka/etl/KafkaETLKey.java       | 104 ---
 .../main/java/kafka/etl/KafkaETLRecordReader.java  | 180 -----
 .../src/main/java/kafka/etl/KafkaETLRequest.java   | 128 ---
 .../src/main/java/kafka/etl/KafkaETLUtils.java     | 205 -----
 .../src/main/java/kafka/etl/Props.java             | 461 -----------
 .../java/kafka/etl/UndefinedPropertyException.java |  28 -
 .../main/java/kafka/etl/impl/DataGenerator.java    | 134 ----
 .../java/kafka/etl/impl/SimpleKafkaETLJob.java     | 104 ---
 .../java/kafka/etl/impl/SimpleKafkaETLMapper.java  |  88 --
 trunk/contrib/hadoop-consumer/test/test.properties |  42 -
 trunk/contrib/hadoop-producer/LICENSE              | 203 -----
 trunk/contrib/hadoop-producer/README.md            | 147 ----
 trunk/contrib/hadoop-producer/lib/piggybank.jar    | Bin 308044 -> 0 bytes
 .../java/kafka/bridge/examples/TextPublisher.java  |  68 --
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     | 173 ----
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |  74 --
 .../java/kafka/bridge/pig/AvroKafkaStorage.java    | 117 ---
 trunk/core/src/main/scala/kafka/Kafka.scala        |  55 --
 .../src/main/scala/kafka/api/FetchRequest.scala    |  51 --
 .../main/scala/kafka/api/MultiFetchRequest.scala   |  58 --
 .../main/scala/kafka/api/MultiFetchResponse.scala  |  52 --
 .../scala/kafka/api/MultiProducerRequest.scala     |  57 --
 .../src/main/scala/kafka/api/OffsetRequest.scala   | 100 ---
 .../src/main/scala/kafka/api/ProducerRequest.scala |  83 --
 .../src/main/scala/kafka/api/RequestKeys.scala     |  26 -
 .../core/src/main/scala/kafka/cluster/Broker.scala |  48 --
 .../src/main/scala/kafka/cluster/Cluster.scala     |  45 --
 .../src/main/scala/kafka/cluster/Partition.scala   |  57 --
 .../common/ConsumerReblanceFailedException.scala   |  26 -
 .../src/main/scala/kafka/common/ErrorMapping.scala |  61 --
 .../kafka/common/InvalidConfigException.scala      |  25 -
 .../kafka/common/InvalidMessageSizeException.scala |  26 -
 .../kafka/common/InvalidPartitionException.scala   |  24 -
 .../common/NoBrokersForPartitionException.scala    |  26 -
 .../kafka/common/OffsetOutOfRangeException.scala   |  26 -
 .../common/UnavailableProducerException.scala      |  24 -
 .../scala/kafka/common/UnknownCodecException.scala |  26 -
 .../main/scala/kafka/common/UnknownException.scala |  23 -
 .../kafka/common/UnknownMagicByteException.scala   |  26 -
 .../scala/kafka/consumer/ConsoleConsumer.scala     | 249 ------
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  98 ---
 .../scala/kafka/consumer/ConsumerConnector.scala   |  92 ---
 .../scala/kafka/consumer/ConsumerIterator.scala    | 100 ---
 .../scala/kafka/consumer/ConsumerTopicStat.scala   |  60 --
 .../scala/kafka/consumer/FetchedDataChunk.scala    |  24 -
 .../src/main/scala/kafka/consumer/Fetcher.scala    |  95 ---
 .../scala/kafka/consumer/FetcherRunnable.scala     | 141 ----
 .../main/scala/kafka/consumer/KafkaStream.scala    |  47 --
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  81 --
 .../main/scala/kafka/consumer/SimpleConsumer.scala | 226 ------
 .../src/main/scala/kafka/consumer/TopicCount.scala | 176 ----
 .../scala/kafka/consumer/TopicEventHandler.scala   |  24 -
 .../main/scala/kafka/consumer/TopicFilter.scala    |  76 --
 .../consumer/ZookeeperConsumerConnector.scala      | 810 -------------------
 .../consumer/ZookeeperTopicEventWatcher.scala      | 105 ---
 .../src/main/scala/kafka/consumer/package.html     |   1 -
 .../consumer/storage/MemoryOffsetStorage.scala     |  44 -
 .../kafka/consumer/storage/OffsetStorage.scala     |  40 -
 .../consumer/storage/OracleOffsetStorage.scala     | 155 ----
 .../src/main/scala/kafka/javaapi/Implicits.scala   | 123 ---
 .../scala/kafka/javaapi/MultiFetchResponse.scala   |  45 --
 .../main/scala/kafka/javaapi/ProducerRequest.scala |  52 --
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  69 --
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |  71 --
 .../consumer/ZookeeperConsumerConnector.scala      | 109 ---
 .../javaapi/message/ByteBufferMessageSet.scala     |  79 --
 .../scala/kafka/javaapi/message/MessageSet.scala   |  55 --
 .../scala/kafka/javaapi/producer/Producer.scala    | 122 ---
 .../kafka/javaapi/producer/ProducerData.scala      |  34 -
 .../kafka/javaapi/producer/SyncProducer.scala      |  48 --
 .../javaapi/producer/async/CallbackHandler.java    |  77 --
 .../kafka/javaapi/producer/async/EventHandler.java |  48 --
 trunk/core/src/main/scala/kafka/log/Log.scala      | 412 ----------
 .../core/src/main/scala/kafka/log/LogManager.scala | 357 --------
 trunk/core/src/main/scala/kafka/log/LogStats.scala |  44 -
 .../src/main/scala/kafka/log/SegmentList.scala     |  86 --
 trunk/core/src/main/scala/kafka/log/package.html   |   1 -
 .../message/ByteBufferBackedInputStream.scala      |  42 -
 .../scala/kafka/message/ByteBufferMessageSet.scala | 203 -----
 .../scala/kafka/message/CompressionCodec.scala     |  39 -
 .../scala/kafka/message/CompressionUtils.scala     | 160 ----
 .../main/scala/kafka/message/FileMessageSet.scala  | 280 -------
 .../kafka/message/InvalidMessageException.scala    |  25 -
 .../src/main/scala/kafka/message/Message.scala     | 180 -----
 .../scala/kafka/message/MessageAndMetadata.scala   |  21 -
 .../scala/kafka/message/MessageAndOffset.scala     |  22 -
 .../kafka/message/MessageLengthException.scala     |  24 -
 .../src/main/scala/kafka/message/MessageSet.scala  | 114 ---
 .../core/src/main/scala/kafka/message/package.html |   1 -
 .../kafka/network/BoundedByteBufferReceive.scala   |  92 ---
 .../kafka/network/BoundedByteBufferSend.scala      |  56 --
 .../main/scala/kafka/network/ByteBufferSend.scala  |  40 -
 .../scala/kafka/network/ConnectionConfig.scala     |  27 -
 .../src/main/scala/kafka/network/Handler.scala     |  33 -
 .../kafka/network/InvalidRequestException.scala    |  24 -
 .../src/main/scala/kafka/network/Request.scala     |  28 -
 .../main/scala/kafka/network/SocketServer.scala    | 354 --------
 .../scala/kafka/network/SocketServerStats.scala    |  90 ---
 .../main/scala/kafka/network/Transmission.scala    | 107 ---
 .../core/src/main/scala/kafka/network/package.html |  11 -
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  59 --
 .../kafka/producer/ConfigBrokerPartitionInfo.scala |  96 ---
 .../scala/kafka/producer/ConsoleProducer.scala     | 144 ----
 .../scala/kafka/producer/DefaultPartitioner.scala  |  29 -
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  94 ---
 .../main/scala/kafka/producer/Partitioner.scala    |  26 -
 .../src/main/scala/kafka/producer/Producer.scala   | 213 -----
 .../main/scala/kafka/producer/ProducerConfig.scala |  89 --
 .../main/scala/kafka/producer/ProducerData.scala   |  39 -
 .../main/scala/kafka/producer/ProducerPool.scala   | 179 -----
 .../main/scala/kafka/producer/SyncProducer.scala   | 229 ------
 .../scala/kafka/producer/SyncProducerConfig.scala  |  47 --
 .../kafka/producer/ZKBrokerPartitionInfo.scala     | 380 ---------
 .../scala/kafka/producer/async/AsyncProducer.scala | 144 ----
 .../kafka/producer/async/AsyncProducerConfig.scala |  61 --
 .../async/AsyncProducerInterruptedException.scala  |  23 -
 .../kafka/producer/async/AsyncProducerStats.scala  |  50 --
 .../producer/async/AsyncProducerStatsMBean.scala   |  27 -
 .../kafka/producer/async/CallbackHandler.scala     |  75 --
 .../kafka/producer/async/DefaultEventHandler.scala | 133 ---
 .../scala/kafka/producer/async/EventHandler.scala  |  45 --
 .../async/IllegalQueueStateException.scala         |  25 -
 .../producer/async/MissingConfigException.scala    |  23 -
 .../kafka/producer/async/ProducerSendThread.scala  | 129 ---
 .../producer/async/QueueClosedException.scala      |  23 -
 .../kafka/producer/async/QueueFullException.scala  |  23 -
 .../src/main/scala/kafka/serializer/Decoder.scala  |  37 -
 .../src/main/scala/kafka/serializer/Encoder.scala  |  32 -
 .../src/main/scala/kafka/server/KafkaConfig.scala  | 108 ---
 .../scala/kafka/server/KafkaRequestHandlers.scala  | 194 -----
 .../src/main/scala/kafka/server/KafkaServer.scala  | 116 ---
 .../scala/kafka/server/KafkaServerStartable.scala  |  59 --
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 117 ---
 .../main/scala/kafka/server/MessageSetSend.scala   |  71 --
 .../scala/kafka/server/MultiMessageSetSend.scala   |  36 -
 .../core/src/main/scala/kafka/server/package.html  |   1 -
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 161 ----
 .../src/main/scala/kafka/tools/ConsumerShell.scala | 108 ---
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  53 --
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 123 ---
 .../main/scala/kafka/tools/GetOffsetShell.scala    |  73 --
 .../main/scala/kafka/tools/ImportZkOffsets.scala   | 112 ---
 .../core/src/main/scala/kafka/tools/JmxTool.scala  | 110 ---
 .../src/main/scala/kafka/tools/MirrorMaker.scala   | 171 ----
 .../src/main/scala/kafka/tools/ProducerShell.scala |  71 --
 .../main/scala/kafka/tools/ReplayLogProducer.scala | 209 -----
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 113 ---
 .../kafka/tools/VerifyConsumerRebalance.scala      | 135 ----
 .../src/main/scala/kafka/utils/Annotations.scala   |  36 -
 .../src/main/scala/kafka/utils/DelayedItem.scala   |  49 --
 .../main/scala/kafka/utils/IteratorTemplate.scala  |  80 --
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  51 --
 .../main/scala/kafka/utils/Log4jController.scala   |  98 ---
 .../core/src/main/scala/kafka/utils/Logging.scala  | 101 ---
 .../core/src/main/scala/kafka/utils/MockTime.scala |  34 -
 .../src/main/scala/kafka/utils/Mx4jLoader.scala    |  72 --
 trunk/core/src/main/scala/kafka/utils/Pool.scala   |  66 --
 trunk/core/src/main/scala/kafka/utils/Range.scala  |  42 -
 .../src/main/scala/kafka/utils/Throttler.scala     |  79 --
 trunk/core/src/main/scala/kafka/utils/Time.scala   |  61 --
 .../scala/kafka/utils/TopicNameValidator.scala     |  41 -
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |  79 --
 trunk/core/src/main/scala/kafka/utils/Utils.scala  | 841 -------------------
 .../core/src/main/scala/kafka/utils/ZkUtils.scala  | 312 -------
 trunk/core/src/main/scala/kafka/utils/package.html |   1 -
 trunk/core/src/test/resources/log4j.properties     |  25 -
 .../MagicByte0-0/00000000000000000000.kafka        | Bin 10900 -> 0 bytes
 .../src/test/scala/other/kafka.log4j.properties    |  22 -
 .../src/test/scala/other/kafka/DeleteZKPath.scala  |  45 --
 .../test/scala/other/kafka/TestKafkaAppender.scala |  50 --
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  76 --
 .../scala/other/kafka/TestLogPerformance.scala     |  56 --
 .../src/test/scala/other/kafka/TestTruncate.scala  |  39 -
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |  74 --
 .../unit/kafka/consumer/TopicFilterTest.scala      |  51 --
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 288 -------
 .../kafka/integration/AutoOffsetResetTest.scala    | 223 -----
 .../integration/BackwardsCompatibilityTest.scala   |  76 --
 .../scala/unit/kafka/integration/FetcherTest.scala | 107 ---
 .../kafka/integration/KafkaServerTestHarness.scala |  45 --
 .../kafka/integration/LazyInitProducerTest.scala   | 185 -----
 .../unit/kafka/integration/LogCorruptionTest.scala | 111 ---
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 271 -------
 .../integration/ProducerConsumerTestHarness.scala  |  52 --
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 124 ---
 .../javaapi/integration/PrimitiveApiTest.scala     | 417 ----------
 .../integration/ProducerConsumerTestHarness.scala  |  53 --
 .../javaapi/message/BaseMessageSetTestCases.scala  |  74 --
 .../javaapi/message/ByteBufferMessageSetTest.scala |  86 --
 .../unit/kafka/javaapi/producer/ProducerTest.scala | 633 ---------------
 .../kafka/javaapi/producer/SyncProducerTest.scala  |  98 ---
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 233 ------
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  | 215 -----
 .../src/test/scala/unit/kafka/log/LogTest.scala    | 299 -------
 .../scala/unit/kafka/log/SegmentListTest.scala     |  58 --
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 254 ------
 .../kafka/message/BaseMessageSetTestCases.scala    |  69 --
 .../kafka/message/ByteBufferMessageSetTest.scala   | 162 ----
 .../unit/kafka/message/CompressionUtilsTest.scala  |  75 --
 .../unit/kafka/message/FileMessageSetTest.scala    |  84 --
 .../scala/unit/kafka/message/MessageTest.scala     |  70 --
 .../unit/kafka/network/SocketServerTest.scala      |  79 --
 .../unit/kafka/producer/AsyncProducerTest.scala    | 319 --------
 .../unit/kafka/producer/ProducerMethodsTest.scala  |  57 --
 .../scala/unit/kafka/producer/ProducerTest.scala   | 702 ----------------
 .../unit/kafka/producer/SyncProducerTest.scala     | 134 ----
 .../unit/kafka/server/ServerShutdownTest.scala     | 122 ---
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 308 -------
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  54 --
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  40 -
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  57 --
 .../scala/unit/kafka/zk/ZKLoadBalanceTest.scala    | 127 ---
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  42 -
 trunk/examples/README                              |  19 -
 trunk/examples/bin/java-producer-consumer-demo.sh  |  59 --
 trunk/examples/bin/java-simple-consumer-demo.sh    |  59 --
 .../src/main/java/kafka/examples/Consumer.java     |  65 --
 .../src/main/java/kafka/examples/ExampleUtils.java |  32 -
 .../kafka/examples/KafkaConsumerProducerDemo.java  |  30 -
 .../main/java/kafka/examples/KafkaProperties.java  |  31 -
 .../src/main/java/kafka/examples/Producer.java     |  50 --
 .../java/kafka/examples/SimpleConsumerDemo.java    |  83 --
 trunk/lib/sbt-launch.jar                           | Bin 920993 -> 0 bytes
 trunk/perf/config/log4j.properties                 |  24 -
 .../scala/kafka/perf/ConsumerPerformance.scala     | 196 -----
 .../src/main/scala/kafka/perf/PerfConfig.scala     |  48 --
 .../scala/kafka/perf/ProducerPerformance.scala     | 237 ------
 .../kafka/perf/SimpleConsumerPerformance.scala     | 141 ----
 trunk/project/build.properties                     |  24 -
 trunk/project/build/KafkaProject.scala             | 249 ------
 trunk/project/plugins/Plugins.scala                |  23 -
 trunk/sbt                                          |   1 -
 trunk/system_test/broker_failure/README            |  72 --
 .../broker_failure/bin/kafka-run-class.sh          |  67 --
 trunk/system_test/broker_failure/bin/run-test.sh   | 823 -------------------
 .../broker_failure/config/log4j.properties         |  86 --
 .../config/mirror_producer.properties              |  27 -
 .../config/mirror_producer1.properties             |  28 -
 .../config/mirror_producer2.properties             |  28 -
 .../config/mirror_producer3.properties             |  28 -
 .../config/server_source1.properties               |  81 --
 .../config/server_source2.properties               |  82 --
 .../config/server_source3.properties               |  82 --
 .../config/server_source4.properties               |  82 --
 .../config/server_target1.properties               |  85 --
 .../config/server_target2.properties               |  85 --
 .../config/server_target3.properties               |  85 --
 .../config/whitelisttest.consumer.properties       |  29 -
 .../config/zookeeper_source.properties             |  18 -
 .../config/zookeeper_target.properties             |  18 -
 trunk/system_test/common/util.sh                   | 168 ----
 trunk/system_test/mirror_maker/README              |  22 -
 trunk/system_test/mirror_maker/bin/expected.out    |  18 -
 trunk/system_test/mirror_maker/bin/run-test.sh     | 357 --------
 .../config/blacklisttest.consumer.properties       |  28 -
 .../mirror_maker/config/mirror_producer.properties |  30 -
 .../config/server_source_1_1.properties            |  76 --
 .../config/server_source_1_2.properties            |  76 --
 .../config/server_source_2_1.properties            |  76 --
 .../config/server_source_2_2.properties            |  76 --
 .../config/server_target_1_1.properties            |  78 --
 .../config/server_target_1_2.properties            |  78 --
 .../config/whitelisttest_1.consumer.properties     |  28 -
 .../config/whitelisttest_2.consumer.properties     |  28 -
 .../config/zookeeper_source_1.properties           |  18 -
 .../config/zookeeper_source_2.properties           |  18 -
 .../config/zookeeper_target.properties             |  18 -
 trunk/system_test/producer_perf/README             |   9 -
 trunk/system_test/producer_perf/bin/expected.out   |  32 -
 .../producer_perf/bin/run-compression-test.sh      |  62 --
 trunk/system_test/producer_perf/bin/run-test.sh    |  62 --
 .../producer_perf/config/server.properties         |  78 --
 .../producer_perf/config/zookeeper.properties      |  18 -
 549 files changed, 55901 deletions(-)
1a0b39347e27321a03a320dd26e51d441fcff602
497f2b7141afe38830ddc8dcc655cde91a4d94b5

 trunk/.gitignore                                   |  14 +
 trunk/.rat-excludes                                |  26 +
 trunk/DISCLAIMER                                   |  15 +
 trunk/LICENSE                                      | 262 ++++++
 trunk/NOTICE                                       |  10 +
 trunk/README.md                                    |  56 ++
 trunk/bin/kafka-console-consumer-log4j.properties  |  21 +
 trunk/bin/kafka-console-consumer.sh                |  19 +
 trunk/bin/kafka-console-producer.sh                |  18 +
 trunk/bin/kafka-consumer-perf-test.sh              |  17 +
 trunk/bin/kafka-consumer-shell.sh                  |  17 +
 trunk/bin/kafka-producer-perf-test.sh              |  17 +
 trunk/bin/kafka-producer-shell.sh                  |  17 +
 trunk/bin/kafka-replay-log-producer.sh             |  19 +
 trunk/bin/kafka-run-class.sh                       |  66 ++
 trunk/bin/kafka-server-start.sh                    |  25 +
 trunk/bin/kafka-server-stop.sh                     |  16 +
 trunk/bin/kafka-simple-consumer-perf-test.sh       |  17 +
 trunk/bin/kafka-simple-consumer-shell.sh           |  17 +
 trunk/bin/run-rat.sh                               |  35 +
 trunk/bin/zookeeper-server-start.sh                |  23 +
 trunk/bin/zookeeper-server-stop.sh                 |  16 +
 trunk/bin/zookeeper-shell.sh                       |  23 +
 trunk/clients/cpp/LICENSE                          | 203 +++++
 trunk/clients/cpp/Makefile.am                      |  51 ++
 trunk/clients/cpp/README.md                        |  56 ++
 trunk/clients/cpp/autoconf.sh                      |  33 +
 trunk/clients/cpp/configure.ac                     |  42 +
 trunk/clients/cpp/src/encoder.hpp                  |  62 ++
 trunk/clients/cpp/src/encoder_helper.hpp           |  79 ++
 trunk/clients/cpp/src/example.cpp                  |  54 ++
 trunk/clients/cpp/src/producer.cpp                 | 117 +++
 trunk/clients/cpp/src/producer.hpp                 | 116 +++
 .../clients/cpp/src/tests/encoder_helper_tests.cpp |  88 ++
 trunk/clients/cpp/src/tests/encoder_tests.cpp      |  69 ++
 trunk/clients/cpp/src/tests/producer_tests.cpp     |  76 ++
 trunk/clients/csharp/.gitignore                    |   5 +
 trunk/clients/csharp/LICENSE                       | 202 +++++
 trunk/clients/csharp/README.md                     |  66 ++
 trunk/clients/csharp/Settings.StyleCop             |  92 +++
 .../csharp/lib/StyleCop/Microsoft.StyleCop.Targets | 125 +++
 .../clients/csharp/lib/StyleCop/Settings.StyleCop  |  48 ++
 .../csharp/lib/nunit/2.5.9/nunit.framework.dll     | Bin 0 -> 135168 bytes
 .../src/Kafka/Kafka.Client/AbstractRequest.cs      |  51 ++
 .../Kafka/Kafka.Client/Cfg/AsyncProducerConfig.cs  |  74 ++
 .../Kafka/Kafka.Client/Cfg/BrokerPartitionInfo.cs  |  72 ++
 .../Cfg/BrokerPartitionInfoCollection.cs           |  52 ++
 .../csharp/src/Kafka/Kafka.Client/Cfg/Consumer.cs  | 136 ++++
 .../src/Kafka/Kafka.Client/Cfg/ConsumerConfig.cs   |  72 ++
 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs |  26 +
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  |  30 +
 .../Kafka.Client/Cfg/KafkaClientConfiguration.cs   |  93 +++
 .../src/Kafka/Kafka.Client/Cfg/KafkaServer.cs      |  52 ++
 .../src/Kafka/Kafka.Client/Cfg/ProducerConfig.cs   |  94 +++
 .../Kafka/Kafka.Client/Cfg/SyncProducerConfig.cs   |  66 ++
 .../csharp/src/Kafka/Kafka.Client/Cfg/ZKConfig.cs  |  43 +
 .../src/Kafka/Kafka.Client/Cfg/ZooKeeperServers.cs |  45 ++
 .../src/Kafka/Kafka.Client/Cluster/Broker.cs       |  68 ++
 .../src/Kafka/Kafka.Client/Cluster/Cluster.cs      | 130 +++
 .../src/Kafka/Kafka.Client/Cluster/Partition.cs    | 147 ++++
 .../csharp/src/Kafka/Kafka.Client/Consumer.cs      | 249 ++++++
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 235 ++++++
 .../Kafka.Client/Consumers/ConsumerIterator.cs     | 211 +++++
 .../Consumers/ConsumerIteratorState.cs             |  28 +
 .../Kafka.Client/Consumers/FetchedDataChunk.cs     |  58 ++
 .../src/Kafka/Kafka.Client/Consumers/Fetcher.cs    | 170 ++++
 .../Kafka.Client/Consumers/FetcherRunnable.cs      | 191 +++++
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  |  74 ++
 .../Kafka.Client/Consumers/IConsumerConnector.cs   |  45 ++
 .../Kafka.Client/Consumers/KafkaMessageStream.cs   |  53 ++
 .../Kafka.Client/Consumers/PartitionTopicInfo.cs   | 198 +++++
 .../src/Kafka/Kafka.Client/Consumers/TopicCount.cs | 111 +++
 .../Consumers/ZookeeperConsumerConnector.cs        | 322 ++++++++
 .../Exceptions/ConsumerTimeoutException.cs         |  28 +
 .../Kafka.Client/Exceptions/KafkaException.cs      | 100 +++
 .../Exceptions/MessageSizeTooLargeException.cs     |  25 +
 .../Exceptions/ZKRebalancerException.cs            |  33 +
 .../Kafka.Client/Exceptions/ZooKeeperException.cs  |  45 ++
 .../Exceptions/ZooKeeperTimeoutException.cs        |  34 +
 .../src/Kafka/Kafka.Client/Kafka.Client.csproj     | 245 ++++++
 .../src/Kafka/Kafka.Client/KafkaClientBase.cs      |  44 +
 .../src/Kafka/Kafka.Client/KafkaConnection.cs      | 224 ++++++
 .../src/Kafka/Kafka.Client/KafkaException.cs       |  98 +++
 .../csharp/src/Kafka/Kafka.Client/Message.cs       | 157 ++++
 .../Kafka/Kafka.Client/Messages/BoundedBuffer.cs   |  38 +
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 407 ++++++++++
 .../src/Kafka/Kafka.Client/Messages/Message.cs     | 329 ++++++++
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  |  91 +++
 .../csharp/src/Kafka/Kafka.Client/Producer.cs      | 152 ++++
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  | 207 +++++
 .../Producers/Async/AsyncProducerPool.cs           | 224 ++++++
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs |  80 ++
 .../Producers/Async/ICallbackHandler.cs            |  35 +
 .../Kafka.Client/Producers/Async/MessageSent.cs    |  31 +
 .../src/Kafka/Kafka.Client/Producers/IProducer.cs  |  46 ++
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  |  58 ++
 .../Partitioning/ConfigBrokerPartitionInfo.cs      | 119 +++
 .../Producers/Partitioning/DefaultPartitioner.cs   |  50 ++
 .../Producers/Partitioning/IBrokerPartitionInfo.cs |  49 ++
 .../Producers/Partitioning/IPartitioner.cs         |  36 +
 .../Partitioning/ZKBrokerPartitionInfo.cs          | 342 ++++++++
 .../Kafka.Client/Producers/Producer.StrMsg.cs      |  96 +++
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   | 337 ++++++++
 .../Kafka/Kafka.Client/Producers/ProducerData.cs   |  95 +++
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   | 206 +++++
 .../Kafka.Client/Producers/ProducerPoolData.cs     |  65 ++
 .../Kafka/Kafka.Client/Producers/ProducerTypes.cs  |  29 +
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   |  60 ++
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    | 155 ++++
 .../Producers/Sync/SyncProducerPool.cs             | 226 ++++++
 .../Kafka/Kafka.Client/Properties/AssemblyInfo.cs  |  34 +
 .../src/Kafka/Kafka.Client/Request/FetchRequest.cs | 129 +++
 .../Kafka.Client/Request/MultiFetchRequest.cs      |  79 ++
 .../Kafka.Client/Request/MultiProducerRequest.cs   |  87 ++
 .../Kafka/Kafka.Client/Request/OffsetRequest.cs    | 107 +++
 .../Kafka/Kafka.Client/Request/ProducerRequest.cs  | 115 +++
 .../src/Kafka/Kafka.Client/RequestContext.cs       |  54 ++
 .../csharp/src/Kafka/Kafka.Client/RequestType.cs   |  53 ++
 .../Kafka/Kafka.Client/Requests/AbstractRequest.cs |  61 ++
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    | 156 ++++
 .../Kafka.Client/Requests/MultiFetchRequest.cs     | 109 +++
 .../Kafka.Client/Requests/MultiProducerRequest.cs  | 134 ++++
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   | 136 ++++
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs | 142 ++++
 .../Kafka/Kafka.Client/Requests/RequestTypes.cs    |  53 ++
 .../Kafka.Client/Serialization/DefaultEncoder.cs   |  41 +
 .../Kafka/Kafka.Client/Serialization/IEncoder.cs   |  41 +
 .../Kafka/Kafka.Client/Serialization/IWritable.cs  |  43 +
 .../Serialization/KafkaBinaryReader.cs             | 148 ++++
 .../Serialization/KafkaBinaryWriter.cs             | 127 +++
 .../Kafka.Client/Serialization/StringEncoder.cs    |  43 +
 .../csharp/src/Kafka/Kafka.Client/Util/BitWorks.cs |  86 ++
 .../csharp/src/Kafka/Kafka.Client/Util/Crc32.cs    | 132 +++
 .../src/Kafka/Kafka.Client/Utils/BitWorks.cs       |  83 ++
 .../src/Kafka/Kafka.Client/Utils/Crc32Hasher.cs    | 138 ++++
 .../src/Kafka/Kafka.Client/Utils/ErrorMapping.cs   |  29 +
 .../src/Kafka/Kafka.Client/Utils/Extensions.cs     |  49 ++
 .../csharp/src/Kafka/Kafka.Client/Utils/Guard.cs   | 120 +++
 .../src/Kafka/Kafka.Client/Utils/KafkaScheduler.cs |  86 ++
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   |  56 ++
 .../src/Kafka/Kafka.Client/Utils/ZKGroupDirs.cs    |  39 +
 .../Kafka/Kafka.Client/Utils/ZKGroupTopicDirs.cs   |  32 +
 .../csharp/src/Kafka/Kafka.Client/Utils/ZkUtils.cs | 147 ++++
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  |  44 +
 .../Events/ChildChangedEventItem.cs                | 113 +++
 .../Events/DataChangedEventItem.cs                 | 161 ++++
 .../Events/ZooKeeperChildChangedEventArgs.cs       |  60 ++
 .../Events/ZooKeeperDataChangedEventArgs.cs        |  88 ++
 .../Events/ZooKeeperEventArgs.cs                   |  56 ++
 .../Events/ZooKeeperEventTypes.cs                  |  35 +
 .../Events/ZooKeeperSessionCreatedEventArgs.cs     |  46 ++
 .../Events/ZooKeeperStateChangedEventArgs.cs       |  55 ++
 .../ZooKeeperIntegration/IZooKeeperClient.cs       | 469 +++++++++++
 .../ZooKeeperIntegration/IZooKeeperConnection.cs   | 164 ++++
 .../ZooKeeperIntegration/IZooKeeperSerializer.cs   |  48 ++
 .../Listeners/BrokerTopicsListener.cs              | 257 ++++++
 .../Listeners/IZooKeeperChildListener.cs           |  43 +
 .../Listeners/IZooKeeperDataListener.cs            |  49 ++
 .../Listeners/IZooKeeperStateListener.cs           |  42 +
 .../Listeners/ZKRebalancerListener.cs              | 368 +++++++++
 .../Listeners/ZKSessionExpireListener.cs           |  86 ++
 .../ZooKeeperClient.Watcher.cs                     | 682 ++++++++++++++++
 .../ZooKeeperIntegration/ZooKeeperClient.cs        | 893 +++++++++++++++++++++
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    | 327 ++++++++
 .../ZooKeeperStringSerializer.cs                   |  72 ++
 trunk/clients/csharp/src/Kafka/Kafka.FxCop         | 120 +++
 trunk/clients/csharp/src/Kafka/Kafka.sln           |  61 ++
 .../Tests/Kafka.Client.IntegrationTests/App.config |  43 +
 .../Config/Debug/App.config                        |  43 +
 .../Config/Integration/App.config                  |  37 +
 .../ConsumerRebalancingTests.cs                    | 236 ++++++
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 307 +++++++
 .../IntegrationFixtureBase.cs                      | 147 ++++
 .../Kafka.Client.IntegrationTests.csproj           | 141 ++++
 .../KafkaIntegrationTest.cs                        | 488 +++++++++++
 .../Kafka.Client.IntegrationTests/Log4Net.config   |  55 ++
 .../MockAlwaysZeroPartitioner.cs                   |  34 +
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 226 ++++++
 .../Properties/AssemblyInfo.cs                     |  52 ++
 .../Kafka.Client.IntegrationTests/TestHelper.cs    |  48 ++
 .../TestMultipleBrokersHelper.cs                   |  78 ++
 .../Kafka.Client.IntegrationTests/TestsSetup.cs    |  35 +
 .../ZKBrokerPartitionInfoTests.cs                  | 464 +++++++++++
 .../ZooKeeperAwareProducerTests.cs                 | 224 ++++++
 .../ZooKeeperClientTests.cs                        | 411 ++++++++++
 .../ZooKeeperConnectionTests.cs                    | 118 +++
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   | 118 +++
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    | 108 +++
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs | 138 ++++
 .../Producers/PartitioningTests.cs                 |  73 ++
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs  |  51 ++
 .../Request/FetchRequestTests.cs                   |  76 ++
 .../Request/MultiFetchRequestTests.cs              |  78 ++
 .../Request/MultiProducerRequestTests.cs           |  69 ++
 .../Request/OffsetRequestTests.cs                  |  73 ++
 .../Request/ProducerRequestTests.cs                |  77 ++
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs | 121 +++
 trunk/clients/go/.gitignore                        |  13 +
 trunk/clients/go/LICENSE                           | 208 +++++
 trunk/clients/go/Makefile                          |  26 +
 trunk/clients/go/README.md                         |  99 +++
 trunk/clients/go/kafka_test.go                     | 277 +++++++
 trunk/clients/go/src/consumer.go                   | 199 +++++
 trunk/clients/go/src/converts.go                   |  51 ++
 trunk/clients/go/src/kafka.go                      |  95 +++
 trunk/clients/go/src/message.go                    | 182 +++++
 trunk/clients/go/src/payload_codec.go              | 116 +++
 trunk/clients/go/src/publisher.go                  |  55 ++
 trunk/clients/go/src/request.go                    | 101 +++
 trunk/clients/go/src/timing.go                     |  49 ++
 trunk/clients/go/tools/consumer/Makefile           |   7 +
 trunk/clients/go/tools/consumer/consumer.go        | 111 +++
 trunk/clients/go/tools/offsets/Makefile            |   7 +
 trunk/clients/go/tools/offsets/offsets.go          |  62 ++
 trunk/clients/go/tools/publisher/Makefile          |   7 +
 trunk/clients/go/tools/publisher/publisher.go      |  89 ++
 trunk/clients/php/LICENSE                          | 203 +++++
 trunk/clients/php/README.md                        |  20 +
 trunk/clients/php/src/examples/autoloader.php      |  40 +
 trunk/clients/php/src/examples/consume.php         |  53 ++
 trunk/clients/php/src/examples/produce.php         |  46 ++
 .../src/lib/Kafka/BoundedByteBuffer/Receive.php    | 154 ++++
 .../php/src/lib/Kafka/BoundedByteBuffer/Send.php   | 118 +++
 trunk/clients/php/src/lib/Kafka/Encoder.php        |  73 ++
 trunk/clients/php/src/lib/Kafka/FetchRequest.php   | 126 +++
 trunk/clients/php/src/lib/Kafka/Message.php        | 126 +++
 trunk/clients/php/src/lib/Kafka/MessageSet.php     | 122 +++
 trunk/clients/php/src/lib/Kafka/Producer.php       | 122 +++
 trunk/clients/php/src/lib/Kafka/Request.php        |  30 +
 trunk/clients/php/src/lib/Kafka/RequestKeys.php    |  30 +
 trunk/clients/php/src/lib/Kafka/SimpleConsumer.php | 142 ++++
 .../tests/Kafka/BoundedByteBuffer/ReceiveTest.php  | 133 +++
 .../src/tests/Kafka/BoundedByteBuffer/SendTest.php | 100 +++
 trunk/clients/php/src/tests/Kafka/EncoderTest.php  |  61 ++
 .../php/src/tests/Kafka/FetchRequestTest.php       |  88 ++
 trunk/clients/php/src/tests/Kafka/MessageTest.php  |  62 ++
 trunk/clients/php/src/tests/Kafka/ProducerTest.php |  76 ++
 trunk/clients/php/src/tests/bootstrap.php          |  53 ++
 trunk/clients/php/src/tests/phpunit.xml            |  17 +
 trunk/clients/python/LICENSE                       | 203 +++++
 trunk/clients/python/kafka.py                      |  73 ++
 trunk/clients/python/setup.py                      |  33 +
 trunk/clients/ruby/LICENSE                         | 202 +++++
 trunk/clients/ruby/README.md                       |  62 ++
 trunk/clients/ruby/Rakefile                        |  76 ++
 trunk/clients/ruby/TODO                            |   1 +
 trunk/clients/ruby/kafka-rb.gemspec                |  46 ++
 trunk/clients/ruby/lib/kafka.rb                    |  27 +
 trunk/clients/ruby/lib/kafka/batch.rb              |  27 +
 trunk/clients/ruby/lib/kafka/consumer.rb           | 149 ++++
 trunk/clients/ruby/lib/kafka/error_codes.rb        |  35 +
 trunk/clients/ruby/lib/kafka/io.rb                 |  53 ++
 trunk/clients/ruby/lib/kafka/message.rb            |  49 ++
 trunk/clients/ruby/lib/kafka/producer.rb           |  63 ++
 trunk/clients/ruby/lib/kafka/request_type.rb       |  23 +
 trunk/clients/ruby/spec/batch_spec.rb              |  35 +
 trunk/clients/ruby/spec/consumer_spec.rb           | 134 ++++
 trunk/clients/ruby/spec/io_spec.rb                 |  91 +++
 trunk/clients/ruby/spec/kafka_spec.rb              |  21 +
 trunk/clients/ruby/spec/message_spec.rb            |  69 ++
 trunk/clients/ruby/spec/producer_spec.rb           | 109 +++
 trunk/clients/ruby/spec/spec_helper.rb             |  18 +
 trunk/config/consumer.properties                   |  29 +
 trunk/config/log4j.properties                      |  30 +
 trunk/config/producer.properties                   |  80 ++
 trunk/config/server.properties                     | 116 +++
 trunk/config/zookeeper.properties                  |  20 +
 trunk/contrib/hadoop-consumer/LICENSE              | 203 +++++
 trunk/contrib/hadoop-consumer/README               |  66 ++
 trunk/contrib/hadoop-consumer/copy-jars.sh         |  69 ++
 trunk/contrib/hadoop-consumer/hadoop-setup.sh      |  20 +
 trunk/contrib/hadoop-consumer/lib/piggybank.jar    | Bin 0 -> 308044 bytes
 trunk/contrib/hadoop-consumer/run-class.sh         |  65 ++
 .../src/main/java/kafka/etl/KafkaETLContext.java   | 286 +++++++
 .../main/java/kafka/etl/KafkaETLInputFormat.java   |  78 ++
 .../src/main/java/kafka/etl/KafkaETLJob.java       | 172 ++++
 .../src/main/java/kafka/etl/KafkaETLKey.java       | 104 +++
 .../main/java/kafka/etl/KafkaETLRecordReader.java  | 180 +++++
 .../src/main/java/kafka/etl/KafkaETLRequest.java   | 128 +++
 .../src/main/java/kafka/etl/KafkaETLUtils.java     | 205 +++++
 .../src/main/java/kafka/etl/Props.java             | 461 +++++++++++
 .../java/kafka/etl/UndefinedPropertyException.java |  28 +
 .../main/java/kafka/etl/impl/DataGenerator.java    | 134 ++++
 .../java/kafka/etl/impl/SimpleKafkaETLJob.java     | 104 +++
 .../java/kafka/etl/impl/SimpleKafkaETLMapper.java  |  88 ++
 trunk/contrib/hadoop-consumer/test/test.properties |  42 +
 trunk/contrib/hadoop-producer/LICENSE              | 203 +++++
 trunk/contrib/hadoop-producer/README.md            | 147 ++++
 trunk/contrib/hadoop-producer/lib/piggybank.jar    | Bin 0 -> 308044 bytes
 .../java/kafka/bridge/examples/TextPublisher.java  |  68 ++
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     | 173 ++++
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |  74 ++
 .../java/kafka/bridge/pig/AvroKafkaStorage.java    | 117 +++
 trunk/core/src/main/scala/kafka/Kafka.scala        |  55 ++
 .../src/main/scala/kafka/api/FetchRequest.scala    |  51 ++
 .../main/scala/kafka/api/MultiFetchRequest.scala   |  58 ++
 .../main/scala/kafka/api/MultiFetchResponse.scala  |  52 ++
 .../scala/kafka/api/MultiProducerRequest.scala     |  57 ++
 .../src/main/scala/kafka/api/OffsetRequest.scala   | 100 +++
 .../src/main/scala/kafka/api/ProducerRequest.scala |  83 ++
 .../src/main/scala/kafka/api/RequestKeys.scala     |  26 +
 .../core/src/main/scala/kafka/cluster/Broker.scala |  48 ++
 .../src/main/scala/kafka/cluster/Cluster.scala     |  45 ++
 .../src/main/scala/kafka/cluster/Partition.scala   |  57 ++
 .../common/ConsumerReblanceFailedException.scala   |  26 +
 .../src/main/scala/kafka/common/ErrorMapping.scala |  61 ++
 .../kafka/common/InvalidConfigException.scala      |  25 +
 .../kafka/common/InvalidMessageSizeException.scala |  26 +
 .../kafka/common/InvalidPartitionException.scala   |  24 +
 .../common/NoBrokersForPartitionException.scala    |  26 +
 .../kafka/common/OffsetOutOfRangeException.scala   |  26 +
 .../common/UnavailableProducerException.scala      |  24 +
 .../scala/kafka/common/UnknownCodecException.scala |  26 +
 .../main/scala/kafka/common/UnknownException.scala |  23 +
 .../kafka/common/UnknownMagicByteException.scala   |  26 +
 .../scala/kafka/consumer/ConsoleConsumer.scala     | 249 ++++++
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  98 +++
 .../scala/kafka/consumer/ConsumerConnector.scala   |  92 +++
 .../scala/kafka/consumer/ConsumerIterator.scala    | 100 +++
 .../scala/kafka/consumer/ConsumerTopicStat.scala   |  60 ++
 .../scala/kafka/consumer/FetchedDataChunk.scala    |  24 +
 .../src/main/scala/kafka/consumer/Fetcher.scala    |  95 +++
 .../scala/kafka/consumer/FetcherRunnable.scala     | 141 ++++
 .../main/scala/kafka/consumer/KafkaStream.scala    |  47 ++
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  81 ++
 .../main/scala/kafka/consumer/SimpleConsumer.scala | 226 ++++++
 .../src/main/scala/kafka/consumer/TopicCount.scala | 176 ++++
 .../scala/kafka/consumer/TopicEventHandler.scala   |  24 +
 .../main/scala/kafka/consumer/TopicFilter.scala    |  76 ++
 .../consumer/ZookeeperConsumerConnector.scala      | 810 +++++++++++++++++++
 .../consumer/ZookeeperTopicEventWatcher.scala      | 105 +++
 .../src/main/scala/kafka/consumer/package.html     |   1 +
 .../consumer/storage/MemoryOffsetStorage.scala     |  44 +
 .../kafka/consumer/storage/OffsetStorage.scala     |  40 +
 .../consumer/storage/OracleOffsetStorage.scala     | 155 ++++
 .../src/main/scala/kafka/javaapi/Implicits.scala   | 123 +++
 .../scala/kafka/javaapi/MultiFetchResponse.scala   |  45 ++
 .../main/scala/kafka/javaapi/ProducerRequest.scala |  52 ++
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  69 ++
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |  71 ++
 .../consumer/ZookeeperConsumerConnector.scala      | 109 +++
 .../javaapi/message/ByteBufferMessageSet.scala     |  79 ++
 .../scala/kafka/javaapi/message/MessageSet.scala   |  55 ++
 .../scala/kafka/javaapi/producer/Producer.scala    | 122 +++
 .../kafka/javaapi/producer/ProducerData.scala      |  34 +
 .../kafka/javaapi/producer/SyncProducer.scala      |  48 ++
 .../javaapi/producer/async/CallbackHandler.java    |  77 ++
 .../kafka/javaapi/producer/async/EventHandler.java |  48 ++
 trunk/core/src/main/scala/kafka/log/Log.scala      | 412 ++++++++++
 .../core/src/main/scala/kafka/log/LogManager.scala | 357 ++++++++
 trunk/core/src/main/scala/kafka/log/LogStats.scala |  44 +
 .../src/main/scala/kafka/log/SegmentList.scala     |  86 ++
 trunk/core/src/main/scala/kafka/log/package.html   |   1 +
 .../message/ByteBufferBackedInputStream.scala      |  42 +
 .../scala/kafka/message/ByteBufferMessageSet.scala | 203 +++++
 .../scala/kafka/message/CompressionCodec.scala     |  39 +
 .../scala/kafka/message/CompressionUtils.scala     | 160 ++++
 .../main/scala/kafka/message/FileMessageSet.scala  | 280 +++++++
 .../kafka/message/InvalidMessageException.scala    |  25 +
 .../src/main/scala/kafka/message/Message.scala     | 180 +++++
 .../scala/kafka/message/MessageAndMetadata.scala   |  21 +
 .../scala/kafka/message/MessageAndOffset.scala     |  22 +
 .../kafka/message/MessageLengthException.scala     |  24 +
 .../src/main/scala/kafka/message/MessageSet.scala  | 114 +++
 .../core/src/main/scala/kafka/message/package.html |   1 +
 .../kafka/network/BoundedByteBufferReceive.scala   |  92 +++
 .../kafka/network/BoundedByteBufferSend.scala      |  56 ++
 .../main/scala/kafka/network/ByteBufferSend.scala  |  40 +
 .../scala/kafka/network/ConnectionConfig.scala     |  27 +
 .../src/main/scala/kafka/network/Handler.scala     |  33 +
 .../kafka/network/InvalidRequestException.scala    |  24 +
 .../src/main/scala/kafka/network/Request.scala     |  28 +
 .../main/scala/kafka/network/SocketServer.scala    | 354 ++++++++
 .../scala/kafka/network/SocketServerStats.scala    |  90 +++
 .../main/scala/kafka/network/Transmission.scala    | 107 +++
 .../core/src/main/scala/kafka/network/package.html |  11 +
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  59 ++
 .../kafka/producer/ConfigBrokerPartitionInfo.scala |  96 +++
 .../scala/kafka/producer/ConsoleProducer.scala     | 144 ++++
 .../scala/kafka/producer/DefaultPartitioner.scala  |  29 +
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  94 +++
 .../main/scala/kafka/producer/Partitioner.scala    |  26 +
 .../src/main/scala/kafka/producer/Producer.scala   | 213 +++++
 .../main/scala/kafka/producer/ProducerConfig.scala |  89 ++
 .../main/scala/kafka/producer/ProducerData.scala   |  39 +
 .../main/scala/kafka/producer/ProducerPool.scala   | 179 +++++
 .../main/scala/kafka/producer/SyncProducer.scala   | 229 ++++++
 .../scala/kafka/producer/SyncProducerConfig.scala  |  47 ++
 .../kafka/producer/ZKBrokerPartitionInfo.scala     | 380 +++++++++
 .../scala/kafka/producer/async/AsyncProducer.scala | 144 ++++
 .../kafka/producer/async/AsyncProducerConfig.scala |  61 ++
 .../async/AsyncProducerInterruptedException.scala  |  23 +
 .../kafka/producer/async/AsyncProducerStats.scala  |  50 ++
 .../producer/async/AsyncProducerStatsMBean.scala   |  27 +
 .../kafka/producer/async/CallbackHandler.scala     |  75 ++
 .../kafka/producer/async/DefaultEventHandler.scala | 133 +++
 .../scala/kafka/producer/async/EventHandler.scala  |  45 ++
 .../async/IllegalQueueStateException.scala         |  25 +
 .../producer/async/MissingConfigException.scala    |  23 +
 .../kafka/producer/async/ProducerSendThread.scala  | 129 +++
 .../producer/async/QueueClosedException.scala      |  23 +
 .../kafka/producer/async/QueueFullException.scala  |  23 +
 .../src/main/scala/kafka/serializer/Decoder.scala  |  37 +
 .../src/main/scala/kafka/serializer/Encoder.scala  |  32 +
 .../src/main/scala/kafka/server/KafkaConfig.scala  | 108 +++
 .../scala/kafka/server/KafkaRequestHandlers.scala  | 194 +++++
 .../src/main/scala/kafka/server/KafkaServer.scala  | 116 +++
 .../scala/kafka/server/KafkaServerStartable.scala  |  59 ++
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 117 +++
 .../main/scala/kafka/server/MessageSetSend.scala   |  71 ++
 .../scala/kafka/server/MultiMessageSetSend.scala   |  36 +
 .../core/src/main/scala/kafka/server/package.html  |   1 +
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 161 ++++
 .../src/main/scala/kafka/tools/ConsumerShell.scala | 108 +++
 .../main/scala/kafka/tools/DumpLogSegments.scala   |  53 ++
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 123 +++
 .../main/scala/kafka/tools/GetOffsetShell.scala    |  73 ++
 .../main/scala/kafka/tools/ImportZkOffsets.scala   | 112 +++
 .../core/src/main/scala/kafka/tools/JmxTool.scala  | 110 +++
 .../src/main/scala/kafka/tools/MirrorMaker.scala   | 171 ++++
 .../src/main/scala/kafka/tools/ProducerShell.scala |  71 ++
 .../main/scala/kafka/tools/ReplayLogProducer.scala | 209 +++++
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 113 +++
 .../kafka/tools/VerifyConsumerRebalance.scala      | 135 ++++
 .../src/main/scala/kafka/utils/Annotations.scala   |  36 +
 .../src/main/scala/kafka/utils/DelayedItem.scala   |  49 ++
 .../main/scala/kafka/utils/IteratorTemplate.scala  |  80 ++
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  51 ++
 .../main/scala/kafka/utils/Log4jController.scala   |  98 +++
 .../core/src/main/scala/kafka/utils/Logging.scala  | 101 +++
 .../core/src/main/scala/kafka/utils/MockTime.scala |  34 +
 .../src/main/scala/kafka/utils/Mx4jLoader.scala    |  72 ++
 trunk/core/src/main/scala/kafka/utils/Pool.scala   |  66 ++
 trunk/core/src/main/scala/kafka/utils/Range.scala  |  42 +
 .../src/main/scala/kafka/utils/Throttler.scala     |  79 ++
 trunk/core/src/main/scala/kafka/utils/Time.scala   |  61 ++
 .../scala/kafka/utils/TopicNameValidator.scala     |  41 +
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |  79 ++
 trunk/core/src/main/scala/kafka/utils/Utils.scala  | 841 +++++++++++++++++++
 .../core/src/main/scala/kafka/utils/ZkUtils.scala  | 312 +++++++
 trunk/core/src/main/scala/kafka/utils/package.html |   1 +
 trunk/core/src/test/resources/log4j.properties     |  25 +
 .../MagicByte0-0/00000000000000000000.kafka        | Bin 0 -> 10900 bytes
 .../src/test/scala/other/kafka.log4j.properties    |  22 +
 .../src/test/scala/other/kafka/DeleteZKPath.scala  |  45 ++
 .../test/scala/other/kafka/TestKafkaAppender.scala |  50 ++
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  76 ++
 .../scala/other/kafka/TestLogPerformance.scala     |  56 ++
 .../src/test/scala/other/kafka/TestTruncate.scala  |  39 +
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |  74 ++
 .../unit/kafka/consumer/TopicFilterTest.scala      |  51 ++
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 288 +++++++
 .../kafka/integration/AutoOffsetResetTest.scala    | 223 +++++
 .../integration/BackwardsCompatibilityTest.scala   |  76 ++
 .../scala/unit/kafka/integration/FetcherTest.scala | 107 +++
 .../kafka/integration/KafkaServerTestHarness.scala |  45 ++
 .../kafka/integration/LazyInitProducerTest.scala   | 185 +++++
 .../unit/kafka/integration/LogCorruptionTest.scala | 111 +++
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 271 +++++++
 .../integration/ProducerConsumerTestHarness.scala  |  52 ++
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 124 +++
 .../javaapi/integration/PrimitiveApiTest.scala     | 417 ++++++++++
 .../integration/ProducerConsumerTestHarness.scala  |  53 ++
 .../javaapi/message/BaseMessageSetTestCases.scala  |  74 ++
 .../javaapi/message/ByteBufferMessageSetTest.scala |  86 ++
 .../unit/kafka/javaapi/producer/ProducerTest.scala | 633 +++++++++++++++
 .../kafka/javaapi/producer/SyncProducerTest.scala  |  98 +++
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 233 ++++++
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  | 215 +++++
 .../src/test/scala/unit/kafka/log/LogTest.scala    | 299 +++++++
 .../scala/unit/kafka/log/SegmentListTest.scala     |  58 ++
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 254 ++++++
 .../kafka/message/BaseMessageSetTestCases.scala    |  69 ++
 .../kafka/message/ByteBufferMessageSetTest.scala   | 162 ++++
 .../unit/kafka/message/CompressionUtilsTest.scala  |  75 ++
 .../unit/kafka/message/FileMessageSetTest.scala    |  84 ++
 .../scala/unit/kafka/message/MessageTest.scala     |  70 ++
 .../unit/kafka/network/SocketServerTest.scala      |  79 ++
 .../unit/kafka/producer/AsyncProducerTest.scala    | 319 ++++++++
 .../unit/kafka/producer/ProducerMethodsTest.scala  |  57 ++
 .../scala/unit/kafka/producer/ProducerTest.scala   | 702 ++++++++++++++++
 .../unit/kafka/producer/SyncProducerTest.scala     | 134 ++++
 .../unit/kafka/server/ServerShutdownTest.scala     | 122 +++
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 308 +++++++
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  54 ++
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  40 +
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  57 ++
 .../scala/unit/kafka/zk/ZKLoadBalanceTest.scala    | 127 +++
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  42 +
 trunk/examples/README                              |  19 +
 trunk/examples/bin/java-producer-consumer-demo.sh  |  59 ++
 trunk/examples/bin/java-simple-consumer-demo.sh    |  59 ++
 .../src/main/java/kafka/examples/Consumer.java     |  65 ++
 .../src/main/java/kafka/examples/ExampleUtils.java |  32 +
 .../kafka/examples/KafkaConsumerProducerDemo.java  |  30 +
 .../main/java/kafka/examples/KafkaProperties.java  |  31 +
 .../src/main/java/kafka/examples/Producer.java     |  50 ++
 .../java/kafka/examples/SimpleConsumerDemo.java    |  83 ++
 trunk/lib/sbt-launch.jar                           | Bin 0 -> 920993 bytes
 trunk/perf/config/log4j.properties                 |  24 +
 .../scala/kafka/perf/ConsumerPerformance.scala     | 196 +++++
 .../src/main/scala/kafka/perf/PerfConfig.scala     |  48 ++
 .../scala/kafka/perf/ProducerPerformance.scala     | 237 ++++++
 .../kafka/perf/SimpleConsumerPerformance.scala     | 141 ++++
 trunk/project/build.properties                     |  24 +
 trunk/project/build/KafkaProject.scala             | 249 ++++++
 trunk/project/plugins/Plugins.scala                |  23 +
 trunk/sbt                                          |   1 +
 trunk/system_test/broker_failure/README            |  72 ++
 .../broker_failure/bin/kafka-run-class.sh          |  67 ++
 trunk/system_test/broker_failure/bin/run-test.sh   | 823 +++++++++++++++++++
 .../broker_failure/config/log4j.properties         |  86 ++
 .../config/mirror_producer.properties              |  27 +
 .../config/mirror_producer1.properties             |  28 +
 .../config/mirror_producer2.properties             |  28 +
 .../config/mirror_producer3.properties             |  28 +
 .../config/server_source1.properties               |  81 ++
 .../config/server_source2.properties               |  82 ++
 .../config/server_source3.properties               |  82 ++
 .../config/server_source4.properties               |  82 ++
 .../config/server_target1.properties               |  85 ++
 .../config/server_target2.properties               |  85 ++
 .../config/server_target3.properties               |  85 ++
 .../config/whitelisttest.consumer.properties       |  29 +
 .../config/zookeeper_source.properties             |  18 +
 .../config/zookeeper_target.properties             |  18 +
 trunk/system_test/common/util.sh                   | 168 ++++
 trunk/system_test/mirror_maker/README              |  22 +
 trunk/system_test/mirror_maker/bin/expected.out    |  18 +
 trunk/system_test/mirror_maker/bin/run-test.sh     | 357 ++++++++
 .../config/blacklisttest.consumer.properties       |  28 +
 .../mirror_maker/config/mirror_producer.properties |  30 +
 .../config/server_source_1_1.properties            |  76 ++
 .../config/server_source_1_2.properties            |  76 ++
 .../config/server_source_2_1.properties            |  76 ++
 .../config/server_source_2_2.properties            |  76 ++
 .../config/server_target_1_1.properties            |  78 ++
 .../config/server_target_1_2.properties            |  78 ++
 .../config/whitelisttest_1.consumer.properties     |  28 +
 .../config/whitelisttest_2.consumer.properties     |  28 +
 .../config/zookeeper_source_1.properties           |  18 +
 .../config/zookeeper_source_2.properties           |  18 +
 .../config/zookeeper_target.properties             |  18 +
 trunk/system_test/producer_perf/README             |   9 +
 trunk/system_test/producer_perf/bin/expected.out   |  32 +
 .../producer_perf/bin/run-compression-test.sh      |  62 ++
 trunk/system_test/producer_perf/bin/run-test.sh    |  62 ++
 .../producer_perf/config/server.properties         |  78 ++
 .../producer_perf/config/zookeeper.properties      |  18 +
 549 files changed, 55901 insertions(+)
3889a3b34fd358ce512efe8c44c44befc19e3273

 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 .../scala/kafka/admin/CreateTopicCommand.scala     |   1 -
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |  10 +-
 .../kafka/common/StateChangeFailedException.scala  |  23 +
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 .../controller/ControllerChannelManager.scala      | 177 ++++++
 .../scala/kafka/controller/KafkaController.scala   | 281 ++++++++++
 .../kafka/controller/PartitionStateMachine.scala   | 416 ++++++++++++++
 .../kafka/controller/ReplicaStateMachine.scala     | 232 ++++++++
 .../main/scala/kafka/server/KafkaController.scala  | 615 ---------------------
 core/src/main/scala/kafka/server/KafkaServer.scala |   1 +
 .../main/scala/kafka/server/LeaderElector.scala    |  35 ++
 .../main/scala/kafka/server/ReplicaManager.scala   |  13 +-
 .../kafka/server/ZookeeperLeaderElector.scala      |  98 ++++
 .../kafka/tools/VerifyConsumerRebalance.scala      |   2 +-
 .../scala/kafka/utils/ShutdownableThread.scala     |   2 +-
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |   2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  52 +-
 .../kafka/network/RpcDataSerializationTest.scala   |   2 +-
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  24 +-
 20 files changed, 1337 insertions(+), 655 deletions(-)
13e606924f7d234a548a47232bc1413e46d54539

 core/src/main/scala/kafka/producer/BrokerPartitionInfo.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d37eb7fdd87ce16afb1cf94e1236301663833247

 .../src/main/scala/kafka/consumer/TopicCount.scala |  8 ++------
 core/src/main/scala/kafka/utils/Utils.scala        | 22 +++++++++++++++++++++-
 2 files changed, 23 insertions(+), 7 deletions(-)
b688c3ba045df340bc32caa40ba1909eddbcbec5

 .../main/java/kafka/etl/impl/DataGenerator.java    |  17 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   | 161 ++++------
 core/src/main/scala/kafka/api/FetchResponse.scala  | 182 ++++++------
 .../src/main/scala/kafka/api/ProducerRequest.scala | 113 +++----
 .../main/scala/kafka/api/ProducerResponse.scala    | 102 ++++---
 .../main/scala/kafka/api/RequestOrResponse.scala   |   6 +
 .../src/main/scala/kafka/common/ErrorMapping.scala |  14 +-
 .../kafka/common/FetchRequestFormatException.scala |  21 --
 .../scala/kafka/common/TopicAndPartition.scala     |  29 ++
 .../kafka/consumer/ConsumerFetcherManager.scala    |  38 +--
 .../kafka/consumer/ConsumerFetcherThread.scala     |   4 +-
 .../main/scala/kafka/javaapi/FetchRequest.scala    |  61 ++++
 .../main/scala/kafka/javaapi/FetchResponse.scala   |  22 +-
 .../main/scala/kafka/javaapi/ProducerRequest.scala |  44 ---
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |  20 +-
 .../kafka/javaapi/producer/SyncProducer.scala      |  43 ---
 .../main/scala/kafka/network/RequestChannel.scala  |   4 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |   2 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  84 +++---
 .../scala/kafka/server/AbstractFetcherThread.scala |  47 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   | 323 ++++++++++-----------
 .../scala/kafka/server/ReplicaFetcherManager.scala |   2 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   4 +-
 core/src/main/scala/kafka/utils/Utils.scala        |   2 +-
 .../kafka/integration/LazyInitProducerTest.scala   |  31 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  34 +--
 .../integration/ProducerConsumerTestHarness.scala  |  53 ----
 .../kafka/network/RpcDataSerializationTest.scala   |  58 ++--
 .../unit/kafka/network/SocketServerTest.scala      |   9 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  18 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  48 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  28 +-
 32 files changed, 777 insertions(+), 847 deletions(-)
c8f75870721ac99286272d1b85d09ce41fad444c

 core/src/main/scala/kafka/log/Log.scala            | 75 +++++++++++-----------
 core/src/main/scala/kafka/log/SegmentList.scala    | 47 ++++++--------
 .../main/scala/kafka/message/FileMessageSet.scala  |  2 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 50 +++++++++++++++
 .../scala/unit/kafka/log/SegmentListTest.scala     | 73 +++++++++++----------
 5 files changed, 149 insertions(+), 98 deletions(-)
fb0f176131b1d075e08cc110bbb9b58ce10dccf9

 .../config/producer_performance.properties         |   2 -
 .../replication_testsuite/replica_basic_test.py    | 137 ++++++++++++--------
 .../testcase_1/testcase_1_properties.json          |   5 +-
 system_test/utils/kafka_system_test_utils.py       | 144 ++++++++++++---------
 system_test/utils/testcase_env.py                  |   8 +-
 5 files changed, 179 insertions(+), 117 deletions(-)
e42c8d5f4e54d3661cb15c7231f9ad306d807790

 core/src/main/scala/kafka/log/LogManager.scala     |  8 +-----
 .../main/scala/kafka/network/SocketServer.scala    |  1 -
 core/src/main/scala/kafka/server/KafkaConfig.scala |  9 -------
 core/src/main/scala/kafka/server/KafkaServer.scala |  1 -
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 29 ----------------------
 .../unit/kafka/network/SocketServerTest.scala      |  1 -
 6 files changed, 1 insertion(+), 48 deletions(-)
2bc65dab67933e9f9cdade59bd0e45ff99afd338

 core/src/main/scala/kafka/api/FetchRequest.scala   |   4 +-
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala |   2 +-
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   2 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   4 +-
 core/src/main/scala/kafka/api/RequestKeys.scala    |  37 +++-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |   2 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  20 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |   2 +-
 .../scala/kafka/consumer/ConsumerConnector.scala   |   6 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |   4 +-
 .../scala/kafka/consumer/ConsumerTopicStat.scala   |  40 +---
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |   5 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  54 ++----
 .../consumer/ZookeeperConsumerConnector.scala      |  74 +------
 .../main/scala/kafka/javaapi/ProducerRequest.scala |   2 +-
 core/src/main/scala/kafka/log/Log.scala            |  23 ++-
 core/src/main/scala/kafka/log/LogStats.scala       |  44 -----
 .../main/scala/kafka/message/FileMessageSet.scala  |  43 +---
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |  28 +--
 .../main/scala/kafka/network/RequestChannel.scala  |  90 ++++++++-
 .../main/scala/kafka/network/SocketServer.scala    |  34 ++--
 .../scala/kafka/network/SocketServerStats.scala    |  90 ---------
 core/src/main/scala/kafka/producer/Producer.scala  |  49 +++--
 .../main/scala/kafka/producer/SyncProducer.scala   |  49 ++---
 .../kafka/producer/async/AsyncProducerStats.scala  |  21 +-
 .../producer/async/AsyncProducerStatsMBean.scala   |  26 ---
 .../kafka/producer/async/DefaultEventHandler.scala |  33 +++-
 .../kafka/producer/async/ProducerSendThread.scala  |  11 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  55 +++++-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 179 ++++-------------
 .../main/scala/kafka/server/KafkaController.scala  |  63 ++++--
 .../scala/kafka/server/KafkaRequestHandler.scala   |  68 ++-----
 core/src/main/scala/kafka/server/KafkaServer.scala |   8 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  25 ++-
 .../main/scala/kafka/server/RequestPurgatory.scala |  27 +--
 core/src/main/scala/kafka/utils/Pool.scala         |  12 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  95 ---------
 .../unit/kafka/integration/TopicMetadataTest.scala |  20 +-
 .../unit/kafka/network/SocketServerTest.scala      |  26 ++-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  25 +--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   8 +
 system_test/metrics.json                           | 216 ++++++++++-----------
 43 files changed, 631 insertions(+), 997 deletions(-)
de927e29482f066cc919817e260356ca9248d42f

 .../scala/kafka/admin/CreateTopicCommand.scala     | 16 +++++--
 core/src/main/scala/kafka/log/LogManager.scala     |  4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  6 ++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  5 ++-
 core/src/main/scala/kafka/utils/Topic.scala        | 44 ++++++++++++++++++
 .../unit/kafka/integration/TopicMetadataTest.scala |  2 +-
 .../scala/unit/kafka/server/SimpleFetchTest.scala  |  2 +
 .../test/scala/unit/kafka/utils/TopicTest.scala    | 52 ++++++++++++++++++++++
 8 files changed, 121 insertions(+), 10 deletions(-)
ea14ae8b7fe12b0c1dbb05c89d3d3eb4d7c882f9

 .../src/main/scala/kafka/common/ErrorMapping.scala |  4 +-
 core/src/main/scala/kafka/log/Log.scala            |  9 ++--
 core/src/main/scala/kafka/log/LogManager.scala     |  4 +-
 .../main/scala/kafka/producer/SyncProducer.scala   | 13 ------
 .../kafka/producer/async/DefaultEventHandler.scala |  6 ++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  6 +--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  3 ++
 .../scala/other/kafka/TestLogPerformance.scala     |  5 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 53 ++++++++++++++++++----
 .../unit/kafka/producer/SyncProducerTest.scala     | 46 ++++++++-----------
 10 files changed, 86 insertions(+), 63 deletions(-)
082d9d3b5a9be63740e4f4f033589f9ebb71e7be

 core/src/main/scala/kafka/api/LeaderAndISRRequest.scala | 0
 1 file changed, 0 insertions(+), 0 deletions(-)
ba58c9a7040e778b6c8cf9dc59d97858c2617afe

 .../src/main/java/kafka/etl/KafkaETLContext.java   | 32 ------------
 core/src/main/scala/kafka/api/FetchResponse.scala  |  2 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |  6 +--
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  9 ----
 core/src/main/scala/kafka/javaapi/Implicits.scala  |  3 +-
 .../javaapi/message/ByteBufferMessageSet.scala     | 26 +++------
 core/src/main/scala/kafka/log/Log.scala            |  2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala | 27 ++++------
 .../main/scala/kafka/message/FileMessageSet.scala  |  2 -
 core/src/main/scala/kafka/message/MessageSet.scala |  5 --
 core/src/main/scala/kafka/server/KafkaApis.scala   | 61 ++++++++++------------
 .../kafka/integration/LazyInitProducerTest.scala   |  8 +--
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 13 ++---
 .../javaapi/message/ByteBufferMessageSetTest.scala | 27 +---------
 .../kafka/message/ByteBufferMessageSetTest.scala   | 36 ++++++++-----
 15 files changed, 85 insertions(+), 174 deletions(-)
22e4341ba9f7744314ae0363529333a276bd325d

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  14 +-
 .../main/scala/kafka/api/LeaderAndISRRequest.scala | 121 -----
 .../main/scala/kafka/api/LeaderAndIsrRequest.scala | 121 +++++
 core/src/main/scala/kafka/cluster/Broker.scala     |   4 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  88 +--
 .../kafka/common/BrokerNotAvailableException.scala |  22 +
 .../kafka/common/BrokerNotExistException.scala     |  22 -
 .../src/main/scala/kafka/common/ErrorMapping.scala |   4 +-
 .../kafka/common/PartitionOfflineException.scala   |  26 +
 .../consumer/ZookeeperConsumerConnector.scala      |  29 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 .../main/scala/kafka/server/KafkaController.scala  | 595 ++++++++++++---------
 .../main/scala/kafka/server/ReplicaManager.scala   |  10 +-
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |  21 +-
 core/src/main/scala/kafka/utils/Utils.scala        |   1 -
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 248 +++++----
 .../kafka/network/RpcDataSerializationTest.scala   |  10 +-
 .../unit/kafka/server/RequestPurgatoryTest.scala   |   2 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  12 +-
 19 files changed, 731 insertions(+), 621 deletions(-)
87fa96e29186a9b874caed820cf25d3d6f91b9f3

 core/src/main/scala/kafka/log/Log.scala            |   6 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  74 +++++---
 .../scala/unit/kafka/server/SimpleFetchTest.scala  | 210 +++++++++++++++++++++
 3 files changed, 260 insertions(+), 30 deletions(-)
50792c8765458c93e4d3632a0b76be4ef4354a60

 core/src/test/scala/unit/kafka/producer/ProducerTest.scala | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)
259b710694a15a5554e895d41508dfc7241181c0

 core/src/test/scala/unit/kafka/server/RequestPurgatoryTest.scala | 3 +--
 core/src/test/scala/unit/kafka/utils/TestUtils.scala             | 1 +
 2 files changed, 2 insertions(+), 2 deletions(-)
9e54dadf4bffbd0401d4b92fb82b1044c87cccc8

 core/src/main/scala/kafka/log/LogManager.scala     |  6 ++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  3 ++
 .../scala/kafka/utils/TopicNameValidator.scala     | 41 ++++++++++++++++++++++
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 27 +++++++++++++-
 4 files changed, 73 insertions(+), 4 deletions(-)
4cea1de21a8f1638e9908560de08072e5782ff68

 system_test/README.txt                             |   7 +-
 system_test/cluster_config.json                    |  24 +-
 .../config/producer_performance.properties         |   1 -
 .../replication_testsuite/replica_basic_test.py    |  96 ++++---
 .../testcase_1/testcase_1_properties.json          |   3 +-
 system_test/utils/kafka_system_test_utils.py       | 302 ++++++++++++++++++---
 system_test/utils/metrics.py                       |  26 +-
 system_test/utils/system_test_utils.py             |  81 +++++-
 system_test/utils/testcase_env.py                  |  23 +-
 9 files changed, 443 insertions(+), 120 deletions(-)
d4f3eff171f97c45c977191999f1f03f7b343fd3

 config/log4j.properties                            |   3 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   6 +-
 .../main/scala/kafka/message/FileMessageSet.scala  |   6 +-
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |   2 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |  10 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   8 +-
 .../main/scala/kafka/server/RequestPurgatory.scala |   2 -
 core/src/main/scala/kafka/tools/JmxTool.scala      |  74 ++-
 system_test/cluster_config.json                    |  12 +-
 system_test/metrics.json                           | 174 +++++++
 .../replication_testsuite/config/server.properties |   2 +
 .../replication_testsuite/replica_basic_test.py    |  55 ++-
 system_test/single_host_multi_brokers/README       |  39 --
 .../bin/kafka-run-class.sh                         |  67 ---
 .../single_host_multi_brokers/bin/run-test.sh      | 529 ---------------------
 .../config/consumer.properties                     |  29 --
 .../config/log4j.properties                        |  41 --
 .../config/producer.properties                     |  69 ---
 .../config/server.properties                       | 119 -----
 .../config/zookeeper.properties                    |  20 -
 system_test/system_test_env.py                     |  18 +
 system_test/system_test_runner.py                  |  16 +
 system_test/utils/kafka_system_test_utils.py       | 104 ++--
 system_test/utils/metrics.py                       | 254 ++++++++++
 system_test/utils/pyh.py                           | 161 +++++++
 system_test/utils/setup_utils.py                   |  16 +
 system_test/utils/system_test_utils.py             |  17 +-
 system_test/utils/testcase_env.py                  |  24 +-
 28 files changed, 848 insertions(+), 1029 deletions(-)
695a8d43eb2a58920f3f00ae4dbce30b10adb42c

 core/src/main/scala/kafka/log/Log.scala                     |  1 +
 core/src/main/scala/kafka/server/KafkaRequestHandlers.scala | 12 ++++++++----
 2 files changed, 9 insertions(+), 4 deletions(-)
e72ff0ee2aef90f532249c7b29d184091d69b4c4

 core/src/main/scala/kafka/message/Message.scala | 24 ++++++++++++++----------
 1 file changed, 14 insertions(+), 10 deletions(-)
a32d37f6d1b0576c2851feb7d7850b89d6e79dfd

 config/server.properties                           |   3 -
 core/src/main/scala/kafka/Kafka.scala              |   5 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     |   2 +-
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  42 ++---
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |   9 +-
 .../scala/kafka/metrics/KafkaMetricsConfig.scala   |   9 +-
 .../scala/kafka/metrics/KafkaMetricsReporter.scala |   4 +-
 .../main/scala/kafka/producer/ProducerConfig.scala |  27 ++--
 .../main/scala/kafka/producer/ProducerPool.scala   |   2 +-
 .../scala/kafka/producer/SyncProducerConfig.scala  |  33 ++--
 .../kafka/producer/async/AsyncProducerConfig.scala |  15 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  93 +++++------
 .../scala/kafka/server/KafkaServerStartable.scala  |   1 +
 core/src/main/scala/kafka/utils/Mx4jLoader.scala   |   7 +-
 core/src/main/scala/kafka/utils/Utils.scala        | 173 ---------------------
 .../scala/kafka/utils/VerifiableProperties.scala   | 171 ++++++++++++++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  11 +-
 17 files changed, 312 insertions(+), 295 deletions(-)
a74cdb61b16dc0aabcd51e7f50d8d5422445aa9a

 core/src/main/scala/kafka/utils/Utils.scala | 52 ++++++++++++++++++++++-------
 1 file changed, 40 insertions(+), 12 deletions(-)
f2c901bcd422807f5d172a3a2f8aa18ee1b7c701

 core/src/main/scala/kafka/utils/Utils.scala | 52 ++++++++++++++++++++++-------
 1 file changed, 40 insertions(+), 12 deletions(-)
2f34eda87eaea7b65aa5ad091cafa4c5d0f1853e

 core/src/main/scala/kafka/Kafka.scala              |  5 --
 .../kafka/producer/async/DefaultEventHandler.scala |  4 +-
 .../main/scala/kafka/utils/Log4jController.scala   | 98 ++++++++++++++++++++++
 core/src/main/scala/kafka/utils/Logging.scala      |  7 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  2 +-
 5 files changed, 106 insertions(+), 10 deletions(-)
749665e33672b0e96869af787d8a4c78fa681732

 core/src/main/scala/kafka/Kafka.scala              |  5 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  2 +-
 .../main/scala/kafka/utils/Log4jController.scala   | 98 ++++++++++++++++++++++
 core/src/main/scala/kafka/utils/Logging.scala      |  5 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  4 +-
 5 files changed, 106 insertions(+), 8 deletions(-)
31b9d124d609b1494cd6f79cdc2a022c7fae8a4f

 core/src/main/scala/kafka/cluster/Partition.scala                 | 6 +++++-
 core/src/main/scala/kafka/server/KafkaApis.scala                  | 2 ++
 core/src/test/scala/unit/kafka/integration/PrimitiveApiTest.scala | 4 ++++
 3 files changed, 11 insertions(+), 1 deletion(-)
2756b424a73785be49a4bcfc2d5dae704e64d2d5

 core/src/main/scala/kafka/log/Log.scala            | 40 ++++++++----
 core/src/main/scala/kafka/log/LogManager.scala     | 25 +++++---
 core/src/main/scala/kafka/server/KafkaConfig.scala | 30 ++++++---
 core/src/main/scala/kafka/server/KafkaServer.scala |  1 +
 core/src/main/scala/kafka/utils/Utils.scala        | 20 +++++-
 .../scala/other/kafka/TestLogPerformance.scala     |  2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 15 ++---
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 71 +++++++++++++++++++---
 8 files changed, 158 insertions(+), 46 deletions(-)
17283a377dc9b2026b3eecdf1d9a32908b3bfc90

 core/src/main/scala/kafka/api/OffsetResponse.scala |  11 ++
 .../src/main/scala/kafka/api/ProducerRequest.scala |   2 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |  15 +-
 .../main/scala/kafka/api/StopReplicaResponse.scala |   2 +-
 .../kafka/controller/ControllerBasicTest.scala     | 104 -----------
 .../kafka/network/RpcDataSerializationTest.scala   | 206 +++++++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  42 -----
 7 files changed, 233 insertions(+), 149 deletions(-)
93e9dbd0268ae04790c75bdd1fb5c521ae331ee0

 core/src/main/scala/kafka/cluster/Partition.scala  | 109 +++++++++++----------
 .../main/scala/kafka/server/ReplicaManager.scala   |   4 +-
 2 files changed, 58 insertions(+), 55 deletions(-)
21326cb9f29c3514b9533a741b69b90ef6d45038

 core/src/main/scala/kafka/log/Log.scala            | 41 ++++++++----
 core/src/main/scala/kafka/log/LogManager.scala     | 32 ++++++----
 core/src/main/scala/kafka/server/KafkaConfig.scala | 26 +++++---
 core/src/main/scala/kafka/server/KafkaServer.scala |  1 +
 core/src/main/scala/kafka/utils/Utils.scala        | 22 ++++++-
 .../scala/other/kafka/TestLogPerformance.scala     |  4 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 17 ++---
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 72 +++++++++++++++++++---
 8 files changed, 162 insertions(+), 53 deletions(-)
9a84e408c1dff1f32ea030190987501701a1903f

 core/src/main/scala/kafka/log/Log.scala            |  4 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  4 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  5 ++-
 .../scala/other/kafka/TestLogPerformance.scala     |  5 ++-
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 50 ++++++++++++++++++----
 5 files changed, 54 insertions(+), 14 deletions(-)
0d6a4dff097d5e46d659db7f7ef922c91ede24e0

 .../src/main/scala/kafka/consumer/TopicCount.scala |  9 +---
 core/src/main/scala/kafka/utils/Utils.scala        | 21 ++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 59 +++-------------------
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  4 +-
 4 files changed, 32 insertions(+), 61 deletions(-)
5861046d09e82b2bd187177c227bdd1be792d60b

 config/log4j.properties                            |   2 +
 system_test/README.txt                             |  80 +++
 system_test/__init__.py                            |   1 +
 system_test/cluster_config.json                    |  52 ++
 system_test/replication_testsuite/__init__.py      |   1 +
 .../config/console_consumer.properties             |   4 +
 .../config/consumer.properties                     |  29 +
 .../replication_testsuite/config/log4j.properties  |  38 ++
 .../config/producer.properties                     |  80 +++
 .../config/producer_performance.properties         |   7 +
 .../replication_testsuite/config/server.properties | 120 ++++
 .../config/zookeeper.properties                    |  20 +
 .../replication_testsuite/replica_basic_test.py    | 256 ++++++++
 .../testcase_1/testcase_1_properties.json          |  63 ++
 system_test/system_test_env.py                     |  56 ++
 system_test/system_test_runner.py                  | 164 +++++
 system_test/utils/__init__.py                      |   1 +
 system_test/utils/kafka_system_test_utils.py       | 681 +++++++++++++++++++++
 system_test/utils/setup_utils.py                   |  27 +
 system_test/utils/system_test_utils.py             | 326 ++++++++++
 system_test/utils/testcase_env.py                  |  65 ++
 21 files changed, 2073 insertions(+)
663d25443359763b2d0fb8adcbdd96cc82dcbda7

 .../src/main/java/kafka/etl/KafkaETLContext.java   |   2 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   2 +-
 .../main/scala/kafka/admin/ListTopicCommand.scala  |   2 +-
 .../scala/kafka/api/LeaderAndISRResponse.scala     |   2 +-
 core/src/main/scala/kafka/cluster/Partition.scala  | 307 ++++++++++++-----
 core/src/main/scala/kafka/cluster/Replica.scala    |  97 +++---
 .../src/main/scala/kafka/common/ErrorMapping.scala |  12 +-
 .../kafka/common/InvalidPartitionException.scala   |  24 --
 .../common/UnknownTopicOrPartitionException.scala  |  24 ++
 core/src/main/scala/kafka/log/LogManager.scala     |   4 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  12 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  11 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 183 +++-------
 core/src/main/scala/kafka/server/KafkaServer.scala |  34 +-
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  26 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  12 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 380 ++++++++-------------
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   2 +-
 .../scala/unit/kafka/consumer/TopicCountTest.scala |  49 ---
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  26 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  10 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |  15 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   8 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |   4 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |   8 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  28 +-
 .../server/HighwatermarkPersistenceTest.scala      |  93 +++--
 .../unit/kafka/server/ISRExpirationTest.scala      | 133 ++------
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  35 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  13 +
 .../single_host_multi_brokers/bin/run-test.sh      |   2 +-
 31 files changed, 632 insertions(+), 928 deletions(-)
7baccc6c331467335954d32558c68511223d8c7c

 core/src/main/scala/kafka/message/Message.scala    |  36 +++-------
 .../MagicByte0-0/00000000000000000000.kafka        | Bin 10900 -> 0 bytes
 .../integration/BackwardsCompatibilityTest.scala   |  73 ---------------------
 3 files changed, 9 insertions(+), 100 deletions(-)
27aaebc874d0b0c0fc9380ed71dca56e1a12e9f1

 .../kafka/consumer/ConsumerFetcherManager.scala    |  68 ++++------
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 core/src/main/scala/kafka/log/Log.scala            |   2 +-
 core/src/main/scala/kafka/log/LogManager.scala     |   2 +-
 .../main/scala/kafka/network/SocketServer.scala    |   2 +-
 .../kafka/server/AbstractFetcherManager.scala      |   6 +-
 .../scala/kafka/server/AbstractFetcherThread.scala | 148 +++++++++------------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  23 ++--
 .../main/scala/kafka/server/KafkaController.scala  |  55 +++-----
 .../scala/kafka/server/KafkaRequestHandler.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   2 +-
 .../main/scala/kafka/server/RequestPurgatory.scala |   2 +-
 .../scala/kafka/utils/ShutdownableThread.scala     |  60 +++++++++
 13 files changed, 190 insertions(+), 186 deletions(-)
be521175dcf383ad97bc4cbcc642f25666dc0336

 .../src/test/scala/unit/kafka/integration/LazyInitProducerTest.scala | 5 -----
 1 file changed, 5 deletions(-)
12a3ccafa1cbc333539b98d83d7d6d572700f05b

 .../consumer/ZookeeperConsumerConnector.scala      |  2 +-
 .../main/scala/kafka/server/KafkaController.scala  | 46 ++++++++++++----------
 core/src/main/scala/kafka/server/KafkaServer.scala |  4 +-
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  2 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  2 +-
 .../server/HighwatermarkPersistenceTest.scala      |  4 +-
 6 files changed, 32 insertions(+), 28 deletions(-)
60735b7ad6ef15f25ae9e432c2fc566bec535e31

 core/src/main/scala/kafka/server/KafkaConfig.scala |  4 +-
 core/src/main/scala/kafka/utils/Utils.scala        | 86 +++++++++-------------
 .../unit/kafka/producer/AsyncProducerTest.scala    |  2 +-
 3 files changed, 39 insertions(+), 53 deletions(-)
190bd3ff71d85b8e3831e1dbedcce3098f50960f

 core/src/main/scala/kafka/Kafka.scala              |   9 +
 core/src/main/scala/kafka/api/FetchResponse.scala  |   1 -
 .../kafka/metrics/KafkaCSVMetricsReporter.scala    |  85 +++++
 .../scala/kafka/metrics/KafkaMetricsConfig.scala   |  38 +++
 .../scala/kafka/metrics/KafkaMetricsGroup.scala    |  77 +++++
 .../scala/kafka/metrics/KafkaMetricsReporter.scala |  47 +++
 core/src/main/scala/kafka/metrics/KafkaTimer.scala |  40 +++
 core/src/main/scala/kafka/server/KafkaApis.scala   | 376 ++++++++++++++++-----
 core/src/main/scala/kafka/server/KafkaConfig.scala |   3 +-
 .../main/scala/kafka/server/RequestPurgatory.scala | 129 ++++---
 core/src/main/scala/kafka/utils/Pool.scala         |  34 +-
 .../unit/kafka/integration/LogCorruptionTest.scala |   2 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |   2 +
 .../scala/unit/kafka/metrics/KafkaTimerTest.scala  |  60 ++++
 .../unit/kafka/server/RequestPurgatoryTest.scala   |  18 +-
 project/build/KafkaProject.scala                   |  15 +-
 16 files changed, 778 insertions(+), 158 deletions(-)
0fe89f7a493ec8879b31fafa560fd59f5df4a910

 core/src/main/scala/kafka/log/Log.scala            |  4 +-
 .../main/scala/kafka/server/KafkaController.scala  | 78 ++++++++++++----------
 2 files changed, 44 insertions(+), 38 deletions(-)
9eb99fde9a5154e1cb8389a8ee2ceead2b995814

 .../scala/kafka/producer/KafkaLog4jAppender.scala  | 23 +++++++++++++++++++++-
 1 file changed, 22 insertions(+), 1 deletion(-)
623e2b7e53f052e9d2db2ab406867e8029ff8852

 bin/kafka-server-start.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
d48253181007d908e2c2099b912b64179a0ad959

 bin/kafka-simple-consumer-perf-test.sh                | 2 +-
 system_test/producer_perf/bin/run-compression-test.sh | 2 +-
 system_test/producer_perf/bin/run-test.sh             | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)
a8790784df26c7ab13ac82b521812c06fdeb718b

 core/src/main/scala/kafka/server/ReplicaManager.scala | 2 +-
 core/src/main/scala/kafka/utils/Utils.scala           | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)
ee855fe1aa4a4f549c9d91c81ee53f448828d81a

 .../kafka/bridge/hadoop/KafkaOutputFormat.java     |  19 +--
 core/src/main/scala/kafka/api/TopicMetadata.scala  |   2 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  70 ++++----
 .../scala/kafka/producer/ConsoleProducer.scala     |  10 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  22 +--
 core/src/main/scala/kafka/producer/Producer.scala  |   9 +-
 .../main/scala/kafka/producer/ProducerConfig.scala |  33 ++--
 .../main/scala/kafka/producer/ProducerPool.scala   |  69 ++++----
 .../kafka/producer/async/DefaultEventHandler.scala |  15 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  14 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   4 +-
 .../main/scala/kafka/server/KafkaController.scala  |   7 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |   4 -
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |   2 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  14 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  15 ++
 .../scala/other/kafka/TestEndToEndLatency.scala    |  13 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  16 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |   3 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |   2 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   4 +-
 .../integration/ProducerConsumerTestHarness.scala  |   7 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   2 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  14 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    | 185 +++++++--------------
 .../scala/unit/kafka/producer/ProducerTest.scala   | 107 +++++++++---
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |   8 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |   2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  20 ++-
 .../src/main/java/kafka/examples/Producer.java     |   2 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |  16 +-
 .../single_host_multi_brokers/bin/run-test.sh      |   6 +-
 .../config/producer.properties                     |  13 +-
 34 files changed, 344 insertions(+), 389 deletions(-)
b995133387881222cf3947f5b333a623a6d8407b

 core/src/main/scala/kafka/server/KafkaServer.scala    |  2 +-
 core/src/main/scala/kafka/tools/JmxTool.scala         | 13 ++++++++-----
 system_test/single_host_multi_brokers/bin/run-test.sh | 16 ++++++++++------
 3 files changed, 19 insertions(+), 12 deletions(-)
8ceec6eff0769198a454e2163e7597aab6c3e7ab

 .../single_host_multi_brokers/bin/run-test.sh      | 144 ++++++++++++++++++---
 1 file changed, 123 insertions(+), 21 deletions(-)
0223fd827003b94babdf6cb6624d0f97e936d00a

 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 .../main/scala/kafka/api/LeaderAndISRRequest.scala |  38 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  11 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |   4 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  48 +--
 .../kafka/common/BrokerNotExistException.scala     |  22 ++
 .../src/main/scala/kafka/common/ErrorMapping.scala |   8 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |   3 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |   2 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  34 +-
 core/src/main/scala/kafka/log/Log.scala            |  80 ++---
 core/src/main/scala/kafka/log/LogManager.scala     |  38 +-
 .../main/scala/kafka/network/SocketServer.scala    |  11 +-
 .../kafka/server/AbstractFetcherManager.scala      |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 205 ++++++-----
 .../main/scala/kafka/server/KafkaController.scala  | 397 +++++++++++++++++----
 .../scala/kafka/server/KafkaRequestHandler.scala   |  25 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  87 +++--
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 317 ++--------------
 .../scala/kafka/server/ReplicaFetcherManager.scala |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 175 +++++----
 .../main/scala/kafka/server/RequestPurgatory.scala | 128 +++----
 .../scala/kafka/server/StateChangeCommand.scala    |  92 -----
 .../kafka/server/StateChangeCommandHandler.scala   |  79 ----
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   6 +-
 .../main/scala/kafka/tools/ExportZkOffsets.scala   |   2 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |   2 +-
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |   6 +-
 core/src/main/scala/kafka/utils/ZkQueue.scala      | 127 -------
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 345 ++++++++++++------
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  28 +-
 .../kafka/controller/ControllerBasicTest.scala     |  32 +-
 .../controller/ControllerToBrokerRequestTest.scala | 173 ---------
 .../integration/BackwardsCompatibilityTest.scala   |   2 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  33 +-
 .../kafka/integration/LazyInitProducerTest.scala   |   4 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   3 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |   3 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   4 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   2 +-
 .../unit/kafka/network/SocketServerTest.scala      |   7 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  14 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |   6 +-
 .../server/HighwatermarkPersistenceTest.scala      |   8 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     | 100 ++----
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  16 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |   2 +-
 .../unit/kafka/server/RequestPurgatoryTest.scala   |   2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 +-
 .../scala/unit/kafka/server/StateChangeTest.scala  | 124 -------
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 169 +++++----
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |   2 +-
 53 files changed, 1327 insertions(+), 1715 deletions(-)
96ed9af6201e7ce7bc3cf44c5d5153ffbb95f7fd

 core/src/main/scala/kafka/log/Log.scala            | 10 +++----
 core/src/main/scala/kafka/log/LogManager.scala     |  4 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |  2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  2 +-
 .../scala/other/kafka/TestLogPerformance.scala     |  4 +--
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  3 --
 .../kafka/controller/ControllerBasicTest.scala     | 12 ++++----
 .../kafka/integration/LazyInitProducerTest.scala   |  3 --
 .../unit/kafka/integration/LogCorruptionTest.scala |  2 --
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 14 ++++------
 .../integration/ProducerConsumerTestHarness.scala  |  1 +
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  6 +---
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  | 17 ++++++------
 core/src/test/scala/unit/kafka/log/LogTest.scala   | 17 ++++++------
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  8 ------
 .../unit/kafka/producer/AsyncProducerTest.scala    | 32 +++++++++-------------
 .../scala/unit/kafka/producer/ProducerTest.scala   | 10 +------
 .../server/HighwatermarkPersistenceTest.scala      | 24 ++++++----------
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 13 +++++----
 .../unit/kafka/server/ServerShutdownTest.scala     |  3 --
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  5 ++--
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  6 ----
 22 files changed, 73 insertions(+), 125 deletions(-)
c21a7979c18c93336bd1dda5f82627c9ae537b62

 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 .../main/scala/kafka/api/LeaderAndISRRequest.scala |  38 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  11 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |   4 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  48 ++-
 .../kafka/common/BrokerNotExistException.scala     |  22 --
 .../src/main/scala/kafka/common/ErrorMapping.scala |   8 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |   3 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |   2 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  34 +-
 core/src/main/scala/kafka/log/Log.scala            |  85 ++---
 core/src/main/scala/kafka/log/LogManager.scala     |  38 +-
 .../main/scala/kafka/network/SocketServer.scala    |  11 +-
 .../kafka/server/AbstractFetcherManager.scala      |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 205 +++++------
 .../main/scala/kafka/server/KafkaController.scala  | 397 ++++-----------------
 .../scala/kafka/server/KafkaRequestHandler.scala   |  25 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  87 ++---
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 317 ++++++++++++++--
 .../scala/kafka/server/ReplicaFetcherManager.scala |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 175 ++++-----
 .../main/scala/kafka/server/RequestPurgatory.scala | 128 ++++---
 .../scala/kafka/server/StateChangeCommand.scala    |  92 +++++
 .../kafka/server/StateChangeCommandHandler.scala   |  79 ++++
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   6 +-
 .../main/scala/kafka/tools/ExportZkOffsets.scala   |   2 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |   2 +-
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |   6 +-
 core/src/main/scala/kafka/utils/ZkQueue.scala      | 127 +++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 348 +++++++-----------
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  28 +-
 .../kafka/controller/ControllerBasicTest.scala     |  33 +-
 .../controller/ControllerToBrokerRequestTest.scala | 173 +++++++++
 .../integration/BackwardsCompatibilityTest.scala   |   2 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  33 +-
 .../kafka/integration/LazyInitProducerTest.scala   |   4 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   2 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |   3 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   4 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   2 +-
 .../unit/kafka/network/SocketServerTest.scala      |   7 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  14 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  12 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |   6 +-
 .../server/HighwatermarkPersistenceTest.scala      |   6 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     | 102 ++++--
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  16 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |   2 +-
 .../unit/kafka/server/RequestPurgatoryTest.scala   |   2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 +-
 .../scala/unit/kafka/server/StateChangeTest.scala  | 124 +++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 170 ++++-----
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |   2 +-
 54 files changed, 1729 insertions(+), 1334 deletions(-)
2a9d42c243397142f80d3f0f96c8d7a6b74d1b02

 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 +-
 .../main/scala/kafka/api/LeaderAndISRRequest.scala |  38 +-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  11 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |   4 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  48 +--
 .../kafka/common/BrokerNotExistException.scala     |  22 ++
 .../src/main/scala/kafka/common/ErrorMapping.scala |   8 +-
 .../kafka/consumer/ConsumerFetcherManager.scala    |   3 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |   2 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  34 +-
 core/src/main/scala/kafka/log/Log.scala            |  85 +++--
 core/src/main/scala/kafka/log/LogManager.scala     |  38 +-
 .../main/scala/kafka/network/SocketServer.scala    |  11 +-
 .../kafka/server/AbstractFetcherManager.scala      |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 205 ++++++-----
 .../main/scala/kafka/server/KafkaController.scala  | 397 +++++++++++++++++----
 .../scala/kafka/server/KafkaRequestHandler.scala   |  25 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  87 +++--
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 317 ++--------------
 .../scala/kafka/server/ReplicaFetcherManager.scala |   4 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 175 +++++----
 .../main/scala/kafka/server/RequestPurgatory.scala | 128 +++----
 .../scala/kafka/server/StateChangeCommand.scala    |  92 -----
 .../kafka/server/StateChangeCommandHandler.scala   |  79 ----
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  |   6 +-
 .../main/scala/kafka/tools/ExportZkOffsets.scala   |   2 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |   2 +-
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |   6 +-
 core/src/main/scala/kafka/utils/ZkQueue.scala      | 127 -------
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 348 +++++++++++-------
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  28 +-
 .../kafka/controller/ControllerBasicTest.scala     |  33 +-
 .../controller/ControllerToBrokerRequestTest.scala | 173 ---------
 .../integration/BackwardsCompatibilityTest.scala   |   2 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  33 +-
 .../kafka/integration/LazyInitProducerTest.scala   |   4 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   2 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |   3 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   4 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   2 +-
 .../unit/kafka/network/SocketServerTest.scala      |   7 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  14 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  12 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |   6 +-
 .../server/HighwatermarkPersistenceTest.scala      |   6 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |   2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     | 102 ++----
 .../scala/unit/kafka/server/LogRecoveryTest.scala  |  16 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |   2 +-
 .../unit/kafka/server/RequestPurgatoryTest.scala   |   2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 +-
 .../scala/unit/kafka/server/StateChangeTest.scala  | 124 -------
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 170 +++++----
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |   2 +-
 54 files changed, 1334 insertions(+), 1729 deletions(-)
19fbdb30998f6dead6cc788a41617c55bcb20d8e

 core/src/main/scala/kafka/api/FetchRequest.scala   |  2 ++
 core/src/main/scala/kafka/server/KafkaApis.scala   |  8 ++++++--
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  9 ++++++++-
 .../unit/kafka/producer/SyncProducerTest.scala     | 22 ++++++++++++++++++++++
 4 files changed, 38 insertions(+), 3 deletions(-)
86de21a71c1d5bafeff04945088fb3e67ff0b800

 .../scala/kafka/consumer/ConsumerFetcherManager.scala    | 16 ++++++++++------
 1 file changed, 10 insertions(+), 6 deletions(-)
2e073db8dc3ce51c993f2174ab8c9c47716f3e3d

 system_test/single_host_multi_brokers/bin/run-test.sh | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
b49de724f12549354836c34aea6f2e0640994e07

 core/src/main/scala/kafka/cluster/Partition.scala  |   9 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |  33 ++---
 .../consumer/ZookeeperConsumerConnector.scala      |   7 +-
 core/src/main/scala/kafka/log/Log.scala            |  58 +++-----
 core/src/main/scala/kafka/log/LogManager.scala     |  27 ++--
 core/src/main/scala/kafka/log/LogStats.scala       |   2 +-
 .../main/scala/kafka/message/FileMessageSet.scala  |   9 +-
 .../kafka/server/HighwaterMarkCheckpoint.scala     | 125 ++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  26 ++--
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |   2 +-
 .../main/scala/kafka/server/ReplicaManager.scala   | 147 +++++++++++++--------
 .../main/scala/kafka/utils/IteratorTemplate.scala  |   1 -
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  32 +++--
 core/src/main/scala/kafka/utils/Utils.scala        |  28 +++-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  20 +--
 .../scala/unit/kafka/producer/ProducerTest.scala   |  55 ++++----
 .../server/HighwatermarkPersistenceTest.scala      | 146 ++++++++++++++++++++
 .../unit/kafka/server/ISRExpirationTest.scala      |  42 +++---
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 104 +++++----------
 20 files changed, 578 insertions(+), 297 deletions(-)
842da7bfcddb322266ee27bab279c6f4e05b79cb

 .../main/java/kafka/etl/KafkaETLRecordReader.java  |   8 +-
 .../src/main/java/kafka/etl/Props.java             |   4 +-
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     |  10 +-
 core/src/main/scala/kafka/admin/AdminUtils.scala   |  61 ++++-
 .../main/scala/kafka/admin/ListTopicCommand.scala  |   9 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   4 +-
 .../scala/kafka/api/TopicMetaDataResponse.scala    |   2 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  |  25 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |   9 +-
 core/src/main/scala/kafka/cluster/Broker.scala     |   3 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  17 +-
 core/src/main/scala/kafka/cluster/Replica.scala    |  10 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   6 +-
 .../main/scala/kafka/common/KafkaException.scala   |  25 ++
 .../kafka/common/LeaderNotAvailableException.scala |  25 ++
 .../common/NoLeaderForPartitionException.scala     |  25 --
 .../common/ReplicaNotAvailableException.scala      |  25 ++
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  16 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |   3 +-
 .../consumer/ZookeeperConsumerConnector.scala      |   5 +-
 .../consumer/storage/OracleOffsetStorage.scala     |   7 +-
 core/src/main/scala/kafka/log/Log.scala            |  77 +++---
 core/src/main/scala/kafka/log/LogManager.scala     |   5 +-
 core/src/main/scala/kafka/log/LogStats.scala       |   2 +-
 core/src/main/scala/kafka/log/SegmentList.scala    |   5 +-
 .../main/scala/kafka/message/FileMessageSet.scala  |  30 +--
 .../kafka/network/BoundedByteBufferSend.scala      |   2 +-
 .../main/scala/kafka/network/SocketServer.scala    |  10 +-
 .../main/scala/kafka/network/Transmission.scala    |   5 +-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  41 +--
 core/src/main/scala/kafka/producer/Producer.scala  |   3 +-
 .../main/scala/kafka/producer/ProducerConfig.scala |   2 +-
 .../main/scala/kafka/producer/ProducerData.scala   |  10 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |   7 +-
 .../scala/kafka/producer/SyncProducerConfig.scala  |  11 +-
 .../kafka/producer/async/DefaultEventHandler.scala | 178 +++++++------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  81 +++---
 core/src/main/scala/kafka/server/KafkaConfig.scala |   4 +-
 .../main/scala/kafka/server/KafkaController.scala  |  20 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  11 +-
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  22 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  19 +-
 .../main/scala/kafka/server/ReplicaManager.scala   |  31 ++-
 .../scala/kafka/server/StateChangeCommand.scala    |   6 +-
 .../main/scala/kafka/utils/IteratorTemplate.scala  |   3 +
 .../main/scala/kafka/utils/KafkaScheduler.scala    |   1 -
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |   6 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  39 +--
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  21 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  43 ++-
 .../kafka/integration/KafkaServerTestHarness.scala |   3 +-
 .../kafka/integration/LazyInitProducerTest.scala   |   9 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |  40 ++-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  14 +-
 .../scala/unit/kafka/log/SegmentListTest.scala     |   3 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |  17 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |   6 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |   4 +-
 .../unit/kafka/server/ISRExpirationTest.scala      |  16 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  51 ++--
 .../scala/unit/kafka/server/LogRecoveryTest.scala  | 288 +++++++++++++++++++++
 .../unit/kafka/server/ServerShutdownTest.scala     |  16 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  20 +-
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |   3 +-
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |   2 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |   5 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |  35 ++-
 system_test/common/util.sh                         |   2 +-
 .../single_host_multi_brokers/bin/run-test.sh      |  35 +--
 .../config/log4j.properties                        |   3 +
 .../config/server.properties                       |   3 +-
 71 files changed, 1029 insertions(+), 540 deletions(-)
c0e6ca95bffdf6cebc74036bea04695721542ebf

 core/src/main/scala/kafka/producer/Producer.scala | 6 ------
 1 file changed, 6 deletions(-)
16b0f44559de969f1fd4387dceda881e6aabdc1c

 core/src/main/scala/kafka/log/LogManager.scala     | 97 +++++-----------------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  2 +-
 core/src/main/scala/kafka/server/KafkaServer.scala | 12 +--
 .../unit/kafka/integration/TopicMetadataTest.scala |  3 +-
 4 files changed, 27 insertions(+), 87 deletions(-)
9e44db6af0a91a6071a046eb8b94f042ca223ec9

 .../main/scala/kafka/consumer/SimpleConsumer.scala |  7 +++--
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  5 ++--
 .../main/scala/kafka/producer/ProducerPool.scala   |  2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 20 +++++++++----
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 24 ++++++++++------
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  2 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  | 15 ++++++++--
 .../unit/kafka/producer/SyncProducerTest.scala     | 33 ++++++++++++++++++----
 .../unit/kafka/server/ServerShutdownTest.scala     |  1 -
 9 files changed, 80 insertions(+), 29 deletions(-)
0d0f1fcfb3598c6d4b6304bd49e3545dbddf9a4b

 core/src/main/scala/kafka/log/LogManager.scala | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)
89661d3b678974fe5574fb3e6b85f7cd2e5b2c2c

 .../main/scala/kafka/consumer/ConsumerConfig.scala |   3 +
 .../kafka/consumer/ConsumerFetcherManager.scala    | 152 +++++++++++++++++++++
 .../kafka/consumer/ConsumerFetcherThread.scala     |  63 +++++++++
 core/src/main/scala/kafka/consumer/Fetcher.scala   |  95 -------------
 .../scala/kafka/consumer/FetcherRunnable.scala     | 149 --------------------
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |   6 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  49 ++++---
 .../kafka/server/AbstractFetcherManager.scala      |   9 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |  90 ++++++------
 core/src/main/scala/kafka/server/KafkaConfig.scala |   2 +
 .../scala/kafka/server/ReplicaFetcherManager.scala |   7 +-
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   6 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  10 +-
 .../unit/kafka/integration/LogCorruptionTest.scala |   3 -
 14 files changed, 324 insertions(+), 320 deletions(-)
3bade0b5c86c1313f52d4488964d9773344542d9

 .../scala/kafka/consumer/ConsoleConsumer.scala     | 24 +++++++-
 .../scala/kafka/perf/ProducerPerformance.scala     | 66 +++++++++++++++++++---
 system_test/common/util.sh                         |  2 +-
 .../single_host_multi_brokers/bin/run-test.sh      | 59 +++++++++----------
 4 files changed, 113 insertions(+), 38 deletions(-)
d79919d82748429589da9907a560e5a5071a4229

 system_test/broker_failure/README                  |  64 +-
 system_test/broker_failure/bin/run-test.sh         | 956 +++++++++++----------
 system_test/broker_failure/config/log4j.properties |   5 +-
 .../config/mirror_producer1.properties             |   3 +-
 .../config/mirror_producer2.properties             |   3 +-
 .../config/mirror_producer3.properties             |   3 +-
 .../config/server_source1.properties               |   5 -
 .../config/server_source2.properties               |   8 +-
 .../config/server_source3.properties               |   8 +-
 .../config/server_source4.properties               |   8 +-
 .../config/server_target1.properties               |   8 +-
 .../config/server_target2.properties               |   8 +-
 .../config/server_target3.properties               |   8 +-
 13 files changed, 548 insertions(+), 539 deletions(-)
489b09c120992d624fe95ed970b80ec8157131a9

 system_test/broker_failure/README                  |  64 +-
 system_test/broker_failure/bin/run-test.sh         | 900 +++++++++++----------
 system_test/broker_failure/config/log4j.properties |   5 +-
 .../config/mirror_producer1.properties             |   3 +-
 .../config/mirror_producer2.properties             |   3 +-
 .../config/mirror_producer3.properties             |   3 +-
 .../config/server_source1.properties               |   4 +-
 .../config/server_source2.properties               |   2 +-
 .../config/server_source3.properties               |   2 +-
 .../config/server_source4.properties               |   2 +-
 .../config/server_target1.properties               |   2 +-
 .../config/server_target2.properties               |   2 +-
 .../config/server_target3.properties               |   2 +-
 system_test/common/util.sh                         | 168 ++++
 14 files changed, 694 insertions(+), 468 deletions(-)
e7efee02c10e2def27d6b301e2f926202dabb9ce

 core/src/main/scala/kafka/api/FetchRequest.scala   |   1 +
 core/src/main/scala/kafka/api/FetchResponse.scala  |  16 +-
 .../main/scala/kafka/api/LeaderAndISRRequest.scala |  12 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |  28 ++-
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  12 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   2 +
 .../kafka/common/RequestTimedOutException.scala    |  29 +++
 .../consumer/ZookeeperConsumerConnector.scala      |   2 +-
 .../main/scala/kafka/javaapi/ProducerRequest.scala |   4 +-
 core/src/main/scala/kafka/log/Log.scala            |   6 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   7 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |   2 +-
 .../scala/kafka/producer/SyncProducerConfig.scala  |  21 +-
 .../kafka/producer/async/DefaultEventHandler.scala |   6 +-
 .../scala/kafka/server/AbstractFetcherThread.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 268 ++++++++++++++++++---
 core/src/main/scala/kafka/server/KafkaServer.scala |   1 +
 .../scala/kafka/server/ReplicaFetcherThread.scala  |   2 +-
 core/src/main/scala/kafka/utils/DelayedItem.scala  |  22 +-
 core/src/main/scala/kafka/utils/Throttler.scala    |  10 +-
 core/src/main/scala/kafka/utils/Utils.scala        |   4 +-
 .../scala/other/kafka/TestEndToEndLatency.scala    |   6 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   4 +-
 .../scala/other/kafka/TestLogPerformance.scala     |   4 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  45 +++-
 .../unit/kafka/server/RequestPurgatoryTest.scala   |   8 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   8 +-
 27 files changed, 401 insertions(+), 131 deletions(-)
cb5be0aff10423eca34fb43d107c65032b158b93

 core/src/main/scala/kafka/consumer/ConsoleConsumer.scala | 14 +++++++++++++-
 core/src/main/scala/kafka/consumer/ConsumerConfig.scala  |  2 +-
 core/src/main/scala/kafka/consumer/FetcherRunnable.scala |  3 ++-
 core/src/main/scala/kafka/log/Log.scala                  |  2 +-
 4 files changed, 17 insertions(+), 4 deletions(-)
505cf9d618c24f532e7b800d8b34a20a40c45feb

 core/src/main/scala/kafka/cluster/Replica.scala    |  28 ----
 .../src/main/scala/kafka/common/ErrorMapping.scala |   2 +
 core/src/main/scala/kafka/log/Log.scala            |  13 ++
 .../kafka/server/AbstractFetcherManager.scala      |  85 ++++++++++++
 .../scala/kafka/server/AbstractFetcherThread.scala | 149 +++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaConfig.scala |   3 +
 .../scala/kafka/server/ReplicaFetcherManager.scala |  29 ++++
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  90 +++++--------
 .../main/scala/kafka/server/ReplicaManager.scala   |  18 ++-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  57 ++++----
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  15 ++-
 11 files changed, 359 insertions(+), 130 deletions(-)
0efd609fe7ee9b8bbcac1cb7ff681a95aadace4b

 core/src/main/scala/kafka/producer/ProducerPool.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
c2861e129211eaca46c7676b629e4a7750e49350
67164af293a2f67d9634e533d8a29212d9ec9fc4
a16448b71e00c19749cd98d8deb37ad7977a3202

 contrib/hadoop-consumer/lib/pig-0.8.0-core.jar | Bin 2234753 -> 0 bytes
 contrib/hadoop-producer/lib/pig-0.8.0-core.jar | Bin 2234753 -> 0 bytes
 project/build/KafkaProject.scala               |   6 ++++++
 3 files changed, 6 insertions(+)
1af23bb2633c162659ab6fa99020307960f41465

 contrib/hadoop-consumer/lib/pig-0.8.0-core.jar | Bin 2234753 -> 0 bytes
 contrib/hadoop-producer/lib/pig-0.8.0-core.jar | Bin 2234753 -> 0 bytes
 project/build/KafkaProject.scala               |   6 ++++++
 3 files changed, 6 insertions(+)
0ceac63592a342233808f974cc7c77e64abcdfb6

 contrib/hadoop-consumer/lib/pig-0.8.0-core.jar | Bin 2234753 -> 0 bytes
 contrib/hadoop-producer/lib/pig-0.8.0-core.jar | Bin 2234753 -> 0 bytes
 project/build/KafkaProject.scala               |   6 ++++++
 3 files changed, 6 insertions(+)
6cbeab01c261ee0879c03edac6ea7c9822949f8e

 project/build.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
09b0abe1abff7fb73f2b430b83f32cb06166b192

 core/src/main/scala/kafka/consumer/ConsumerIterator.scala   |  1 +
 core/src/main/scala/kafka/consumer/ConsumerTopicStat.scala  | 10 ++++++++++
 core/src/main/scala/kafka/consumer/PartitionTopicInfo.scala |  2 ++
 3 files changed, 13 insertions(+)
1a8511684c9d6e3b8ec073036551b79441aa5280

 core/src/main/scala/kafka/consumer/ConsumerIterator.scala   |  1 +
 core/src/main/scala/kafka/consumer/ConsumerTopicStat.scala  | 10 ++++++++++
 core/src/main/scala/kafka/consumer/PartitionTopicInfo.scala |  2 ++
 3 files changed, 13 insertions(+)
16b600d4fd972be697af95398f22f23aa8ad2608

 core/src/main/scala/kafka/consumer/ConsumerIterator.scala   |  1 +
 core/src/main/scala/kafka/consumer/ConsumerTopicStat.scala  | 10 ++++++++++
 core/src/main/scala/kafka/consumer/PartitionTopicInfo.scala |  2 ++
 3 files changed, 13 insertions(+)
eff68ce1d0ef59e27a49edea4759ad0cd4096b7a

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  64 +++++-----
 .../scala/kafka/admin/CreateTopicCommand.scala     |  29 +++--
 core/src/main/scala/kafka/server/KafkaApis.scala   |   3 +-
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  88 +++++---------
 core/src/main/scala/kafka/utils/Utils.scala        |  15 +++
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 130 ++++++++++-----------
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  91 ++++++++-------
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  28 ++---
 .../scala/unit/kafka/producer/ProducerTest.scala   |  10 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |   3 +-
 10 files changed, 222 insertions(+), 239 deletions(-)
efdc57bc58c2812cc01e627b64eaace9a5f92cb4

 core/src/main/scala/kafka/log/Log.scala            | 37 ++++++++++++++++++----
 .../main/scala/kafka/network/BlockingChannel.scala |  1 +
 core/src/main/scala/kafka/server/KafkaApis.scala   |  8 +++++
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  2 +-
 4 files changed, 40 insertions(+), 8 deletions(-)
8d14d26f5f266c7beb4ba24d9489c6fe1f92c29a
e88171ae886782cccb48f5327f93882d30b8fe79

 NOTICE | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
f8ce071f3fa0efdad555a82aba9e024e3a7f4f56

 NOTICE | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ebcf7fc10d2a6a83545316d6f1526d5084c92b01

 NOTICE | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
965edbbcd8149abe4d9ecd87dcf813fb13874e83

 system_test/common/util.sh                         | 168 ++++++++
 system_test/single_host_multi_brokers/README       |  39 ++
 .../bin/kafka-run-class.sh                         |  67 ++++
 .../single_host_multi_brokers/bin/run-test.sh      | 429 +++++++++++++++++++++
 .../config/consumer.properties                     |  29 ++
 .../config/log4j.properties                        |  38 ++
 .../config/producer.properties                     |  80 ++++
 .../config/server.properties                       | 118 ++++++
 .../config/zookeeper.properties                    |  20 +
 9 files changed, 988 insertions(+)
83c82a3ecc734138ed561a69f18ca3ac02a41ddb

 core/src/main/scala/kafka/cluster/Partition.scala  |   2 +-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   2 +-
 .../main/scala/kafka/network/BlockingChannel.scala |   6 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   7 +
 .../main/scala/kafka/server/KafkaController.scala  | 288 +++++++++++++++++++++
 core/src/main/scala/kafka/server/KafkaServer.scala |  10 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  10 +
 .../kafka/controller/ControllerBasicTest.scala     | 100 +++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  51 +++-
 10 files changed, 471 insertions(+), 7 deletions(-)
326e8dd6b1d74391409579875c95583d4390c260
0d015f938678797e50bad73a261dfac7ba0abb46
7d3a782e50e878f7f4f948b5edbc440297097382

 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
f99177766aff632831598a1e2e2c929a015b7c68

 .../src/main/java/kafka/etl/KafkaETLContext.java   |   2 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   3 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  | 155 +++++++++---------
 .../main/scala/kafka/api/LeaderAndISRRequest.scala | 107 +++++++++++++
 .../scala/kafka/api/LeaderAndISRResponse.scala     |  66 ++++++++
 core/src/main/scala/kafka/api/OffsetRequest.scala  |  75 +++------
 core/src/main/scala/kafka/api/OffsetResponse.scala |  49 ++++++
 .../src/main/scala/kafka/api/ProducerRequest.scala |   3 +-
 .../main/scala/kafka/api/ProducerResponse.scala    |  60 ++-----
 core/src/main/scala/kafka/api/RequestKeys.scala    |   2 +
 .../main/scala/kafka/api/RequestOrResponse.scala   |  28 ++++
 .../main/scala/kafka/api/StopReplicaRequest.scala  |  70 +++++++++
 .../main/scala/kafka/api/StopReplicaResponse.scala |  66 ++++++++
 .../scala/kafka/api/TopicMetaDataResponse.scala    |  53 +++++++
 .../scala/kafka/api/TopicMetadataRequest.scala     |  78 +++-------
 .../src/main/scala/kafka/common/ErrorMapping.scala |  32 ++--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   8 +-
 .../main/scala/kafka/javaapi/ProducerRequest.scala |   4 +-
 .../javaapi/message/ByteBufferMessageSet.scala     |   2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   2 +-
 .../main/scala/kafka/network/BlockingChannel.scala |   9 +-
 .../kafka/network/BoundedByteBufferSend.scala      |  13 +-
 core/src/main/scala/kafka/network/Request.scala    |  28 ----
 .../main/scala/kafka/producer/SyncProducer.scala   |  13 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  59 +++++--
 .../main/scala/kafka/server/MessageSetSend.scala   |   4 +-
 .../controller/ControllerToBrokerRequestTest.scala | 173 +++++++++++++++++++++
 .../unit/kafka/integration/TopicMetadataTest.scala |   7 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   |   4 +-
 .../unit/kafka/producer/AsyncProducerTest.scala    |   8 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   1 -
 31 files changed, 848 insertions(+), 336 deletions(-)
c4a913e3c4a8ce21a08a49ca72f090750aa9e7f0
045f4fdca4f8305a537d0e382f88aed3da0965a7

 .../src/main/java/kafka/etl/KafkaETLContext.java   |   2 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |   5 +-
 core/src/main/scala/kafka/api/FetchResponse.scala  |  21 +-
 core/src/main/scala/kafka/cluster/Partition.scala  | 168 +++++++++++++-
 core/src/main/scala/kafka/cluster/Replica.scala    | 121 +++++++++-
 .../src/main/scala/kafka/common/ErrorMapping.scala |  15 +-
 .../common/NotLeaderForPartitionException.scala    |   8 +-
 .../scala/kafka/common/UnknownTopicException.scala |  25 +++
 core/src/main/scala/kafka/log/Log.scala            | 183 ++++++++++------
 core/src/main/scala/kafka/log/LogManager.scala     |  32 +--
 core/src/main/scala/kafka/log/LogStats.scala       |   2 +-
 core/src/main/scala/kafka/log/SegmentList.scala    |  24 +-
 .../main/scala/kafka/message/FileMessageSet.scala  |  10 +-
 .../main/scala/kafka/network/SocketServer.scala    |   1 +
 .../scala/kafka/producer/BrokerPartitionInfo.scala |   4 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  11 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  88 ++++++--
 core/src/main/scala/kafka/server/KafkaConfig.scala |  21 ++
 .../scala/kafka/server/KafkaRequestHandler.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  36 ++-
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 157 ++++++++++---
 .../scala/kafka/server/ReplicaFetcherThread.scala  |  83 +++++++
 .../main/scala/kafka/server/ReplicaManager.scala   | 243 ++++++++++++++++++---
 .../main/scala/kafka/server/RequestPurgatory.scala |   1 -
 .../main/scala/kafka/utils/KafkaScheduler.scala    |   8 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  11 +-
 core/src/test/resources/log4j.properties           |   2 +-
 .../scala/unit/kafka/consumer/TopicCountTest.scala |   4 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |   8 +-
 .../integration/BackwardsCompatibilityTest.scala   |   3 +
 .../scala/unit/kafka/integration/FetcherTest.scala |   6 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  22 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |   5 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |  27 ---
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  14 +-
 .../scala/unit/kafka/log/SegmentListTest.scala     |  47 ++++
 .../scala/unit/kafka/producer/ProducerTest.scala   |  99 ++-------
 .../unit/kafka/producer/SyncProducerTest.scala     |   2 +-
 .../unit/kafka/server/ISRExpirationTest.scala      | 184 ++++++++++++++++
 .../unit/kafka/server/LeaderElectionTest.scala     |  22 +-
 .../scala/unit/kafka/server/ReplicaFetchTest.scala |  84 +++++++
 .../unit/kafka/server/RequestPurgatoryTest.scala   |   1 -
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   8 +-
 43 files changed, 1452 insertions(+), 370 deletions(-)
822963bb9dab9c948ecf850ab25b311e9d9fa7ae

 clients/cpp/src/encoder.hpp                        |   2 +-
 .../src/main/java/kafka/etl/KafkaETLContext.java   |  24 +-
 .../main/java/kafka/etl/KafkaETLInputFormat.java   |   5 +-
 .../src/main/java/kafka/etl/KafkaETLJob.java       |   2 +-
 .../src/main/java/kafka/etl/KafkaETLKey.java       |   2 +-
 .../src/main/java/kafka/etl/KafkaETLUtils.java     |   2 +-
 .../main/java/kafka/etl/impl/DataGenerator.java    |  24 +-
 contrib/hadoop-producer/README.md                  |  35 +-
 .../java/kafka/bridge/examples/TextPublisher.java  |   5 +-
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     | 105 +++--
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |  28 +-
 .../java/kafka/bridge/pig/AvroKafkaStorage.java    |   9 +-
 core/src/main/scala/kafka/Kafka.scala              |  15 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  66 +--
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  23 +-
 .../scala/kafka/consumer/ConsumerConnector.scala   |  22 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |  31 +-
 core/src/main/scala/kafka/consumer/Fetcher.scala   |  12 +-
 .../scala/kafka/consumer/KafkaMessageStream.scala  |  49 ---
 .../main/scala/kafka/consumer/KafkaStream.scala    |  47 +++
 .../src/main/scala/kafka/consumer/TopicCount.scala | 148 +++++--
 .../main/scala/kafka/consumer/TopicFilter.scala    |  76 ++++
 .../consumer/ZookeeperConsumerConnector.scala      | 447 ++++++++++++++-------
 .../consumer/ZookeeperTopicEventWatcher.scala      |  14 +-
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  65 +--
 .../consumer/ZookeeperConsumerConnector.scala      |  20 +-
 .../scala/kafka/javaapi/message/MessageSet.scala   |   2 +
 core/src/main/scala/kafka/log/Log.scala            |  38 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |  97 +++--
 .../scala/kafka/message/CompressionUtils.scala     |   2 +-
 .../kafka/message/InvalidMessageException.scala    |   4 +-
 .../scala/kafka/message/MessageAndMetadata.scala   |  21 +
 .../scala/kafka/message/MessageAndOffset.scala     |   9 +-
 .../scala/kafka/producer/ConsoleProducer.scala     |  10 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |   6 -
 .../main/scala/kafka/producer/ProducerConfig.scala |  14 +
 .../main/scala/kafka/producer/SyncProducer.scala   |  24 +-
 .../scala/kafka/producer/SyncProducerConfig.scala  |   3 +
 .../kafka/producer/async/ProducerSendThread.scala  |   7 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   2 +-
 .../scala/kafka/server/KafkaRequestHandler.scala   |  59 ++-
 .../scala/kafka/server/KafkaServerStartable.scala  | 170 +-------
 .../src/main/scala/kafka/tools/ConsumerShell.scala |   6 +-
 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 123 ++++++
 .../main/scala/kafka/tools/ImportZkOffsets.scala   | 112 ++++++
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 171 ++++++++
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   8 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |   8 +-
 core/src/main/scala/kafka/utils/Logging.scala      |  43 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  72 +++-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  12 +-
 .../scala/other/kafka/TestEndToEndLatency.scala    |   2 -
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |   6 +-
 .../scala/unit/kafka/consumer/TopicCountTest.scala |   4 +-
 .../unit/kafka/consumer/TopicFilterTest.scala      |  51 +++
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   6 +-
 .../integration/BackwardsCompatibilityTest.scala   |   4 -
 .../scala/unit/kafka/integration/FetcherTest.scala |   2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   9 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  14 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   5 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |   6 +-
 .../kafka/message/ByteBufferMessageSetTest.scala   |  18 +
 .../unit/kafka/network/SocketServerTest.scala      |   2 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  24 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   1 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  17 +-
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |  23 +-
 .../src/main/java/kafka/examples/Consumer.java     |  17 +-
 .../src/main/java/kafka/examples/ExampleUtils.java |   2 +-
 .../src/main/java/kafka/examples/Producer.java     |   3 +-
 .../java/kafka/examples/SimpleConsumerDemo.java    |   7 +-
 .../scala/kafka/perf/ConsumerPerformance.scala     |  11 +-
 perf/src/main/scala/kafka/perf/PerfConfig.scala    |   2 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |  15 +-
 system_test/broker_failure/bin/run-test.sh         | 203 +++++++---
 system_test/broker_failure/config/log4j.properties |  72 +++-
 .../config/mirror_producer1.properties             |   2 +-
 .../config/mirror_producer2.properties             |   2 +-
 .../config/mirror_producer3.properties             |   2 +-
 .../config/server_source1.properties               |   2 +-
 .../config/server_source2.properties               |   2 +-
 .../config/server_source3.properties               |   2 +-
 .../config/server_source4.properties               |   2 +-
 .../config/server_target1.properties               |   2 +-
 .../config/server_target2.properties               |   2 +-
 .../config/server_target3.properties               |   2 +-
 .../config/whitelisttest.consumer.properties       |   4 +-
 system_test/embedded_consumer/README               |  27 --
 system_test/embedded_consumer/bin/expected.out     |  18 -
 system_test/embedded_consumer/bin/run-test.sh      | 328 ---------------
 .../config/blacklisttest.consumer.properties       |  29 --
 .../embedded_consumer/config/consumer.properties   |  14 -
 .../config/mirror_producer.properties              |  27 --
 .../config/server_source1.properties               |  76 ----
 .../config/server_source2.properties               |  76 ----
 .../config/server_source3.properties               |  76 ----
 .../config/server_target1.properties               |  78 ----
 .../config/server_target2.properties               |  78 ----
 .../config/whitelisttest.consumer.properties       |  29 --
 .../config/zookeeper_source.properties             |  18 -
 .../config/zookeeper_target.properties             |  18 -
 system_test/embedded_consumer/expected.out         |  11 -
 system_test/mirror_maker/README                    |  22 +
 system_test/mirror_maker/bin/expected.out          |  18 +
 system_test/mirror_maker/bin/run-test.sh           | 357 ++++++++++++++++
 .../config/blacklisttest.consumer.properties       |  28 ++
 .../mirror_maker/config/mirror_producer.properties |  30 ++
 .../config/server_source_1_1.properties            |  76 ++++
 .../config/server_source_1_2.properties            |  76 ++++
 .../config/server_source_2_1.properties            |  76 ++++
 .../config/server_source_2_2.properties            |  76 ++++
 .../config/server_target_1_1.properties            |  78 ++++
 .../config/server_target_1_2.properties            |  78 ++++
 .../config/whitelisttest_1.consumer.properties     |  28 ++
 .../config/whitelisttest_2.consumer.properties     |  28 ++
 .../config/zookeeper_source_1.properties           |  18 +
 .../config/zookeeper_source_2.properties           |  18 +
 .../config/zookeeper_target.properties             |  18 +
 120 files changed, 3011 insertions(+), 1770 deletions(-)
904708fae892417f248b74130da14a165747abcc

 core/src/main/scala/kafka/api/FetchResponse.scala  |   6 --
 .../src/main/scala/kafka/api/ProducerRequest.scala |   6 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   6 +-
 .../common/NotLeaderForPartitionException.scala    |  25 +++++
 core/src/main/scala/kafka/log/LogManager.scala     |   7 +-
 .../kafka/producer/async/DefaultEventHandler.scala |  59 +++++++-----
 core/src/main/scala/kafka/server/KafkaApis.scala   |  11 +--
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  23 +++--
 .../main/scala/kafka/server/ReplicaManager.scala   |   6 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   7 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  34 +++++--
 .../unit/kafka/producer/AsyncProducerTest.scala    | 107 +++++++++++++++++----
 .../unit/kafka/producer/SyncProducerTest.scala     |  15 +--
 .../unit/kafka/server/RequestPurgatoryTest.scala   |   4 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  21 ++--
 15 files changed, 228 insertions(+), 109 deletions(-)
23b422bc446e351363d19d00397fc1b3c0e269fa

 core/lib/zkclient-20120522.jar   | Bin 0 -> 99193 bytes
 project/build/KafkaProject.scala |  23 +++++++++++++++++++++--
 2 files changed, 21 insertions(+), 2 deletions(-)
2a59ad76c657e4aad8ee6ca67078f49d2f6017c9

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala | 1 +
 1 file changed, 1 insertion(+)
1bedde76c280181fe5114cd262389f599d8542fb

 config/server.properties                           |   8 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   |  30 ++-
 core/src/main/scala/kafka/api/FetchResponse.scala  |   2 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   2 +-
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  16 +-
 .../scala/kafka/consumer/FetcherRunnable.scala     |  42 ++--
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   2 +-
 .../main/scala/kafka/message/FileMessageSet.scala  |   2 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   5 +-
 .../main/scala/kafka/network/SocketServer.scala    |   2 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |   2 +-
 .../kafka/producer/async/DefaultEventHandler.scala |   4 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   | 180 ++++++++++---
 .../scala/kafka/server/KafkaRequestHandler.scala   |  36 +--
 core/src/main/scala/kafka/server/KafkaServer.scala |   4 +-
 .../main/scala/kafka/server/RequestPurgatory.scala | 278 +++++++++++++++++++++
 core/src/main/scala/kafka/utils/DelayedItem.scala  |   2 +-
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  11 +-
 core/src/main/scala/kafka/utils/Utils.scala        |   5 +
 core/src/test/resources/log4j.properties           |   2 +-
 .../scala/other/kafka/TestEndToEndLatency.scala    |  72 ++++++
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  17 +-
 .../kafka/integration/AutoOffsetResetTest.scala    | 190 +++-----------
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   7 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |  34 ++-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   2 +-
 .../unit/kafka/server/RequestPurgatoryTest.scala   |  94 +++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   1 +
 28 files changed, 747 insertions(+), 305 deletions(-)
d6b1de35f6b9cd5370c7812790fea8e61618f461

 .../main/scala/kafka/producer/ProducerConfig.scala | 11 ++++++++++
 .../kafka/producer/async/DefaultEventHandler.scala | 22 ++++++++++++++++---
 .../kafka/producer/async/ProducerSendThread.scala  |  2 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 25 +++++++++++++++-------
 core/src/main/scala/kafka/utils/Utils.scala        | 11 ++++++++++
 .../test/scala/unit/kafka/utils/UtilsTest.scala    | 20 +++++++++++++++++
 system_test/mirror_maker/bin/run-test.sh           |  6 +++---
 .../mirror_maker/config/mirror_producer.properties |  2 ++
 8 files changed, 84 insertions(+), 15 deletions(-)
d73355017a66fbcdf0a6ad1bafbf3d60fa004b92

 bin/run-rat.sh                                     |   0
 core/src/main/scala/kafka/admin/AdminUtils.scala   |   7 +-
 .../common/NoEpochForPartitionException.scala      |  25 ++++
 .../scala/kafka/common/QueueFullException.scala    |  23 ++++
 core/src/main/scala/kafka/producer/Producer.scala  |   3 +-
 .../kafka/producer/async/QueueFullException.scala  |  23 ----
 core/src/main/scala/kafka/server/KafkaConfig.scala |   3 +
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  50 ++++++--
 .../scala/kafka/server/StateChangeCommand.scala    |  92 +++++++++++++++
 .../kafka/server/StateChangeCommandHandler.scala   |  79 +++++++++++++
 core/src/main/scala/kafka/utils/Utils.scala        |  15 +++
 core/src/main/scala/kafka/utils/ZkQueue.scala      | 127 +++++++++++++++++++++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  97 ++++++++++++++--
 .../unit/kafka/producer/AsyncProducerTest.scala    |   8 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  65 ++++++++---
 .../scala/unit/kafka/server/StateChangeTest.scala  | 124 ++++++++++++++++++++
 16 files changed, 675 insertions(+), 66 deletions(-)
d97c557202e7f20001d2597d09bcbf0bfc123fa9

 core/src/main/scala/kafka/server/KafkaServer.scala          |  8 +++++---
 core/src/test/resources/log4j.properties                    |  4 ++--
 core/src/test/scala/unit/kafka/log/LogOffsetTest.scala      |  2 --
 core/src/test/scala/unit/kafka/producer/ProducerTest.scala  | 13 +++++++++++--
 .../test/scala/unit/kafka/server/ServerShutdownTest.scala   |  2 ++
 core/src/test/scala/unit/kafka/zk/EmbeddedZookeeper.scala   |  5 +----
 core/src/test/scala/unit/kafka/zk/ZKLoadBalanceTest.scala   | 10 +++++-----
 .../src/test/scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  6 ++++++
 8 files changed, 32 insertions(+), 18 deletions(-)
79a3b31f267921dedbe8b6ca6af648609bb11dc0

 .../main/scala/kafka/producer/ProducerPool.scala   |  1 +
 core/src/main/scala/kafka/server/KafkaServer.scala | 10 ++++---
 core/src/main/scala/kafka/utils/Utils.scala        |  1 -
 core/src/test/resources/log4j.properties           |  8 ++---
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 14 ++++-----
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 34 ++++++++++++----------
 .../scala/unit/kafka/integration/FetcherTest.scala |  4 +--
 .../unit/kafka/integration/TopicMetadataTest.scala |  8 ++---
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  6 ++--
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  6 ++--
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  | 11 +++----
 .../unit/kafka/producer/AsyncProducerTest.scala    |  6 +---
 .../scala/unit/kafka/producer/ProducerTest.scala   |  8 ++---
 .../unit/kafka/producer/SyncProducerTest.scala     |  2 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  6 +---
 .../unit/kafka/server/ServerShutdownTest.scala     |  6 ++--
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  5 +---
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |  7 ++++-
 18 files changed, 66 insertions(+), 77 deletions(-)
c0e190cdefabc7c59b11bbe0de843baec78efe3f

 .../src/main/java/kafka/etl/KafkaETLContext.java   |  20 +-
 .../main/java/kafka/etl/KafkaETLInputFormat.java   |   5 +-
 .../src/main/java/kafka/etl/KafkaETLJob.java       |   2 +-
 .../src/main/java/kafka/etl/KafkaETLKey.java       |   2 +-
 .../src/main/java/kafka/etl/KafkaETLUtils.java     |   2 +-
 .../main/java/kafka/etl/impl/DataGenerator.java    |  24 +-
 .../java/kafka/bridge/examples/TextPublisher.java  |   5 +-
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     |  16 +-
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |   9 +-
 .../java/kafka/bridge/pig/AvroKafkaStorage.java    |   9 +-
 core/src/main/scala/kafka/Kafka.scala              |  15 +-
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  54 ++--
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  18 --
 .../scala/kafka/consumer/ConsumerConnector.scala   |  22 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |  25 +-
 core/src/main/scala/kafka/consumer/Fetcher.scala   |  12 +-
 .../scala/kafka/consumer/KafkaMessageStream.scala  |  50 ---
 .../main/scala/kafka/consumer/KafkaStream.scala    |  47 +++
 .../src/main/scala/kafka/consumer/TopicCount.scala | 149 +++++++--
 .../main/scala/kafka/consumer/TopicFilter.scala    |  76 +++++
 .../consumer/ZookeeperConsumerConnector.scala      | 299 ++++++++++++-----
 .../consumer/ZookeeperTopicEventWatcher.scala      |  14 +-
 .../kafka/javaapi/consumer/ConsumerConnector.java  |  65 ++--
 .../consumer/ZookeeperConsumerConnector.scala      |  20 +-
 .../scala/kafka/javaapi/message/MessageSet.scala   |   2 +
 .../javaapi/producer/async/CallbackHandler.java    |   2 +-
 .../kafka/javaapi/producer/async/EventHandler.java |   6 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   1 -
 .../scala/kafka/message/MessageAndMetadata.scala   |  21 ++
 .../scala/kafka/message/MessageAndOffset.scala     |   9 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |   2 -
 core/src/main/scala/kafka/producer/Producer.scala  |   2 +-
 .../scala/kafka/server/KafkaServerStartable.scala  | 170 +---------
 .../src/main/scala/kafka/tools/ConsumerShell.scala |   6 +-
 core/src/main/scala/kafka/tools/MirrorMaker.scala  | 162 ++++++++++
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   8 +-
 core/src/main/scala/kafka/utils/Logging.scala      |  40 +--
 core/src/main/scala/kafka/utils/Utils.scala        |  13 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  12 +-
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |   6 +-
 .../scala/unit/kafka/consumer/TopicCountTest.scala |  49 ---
 .../unit/kafka/consumer/TopicFilterTest.scala      |  51 +++
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   6 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |   2 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   7 +-
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |   3 +-
 .../src/main/java/kafka/examples/Consumer.java     |  17 +-
 .../src/main/java/kafka/examples/ExampleUtils.java |   2 +-
 .../src/main/java/kafka/examples/Producer.java     |   3 +-
 .../java/kafka/examples/SimpleConsumerDemo.java    |   7 +-
 .../scala/kafka/perf/ConsumerPerformance.scala     |  11 +-
 perf/src/main/scala/kafka/perf/PerfConfig.scala    |   2 +-
 .../kafka/perf/SimpleConsumerPerformance.scala     |   2 -
 system_test/embedded_consumer/README               |  27 --
 system_test/embedded_consumer/bin/expected.out     |  18 --
 system_test/embedded_consumer/bin/run-test.sh      | 328 -------------------
 .../config/blacklisttest.consumer.properties       |  29 --
 .../embedded_consumer/config/consumer.properties   |  14 -
 .../config/mirror_producer.properties              |  27 --
 .../config/server_source1.properties               |  76 -----
 .../config/server_source2.properties               |  76 -----
 .../config/server_source3.properties               |  76 -----
 .../config/server_target1.properties               |  78 -----
 .../config/server_target2.properties               |  78 -----
 .../config/whitelisttest.consumer.properties       |  29 --
 .../config/zookeeper_source.properties             |  18 --
 .../config/zookeeper_target.properties             |  18 --
 system_test/embedded_consumer/expected.out         |  11 -
 system_test/mirror_maker/README                    |  22 ++
 system_test/mirror_maker/bin/expected.out          |  18 ++
 system_test/mirror_maker/bin/run-test.sh           | 357 +++++++++++++++++++++
 .../config/blacklisttest.consumer.properties       |  28 ++
 .../mirror_maker/config/mirror_producer.properties |  28 ++
 .../config/server_source_1_1.properties            |  76 +++++
 .../config/server_source_1_2.properties            |  76 +++++
 .../config/server_source_2_1.properties            |  76 +++++
 .../config/server_source_2_2.properties            |  76 +++++
 .../config/server_target_1_1.properties            |  78 +++++
 .../config/server_target_1_2.properties            |  78 +++++
 .../config/whitelisttest_1.consumer.properties     |  28 ++
 .../config/whitelisttest_2.consumer.properties     |  28 ++
 .../config/zookeeper_source_1.properties           |  18 ++
 .../config/zookeeper_source_2.properties           |  18 ++
 .../config/zookeeper_target.properties             |  18 ++
 84 files changed, 1992 insertions(+), 1518 deletions(-)
d9441f0066604534a8226ce1809eaf68e5a4ada2

 .../src/main/scala/kafka/consumer/ConsumerConfig.scala |  7 +++++++
 .../main/scala/kafka/consumer/ConsumerIterator.scala   |  6 ++++--
 .../main/scala/kafka/consumer/KafkaMessageStream.scala |  5 +++--
 .../kafka/consumer/ZookeeperConsumerConnector.scala    |  2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala     | 12 +++++++-----
 .../unit/kafka/message/ByteBufferMessageSetTest.scala  | 18 ++++++++++++++++++
 6 files changed, 40 insertions(+), 10 deletions(-)
f8346239d492b22416d9c5d4639ebd5eafdbae92

 .../kafka/producer/async/ProducerSendThread.scala     | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)
a260bfacaee251b4f23236a71651cfb87ce3f6d7

 .../main/scala/kafka/consumer/SimpleConsumer.scala | 129 +++++-------
 .../main/scala/kafka/network/BlockingChannel.scala |  93 +++++++++
 .../main/scala/kafka/network/Transmission.scala    |   7 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |  53 ++---
 .../kafka/producer/async/DefaultEventHandler.scala |  20 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  14 --
 .../scala/unit/kafka/producer/ProducerTest.scala   | 223 +++++++++++----------
 .../unit/kafka/producer/SyncProducerTest.scala     |  36 +++-
 8 files changed, 338 insertions(+), 237 deletions(-)
fedb9d6c19903651e5b27412374aad84994f1320

 core/src/main/scala/kafka/log/LogManager.scala     | 49 +----------------
 core/src/main/scala/kafka/server/KafkaApis.scala   |  9 +--
 core/src/main/scala/kafka/server/KafkaServer.scala | 22 ++++++--
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 37 ++++++++-----
 .../main/scala/kafka/server/ReplicaManager.scala   | 64 ++++++++++++++++++++++
 core/src/test/resources/log4j.properties           |  6 +-
 .../unit/kafka/integration/TopicMetadataTest.scala |  9 ++-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  5 +-
 .../unit/kafka/server/LeaderElectionTest.scala     |  2 +-
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  3 +-
 10 files changed, 126 insertions(+), 80 deletions(-)
ba8fd9f1ee9fc47a1e62ee6f529f7cb272b3c7f3

 core/src/main/scala/kafka/message/ByteBufferMessageSet.scala | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
2bcc91134316a546322bf59a422bec1934613607

 core/src/main/scala/kafka/log/Log.scala                  | 16 +++++++++++++---
 .../main/scala/kafka/message/ByteBufferMessageSet.scala  |  3 +--
 2 files changed, 14 insertions(+), 5 deletions(-)
854fb29c26ed55926956e858b0465b85f80ef738

 core/src/main/scala/kafka/admin/AdminUtils.scala   |   4 -
 core/src/main/scala/kafka/cluster/Partition.scala  |  20 +--
 core/src/main/scala/kafka/cluster/Replica.scala    |  23 +++
 .../scala/kafka/consumer/FetcherRunnable.scala     |  18 +-
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |   5 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  24 ++-
 .../main/scala/kafka/javaapi/ProducerRequest.scala |   1 -
 core/src/main/scala/kafka/log/Log.scala            |   4 +-
 core/src/main/scala/kafka/log/LogManager.scala     |  55 +++++-
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  45 ++---
 .../kafka/producer/async/DefaultEventHandler.scala | 114 +++++++------
 .../kafka/producer/async/ProducerSendThread.scala  |   6 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |   4 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  11 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  11 +-
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 190 ++++++++++++++++++++-
 core/src/main/scala/kafka/utils/Utils.scala        |  16 ++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  69 ++++++--
 core/src/test/resources/log4j.properties           |   6 +-
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   2 -
 .../scala/unit/kafka/consumer/TopicCountTest.scala |   4 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  35 +++-
 .../scala/unit/kafka/integration/FetcherTest.scala |   6 +-
 .../kafka/integration/LazyInitProducerTest.scala   |   3 +-
 .../integration/ProducerConsumerTestHarness.scala  |   2 +
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  12 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  31 +---
 .../scala/unit/kafka/producer/ProducerTest.scala   |  56 +++++-
 .../unit/kafka/server/LeaderElectionTest.scala     |  98 +++++++++++
 .../unit/kafka/server/ServerShutdownTest.scala     |   6 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  33 +++-
 31 files changed, 712 insertions(+), 202 deletions(-)
e180e68f94d1d50fb9563d273c03d255eb081998

 core/src/main/scala/kafka/producer/KafkaLog4jAppender.scala | 4 ----
 1 file changed, 4 deletions(-)
7b39d7eed1449d993cdec6dca6babea6032dbbc3

 core/src/main/scala/kafka/producer/ConsoleProducer.scala | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)
7b642040b49f0c6978d77f00b0b5e2f7482d0bc4

 go/src/consumer.go              | 21 ++++++++++-----------
 go/src/kafka.go                 | 20 ++++++++++----------
 go/src/message.go               |  4 ++--
 go/src/payload_codec.go         |  4 +++-
 go/src/publisher.go             |  8 ++++++--
 go/src/request.go               |  2 +-
 go/src/timing.go                |  6 +++---
 go/tools/consumer/consumer.go   | 23 ++++++++---------------
 go/tools/offsets/offsets.go     |  6 ++++--
 go/tools/publisher/publisher.go |  4 ++--
 10 files changed, 49 insertions(+), 49 deletions(-)
5e0e0b17fb5a9549fc9860c91384121def8ae695

 clients/go/src/consumer.go              | 21 ++++++++++-----------
 clients/go/src/kafka.go                 | 20 ++++++++++----------
 clients/go/src/message.go               |  4 ++--
 clients/go/src/payload_codec.go         |  4 +++-
 clients/go/src/publisher.go             |  8 ++++++--
 clients/go/src/request.go               |  2 +-
 clients/go/src/timing.go                |  6 +++---
 clients/go/tools/consumer/consumer.go   | 23 ++++++++---------------
 clients/go/tools/offsets/offsets.go     |  6 ++++--
 clients/go/tools/publisher/publisher.go |  4 ++--
 10 files changed, 49 insertions(+), 49 deletions(-)
0398178f28a3ad8ca65980470d81b0ebcc01cddc

 go/src/consumer.go              | 21 +++++++++++----------
 go/src/kafka.go                 | 20 ++++++++++----------
 go/src/message.go               |  4 ++--
 go/src/payload_codec.go         |  4 +---
 go/src/publisher.go             |  8 ++------
 go/src/request.go               |  2 +-
 go/src/timing.go                |  6 +++---
 go/tools/consumer/consumer.go   | 23 +++++++++++++++--------
 go/tools/offsets/offsets.go     |  6 ++----
 go/tools/publisher/publisher.go |  4 ++--
 10 files changed, 49 insertions(+), 49 deletions(-)
66d8073156403ce1a8f91b56f27beed93196ae04

 clients/go/src/consumer.go              | 21 +++++++++++----------
 clients/go/src/kafka.go                 | 20 ++++++++++----------
 clients/go/src/message.go               |  4 ++--
 clients/go/src/payload_codec.go         |  4 +---
 clients/go/src/publisher.go             |  8 ++------
 clients/go/src/request.go               |  2 +-
 clients/go/src/timing.go                |  6 +++---
 clients/go/tools/consumer/consumer.go   | 23 +++++++++++++++--------
 clients/go/tools/offsets/offsets.go     |  6 ++----
 clients/go/tools/publisher/publisher.go |  4 ++--
 10 files changed, 49 insertions(+), 49 deletions(-)
4dd7f95569d3af60c73484e7969080ac0d755085

 core/src/main/scala/kafka/api/FetchResponse.scala  |  1 +
 .../src/main/scala/kafka/api/ProducerRequest.scala | 77 +++++++----------
 .../main/scala/kafka/api/ProducerResponse.scala    | 93 ++++++++++++++++-----
 core/src/main/scala/kafka/api/RequestKeys.scala    |  5 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  5 +-
 .../kafka/javaapi/producer/SyncProducer.scala      | 17 ++--
 .../scala/kafka/network/SocketServerStats.scala    |  2 +-
 .../main/scala/kafka/producer/SyncProducer.scala   | 82 ++++++++----------
 .../kafka/producer/async/DefaultEventHandler.scala | 96 +++++++++++-----------
 core/src/main/scala/kafka/server/KafkaApis.scala   | 50 +++++------
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  1 -
 .../unit/kafka/producer/AsyncProducerTest.scala    | 44 +++++-----
 .../scala/unit/kafka/producer/ProducerTest.scala   | 89 +++++++++++---------
 .../unit/kafka/producer/SyncProducerTest.scala     | 93 +++++++++++++++------
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 19 +++--
 15 files changed, 378 insertions(+), 296 deletions(-)
74af0deef17bfed19237367cdbee7027666add08

 core/src/test/scala/unit/kafka/log/LogManagerTest.scala | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)
624a361e01431bf87ccda883fb9b1817d67cdbf7

 core/src/main/scala/kafka/common/ErrorMapping.scala          | 1 -
 core/src/main/scala/kafka/message/ByteBufferMessageSet.scala | 5 +++--
 2 files changed, 3 insertions(+), 3 deletions(-)
88660999a87c5e8214a57439156ed62358af3509

 .../main/scala/kafka/api/ProducerResponse.scala    | 50 ++++++++++++++++++++++
 1 file changed, 50 insertions(+)
0443e2dd737cada1fed3964dd1cb2b687944f9c6

 core/src/main/scala/kafka/log/Log.scala          | 19 +++++++++++++++----
 core/src/test/scala/unit/kafka/log/LogTest.scala |  5 ++++-
 2 files changed, 19 insertions(+), 5 deletions(-)
f8042d5b3932a0114c33cad6388eba9c41d77809

 core/src/main/scala/kafka/api/FetchResponse.scala  |  18 ++++
 .../scala/kafka/api/MultiProducerRequest.scala     |  57 ----------
 .../src/main/scala/kafka/api/ProducerRequest.scala | 118 +++++++++++++++------
 .../main/scala/kafka/javaapi/FetchResponse.scala   |   2 +-
 .../main/scala/kafka/javaapi/ProducerRequest.scala |  29 ++---
 .../javaapi/message/ByteBufferMessageSet.scala     |   2 +-
 .../kafka/javaapi/producer/SyncProducer.scala      |  24 ++---
 .../scala/kafka/message/ByteBufferMessageSet.scala |   2 +-
 .../main/scala/kafka/message/FileMessageSet.scala  |   2 +
 core/src/main/scala/kafka/message/MessageSet.scala |   5 +
 .../main/scala/kafka/producer/SyncProducer.scala   |  47 ++------
 .../scala/kafka/producer/SyncProducerConfig.scala  |  19 ++++
 .../kafka/producer/async/DefaultEventHandler.scala |  19 +++-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  56 +++++-----
 .../scala/kafka/server/MultiMessageSetSend.scala   |  36 -------
 core/src/main/scala/kafka/utils/Utils.scala        |  17 ++-
 .../kafka/message/ByteBufferMessageSetTest.scala   |  24 ++---
 .../unit/kafka/producer/AsyncProducerTest.scala    |  14 ++-
 .../unit/kafka/producer/SyncProducerTest.scala     |   8 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  41 +++++++
 20 files changed, 289 insertions(+), 251 deletions(-)
9fd2d4ffdba4b45df7807c1a70ff17496b51afa8

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  11 +-
 .../scala/kafka/admin/CreateTopicCommand.scala     |   9 +-
 core/src/main/scala/kafka/api/TopicMetadata.scala  |   4 +-
 .../scala/kafka/api/TopicMetadataRequest.scala     |  12 +-
 core/src/main/scala/kafka/cluster/Partition.scala  |  35 +-
 .../common/NoLeaderForPartitionException.scala     |  25 ++
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  31 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  49 ++-
 core/src/main/scala/kafka/log/LogManager.scala     |  63 ++--
 .../scala/kafka/producer/BrokerPartitionInfo.scala |  84 +++--
 .../kafka/producer/ConfigBrokerPartitionInfo.scala |  95 -----
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |   2 +-
 core/src/main/scala/kafka/producer/Producer.scala  |  16 +-
 .../main/scala/kafka/producer/ProducerConfig.scala |  10 +-
 .../main/scala/kafka/producer/ProducerPool.scala   |  59 ++-
 .../main/scala/kafka/producer/SyncProducer.scala   |  16 +
 .../kafka/producer/ZKBrokerPartitionInfo.scala     | 376 -------------------
 .../kafka/producer/async/DefaultEventHandler.scala |  60 +--
 core/src/main/scala/kafka/server/KafkaApis.scala   |   1 +
 core/src/main/scala/kafka/server/KafkaServer.scala |   5 +-
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  20 -
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  39 +-
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |  32 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  15 +
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  66 ++--
 .../test/scala/unit/kafka/admin/AdminTest.scala    |   3 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 248 +++++++++---
 .../kafka/integration/AutoOffsetResetTest.scala    |  33 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  10 +-
 .../kafka/integration/LazyInitProducerTest.scala   |  77 ++--
 .../unit/kafka/integration/LogCorruptionTest.scala |   8 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 100 ++---
 .../integration/ProducerConsumerTestHarness.scala  |  18 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  17 +-
 .../javaapi/integration/PrimitiveApiTest.scala     | 415 ---------------------
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  35 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |  22 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  59 +--
 .../unit/kafka/producer/AsyncProducerTest.scala    | 232 ++++++++----
 .../scala/unit/kafka/producer/ProducerTest.scala   | 155 ++++----
 .../unit/kafka/producer/SyncProducerTest.scala     |   2 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |  56 ++-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  43 ++-
 .../scala/unit/kafka/zk/ZKLoadBalanceTest.scala    | 126 -------
 system_test/broker_failure/bin/run-test.sh         |   2 +-
 45 files changed, 1036 insertions(+), 1760 deletions(-)
bd3079b8947e9b77ed6eac7dc77a69c10c522874

 cpp/src/encoder.hpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ccc464c19a80f9818145c70079e9966fed22d75c

 clients/cpp/src/encoder.hpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
6c34cf2dcc5961703001ab484a1ca6e662eee362

 core/src/main/scala/kafka/producer/Producer.scala                 | 4 ----
 core/src/main/scala/kafka/producer/ProducerConfig.scala           | 7 +++++--
 .../src/test/scala/unit/kafka/javaapi/producer/ProducerTest.scala | 4 ++++
 core/src/test/scala/unit/kafka/producer/AsyncProducerTest.scala   | 8 ++++++++
 core/src/test/scala/unit/kafka/producer/ProducerTest.scala        | 4 ++++
 5 files changed, 21 insertions(+), 6 deletions(-)
d8286aad107dbec34faae9e4e29c65bde20eb6f8

 core/src/main/scala/kafka/server/KafkaConfig.scala |  2 +-
 core/src/main/scala/kafka/utils/Utils.scala        | 42 ++++++++++++++++++++++
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  2 +-
 3 files changed, 44 insertions(+), 2 deletions(-)
caf310c2283731751926ccf8bd902df01dcb04f4

 .../consumer/ZookeeperConsumerConnector.scala      | 38 +++++++++++++---------
 1 file changed, 22 insertions(+), 16 deletions(-)
7e91c167430afcffd5b700de58bbc54b2149be00

 .../main/scala/kafka/server/KafkaRequestHandlers.scala   | 16 ++++++++++++++++
 1 file changed, 16 insertions(+)
333966f50ea42ba41ff243d1ba5571a2fa8b9a60

 .../scala/kafka/message/ByteBufferMessageSet.scala | 87 ++++++++++++++--------
 .../main/scala/kafka/producer/SyncProducer.scala   | 10 +--
 .../unit/kafka/producer/SyncProducerTest.scala     | 35 ++++++++-
 3 files changed, 89 insertions(+), 43 deletions(-)
22d80462b15e24fc63960254bdfd8be74ddc14ba

 .../main/scala/kafka/tools/ImportZkOffsets.scala   | 112 +++++++++++++++++++++
 1 file changed, 112 insertions(+)
7066d1c38b66d4de2d02fc1ef2fa8e7908990d07

 .../main/scala/kafka/tools/ExportZkOffsets.scala   | 123 +++++++++++++++++++++
 1 file changed, 123 insertions(+)
95ee38728cb1d8eb9b62a73eb5ad26902142a1fd

 core/src/main/scala/kafka/producer/SyncProducer.scala | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)
a23d396a5a2f5c8685a404ce8478540c13fac6d4

 bin/kafka-producer-perf-test.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ff562472ddf834e092cc2a8124dad59e763017db

 core/src/main/scala/kafka/utils/Logging.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
c28b3a61cce3288d3c0b620d1ef73d936989d3c5

 .../main/scala/kafka/message/ByteBufferMessageSet.scala   |  6 ++++++
 .../scala/kafka/message/InvalidMessageException.scala     |  4 +++-
 core/src/main/scala/kafka/producer/SyncProducer.scala     | 15 ++++++++++-----
 3 files changed, 19 insertions(+), 6 deletions(-)
6e1b2ebe3278c99e1b3ea89a47c60497cb964d44

 .../src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)
2ead8a49ea1c7e634c889e9425fd5eb209e7f1ff

 core/src/main/scala/kafka/consumer/FetcherRunnable.scala | 1 +
 1 file changed, 1 insertion(+)
3e79116e7a7c725cafae1b5248a99837641a4ca2

 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5c4ce616994112a68f8864520c4a2a6c7b545e30

 core/src/main/scala/kafka/log/Log.scala            |  3 ++
 .../scala/kafka/server/KafkaRequestHandlers.scala  | 56 ++++++++++++++++++++--
 2 files changed, 56 insertions(+), 3 deletions(-)
6e36047fae3338b425a63c0d1e4a5acb499e5207

 core/src/main/scala/kafka/api/FetchRequest.scala   | 27 +++++++++++++++++++---
 core/src/main/scala/kafka/api/FetchResponse.scala  |  2 ++
 .../src/main/scala/kafka/common/ErrorMapping.scala |  4 +++-
 .../kafka/common/FetchRequestFormatException.scala | 21 +++++++++++++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   | 19 ++++++++++-----
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 25 ++++++++++++++++----
 6 files changed, 84 insertions(+), 14 deletions(-)
0bd3b9c3f6df76043afbdce817d33d7531f1eecd

 core/src/main/scala/kafka/producer/SyncProducer.scala       | 6 +++++-
 core/src/main/scala/kafka/producer/SyncProducerConfig.scala | 3 +++
 2 files changed, 8 insertions(+), 1 deletion(-)
732c27ff3e8bc6d5a9511ee64de275df49adf73f

 .../consumer/ZookeeperConsumerConnector.scala      | 36 ++++++++++++++++++++--
 1 file changed, 33 insertions(+), 3 deletions(-)
a5fb217293e5124ef7f47e0d45c7400bd9286077

 .../src/main/java/kafka/etl/KafkaETLContext.java   |  38 +--
 .../src/main/java/kafka/etl/KafkaETLRequest.java   |  11 +-
 core/src/main/scala/kafka/api/FetchRequest.scala   | 155 ++++++++--
 core/src/main/scala/kafka/api/FetchResponse.scala  | 199 ++++++++++++
 .../main/scala/kafka/api/MultiFetchRequest.scala   |  58 ----
 .../main/scala/kafka/api/MultiFetchResponse.scala  |  52 ----
 core/src/main/scala/kafka/api/RequestKeys.scala    |   7 +-
 .../main/scala/kafka/consumer/ConsumerConfig.scala |   3 +-
 .../scala/kafka/consumer/FetcherRunnable.scala     |  40 ++-
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  47 +--
 .../src/main/scala/kafka/consumer/TopicCount.scala |   6 +-
 .../consumer/ZookeeperConsumerConnector.scala      |  39 +--
 .../main/scala/kafka/javaapi/FetchResponse.scala   |  33 ++
 core/src/main/scala/kafka/javaapi/Implicits.scala  |   7 +-
 .../scala/kafka/javaapi/MultiFetchResponse.scala   |  45 ---
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |  19 +-
 .../kafka/network/BoundedByteBufferReceive.scala   |   8 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   4 +-
 .../scala/kafka/network/SocketServerStats.scala    |   2 +-
 .../main/scala/kafka/network/Transmission.scala    |  15 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  80 ++---
 .../scala/kafka/server/KafkaRequestHandler.scala   |   6 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |  41 ++-
 .../integration/BackwardsCompatibilityTest.scala   |  19 +-
 .../kafka/integration/LazyInitProducerTest.scala   |  89 +++---
 .../unit/kafka/integration/LogCorruptionTest.scala |  27 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  | 203 ++++++++-----
 .../javaapi/integration/PrimitiveApiTest.scala     | 334 ++++++++++-----------
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |  13 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  32 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  55 ++--
 .../unit/kafka/server/ServerShutdownTest.scala     |  24 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  18 +-
 .../scala/unit/kafka/zk/ZKLoadBalanceTest.scala    |   2 +-
 .../main/java/kafka/examples/KafkaProperties.java  |   1 +
 .../java/kafka/examples/SimpleConsumerDemo.java    |  75 ++---
 .../kafka/perf/SimpleConsumerPerformance.scala     |  33 +-
 37 files changed, 1037 insertions(+), 803 deletions(-)
6a3c2f2032c5e910f634a29bfead555b63433465

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a888a9d09e4fc219ab9d8536034ac043093f17df

 .../consumer/ZookeeperConsumerConnector.scala      | 83 +++++-----------------
 .../scala/kafka/message/CompressionUtils.scala     |  2 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  6 +-
 .../kafka/tools/VerifyConsumerRebalance.scala      |  8 +--
 .../test/scala/other/kafka/TestKafkaAppender.scala |  2 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |  2 -
 .../scala/other/kafka/TestLogPerformance.scala     |  1 -
 .../integration/BackwardsCompatibilityTest.scala   |  3 +-
 .../kafka/integration/KafkaServerTestHarness.scala |  5 --
 .../javaapi/message/BaseMessageSetTestCases.scala  |  1 -
 .../javaapi/message/ByteBufferMessageSetTest.scala |  1 -
 .../unit/kafka/javaapi/producer/ProducerTest.scala |  3 +-
 .../kafka/javaapi/producer/SyncProducerTest.scala  |  4 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |  3 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  3 +-
 .../kafka/message/BaseMessageSetTestCases.scala    |  1 -
 .../unit/kafka/message/FileMessageSetTest.scala    |  3 -
 .../scala/unit/kafka/message/MessageTest.scala     |  3 -
 .../unit/kafka/network/SocketServerTest.scala      |  4 --
 .../unit/kafka/producer/AsyncProducerTest.scala    |  2 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  3 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  4 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |  4 +-
 23 files changed, 37 insertions(+), 114 deletions(-)
21da30456f4c23aae1f40b3446f74565d5b6d917

 .../common/FailedToSendMessageException.scala      |  23 +
 core/src/main/scala/kafka/javaapi/Implicits.scala  |  87 ---
 .../scala/kafka/javaapi/producer/Producer.scala    |  77 +--
 .../kafka/javaapi/producer/ProducerData.scala      |   8 +-
 .../javaapi/producer/async/CallbackHandler.java    |  77 ---
 .../kafka/javaapi/producer/async/EventHandler.java |  48 --
 .../scala/kafka/producer/BrokerPartitionInfo.scala |   2 +-
 .../kafka/producer/ConfigBrokerPartitionInfo.scala |  17 +-
 core/src/main/scala/kafka/producer/Producer.scala  | 260 ++++-----
 .../kafka/producer/ProducerClosedException.scala   |  21 +
 .../main/scala/kafka/producer/ProducerConfig.scala |  10 +-
 .../main/scala/kafka/producer/ProducerData.scala   |   8 +-
 .../main/scala/kafka/producer/ProducerPool.scala   | 157 +----
 .../scala/kafka/producer/async/AsyncProducer.scala | 141 -----
 .../kafka/producer/async/AsyncProducerConfig.scala |  19 +-
 .../async/AsyncProducerInterruptedException.scala  |  23 -
 .../kafka/producer/async/AsyncProducerStats.scala  |  18 +-
 .../producer/async/AsyncProducerStatsMBean.scala   |   1 -
 .../kafka/producer/async/CallbackHandler.scala     |  75 ---
 .../kafka/producer/async/DefaultEventHandler.scala | 254 ++++++---
 .../scala/kafka/producer/async/EventHandler.scala  |  19 +-
 .../kafka/producer/async/ProducerSendThread.scala  |  73 +--
 .../producer/async/QueueClosedException.scala      |  23 -
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   8 +-
 core/src/main/scala/kafka/utils/Utils.scala        |   7 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  41 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   4 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   2 +-
 .../unit/kafka/javaapi/producer/ProducerTest.scala | 629 ---------------------
 .../kafka/javaapi/producer/SyncProducerTest.scala  |  84 ---
 .../unit/kafka/producer/AsyncProducerTest.scala    | 510 ++++++++++-------
 .../unit/kafka/producer/ProducerMethodsTest.scala  |  57 --
 .../scala/unit/kafka/producer/ProducerTest.scala   | 489 +---------------
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  26 +-
 34 files changed, 783 insertions(+), 2515 deletions(-)
345bc7bad594af43df5fc264ad0b5904d1126257

 .../scala/kafka/consumer/ConsoleConsumer.scala     |  12 +-
 .../scala/kafka/perf/ProducerPerformance.scala     |  15 +-
 system_test/broker_failure/bin/run-test.sh         | 205 ++++++++++++++++-----
 system_test/broker_failure/config/log4j.properties |  72 ++++++--
 .../config/mirror_producer1.properties             |   2 +-
 .../config/mirror_producer2.properties             |   2 +-
 .../config/mirror_producer3.properties             |   2 +-
 .../config/server_source1.properties               |   2 +-
 .../config/server_source2.properties               |   2 +-
 .../config/server_source3.properties               |   2 +-
 .../config/server_source4.properties               |   2 +-
 .../config/server_target1.properties               |   2 +-
 .../config/server_target2.properties               |   2 +-
 .../config/server_target3.properties               |   2 +-
 .../config/whitelisttest.consumer.properties       |   4 +-
 15 files changed, 246 insertions(+), 82 deletions(-)
2552a2488f2674e2fc3abea02272e85ff13a3ee4

 contrib/hadoop-producer/README.md                  | 35 ++++++---
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     | 91 +++++++++++++++++-----
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     | 21 +++--
 3 files changed, 107 insertions(+), 40 deletions(-)
e3b529df80bfbc8d5ae3f86ef29efaf25e2edfb7

 core/src/main/scala/kafka/cluster/Cluster.scala    |   2 +-
 .../main/scala/kafka/consumer/ConsumerConfig.scala |   5 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |   2 +
 core/src/main/scala/kafka/consumer/Fetcher.scala   |   9 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |   4 +-
 .../consumer/ZookeeperConsumerConnector.scala      | 209 +++++++++++++--------
 core/src/main/scala/kafka/log/Log.scala            |  16 +-
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  87 +++++----
 .../main/scala/kafka/producer/ProducerConfig.scala |   4 +
 .../kafka/tools/VerifyConsumerRebalance.scala      | 137 ++++++++++++++
 .../main/scala/kafka/utils/IteratorTemplate.scala  |   5 +-
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |   7 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  39 ++++
 core/src/test/resources/log4j.properties           |   3 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  21 ++-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 133 ++++++++++---
 system_test/broker_failure/bin/run-test.sh         |  18 +-
 system_test/broker_failure/config/log4j.properties |   4 +-
 18 files changed, 532 insertions(+), 173 deletions(-)
afd4b0d772f35f902a7acf81039abcc47b983d1f

 .../main/scala/kafka/api/MultiFetchRequest.scala   |   2 -
 core/src/main/scala/kafka/cluster/Broker.scala     |   4 -
 core/src/main/scala/kafka/cluster/Cluster.scala    |   3 +-
 .../src/main/scala/kafka/common/ErrorMapping.scala |   1 -
 .../scala/kafka/consumer/ConsoleConsumer.scala     |   2 -
 core/src/main/scala/kafka/consumer/Fetcher.scala   |   9 +-
 .../src/main/scala/kafka/consumer/TopicCount.scala |   4 +-
 .../consumer/ZookeeperConsumerConnector.scala      | 209 +++++++++++++--------
 .../consumer/ZookeeperTopicEventWatcher.scala      |   2 +-
 core/src/main/scala/kafka/javaapi/Implicits.scala  |   4 +-
 .../scala/kafka/javaapi/message/MessageSet.scala   |   3 +-
 .../scala/kafka/javaapi/producer/Producer.scala    |   1 -
 .../message/ByteBufferBackedInputStream.scala      |   1 -
 .../scala/kafka/message/ByteBufferMessageSet.scala |   1 -
 .../scala/kafka/message/CompressionUtils.scala     |   4 +-
 .../main/scala/kafka/message/FileMessageSet.scala  |   2 -
 core/src/main/scala/kafka/message/Message.scala    |   3 -
 .../main/scala/kafka/network/SocketServer.scala    |   1 -
 .../scala/kafka/network/SocketServerStats.scala    |   2 -
 .../scala/kafka/producer/ConsoleProducer.scala     |   4 -
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |   2 +-
 .../scala/kafka/producer/SyncProducerConfig.scala  |   1 -
 core/src/main/scala/kafka/server/KafkaServer.scala |   1 -
 .../scala/kafka/server/MultiMessageSetSend.scala   |   3 -
 core/src/main/scala/kafka/tools/JmxTool.scala      |   2 +-
 .../src/main/scala/kafka/tools/ProducerShell.scala |   3 -
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   8 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |   1 -
 .../kafka/tools/VerifyConsumerRebalance.scala      | 137 ++++++++++++++
 .../main/scala/kafka/utils/KafkaScheduler.scala    |   1 -
 core/src/main/scala/kafka/utils/Range.scala        |   3 +-
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |   7 +-
 core/src/main/scala/kafka/utils/Utils.scala        |   1 -
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  39 ++++
 core/src/test/resources/log4j.properties           |   3 +-
 system_test/broker_failure/bin/run-test.sh         |  18 +-
 system_test/broker_failure/config/log4j.properties |   4 +-
 37 files changed, 356 insertions(+), 140 deletions(-)
fcc82dce6aff8fee30ce8a5ada3c6167aef1462f

 core/src/main/scala/kafka/log/Log.scala                  | 16 ++++++++++++----
 .../main/scala/kafka/server/KafkaRequestHandlers.scala   |  8 --------
 2 files changed, 12 insertions(+), 12 deletions(-)
af0ceff79b3f1902bf9d005136ace81549332902

 core/src/main/scala/kafka/admin/AdminUtils.scala   |  69 ++++--
 .../scala/kafka/admin/CreateTopicCommand.scala     |  27 ++-
 .../main/scala/kafka/admin/ListTopicCommand.scala  |   4 +-
 .../main/scala/kafka/admin/PartitionMetaData.scala |  33 ---
 core/src/main/scala/kafka/api/FetchRequest.scala   |   2 +-
 .../main/scala/kafka/api/MultiFetchRequest.scala   |   2 -
 core/src/main/scala/kafka/api/OffsetRequest.scala  |   2 +-
 .../src/main/scala/kafka/api/ProducerRequest.scala |   2 +-
 core/src/main/scala/kafka/api/RequestKeys.scala    |   1 +
 core/src/main/scala/kafka/api/TopicMetadata.scala  | 244 +++++++++++++++++++++
 .../scala/kafka/api/TopicMetadataRequest.scala     | 146 ++++++++++++
 core/src/main/scala/kafka/cluster/Broker.scala     |  37 +++-
 core/src/main/scala/kafka/cluster/Cluster.scala    |   1 -
 .../src/main/scala/kafka/common/ErrorMapping.scala |   1 -
 .../scala/kafka/common/KafkaZookeperClient.scala   |  35 +++
 .../scala/kafka/consumer/ConsoleConsumer.scala     |   2 -
 .../consumer/ZookeeperTopicEventWatcher.scala      |   2 +-
 .../consumer/storage/OracleOffsetStorage.scala     |   3 +-
 core/src/main/scala/kafka/javaapi/Implicits.scala  |   4 +-
 .../scala/kafka/javaapi/message/MessageSet.scala   |   3 +-
 .../scala/kafka/javaapi/producer/Producer.scala    |   1 -
 core/src/main/scala/kafka/log/LogManager.scala     |  66 +++---
 .../message/ByteBufferBackedInputStream.scala      |   1 -
 .../scala/kafka/message/ByteBufferMessageSet.scala |   1 -
 .../scala/kafka/message/CompressionUtils.scala     |   4 +-
 .../main/scala/kafka/message/FileMessageSet.scala  |   2 -
 core/src/main/scala/kafka/message/Message.scala    |   3 -
 .../kafka/network/BoundedByteBufferReceive.scala   |   4 +-
 .../main/scala/kafka/network/RequestChannel.scala  |   1 -
 .../main/scala/kafka/network/SocketServer.scala    |   1 -
 .../scala/kafka/network/SocketServerStats.scala    |   2 -
 .../scala/kafka/producer/BrokerPartitionInfo.scala |   2 +-
 .../kafka/producer/ConfigBrokerPartitionInfo.scala |   4 +-
 .../scala/kafka/producer/ConsoleProducer.scala     |   4 -
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |   2 +-
 .../scala/kafka/producer/SyncProducerConfig.scala  |   1 -
 .../kafka/producer/ZKBrokerPartitionInfo.scala     |  10 +-
 .../scala/kafka/producer/async/AsyncProducer.scala |  15 +-
 core/src/main/scala/kafka/server/KafkaApis.scala   |  41 +++-
 core/src/main/scala/kafka/server/KafkaConfig.scala |   9 +-
 .../scala/kafka/server/KafkaRequestHandler.scala   |   3 -
 .../scala/kafka/server/KafkaRequestHandlers.scala  | 132 -----------
 core/src/main/scala/kafka/server/KafkaServer.scala |   4 +-
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  17 +-
 .../scala/kafka/server/MultiMessageSetSend.scala   |   3 -
 core/src/main/scala/kafka/tools/JmxTool.scala      |   2 +-
 .../src/main/scala/kafka/tools/ProducerShell.scala |   3 -
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   8 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    |   1 -
 .../main/scala/kafka/utils/KafkaScheduler.scala    |   1 -
 core/src/main/scala/kafka/utils/Range.scala        |   3 +-
 core/src/main/scala/kafka/utils/Utils.scala        |  48 +++-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  44 +++-
 core/src/test/resources/log4j.properties           |   6 +-
 .../test/scala/other/kafka/TestKafkaAppender.scala |   2 +-
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |   2 -
 .../scala/other/kafka/TestLogPerformance.scala     |   1 -
 .../test/scala/unit/kafka/admin/AdminTest.scala    |  51 ++++-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   7 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |   3 +-
 .../integration/BackwardsCompatibilityTest.scala   |  16 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |   4 +-
 .../kafka/integration/KafkaServerTestHarness.scala |  13 +-
 .../kafka/integration/LazyInitProducerTest.scala   |  10 +-
 .../unit/kafka/integration/LogCorruptionTest.scala |   7 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   3 +-
 .../unit/kafka/integration/TopicMetadataTest.scala | 128 +++++++++++
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  11 +-
 .../javaapi/integration/PrimitiveApiTest.scala     |   6 +-
 .../javaapi/message/BaseMessageSetTestCases.scala  |   1 -
 .../javaapi/message/ByteBufferMessageSetTest.scala |   1 -
 .../unit/kafka/javaapi/producer/ProducerTest.scala |   4 +-
 .../kafka/javaapi/producer/SyncProducerTest.scala  |  34 +--
 .../test/scala/unit/kafka/log/LogManagerTest.scala |  22 +-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |  12 +-
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   3 +-
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  18 +-
 .../kafka/message/BaseMessageSetTestCases.scala    |   1 -
 .../unit/kafka/message/FileMessageSetTest.scala    |   3 -
 .../scala/unit/kafka/message/MessageTest.scala     |   3 -
 .../unit/kafka/network/SocketServerTest.scala      |   4 -
 .../unit/kafka/producer/AsyncProducerTest.scala    |   2 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |   3 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |  35 +--
 .../unit/kafka/server/ServerShutdownTest.scala     |  16 +-
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   7 +
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |   3 +-
 .../scala/unit/kafka/zk/ZKLoadBalanceTest.scala    |   3 +-
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |   3 +-
 project/build.properties                           |   2 +-
 90 files changed, 975 insertions(+), 538 deletions(-)
fe2f0557130b21aca203ced11bd6990322847b97

 .../scala/kafka/consumer/ConsumerIterator.scala     |  2 ++
 .../main/scala/kafka/utils/IteratorTemplate.scala   |  5 ++++-
 .../consumer/ZookeeperConsumerConnectorTest.scala   | 21 +++++++++++++--------
 3 files changed, 19 insertions(+), 9 deletions(-)
d3c58b64287b73ff9613e53e293d4a0989389cb2

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala | 5 +----
 1 file changed, 1 insertion(+), 4 deletions(-)
e913a06533c12c3cb7f139962abe5b61d2d08e0a

 bin/kafka-create-topic.sh | 0
 bin/kafka-delete-topic.sh | 0
 bin/kafka-list-topic.sh   | 0
 3 files changed, 0 insertions(+), 0 deletions(-)
ff668f4fc9a07137c92cc9259f8116d9ec2d2e1f

 bin/kafka-create-topic.sh                          |  19 +++
 bin/kafka-delete-topic.sh                          |  19 +++
 bin/kafka-list-topic.sh                            |  19 +++
 core/src/main/scala/kafka/admin/AdminUtils.scala   | 119 ++++++++++++++++
 .../scala/kafka/admin/CreateTopicCommand.scala     | 110 +++++++++++++++
 .../scala/kafka/admin/DeleteTopicCommand.scala     |  66 +++++++++
 .../main/scala/kafka/admin/ListTopicCommand.scala  |  89 ++++++++++++
 .../main/scala/kafka/admin/PartitionMetaData.scala |  33 +++++
 core/src/main/scala/kafka/utils/Utils.scala        |  10 ++
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  47 +++++++
 .../test/scala/unit/kafka/admin/AdminTest.scala    | 152 +++++++++++++++++++++
 11 files changed, 683 insertions(+)
cd91e6770b62d336ea61332782d31a21599587a3

 .../main/scala/kafka/network/RequestChannel.scala  |  61 ++++++++++
 core/src/main/scala/kafka/server/KafkaApis.scala   | 132 +++++++++++++++++++++
 .../scala/kafka/server/KafkaRequestHandler.scala   |  79 ++++++++++++
 3 files changed, 272 insertions(+)
1021ea9002dc7250c000512db7a8dec92f462404

 .../scala/kafka/producer/KafkaLog4jAppender.scala  |  83 +++++++------
 .../main/scala/kafka/producer/ProducerConfig.scala |   4 +
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 128 ++++++++++++++++-----
 3 files changed, 148 insertions(+), 67 deletions(-)
60d88a3ac95bee3b54a3d732d1ada22258054a33

 bin/kafka-consumer-perf-test.sh                    |   2 +-
 bin/kafka-producer-perf-test.sh                    |   2 +-
 core/src/main/scala/kafka/Kafka.scala              |   1 -
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   4 +-
 core/src/main/scala/kafka/log/Log.scala            |   1 +
 core/src/main/scala/kafka/log/LogManager.scala     |   5 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |   1 -
 .../main/scala/kafka/network/SocketServer.scala    | 187 +++++++++------------
 .../main/scala/kafka/network/Transmission.scala    |   4 +-
 .../main/scala/kafka/producer/SyncProducer.scala   |   6 +-
 .../scala/kafka/producer/async/AsyncProducer.scala |   2 +-
 core/src/main/scala/kafka/server/KafkaConfig.scala |  10 +-
 core/src/main/scala/kafka/server/KafkaServer.scala |  49 +++---
 .../scala/kafka/server/KafkaServerStartable.scala  |   6 +-
 core/src/main/scala/kafka/utils/Logging.scala      |  19 ++-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |  11 +-
 .../kafka/integration/AutoOffsetResetTest.scala    |   4 +-
 .../kafka/integration/LazyInitProducerTest.scala   |  26 ++-
 .../unit/kafka/integration/LogCorruptionTest.scala |   2 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   5 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   6 +-
 .../javaapi/integration/PrimitiveApiTest.scala     |   4 +-
 .../unit/kafka/javaapi/producer/ProducerTest.scala |  11 +-
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   3 +-
 .../unit/kafka/network/SocketServerTest.scala      |  47 +++---
 .../scala/unit/kafka/producer/ProducerTest.scala   |   4 +-
 .../unit/kafka/producer/SyncProducerTest.scala     |   4 +-
 .../unit/kafka/server/ServerShutdownTest.scala     |   2 +-
 28 files changed, 219 insertions(+), 209 deletions(-)
570672793791b927162d4bf7d9da6f8c016f270d
6c43b4634e5cebae822f19ed581bd97d74b3d47f

 system_test/broker_failure/bin/run-test.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
7bd3e169f165a15822e2c81f3ea90ea954175f31

 core/src/main/scala/kafka/tools/ConsumerOffsetChecker.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
a3c742ef23d19962bdc13f75eebb8a8082ad04a2

 core/lib/zkclient-20110412.jar   | Bin 97497 -> 0 bytes
 project/build/KafkaProject.scala |  23 ++---------------------
 2 files changed, 2 insertions(+), 21 deletions(-)
7821f5b20fd9c842cad00435abd1f697b238f540

 project/build/KafkaProject.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
b0484eccf3e72ff856c4e1c63949ac036c92d932

 .../scala/kafka/consumer/ConsumerIterator.scala    | 34 +++++----
 core/src/main/scala/kafka/consumer/Fetcher.scala   | 32 ++++++---
 .../scala/kafka/consumer/FetcherRunnable.scala     |  5 +-
 .../scala/kafka/consumer/KafkaMessageStream.scala  | 14 +++-
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |  1 -
 .../main/scala/kafka/consumer/SimpleConsumer.scala |  3 -
 .../consumer/ZookeeperConsumerConnector.scala      | 83 +++++++++++++++-------
 .../kafka/consumer/storage/OffsetStorage.scala     |  1 -
 .../kafka/producer/async/DefaultEventHandler.scala |  3 +-
 .../scala/kafka/server/KafkaRequestHandlers.scala  |  2 +-
 .../scala/unit/kafka/integration/FetcherTest.scala |  5 +-
 system_test/broker_failure/bin/run-test.sh         |  9 ++-
 12 files changed, 123 insertions(+), 69 deletions(-)
66be5eedf3e758ad53b966272f9228f54a96e648

 .../main/scala/kafka/consumer/ConsoleConsumer.scala |  2 +-
 .../src/main/scala/kafka/network/SocketServer.scala | 21 +++++++++++++++------
 core/src/main/scala/kafka/server/KafkaServer.scala  |  2 ++
 .../scala/unit/kafka/network/SocketServerTest.scala |  2 ++
 4 files changed, 20 insertions(+), 7 deletions(-)
336410a7774b0ee20758358a1bf03461ce4b98e1

 bin/kafka-run-class.sh                             |   5 +
 .../scala/kafka/consumer/ConsoleConsumer.scala     |  19 +-
 .../scala/kafka/server/KafkaRequestHandlers.scala  |   1 +
 .../scala/kafka/server/KafkaServerStartable.scala  |   1 +
 .../scala/kafka/perf/ProducerPerformance.scala     |  31 +-
 system_test/broker_failure/README                  |  42 ++
 system_test/broker_failure/bin/kafka-run-class.sh  |  67 +++
 system_test/broker_failure/bin/run-test.sh         | 667 +++++++++++++++++++++
 system_test/broker_failure/config/log4j.properties |  39 ++
 .../config/mirror_producer.properties              |  27 +
 .../config/mirror_producer1.properties             |  27 +
 .../config/mirror_producer2.properties             |  27 +
 .../config/mirror_producer3.properties             |  27 +
 .../config/server_source1.properties               |  81 +++
 .../config/server_source2.properties               |  82 +++
 .../config/server_source3.properties               |  82 +++
 .../config/server_source4.properties               |  82 +++
 .../config/server_target1.properties               |  85 +++
 .../config/server_target2.properties               |  85 +++
 .../config/server_target3.properties               |  85 +++
 .../config/whitelisttest.consumer.properties       |  29 +
 .../config/zookeeper_source.properties             |  18 +
 .../config/zookeeper_target.properties             |  18 +
 23 files changed, 1616 insertions(+), 11 deletions(-)
aac76681959f8e6090e443cbbce41c74e0393089

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala            | 7 +++++--
 core/src/main/scala/kafka/consumer/FetcherRunnable.scala           | 4 ++--
 .../src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 2 +-
 3 files changed, 8 insertions(+), 5 deletions(-)
a7d4c2cf235cbe626ff3bc9053982929b6a62884

 core/src/main/scala/kafka/producer/SyncProducer.scala       | 4 ++--
 core/src/main/scala/kafka/server/KafkaServerStartable.scala | 3 +--
 core/src/main/scala/kafka/utils/Utils.scala                 | 3 +--
 3 files changed, 4 insertions(+), 6 deletions(-)
5eb4badfc9980d25dd817c4caee6264e1e5b4b70

 core/src/main/scala/kafka/consumer/SimpleConsumer.scala | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
fc59ccf9d406b341ebc5ab8ffc065034804665dd
34508d155da2e5aecefcf52ec02718da7b126f46

 NOTICE | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
72f6d31c517bd2ed8c2e4269060501b0eb43a7df

 NOTICE | 4 ++++
 1 file changed, 4 insertions(+)
e5a4ec1806e5a457dae4d9b0df75953876888940

 core/src/main/scala/kafka/producer/SyncProducer.scala | 1 -
 1 file changed, 1 deletion(-)
2633b1f07b6c66f83b1ef3f13f06e63852ff13a9

 LICENSE                  | 98 ++++++++++++++++--------------------------------
 NOTICE                   | 32 ----------------
 config/server.properties |  2 +-
 3 files changed, 33 insertions(+), 99 deletions(-)
77da5f54d736bfa63fb0b2a20415919aaf9ad96d

 LICENSE | 99 +++++++++++++++++++++--------------------------------------------
 NOTICE  | 32 ---------------------
 2 files changed, 32 insertions(+), 99 deletions(-)
31f6f02aa2395011e713b3ca66f2412926db34ca

 .../common/ConsumerReblanceFailedException.scala   | 26 +++++++++++++++++
 .../consumer/ZookeeperConsumerConnector.scala      |  4 +--
 .../consumer/ZookeeperTopicEventWatcher.scala      | 33 ++++++++++------------
 .../scala/kafka/server/KafkaServerStartable.scala  |  7 +++--
 4 files changed, 47 insertions(+), 23 deletions(-)
bbba103d768b02bd39dc77caceb560d78c10f024

 core/src/main/scala/kafka/server/KafkaServer.scala | 91 ++++++++++------------
 .../scala/kafka/server/KafkaServerStartable.scala  | 28 +++++--
 2 files changed, 60 insertions(+), 59 deletions(-)
9a3e2104b5fcf845afb1a1218989ec2436fbf0da

 core/src/main/scala/kafka/producer/async/ProducerSendThread.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
fd0a3b86bcb4e757636843704a7a235275cf9c03

 bin/run-rat.sh                                     |   2 +-
 contrib/hadoop-consumer/lib/avro-1.4.0.jar         | Bin 568780 -> 0 bytes
 .../hadoop-consumer/lib/commons-logging-1.0.4.jar  | Bin 38015 -> 0 bytes
 contrib/hadoop-consumer/lib/hadoop-0.20.2-core.jar | Bin 2689741 -> 0 bytes
 .../hadoop-consumer/lib/jackson-core-asl-1.5.5.jar | Bin 171958 -> 0 bytes
 .../lib/jackson-mapper-asl-1.5.5.jar               | Bin 485699 -> 0 bytes
 contrib/hadoop-producer/lib/avro-1.4.0.jar         | Bin 568780 -> 0 bytes
 .../hadoop-producer/lib/commons-logging-1.0.4.jar  | Bin 38015 -> 0 bytes
 contrib/hadoop-producer/lib/hadoop-0.20.2-core.jar | Bin 2689741 -> 0 bytes
 .../hadoop-producer/lib/jackson-core-asl-1.5.5.jar | Bin 171958 -> 0 bytes
 .../lib/jackson-mapper-asl-1.5.5.jar               | Bin 485699 -> 0 bytes
 lib/apache-rat-0.8-SNAPSHOT.jar                    | Bin 1165051 -> 0 bytes
 project/build/KafkaProject.scala                   |  25 +++++++++++++--------
 13 files changed, 17 insertions(+), 10 deletions(-)
f53eb16f879374fea421deb0a31464d5a32273d4

 bin/run-rat.sh                                     |   2 +-
 contrib/hadoop-consumer/lib/avro-1.4.0.jar         | Bin 568780 -> 0 bytes
 .../hadoop-consumer/lib/commons-logging-1.0.4.jar  | Bin 38015 -> 0 bytes
 contrib/hadoop-consumer/lib/hadoop-0.20.2-core.jar | Bin 2689741 -> 0 bytes
 .../hadoop-consumer/lib/jackson-core-asl-1.5.5.jar | Bin 171958 -> 0 bytes
 .../lib/jackson-mapper-asl-1.5.5.jar               | Bin 485699 -> 0 bytes
 contrib/hadoop-producer/lib/avro-1.4.0.jar         | Bin 568780 -> 0 bytes
 .../hadoop-producer/lib/commons-logging-1.0.4.jar  | Bin 38015 -> 0 bytes
 contrib/hadoop-producer/lib/hadoop-0.20.2-core.jar | Bin 2689741 -> 0 bytes
 .../hadoop-producer/lib/jackson-core-asl-1.5.5.jar | Bin 171958 -> 0 bytes
 .../lib/jackson-mapper-asl-1.5.5.jar               | Bin 485699 -> 0 bytes
 core/src/main/scala/kafka/utils/Logging.scala      |  17 ++++++++++++++
 lib/apache-rat-0.8-SNAPSHOT.jar                    | Bin 1165051 -> 0 bytes
 project/build/KafkaProject.scala                   |  26 ++++++++++++++-------
 14 files changed, 35 insertions(+), 10 deletions(-)
c36cba4f6c7f439984a40a09dee58355200624a4

 LICENSE | 1 +
 1 file changed, 1 insertion(+)
07611f317474a3d4fd835df0feca729de976ada9

 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 5 ++++-
 core/src/main/scala/kafka/server/KafkaServerStartable.scala         | 3 +++
 2 files changed, 7 insertions(+), 1 deletion(-)
e947af13e22d0f6813b730f3cd93a91c7e11ea6f

 LICENSE | 29 +++++++++++++++++++++++++++++
 NOTICE  |  5 +++++
 2 files changed, 34 insertions(+)
8aecab22532711dbe568261347ebaa077298f007

 LICENSE | 29 +++++++++++++++++++++++++++++
 NOTICE  |  5 +++++
 2 files changed, 34 insertions(+)
078bd591e1c5c37198af43184620fc69320d6a36

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala             | 4 ++++
 core/src/main/scala/kafka/consumer/ZookeeperConsumerConnector.scala | 5 ++---
 2 files changed, 6 insertions(+), 3 deletions(-)
cb2564c45e83ab829cbf482665abe667bd830292

 core/src/main/scala/kafka/producer/SyncProducer.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
c65e771d4714e7081d54222d847ad5e08a3238ed

 core/src/main/scala/kafka/network/BoundedByteBufferReceive.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
eefd133656f6dfcf6cfcdc524b300bfa13fd1d0a

 core/src/main/scala/kafka/network/BoundedByteBufferReceive.scala | 6 ++----
 1 file changed, 2 insertions(+), 4 deletions(-)
285acbec41af90a9308a5c762fc13441ce83a57c

 core/src/main/scala/kafka/network/BoundedByteBufferReceive.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
e98bf881a5b3c81d00e6d5b424ef74236c197952

 .../consumer/ZookeeperConsumerConnectorTest.scala  | 188 +--------------------
 1 file changed, 3 insertions(+), 185 deletions(-)
56b48d3fb6eaac98f3452901af0f61a60adf7db8

 .../scala/kafka/tools/ConsumerPerformance.scala    | 161 -------------
 .../scala/kafka/tools/ProducerPerformance.scala    | 264 ---------------------
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   3 +-
 .../kafka/tools/SimpleConsumerPerformance.scala    |  96 --------
 core/src/main/scala/kafka/utils/Utils.scala        |  13 +
 perf/config/log4j.properties                       |  24 ++
 .../scala/kafka/perf/ConsumerPerformance.scala     | 199 ++++++++++++++++
 perf/src/main/scala/kafka/perf/PerfConfig.scala    |  48 ++++
 .../scala/kafka/perf/ProducerPerformance.scala     | 229 ++++++++++++++++++
 .../kafka/perf/SimpleConsumerPerformance.scala     | 143 +++++++++++
 project/build/KafkaProject.scala                   |  27 ++-
 11 files changed, 682 insertions(+), 525 deletions(-)
cb4486656e2c25d2988892628a61279b0a9eb913

 core/src/main/scala/kafka/api/OffsetRequest.scala  |  4 ++--
 .../scala/kafka/javaapi/message/MessageSet.scala   |  2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala |  4 ++--
 .../main/scala/kafka/message/FileMessageSet.scala  |  2 +-
 core/src/main/scala/kafka/message/MessageSet.scala |  2 +-
 .../kafka/network/BoundedByteBufferSend.scala      | 23 ++++++++++------------
 .../main/scala/kafka/network/ByteBufferSend.scala  |  2 +-
 .../main/scala/kafka/network/Transmission.scala    |  6 +++---
 .../main/scala/kafka/server/MessageSetSend.scala   |  2 +-
 9 files changed, 22 insertions(+), 25 deletions(-)
1280b71a35f0868de427a22271fa9f38384d9f2f

 core/src/main/scala/kafka/Kafka.scala              | 11 ++-
 .../scala/kafka/consumer/ConsoleConsumer.scala     | 15 ++--
 .../scala/kafka/consumer/ConsumerConnector.scala   | 10 +--
 .../scala/kafka/consumer/ConsumerIterator.scala    | 14 ++--
 .../scala/kafka/consumer/ConsumerTopicStat.scala   |  8 +-
 core/src/main/scala/kafka/consumer/Fetcher.scala   |  2 -
 .../scala/kafka/consumer/FetcherRunnable.scala     | 46 +++++------
 .../scala/kafka/consumer/KafkaMessageStream.scala  |  2 -
 .../scala/kafka/consumer/PartitionTopicInfo.scala  | 24 +++---
 .../main/scala/kafka/consumer/SimpleConsumer.scala | 28 +++----
 .../src/main/scala/kafka/consumer/TopicCount.scala |  7 +-
 .../consumer/ZookeeperConsumerConnector.scala      | 70 ++++++++---------
 .../consumer/ZookeeperTopicEventWatcher.scala      | 21 +++--
 .../consumer/storage/OracleOffsetStorage.scala     |  7 +-
 core/src/main/scala/kafka/javaapi/Implicits.scala  | 12 +--
 .../javaapi/message/ByteBufferMessageSet.scala     |  2 -
 core/src/main/scala/kafka/log/Log.scala            | 17 ++---
 core/src/main/scala/kafka/log/LogManager.scala     | 42 +++++-----
 .../scala/kafka/message/ByteBufferMessageSet.scala | 24 +++---
 .../scala/kafka/message/CompressionUtils.scala     | 12 ++-
 .../main/scala/kafka/message/FileMessageSet.scala  | 23 ++----
 .../main/scala/kafka/network/SocketServer.scala    |  1 -
 .../main/scala/kafka/network/Transmission.scala    | 14 ++--
 .../kafka/producer/ConfigBrokerPartitionInfo.scala |  2 -
 .../scala/kafka/producer/ConsoleProducer.scala     |  3 -
 .../scala/kafka/producer/KafkaLog4jAppender.scala  | 15 ++--
 core/src/main/scala/kafka/producer/Producer.scala  | 24 +++---
 .../main/scala/kafka/producer/ProducerPool.scala   | 26 +++----
 .../main/scala/kafka/producer/SyncProducer.scala   | 33 ++++----
 .../kafka/producer/ZKBrokerPartitionInfo.scala     | 89 ++++++++--------------
 .../scala/kafka/producer/async/AsyncProducer.scala |  9 +--
 .../kafka/producer/async/AsyncProducerStats.scala  |  2 +-
 .../kafka/producer/async/DefaultEventHandler.scala | 23 ++----
 .../kafka/producer/async/ProducerSendThread.scala  | 34 ++++-----
 .../scala/kafka/server/KafkaRequestHandlers.scala  | 18 ++---
 core/src/main/scala/kafka/server/KafkaServer.scala | 24 +++---
 .../scala/kafka/server/KafkaServerStartable.scala  | 36 ++++-----
 .../main/scala/kafka/server/KafkaZooKeeper.scala   | 23 +++---
 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 12 ++-
 .../scala/kafka/tools/ConsumerPerformance.scala    | 12 ++-
 .../src/main/scala/kafka/tools/ConsumerShell.scala |  9 +--
 .../scala/kafka/tools/ProducerPerformance.scala    | 30 ++++----
 .../main/scala/kafka/tools/ReplayLogProducer.scala | 20 +++--
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 16 ++--
 .../main/scala/kafka/utils/KafkaScheduler.scala    |  8 +-
 core/src/main/scala/kafka/utils/Logging.scala      | 77 +++++++++++++++++++
 core/src/main/scala/kafka/utils/Mx4jLoader.scala   | 12 ++-
 core/src/main/scala/kafka/utils/Throttler.scala    |  7 +-
 core/src/main/scala/kafka/utils/Utils.scala        | 39 ++++++----
 core/src/main/scala/kafka/utils/ZkUtils.scala      | 12 ++-
 .../test/scala/other/kafka/TestKafkaAppender.scala |  7 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 13 ++--
 .../kafka/integration/AutoOffsetResetTest.scala    | 19 +++--
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 13 ++--
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |  7 +-
 55 files changed, 495 insertions(+), 591 deletions(-)
f72c142bb1cf5fa584552cfec3ed5e8553448bf6

 LICENSE | 64 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 64 insertions(+)
41db543d31622e2b0943e3e62fbca4203493825f

 LICENSE | 64 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 64 insertions(+)
09f5ce21b337bdfb950cb393bf8fc004dcd0f36d

 .../scala/kafka/producer/async/AsyncProducer.scala | 23 +++++++---------------
 .../kafka/producer/async/AsyncProducerStats.scala  | 22 ++++++++++++++++++---
 .../producer/async/AsyncProducerStatsMBean.scala   |  6 +++++-
 3 files changed, 31 insertions(+), 20 deletions(-)
af923c3018f8ddee6703e577eadf9227d826806e

 .../consumer/ZookeeperConsumerConnector.scala      |  1 -
 core/src/main/scala/kafka/log/Log.scala            | 11 ++++--
 core/src/main/scala/kafka/log/LogManager.scala     | 43 +++++++++++++++++-----
 .../scala/kafka/server/KafkaRequestHandlers.scala  | 16 ++++----
 .../main/scala/kafka/server/MessageSetSend.scala   |  2 +
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  9 +++++
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 12 +++++-
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  | 22 +++++++----
 8 files changed, 85 insertions(+), 31 deletions(-)
799185b4d48df66a377c5040782cfc486b8412d3

 DISCLAIMER | 15 ++++++++++++
 NOTICE     | 77 ++++++++++++++++++++------------------------------------------
 2 files changed, 40 insertions(+), 52 deletions(-)
7d856dce92d00e2c5a5dccdac7f8908f7fba44e2

 DISCLAIMER | 15 ++++++++++++
 NOTICE     | 77 ++++++++++++++++++++------------------------------------------
 2 files changed, 40 insertions(+), 52 deletions(-)
c51b940179e2a5719021ea253b38ec4a2beed41f

 .../scala/kafka/message/CompressionCodec.scala     |   9 +-
 .../scala/kafka/message/CompressionUtils.scala     | 234 +++++++++++----------
 .../unit/kafka/message/CompressionUtilsTest.scala  |  17 ++
 project/build/KafkaProject.scala                   |   6 +-
 4 files changed, 154 insertions(+), 112 deletions(-)
e5702b874da5f0c83163f1a6ba6a07a62c00269b

 config/producer.properties                         | 80 ++++++++++++++++++++++
 config/server.properties                           |  2 +-
 .../src/main/scala/kafka/tools/ProducerShell.scala | 25 +++----
 3 files changed, 91 insertions(+), 16 deletions(-)
6110e6b215a11a10a570f730834e67a2416b964e

 config/server.properties                                 |  2 +-
 .../scala/unit/kafka/message/CompressionUtilsTest.scala  | 16 ++++++++--------
 2 files changed, 9 insertions(+), 9 deletions(-)
0153d4bb597283f48ae07af7cda3c633a71e436b

 config/producer.properties                         | 80 ++++++++++++++++++++++
 .../src/main/scala/kafka/tools/ProducerShell.scala | 25 +++----
 2 files changed, 90 insertions(+), 15 deletions(-)
4f9000c412f0586032bf622ebad23f941969d2c4

 .../scala/unit/kafka/message/CompressionUtilsTest.scala  | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)
5497e8d156abeb898ed556c688d2a84b8c8bdd83

 config/server.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
ff0141e2b6b2efeaef6882e14b3c8e0404b0dc30

 clojure/.gitignore                       | 0
 clojure/LICENSE                          | 0
 clojure/README.md                        | 0
 clojure/leiningen/run_example.clj        | 0
 clojure/project.clj                      | 0
 clojure/resources/log4j.properties       | 0
 clojure/src/kafka/buffer.clj             | 0
 clojure/src/kafka/example.clj            | 0
 clojure/src/kafka/kafka.clj              | 0
 clojure/src/kafka/print.clj              | 0
 clojure/src/kafka/serializable.clj       | 0
 clojure/src/kafka/types.clj              | 0
 clojure/test/kafka/buffer_test.clj       | 0
 clojure/test/kafka/print_test.clj        | 0
 clojure/test/kafka/serializable_test.clj | 0
 15 files changed, 0 insertions(+), 0 deletions(-)
5c3d5d815ca4f74611ffdd0fbd9da05cd5943d83

 clients/clojure/.gitignore                       | 0
 clients/clojure/LICENSE                          | 0
 clients/clojure/README.md                        | 0
 clients/clojure/leiningen/run_example.clj        | 0
 clients/clojure/project.clj                      | 0
 clients/clojure/resources/log4j.properties       | 0
 clients/clojure/src/kafka/buffer.clj             | 0
 clients/clojure/src/kafka/example.clj            | 0
 clients/clojure/src/kafka/kafka.clj              | 0
 clients/clojure/src/kafka/print.clj              | 0
 clients/clojure/src/kafka/serializable.clj       | 0
 clients/clojure/src/kafka/types.clj              | 0
 clients/clojure/test/kafka/buffer_test.clj       | 0
 clients/clojure/test/kafka/print_test.clj        | 0
 clients/clojure/test/kafka/serializable_test.clj | 0
 15 files changed, 0 insertions(+), 0 deletions(-)
3bd0b990c1a43e02c6cde7f6182844d0ff0e8086

 project/build/KafkaProject.scala | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
65c25ae6b948587b65ada9c87f8a783ac1b2ab22

 project/build/KafkaProject.scala | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
71a885ad9f68a0899cf993237214d3322f4c7f0c

 clojure/.gitignore                       |   2 -
 clojure/LICENSE                          | 202 ----------------------
 clojure/README.md                        |  50 ------
 clojure/leiningen/run_example.clj        |  24 ---
 clojure/project.clj                      |  27 ---
 clojure/resources/log4j.properties       |  19 ---
 clojure/src/kafka/buffer.clj             | 189 ---------------------
 clojure/src/kafka/example.clj            |  52 ------
 clojure/src/kafka/kafka.clj              | 281 -------------------------------
 clojure/src/kafka/print.clj              |  36 ----
 clojure/src/kafka/serializable.clj       |  36 ----
 clojure/src/kafka/types.clj              |  42 -----
 clojure/test/kafka/buffer_test.clj       |  60 -------
 clojure/test/kafka/print_test.clj        |  26 ---
 clojure/test/kafka/serializable_test.clj |  28 ---
 15 files changed, 1074 deletions(-)
12572102c695058264af1599112f0660325e7189

 clients/clojure/.gitignore                       |   2 -
 clients/clojure/LICENSE                          | 202 ----------------
 clients/clojure/README.md                        |  50 ----
 clients/clojure/leiningen/run_example.clj        |  24 --
 clients/clojure/project.clj                      |  27 ---
 clients/clojure/resources/log4j.properties       |  19 --
 clients/clojure/src/kafka/buffer.clj             | 189 ---------------
 clients/clojure/src/kafka/example.clj            |  52 -----
 clients/clojure/src/kafka/kafka.clj              | 281 -----------------------
 clients/clojure/src/kafka/print.clj              |  36 ---
 clients/clojure/src/kafka/serializable.clj       |  36 ---
 clients/clojure/src/kafka/types.clj              |  42 ----
 clients/clojure/test/kafka/buffer_test.clj       |  60 -----
 clients/clojure/test/kafka/print_test.clj        |  26 ---
 clients/clojure/test/kafka/serializable_test.clj |  28 ---
 15 files changed, 1074 deletions(-)
a38fbf868864bbe4b2a8bd550b32f3538acfe4c5

 clients/clojure/.gitignore                       |   2 -
 clients/clojure/LICENSE                          | 202 ----------------
 clients/clojure/README.md                        |  50 ----
 clients/clojure/leiningen/run_example.clj        |  24 --
 clients/clojure/project.clj                      |  27 ---
 clients/clojure/resources/log4j.properties       |  19 --
 clients/clojure/src/kafka/buffer.clj             | 189 ---------------
 clients/clojure/src/kafka/example.clj            |  52 -----
 clients/clojure/src/kafka/kafka.clj              | 281 -----------------------
 clients/clojure/src/kafka/print.clj              |  36 ---
 clients/clojure/src/kafka/serializable.clj       |  36 ---
 clients/clojure/src/kafka/types.clj              |  42 ----
 clients/clojure/test/kafka/buffer_test.clj       |  60 -----
 clients/clojure/test/kafka/print_test.clj        |  26 ---
 clients/clojure/test/kafka/serializable_test.clj |  28 ---
 15 files changed, 1074 deletions(-)
0bfe6b1ed30454837d0aeaaf11b60089d3dd1a56
dcbf7d4b68bd8e1eab410bc0637ca104ddb04c6f

 go/Makefile                     |   1 +
 go/README.md                    |  20 ++++-
 go/kafka_test.go                | 191 +++++++++++++++++++++++++++++++++++-----
 go/src/consumer.go              |  37 +++++---
 go/src/converts.go              |   2 -
 go/src/kafka.go                 |  10 +--
 go/src/message.go               | 113 ++++++++++++++++++++----
 go/src/payload_codec.go         | 116 ++++++++++++++++++++++++
 go/src/publisher.go             |  12 +--
 go/src/request.go               |  19 ++--
 go/src/timing.go                |   1 -
 go/tools/consumer/consumer.go   |   4 +-
 go/tools/publisher/publisher.go |  18 +++-
 13 files changed, 456 insertions(+), 88 deletions(-)
14a1f0dcd6af28bc710e108e6f7a5c10f825a40a

 clients/go/Makefile                     |   1 +
 clients/go/README.md                    |  20 +++-
 clients/go/kafka_test.go                | 191 ++++++++++++++++++++++++++++----
 clients/go/src/consumer.go              |  37 +++++--
 clients/go/src/converts.go              |   2 -
 clients/go/src/kafka.go                 |  10 +-
 clients/go/src/message.go               | 113 +++++++++++++++----
 clients/go/src/payload_codec.go         | 116 +++++++++++++++++++
 clients/go/src/publisher.go             |  12 +-
 clients/go/src/request.go               |  19 +---
 clients/go/src/timing.go                |   1 -
 clients/go/tools/consumer/consumer.go   |   4 +-
 clients/go/tools/publisher/publisher.go |  18 ++-
 13 files changed, 456 insertions(+), 88 deletions(-)
d9a8af778275fda2057d49f244e61456dfcf2f96

 core/src/main/scala/kafka/producer/Producer.scala  | 31 +++++++++++++---------
 .../unit/kafka/javaapi/producer/ProducerTest.scala | 12 ++++-----
 .../scala/unit/kafka/producer/ProducerTest.scala   | 12 ++++-----
 3 files changed, 30 insertions(+), 25 deletions(-)
41f14a3e965b8ff6a3e2e734e92574199463b452

 core/src/main/scala/kafka/tools/JmxTool.scala | 110 ++++++++++++++++++++++++++
 1 file changed, 110 insertions(+)
76957e5e3a748b59525e5e7934f93721eb8f4c38

 core/src/main/scala/kafka/server/KafkaServer.scala    |  3 +--
 core/src/main/scala/kafka/server/KafkaZooKeeper.scala | 11 ++++++++++-
 2 files changed, 11 insertions(+), 3 deletions(-)
46b6144a8fee4d9cc1c4ff22d2c1984540259c6b

 config/server.properties | 114 +++++++++++++++++++++++++++++++----------------
 1 file changed, 76 insertions(+), 38 deletions(-)
ce070548e413714c60a5cbdd642421cdc1e49b1d

 bin/zookeeper-shell.sh | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
81f8d0dd83a25e075cc6a08c6105b01459980c5f

 .../scala/kafka/consumer/PartitionTopicInfo.scala     |  3 ++-
 .../scala/kafka/message/ByteBufferMessageSet.scala    |  2 +-
 core/src/main/scala/kafka/tools/ConsumerShell.scala   |  2 +-
 .../unit/kafka/message/ByteBufferMessageSetTest.scala | 19 +++++++++++++++++++
 4 files changed, 23 insertions(+), 3 deletions(-)
79b9849271c110881e375ac4cb73285140771440

 python/kafka.py | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
a0b2aa8847a97a60fbc087d7fff27db28be170d1

 clients/python/kafka.py | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
ef1cf403609d90d173013a4679714fb6ec44be36

 php/src/lib/Kafka/Encoder.php  | 14 ++++++++------
 php/src/lib/Kafka/Message.php  | 23 +++++++++++------------
 php/src/lib/Kafka/Producer.php |  8 +++++++-
 3 files changed, 26 insertions(+), 19 deletions(-)
c2dc9c0841532abc3cdb29e2daeae2a4854dee3d

 clients/php/src/lib/Kafka/Encoder.php  | 14 ++++++++------
 clients/php/src/lib/Kafka/Message.php  | 23 +++++++++++------------
 clients/php/src/lib/Kafka/Producer.php |  8 +++++++-
 3 files changed, 26 insertions(+), 19 deletions(-)
0fa8b4080aeaad8f39e48322035e41361c1070aa

 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs |  16 +-
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  |   2 -
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 251 +++++++----------
 .../Kafka.Client/Consumers/ConsumerIterator.cs     |  45 +--
 csharp/src/Kafka/Kafka.Client/Consumers/Fetcher.cs |   4 +-
 .../Kafka.Client/Consumers/FetcherRunnable.cs      |  13 +-
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  |  10 -
 .../Consumers/ZookeeperConsumerConnector.cs        |  15 +-
 .../Exceptions/ConsumerTimeoutException.cs         |   3 +
 csharp/src/Kafka/Kafka.Client/Kafka.Client.csproj  |  41 ++-
 csharp/src/Kafka/Kafka.Client/KafkaConnection.cs   | 137 +++-------
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 297 +++++++++++++++++---
 csharp/src/Kafka/Kafka.Client/Messages/Message.cs  | 196 +++++++++----
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  |   2 +-
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  |  90 ++++--
 .../Producers/Async/AsyncProducerPool.cs           |  45 ++-
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs |   3 +-
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  |   3 +-
 .../Partitioning/ConfigBrokerPartitionInfo.cs      |  18 +-
 .../Producers/Partitioning/DefaultPartitioner.cs   |   2 +-
 .../Partitioning/ZKBrokerPartitionInfo.cs          |  21 +-
 .../Kafka.Client/Producers/Producer.StrMsg.cs      |   8 +-
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   |  57 ++--
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   |  46 +++-
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   |   3 +-
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    |  80 ++++--
 .../Producers/Sync/SyncProducerPool.cs             |  48 ++--
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    |   4 +-
 .../Kafka.Client/Requests/MultiFetchRequest.cs     |   6 +-
 .../Kafka.Client/Requests/MultiProducerRequest.cs  |  31 +--
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   |   4 +-
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs |  49 ++--
 .../Serialization/KafkaBinaryReader.cs             |  19 +-
 csharp/src/Kafka/Kafka.Client/Utils/Guard.cs       |  54 +++-
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   |   6 +-
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  |   2 +-
 .../ZooKeeperIntegration/IZooKeeperClient.cs       |   2 +-
 .../Listeners/BrokerTopicsListener.cs              |   6 +-
 .../Listeners/ZKRebalancerListener.cs              |  12 +-
 .../Listeners/ZKSessionExpireListener.cs           |   4 +-
 .../ZooKeeperIntegration/ZooKeeperClient.cs        |  65 ++---
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    |  16 +-
 .../ZooKeeperStringSerializer.cs                   |   6 +-
 .../Config/Integration/App.config                  |   4 +-
 .../ConsumerRebalancingTests.cs                    |  52 +---
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 129 +++++----
 .../IntegrationFixtureBase.cs                      | 109 +++++++-
 .../Kafka.Client.IntegrationTests.csproj           |   6 +-
 .../KafkaIntegrationTest.cs                        | 303 ++++++++++-----------
 .../MockAlwaysZeroPartitioner.cs                   |   2 +
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 249 ++++++++---------
 .../Kafka.Client.IntegrationTests/TestHelper.cs    |  27 +-
 .../TestMultipleBrokersHelper.cs                   |  49 ++--
 .../ZKBrokerPartitionInfoTests.cs                  | 204 +++++++-------
 .../ZooKeeperAwareProducerTests.cs                 |  87 +++---
 .../ZooKeeperClientTests.cs                        | 119 +++++---
 .../ZooKeeperConnectionTests.cs                    |  37 ++-
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   |  12 +-
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    |  20 +-
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs |  35 ++-
 .../Producers/PartitioningTests.cs                 |   9 +-
 .../Request/MultiProducerRequestTests.cs           |   4 +-
 .../Request/ProducerRequestTests.cs                |   8 +-
 63 files changed, 1815 insertions(+), 1392 deletions(-)
e39c11abbc24223344b5ee8f7c8c03f126da5750

 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs |  16 +-
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  |   2 -
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 251 +++++++----------
 .../Kafka.Client/Consumers/ConsumerIterator.cs     |  45 +--
 .../src/Kafka/Kafka.Client/Consumers/Fetcher.cs    |   4 +-
 .../Kafka.Client/Consumers/FetcherRunnable.cs      |  13 +-
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  |  10 -
 .../Consumers/ZookeeperConsumerConnector.cs        |  15 +-
 .../Exceptions/ConsumerTimeoutException.cs         |   3 +
 .../src/Kafka/Kafka.Client/Kafka.Client.csproj     |  41 ++-
 .../src/Kafka/Kafka.Client/KafkaConnection.cs      | 137 +++-------
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 297 +++++++++++++++++---
 .../src/Kafka/Kafka.Client/Messages/Message.cs     | 196 +++++++++----
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  |   2 +-
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  |  90 ++++--
 .../Producers/Async/AsyncProducerPool.cs           |  45 ++-
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs |   3 +-
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  |   3 +-
 .../Partitioning/ConfigBrokerPartitionInfo.cs      |  18 +-
 .../Producers/Partitioning/DefaultPartitioner.cs   |   2 +-
 .../Partitioning/ZKBrokerPartitionInfo.cs          |  21 +-
 .../Kafka.Client/Producers/Producer.StrMsg.cs      |   8 +-
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   |  57 ++--
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   |  46 +++-
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   |   3 +-
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    |  80 ++++--
 .../Producers/Sync/SyncProducerPool.cs             |  48 ++--
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    |   4 +-
 .../Kafka.Client/Requests/MultiFetchRequest.cs     |   6 +-
 .../Kafka.Client/Requests/MultiProducerRequest.cs  |  31 +--
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   |   4 +-
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs |  49 ++--
 .../Serialization/KafkaBinaryReader.cs             |  19 +-
 .../csharp/src/Kafka/Kafka.Client/Utils/Guard.cs   |  54 +++-
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   |   6 +-
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  |   2 +-
 .../ZooKeeperIntegration/IZooKeeperClient.cs       |   2 +-
 .../Listeners/BrokerTopicsListener.cs              |   6 +-
 .../Listeners/ZKRebalancerListener.cs              |  12 +-
 .../Listeners/ZKSessionExpireListener.cs           |   4 +-
 .../ZooKeeperIntegration/ZooKeeperClient.cs        |  65 ++---
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    |  16 +-
 .../ZooKeeperStringSerializer.cs                   |   6 +-
 .../Config/Integration/App.config                  |   4 +-
 .../ConsumerRebalancingTests.cs                    |  52 +---
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 129 +++++----
 .../IntegrationFixtureBase.cs                      | 109 +++++++-
 .../Kafka.Client.IntegrationTests.csproj           |   6 +-
 .../KafkaIntegrationTest.cs                        | 303 ++++++++++-----------
 .../MockAlwaysZeroPartitioner.cs                   |   2 +
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 249 ++++++++---------
 .../Kafka.Client.IntegrationTests/TestHelper.cs    |  27 +-
 .../TestMultipleBrokersHelper.cs                   |  49 ++--
 .../ZKBrokerPartitionInfoTests.cs                  | 204 +++++++-------
 .../ZooKeeperAwareProducerTests.cs                 |  87 +++---
 .../ZooKeeperClientTests.cs                        | 119 +++++---
 .../ZooKeeperConnectionTests.cs                    |  37 ++-
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   |  12 +-
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    |  20 +-
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs |  35 ++-
 .../Producers/PartitioningTests.cs                 |   9 +-
 .../Request/MultiProducerRequestTests.cs           |   4 +-
 .../Request/ProducerRequestTests.cs                |   8 +-
 63 files changed, 1815 insertions(+), 1392 deletions(-)
78947b5d7b2ef77f9c2eff61afd5b3cdb2e07eff

 cpp/configure.ac                                       | 16 +++++++++++++++-
 csharp/Settings.StyleCop                               | 16 ++++++++++++++++
 csharp/lib/StyleCop/Microsoft.StyleCop.Targets         | 16 ++++++++++++++++
 csharp/lib/StyleCop/Settings.StyleCop                  | 16 ++++++++++++++++
 csharp/src/Kafka/Kafka.Client/AbstractRequest.cs       | 18 +++++++++++++++++-
 .../src/Kafka/Kafka.Client/Properties/AssemblyInfo.cs  | 18 +++++++++++++++++-
 csharp/src/Kafka/Kafka.FxCop                           | 16 ++++++++++++++++
 csharp/src/Kafka/Kafka.sln                             | 16 ++++++++++++++++
 .../Tests/Kafka.Client.IntegrationTests/App.config     | 16 ++++++++++++++++
 .../Config/Debug/App.config                            | 16 ++++++++++++++++
 .../Config/Integration/App.config                      | 16 ++++++++++++++++
 .../Tests/Kafka.Client.IntegrationTests/Log4Net.config | 16 ++++++++++++++++
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs      | 18 +++++++++++++++++-
 ruby/Rakefile                                          | 15 +++++++++++++++
 ruby/kafka-rb.gemspec                                  | 14 ++++++++++++++
 15 files changed, 239 insertions(+), 4 deletions(-)
3f0046be1b1ff9f0561b3f6cbf36dd32b0c0727d

 clients/cpp/configure.ac                               | 16 +++++++++++++++-
 clients/csharp/Settings.StyleCop                       | 16 ++++++++++++++++
 clients/csharp/lib/StyleCop/Microsoft.StyleCop.Targets | 16 ++++++++++++++++
 clients/csharp/lib/StyleCop/Settings.StyleCop          | 16 ++++++++++++++++
 .../csharp/src/Kafka/Kafka.Client/AbstractRequest.cs   | 18 +++++++++++++++++-
 .../src/Kafka/Kafka.Client/Properties/AssemblyInfo.cs  | 18 +++++++++++++++++-
 clients/csharp/src/Kafka/Kafka.FxCop                   | 16 ++++++++++++++++
 clients/csharp/src/Kafka/Kafka.sln                     | 16 ++++++++++++++++
 .../Tests/Kafka.Client.IntegrationTests/App.config     | 16 ++++++++++++++++
 .../Config/Debug/App.config                            | 16 ++++++++++++++++
 .../Config/Integration/App.config                      | 16 ++++++++++++++++
 .../Tests/Kafka.Client.IntegrationTests/Log4Net.config | 16 ++++++++++++++++
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs      | 18 +++++++++++++++++-
 clients/ruby/Rakefile                                  | 15 +++++++++++++++
 clients/ruby/kafka-rb.gemspec                          | 14 ++++++++++++++
 project/plugins/Plugins.scala                          | 17 +++++++++++++++++
 16 files changed, 256 insertions(+), 4 deletions(-)
4ad98872ad25b93a10c368edc77b59ed4032d3af

 .rat-excludes                    |  26 ++++++++++++++++++++++++++
 bin/run-rat.sh                   |  35 +++++++++++++++++++++++++++++++++++
 lib/apache-rat-0.8-SNAPSHOT.jar  | Bin 0 -> 1165051 bytes
 project/build/KafkaProject.scala |  13 +++++++++++++
 4 files changed, 74 insertions(+)
85989a1baf42f5a3e204044e09a01dcee8332afa

 KEYS | 100 -------------------------------------------------------------------
 1 file changed, 100 deletions(-)
076dced00a097fb8f698d6818151fd146eb246fc

 cpp/Makefile.in                        |   946 --
 cpp/README.md                          |     1 +
 cpp/aclocal.m4                         |   956 --
 cpp/autoconf.sh                        |    33 +
 cpp/build-aux/config.guess             |  1502 ---
 cpp/build-aux/config.sub               |  1714 ----
 cpp/build-aux/depcomp                  |   630 --
 cpp/build-aux/install-sh               |   534 -
 cpp/build-aux/ltmain.sh                |  8427 ----------------
 cpp/build-aux/m4/libtool.m4            |  7377 --------------
 cpp/build-aux/m4/ltoptions.m4          |   368 -
 cpp/build-aux/m4/ltsugar.m4            |   123 -
 cpp/build-aux/m4/ltversion.m4          |    23 -
 cpp/build-aux/m4/lt~obsolete.m4        |    92 -
 cpp/build-aux/missing                  |   376 -
 cpp/configure                          | 16820 -------------------------------
 cpp/src/encoder.hpp                    |    19 +-
 cpp/src/encoder_helper.hpp             |    16 +
 cpp/src/example.cpp                    |    16 +
 cpp/src/producer.cpp                   |    17 +
 cpp/src/producer.hpp                   |    17 +
 cpp/src/tests/encoder_helper_tests.cpp |    17 +
 cpp/src/tests/encoder_tests.cpp        |    17 +
 cpp/src/tests/producer_tests.cpp       |    17 +
 24 files changed, 167 insertions(+), 39891 deletions(-)
e27136d81a47a5601e0a85069140a0a7854d3d65

 clients/cpp/Makefile.in                        |   946 --
 clients/cpp/README.md                          |     1 +
 clients/cpp/aclocal.m4                         |   956 --
 clients/cpp/autoconf.sh                        |    33 +
 clients/cpp/build-aux/config.guess             |  1502 --
 clients/cpp/build-aux/config.sub               |  1714 ---
 clients/cpp/build-aux/depcomp                  |   630 -
 clients/cpp/build-aux/install-sh               |   534 -
 clients/cpp/build-aux/ltmain.sh                |  8427 ------------
 clients/cpp/build-aux/m4/libtool.m4            |  7377 ----------
 clients/cpp/build-aux/m4/ltoptions.m4          |   368 -
 clients/cpp/build-aux/m4/ltsugar.m4            |   123 -
 clients/cpp/build-aux/m4/ltversion.m4          |    23 -
 clients/cpp/build-aux/m4/lt~obsolete.m4        |    92 -
 clients/cpp/build-aux/missing                  |   376 -
 clients/cpp/configure                          | 16820 -----------------------
 clients/cpp/src/encoder.hpp                    |    19 +-
 clients/cpp/src/encoder_helper.hpp             |    16 +
 clients/cpp/src/example.cpp                    |    16 +
 clients/cpp/src/producer.cpp                   |    17 +
 clients/cpp/src/producer.hpp                   |    17 +
 clients/cpp/src/tests/encoder_helper_tests.cpp |    17 +
 clients/cpp/src/tests/encoder_tests.cpp        |    17 +
 clients/cpp/src/tests/producer_tests.cpp       |    17 +
 24 files changed, 167 insertions(+), 39891 deletions(-)
c0fc483d9f34d2adf3499b7d164f4c73d2e4f10e

 core/src/main/scala/kafka/consumer/PartitionTopicInfo.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
57f4604d31b2afb94a33b0c25aafd19556999a24

 csharp/src/Kafka/Kafka.Client/Consumer.cs          |  19 +-
 csharp/src/Kafka/Kafka.Client/KafkaException.cs    |  19 +-
 csharp/src/Kafka/Kafka.Client/Message.cs           |  19 +-
 csharp/src/Kafka/Kafka.Client/Producer.cs          |  19 +-
 .../src/Kafka/Kafka.Client/Request/FetchRequest.cs |  18 +-
 .../Kafka.Client/Request/MultiFetchRequest.cs      |  19 +-
 .../Kafka.Client/Request/MultiProducerRequest.cs   |  18 +-
 .../Kafka/Kafka.Client/Request/OffsetRequest.cs    |  19 +-
 .../Kafka/Kafka.Client/Request/ProducerRequest.cs  |  19 +-
 csharp/src/Kafka/Kafka.Client/RequestType.cs       |  19 +-
 csharp/src/Kafka/Kafka.Client/Util/BitWorks.cs     |  19 +-
 csharp/src/Kafka/Kafka.Client/Util/Crc32.cs        |  19 +-
 .../ZooKeeperClient.Watcher.cs                     |  14 +-
 python/LICENSE                                     | 203 +++++++++++++++++++++
 14 files changed, 425 insertions(+), 18 deletions(-)
c7fb4649384d6635b820b6b39fa6c424e0c535b9

 clients/csharp/src/Kafka/Kafka.Client/Consumer.cs  |  19 +-
 .../src/Kafka/Kafka.Client/KafkaException.cs       |  19 +-
 clients/csharp/src/Kafka/Kafka.Client/Message.cs   |  19 +-
 clients/csharp/src/Kafka/Kafka.Client/Producer.cs  |  19 +-
 .../src/Kafka/Kafka.Client/Request/FetchRequest.cs |  18 +-
 .../Kafka.Client/Request/MultiFetchRequest.cs      |  19 +-
 .../Kafka.Client/Request/MultiProducerRequest.cs   |  18 +-
 .../Kafka/Kafka.Client/Request/OffsetRequest.cs    |  19 +-
 .../Kafka/Kafka.Client/Request/ProducerRequest.cs  |  19 +-
 .../csharp/src/Kafka/Kafka.Client/RequestType.cs   |  19 +-
 .../csharp/src/Kafka/Kafka.Client/Util/BitWorks.cs |  19 +-
 .../csharp/src/Kafka/Kafka.Client/Util/Crc32.cs    |  19 +-
 .../ZooKeeperClient.Watcher.cs                     |  14 +-
 clients/python/LICENSE                             | 203 +++++++++++++++++++++
 contrib/hadoop-consumer/LICENSE                    | 203 +++++++++++++++++++++
 contrib/hadoop-producer/LICENSE                    | 203 +++++++++++++++++++++
 16 files changed, 831 insertions(+), 18 deletions(-)
84c06d4285fd087a44df07684031d96a4ba249c5

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
a45af2f1ed30bd6586690076dc7523b303fa6168

 .gitignore | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
b1e3d250daaf0810c32384293b09f0791534b189

 clojure/leiningen/run_example.clj                     | 14 ++++++++++++++
 clojure/project.clj                                   | 14 ++++++++++++++
 clojure/resources/log4j.properties                    | 14 ++++++++++++++
 clojure/src/kafka/buffer.clj                          | 14 ++++++++++++++
 clojure/src/kafka/example.clj                         | 14 ++++++++++++++
 clojure/src/kafka/kafka.clj                           | 14 ++++++++++++++
 clojure/src/kafka/print.clj                           | 14 ++++++++++++++
 clojure/src/kafka/serializable.clj                    | 14 ++++++++++++++
 clojure/src/kafka/types.clj                           | 14 ++++++++++++++
 clojure/test/kafka/buffer_test.clj                    | 14 ++++++++++++++
 clojure/test/kafka/print_test.clj                     | 14 ++++++++++++++
 clojure/test/kafka/serializable_test.clj              | 14 ++++++++++++++
 cpp/build-aux/install-sh                              | 14 ++++++++++++++
 cpp/build-aux/ltmain.sh                               | 14 ++++++++++++++
 php/src/examples/autoloader.php                       | 17 +++++++++++++++++
 php/src/examples/consume.php                          | 17 +++++++++++++++++
 php/src/examples/produce.php                          | 17 +++++++++++++++++
 php/src/tests/Kafka/BoundedByteBuffer/ReceiveTest.php | 17 +++++++++++++++++
 php/src/tests/Kafka/BoundedByteBuffer/SendTest.php    | 17 +++++++++++++++++
 php/src/tests/Kafka/EncoderTest.php                   | 17 +++++++++++++++++
 php/src/tests/Kafka/FetchRequestTest.php              | 17 +++++++++++++++++
 php/src/tests/Kafka/MessageTest.php                   | 17 +++++++++++++++++
 php/src/tests/Kafka/ProducerTest.php                  | 17 +++++++++++++++++
 php/src/tests/bootstrap.php                           | 17 +++++++++++++++++
 ruby/lib/kafka.rb                                     | 14 ++++++++++++++
 ruby/lib/kafka/batch.rb                               | 14 ++++++++++++++
 ruby/lib/kafka/consumer.rb                            | 14 ++++++++++++++
 ruby/lib/kafka/error_codes.rb                         | 14 ++++++++++++++
 ruby/lib/kafka/io.rb                                  | 14 ++++++++++++++
 ruby/lib/kafka/message.rb                             | 14 ++++++++++++++
 ruby/lib/kafka/producer.rb                            | 14 ++++++++++++++
 ruby/lib/kafka/request_type.rb                        | 14 ++++++++++++++
 ruby/spec/batch_spec.rb                               | 14 ++++++++++++++
 ruby/spec/consumer_spec.rb                            | 14 ++++++++++++++
 ruby/spec/io_spec.rb                                  | 14 ++++++++++++++
 ruby/spec/kafka_spec.rb                               | 14 ++++++++++++++
 ruby/spec/message_spec.rb                             | 14 ++++++++++++++
 ruby/spec/producer_spec.rb                            | 14 ++++++++++++++
 ruby/spec/spec_helper.rb                              | 14 ++++++++++++++
 39 files changed, 576 insertions(+)
fa09aacdbdf0cd325edd28eb80cbd0f4b232ffc3

 bin/kafka-console-consumer-log4j.properties             | 14 ++++++++++++++
 bin/kafka-console-consumer.sh                           | 14 ++++++++++++++
 bin/kafka-console-producer.sh                           | 14 ++++++++++++++
 bin/kafka-consumer-perf-test.sh                         | 14 ++++++++++++++
 bin/kafka-consumer-shell.sh                             | 14 ++++++++++++++
 bin/kafka-producer-perf-test.sh                         | 14 ++++++++++++++
 bin/kafka-producer-shell.sh                             | 14 ++++++++++++++
 bin/kafka-replay-log-producer.sh                        | 14 ++++++++++++++
 bin/kafka-run-class.sh                                  | 14 ++++++++++++++
 bin/kafka-server-start.sh                               | 14 ++++++++++++++
 bin/kafka-server-stop.sh                                | 14 ++++++++++++++
 bin/kafka-simple-consumer-perf-test.sh                  | 14 ++++++++++++++
 bin/kafka-simple-consumer-shell.sh                      | 14 ++++++++++++++
 bin/zookeeper-server-start.sh                           | 16 +++++++++++++++-
 bin/zookeeper-server-stop.sh                            | 14 ++++++++++++++
 clients/clojure/leiningen/run_example.clj               | 14 ++++++++++++++
 clients/clojure/project.clj                             | 14 ++++++++++++++
 clients/clojure/resources/log4j.properties              | 14 ++++++++++++++
 clients/clojure/src/kafka/buffer.clj                    | 14 ++++++++++++++
 clients/clojure/src/kafka/example.clj                   | 14 ++++++++++++++
 clients/clojure/src/kafka/kafka.clj                     | 14 ++++++++++++++
 clients/clojure/src/kafka/print.clj                     | 14 ++++++++++++++
 clients/clojure/src/kafka/serializable.clj              | 14 ++++++++++++++
 clients/clojure/src/kafka/types.clj                     | 14 ++++++++++++++
 clients/clojure/test/kafka/buffer_test.clj              | 14 ++++++++++++++
 clients/clojure/test/kafka/print_test.clj               | 14 ++++++++++++++
 clients/clojure/test/kafka/serializable_test.clj        | 14 ++++++++++++++
 clients/cpp/build-aux/install-sh                        | 14 ++++++++++++++
 clients/cpp/build-aux/ltmain.sh                         | 14 ++++++++++++++
 clients/php/src/examples/autoloader.php                 | 17 +++++++++++++++++
 clients/php/src/examples/consume.php                    | 17 +++++++++++++++++
 clients/php/src/examples/produce.php                    | 17 +++++++++++++++++
 .../src/tests/Kafka/BoundedByteBuffer/ReceiveTest.php   | 17 +++++++++++++++++
 .../php/src/tests/Kafka/BoundedByteBuffer/SendTest.php  | 17 +++++++++++++++++
 clients/php/src/tests/Kafka/EncoderTest.php             | 17 +++++++++++++++++
 clients/php/src/tests/Kafka/FetchRequestTest.php        | 17 +++++++++++++++++
 clients/php/src/tests/Kafka/MessageTest.php             | 17 +++++++++++++++++
 clients/php/src/tests/Kafka/ProducerTest.php            | 17 +++++++++++++++++
 clients/php/src/tests/bootstrap.php                     | 17 +++++++++++++++++
 clients/ruby/lib/kafka.rb                               | 14 ++++++++++++++
 clients/ruby/lib/kafka/batch.rb                         | 14 ++++++++++++++
 clients/ruby/lib/kafka/consumer.rb                      | 14 ++++++++++++++
 clients/ruby/lib/kafka/error_codes.rb                   | 14 ++++++++++++++
 clients/ruby/lib/kafka/io.rb                            | 14 ++++++++++++++
 clients/ruby/lib/kafka/message.rb                       | 14 ++++++++++++++
 clients/ruby/lib/kafka/producer.rb                      | 14 ++++++++++++++
 clients/ruby/lib/kafka/request_type.rb                  | 14 ++++++++++++++
 clients/ruby/spec/batch_spec.rb                         | 14 ++++++++++++++
 clients/ruby/spec/consumer_spec.rb                      | 14 ++++++++++++++
 clients/ruby/spec/io_spec.rb                            | 14 ++++++++++++++
 clients/ruby/spec/kafka_spec.rb                         | 14 ++++++++++++++
 clients/ruby/spec/message_spec.rb                       | 14 ++++++++++++++
 clients/ruby/spec/producer_spec.rb                      | 14 ++++++++++++++
 clients/ruby/spec/spec_helper.rb                        | 14 ++++++++++++++
 config/consumer.properties                              | 14 ++++++++++++++
 config/log4j.properties                                 | 14 ++++++++++++++
 config/server.properties                                | 14 ++++++++++++++
 config/zookeeper.properties                             | 14 ++++++++++++++
 contrib/hadoop-consumer/copy-jars.sh                    | 14 ++++++++++++++
 contrib/hadoop-consumer/hadoop-setup.sh                 | 14 ++++++++++++++
 contrib/hadoop-consumer/run-class.sh                    | 14 ++++++++++++++
 contrib/hadoop-consumer/test/test.properties            | 14 ++++++++++++++
 core/src/test/resources/log4j.properties                | 14 ++++++++++++++
 core/src/test/scala/other/kafka.log4j.properties        | 14 ++++++++++++++
 examples/bin/java-producer-consumer-demo.sh             | 14 ++++++++++++++
 examples/bin/java-simple-consumer-demo.sh               | 14 ++++++++++++++
 project/build.properties                                | 14 ++++++++++++++
 system_test/embedded_consumer/bin/run-test.sh           | 14 ++++++++++++++
 .../config/blacklisttest.consumer.properties            | 14 ++++++++++++++
 .../embedded_consumer/config/consumer.properties        | 14 ++++++++++++++
 .../embedded_consumer/config/mirror_producer.properties | 14 ++++++++++++++
 .../embedded_consumer/config/server_source1.properties  | 14 ++++++++++++++
 .../embedded_consumer/config/server_source2.properties  | 14 ++++++++++++++
 .../embedded_consumer/config/server_source3.properties  | 14 ++++++++++++++
 .../embedded_consumer/config/server_target1.properties  | 14 ++++++++++++++
 .../embedded_consumer/config/server_target2.properties  | 14 ++++++++++++++
 .../config/whitelisttest.consumer.properties            | 14 ++++++++++++++
 .../config/zookeeper_source.properties                  | 14 ++++++++++++++
 .../config/zookeeper_target.properties                  | 14 ++++++++++++++
 system_test/producer_perf/bin/run-compression-test.sh   | 14 ++++++++++++++
 system_test/producer_perf/bin/run-test.sh               | 14 ++++++++++++++
 system_test/producer_perf/config/server.properties      | 14 ++++++++++++++
 system_test/producer_perf/config/zookeeper.properties   | 14 ++++++++++++++
 83 files changed, 1193 insertions(+), 1 deletion(-)
3f52d9f13fa40c300fef8cd0e1f315cff31dc7d7

 clojure/leiningen/run_example.clj                     | 14 --------------
 clojure/project.clj                                   | 14 --------------
 clojure/resources/log4j.properties                    | 14 --------------
 clojure/src/kafka/buffer.clj                          | 14 --------------
 clojure/src/kafka/example.clj                         | 14 --------------
 clojure/src/kafka/kafka.clj                           | 14 --------------
 clojure/src/kafka/print.clj                           | 14 --------------
 clojure/src/kafka/serializable.clj                    | 14 --------------
 clojure/src/kafka/types.clj                           | 14 --------------
 clojure/test/kafka/buffer_test.clj                    | 14 --------------
 clojure/test/kafka/print_test.clj                     | 14 --------------
 clojure/test/kafka/serializable_test.clj              | 14 --------------
 cpp/build-aux/install-sh                              | 14 --------------
 cpp/build-aux/ltmain.sh                               | 14 --------------
 php/src/examples/autoloader.php                       | 17 -----------------
 php/src/examples/consume.php                          | 17 -----------------
 php/src/examples/produce.php                          | 17 -----------------
 php/src/tests/Kafka/BoundedByteBuffer/ReceiveTest.php | 17 -----------------
 php/src/tests/Kafka/BoundedByteBuffer/SendTest.php    | 17 -----------------
 php/src/tests/Kafka/EncoderTest.php                   | 17 -----------------
 php/src/tests/Kafka/FetchRequestTest.php              | 17 -----------------
 php/src/tests/Kafka/MessageTest.php                   | 17 -----------------
 php/src/tests/Kafka/ProducerTest.php                  | 17 -----------------
 php/src/tests/bootstrap.php                           | 17 -----------------
 ruby/lib/kafka.rb                                     | 14 --------------
 ruby/lib/kafka/batch.rb                               | 14 --------------
 ruby/lib/kafka/consumer.rb                            | 14 --------------
 ruby/lib/kafka/error_codes.rb                         | 14 --------------
 ruby/lib/kafka/io.rb                                  | 14 --------------
 ruby/lib/kafka/message.rb                             | 14 --------------
 ruby/lib/kafka/producer.rb                            | 14 --------------
 ruby/lib/kafka/request_type.rb                        | 14 --------------
 ruby/spec/batch_spec.rb                               | 14 --------------
 ruby/spec/consumer_spec.rb                            | 14 --------------
 ruby/spec/io_spec.rb                                  | 14 --------------
 ruby/spec/kafka_spec.rb                               | 14 --------------
 ruby/spec/message_spec.rb                             | 14 --------------
 ruby/spec/producer_spec.rb                            | 14 --------------
 ruby/spec/spec_helper.rb                              | 14 --------------
 39 files changed, 576 deletions(-)
f34dfc002d7e1aa6b57eb7fa28ee3c928a96e968

 bin/kafka-console-consumer-log4j.properties             | 14 --------------
 bin/kafka-console-consumer.sh                           | 14 --------------
 bin/kafka-console-producer.sh                           | 14 --------------
 bin/kafka-consumer-perf-test.sh                         | 14 --------------
 bin/kafka-consumer-shell.sh                             | 14 --------------
 bin/kafka-producer-perf-test.sh                         | 14 --------------
 bin/kafka-producer-shell.sh                             | 14 --------------
 bin/kafka-replay-log-producer.sh                        | 14 --------------
 bin/kafka-run-class.sh                                  | 14 --------------
 bin/kafka-server-start.sh                               | 14 --------------
 bin/kafka-server-stop.sh                                | 14 --------------
 bin/kafka-simple-consumer-perf-test.sh                  | 14 --------------
 bin/kafka-simple-consumer-shell.sh                      | 14 --------------
 bin/zookeeper-server-start.sh                           | 16 +---------------
 bin/zookeeper-server-stop.sh                            | 14 --------------
 clients/clojure/leiningen/run_example.clj               | 14 --------------
 clients/clojure/project.clj                             | 14 --------------
 clients/clojure/resources/log4j.properties              | 14 --------------
 clients/clojure/src/kafka/buffer.clj                    | 14 --------------
 clients/clojure/src/kafka/example.clj                   | 14 --------------
 clients/clojure/src/kafka/kafka.clj                     | 14 --------------
 clients/clojure/src/kafka/print.clj                     | 14 --------------
 clients/clojure/src/kafka/serializable.clj              | 14 --------------
 clients/clojure/src/kafka/types.clj                     | 14 --------------
 clients/clojure/test/kafka/buffer_test.clj              | 14 --------------
 clients/clojure/test/kafka/print_test.clj               | 14 --------------
 clients/clojure/test/kafka/serializable_test.clj        | 14 --------------
 clients/cpp/build-aux/install-sh                        | 14 --------------
 clients/cpp/build-aux/ltmain.sh                         | 14 --------------
 clients/php/src/examples/autoloader.php                 | 17 -----------------
 clients/php/src/examples/consume.php                    | 17 -----------------
 clients/php/src/examples/produce.php                    | 17 -----------------
 .../src/tests/Kafka/BoundedByteBuffer/ReceiveTest.php   | 17 -----------------
 .../php/src/tests/Kafka/BoundedByteBuffer/SendTest.php  | 17 -----------------
 clients/php/src/tests/Kafka/EncoderTest.php             | 17 -----------------
 clients/php/src/tests/Kafka/FetchRequestTest.php        | 17 -----------------
 clients/php/src/tests/Kafka/MessageTest.php             | 17 -----------------
 clients/php/src/tests/Kafka/ProducerTest.php            | 17 -----------------
 clients/php/src/tests/bootstrap.php                     | 17 -----------------
 clients/ruby/lib/kafka.rb                               | 14 --------------
 clients/ruby/lib/kafka/batch.rb                         | 14 --------------
 clients/ruby/lib/kafka/consumer.rb                      | 14 --------------
 clients/ruby/lib/kafka/error_codes.rb                   | 14 --------------
 clients/ruby/lib/kafka/io.rb                            | 14 --------------
 clients/ruby/lib/kafka/message.rb                       | 14 --------------
 clients/ruby/lib/kafka/producer.rb                      | 14 --------------
 clients/ruby/lib/kafka/request_type.rb                  | 14 --------------
 clients/ruby/spec/batch_spec.rb                         | 14 --------------
 clients/ruby/spec/consumer_spec.rb                      | 14 --------------
 clients/ruby/spec/io_spec.rb                            | 14 --------------
 clients/ruby/spec/kafka_spec.rb                         | 14 --------------
 clients/ruby/spec/message_spec.rb                       | 14 --------------
 clients/ruby/spec/producer_spec.rb                      | 14 --------------
 clients/ruby/spec/spec_helper.rb                        | 14 --------------
 config/consumer.properties                              | 14 --------------
 config/log4j.properties                                 | 14 --------------
 config/server.properties                                | 14 --------------
 config/zookeeper.properties                             | 14 --------------
 contrib/hadoop-consumer/copy-jars.sh                    | 14 --------------
 contrib/hadoop-consumer/hadoop-setup.sh                 | 14 --------------
 contrib/hadoop-consumer/run-class.sh                    | 14 --------------
 contrib/hadoop-consumer/test/test.properties            | 14 --------------
 core/src/test/resources/log4j.properties                | 14 --------------
 core/src/test/scala/other/kafka.log4j.properties        | 14 --------------
 examples/bin/java-producer-consumer-demo.sh             | 14 --------------
 examples/bin/java-simple-consumer-demo.sh               | 14 --------------
 project/build.properties                                | 14 --------------
 system_test/embedded_consumer/bin/run-test.sh           | 14 --------------
 .../config/blacklisttest.consumer.properties            | 14 --------------
 .../embedded_consumer/config/consumer.properties        | 14 --------------
 .../embedded_consumer/config/mirror_producer.properties | 14 --------------
 .../embedded_consumer/config/server_source1.properties  | 14 --------------
 .../embedded_consumer/config/server_source2.properties  | 14 --------------
 .../embedded_consumer/config/server_source3.properties  | 14 --------------
 .../embedded_consumer/config/server_target1.properties  | 14 --------------
 .../embedded_consumer/config/server_target2.properties  | 14 --------------
 .../config/whitelisttest.consumer.properties            | 14 --------------
 .../config/zookeeper_source.properties                  | 14 --------------
 .../config/zookeeper_target.properties                  | 14 --------------
 system_test/producer_perf/bin/run-compression-test.sh   | 14 --------------
 system_test/producer_perf/bin/run-test.sh               | 14 --------------
 system_test/producer_perf/config/server.properties      | 14 --------------
 system_test/producer_perf/config/zookeeper.properties   | 14 --------------
 83 files changed, 1 insertion(+), 1193 deletions(-)
63bef40b5906dc78e6bd304b470ed42764f143f4

 clojure/leiningen/run_example.clj                     | 14 ++++++++++++++
 clojure/project.clj                                   | 14 ++++++++++++++
 clojure/resources/log4j.properties                    | 14 ++++++++++++++
 clojure/src/kafka/buffer.clj                          | 14 ++++++++++++++
 clojure/src/kafka/example.clj                         | 14 ++++++++++++++
 clojure/src/kafka/kafka.clj                           | 14 ++++++++++++++
 clojure/src/kafka/print.clj                           | 14 ++++++++++++++
 clojure/src/kafka/serializable.clj                    | 14 ++++++++++++++
 clojure/src/kafka/types.clj                           | 14 ++++++++++++++
 clojure/test/kafka/buffer_test.clj                    | 14 ++++++++++++++
 clojure/test/kafka/print_test.clj                     | 14 ++++++++++++++
 clojure/test/kafka/serializable_test.clj              | 14 ++++++++++++++
 cpp/build-aux/install-sh                              | 14 ++++++++++++++
 cpp/build-aux/ltmain.sh                               | 14 ++++++++++++++
 php/src/examples/autoloader.php                       | 17 +++++++++++++++++
 php/src/examples/consume.php                          | 17 +++++++++++++++++
 php/src/examples/produce.php                          | 17 +++++++++++++++++
 php/src/tests/Kafka/BoundedByteBuffer/ReceiveTest.php | 17 +++++++++++++++++
 php/src/tests/Kafka/BoundedByteBuffer/SendTest.php    | 17 +++++++++++++++++
 php/src/tests/Kafka/EncoderTest.php                   | 17 +++++++++++++++++
 php/src/tests/Kafka/FetchRequestTest.php              | 17 +++++++++++++++++
 php/src/tests/Kafka/MessageTest.php                   | 17 +++++++++++++++++
 php/src/tests/Kafka/ProducerTest.php                  | 17 +++++++++++++++++
 php/src/tests/bootstrap.php                           | 17 +++++++++++++++++
 ruby/lib/kafka.rb                                     | 14 ++++++++++++++
 ruby/lib/kafka/batch.rb                               | 14 ++++++++++++++
 ruby/lib/kafka/consumer.rb                            | 14 ++++++++++++++
 ruby/lib/kafka/error_codes.rb                         | 14 ++++++++++++++
 ruby/lib/kafka/io.rb                                  | 14 ++++++++++++++
 ruby/lib/kafka/message.rb                             | 14 ++++++++++++++
 ruby/lib/kafka/producer.rb                            | 14 ++++++++++++++
 ruby/lib/kafka/request_type.rb                        | 14 ++++++++++++++
 ruby/spec/batch_spec.rb                               | 14 ++++++++++++++
 ruby/spec/consumer_spec.rb                            | 14 ++++++++++++++
 ruby/spec/io_spec.rb                                  | 14 ++++++++++++++
 ruby/spec/kafka_spec.rb                               | 14 ++++++++++++++
 ruby/spec/message_spec.rb                             | 14 ++++++++++++++
 ruby/spec/producer_spec.rb                            | 14 ++++++++++++++
 ruby/spec/spec_helper.rb                              | 14 ++++++++++++++
 39 files changed, 576 insertions(+)
a99becbe491680346c47b0bf8af738e1729de348

 .gitignore                                              | 14 --------------
 bin/kafka-console-consumer-log4j.properties             | 14 ++++++++++++++
 bin/kafka-console-consumer.sh                           | 14 ++++++++++++++
 bin/kafka-console-producer.sh                           | 14 ++++++++++++++
 bin/kafka-consumer-perf-test.sh                         | 14 ++++++++++++++
 bin/kafka-consumer-shell.sh                             | 14 ++++++++++++++
 bin/kafka-producer-perf-test.sh                         | 14 ++++++++++++++
 bin/kafka-producer-shell.sh                             | 14 ++++++++++++++
 bin/kafka-replay-log-producer.sh                        | 14 ++++++++++++++
 bin/kafka-run-class.sh                                  | 14 ++++++++++++++
 bin/kafka-server-start.sh                               | 14 ++++++++++++++
 bin/kafka-server-stop.sh                                | 14 ++++++++++++++
 bin/kafka-simple-consumer-perf-test.sh                  | 14 ++++++++++++++
 bin/kafka-simple-consumer-shell.sh                      | 14 ++++++++++++++
 bin/zookeeper-server-start.sh                           | 16 +++++++++++++++-
 bin/zookeeper-server-stop.sh                            | 14 ++++++++++++++
 clients/clojure/leiningen/run_example.clj               | 14 ++++++++++++++
 clients/clojure/project.clj                             | 14 ++++++++++++++
 clients/clojure/resources/log4j.properties              | 14 ++++++++++++++
 clients/clojure/src/kafka/buffer.clj                    | 14 ++++++++++++++
 clients/clojure/src/kafka/example.clj                   | 14 ++++++++++++++
 clients/clojure/src/kafka/kafka.clj                     | 14 ++++++++++++++
 clients/clojure/src/kafka/print.clj                     | 14 ++++++++++++++
 clients/clojure/src/kafka/serializable.clj              | 14 ++++++++++++++
 clients/clojure/src/kafka/types.clj                     | 14 ++++++++++++++
 clients/clojure/test/kafka/buffer_test.clj              | 14 ++++++++++++++
 clients/clojure/test/kafka/print_test.clj               | 14 ++++++++++++++
 clients/clojure/test/kafka/serializable_test.clj        | 14 ++++++++++++++
 clients/cpp/build-aux/install-sh                        | 14 ++++++++++++++
 clients/cpp/build-aux/ltmain.sh                         | 14 ++++++++++++++
 clients/php/src/examples/autoloader.php                 | 17 +++++++++++++++++
 clients/php/src/examples/consume.php                    | 17 +++++++++++++++++
 clients/php/src/examples/produce.php                    | 17 +++++++++++++++++
 .../src/tests/Kafka/BoundedByteBuffer/ReceiveTest.php   | 17 +++++++++++++++++
 .../php/src/tests/Kafka/BoundedByteBuffer/SendTest.php  | 17 +++++++++++++++++
 clients/php/src/tests/Kafka/EncoderTest.php             | 17 +++++++++++++++++
 clients/php/src/tests/Kafka/FetchRequestTest.php        | 17 +++++++++++++++++
 clients/php/src/tests/Kafka/MessageTest.php             | 17 +++++++++++++++++
 clients/php/src/tests/Kafka/ProducerTest.php            | 17 +++++++++++++++++
 clients/php/src/tests/bootstrap.php                     | 17 +++++++++++++++++
 clients/ruby/lib/kafka.rb                               | 14 ++++++++++++++
 clients/ruby/lib/kafka/batch.rb                         | 14 ++++++++++++++
 clients/ruby/lib/kafka/consumer.rb                      | 14 ++++++++++++++
 clients/ruby/lib/kafka/error_codes.rb                   | 14 ++++++++++++++
 clients/ruby/lib/kafka/io.rb                            | 14 ++++++++++++++
 clients/ruby/lib/kafka/message.rb                       | 14 ++++++++++++++
 clients/ruby/lib/kafka/producer.rb                      | 14 ++++++++++++++
 clients/ruby/lib/kafka/request_type.rb                  | 14 ++++++++++++++
 clients/ruby/spec/batch_spec.rb                         | 14 ++++++++++++++
 clients/ruby/spec/consumer_spec.rb                      | 14 ++++++++++++++
 clients/ruby/spec/io_spec.rb                            | 14 ++++++++++++++
 clients/ruby/spec/kafka_spec.rb                         | 14 ++++++++++++++
 clients/ruby/spec/message_spec.rb                       | 14 ++++++++++++++
 clients/ruby/spec/producer_spec.rb                      | 14 ++++++++++++++
 clients/ruby/spec/spec_helper.rb                        | 14 ++++++++++++++
 config/consumer.properties                              | 14 ++++++++++++++
 config/log4j.properties                                 | 14 ++++++++++++++
 config/server.properties                                | 14 ++++++++++++++
 config/zookeeper.properties                             | 14 ++++++++++++++
 contrib/hadoop-consumer/copy-jars.sh                    | 14 ++++++++++++++
 contrib/hadoop-consumer/hadoop-setup.sh                 | 14 ++++++++++++++
 contrib/hadoop-consumer/run-class.sh                    | 14 ++++++++++++++
 contrib/hadoop-consumer/test/test.properties            | 14 ++++++++++++++
 core/src/test/resources/log4j.properties                | 14 ++++++++++++++
 core/src/test/scala/other/kafka.log4j.properties        | 14 ++++++++++++++
 examples/bin/java-producer-consumer-demo.sh             | 14 ++++++++++++++
 examples/bin/java-simple-consumer-demo.sh               | 14 ++++++++++++++
 project/build.properties                                | 14 ++++++++++++++
 system_test/embedded_consumer/bin/run-test.sh           | 14 ++++++++++++++
 .../config/blacklisttest.consumer.properties            | 14 ++++++++++++++
 .../embedded_consumer/config/consumer.properties        | 14 ++++++++++++++
 .../embedded_consumer/config/mirror_producer.properties | 14 ++++++++++++++
 .../embedded_consumer/config/server_source1.properties  | 14 ++++++++++++++
 .../embedded_consumer/config/server_source2.properties  | 14 ++++++++++++++
 .../embedded_consumer/config/server_source3.properties  | 14 ++++++++++++++
 .../embedded_consumer/config/server_target1.properties  | 14 ++++++++++++++
 .../embedded_consumer/config/server_target2.properties  | 14 ++++++++++++++
 .../config/whitelisttest.consumer.properties            | 14 ++++++++++++++
 .../config/zookeeper_source.properties                  | 14 ++++++++++++++
 .../config/zookeeper_target.properties                  | 14 ++++++++++++++
 system_test/producer_perf/bin/run-compression-test.sh   | 14 ++++++++++++++
 system_test/producer_perf/bin/run-test.sh               | 14 ++++++++++++++
 system_test/producer_perf/config/server.properties      | 14 ++++++++++++++
 system_test/producer_perf/config/zookeeper.properties   | 14 ++++++++++++++
 84 files changed, 1193 insertions(+), 15 deletions(-)
79092880fdce34005b5de8d4fb2c80b1d5e7533f

 KEYS | 137 +++++++++++++++++++++++++++++++++++++++++--------------------------
 1 file changed, 84 insertions(+), 53 deletions(-)
e2a91de7a212a0f5fd18686b0e1dff659a1fe1bb

 KEYS | 69 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 69 insertions(+)
a1193810b62504ff2e3b4a931bc8c5109a7a530b

 project/build/KafkaProject.scala | 23 +----------------------
 1 file changed, 1 insertion(+), 22 deletions(-)
4de899c24d29b86b2faf51040976ae795e12fea8

 .../consumer/ZookeeperConsumerConnector.scala      | 29 ++++++++++++++++------
 1 file changed, 21 insertions(+), 8 deletions(-)
472723f1cccb8cb1e74ef52e47ccb2fbdc6c3e3d

 perf/.classpath                                    |  10 -
 perf/.project                                      |  17 -
 perf/README.md                                     |  23 --
 perf/lib/jopt-simple-3.1.jar                       | Bin 50801 -> 0 bytes
 perf/report-html/js/exporting.js                   |  21 --
 perf/report-html/js/highcharts.js                  | 135 --------
 perf/report-html/js/kafka.js                       |  91 -----
 perf/report-html/report.html                       |  43 ---
 perf/run-simulator.sh                              |  35 --
 .../main/java/kafka/perf/KafkaPerfSimulator.java   | 385 ---------------------
 .../main/java/kafka/perf/KafkaSimulatorMXBean.java |  28 --
 perf/src/main/java/kafka/perf/PerfTimer.java       | 149 --------
 .../kafka/perf/consumer/SimplePerfConsumer.java    | 109 ------
 .../main/java/kafka/perf/jmx/BrokerJmxClient.java  |  49 ---
 .../main/java/kafka/perf/producer/Producer.java    | 102 ------
 perf/util-bin/remote-kafka-env.sh                  |  31 --
 perf/util-bin/run-fetchsize-test.sh                |  15 -
 perf/util-bin/run-msgsize-test.sh                  |  15 -
 perf/util-bin/run-numconsumer-sustained.sh         |  15 -
 perf/util-bin/run-numconsumer-test.sh              |  21 --
 perf/util-bin/run-numproducer-single-topic.sh      |  15 -
 perf/util-bin/run-numproducer-test.sh              |  15 -
 perf/util-bin/run-numtopic-test.sh                 |  15 -
 23 files changed, 1339 deletions(-)
101af58f6c0dc007d53819eb5f3281c60d1fa7bc

 CONTRIBUTORS                                            | 10 ----------
 .../kafka/common/InvalidMessageSizeException.scala      | 17 +++++++++++++++++
 .../kafka/common/NoBrokersForPartitionException.scala   | 17 +++++++++++++++++
 .../kafka/message/ByteBufferBackedInputStream.scala     | 17 +++++++++++++++++
 .../main/scala/kafka/tools/ConsumerOffsetChecker.scala  | 16 ++++++++++++++++
 core/src/main/scala/kafka/tools/ReplayLogProducer.scala | 17 +++++++++++++++++
 .../unit/kafka/integration/LogCorruptionTest.scala      | 17 +++++++++++++++++
 .../scala/unit/kafka/message/CompressionUtilsTest.scala | 17 +++++++++++++++++
 8 files changed, 118 insertions(+), 10 deletions(-)
0a9aea7160cc3b0e493608d843998300dd0ec495

 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 core/src/main/scala/kafka/utils/Mx4jLoader.scala   | 74 ++++++++++++++++++++++
 2 files changed, 76 insertions(+), 1 deletion(-)
881eaf14e5a8d8396c897b158209080b558be377

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 1 +
 1 file changed, 1 insertion(+)
f7b2819bff31bb58c4fd32f847e2659b23ecda4a

 bin/kafka-run-class.sh   |   2 +-
 lib/sbt-launch-0.7.7.jar | Bin 952175 -> 0 bytes
 lib/sbt-launch.jar       | Bin 0 -> 920993 bytes
 project/build.properties |   2 +-
 sbt                      |   2 +-
 5 files changed, 3 insertions(+), 3 deletions(-)
4f284428640f172976f2ece9e696b5cf95907b5f

 .../scala/kafka/server/KafkaServerStartable.scala  | 99 +++++++++++++++-------
 1 file changed, 70 insertions(+), 29 deletions(-)
bac6d9c3fa0e650aa1af99959fe63a8dd33971c8

 .../kafka/javaapi/producer/SyncProducerTest.scala  | 76 ----------------------
 .../unit/kafka/producer/SyncProducerTest.scala     | 71 --------------------
 2 files changed, 147 deletions(-)
dd62e77f90f5f6fb9050627a9cfa40b35dae67b1

 .../scala/kafka/producer/BrokerPartitionInfo.scala |   9 ++
 .../kafka/producer/ConfigBrokerPartitionInfo.scala |   6 +-
 core/src/main/scala/kafka/producer/Producer.scala  |  96 +++++++++----
 .../main/scala/kafka/producer/ProducerConfig.scala |  14 +-
 .../kafka/producer/ZKBrokerPartitionInfo.scala     | 151 +++++++++++++--------
 .../unit/kafka/javaapi/producer/ProducerTest.scala |   9 +-
 .../scala/unit/kafka/producer/ProducerTest.scala   |  11 +-
 7 files changed, 199 insertions(+), 97 deletions(-)
513c4a59d8335e019a6742f731ce3fd5d6a433ff

 project/build.properties | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
a7b4731947b605d8433c91e967aaecacd5340aa4

 .../scala/kafka/consumer/ConsoleConsumer.scala     |   8 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    |   4 +-
 .../main/scala/kafka/network/SocketServer.scala    | 134 ++++++++++-----------
 .../main/scala/kafka/network/Transmission.scala    |   2 +-
 .../main/scala/kafka/utils/IteratorTemplate.scala  |   2 +-
 .../kafka/integration/LazyInitProducerTest.scala   |   8 +-
 .../unit/kafka/integration/PrimitiveApiTest.scala  |  16 +--
 .../javaapi/integration/PrimitiveApiTest.scala     |  16 +--
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   2 +-
 .../unit/kafka/message/FileMessageSetTest.scala    |   4 +-
 10 files changed, 98 insertions(+), 98 deletions(-)
4c2d121b26ad9c2efa7d6b23bff7278a54c5e3ed

 bin/kafka-run-class.sh   |   2 +-
 lib/sbt-launch-0.7.7.jar | Bin 0 -> 952175 bytes
 lib/sbt-launch.jar       | Bin 920993 -> 0 bytes
 project/build.properties |   2 +-
 sbt                      |   2 +-
 5 files changed, 3 insertions(+), 3 deletions(-)
59a5c3215a4736f8c6ccbaace3bf99ec935e738d

 bin/kafka-console-producer.sh                      |   4 +
 .../scala/kafka/producer/ConsoleProducer.scala     | 151 +++++++++++++++++++++
 2 files changed, 155 insertions(+)
031a559e89134497d0e3e9a366321fbdb3976b99

 core/src/test/scala/unit/kafka/network/SocketServerTest.scala | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)
42c2241cfb1308956b87477dad6e71a63d0ab40f

 bin/kafka-server-start.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
596c8d1af7403782c54c1e0814fff526f21cb8df

 .../scala/kafka/consumer/ConsumerIterator.scala    |  4 +-
 .../scala/kafka/consumer/ConsumerTopicStat.scala   | 52 ++++++++++++++++++++++
 .../scala/kafka/consumer/KafkaMessageStream.scala  |  5 ++-
 .../consumer/ZookeeperConsumerConnector.scala      |  2 +-
 4 files changed, 59 insertions(+), 4 deletions(-)
efc7a8a0cd16c759cee54b8621bbfdbd4e7bb2a9

 core/src/main/scala/kafka/message/FileMessageSet.scala    |  3 +++
 core/src/main/scala/kafka/network/SocketServerStats.scala | 12 ++++++++++++
 core/src/main/scala/kafka/utils/Utils.scala               |  4 ++++
 3 files changed, 19 insertions(+)
da35513245797a491f8908c2c9ef7f66341bcbd2

 core/src/main/scala/kafka/producer/DefaultPartitioner.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
1b0feb6345b07136c8a7807962c4a7aa0691d777

 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 4 ++--
 core/src/main/scala/kafka/producer/async/ProducerSendThread.scala  | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)
4092ceeb5ae5c5e2546c824ccab7478a8ab19c68

 .../scala/kafka/consumer/ConsoleConsumer.scala     |  2 +-
 .../scala/kafka/consumer/ConsumerConnector.scala   |  5 +-
 .../scala/kafka/consumer/ConsumerIterator.scala    | 23 +++++----
 .../scala/kafka/consumer/KafkaMessageStream.scala  | 13 +++--
 .../consumer/ZookeeperConsumerConnector.scala      | 17 ++++---
 .../kafka/javaapi/consumer/ConsumerConnector.java  | 10 +++-
 .../consumer/ZookeeperConsumerConnector.scala      | 20 ++++++--
 .../src/main/scala/kafka/tools/ConsumerShell.scala |  7 +--
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  2 +-
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |  3 +-
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 58 ++++++++++++++--------
 .../consumer/ZookeeperConsumerConnectorTest.scala  | 56 ++++++++++++++-------
 .../src/main/java/kafka/examples/Consumer.java     | 20 ++++----
 project/build/KafkaProject.scala                   |  2 +
 14 files changed, 154 insertions(+), 84 deletions(-)
b10fe7952c0faba18342875440d05404e7252a59

 ruby/kafka-rb.gemspec | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
61433bf0a2afc4d7da9bcde79c504aab434f4d79

 clients/ruby/kafka-rb.gemspec | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
5fbac30f865dd0829ea965b5a5a62b8b8f695e2a

 .../scala/kafka/consumer/ZookeeperConsumerConnector.scala   |  2 +-
 core/src/main/scala/kafka/log/LogManager.scala              |  4 ++--
 core/src/main/scala/kafka/producer/Producer.scala           |  2 ++
 core/src/main/scala/kafka/server/KafkaServer.scala          |  2 +-
 core/src/main/scala/kafka/utils/KafkaScheduler.scala        | 13 ++++++++++---
 5 files changed, 16 insertions(+), 7 deletions(-)
81bf84a359c8da1b7007336441ca23171d7f0b94

 .../Kafka/Kafka.Client/Cfg/AsyncProducerConfig.cs  | 15 ++++++-----
 .../Kafka/Kafka.Client/Cfg/BrokerPartitionInfo.cs  | 15 ++++++-----
 .../Cfg/BrokerPartitionInfoCollection.cs           | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Cfg/Consumer.cs      | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Cfg/ConsumerConfig.cs   | 15 ++++++-----
 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs | 15 ++++++-----
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  | 15 ++++++-----
 .../Kafka.Client/Cfg/KafkaClientConfiguration.cs   | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Cfg/KafkaServer.cs   | 31 +++++++++++-----------
 .../src/Kafka/Kafka.Client/Cfg/ProducerConfig.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Cfg/SyncProducerConfig.cs   | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Cfg/ZKConfig.cs      | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Cfg/ZooKeeperServers.cs | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Cluster/Broker.cs    | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Cluster/Cluster.cs   | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Cluster/Partition.cs | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 15 ++++++-----
 .../Kafka.Client/Consumers/ConsumerIterator.cs     | 15 ++++++-----
 .../Consumers/ConsumerIteratorState.cs             | 16 ++++++-----
 .../Kafka.Client/Consumers/FetchedDataChunk.cs     | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Consumers/Fetcher.cs | 15 ++++++-----
 .../Kafka.Client/Consumers/FetcherRunnable.cs      | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  | 15 ++++++-----
 .../Kafka.Client/Consumers/IConsumerConnector.cs   | 15 ++++++-----
 .../Kafka.Client/Consumers/KafkaMessageStream.cs   | 15 ++++++-----
 .../Kafka.Client/Consumers/PartitionTopicInfo.cs   | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Consumers/TopicCount.cs | 15 ++++++-----
 .../Consumers/ZookeeperConsumerConnector.cs        | 15 ++++++-----
 .../Exceptions/ConsumerTimeoutException.cs         | 22 ++++++++++++---
 .../Kafka.Client/Exceptions/KafkaException.cs      | 15 ++++++-----
 .../Exceptions/MessageSizeTooLargeException.cs     | 19 ++++++++++++-
 .../Exceptions/ZKRebalancerException.cs            | 22 ++++++++++++---
 .../Kafka.Client/Exceptions/ZooKeeperException.cs  | 19 ++++++++++++-
 .../Exceptions/ZooKeeperTimeoutException.cs        | 19 ++++++++++++-
 csharp/src/Kafka/Kafka.Client/KafkaClientBase.cs   | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/KafkaConnection.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Messages/BoundedBuffer.cs   | 15 ++++++-----
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Messages/Message.cs  | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  | 15 ++++++-----
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  | 15 ++++++-----
 .../Producers/Async/AsyncProducerPool.cs           | 15 ++++++-----
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs | 15 ++++++-----
 .../Producers/Async/ICallbackHandler.cs            | 15 ++++++-----
 .../Kafka.Client/Producers/Async/MessageSent.cs    | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Producers/IProducer.cs  | 15 ++++++-----
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  | 15 ++++++-----
 .../Partitioning/ConfigBrokerPartitionInfo.cs      | 15 ++++++-----
 .../Producers/Partitioning/DefaultPartitioner.cs   | 15 ++++++-----
 .../Producers/Partitioning/IBrokerPartitionInfo.cs | 15 ++++++-----
 .../Producers/Partitioning/IPartitioner.cs         | 15 ++++++-----
 .../Partitioning/ZKBrokerPartitionInfo.cs          | 15 ++++++-----
 .../Kafka.Client/Producers/Producer.StrMsg.cs      | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Producers/ProducerData.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   | 15 ++++++-----
 .../Kafka.Client/Producers/ProducerPoolData.cs     | 15 ++++++-----
 .../Kafka/Kafka.Client/Producers/ProducerTypes.cs  | 15 ++++++-----
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   | 15 ++++++-----
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    | 15 ++++++-----
 .../Producers/Sync/SyncProducerPool.cs             | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/RequestContext.cs    | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/AbstractRequest.cs | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    | 15 ++++++-----
 .../Kafka.Client/Requests/MultiFetchRequest.cs     | 15 ++++++-----
 .../Kafka.Client/Requests/MultiProducerRequest.cs  | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/RequestTypes.cs    | 15 ++++++-----
 .../Kafka.Client/Serialization/DefaultEncoder.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Serialization/IEncoder.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Serialization/IWritable.cs  | 15 ++++++-----
 .../Serialization/KafkaBinaryReader.cs             | 15 ++++++-----
 .../Serialization/KafkaBinaryWriter.cs             | 15 ++++++-----
 .../Kafka.Client/Serialization/StringEncoder.cs    | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Utils/BitWorks.cs    | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Utils/Crc32Hasher.cs | 18 ++++++++++++-
 .../src/Kafka/Kafka.Client/Utils/ErrorMapping.cs   | 16 ++++++-----
 csharp/src/Kafka/Kafka.Client/Utils/Extensions.cs  | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Utils/Guard.cs       | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Utils/KafkaScheduler.cs | 15 ++++++-----
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Utils/ZKGroupDirs.cs | 16 ++++++-----
 .../Kafka/Kafka.Client/Utils/ZKGroupTopicDirs.cs   | 15 ++++++-----
 csharp/src/Kafka/Kafka.Client/Utils/ZkUtils.cs     | 15 ++++++-----
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  | 15 ++++++-----
 .../Events/ChildChangedEventItem.cs                | 15 ++++++-----
 .../Events/DataChangedEventItem.cs                 | 15 ++++++-----
 .../Events/ZooKeeperChildChangedEventArgs.cs       | 15 ++++++-----
 .../Events/ZooKeeperDataChangedEventArgs.cs        | 15 ++++++-----
 .../Events/ZooKeeperEventArgs.cs                   | 15 ++++++-----
 .../Events/ZooKeeperEventTypes.cs                  | 15 ++++++-----
 .../Events/ZooKeeperSessionCreatedEventArgs.cs     | 15 ++++++-----
 .../Events/ZooKeeperStateChangedEventArgs.cs       | 15 ++++++-----
 .../ZooKeeperIntegration/IZooKeeperClient.cs       | 15 ++++++-----
 .../ZooKeeperIntegration/IZooKeeperConnection.cs   | 15 ++++++-----
 .../ZooKeeperIntegration/IZooKeeperSerializer.cs   | 15 ++++++-----
 .../Listeners/BrokerTopicsListener.cs              | 15 ++++++-----
 .../Listeners/IZooKeeperChildListener.cs           | 15 ++++++-----
 .../Listeners/IZooKeeperDataListener.cs            | 15 ++++++-----
 .../Listeners/IZooKeeperStateListener.cs           | 15 ++++++-----
 .../Listeners/ZKRebalancerListener.cs              | 15 ++++++-----
 .../Listeners/ZKSessionExpireListener.cs           | 15 ++++++-----
 .../ZooKeeperIntegration/ZooKeeperClient.cs        | 15 ++++++-----
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    | 15 ++++++-----
 .../ZooKeeperStringSerializer.cs                   | 15 ++++++-----
 .../ConsumerRebalancingTests.cs                    | 15 ++++++-----
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 15 ++++++-----
 .../IntegrationFixtureBase.cs                      | 15 ++++++-----
 .../KafkaIntegrationTest.cs                        | 15 ++++++-----
 .../MockAlwaysZeroPartitioner.cs                   | 21 ++++++++++++---
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 15 ++++++-----
 .../Properties/AssemblyInfo.cs                     | 19 ++++++++++++-
 .../Kafka.Client.IntegrationTests/TestHelper.cs    | 15 ++++++-----
 .../TestMultipleBrokersHelper.cs                   | 15 ++++++-----
 .../Kafka.Client.IntegrationTests/TestsSetup.cs    | 15 ++++++-----
 .../ZKBrokerPartitionInfoTests.cs                  | 15 ++++++-----
 .../ZooKeeperAwareProducerTests.cs                 | 15 ++++++-----
 .../ZooKeeperClientTests.cs                        | 15 ++++++-----
 .../ZooKeeperConnectionTests.cs                    | 15 ++++++-----
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    | 15 ++++++-----
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs | 15 ++++++-----
 .../Producers/PartitioningTests.cs                 | 15 ++++++-----
 .../Request/FetchRequestTests.cs                   | 15 ++++++-----
 .../Request/MultiFetchRequestTests.cs              | 15 ++++++-----
 .../Request/MultiProducerRequestTests.cs           | 15 ++++++-----
 .../Request/OffsetRequestTests.cs                  | 15 ++++++-----
 .../Request/ProducerRequestTests.cs                | 15 ++++++-----
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs | 15 ++++++-----
 129 files changed, 1121 insertions(+), 872 deletions(-)
d772600c7b79d84d332aa2b7d37512b47fd7d7ae

 .../Kafka/Kafka.Client/Cfg/AsyncProducerConfig.cs  | 15 ++++++-----
 .../Kafka/Kafka.Client/Cfg/BrokerPartitionInfo.cs  | 15 ++++++-----
 .../Cfg/BrokerPartitionInfoCollection.cs           | 15 ++++++-----
 .../csharp/src/Kafka/Kafka.Client/Cfg/Consumer.cs  | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Cfg/ConsumerConfig.cs   | 15 ++++++-----
 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs | 15 ++++++-----
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  | 15 ++++++-----
 .../Kafka.Client/Cfg/KafkaClientConfiguration.cs   | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Cfg/KafkaServer.cs      | 31 +++++++++++-----------
 .../src/Kafka/Kafka.Client/Cfg/ProducerConfig.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Cfg/SyncProducerConfig.cs   | 15 ++++++-----
 .../csharp/src/Kafka/Kafka.Client/Cfg/ZKConfig.cs  | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Cfg/ZooKeeperServers.cs | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Cluster/Broker.cs       | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Cluster/Cluster.cs      | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Cluster/Partition.cs    | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 15 ++++++-----
 .../Kafka.Client/Consumers/ConsumerIterator.cs     | 15 ++++++-----
 .../Consumers/ConsumerIteratorState.cs             | 16 ++++++-----
 .../Kafka.Client/Consumers/FetchedDataChunk.cs     | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Consumers/Fetcher.cs    | 15 ++++++-----
 .../Kafka.Client/Consumers/FetcherRunnable.cs      | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  | 15 ++++++-----
 .../Kafka.Client/Consumers/IConsumerConnector.cs   | 15 ++++++-----
 .../Kafka.Client/Consumers/KafkaMessageStream.cs   | 15 ++++++-----
 .../Kafka.Client/Consumers/PartitionTopicInfo.cs   | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Consumers/TopicCount.cs | 15 ++++++-----
 .../Consumers/ZookeeperConsumerConnector.cs        | 15 ++++++-----
 .../Exceptions/ConsumerTimeoutException.cs         | 22 ++++++++++++---
 .../Kafka.Client/Exceptions/KafkaException.cs      | 15 ++++++-----
 .../Exceptions/MessageSizeTooLargeException.cs     | 19 ++++++++++++-
 .../Exceptions/ZKRebalancerException.cs            | 22 ++++++++++++---
 .../Kafka.Client/Exceptions/ZooKeeperException.cs  | 19 ++++++++++++-
 .../Exceptions/ZooKeeperTimeoutException.cs        | 19 ++++++++++++-
 .../src/Kafka/Kafka.Client/KafkaClientBase.cs      | 15 ++++++-----
 .../src/Kafka/Kafka.Client/KafkaConnection.cs      | 15 ++++++-----
 .../Kafka/Kafka.Client/Messages/BoundedBuffer.cs   | 15 ++++++-----
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Messages/Message.cs     | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  | 15 ++++++-----
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  | 15 ++++++-----
 .../Producers/Async/AsyncProducerPool.cs           | 15 ++++++-----
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs | 15 ++++++-----
 .../Producers/Async/ICallbackHandler.cs            | 15 ++++++-----
 .../Kafka.Client/Producers/Async/MessageSent.cs    | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Producers/IProducer.cs  | 15 ++++++-----
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  | 15 ++++++-----
 .../Partitioning/ConfigBrokerPartitionInfo.cs      | 15 ++++++-----
 .../Producers/Partitioning/DefaultPartitioner.cs   | 15 ++++++-----
 .../Producers/Partitioning/IBrokerPartitionInfo.cs | 15 ++++++-----
 .../Producers/Partitioning/IPartitioner.cs         | 15 ++++++-----
 .../Partitioning/ZKBrokerPartitionInfo.cs          | 15 ++++++-----
 .../Kafka.Client/Producers/Producer.StrMsg.cs      | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Producers/ProducerData.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   | 15 ++++++-----
 .../Kafka.Client/Producers/ProducerPoolData.cs     | 15 ++++++-----
 .../Kafka/Kafka.Client/Producers/ProducerTypes.cs  | 15 ++++++-----
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   | 15 ++++++-----
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    | 15 ++++++-----
 .../Producers/Sync/SyncProducerPool.cs             | 15 ++++++-----
 .../src/Kafka/Kafka.Client/RequestContext.cs       | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/AbstractRequest.cs | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    | 15 ++++++-----
 .../Kafka.Client/Requests/MultiFetchRequest.cs     | 15 ++++++-----
 .../Kafka.Client/Requests/MultiProducerRequest.cs  | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs | 15 ++++++-----
 .../Kafka/Kafka.Client/Requests/RequestTypes.cs    | 15 ++++++-----
 .../Kafka.Client/Serialization/DefaultEncoder.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Serialization/IEncoder.cs   | 15 ++++++-----
 .../Kafka/Kafka.Client/Serialization/IWritable.cs  | 15 ++++++-----
 .../Serialization/KafkaBinaryReader.cs             | 15 ++++++-----
 .../Serialization/KafkaBinaryWriter.cs             | 15 ++++++-----
 .../Kafka.Client/Serialization/StringEncoder.cs    | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Utils/BitWorks.cs       | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Utils/Crc32Hasher.cs    | 18 ++++++++++++-
 .../src/Kafka/Kafka.Client/Utils/ErrorMapping.cs   | 16 ++++++-----
 .../src/Kafka/Kafka.Client/Utils/Extensions.cs     | 15 ++++++-----
 .../csharp/src/Kafka/Kafka.Client/Utils/Guard.cs   | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Utils/KafkaScheduler.cs | 15 ++++++-----
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   | 15 ++++++-----
 .../src/Kafka/Kafka.Client/Utils/ZKGroupDirs.cs    | 16 ++++++-----
 .../Kafka/Kafka.Client/Utils/ZKGroupTopicDirs.cs   | 15 ++++++-----
 .../csharp/src/Kafka/Kafka.Client/Utils/ZkUtils.cs | 15 ++++++-----
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  | 15 ++++++-----
 .../Events/ChildChangedEventItem.cs                | 15 ++++++-----
 .../Events/DataChangedEventItem.cs                 | 15 ++++++-----
 .../Events/ZooKeeperChildChangedEventArgs.cs       | 15 ++++++-----
 .../Events/ZooKeeperDataChangedEventArgs.cs        | 15 ++++++-----
 .../Events/ZooKeeperEventArgs.cs                   | 15 ++++++-----
 .../Events/ZooKeeperEventTypes.cs                  | 15 ++++++-----
 .../Events/ZooKeeperSessionCreatedEventArgs.cs     | 15 ++++++-----
 .../Events/ZooKeeperStateChangedEventArgs.cs       | 15 ++++++-----
 .../ZooKeeperIntegration/IZooKeeperClient.cs       | 15 ++++++-----
 .../ZooKeeperIntegration/IZooKeeperConnection.cs   | 15 ++++++-----
 .../ZooKeeperIntegration/IZooKeeperSerializer.cs   | 15 ++++++-----
 .../Listeners/BrokerTopicsListener.cs              | 15 ++++++-----
 .../Listeners/IZooKeeperChildListener.cs           | 15 ++++++-----
 .../Listeners/IZooKeeperDataListener.cs            | 15 ++++++-----
 .../Listeners/IZooKeeperStateListener.cs           | 15 ++++++-----
 .../Listeners/ZKRebalancerListener.cs              | 15 ++++++-----
 .../Listeners/ZKSessionExpireListener.cs           | 15 ++++++-----
 .../ZooKeeperIntegration/ZooKeeperClient.cs        | 15 ++++++-----
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    | 15 ++++++-----
 .../ZooKeeperStringSerializer.cs                   | 15 ++++++-----
 .../ConsumerRebalancingTests.cs                    | 15 ++++++-----
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 15 ++++++-----
 .../IntegrationFixtureBase.cs                      | 15 ++++++-----
 .../KafkaIntegrationTest.cs                        | 15 ++++++-----
 .../MockAlwaysZeroPartitioner.cs                   | 21 ++++++++++++---
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 15 ++++++-----
 .../Properties/AssemblyInfo.cs                     | 19 ++++++++++++-
 .../Kafka.Client.IntegrationTests/TestHelper.cs    | 15 ++++++-----
 .../TestMultipleBrokersHelper.cs                   | 15 ++++++-----
 .../Kafka.Client.IntegrationTests/TestsSetup.cs    | 15 ++++++-----
 .../ZKBrokerPartitionInfoTests.cs                  | 15 ++++++-----
 .../ZooKeeperAwareProducerTests.cs                 | 15 ++++++-----
 .../ZooKeeperClientTests.cs                        | 15 ++++++-----
 .../ZooKeeperConnectionTests.cs                    | 15 ++++++-----
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    | 15 ++++++-----
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs | 15 ++++++-----
 .../Producers/PartitioningTests.cs                 | 15 ++++++-----
 .../Request/FetchRequestTests.cs                   | 15 ++++++-----
 .../Request/MultiFetchRequestTests.cs              | 15 ++++++-----
 .../Request/MultiProducerRequestTests.cs           | 15 ++++++-----
 .../Request/OffsetRequestTests.cs                  | 15 ++++++-----
 .../Request/ProducerRequestTests.cs                | 15 ++++++-----
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs | 15 ++++++-----
 129 files changed, 1121 insertions(+), 872 deletions(-)
9c024cb0ea248769abb022567863f1931beb0958

 csharp/LICENSE                                     |   4 +-
 csharp/lib/StyleCop/Microsoft.StyleCop.Targets     | 109 +++
 csharp/lib/StyleCop/Settings.StyleCop              |  32 +
 .../Kafka/Kafka.Client/Cfg/AsyncProducerConfig.cs  |  73 ++
 .../Kafka/Kafka.Client/Cfg/BrokerPartitionInfo.cs  |  71 ++
 .../Cfg/BrokerPartitionInfoCollection.cs           |  51 ++
 csharp/src/Kafka/Kafka.Client/Cfg/Consumer.cs      | 135 ++++
 .../src/Kafka/Kafka.Client/Cfg/ConsumerConfig.cs   |  71 ++
 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs |  39 +
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  |  31 +
 .../Kafka.Client/Cfg/KafkaClientConfiguration.cs   |  92 +++
 csharp/src/Kafka/Kafka.Client/Cfg/KafkaServer.cs   |  51 ++
 .../src/Kafka/Kafka.Client/Cfg/ProducerConfig.cs   |  93 +++
 .../Kafka/Kafka.Client/Cfg/SyncProducerConfig.cs   |  65 ++
 csharp/src/Kafka/Kafka.Client/Cfg/ZKConfig.cs      |  42 +
 .../src/Kafka/Kafka.Client/Cfg/ZooKeeperServers.cs |  44 +
 csharp/src/Kafka/Kafka.Client/Cluster/Broker.cs    |  67 ++
 csharp/src/Kafka/Kafka.Client/Cluster/Cluster.cs   | 129 +++
 csharp/src/Kafka/Kafka.Client/Cluster/Partition.cs | 146 ++++
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 287 +++++++
 .../Kafka.Client/Consumers/ConsumerIterator.cs     | 197 +++++
 .../Consumers/ConsumerIteratorState.cs             |  26 +
 .../Kafka.Client/Consumers/FetchedDataChunk.cs     |  57 ++
 csharp/src/Kafka/Kafka.Client/Consumers/Fetcher.cs | 169 ++++
 .../Kafka.Client/Consumers/FetcherRunnable.cs      | 189 +++++
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  |  83 ++
 .../Kafka.Client/Consumers/IConsumerConnector.cs   |  44 +
 .../Kafka.Client/Consumers/KafkaMessageStream.cs   |  52 ++
 .../Kafka.Client/Consumers/PartitionTopicInfo.cs   | 197 +++++
 .../src/Kafka/Kafka.Client/Consumers/TopicCount.cs | 110 +++
 .../Consumers/ZookeeperConsumerConnector.cs        | 322 ++++++++
 .../Exceptions/ConsumerTimeoutException.cs         |  11 +
 .../Kafka.Client/Exceptions/KafkaException.cs      |  99 +++
 .../Exceptions/MessageSizeTooLargeException.cs     |   8 +
 .../Exceptions/ZKRebalancerException.cs            |  19 +
 .../Kafka.Client/Exceptions/ZooKeeperException.cs  |  28 +
 .../Exceptions/ZooKeeperTimeoutException.cs        |  17 +
 csharp/src/Kafka/Kafka.Client/Kafka.Client.csproj  | 297 +++++--
 csharp/src/Kafka/Kafka.Client/KafkaClientBase.cs   |  43 +
 csharp/src/Kafka/Kafka.Client/KafkaConnection.cs   | 500 +++++++-----
 .../Kafka/Kafka.Client/Messages/BoundedBuffer.cs   |  37 +
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 179 +++++
 csharp/src/Kafka/Kafka.Client/Messages/Message.cs  | 252 ++++++
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  |  90 +++
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  | 170 ++++
 .../Producers/Async/AsyncProducerPool.cs           | 206 +++++
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs |  78 ++
 .../Producers/Async/ICallbackHandler.cs            |  34 +
 .../Kafka.Client/Producers/Async/MessageSent.cs    |  30 +
 .../src/Kafka/Kafka.Client/Producers/IProducer.cs  |  45 ++
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  |  56 ++
 .../Partitioning/ConfigBrokerPartitionInfo.cs      | 120 +++
 .../Producers/Partitioning/DefaultPartitioner.cs   |  49 ++
 .../Producers/Partitioning/IBrokerPartitionInfo.cs |  48 ++
 .../Producers/Partitioning/IPartitioner.cs         |  35 +
 .../Partitioning/ZKBrokerPartitionInfo.cs          | 336 ++++++++
 .../Kafka.Client/Producers/Producer.StrMsg.cs      |  95 +++
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   | 329 ++++++++
 .../Kafka/Kafka.Client/Producers/ProducerData.cs   |  94 +++
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   | 179 +++++
 .../Kafka.Client/Producers/ProducerPoolData.cs     |  64 ++
 .../Kafka/Kafka.Client/Producers/ProducerTypes.cs  |  28 +
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   |  58 ++
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    | 118 +++
 .../Producers/Sync/SyncProducerPool.cs             | 209 +++++
 .../Kafka/Kafka.Client/Properties/AssemblyInfo.cs  |  54 +-
 csharp/src/Kafka/Kafka.Client/RequestContext.cs    |  89 +-
 .../Kafka/Kafka.Client/Requests/AbstractRequest.cs |  60 ++
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    | 155 ++++
 .../Kafka.Client/Requests/MultiFetchRequest.cs     | 108 +++
 .../Kafka.Client/Requests/MultiProducerRequest.cs  | 144 ++++
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   | 135 ++++
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs | 156 ++++
 .../Kafka/Kafka.Client/Requests/RequestTypes.cs    |  52 ++
 .../Kafka.Client/Serialization/DefaultEncoder.cs   |  40 +
 .../Kafka/Kafka.Client/Serialization/IEncoder.cs   |  40 +
 .../Kafka/Kafka.Client/Serialization/IWritable.cs  |  42 +
 .../Serialization/KafkaBinaryReader.cs             | 130 +++
 .../Serialization/KafkaBinaryWriter.cs             | 126 +++
 .../Kafka.Client/Serialization/StringEncoder.cs    |  42 +
 csharp/src/Kafka/Kafka.Client/Utils/BitWorks.cs    |  82 ++
 csharp/src/Kafka/Kafka.Client/Utils/Crc32Hasher.cs | 122 +++
 .../src/Kafka/Kafka.Client/Utils/ErrorMapping.cs   |  27 +
 csharp/src/Kafka/Kafka.Client/Utils/Extensions.cs  |  48 ++
 csharp/src/Kafka/Kafka.Client/Utils/Guard.cs       |  95 +++
 .../src/Kafka/Kafka.Client/Utils/KafkaScheduler.cs |  85 ++
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   |  57 ++
 csharp/src/Kafka/Kafka.Client/Utils/ZKGroupDirs.cs |  37 +
 .../Kafka/Kafka.Client/Utils/ZKGroupTopicDirs.cs   |  31 +
 csharp/src/Kafka/Kafka.Client/Utils/ZkUtils.cs     | 146 ++++
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  |  43 +
 .../Events/ChildChangedEventItem.cs                | 112 +++
 .../Events/DataChangedEventItem.cs                 | 160 ++++
 .../Events/ZooKeeperChildChangedEventArgs.cs       |  59 ++
 .../Events/ZooKeeperDataChangedEventArgs.cs        |  87 ++
 .../Events/ZooKeeperEventArgs.cs                   |  55 ++
 .../Events/ZooKeeperEventTypes.cs                  |  34 +
 .../Events/ZooKeeperSessionCreatedEventArgs.cs     |  45 ++
 .../Events/ZooKeeperStateChangedEventArgs.cs       |  54 ++
 .../ZooKeeperIntegration/IZooKeeperClient.cs       | 468 +++++++++++
 .../ZooKeeperIntegration/IZooKeeperConnection.cs   | 163 ++++
 .../ZooKeeperIntegration/IZooKeeperSerializer.cs   |  47 ++
 .../Listeners/BrokerTopicsListener.cs              | 256 ++++++
 .../Listeners/IZooKeeperChildListener.cs           |  42 +
 .../Listeners/IZooKeeperDataListener.cs            |  48 ++
 .../Listeners/IZooKeeperStateListener.cs           |  41 +
 .../Listeners/ZKRebalancerListener.cs              | 367 +++++++++
 .../Listeners/ZKSessionExpireListener.cs           |  85 ++
 .../ZooKeeperClient.Watcher.cs                     | 680 ++++++++++++++++
 .../ZooKeeperIntegration/ZooKeeperClient.cs        | 891 +++++++++++++++++++++
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    | 326 ++++++++
 .../ZooKeeperStringSerializer.cs                   |  71 ++
 csharp/src/Kafka/Kafka.FxCop                       | 104 +++
 csharp/src/Kafka/Kafka.sln                         |  83 +-
 .../Tests/Kafka.Client.IntegrationTests/App.config |  27 +
 .../Config/Debug/App.config                        |  27 +
 .../Config/Integration/App.config                  |  21 +
 .../ConsumerRebalancingTests.cs                    | 267 ++++++
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 309 +++++++
 .../IntegrationFixtureBase.cs                      |  45 ++
 .../Kafka.Client.IntegrationTests.csproj           | 199 +++--
 .../KafkaIntegrationTest.cs                        | 689 +++++++++++-----
 .../Kafka.Client.IntegrationTests/Log4Net.config   |  39 +
 .../MockAlwaysZeroPartitioner.cs                   |  19 +
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 244 ++++++
 .../Properties/AssemblyInfo.cs                     |  71 +-
 .../Kafka.Client.IntegrationTests/TestHelper.cs    |  50 ++
 .../TestMultipleBrokersHelper.cs                   |  80 ++
 .../Kafka.Client.IntegrationTests/TestsSetup.cs    |  34 +
 .../ZKBrokerPartitionInfoTests.cs                  | 455 +++++++++++
 .../ZooKeeperAwareProducerTests.cs                 | 238 ++++++
 .../ZooKeeperClientTests.cs                        | 365 +++++++++
 .../ZooKeeperConnectionTests.cs                    | 120 +++
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   | 176 ++--
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    | 105 +++
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs | 198 +++--
 .../Producers/PartitioningTests.cs                 |  69 ++
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs  |   1 -
 .../Request/FetchRequestTests.cs                   | 161 ++--
 .../Request/MultiFetchRequestTests.cs              | 163 ++--
 .../Request/MultiProducerRequestTests.cs           | 154 ++--
 .../Request/OffsetRequestTests.cs                  | 155 ++--
 .../Request/ProducerRequestTests.cs                | 162 ++--
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs | 224 +++---
 144 files changed, 16997 insertions(+), 1333 deletions(-)
dc66fd9a4b6e77cacb5c15dee18a404a0bb89408

 clients/csharp/LICENSE                             |   4 +-
 .../csharp/lib/StyleCop/Microsoft.StyleCop.Targets | 109 +++
 clients/csharp/lib/StyleCop/Settings.StyleCop      |  32 +
 .../Kafka/Kafka.Client/Cfg/AsyncProducerConfig.cs  |  73 ++
 .../Kafka/Kafka.Client/Cfg/BrokerPartitionInfo.cs  |  71 ++
 .../Cfg/BrokerPartitionInfoCollection.cs           |  51 ++
 .../csharp/src/Kafka/Kafka.Client/Cfg/Consumer.cs  | 135 ++++
 .../src/Kafka/Kafka.Client/Cfg/ConsumerConfig.cs   |  71 ++
 .../Kafka.Client/Cfg/IAsyncProducerConfigShared.cs |  39 +
 .../Kafka.Client/Cfg/ISyncProducerConfigShared.cs  |  31 +
 .../Kafka.Client/Cfg/KafkaClientConfiguration.cs   |  92 +++
 .../src/Kafka/Kafka.Client/Cfg/KafkaServer.cs      |  51 ++
 .../src/Kafka/Kafka.Client/Cfg/ProducerConfig.cs   |  93 +++
 .../Kafka/Kafka.Client/Cfg/SyncProducerConfig.cs   |  65 ++
 .../csharp/src/Kafka/Kafka.Client/Cfg/ZKConfig.cs  |  42 +
 .../src/Kafka/Kafka.Client/Cfg/ZooKeeperServers.cs |  44 +
 .../src/Kafka/Kafka.Client/Cluster/Broker.cs       |  67 ++
 .../src/Kafka/Kafka.Client/Cluster/Cluster.cs      | 129 +++
 .../src/Kafka/Kafka.Client/Cluster/Partition.cs    | 146 ++++
 .../src/Kafka/Kafka.Client/Consumers/Consumer.cs   | 287 +++++++
 .../Kafka.Client/Consumers/ConsumerIterator.cs     | 197 +++++
 .../Consumers/ConsumerIteratorState.cs             |  26 +
 .../Kafka.Client/Consumers/FetchedDataChunk.cs     |  57 ++
 .../src/Kafka/Kafka.Client/Consumers/Fetcher.cs    | 169 ++++
 .../Kafka.Client/Consumers/FetcherRunnable.cs      | 189 +++++
 .../src/Kafka/Kafka.Client/Consumers/IConsumer.cs  |  83 ++
 .../Kafka.Client/Consumers/IConsumerConnector.cs   |  44 +
 .../Kafka.Client/Consumers/KafkaMessageStream.cs   |  52 ++
 .../Kafka.Client/Consumers/PartitionTopicInfo.cs   | 197 +++++
 .../src/Kafka/Kafka.Client/Consumers/TopicCount.cs | 110 +++
 .../Consumers/ZookeeperConsumerConnector.cs        | 322 ++++++++
 .../Exceptions/ConsumerTimeoutException.cs         |  11 +
 .../Kafka.Client/Exceptions/KafkaException.cs      |  99 +++
 .../Exceptions/MessageSizeTooLargeException.cs     |   8 +
 .../Exceptions/ZKRebalancerException.cs            |  19 +
 .../Kafka.Client/Exceptions/ZooKeeperException.cs  |  28 +
 .../Exceptions/ZooKeeperTimeoutException.cs        |  17 +
 .../src/Kafka/Kafka.Client/Kafka.Client.csproj     | 297 +++++--
 .../src/Kafka/Kafka.Client/KafkaClientBase.cs      |  43 +
 .../src/Kafka/Kafka.Client/KafkaConnection.cs      | 500 +++++++-----
 .../Kafka/Kafka.Client/Messages/BoundedBuffer.cs   |  37 +
 .../Kafka.Client/Messages/BufferedMessageSet.cs    | 179 +++++
 .../src/Kafka/Kafka.Client/Messages/Message.cs     | 252 ++++++
 .../src/Kafka/Kafka.Client/Messages/MessageSet.cs  |  90 +++
 .../Kafka.Client/Producers/Async/AsyncProducer.cs  | 170 ++++
 .../Producers/Async/AsyncProducerPool.cs           | 206 +++++
 .../Kafka.Client/Producers/Async/IAsyncProducer.cs |  78 ++
 .../Producers/Async/ICallbackHandler.cs            |  34 +
 .../Kafka.Client/Producers/Async/MessageSent.cs    |  30 +
 .../src/Kafka/Kafka.Client/Producers/IProducer.cs  |  45 ++
 .../Kafka/Kafka.Client/Producers/IProducerPool.cs  |  56 ++
 .../Partitioning/ConfigBrokerPartitionInfo.cs      | 120 +++
 .../Producers/Partitioning/DefaultPartitioner.cs   |  49 ++
 .../Producers/Partitioning/IBrokerPartitionInfo.cs |  48 ++
 .../Producers/Partitioning/IPartitioner.cs         |  35 +
 .../Partitioning/ZKBrokerPartitionInfo.cs          | 336 ++++++++
 .../Kafka.Client/Producers/Producer.StrMsg.cs      |  95 +++
 .../src/Kafka/Kafka.Client/Producers/Producer.cs   | 329 ++++++++
 .../Kafka/Kafka.Client/Producers/ProducerData.cs   |  94 +++
 .../Kafka/Kafka.Client/Producers/ProducerPool.cs   | 179 +++++
 .../Kafka.Client/Producers/ProducerPoolData.cs     |  64 ++
 .../Kafka/Kafka.Client/Producers/ProducerTypes.cs  |  28 +
 .../Kafka.Client/Producers/Sync/ISyncProducer.cs   |  58 ++
 .../Kafka.Client/Producers/Sync/SyncProducer.cs    | 118 +++
 .../Producers/Sync/SyncProducerPool.cs             | 209 +++++
 .../Kafka/Kafka.Client/Properties/AssemblyInfo.cs  |  54 +-
 .../src/Kafka/Kafka.Client/RequestContext.cs       |  89 +-
 .../Kafka/Kafka.Client/Requests/AbstractRequest.cs |  60 ++
 .../Kafka/Kafka.Client/Requests/FetchRequest.cs    | 155 ++++
 .../Kafka.Client/Requests/MultiFetchRequest.cs     | 108 +++
 .../Kafka.Client/Requests/MultiProducerRequest.cs  | 144 ++++
 .../Kafka/Kafka.Client/Requests/OffsetRequest.cs   | 135 ++++
 .../Kafka/Kafka.Client/Requests/ProducerRequest.cs | 156 ++++
 .../Kafka/Kafka.Client/Requests/RequestTypes.cs    |  52 ++
 .../Kafka.Client/Serialization/DefaultEncoder.cs   |  40 +
 .../Kafka/Kafka.Client/Serialization/IEncoder.cs   |  40 +
 .../Kafka/Kafka.Client/Serialization/IWritable.cs  |  42 +
 .../Serialization/KafkaBinaryReader.cs             | 130 +++
 .../Serialization/KafkaBinaryWriter.cs             | 126 +++
 .../Kafka.Client/Serialization/StringEncoder.cs    |  42 +
 .../src/Kafka/Kafka.Client/Utils/BitWorks.cs       |  82 ++
 .../src/Kafka/Kafka.Client/Utils/Crc32Hasher.cs    | 122 +++
 .../src/Kafka/Kafka.Client/Utils/ErrorMapping.cs   |  27 +
 .../src/Kafka/Kafka.Client/Utils/Extensions.cs     |  48 ++
 .../csharp/src/Kafka/Kafka.Client/Utils/Guard.cs   |  95 +++
 .../src/Kafka/Kafka.Client/Utils/KafkaScheduler.cs |  85 ++
 .../Kafka/Kafka.Client/Utils/ReflectionHelper.cs   |  57 ++
 .../src/Kafka/Kafka.Client/Utils/ZKGroupDirs.cs    |  37 +
 .../Kafka/Kafka.Client/Utils/ZKGroupTopicDirs.cs   |  31 +
 .../csharp/src/Kafka/Kafka.Client/Utils/ZkUtils.cs | 146 ++++
 .../Kafka.Client/ZooKeeperAwareKafkaClientBase.cs  |  43 +
 .../Events/ChildChangedEventItem.cs                | 112 +++
 .../Events/DataChangedEventItem.cs                 | 160 ++++
 .../Events/ZooKeeperChildChangedEventArgs.cs       |  59 ++
 .../Events/ZooKeeperDataChangedEventArgs.cs        |  87 ++
 .../Events/ZooKeeperEventArgs.cs                   |  55 ++
 .../Events/ZooKeeperEventTypes.cs                  |  34 +
 .../Events/ZooKeeperSessionCreatedEventArgs.cs     |  45 ++
 .../Events/ZooKeeperStateChangedEventArgs.cs       |  54 ++
 .../ZooKeeperIntegration/IZooKeeperClient.cs       | 468 +++++++++++
 .../ZooKeeperIntegration/IZooKeeperConnection.cs   | 163 ++++
 .../ZooKeeperIntegration/IZooKeeperSerializer.cs   |  47 ++
 .../Listeners/BrokerTopicsListener.cs              | 256 ++++++
 .../Listeners/IZooKeeperChildListener.cs           |  42 +
 .../Listeners/IZooKeeperDataListener.cs            |  48 ++
 .../Listeners/IZooKeeperStateListener.cs           |  41 +
 .../Listeners/ZKRebalancerListener.cs              | 367 +++++++++
 .../Listeners/ZKSessionExpireListener.cs           |  85 ++
 .../ZooKeeperClient.Watcher.cs                     | 680 ++++++++++++++++
 .../ZooKeeperIntegration/ZooKeeperClient.cs        | 891 +++++++++++++++++++++
 .../ZooKeeperIntegration/ZooKeeperConnection.cs    | 326 ++++++++
 .../ZooKeeperStringSerializer.cs                   |  71 ++
 clients/csharp/src/Kafka/Kafka.FxCop               | 104 +++
 clients/csharp/src/Kafka/Kafka.sln                 |  83 +-
 .../Tests/Kafka.Client.IntegrationTests/App.config |  27 +
 .../Config/Debug/App.config                        |  27 +
 .../Config/Integration/App.config                  |  21 +
 .../ConsumerRebalancingTests.cs                    | 267 ++++++
 .../Kafka.Client.IntegrationTests/ConsumerTests.cs | 309 +++++++
 .../IntegrationFixtureBase.cs                      |  45 ++
 .../Kafka.Client.IntegrationTests.csproj           | 199 +++--
 .../KafkaIntegrationTest.cs                        | 689 +++++++++++-----
 .../Kafka.Client.IntegrationTests/Log4Net.config   |  39 +
 .../MockAlwaysZeroPartitioner.cs                   |  19 +
 .../Kafka.Client.IntegrationTests/ProducerTests.cs | 244 ++++++
 .../Properties/AssemblyInfo.cs                     |  71 +-
 .../Kafka.Client.IntegrationTests/TestHelper.cs    |  50 ++
 .../TestMultipleBrokersHelper.cs                   |  80 ++
 .../Kafka.Client.IntegrationTests/TestsSetup.cs    |  34 +
 .../ZKBrokerPartitionInfoTests.cs                  | 455 +++++++++++
 .../ZooKeeperAwareProducerTests.cs                 | 238 ++++++
 .../ZooKeeperClientTests.cs                        | 365 +++++++++
 .../ZooKeeperConnectionTests.cs                    | 120 +++
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   | 176 ++--
 .../Tests/Kafka.Client.Tests/MessageSetTests.cs    | 105 +++
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs | 198 +++--
 .../Producers/PartitioningTests.cs                 |  69 ++
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs  |   1 -
 .../Request/FetchRequestTests.cs                   | 161 ++--
 .../Request/MultiFetchRequestTests.cs              | 163 ++--
 .../Request/MultiProducerRequestTests.cs           | 154 ++--
 .../Request/OffsetRequestTests.cs                  | 155 ++--
 .../Request/ProducerRequestTests.cs                | 162 ++--
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs | 224 +++---
 144 files changed, 16997 insertions(+), 1333 deletions(-)
8efb536aff3fefda0e7f683c5daf6814d0f27c2c

 core/src/main/scala/kafka/log/Log.scala | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)
54f49314afbc1e13ff511f152e9b292ffaf9104d

 core/src/main/scala/kafka/log/LogManager.scala     | 60 +++++++++++++++++-----
 core/src/main/scala/kafka/server/KafkaConfig.scala |  3 ++
 .../test/scala/unit/kafka/log/LogManagerTest.scala | 50 +++++++++++++++++-
 3 files changed, 99 insertions(+), 14 deletions(-)
6af334d69ade5f4f21a89b8b2a8e0e881ed51359

 .../scala/kafka/tools/ConsumerOffsetChecker.scala  | 147 +++++++++++++++++++++
 1 file changed, 147 insertions(+)
d42450715cf8ac6774fc68e36c1751e34f29549b

 .../src/main/java/kafka/etl/KafkaETLContext.java         | 16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)
c8e507aba42cd5572ea237c1db0654164209b3c8

 core/src/main/scala/kafka/tools/ConsumerShell.scala | 2 +-
 core/src/main/scala/kafka/tools/ProducerShell.scala | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)
ec21a5e841bf561275f1095deb7e8b38ad9ca953

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
c247dfa8844f6d112755f21918dc1515db37a05e

 core/src/main/scala/kafka/consumer/ConsoleConsumer.scala | 13 ++++++++++---
 1 file changed, 10 insertions(+), 3 deletions(-)
92b1dd925256455b97200a5c77d4e83ba50c4b86

 core/src/test/resources/log4j.properties | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
d72b388236fb9b1541c79bd7e31687795e137b25

 core/src/main/scala/kafka/tools/DumpLogSegments.scala | 9 +++------
 1 file changed, 3 insertions(+), 6 deletions(-)
b5ea7c9055bbc7dd0b1a655b9340f48a7e795d4d

 .../async/IllegalQueueStateException.scala         | 25 ++++++++++++++++++++++
 1 file changed, 25 insertions(+)
72544aa51ee07d573922498f33783aa636de7fea

 core/src/main/scala/kafka/consumer/FetcherRunnable.scala    |  5 +++--
 .../scala/kafka/consumer/ZookeeperConsumerConnector.scala   | 13 +++----------
 2 files changed, 6 insertions(+), 12 deletions(-)
bf30ae996f2ec08ae97f61a0eff0c50bb8ce8067

 .../scala/kafka/consumer/PartitionTopicInfo.scala   |  2 +-
 .../scala/kafka/message/ByteBufferMessageSet.scala  | 21 +++++----------------
 .../kafka/message/ByteBufferMessageSetTest.scala    | 20 ++++++++++++++------
 3 files changed, 20 insertions(+), 23 deletions(-)
4cdc982e22870f0e4d993d479036a3571ad3a2bc

 core/src/main/scala/kafka/tools/ProducerPerformance.scala | 12 +-----------
 system_test/embedded_consumer/bin/run-test.sh             |  2 +-
 system_test/producer_perf/bin/run-compression-test.sh     |  2 +-
 system_test/producer_perf/bin/run-test.sh                 |  2 +-
 4 files changed, 4 insertions(+), 14 deletions(-)
c79c4f6f94328da5ca5090037093453311b0bfa4

 .../scala/kafka/producer/async/AsyncProducer.scala | 42 +++++++++++-----------
 .../kafka/producer/async/DefaultEventHandler.scala | 33 ++++++++++-------
 .../kafka/producer/async/ProducerSendThread.scala  |  6 ++++
 3 files changed, 48 insertions(+), 33 deletions(-)
e311cbb6bb1735ecd1d94be0fb1e6fca9fa99f75

 core/lib/zookeeper-3.3.3.jar     | Bin 1023866 -> 0 bytes
 project/build/KafkaProject.scala |   4 ++++
 2 files changed, 4 insertions(+)
2e05fbfa221fcec5ef6b57490e005759363966ee

 .../main/scala/kafka/tools/DumpLogSegments.scala   | 53 ++++++++++++++++++++++
 .../scala/kafka/tools/ProducerPerformance.scala    |  2 +-
 .../scala/kafka/tools/SimpleConsumerShell.scala    | 45 ++++++++++++------
 .../main/scala/kafka/utils/DumpLogSegments.scala   | 53 ----------------------
 4 files changed, 85 insertions(+), 68 deletions(-)
a484c1bcd1ecf4116102576ccd615168c693832f

 core/src/main/scala/kafka/server/KafkaRequestHandlers.scala | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
4a688c5d6c87aa8dfffdb2154ef880107176573f

 .../kafka/network/BoundedByteBufferReceive.scala   |  6 +-
 .../main/scala/kafka/network/SocketServer.scala    | 23 +++---
 core/src/main/scala/kafka/server/KafkaServer.scala |  3 +-
 .../unit/kafka/network/SocketServerTest.scala      | 81 ++++++++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  1 +
 5 files changed, 102 insertions(+), 12 deletions(-)
4f56e4410025a1154b75f20e86091589aace7bd5

 .../scala/kafka/message/ByteBufferMessageSet.scala    | 19 +++++++++++++------
 1 file changed, 13 insertions(+), 6 deletions(-)
76ccf2211db03d819b7847d69c41cb88da04bfe9

 core/src/main/scala/kafka/producer/async/DefaultEventHandler.scala | 3 ++-
 core/src/main/scala/kafka/producer/async/ProducerSendThread.scala  | 3 ++-
 2 files changed, 4 insertions(+), 2 deletions(-)
28984e6c1834bd88f5acb86dd7468751c542ac50

 .../kafka/message/ByteBufferMessageSetTest.scala   | 65 ++++++++++++++++++++++
 .../test/scala/unit/kafka/utils/TestUtils.scala    | 12 ++++
 2 files changed, 77 insertions(+)
900496eedabd7acfdeaaf077239228f4d94312e8

 .../javaapi/message/ByteBufferMessageSet.scala     | 20 ++---------------
 .../scala/kafka/message/ByteBufferMessageSet.scala | 17 +--------------
 core/src/main/scala/kafka/message/MessageSet.scala | 25 +++++++++++++++++++++-
 .../javaapi/message/BaseMessageSetTestCases.scala  |  2 +-
 4 files changed, 28 insertions(+), 36 deletions(-)
8a07bdb71e74377d7b8ae3c53fe1e59f46bbe2a8

 .../kafka/producer/async/DefaultEventHandler.scala | 65 +++++++++++-----------
 .../unit/kafka/producer/AsyncProducerTest.scala    | 42 ++++++++++++++
 2 files changed, 76 insertions(+), 31 deletions(-)
82b42163a55440eee6508ff4a721906bc40704e8

 core/src/main/scala/kafka/consumer/ConsumerConfig.scala    | 14 +++++++++-----
 .../src/main/scala/kafka/server/KafkaServerStartable.scala | 11 ++++++++---
 .../config/whitelisttest.consumer.properties               |  2 +-
 3 files changed, 18 insertions(+), 9 deletions(-)
4cf1f167460f9ee5da60214eef72ea43148063c6

 config/log4j.properties | 8 +-------
 1 file changed, 1 insertion(+), 7 deletions(-)
6d1b6f28270e0bfc0678bd69fbb77341cef74d51

 .../kafka/integration/BackwardsCompatibilityTest.scala  |  2 +-
 .../unit/kafka/integration/LazyInitProducerTest.scala   |  2 +-
 .../unit/kafka/integration/LogCorruptionTest.scala      |  2 +-
 .../scala/unit/kafka/integration/PrimitiveApiTest.scala |  6 +++---
 .../test/scala/unit/kafka/producer/ProducerTest.scala   |  9 +++++----
 .../scala/unit/kafka/producer/SyncProducerTest.scala    | 17 ++++++++---------
 .../scala/unit/kafka/server/ServerShutdownTest.scala    |  2 +-
 7 files changed, 20 insertions(+), 20 deletions(-)
7976993f9e20d7448105e50e1dca74ecf8bc1ea3

 core/src/main/scala/kafka/log/LogManager.scala              | 4 ++--
 core/src/main/scala/kafka/server/KafkaRequestHandlers.scala | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)
d7e0b11d875e4c8fc21bfe3cc0cc4da542fa387a

 bin/kafka-server-start.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
944da579ba1828586b1b000fcd5cad6076abbcd3

 core/src/main/scala/kafka/server/KafkaServer.scala | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)
49f3b4017918c4e254e9bc09e2ef5178d62e0248

 core/src/main/scala/kafka/Kafka.scala              |  19 +-
 .../main/scala/kafka/consumer/ConsumerConfig.scala |  25 +-
 .../scala/kafka/consumer/TopicEventHandler.scala   |  24 ++
 .../consumer/ZookeeperConsumerConnector.scala      |  15 +-
 .../consumer/ZookeeperTopicEventWatcher.scala      | 115 ++++++
 .../main/scala/kafka/producer/ProducerConfig.scala |   2 +-
 .../scala/kafka/producer/async/AsyncProducer.scala |  25 +-
 .../kafka/producer/async/AsyncProducerConfig.scala |   8 +
 .../async/AsyncProducerInterruptedException.scala  |  23 ++
 .../scala/kafka/server/KafkaServerStartable.scala  | 148 +++++---
 project/build/KafkaProject.scala                   |   2 +
 system_test/embedded_consumer/README               |  25 +-
 system_test/embedded_consumer/bin/run-test.sh      | 385 +++++++++++++++++----
 .../config/blacklisttest.consumer.properties       |  15 +
 .../embedded_consumer/config/consumer.properties   |  14 -
 .../config/mirror_producer.properties              |  13 +
 .../config/server_source1.properties               |   2 -
 .../config/server_source2.properties               |   2 -
 .../config/server_source3.properties               |   2 -
 .../config/whitelisttest.consumer.properties       |  15 +
 20 files changed, 720 insertions(+), 159 deletions(-)
3e86d640a4b6cb84287601bf9196d3ba96589246

 clojure/LICENSE |  2 +-
 cpp/LICENSE     |  2 +-
 csharp/LICENSE  |  4 ++--
 php/LICENSE     |  2 +-
 python/kafka.py | 26 +++++++++++++++-----------
 python/setup.py | 18 ++++++++++++++++++
 ruby/LICENSE    |  2 +-
 7 files changed, 39 insertions(+), 17 deletions(-)
d0c980dab278627286e9a2be649de0f6c8ce8b53

 LICENSE                                            |  3 +-
 clients/clojure/LICENSE                            |  2 +-
 clients/cpp/LICENSE                                |  2 +-
 clients/csharp/LICENSE                             |  4 +--
 clients/php/LICENSE                                |  2 +-
 clients/python/kafka.py                            | 26 ++++++++++--------
 clients/python/setup.py                            | 18 ++++++++++++
 clients/ruby/LICENSE                               |  2 +-
 .../main/scala/kafka/tools/GetOffsetShell.scala    | 32 ++++++++++++----------
 .../unit/kafka/producer/ProducerMethodsTest.scala  | 29 +++++++++++---------
 10 files changed, 74 insertions(+), 46 deletions(-)
462dfda513d98a0017564f5070f678d57f834872

 .../src/main/java/kafka/etl/KafkaETLContext.java         | 16 ++++++++++++++++
 .../src/main/java/kafka/etl/KafkaETLInputFormat.java     | 16 ++++++++++++++++
 .../src/main/java/kafka/etl/KafkaETLJob.java             | 16 ++++++++++++++++
 .../src/main/java/kafka/etl/KafkaETLKey.java             | 16 ++++++++++++++++
 .../src/main/java/kafka/etl/KafkaETLRecordReader.java    | 16 ++++++++++++++++
 .../src/main/java/kafka/etl/KafkaETLRequest.java         | 16 ++++++++++++++++
 .../src/main/java/kafka/etl/KafkaETLUtils.java           | 13 +++++++------
 .../hadoop-consumer/src/main/java/kafka/etl/Props.java   | 13 +++++++------
 .../main/java/kafka/etl/UndefinedPropertyException.java  | 13 +++++++------
 .../src/main/java/kafka/etl/impl/DataGenerator.java      | 13 +++++++------
 .../src/main/java/kafka/etl/impl/SimpleKafkaETLJob.java  | 13 +++++++------
 .../main/java/kafka/etl/impl/SimpleKafkaETLMapper.java   | 13 +++++++------
 .../main/java/kafka/bridge/examples/TextPublisher.java   | 13 +++++++------
 .../main/java/kafka/bridge/hadoop/KafkaOutputFormat.java | 13 +++++++------
 .../main/java/kafka/bridge/hadoop/KafkaRecordWriter.java | 13 +++++++------
 .../src/main/java/kafka/bridge/pig/AvroKafkaStorage.java | 13 +++++++------
 core/src/main/scala/kafka/Kafka.scala                    | 13 +++++++------
 core/src/main/scala/kafka/api/FetchRequest.scala         | 13 +++++++------
 core/src/main/scala/kafka/api/MultiFetchRequest.scala    | 13 +++++++------
 core/src/main/scala/kafka/api/MultiFetchResponse.scala   | 13 +++++++------
 core/src/main/scala/kafka/api/MultiProducerRequest.scala | 13 +++++++------
 core/src/main/scala/kafka/api/OffsetRequest.scala        | 13 +++++++------
 core/src/main/scala/kafka/api/ProducerRequest.scala      | 13 +++++++------
 core/src/main/scala/kafka/api/RequestKeys.scala          | 13 +++++++------
 core/src/main/scala/kafka/cluster/Broker.scala           | 13 +++++++------
 core/src/main/scala/kafka/cluster/Cluster.scala          | 13 +++++++------
 core/src/main/scala/kafka/cluster/Partition.scala        | 13 +++++++------
 core/src/main/scala/kafka/common/ErrorMapping.scala      | 13 +++++++------
 .../main/scala/kafka/common/InvalidConfigException.scala | 13 +++++++------
 .../scala/kafka/common/InvalidPartitionException.scala   | 13 +++++++------
 .../scala/kafka/common/OffsetOutOfRangeException.scala   | 13 +++++++------
 .../kafka/common/UnavailableProducerException.scala      | 13 +++++++------
 .../main/scala/kafka/common/UnknownCodecException.scala  | 13 +++++++------
 core/src/main/scala/kafka/common/UnknownException.scala  | 13 +++++++------
 .../scala/kafka/common/UnknownMagicByteException.scala   | 13 +++++++------
 core/src/main/scala/kafka/consumer/ConsoleConsumer.scala | 13 +++++++------
 core/src/main/scala/kafka/consumer/ConsumerConfig.scala  | 13 +++++++------
 .../main/scala/kafka/consumer/ConsumerConnector.scala    | 13 +++++++------
 .../src/main/scala/kafka/consumer/ConsumerIterator.scala | 13 +++++++------
 .../src/main/scala/kafka/consumer/FetchedDataChunk.scala | 13 +++++++------
 core/src/main/scala/kafka/consumer/Fetcher.scala         | 13 +++++++------
 core/src/main/scala/kafka/consumer/FetcherRunnable.scala | 13 +++++++------
 .../main/scala/kafka/consumer/KafkaMessageStream.scala   | 13 +++++++------
 .../main/scala/kafka/consumer/PartitionTopicInfo.scala   | 13 +++++++------
 core/src/main/scala/kafka/consumer/SimpleConsumer.scala  | 13 +++++++------
 core/src/main/scala/kafka/consumer/TopicCount.scala      | 13 +++++++------
 .../kafka/consumer/ZookeeperConsumerConnector.scala      | 13 +++++++------
 .../kafka/consumer/storage/MemoryOffsetStorage.scala     | 13 +++++++------
 .../scala/kafka/consumer/storage/OffsetStorage.scala     | 13 +++++++------
 .../kafka/consumer/storage/OracleOffsetStorage.scala     | 13 +++++++------
 core/src/main/scala/kafka/javaapi/Implicits.scala        | 13 +++++++------
 .../main/scala/kafka/javaapi/MultiFetchResponse.scala    | 13 +++++++------
 core/src/main/scala/kafka/javaapi/ProducerRequest.scala  | 13 +++++++------
 .../scala/kafka/javaapi/consumer/ConsumerConnector.java  | 13 +++++++------
 .../scala/kafka/javaapi/consumer/SimpleConsumer.scala    | 13 +++++++------
 .../javaapi/consumer/ZookeeperConsumerConnector.scala    | 13 +++++++------
 .../kafka/javaapi/message/ByteBufferMessageSet.scala     | 13 +++++++------
 .../main/scala/kafka/javaapi/message/MessageSet.scala    | 13 +++++++------
 .../src/main/scala/kafka/javaapi/producer/Producer.scala | 13 +++++++------
 .../main/scala/kafka/javaapi/producer/ProducerData.scala | 13 +++++++------
 .../main/scala/kafka/javaapi/producer/SyncProducer.scala | 13 +++++++------
 .../kafka/javaapi/producer/async/CallbackHandler.java    | 13 +++++++------
 .../scala/kafka/javaapi/producer/async/EventHandler.java | 13 +++++++------
 core/src/main/scala/kafka/log/Log.scala                  | 13 +++++++------
 core/src/main/scala/kafka/log/LogManager.scala           | 13 +++++++------
 core/src/main/scala/kafka/log/LogStats.scala             | 13 +++++++------
 core/src/main/scala/kafka/log/SegmentList.scala          | 13 +++++++------
 .../main/scala/kafka/message/ByteBufferMessageSet.scala  | 13 +++++++------
 core/src/main/scala/kafka/message/CompressionCodec.scala | 13 +++++++------
 core/src/main/scala/kafka/message/CompressionUtils.scala | 13 +++++++------
 core/src/main/scala/kafka/message/FileMessageSet.scala   | 13 +++++++------
 .../scala/kafka/message/InvalidMessageException.scala    | 13 +++++++------
 core/src/main/scala/kafka/message/Message.scala          | 13 +++++++------
 core/src/main/scala/kafka/message/MessageAndOffset.scala | 13 +++++++------
 .../scala/kafka/message/MessageLengthException.scala     | 13 +++++++------
 core/src/main/scala/kafka/message/MessageSet.scala       | 13 +++++++------
 .../scala/kafka/network/BoundedByteBufferReceive.scala   | 13 +++++++------
 .../main/scala/kafka/network/BoundedByteBufferSend.scala | 13 +++++++------
 core/src/main/scala/kafka/network/ByteBufferSend.scala   | 13 +++++++------
 core/src/main/scala/kafka/network/ConnectionConfig.scala | 13 +++++++------
 core/src/main/scala/kafka/network/Handler.scala          | 13 +++++++------
 .../scala/kafka/network/InvalidRequestException.scala    | 13 +++++++------
 core/src/main/scala/kafka/network/Request.scala          | 13 +++++++------
 core/src/main/scala/kafka/network/SocketServer.scala     | 13 +++++++------
 .../src/main/scala/kafka/network/SocketServerStats.scala | 13 +++++++------
 core/src/main/scala/kafka/network/Transmission.scala     | 13 +++++++------
 .../main/scala/kafka/producer/BrokerPartitionInfo.scala  | 13 +++++++------
 .../scala/kafka/producer/ConfigBrokerPartitionInfo.scala | 13 +++++++------
 .../main/scala/kafka/producer/DefaultPartitioner.scala   | 13 +++++++------
 .../main/scala/kafka/producer/KafkaLog4jAppender.scala   | 13 +++++++------
 core/src/main/scala/kafka/producer/Partitioner.scala     | 13 +++++++------
 core/src/main/scala/kafka/producer/Producer.scala        | 16 ++++++++--------
 core/src/main/scala/kafka/producer/ProducerConfig.scala  | 13 +++++++------
 core/src/main/scala/kafka/producer/ProducerData.scala    | 13 +++++++------
 core/src/main/scala/kafka/producer/ProducerPool.scala    | 13 +++++++------
 core/src/main/scala/kafka/producer/SyncProducer.scala    | 13 +++++++------
 .../main/scala/kafka/producer/SyncProducerConfig.scala   | 13 +++++++------
 .../scala/kafka/producer/ZKBrokerPartitionInfo.scala     | 13 +++++++------
 .../main/scala/kafka/producer/async/AsyncProducer.scala  | 13 +++++++------
 .../scala/kafka/producer/async/AsyncProducerConfig.scala | 13 +++++++------
 .../scala/kafka/producer/async/AsyncProducerStats.scala  | 13 +++++++------
 .../kafka/producer/async/AsyncProducerStatsMBean.scala   | 13 +++++++------
 .../scala/kafka/producer/async/CallbackHandler.scala     | 13 +++++++------
 .../scala/kafka/producer/async/DefaultEventHandler.scala | 13 +++++++------
 .../main/scala/kafka/producer/async/EventHandler.scala   | 13 +++++++------
 .../kafka/producer/async/MissingConfigException.scala    | 13 +++++++------
 .../scala/kafka/producer/async/ProducerSendThread.scala  | 13 +++++++------
 .../kafka/producer/async/QueueClosedException.scala      | 13 +++++++------
 .../scala/kafka/producer/async/QueueFullException.scala  | 13 +++++++------
 core/src/main/scala/kafka/serializer/Decoder.scala       | 13 +++++++------
 core/src/main/scala/kafka/serializer/Encoder.scala       | 13 +++++++------
 core/src/main/scala/kafka/server/KafkaConfig.scala       | 13 +++++++------
 .../main/scala/kafka/server/KafkaRequestHandlers.scala   | 13 +++++++------
 core/src/main/scala/kafka/server/KafkaServer.scala       | 13 +++++++------
 .../main/scala/kafka/server/KafkaServerStartable.scala   | 13 +++++++------
 core/src/main/scala/kafka/server/KafkaZooKeeper.scala    | 13 +++++++------
 core/src/main/scala/kafka/server/MessageSetSend.scala    | 13 +++++++------
 .../main/scala/kafka/server/MultiMessageSetSend.scala    | 13 +++++++------
 .../src/main/scala/kafka/tools/ConsumerPerformance.scala | 13 +++++++------
 core/src/main/scala/kafka/tools/ConsumerShell.scala      | 13 +++++++------
 .../src/main/scala/kafka/tools/ProducerPerformance.scala | 13 +++++++------
 core/src/main/scala/kafka/tools/ProducerShell.scala      | 13 +++++++------
 .../scala/kafka/tools/SimpleConsumerPerformance.scala    | 13 +++++++------
 .../src/main/scala/kafka/tools/SimpleConsumerShell.scala | 13 +++++++------
 core/src/main/scala/kafka/utils/Annotations.scala        | 13 +++++++------
 core/src/main/scala/kafka/utils/DelayedItem.scala        | 13 +++++++------
 core/src/main/scala/kafka/utils/DumpLogSegments.scala    | 13 +++++++------
 core/src/main/scala/kafka/utils/IteratorTemplate.scala   | 13 +++++++------
 core/src/main/scala/kafka/utils/KafkaScheduler.scala     | 13 +++++++------
 core/src/main/scala/kafka/utils/MockTime.scala           | 13 +++++++------
 core/src/main/scala/kafka/utils/Pool.scala               | 13 +++++++------
 core/src/main/scala/kafka/utils/Range.scala              | 13 +++++++------
 core/src/main/scala/kafka/utils/Throttler.scala          | 13 +++++++------
 core/src/main/scala/kafka/utils/Time.scala               | 13 +++++++------
 core/src/main/scala/kafka/utils/UpdateOffsetsInZK.scala  | 13 +++++++------
 core/src/main/scala/kafka/utils/Utils.scala              | 13 +++++++------
 core/src/main/scala/kafka/utils/ZkUtils.scala            | 13 +++++++------
 core/src/test/scala/other/kafka/DeleteZKPath.scala       | 13 +++++++------
 core/src/test/scala/other/kafka/TestKafkaAppender.scala  | 13 +++++++------
 .../test/scala/other/kafka/TestLinearWriteSpeed.scala    | 13 +++++++------
 core/src/test/scala/other/kafka/TestLogPerformance.scala | 13 +++++++------
 core/src/test/scala/other/kafka/TestTruncate.scala       | 13 +++++++------
 .../test/scala/other/kafka/TestZKConsumerOffsets.scala   | 13 +++++++------
 .../test/scala/unit/kafka/consumer/TopicCountTest.scala  | 13 +++++++------
 .../kafka/consumer/ZookeeperConsumerConnectorTest.scala  | 13 +++++++------
 .../unit/kafka/integration/AutoOffsetResetTest.scala     | 13 +++++++------
 .../kafka/integration/BackwardsCompatibilityTest.scala   | 13 +++++++------
 .../test/scala/unit/kafka/integration/FetcherTest.scala  | 13 +++++++------
 .../unit/kafka/integration/KafkaServerTestHarness.scala  | 13 +++++++------
 .../unit/kafka/integration/LazyInitProducerTest.scala    | 13 +++++++------
 .../scala/unit/kafka/integration/PrimitiveApiTest.scala  | 13 +++++++------
 .../kafka/integration/ProducerConsumerTestHarness.scala  | 13 +++++++------
 .../consumer/ZookeeperConsumerConnectorTest.scala        | 13 +++++++------
 .../kafka/javaapi/integration/PrimitiveApiTest.scala     | 13 +++++++------
 .../integration/ProducerConsumerTestHarness.scala        | 13 +++++++------
 .../kafka/javaapi/message/BaseMessageSetTestCases.scala  | 13 +++++++------
 .../kafka/javaapi/message/ByteBufferMessageSetTest.scala | 13 +++++++------
 .../scala/unit/kafka/javaapi/producer/ProducerTest.scala | 13 +++++++------
 .../unit/kafka/javaapi/producer/SyncProducerTest.scala   | 13 +++++++------
 core/src/test/scala/unit/kafka/log/LogManagerTest.scala  | 13 +++++++------
 core/src/test/scala/unit/kafka/log/LogOffsetTest.scala   | 13 +++++++------
 core/src/test/scala/unit/kafka/log/LogTest.scala         | 13 +++++++------
 core/src/test/scala/unit/kafka/log/SegmentListTest.scala | 13 +++++++------
 .../scala/unit/kafka/log4j/KafkaLog4jAppenderTest.scala  | 13 +++++++------
 .../unit/kafka/message/BaseMessageSetTestCases.scala     | 13 +++++++------
 .../unit/kafka/message/ByteBufferMessageSetTest.scala    | 13 +++++++------
 .../scala/unit/kafka/message/FileMessageSetTest.scala    | 13 +++++++------
 core/src/test/scala/unit/kafka/message/MessageTest.scala | 13 +++++++------
 .../scala/unit/kafka/producer/AsyncProducerTest.scala    | 13 +++++++------
 .../test/scala/unit/kafka/producer/ProducerTest.scala    | 13 +++++++------
 .../scala/unit/kafka/producer/SyncProducerTest.scala     | 13 +++++++------
 .../scala/unit/kafka/server/ServerShutdownTest.scala     | 13 +++++++------
 core/src/test/scala/unit/kafka/utils/TestUtils.scala     | 13 +++++++------
 core/src/test/scala/unit/kafka/utils/UtilsTest.scala     | 13 +++++++------
 .../src/test/scala/unit/kafka/zk/EmbeddedZookeeper.scala | 13 +++++++------
 core/src/test/scala/unit/kafka/zk/ZKEphemeralTest.scala  | 13 +++++++------
 .../src/test/scala/unit/kafka/zk/ZKLoadBalanceTest.scala | 13 +++++++------
 .../test/scala/unit/kafka/zk/ZooKeeperTestHarness.scala  | 13 +++++++------
 examples/src/main/java/kafka/examples/Consumer.java      | 13 +++++++------
 examples/src/main/java/kafka/examples/ExampleUtils.java  | 13 +++++++------
 .../java/kafka/examples/KafkaConsumerProducerDemo.java   | 13 +++++++------
 .../src/main/java/kafka/examples/KafkaProperties.java    | 13 +++++++------
 examples/src/main/java/kafka/examples/Producer.java      | 13 +++++++------
 .../src/main/java/kafka/examples/SimpleConsumerDemo.java | 13 +++++++------
 perf/src/main/java/kafka/perf/KafkaSimulatorMXBean.java  | 13 +++++++------
 .../java/kafka/perf/consumer/SimplePerfConsumer.java     | 13 +++++++------
 perf/src/main/java/kafka/perf/producer/Producer.java     | 13 +++++++------
 project/build/KafkaProject.scala                         | 16 ++++++++++++++++
 188 files changed, 1380 insertions(+), 1088 deletions(-)
e96cf1facfa4ef21128f38aaf9484a307c6bdb61

 README.md | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)
ed34f0cb35cf7ec1a6837ba5180d05a9659e0d37

 config/zookeeper.properties | 2 ++
 1 file changed, 2 insertions(+)
f7046c247dd466c90337bb39a4612115c3e41923

 core/src/main/scala/kafka/producer/ProducerPool.scala | 17 ++++-------------
 1 file changed, 4 insertions(+), 13 deletions(-)
96b8e03dd1ee23a550ca87803777b4d7bec05d5a

 .../scala/kafka/consumer/ConsoleConsumer.scala     |  4 ++--
 .../consumer/ZookeeperConsumerConnector.scala      | 28 ++++++++++++----------
 .../kafka/producer/ZKBrokerPartitionInfo.scala     |  4 ++--
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |  2 +-
 .../main/scala/kafka/tools/ReplayLogProducer.scala |  4 ++--
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |  2 +-
 core/src/main/scala/kafka/utils/ZkUtils.scala      |  2 +-
 core/src/test/scala/other/kafka/DeleteZKPath.scala |  4 ++--
 .../test/scala/unit/kafka/utils/TestUtils.scala    |  4 ++--
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |  4 ++--
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |  6 ++---
 11 files changed, 33 insertions(+), 31 deletions(-)
665f1d0527846e1eaf6c39fd8a329dbfeb08b0c9

 core/lib/zkclient-0.1.0.jar    | Bin 97269 -> 0 bytes
 core/lib/zkclient-20110412.jar | Bin 0 -> 97497 bytes
 2 files changed, 0 insertions(+), 0 deletions(-)
cbbfbaf33179f2a44ae641ccaaba1f0a8e73730f

 .gitignore | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
0b867cb28486089aed0c5da0a4e566de260604b2

 clojure/.gitignore                                 |     2 +
 clojure/LICENSE                                    |   202 +
 clojure/README.md                                  |    50 +
 clojure/leiningen/run_example.clj                  |    10 +
 clojure/project.clj                                |    13 +
 clojure/resources/log4j.properties                 |     5 +
 clojure/src/kafka/buffer.clj                       |   175 +
 clojure/src/kafka/example.clj                      |    38 +
 clojure/src/kafka/kafka.clj                        |   267 +
 clojure/src/kafka/print.clj                        |    22 +
 clojure/src/kafka/serializable.clj                 |    22 +
 clojure/src/kafka/types.clj                        |    28 +
 clojure/test/kafka/buffer_test.clj                 |    46 +
 clojure/test/kafka/print_test.clj                  |    12 +
 clojure/test/kafka/serializable_test.clj           |    14 +
 cpp/LICENSE                                        |   203 +
 cpp/Makefile.am                                    |    51 +
 cpp/Makefile.in                                    |   946 ++
 cpp/README.md                                      |    55 +
 cpp/aclocal.m4                                     |   956 ++
 cpp/build-aux/config.guess                         |  1502 ++
 cpp/build-aux/config.sub                           |  1714 ++
 cpp/build-aux/depcomp                              |   630 +
 cpp/build-aux/install-sh                           |   520 +
 cpp/build-aux/ltmain.sh                            |  8413 ++++++++++
 cpp/build-aux/m4/libtool.m4                        |  7377 ++++++++
 cpp/build-aux/m4/ltoptions.m4                      |   368 +
 cpp/build-aux/m4/ltsugar.m4                        |   123 +
 cpp/build-aux/m4/ltversion.m4                      |    23 +
 cpp/build-aux/m4/lt~obsolete.m4                    |    92 +
 cpp/build-aux/missing                              |   376 +
 cpp/configure                                      | 16820 +++++++++++++++++++
 cpp/configure.ac                                   |    28 +
 cpp/src/encoder.hpp                                |    49 +
 cpp/src/encoder_helper.hpp                         |    63 +
 cpp/src/example.cpp                                |    38 +
 cpp/src/producer.cpp                               |   100 +
 cpp/src/producer.hpp                               |    99 +
 cpp/src/tests/encoder_helper_tests.cpp             |    71 +
 cpp/src/tests/encoder_tests.cpp                    |    52 +
 cpp/src/tests/producer_tests.cpp                   |    59 +
 csharp/.gitignore                                  |     5 +
 csharp/LICENSE                                     |   202 +
 csharp/README.md                                   |    66 +
 csharp/Settings.StyleCop                           |    76 +
 csharp/lib/nunit/2.5.9/nunit.framework.dll         |   Bin 0 -> 135168 bytes
 csharp/src/Kafka/Kafka.Client/AbstractRequest.cs   |    35 +
 csharp/src/Kafka/Kafka.Client/Consumer.cs          |   232 +
 csharp/src/Kafka/Kafka.Client/Kafka.Client.csproj  |    69 +
 csharp/src/Kafka/Kafka.Client/KafkaConnection.cs   |   204 +
 csharp/src/Kafka/Kafka.Client/KafkaException.cs    |    81 +
 csharp/src/Kafka/Kafka.Client/Message.cs           |   140 +
 csharp/src/Kafka/Kafka.Client/Producer.cs          |   135 +
 .../Kafka/Kafka.Client/Properties/AssemblyInfo.cs  |    36 +
 .../src/Kafka/Kafka.Client/Request/FetchRequest.cs |   113 +
 .../Kafka.Client/Request/MultiFetchRequest.cs      |    62 +
 .../Kafka.Client/Request/MultiProducerRequest.cs   |    71 +
 .../Kafka/Kafka.Client/Request/OffsetRequest.cs    |    90 +
 .../Kafka/Kafka.Client/Request/ProducerRequest.cs  |    98 +
 csharp/src/Kafka/Kafka.Client/RequestContext.cs    |    36 +
 csharp/src/Kafka/Kafka.Client/RequestType.cs       |    36 +
 csharp/src/Kafka/Kafka.Client/Util/BitWorks.cs     |    69 +
 csharp/src/Kafka/Kafka.Client/Util/Crc32.cs        |   115 +
 csharp/src/Kafka/Kafka.sln                         |    38 +
 .../Kafka.Client.IntegrationTests.csproj           |    64 +
 .../KafkaIntegrationTest.cs                        |   181 +
 .../Properties/AssemblyInfo.cs                     |    36 +
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   |    70 +
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs |    68 +
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs  |    36 +
 .../Request/FetchRequestTests.cs                   |    86 +
 .../Request/MultiFetchRequestTests.cs              |    86 +
 .../Request/MultiProducerRequestTests.cs           |    86 +
 .../Request/OffsetRequestTests.cs                  |    83 +
 .../Request/ProducerRequestTests.cs                |    86 +
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs |   104 +
 go/.gitignore                                      |    13 +
 go/LICENSE                                         |   208 +
 go/Makefile                                        |    25 +
 go/README.md                                       |    83 +
 go/kafka_test.go                                   |   128 +
 go/src/consumer.go                                 |   184 +
 go/src/converts.go                                 |    53 +
 go/src/kafka.go                                    |    97 +
 go/src/message.go                                  |   107 +
 go/src/publisher.go                                |    59 +
 go/src/request.go                                  |   108 +
 go/src/timing.go                                   |    50 +
 go/tools/consumer/Makefile                         |     7 +
 go/tools/consumer/consumer.go                      |   113 +
 go/tools/offsets/Makefile                          |     7 +
 go/tools/offsets/offsets.go                        |    62 +
 go/tools/publisher/Makefile                        |     7 +
 go/tools/publisher/publisher.go                    |    75 +
 php/LICENSE                                        |   203 +
 php/README.md                                      |    20 +
 php/src/examples/autoloader.php                    |    23 +
 php/src/examples/consume.php                       |    36 +
 php/src/examples/produce.php                       |    29 +
 php/src/lib/Kafka/BoundedByteBuffer/Receive.php    |   154 +
 php/src/lib/Kafka/BoundedByteBuffer/Send.php       |   118 +
 php/src/lib/Kafka/Encoder.php                      |    71 +
 php/src/lib/Kafka/FetchRequest.php                 |   126 +
 php/src/lib/Kafka/Message.php                      |   127 +
 php/src/lib/Kafka/MessageSet.php                   |   122 +
 php/src/lib/Kafka/Producer.php                     |   116 +
 php/src/lib/Kafka/Request.php                      |    30 +
 php/src/lib/Kafka/RequestKeys.php                  |    30 +
 php/src/lib/Kafka/SimpleConsumer.php               |   142 +
 .../tests/Kafka/BoundedByteBuffer/ReceiveTest.php  |   116 +
 php/src/tests/Kafka/BoundedByteBuffer/SendTest.php |    83 +
 php/src/tests/Kafka/EncoderTest.php                |    44 +
 php/src/tests/Kafka/FetchRequestTest.php           |    71 +
 php/src/tests/Kafka/MessageTest.php                |    45 +
 php/src/tests/Kafka/ProducerTest.php               |    59 +
 php/src/tests/bootstrap.php                        |    36 +
 php/src/tests/phpunit.xml                          |    17 +
 python/kafka.py                                    |    68 +
 python/setup.py                                    |    15 +
 ruby/LICENSE                                       |   202 +
 ruby/README.md                                     |    62 +
 ruby/Rakefile                                      |    61 +
 ruby/TODO                                          |     1 +
 ruby/kafka-rb.gemspec                              |    32 +
 ruby/lib/kafka.rb                                  |    13 +
 ruby/lib/kafka/batch.rb                            |    13 +
 ruby/lib/kafka/consumer.rb                         |   135 +
 ruby/lib/kafka/error_codes.rb                      |    21 +
 ruby/lib/kafka/io.rb                               |    39 +
 ruby/lib/kafka/message.rb                          |    35 +
 ruby/lib/kafka/producer.rb                         |    49 +
 ruby/lib/kafka/request_type.rb                     |     9 +
 ruby/spec/batch_spec.rb                            |    21 +
 ruby/spec/consumer_spec.rb                         |   120 +
 ruby/spec/io_spec.rb                               |    77 +
 ruby/spec/kafka_spec.rb                            |     7 +
 ruby/spec/message_spec.rb                          |    55 +
 ruby/spec/producer_spec.rb                         |    95 +
 ruby/spec/spec_helper.rb                           |     4 +
 139 files changed, 48967 insertions(+)
642da2f28c9bc6e373603d6d9119ce33684090f5

 CONTRIBUTORS                                       |    10 +
 LICENSE                                            |   202 +
 NOTICE                                             |    64 +
 README.md                                          |    55 +
 bin/kafka-console-consumer-log4j.properties        |     7 +
 bin/kafka-console-consumer.sh                      |     5 +
 bin/kafka-consumer-perf-test.sh                    |     3 +
 bin/kafka-consumer-shell.sh                        |     3 +
 bin/kafka-producer-perf-test.sh                    |     3 +
 bin/kafka-producer-shell.sh                        |     3 +
 bin/kafka-replay-log-producer.sh                   |     5 +
 bin/kafka-run-class.sh                             |    47 +
 bin/kafka-server-start.sh                          |    11 +
 bin/kafka-server-stop.sh                           |     2 +
 bin/kafka-simple-consumer-perf-test.sh             |     3 +
 bin/kafka-simple-consumer-shell.sh                 |     3 +
 bin/zookeeper-server-start.sh                      |     9 +
 bin/zookeeper-server-stop.sh                       |     2 +
 clients/clojure/.gitignore                         |     2 +
 clients/clojure/LICENSE                            |   202 +
 clients/clojure/README.md                          |    50 +
 clients/clojure/leiningen/run_example.clj          |    10 +
 clients/clojure/project.clj                        |    13 +
 clients/clojure/resources/log4j.properties         |     5 +
 clients/clojure/src/kafka/buffer.clj               |   175 +
 clients/clojure/src/kafka/example.clj              |    38 +
 clients/clojure/src/kafka/kafka.clj                |   267 +
 clients/clojure/src/kafka/print.clj                |    22 +
 clients/clojure/src/kafka/serializable.clj         |    22 +
 clients/clojure/src/kafka/types.clj                |    28 +
 clients/clojure/test/kafka/buffer_test.clj         |    46 +
 clients/clojure/test/kafka/print_test.clj          |    12 +
 clients/clojure/test/kafka/serializable_test.clj   |    14 +
 clients/cpp/LICENSE                                |   203 +
 clients/cpp/Makefile.am                            |    51 +
 clients/cpp/Makefile.in                            |   946 ++
 clients/cpp/README.md                              |    55 +
 clients/cpp/aclocal.m4                             |   956 ++
 clients/cpp/build-aux/config.guess                 |  1502 ++
 clients/cpp/build-aux/config.sub                   |  1714 ++
 clients/cpp/build-aux/depcomp                      |   630 +
 clients/cpp/build-aux/install-sh                   |   520 +
 clients/cpp/build-aux/ltmain.sh                    |  8413 ++++++++++
 clients/cpp/build-aux/m4/libtool.m4                |  7377 ++++++++
 clients/cpp/build-aux/m4/ltoptions.m4              |   368 +
 clients/cpp/build-aux/m4/ltsugar.m4                |   123 +
 clients/cpp/build-aux/m4/ltversion.m4              |    23 +
 clients/cpp/build-aux/m4/lt~obsolete.m4            |    92 +
 clients/cpp/build-aux/missing                      |   376 +
 clients/cpp/configure                              | 16820 +++++++++++++++++++
 clients/cpp/configure.ac                           |    28 +
 clients/cpp/src/encoder.hpp                        |    49 +
 clients/cpp/src/encoder_helper.hpp                 |    63 +
 clients/cpp/src/example.cpp                        |    38 +
 clients/cpp/src/producer.cpp                       |   100 +
 clients/cpp/src/producer.hpp                       |    99 +
 clients/cpp/src/tests/encoder_helper_tests.cpp     |    71 +
 clients/cpp/src/tests/encoder_tests.cpp            |    52 +
 clients/cpp/src/tests/producer_tests.cpp           |    59 +
 clients/csharp/.gitignore                          |     5 +
 clients/csharp/LICENSE                             |   202 +
 clients/csharp/README.md                           |    66 +
 clients/csharp/Settings.StyleCop                   |    76 +
 clients/csharp/lib/nunit/2.5.9/nunit.framework.dll |   Bin 0 -> 135168 bytes
 .../src/Kafka/Kafka.Client/AbstractRequest.cs      |    35 +
 clients/csharp/src/Kafka/Kafka.Client/Consumer.cs  |   232 +
 .../src/Kafka/Kafka.Client/Kafka.Client.csproj     |    69 +
 .../src/Kafka/Kafka.Client/KafkaConnection.cs      |   204 +
 .../src/Kafka/Kafka.Client/KafkaException.cs       |    81 +
 clients/csharp/src/Kafka/Kafka.Client/Message.cs   |   140 +
 clients/csharp/src/Kafka/Kafka.Client/Producer.cs  |   135 +
 .../Kafka/Kafka.Client/Properties/AssemblyInfo.cs  |    36 +
 .../src/Kafka/Kafka.Client/Request/FetchRequest.cs |   113 +
 .../Kafka.Client/Request/MultiFetchRequest.cs      |    62 +
 .../Kafka.Client/Request/MultiProducerRequest.cs   |    71 +
 .../Kafka/Kafka.Client/Request/OffsetRequest.cs    |    90 +
 .../Kafka/Kafka.Client/Request/ProducerRequest.cs  |    98 +
 .../src/Kafka/Kafka.Client/RequestContext.cs       |    36 +
 .../csharp/src/Kafka/Kafka.Client/RequestType.cs   |    36 +
 .../csharp/src/Kafka/Kafka.Client/Util/BitWorks.cs |    69 +
 .../csharp/src/Kafka/Kafka.Client/Util/Crc32.cs    |   115 +
 clients/csharp/src/Kafka/Kafka.sln                 |    38 +
 .../Kafka.Client.IntegrationTests.csproj           |    64 +
 .../KafkaIntegrationTest.cs                        |   181 +
 .../Properties/AssemblyInfo.cs                     |    36 +
 .../Kafka.Client.Tests/Kafka.Client.Tests.csproj   |    70 +
 .../Kafka/Tests/Kafka.Client.Tests/MessageTests.cs |    68 +
 .../Kafka.Client.Tests/Properties/AssemblyInfo.cs  |    36 +
 .../Request/FetchRequestTests.cs                   |    86 +
 .../Request/MultiFetchRequestTests.cs              |    86 +
 .../Request/MultiProducerRequestTests.cs           |    86 +
 .../Request/OffsetRequestTests.cs                  |    83 +
 .../Request/ProducerRequestTests.cs                |    86 +
 .../Tests/Kafka.Client.Tests/Util/BitWorksTests.cs |   104 +
 clients/go/.gitignore                              |    13 +
 clients/go/LICENSE                                 |   208 +
 clients/go/Makefile                                |    25 +
 clients/go/README.md                               |    83 +
 clients/go/kafka_test.go                           |   128 +
 clients/go/src/consumer.go                         |   184 +
 clients/go/src/converts.go                         |    53 +
 clients/go/src/kafka.go                            |    97 +
 clients/go/src/message.go                          |   107 +
 clients/go/src/publisher.go                        |    59 +
 clients/go/src/request.go                          |   108 +
 clients/go/src/timing.go                           |    50 +
 clients/go/tools/consumer/Makefile                 |     7 +
 clients/go/tools/consumer/consumer.go              |   113 +
 clients/go/tools/offsets/Makefile                  |     7 +
 clients/go/tools/offsets/offsets.go                |    62 +
 clients/go/tools/publisher/Makefile                |     7 +
 clients/go/tools/publisher/publisher.go            |    75 +
 clients/php/LICENSE                                |   203 +
 clients/php/README.md                              |    20 +
 clients/php/src/examples/autoloader.php            |    23 +
 clients/php/src/examples/consume.php               |    36 +
 clients/php/src/examples/produce.php               |    29 +
 .../src/lib/Kafka/BoundedByteBuffer/Receive.php    |   154 +
 .../php/src/lib/Kafka/BoundedByteBuffer/Send.php   |   118 +
 clients/php/src/lib/Kafka/Encoder.php              |    71 +
 clients/php/src/lib/Kafka/FetchRequest.php         |   126 +
 clients/php/src/lib/Kafka/Message.php              |   127 +
 clients/php/src/lib/Kafka/MessageSet.php           |   122 +
 clients/php/src/lib/Kafka/Producer.php             |   116 +
 clients/php/src/lib/Kafka/Request.php              |    30 +
 clients/php/src/lib/Kafka/RequestKeys.php          |    30 +
 clients/php/src/lib/Kafka/SimpleConsumer.php       |   142 +
 .../tests/Kafka/BoundedByteBuffer/ReceiveTest.php  |   116 +
 .../src/tests/Kafka/BoundedByteBuffer/SendTest.php |    83 +
 clients/php/src/tests/Kafka/EncoderTest.php        |    44 +
 clients/php/src/tests/Kafka/FetchRequestTest.php   |    71 +
 clients/php/src/tests/Kafka/MessageTest.php        |    45 +
 clients/php/src/tests/Kafka/ProducerTest.php       |    59 +
 clients/php/src/tests/bootstrap.php                |    36 +
 clients/php/src/tests/phpunit.xml                  |    17 +
 clients/python/kafka.py                            |    68 +
 clients/python/setup.py                            |    15 +
 clients/ruby/LICENSE                               |   202 +
 clients/ruby/README.md                             |    62 +
 clients/ruby/Rakefile                              |    61 +
 clients/ruby/TODO                                  |     1 +
 clients/ruby/kafka-rb.gemspec                      |    32 +
 clients/ruby/lib/kafka.rb                          |    13 +
 clients/ruby/lib/kafka/batch.rb                    |    13 +
 clients/ruby/lib/kafka/consumer.rb                 |   135 +
 clients/ruby/lib/kafka/error_codes.rb              |    21 +
 clients/ruby/lib/kafka/io.rb                       |    39 +
 clients/ruby/lib/kafka/message.rb                  |    35 +
 clients/ruby/lib/kafka/producer.rb                 |    49 +
 clients/ruby/lib/kafka/request_type.rb             |     9 +
 clients/ruby/spec/batch_spec.rb                    |    21 +
 clients/ruby/spec/consumer_spec.rb                 |   120 +
 clients/ruby/spec/io_spec.rb                       |    77 +
 clients/ruby/spec/kafka_spec.rb                    |     7 +
 clients/ruby/spec/message_spec.rb                  |    55 +
 clients/ruby/spec/producer_spec.rb                 |    95 +
 clients/ruby/spec/spec_helper.rb                   |     4 +
 config/consumer.properties                         |    15 +
 config/log4j.properties                            |    22 +
 config/server.properties                           |    64 +
 config/zookeeper.properties                        |     4 +
 contrib/hadoop-consumer/README                     |    66 +
 contrib/hadoop-consumer/copy-jars.sh               |    55 +
 contrib/hadoop-consumer/hadoop-setup.sh            |     6 +
 contrib/hadoop-consumer/lib/avro-1.4.0.jar         |   Bin 0 -> 568780 bytes
 .../hadoop-consumer/lib/commons-logging-1.0.4.jar  |   Bin 0 -> 38015 bytes
 contrib/hadoop-consumer/lib/hadoop-0.20.2-core.jar |   Bin 0 -> 2689741 bytes
 .../hadoop-consumer/lib/jackson-core-asl-1.5.5.jar |   Bin 0 -> 171958 bytes
 .../lib/jackson-mapper-asl-1.5.5.jar               |   Bin 0 -> 485699 bytes
 contrib/hadoop-consumer/lib/pig-0.8.0-core.jar     |   Bin 0 -> 2234753 bytes
 contrib/hadoop-consumer/lib/piggybank.jar          |   Bin 0 -> 308044 bytes
 contrib/hadoop-consumer/run-class.sh               |    51 +
 .../src/main/java/kafka/etl/KafkaETLContext.java   |   270 +
 .../main/java/kafka/etl/KafkaETLInputFormat.java   |    61 +
 .../src/main/java/kafka/etl/KafkaETLJob.java       |   156 +
 .../src/main/java/kafka/etl/KafkaETLKey.java       |    88 +
 .../main/java/kafka/etl/KafkaETLRecordReader.java  |   164 +
 .../src/main/java/kafka/etl/KafkaETLRequest.java   |   112 +
 .../src/main/java/kafka/etl/KafkaETLUtils.java     |   204 +
 .../src/main/java/kafka/etl/Props.java             |   460 +
 .../java/kafka/etl/UndefinedPropertyException.java |    27 +
 .../main/java/kafka/etl/impl/DataGenerator.java    |   141 +
 .../java/kafka/etl/impl/SimpleKafkaETLJob.java     |   103 +
 .../java/kafka/etl/impl/SimpleKafkaETLMapper.java  |    87 +
 contrib/hadoop-consumer/test/test.properties       |    28 +
 contrib/hadoop-producer/README.md                  |   134 +
 contrib/hadoop-producer/lib/avro-1.4.0.jar         |   Bin 0 -> 568780 bytes
 .../hadoop-producer/lib/commons-logging-1.0.4.jar  |   Bin 0 -> 38015 bytes
 contrib/hadoop-producer/lib/hadoop-0.20.2-core.jar |   Bin 0 -> 2689741 bytes
 .../hadoop-producer/lib/jackson-core-asl-1.5.5.jar |   Bin 0 -> 171958 bytes
 .../lib/jackson-mapper-asl-1.5.5.jar               |   Bin 0 -> 485699 bytes
 contrib/hadoop-producer/lib/pig-0.8.0-core.jar     |   Bin 0 -> 2234753 bytes
 contrib/hadoop-producer/lib/piggybank.jar          |   Bin 0 -> 308044 bytes
 .../java/kafka/bridge/examples/TextPublisher.java  |    68 +
 .../kafka/bridge/hadoop/KafkaOutputFormat.java     |   115 +
 .../kafka/bridge/hadoop/KafkaRecordWriter.java     |    75 +
 .../java/kafka/bridge/pig/AvroKafkaStorage.java    |   117 +
 core/lib/zkclient-0.1.0.jar                        |   Bin 0 -> 97269 bytes
 core/lib/zookeeper-3.3.3.jar                       |   Bin 0 -> 1023866 bytes
 core/src/main/scala/kafka/Kafka.scala              |    64 +
 core/src/main/scala/kafka/api/FetchRequest.scala   |    50 +
 .../main/scala/kafka/api/MultiFetchRequest.scala   |    59 +
 .../main/scala/kafka/api/MultiFetchResponse.scala  |    51 +
 .../scala/kafka/api/MultiProducerRequest.scala     |    56 +
 core/src/main/scala/kafka/api/OffsetRequest.scala  |    99 +
 .../src/main/scala/kafka/api/ProducerRequest.scala |    82 +
 core/src/main/scala/kafka/api/RequestKeys.scala    |    25 +
 core/src/main/scala/kafka/cluster/Broker.scala     |    51 +
 core/src/main/scala/kafka/cluster/Cluster.scala    |    45 +
 core/src/main/scala/kafka/cluster/Partition.scala  |    56 +
 .../src/main/scala/kafka/common/ErrorMapping.scala |    62 +
 .../kafka/common/InvalidConfigException.scala      |    24 +
 .../kafka/common/InvalidMessageSizeException.scala |     9 +
 .../kafka/common/InvalidPartitionException.scala   |    23 +
 .../common/NoBrokersForPartitionException.scala    |     9 +
 .../kafka/common/OffsetOutOfRangeException.scala   |    25 +
 .../common/UnavailableProducerException.scala      |    23 +
 .../scala/kafka/common/UnknownCodecException.scala |    25 +
 .../main/scala/kafka/common/UnknownException.scala |    22 +
 .../kafka/common/UnknownMagicByteException.scala   |    25 +
 .../scala/kafka/consumer/ConsoleConsumer.scala     |   211 +
 .../main/scala/kafka/consumer/ConsumerConfig.scala |    85 +
 .../scala/kafka/consumer/ConsumerConnector.scala   |    74 +
 .../scala/kafka/consumer/ConsumerIterator.scala    |    82 +
 .../scala/kafka/consumer/FetchedDataChunk.scala    |    23 +
 core/src/main/scala/kafka/consumer/Fetcher.scala   |    79 +
 .../scala/kafka/consumer/FetcherRunnable.scala     |   143 +
 .../scala/kafka/consumer/KafkaMessageStream.scala  |    38 +
 .../scala/kafka/consumer/PartitionTopicInfo.scala  |    84 +
 .../main/scala/kafka/consumer/SimpleConsumer.scala |   233 +
 .../src/main/scala/kafka/consumer/TopicCount.scala |    89 +
 .../consumer/ZookeeperConsumerConnector.scala      |   569 +
 core/src/main/scala/kafka/consumer/package.html    |     1 +
 .../consumer/storage/MemoryOffsetStorage.scala     |    43 +
 .../kafka/consumer/storage/OffsetStorage.scala     |    40 +
 .../consumer/storage/OracleOffsetStorage.scala     |   157 +
 core/src/main/scala/kafka/javaapi/Implicits.scala  |   128 +
 .../scala/kafka/javaapi/MultiFetchResponse.scala   |    44 +
 .../main/scala/kafka/javaapi/ProducerRequest.scala |    51 +
 .../kafka/javaapi/consumer/ConsumerConnector.java  |    43 +
 .../kafka/javaapi/consumer/SimpleConsumer.scala    |    70 +
 .../consumer/ZookeeperConsumerConnector.scala      |    88 +
 .../javaapi/message/ByteBufferMessageSet.scala     |    96 +
 .../scala/kafka/javaapi/message/MessageSet.scala   |    53 +
 .../scala/kafka/javaapi/producer/Producer.scala    |   122 +
 .../kafka/javaapi/producer/ProducerData.scala      |    33 +
 .../kafka/javaapi/producer/SyncProducer.scala      |    47 +
 .../javaapi/producer/async/CallbackHandler.java    |    76 +
 .../kafka/javaapi/producer/async/EventHandler.java |    47 +
 core/src/main/scala/kafka/log/Log.scala            |   361 +
 core/src/main/scala/kafka/log/LogManager.scala     |   291 +
 core/src/main/scala/kafka/log/LogStats.scala       |    43 +
 core/src/main/scala/kafka/log/SegmentList.scala    |    85 +
 core/src/main/scala/kafka/log/package.html         |     1 +
 .../message/ByteBufferBackedInputStream.scala      |    26 +
 .../scala/kafka/message/ByteBufferMessageSet.scala |   192 +
 .../scala/kafka/message/CompressionCodec.scala     |    35 +
 .../scala/kafka/message/CompressionUtils.scala     |   143 +
 .../main/scala/kafka/message/FileMessageSet.scala  |   285 +
 .../kafka/message/InvalidMessageException.scala    |    22 +
 core/src/main/scala/kafka/message/Message.scala    |   182 +
 .../scala/kafka/message/MessageAndOffset.scala     |    22 +
 .../kafka/message/MessageLengthException.scala     |    23 +
 core/src/main/scala/kafka/message/MessageSet.scala |    90 +
 core/src/main/scala/kafka/message/package.html     |     1 +
 .../kafka/network/BoundedByteBufferReceive.scala   |    87 +
 .../kafka/network/BoundedByteBufferSend.scala      |    58 +
 .../main/scala/kafka/network/ByteBufferSend.scala  |    39 +
 .../scala/kafka/network/ConnectionConfig.scala     |    26 +
 core/src/main/scala/kafka/network/Handler.scala    |    32 +
 .../kafka/network/InvalidRequestException.scala    |    23 +
 core/src/main/scala/kafka/network/Request.scala    |    27 +
 .../main/scala/kafka/network/SocketServer.scala    |   341 +
 .../scala/kafka/network/SocketServerStats.scala    |    79 +
 .../main/scala/kafka/network/Transmission.scala    |   110 +
 core/src/main/scala/kafka/network/package.html     |    11 +
 .../scala/kafka/producer/BrokerPartitionInfo.scala |    49 +
 .../kafka/producer/ConfigBrokerPartitionInfo.scala |    95 +
 .../scala/kafka/producer/DefaultPartitioner.scala  |    28 +
 .../scala/kafka/producer/KafkaLog4jAppender.scala  |    91 +
 .../main/scala/kafka/producer/Partitioner.scala    |    25 +
 core/src/main/scala/kafka/producer/Producer.scala  |   178 +
 .../main/scala/kafka/producer/ProducerConfig.scala |    60 +
 .../main/scala/kafka/producer/ProducerData.scala   |    38 +
 .../main/scala/kafka/producer/ProducerPool.scala   |   189 +
 .../main/scala/kafka/producer/SyncProducer.scala   |   228 +
 .../scala/kafka/producer/SyncProducerConfig.scala  |    44 +
 .../kafka/producer/ZKBrokerPartitionInfo.scala     |   359 +
 .../scala/kafka/producer/async/AsyncProducer.scala |   130 +
 .../kafka/producer/async/AsyncProducerConfig.scala |    52 +
 .../kafka/producer/async/AsyncProducerStats.scala  |    33 +
 .../producer/async/AsyncProducerStatsMBean.scala   |    22 +
 .../kafka/producer/async/CallbackHandler.scala     |    74 +
 .../kafka/producer/async/DefaultEventHandler.scala |   111 +
 .../scala/kafka/producer/async/EventHandler.scala  |    44 +
 .../producer/async/MissingConfigException.scala    |    22 +
 .../kafka/producer/async/ProducerSendThread.scala  |   124 +
 .../producer/async/QueueClosedException.scala      |    22 +
 .../kafka/producer/async/QueueFullException.scala  |    22 +
 core/src/main/scala/kafka/serializer/Decoder.scala |    36 +
 core/src/main/scala/kafka/serializer/Encoder.scala |    31 +
 core/src/main/scala/kafka/server/KafkaConfig.scala |    86 +
 .../scala/kafka/server/KafkaRequestHandlers.scala  |   134 +
 core/src/main/scala/kafka/server/KafkaServer.scala |   123 +
 .../scala/kafka/server/KafkaServerStartable.scala  |    96 +
 .../main/scala/kafka/server/KafkaZooKeeper.scala   |   110 +
 .../main/scala/kafka/server/MessageSetSend.scala   |    68 +
 .../scala/kafka/server/MultiMessageSetSend.scala   |    38 +
 core/src/main/scala/kafka/server/package.html      |     1 +
 .../scala/kafka/tools/ConsumerPerformance.scala    |   162 +
 .../src/main/scala/kafka/tools/ConsumerShell.scala |   109 +
 .../main/scala/kafka/tools/GetOffsetShell.scala    |    71 +
 .../scala/kafka/tools/ProducerPerformance.scala    |   277 +
 .../src/main/scala/kafka/tools/ProducerShell.scala |    78 +
 .../main/scala/kafka/tools/ReplayLogProducer.scala |   197 +
 .../kafka/tools/SimpleConsumerPerformance.scala    |    95 +
 .../scala/kafka/tools/SimpleConsumerShell.scala    |   100 +
 core/src/main/scala/kafka/utils/Annotations.scala  |    35 +
 core/src/main/scala/kafka/utils/DelayedItem.scala  |    48 +
 .../main/scala/kafka/utils/DumpLogSegments.scala   |    52 +
 .../main/scala/kafka/utils/IteratorTemplate.scala  |    76 +
 .../main/scala/kafka/utils/KafkaScheduler.scala    |    46 +
 core/src/main/scala/kafka/utils/MockTime.scala     |    33 +
 core/src/main/scala/kafka/utils/Pool.scala         |    65 +
 core/src/main/scala/kafka/utils/Range.scala        |    42 +
 core/src/main/scala/kafka/utils/Throttler.scala    |    81 +
 core/src/main/scala/kafka/utils/Time.scala         |    60 +
 .../main/scala/kafka/utils/UpdateOffsetsInZK.scala |    73 +
 core/src/main/scala/kafka/utils/Utils.scala        |   684 +
 core/src/main/scala/kafka/utils/ZkUtils.scala      |   280 +
 core/src/main/scala/kafka/utils/package.html       |     1 +
 core/src/test/resources/log4j.properties           |     9 +
 .../MagicByte0-0/00000000000000000000.kafka        |   Bin 0 -> 10900 bytes
 core/src/test/scala/other/kafka.log4j.properties   |     8 +
 core/src/test/scala/other/kafka/DeleteZKPath.scala |    44 +
 .../test/scala/other/kafka/TestKafkaAppender.scala |    50 +
 .../scala/other/kafka/TestLinearWriteSpeed.scala   |    77 +
 .../scala/other/kafka/TestLogPerformance.scala     |    53 +
 core/src/test/scala/other/kafka/TestTruncate.scala |    38 +
 .../scala/other/kafka/TestZKConsumerOffsets.scala  |    72 +
 .../scala/unit/kafka/consumer/TopicCountTest.scala |    48 +
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   267 +
 .../kafka/integration/AutoOffsetResetTest.scala    |   223 +
 .../integration/BackwardsCompatibilityTest.scala   |    76 +
 .../scala/unit/kafka/integration/FetcherTest.scala |   105 +
 .../kafka/integration/KafkaServerTestHarness.scala |    49 +
 .../kafka/integration/LazyInitProducerTest.scala   |   184 +
 .../unit/kafka/integration/LogCorruptionTest.scala |    94 +
 .../unit/kafka/integration/PrimitiveApiTest.scala  |   261 +
 .../integration/ProducerConsumerTestHarness.scala  |    51 +
 .../consumer/ZookeeperConsumerConnectorTest.scala  |   287 +
 .../javaapi/integration/PrimitiveApiTest.scala     |   416 +
 .../integration/ProducerConsumerTestHarness.scala  |    52 +
 .../javaapi/message/BaseMessageSetTestCases.scala  |    74 +
 .../javaapi/message/ByteBufferMessageSetTest.scala |    86 +
 .../unit/kafka/javaapi/producer/ProducerTest.scala |   630 +
 .../kafka/javaapi/producer/SyncProducerTest.scala  |   173 +
 .../test/scala/unit/kafka/log/LogManagerTest.scala |   142 +
 .../test/scala/unit/kafka/log/LogOffsetTest.scala  |   210 +
 core/src/test/scala/unit/kafka/log/LogTest.scala   |   212 +
 .../scala/unit/kafka/log/SegmentListTest.scala     |    57 +
 .../unit/kafka/log4j/KafkaLog4jAppenderTest.scala  |   189 +
 .../kafka/message/BaseMessageSetTestCases.scala    |    69 +
 .../kafka/message/ByteBufferMessageSetTest.scala   |    51 +
 .../unit/kafka/message/CompressionUtilsTest.scala  |    41 +
 .../unit/kafka/message/FileMessageSetTest.scala    |    86 +
 .../scala/unit/kafka/message/MessageTest.scala     |    72 +
 .../unit/kafka/producer/AsyncProducerTest.scala    |   268 +
 .../unit/kafka/producer/ProducerMethodsTest.scala  |    54 +
 .../scala/unit/kafka/producer/ProducerTest.scala   |   689 +
 .../unit/kafka/producer/SyncProducerTest.scala     |   178 +
 .../unit/kafka/server/ServerShutdownTest.scala     |   121 +
 .../test/scala/unit/kafka/utils/TestUtils.scala    |   294 +
 .../test/scala/unit/kafka/utils/UtilsTest.scala    |    32 +
 .../scala/unit/kafka/zk/EmbeddedZookeeper.scala    |    42 +
 .../test/scala/unit/kafka/zk/ZKEphemeralTest.scala |    56 +
 .../scala/unit/kafka/zk/ZKLoadBalanceTest.scala    |   126 +
 .../scala/unit/kafka/zk/ZooKeeperTestHarness.scala |    35 +
 examples/README                                    |    19 +
 examples/bin/java-producer-consumer-demo.sh        |    45 +
 examples/bin/java-simple-consumer-demo.sh          |    45 +
 .../src/main/java/kafka/examples/Consumer.java     |    61 +
 .../src/main/java/kafka/examples/ExampleUtils.java |    31 +
 .../kafka/examples/KafkaConsumerProducerDemo.java  |    29 +
 .../main/java/kafka/examples/KafkaProperties.java  |    30 +
 .../src/main/java/kafka/examples/Producer.java     |    48 +
 .../java/kafka/examples/SimpleConsumerDemo.java    |    85 +
 lib/sbt-launch.jar                                 |   Bin 0 -> 920993 bytes
 perf/.classpath                                    |    10 +
 perf/.project                                      |    17 +
 perf/README.md                                     |    23 +
 perf/lib/jopt-simple-3.1.jar                       |   Bin 0 -> 50801 bytes
 perf/report-html/js/exporting.js                   |    21 +
 perf/report-html/js/highcharts.js                  |   135 +
 perf/report-html/js/kafka.js                       |    91 +
 perf/report-html/report.html                       |    43 +
 perf/run-simulator.sh                              |    35 +
 .../main/java/kafka/perf/KafkaPerfSimulator.java   |   385 +
 .../main/java/kafka/perf/KafkaSimulatorMXBean.java |    27 +
 perf/src/main/java/kafka/perf/PerfTimer.java       |   149 +
 .../kafka/perf/consumer/SimplePerfConsumer.java    |   108 +
 .../main/java/kafka/perf/jmx/BrokerJmxClient.java  |    49 +
 .../main/java/kafka/perf/producer/Producer.java    |   101 +
 perf/util-bin/remote-kafka-env.sh                  |    31 +
 perf/util-bin/run-fetchsize-test.sh                |    15 +
 perf/util-bin/run-msgsize-test.sh                  |    15 +
 perf/util-bin/run-numconsumer-sustained.sh         |    15 +
 perf/util-bin/run-numconsumer-test.sh              |    21 +
 perf/util-bin/run-numproducer-single-topic.sh      |    15 +
 perf/util-bin/run-numproducer-test.sh              |    15 +
 perf/util-bin/run-numtopic-test.sh                 |    15 +
 project/build.properties                           |    10 +
 project/build/KafkaProject.scala                   |   190 +
 project/plugins/Plugins.scala                      |     6 +
 sbt                                                |     1 +
 system_test/embedded_consumer/README               |     8 +
 system_test/embedded_consumer/bin/expected.out     |    18 +
 system_test/embedded_consumer/bin/run-test.sh      |    79 +
 .../embedded_consumer/config/consumer.properties   |    14 +
 .../config/server_source1.properties               |    64 +
 .../config/server_source2.properties               |    64 +
 .../config/server_source3.properties               |    64 +
 .../config/server_target1.properties               |    64 +
 .../config/server_target2.properties               |    64 +
 .../config/zookeeper_source.properties             |     4 +
 .../config/zookeeper_target.properties             |     4 +
 system_test/embedded_consumer/expected.out         |    11 +
 system_test/producer_perf/README                   |     9 +
 system_test/producer_perf/bin/expected.out         |    32 +
 .../producer_perf/bin/run-compression-test.sh      |    48 +
 system_test/producer_perf/bin/run-test.sh          |    48 +
 system_test/producer_perf/config/server.properties |    64 +
 .../producer_perf/config/zookeeper.properties      |     4 +
 433 files changed, 72944 insertions(+)
